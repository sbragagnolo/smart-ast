base 64 content
base64aRK
	^'Y29udHJhY3QgQVJLDQp7DQogICAgICAgDQogICAgYWRkcmVzcyBvd25lcjsNCiAgICBhZGRyZXNzIGNvbnRyb2xsZXI7DQogICAgYm9vbCBtdXRlOw0KICAgIHN0cmluZ1tdIGNvbXBhbmllczsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGNvbXBhbnlJbmRleDsNCiAgICBhZGRyZXNzW10gY29tcGFueVdhbGxldDsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gQm90KSAgYm90czsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnRbXSkgIGJvdE93bmVyczsgICAgICANCiAgICBtYXBwaW5nICh1aW50ID0+IE1hcmtldEJpbGwpICBNYXJrZXRCaWxsczsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnRbXSkgIEJ1eWVyc0JpbGxzOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludFtdKSAgU2VsbGVyc0JpbGxzOw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gU3RhdHMpICBjeWNsZTsNCiAgICB1aW50W10gIGxhc3RQcmljZTsNCiAgICB1aW50IHRvdENvbXBhbmllczsNCg0KICAgIGxvZ1tdIGxvZ3M7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIFRPUzsNCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gYm9vbCkgYmFuOw0KICAgIHVpbnRbMjBdICBsaXN0ZWQ7ICANCiAgICB1aW50IGNvaW5JbmRleDsgICAgICANCiAgICBtYXBwaW5nICh1aW50ID0+IENvaW4pIGNvaW5zOw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gQ29pbikgdHJhc2g7DQogICAgQVJLQ29udHJvbGxlcl8xXzAwIGNvbnRyb2w7DQoNCiAgICBzdHJ1Y3QgbG9new0KICAgIGFkZHJlc3MgYWRtaW47DQogICAgc3RyaW5nIGFjdGlvbjsNCiAgICBhZGRyZXNzIGFkZHI7DQogICAgfQ0KDQogICAgc3RydWN0IE1hcmtldEJpbGwgew0KICAgIHVpbnQgc2VsbGVyZGF0YTsNCiAgICB1aW50IGJ1eWVyZGF0YTsNCiAgICB1aW50IHByb2R1Y3Q7DQogICAgdWludCBpbmRleDsNCiAgICB1aW50IGNvc3Q7DQogICAgdWludCBibG9jazsNCiAgICB9DQogICAgDQogICAgc3RydWN0IENvaW4gew0KICAgIGFkZHJlc3MgY29pbk93bmVyOw0KICAgIHN0cmluZyBkYXRhOw0KICAgIHN0cmluZyBtaW5lOyAgICAgIA0KICAgIHVpbnQgY29pblR5cGU7DQogICAgdWludCBwbGF0ZjsNCiAgICBzdHJpbmcgYWR2Ow0KICAgIHVpbnQgYmxvY2s7DQogICAgfQ0KICANCiAgICBzdHJ1Y3QgQm90IHsNCiAgICBhZGRyZXNzIG93bmVyOw0KICAgIHN0cmluZyBpbmZvOyAgICAgICAgICAgICAgDQogICAgdWludCBjb3N0Ow0KICAgIHVpbnQgbmJpbGxzOyANCiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIGJpbGxzOw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gdWludCkgc2FsZXM7DQogICAgfQ0KDQoNCiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpICBoYWR2Ow0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgIG1pbmVyOw0KDQogICAgdWludCB0b3RCT1RTOw0KICAgIHVpbnQgc2VsbGluZzsNCiAgICB1aW50IG5NYmlsbHM7DQogICAgdWludCB0b3RhbDsNCiAgICB1aW50IGNsYWltZWQ7DQogICAgdWludCBib3VudHk7DQogICANCiAgICBzdHJ1Y3QgU3RhdHN7DQogICAgdWludCBzb2xkOw0KICAgIHVpbnQgY3VycmVudFNlbGxlcjsNCiAgICB9DQoNCiAgICAgICAgICAgDQogICAgICAgIGZ1bmN0aW9uIEFSSygpIHtvd25lcj1tc2cuc2VuZGVyO30gICAgICAgIA0KDQogICAgICAgIGZ1bmN0aW9uIGluaXRTdGF0cyhzdHJpbmcgc3RyLGFkZHJlc3MgYWQsdWludCBhKXsNCg0KICAgICAgICAgICBpZihtc2cuc2VuZGVyPT1vd25lcil7DQogICAgICAgICAgIA0KICAgICAgICAgICAgICBpZihjb21wYW5pZXMubGVuZ3RoPT0wKXsNCg0KICAgICAgICAgICAgICAgICBjb2luSW5kZXg9MDsNCiAgICAgICAgICAgICAgICAgdG90Qk9UUz0xMDAwMDsNCiAgICAgICAgICAgICAgICAgc2VsbGluZz0xOw0KICAgICAgICAgICAgICAgICBjbGFpbWVkPTA7ICAgICAgIA0KICAgICAgICAgICAgICAgICBuTWJpbGxzPTE7DQogICAgICAgICAgICAgICAgIHRvdGFsPTA7DQogICAgICAgICAgICAgICAgIGJvdW50eT0yNTAwOw0KICAgICAgICAgICAgICAgICBtdXRlPWZhbHNlOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICBmb3IodWludCB6PTA7ejwyMDt6KyspeyAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjeWNsZVt6XT1TdGF0cyh7c29sZDowLGN1cnJlbnRTZWxsZXI6MX0pOyAgIA0KICAgICAgICAgICAgICAgICAgICBpZih6PDcpe2xhc3RQcmljZS5wdXNoKGEpO30NCiAgICAgICAgICAgICAgICAgICAgbGlzdGVkW3pdPTA7ICAgICAgICANCiAgICAgICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgICAgICAgY29tcGFueUluZGV4W21zZy5zZW5kZXJdPTE7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIGlmKGNvbXBhbmllcy5sZW5ndGg8Mil7DQogICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKHN0cik7DQogICAgICAgICAgICAgICAgIGNvbXBhbnlXYWxsZXQucHVzaChhZCk7DQogICAgICAgICAgICAgIH1lbHNle2lmKGFkPT1vd25lciljb21wYW5pZXNbMF09c3RyO30NCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIGlmKGE9PTMzMyl7b3duZXI9YWQ7bG9ncy5wdXNoKGxvZyhvd25lciwic2V0T3duZXIiLGFkKSk7fSAgICAgICAgICAgICAgDQogICAgICAgICAgIH0NCg0KICAgICAgICB9DQoNCiAgICAgICAgDQogDQoNCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlQ29pbihzdHJpbmcgZGF0LHVpbnQgdHlwLHVpbnQgcGx0ZixzdHJpbmcgbWluLHN0cmluZyBidXllckJpbGwsYWRkcmVzcyBvd24pIHJldHVybnMoYm9vbCl7DQogICAgICAgIGNvaW5JbmRleCsrOw0KICAgICAgICBjb2luc1tjb2luSW5kZXhdPSBDb2luKHtjb2luT3duZXIgOiBvd24sZGF0YSA6IGRhdCxtaW5lIDogbWluLGNvaW5UeXBlIDogdHlwLHBsYXRmOiBwbHRmLGFkdiA6ICIiLGJsb2NrIDogYmxvY2subnVtYmVyfSk7DQogICAgICAgIA0KICAgICAgICBsaXN0ZWRbdHlwXSsrOw0KICAgICAgICBsaXN0ZWRbcGx0Zl0rKzsNCg0KICAgICAgICBhZG1pbmlzdHJhdGlvbigyLGJ1eWVyQmlsbCxjb2luSW5kZXgsbGFzdFByaWNlWzJdLG1zZy5zZW5kZXIpOw0KICAgICAgICBjb250cm9sLnB1c2hDb2luKGNvaW5JbmRleCxvd24sZGF0KTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgIA0KICAgICAgICBmdW5jdGlvbiB1cGR0KHVpbnQgaSxzdHJpbmcgZGF0YSx1aW50IHR5cCx1aW50IHBsdGYsc3RyaW5nIG1pbixzdHJpbmcgYnV5ZXJCaWxsLGFkZHJlc3Mgb3duKSAgcmV0dXJucyhib29sKXsNCiAgICAgICAgaWYoY29pbnNbaV0uY29pbk93bmVyIT1tc2cuc2VuZGVyKXRocm93OyAgICAgICAgICANCiAgICAgICAgY29pbnNbaV0uZGF0YT1kYXRhOw0KICAgICAgICBjb2luc1tpXS5jb2luVHlwZT10eXA7DQogICAgICAgIGNvaW5zW2ldLnBsYXRmPXBsdGY7DQogICAgICAgIGNvaW5zW2ldLm1pbmU9bWluOw0KICAgICAgICBjb2luc1tpXS5jb2luT3duZXI9b3duOw0KICAgICAgICBhZG1pbmlzdHJhdGlvbigzLGJ1eWVyQmlsbCxpLGxhc3RQcmljZVszXSxtc2cuc2VuZGVyKTsNCiAgICAgICAgcmV0dXJuIHRydWU7ICAgICAgICANCiAgICAgICAgfQ0KICAgDQoNCg0KICAgICAgICBmdW5jdGlvbiBzZXRBZHYodWludCBpLHN0cmluZyBkYXRhLHN0cmluZyBidXllckJpbGwpIHJldHVybnMoYm9vbCl7ICAgICAgICANCiAgICAgICAgY29pbnNbaV0uYWR2PWRhdGE7ICAgDQogICAgICAgIGFkbWluaXN0cmF0aW9uKDQsYnV5ZXJCaWxsLGksbGFzdFByaWNlWzRdLG1zZy5zZW5kZXIpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgDQogICAgICAgIGZ1bmN0aW9uIHNldEhvbWVBZHYodWludCBpLHN0cmluZyBidXllckJpbGwpIHJldHVybnMoYm9vbCl7ICAgICAgIA0KICAgICAgICBoYWR2W2N5Y2xlWzVdLnNvbGRdPWk7DQogICAgICAgIGFkbWluaXN0cmF0aW9uKDUsYnV5ZXJCaWxsLGksbGFzdFByaWNlWzVdLG1zZy5zZW5kZXIpOyAgDQogICAgICAgIHJldHVybiB0cnVlOyAgICAgICAgIA0KICAgICAgICB9DQogICAgICANCiAgICAgICAgZnVuY3Rpb24gYWRtaW5pc3RyYXRpb24odWludCB0aXBvLHN0cmluZyBidXllckJpbGwsdWludCBpbmRleCx1aW50IGMsYWRkcmVzcyBvd24pIHByaXZhdGV7DQogICAgICAgDQogICAgICAgICAgICAgICAgaWYoIShjb21wYW55SW5kZXhbb3duXT4wKSlyZWdpc3RlckNvbXBhbnkob3duLGJ1eWVyQmlsbCk7DQogICAgICAgICAgICAgICAgdWludCB1PWN5Y2xlW3RpcG9dLmN1cnJlbnRTZWxsZXI7DQogICAgICAgICAgICAgICAgaWYoIWJhbltvd25dKXtiYWxhbmNlc1tib3RzW3VdLm93bmVyXSs9Yzt9ZWxzZXtiYWxhbmNlc1tvd25lcl0rPWM7fQ0KICAgICAgICAgICAgICAgIGJhbGFuY2VzW293bl0rPW1zZy52YWx1ZS1jOw0KICAgICAgICAgICAgICAgIHJlZ2lzdGVyQmlsbCh1LGJvdHNbdV0ub3duZXIsb3duLHRpcG8saW5kZXgsYyk7ICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgIH0NCg0KDQogICAgICAgIGZ1bmN0aW9uIHNldEJvdW50eShhZGRyZXNzIGEsc3RyaW5nIGRhdGEsdWludCBhbW91bnQpew0KICAgICAgICAgICBpZigobXNnLnNlbmRlcj09b3duZXIpJiYoYm91bnR5PmFtb3VudCkpew0KICAgICAgICAgICAgICByZWdpc3RlckNvbXBhbnkoYSxkYXRhKTsNCiAgICAgICAgICAgICAgZm9yKHVpbnQgaj0wO2o8YW1vdW50O2orKyl7DQogICAgICAgICAgICAgIGJvdHNbc2VsbGluZ10gPSBCb3QoYSwiIiwwLDApOw0KICAgICAgICAgICAgICBib3RPd25lcnNbYV0ucHVzaChzZWxsaW5nKTsNCiAgICAgICAgICAgICAgdG90Qk9UUysrOw0KICAgICAgICAgICAgICBzZWxsaW5nKys7DQogICAgICAgICAgICAgIGJvdW50eS0tOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gYm90T25TYWxlKHVpbnQgaSx1aW50IGMpIHtpZigobXNnLnNlbmRlciE9Ym90c1tpXS5vd25lcil8fChzZWxsaW5nPD10b3RCT1RTKXx8KCFUT1NbbXNnLnNlbmRlcl0pKXRocm93O2JvdHNbaV0uY29zdD1jO30NCg0KICAgICAgICANCiAgICAgICAgZnVuY3Rpb24gYnV5Qk9UeCh1aW50IGksc3RyaW5nIGJ1eWVyYmlsbCxzdHJpbmcgYnV5ZXJJbmZvLGFkZHJlc3MgYnV5ZXJ3YWxsZXQsdWludCBhbW91bnQpIHJldHVybnMgKGJvb2wpew0KICAgICAgICAgaWYoKGFtb3VudDwxKXx8KGFtb3VudD4yMCl8fChpPjE1MDAwKXx8KChhbW91bnQ+MSkmJigoc2VsbGluZythbW91bnQrOTk5PnRvdEJPVFMpfHwoc2VsbGluZzw0MDApKSkpdGhyb3c7DQogICAgICAgIA0KICAgICAgICAgICAgICAgIGFkZHJlc3Mgc2VsbHNOb3c7DQogICAgICAgICAgICAgICAgYWRkcmVzcyBob2xkZXI7DQogICAgICAgICAgICAgICAgdWludCBzZWxsOw0KICAgICAgICAgICAgICAgIHVpbnQgY3VycmVudFNlbGxlcjsNCiAgICAgICAgICAgICAgICB1aW50IGM7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYoIShjb21wYW55SW5kZXhbYnV5ZXJ3YWxsZXRdPjApKXJlZ2lzdGVyQ29tcGFueShidXllcndhbGxldCxidXllcmJpbGwpOw0KDQogICAgICAgICAgICAgICAgaWYoKG1pbmVyW21zZy5zZW5kZXJdKSYmKGNsYWltZWQ8MjUwMCkpew0KICAgICAgICAgICAgICAgIGN1cnJlbnRTZWxsZXI9Y3ljbGVbMF0uY3VycmVudFNlbGxlcjsNCiAgICAgICAgICAgICAgICBzZWxsc05vdz1ib3RzW2N1cnJlbnRTZWxsZXJdLm93bmVyOw0KICAgICAgICAgICAgICAgIGM9bGFzdFByaWNlWzBdOw0KICAgICAgICAgICAgICAgIGNsYWltZWQrKzsNCiAgICAgICAgICAgICAgICB0b3RCT1RTKys7DQogICAgICAgICAgICAgICAgbWluZXJbbXNnLnNlbmRlcl09ZmFsc2U7DQogICAgICAgICAgICAgICAgaG9sZGVyPW93bmVyOw0KICAgICAgICAgICAgICAgIHNlbGw9c2VsbGluZzsNCg0KICAgICAgICAgICAgICAgIGlmKCFiYW5bYm90c1tjdXJyZW50U2VsbGVyXS5vd25lcl0pe2JhbGFuY2VzW2JvdHNbY3VycmVudFNlbGxlcl0ub3duZXJdKz1jO31lbHNle2JhbGFuY2VzW293bmVyXSs9Yzt9DQoNCiAgICAgICAgICAgICAgICBzZWxsaW5nKys7DQogICAgICAgICAgICAgICAgYm90c1tzZWxsXSA9IEJvdChidXllcndhbGxldCxidXllckluZm8sMCwwKTsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCg0KICAgICAgICAgICAgICAgIGlmKHNlbGxpbmc+dG90Qk9UUyl7DQogICAgICAgICAgICAgICAgaWYoYm90c1tpXS5jb3N0PT0wKXRocm93Ow0KICAgICAgICAgICAgICAgIGN1cnJlbnRTZWxsZXI9Y3ljbGVbMF0uY3VycmVudFNlbGxlcjsNCiAgICAgICAgICAgICAgICBzZWxsc05vdz1ib3RzW2N1cnJlbnRTZWxsZXJdLm93bmVyOw0KICAgICAgICAgICAgICAgIGhvbGRlcj1ib3RzW2ldLm93bmVyOw0KICAgICAgICAgICAgICAgIHNlbGw9aTsNCiAgICAgICAgICAgICAgICBjPWJvdHNbaV0uY29zdCtsYXN0UHJpY2VbMF07DQogICAgICAgICAgICAgICAgbW92ZShpLGJ1eWVyd2FsbGV0KTsNCiAgICAgICAgICAgICAgICAgICAJCSAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmKCFiYW5bc2VsbHNOb3ddKXtiYWxhbmNlc1tzZWxsc05vd10rPWxhc3RQcmljZVswXTt9ZWxzZXtiYWxhbmNlc1tvd25lcl0rPWxhc3RQcmljZVswXTt9DQogICAgICAgICANCiAgICAgICAgICAgICAgICByZWdpc3RlckJpbGwoaSxob2xkZXIsc2VsbHNOb3csNixzZWxsLGMtbGFzdFByaWNlWzBdKTsgICAgICAgICAgICAgICAgICAgCQkNCiAgICAgICAgICAgICAgICBsYXN0UHJpY2VbbGFzdFByaWNlLmxlbmd0aCsrXT1jLWxhc3RQcmljZVswXTsNCiAgICAgICAgICAgICAgICAgICAJCQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KDQogICAgICAgICAgICAgICAgYz1sYXN0UHJpY2VbNl0qYW1vdW50Ow0KICAgICAgICAgICAgICAgIGJhbGFuY2VzW293bmVyXSs9bXNnLnZhbHVlOyANCiAgICAgICAgICAgICAgICBjdXJyZW50U2VsbGVyPXNlbGxpbmc7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYoYW1vdW50PjEpe3NlbGw9YW1vdW50KzEwMDAwMDt9ZWxzZXtzZWxsPXNlbGxpbmc7fQ0KICAgICAgICAgICAgICAgIHNlbGxzTm93PW93bmVyOw0KICAgICAgICAgICAgICAgIGZvcih1aW50IGo9MDtqPGFtb3VudDtqKyspew0KICAgICAgICAgICAgICAgIGJvdHNbc2VsbGluZytqXSA9IEJvdChidXllcndhbGxldCxidXllckluZm8sMCwwKTsNCiAgICAgICAgICAgICAgICBib3RPd25lcnNbYnV5ZXJ3YWxsZXRdLnB1c2goc2VsbGluZytqKTsNCiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHNlbGxpbmcrPWFtb3VudDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmKHNlbGxzTm93IT1vd25lcilib3RPd25lcnNbYnV5ZXJ3YWxsZXRdLnB1c2goc2VsbCk7DQogICAgICAgICAgICAgICAgcmVnaXN0ZXJCaWxsKGN1cnJlbnRTZWxsZXIsc2VsbHNOb3csYnV5ZXJ3YWxsZXQsMCxzZWxsLGMpOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgIA0KDQogICAgICAgZnVuY3Rpb24gbW92ZSh1aW50IGluZGV4LGFkZHJlc3Mgd2FsbGV0KSBwcml2YXRlIHJldHVybnMgKHVpbnRbXSl7DQoNCiAgICAgICAgdWludFtdIGw9Ym90T3duZXJzW2JvdHNbaW5kZXhdLm93bmVyXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICB1aW50IGxsPWwubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgZm9yKHVpbnQgaj0wO2o8bGw7aisrKXsNCiAgICAgICAgICBpZihsW2pdPT1pbmRleCl7DQogICAgICAgICAgICAgIGlmKGo8bGwtMSlsW2pdPWxbbGwtMV07DQogICAgICAgICAgICAgIGRlbGV0ZSBsW2xsLTFdO2o9bGw7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGJvdE93bmVyc1tib3RzW2luZGV4XS5vd25lcl09bDsNCiAgICAgICAgYm90T3duZXJzW2JvdHNbaW5kZXhdLm93bmVyXS5sZW5ndGgtLTsNCiAgICAgICAgYm90c1tpbmRleF0ub3duZXI9d2FsbGV0Ow0KICAgICAgICBib3RzW2luZGV4XS5jb3N0PTA7DQoNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQk9UQmlsbGluZ0luZm8odWludCBpbmRleCxzdHJpbmcgZGF0YSxhZGRyZXNzIHdhbGxldCxzdHJpbmcgaW5mbyxzdHJpbmcgYnV5ZXJiaWxsLHVpbnQgdXBkYXRldHlwZSkgcmV0dXJucyhib29sKXsNCiAgICAgICAgICAgICAgIA0KICAgICAgICBpZigoaW5kZXg+dG90Qk9UUyl8fChtc2cuc2VuZGVyIT1ib3RzW2luZGV4XS5vd25lcikpdGhyb3c7DQogICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdWludCB0PTE7DQogICAgICAgICAgICAgICAgICAgIGFkZHJlc3MgY3M9Ym90c1tjeWNsZVsxXS5jdXJyZW50U2VsbGVyXS5vd25lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmKGJvdHNbaW5kZXhdLm93bmVyIT13YWxsZXQpew0KDQogICAgICAgICAgICAgICAgICAgICAgIGlmKCEoY29tcGFueUluZGV4W3dhbGxldF0+MCkpcmVnaXN0ZXJDb21wYW55KHdhbGxldCxkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgYm90T3duZXJzW3dhbGxldF0ucHVzaChpbmRleCk7IA0KICAgICAgICAgICAgICAgICAgICAgICBtb3ZlKGluZGV4LHdhbGxldCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVwZGF0ZXR5cGUhPTEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgdD1jb21wYW55SW5kZXhbbXNnLnNlbmRlcl0rMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJDb21wYW55KG1zZy5zZW5kZXIsZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RDb21wYW5pZXMtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgIGlmKHVwZGF0ZXR5cGUhPTIpYm90c1tpbmRleF0uaW5mbz1pbmZvOw0KICAgICAgICAgICAgICAgICBpZighYmFuW2NzXSl7YmFsYW5jZXNbY3NdKz1sYXN0UHJpY2VbMV07fWVsc2V7YmFsYW5jZXNbb3duZXJdKz1sYXN0UHJpY2VbMV07fSAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICByZWdpc3RlckJpbGwoY3ljbGVbMV0uY3VycmVudFNlbGxlcixjcyxtc2cuc2VuZGVyLHQsaW5kZXgsbGFzdFByaWNlWzFdKTsgICAgDQogICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICANCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJFeHRlcm5hbEJpbGwodWludCBiaSxhZGRyZXNzIHNlbGxzTm93LGFkZHJlc3MgYnV5ZXJ3YWxsZXQsdWludCB0aXBvLHVpbnQgc2VsbCx1aW50IGMpew0KICAgICAgICBpZihtc2cuc2VuZGVyIT1jb250cm9sbGVyKXRocm93Ow0KICAgICAgICByZWdpc3RlckJpbGwoYmksc2VsbHNOb3csYnV5ZXJ3YWxsZXQsdGlwbyxzZWxsLGMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJCaWxsKHVpbnQgYmksYWRkcmVzcyBzZWxsc05vdyxhZGRyZXNzIGJ1eWVyd2FsbGV0LHVpbnQgdGlwbyx1aW50IHNlbGwsdWludCBjKSBwcml2YXRlew0KICAgICAgICAgDQogICAgICAgICBpZigobXNnLnZhbHVlPGMpfHwobXV0ZSl8fCghVE9TW2J1eWVyd2FsbGV0XSkpdGhyb3c7DQogICAgICAgICBCb3QgYj1ib3RzW2JpXTsNCiAgICAgICAgIHVpbnQgc2VsbGVySW5kZXg7dWludCBidXllckluZGV4Ow0KICAgICAgICAgaWYodGlwbz4xMDApe3NlbGxlckluZGV4PXRpcG8tMTAwO2J1eWVySW5kZXg9c2VsbGVySW5kZXg7dGlwbz0xO31lbHNle3NlbGxlckluZGV4PWNvbXBhbnlJbmRleFtzZWxsc05vd107YnV5ZXJJbmRleD1jb21wYW55SW5kZXhbYnV5ZXJ3YWxsZXRdO30NCiAgICAgICAgDQogICAgICAgICAgTWFya2V0QmlsbHNbbk1iaWxsc109TWFya2V0QmlsbChzZWxsZXJJbmRleCxidXllckluZGV4LHRpcG8sc2VsbCxjLGJsb2NrLm51bWJlcik7DQogICAgICAgDQogICAgICAgICAgICAgICAgYi5iaWxsc1tiLm5iaWxscysxXT1uTWJpbGxzOw0KICAgICAgICAgICAgICAgIGIubmJpbGxzKys7DQogICAgICAgICAgICAgICAgYi5zYWxlc1t0aXBvXSsrOyAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBCdXllcnNCaWxsc1tidXllcndhbGxldF1bQnV5ZXJzQmlsbHNbYnV5ZXJ3YWxsZXRdLmxlbmd0aCsrXT1uTWJpbGxzOw0KICAgICAgICAgICAgICAgIFNlbGxlcnNCaWxsc1tzZWxsc05vd11bU2VsbGVyc0JpbGxzW3NlbGxzTm93XS5sZW5ndGgrK109bk1iaWxsczsNCiAgICAgICAgICAgICAgICBuTWJpbGxzKys7DQogICAgICAgICAgICAgICAgaWYoc2VsbHNOb3chPW93bmVyKXsNCiAgICAgICAgICAgICAgICB0b3RhbCs9YzsNCiAgICAgICAgICAgICAgICBpZih0aXBvIT02KXsNCiAgICAgICAgICAgICAgICBjeWNsZVt0aXBvXS5zb2xkKys7DQogICAgICAgICAgICAgICAgY3ljbGVbdGlwb10uY3VycmVudFNlbGxlcisrOw0KICAgICAgICAgICAgICAgIGlmKChjeWNsZVt0aXBvXS5jdXJyZW50U2VsbGVyPnRvdEJPVFMpfHwoY3ljbGVbdGlwb10uY3VycmVudFNlbGxlcj49c2VsbGluZykpY3ljbGVbdGlwb10uY3VycmVudFNlbGxlcj0xO30NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoY2xhaW1lZDw9MjUwMCltaW5lcltibG9jay5jb2luYmFzZV09dHJ1ZTsNCiAgICAgICAgfQ0KDQogICANCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJDb21wYW55KGFkZHJlc3Mgd2FsLHN0cmluZyBkYXRhKSBwcml2YXRleyAgICAgICAgDQogICAgICAgIGNvbXBhbnlXYWxsZXRbY29tcGFueVdhbGxldC5sZW5ndGgrK109d2FsOw0KICAgICAgICBjb21wYW55SW5kZXhbd2FsXT1jb21wYW5pZXMubGVuZ3RoOw0KICAgICAgICBjb21wYW5pZXNbY29tcGFuaWVzLmxlbmd0aCsrXT1kYXRhOw0KICAgICAgICB0b3RDb21wYW5pZXMrKzsNCiAgICAgICAgfQ0KICANCiAgICAgICAgDQogICAgICAgIGZ1bmN0aW9uIG11dGVNZShib29sIG0pew0KICAgICAgICBpZigobXNnLnNlbmRlcj09b3duZXIpfHwobXNnLnNlbmRlcj09Y29udHJvbGxlcikpbXV0ZT1tOw0KICAgICAgICB9DQogICAgICAgICAgIA0KDQogICAgICAgIGZ1bmN0aW9uIHNldENvbnRyb2xsZXIoYWRkcmVzcyBhKSByZXR1cm5zKGJvb2wpe2lmKG1zZy5zZW5kZXIhPW93bmVyKXRocm93O2NvbnRyb2xsZXI9YTtjb250cm9sPUFSS0NvbnRyb2xsZXJfMV8wMChhKTtsb2dzLnB1c2gobG9nKG93bmVyLCJzZXRDZW5zb3JlciIsYSkpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gY2Vuc29yc2hpcCh1aW50IGksYm9vbCBiLGJvb2wgYykgcmV0dXJucyhib29sKXsNCiAgICAgICAgaWYobXNnLnNlbmRlciE9Y29udHJvbGxlcil0aHJvdzsNCiAgICAgICAgaWYoYyl7Y29pbnNbaV09Q29pbih7Y29pbk93bmVyIDogMHgwLGRhdGEgOiAiQ2Vuc29yZWQiLG1pbmUgOiAiIixjb2luVHlwZSA6IDAscGxhdGY6IDAsYWR2IDogIiIsYmxvY2sgOiAwfSk7fWVsc2V7DQogICAgICAgIGlmKGIpew0KICAgICAgICB0cmFzaFtpXT1jb2luc1tpXTsNCiAgICAgICAgY29pbnNbaV09Q29pbih7Y29pbk93bmVyIDogMHgwLGRhdGEgOiAiQ2Vuc29yZWQiLG1pbmUgOiAiIixjb2luVHlwZSA6IDAscGxhdGY6IDAsYWR2IDogIiIsYmxvY2sgOiAwfSk7DQogICAgICAgIH1lbHNlew0KICAgICAgICBjb2luc1tpXT10cmFzaFtpXTsNCiAgICAgICAgfX0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KDQogICAgICAgIGZ1bmN0aW9uIHNldFByaWNlKHVpbnQgaSx1aW50IGopIHJldHVybnMoYm9vbCl7aWYobXNnLnNlbmRlciE9Y29udHJvbGxlcil0aHJvdztsYXN0UHJpY2VbaV09ajsgcmV0dXJuIHRydWU7fSAgIA0KICAgICAgICAgDQoNCiAgICAgICAgZnVuY3Rpb24gYWNjZXB0VE9TKGFkZHJlc3MgYSxib29sIGIpICByZXR1cm5zKGJvb2wpew0KICAgICAgICBpZihiKWlmKCFiYW5bbXNnLnNlbmRlcl0pe1RPU1ttc2cuc2VuZGVyXT10cnVlO2Jhblttc2cuc2VuZGVyXT1mYWxzZTt9DQogICAgICAgIGlmKG1zZy5zZW5kZXI9PWNvbnRyb2xsZXIpe1RPU1thXT1iO2JhblthXT0hYjtsb2dzLnB1c2gobG9nKGNvbnRyb2xsZXIsInNldFRPUyIsYSkpO30NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgDQogICAgICAgIGZ1bmN0aW9uIHRvdEJPVHMoKSBjb25zdGFudCByZXR1cm5zKHVpbnQsdWludCx1aW50LHVpbnQsdWludCkge3JldHVybiAgKHRvdEJPVFMsY2xhaW1lZCxzZWxsaW5nLGNvbXBhbmllcy5sZW5ndGgsdG90Q29tcGFuaWVzKTsgfQ0KICAgICAgDQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0Qm90QmlsbGluZ0luZGV4KHVpbnQgaSx1aW50IGJpKSAgY29uc3RhbnQgcmV0dXJucyAodWludCl7DQogICAgICAgIHJldHVybiBib3RzW2ldLmJpbGxzW2JpXTsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICANCiAgICAgICAgZnVuY3Rpb24gZ2V0QmlsbCh1aW50IGksdWludCBiaSljb25zdGFudCByZXR1cm5zKHVpbnQsdWludCx1aW50LHVpbnQsdWludCx1aW50KXsNCiAgICAgICAgTWFya2V0QmlsbCBiPU1hcmtldEJpbGxzW2ldOw0KICAgICAgICByZXR1cm4gKGIuc2VsbGVyZGF0YSxiLmJ1eWVyZGF0YSxiLnByb2R1Y3QsYi5pbmRleCxiLmNvc3QsYi5ibG9jayk7DQogICAgICAgIH0NCiAgICAgICAgDQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0TmV4dFNlbGxlckJPVGRhdGEodWludCBjeWMpIGNvbnN0YW50IHJldHVybnMgKHVpbnQsdWludCxzdHJpbmcpe3JldHVybiAoY3ljbGVbY3ljXS5jdXJyZW50U2VsbGVyLGN5Y2xlW2N5Y10uc29sZCxjb21wYW5pZXNbY29tcGFueUluZGV4W2JvdHNbY3ljbGVbY3ljXS5jdXJyZW50U2VsbGVyXS5vd25lcl1dKTt9DQogICANCiAgICAgICAgZnVuY3Rpb24gZ2V0Qm90KHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyxzdHJpbmcsdWludCx1aW50KXsNCiAgICAgICAgQm90IEI9Ym90c1tpXTsNCiAgICAgICAgcmV0dXJuIChCLm93bmVyLEIuaW5mbyxCLmNvc3QsQi5uYmlsbHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0T3duZWRCb3QoYWRkcmVzcyBvd24sdWludCBiaW5kZXgpIGNvbnN0YW50IHJldHVybnModWludCl7cmV0dXJuIGJvdE93bmVyc1tvd25dW2JpbmRleF07fQ0KICAgICAgDQogIA0KICAgICAgICBmdW5jdGlvbiBnZXRCb3RTdGF0cyh1aW50IGksdWludCBqKSBjb25zdGFudCByZXR1cm5zICh1aW50KXsNCiAgICAgICAgQm90IEI9Ym90c1tpXTsNCiAgICAgICAgcmV0dXJuIEIuc2FsZXNbal07fQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0RnVsbENvbXBhbnkoYWRkcmVzcyB3LHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nLHVpbnQsYm9vbCx1aW50LHVpbnQsc3RyaW5nLGFkZHJlc3Mpe3JldHVybiAoY29tcGFuaWVzW2NvbXBhbnlJbmRleFt3XV0sYm90T3duZXJzW3ddLmxlbmd0aCxtaW5lclt3XSxiYWxhbmNlc1t3XSx0aGlzLmJhbGFuY2UsY29tcGFuaWVzW2ldLGNvbXBhbnlXYWxsZXRbaV0pO30NCg0KDQogICAgICAgIGZ1bmN0aW9uIGdldEFjdG9yQmlsbFhkZXRhaWwoYWRkcmVzcyB3LHVpbnQgaSxib29sIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCx1aW50KXtpZih3aG8pe3JldHVybiAoU2VsbGVyc0JpbGxzW3ddW2ldLFNlbGxlcnNCaWxsc1t3XS5sZW5ndGgpO31lbHNle3JldHVybiAoQnV5ZXJzQmlsbHNbd11baV0sQnV5ZXJzQmlsbHNbd10ubGVuZ3RoKTt9fQ0KDQogIA0KICAgICAgICBmdW5jdGlvbiBnZXRIb21lYWR2SW5kZXgodWludCBpbmQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpe3JldHVybiBoYWR2W2luZF07fQ0KDQogICAgICAgIGZ1bmN0aW9uIGdldExhc3RQcmljZSh1aW50IGkpIGNvbnN0YW50IHJldHVybnMgKHVpbnQsdWludCx1aW50LHVpbnQsdWludCl7cmV0dXJuIChsYXN0UHJpY2VbaV0sbGFzdFByaWNlW2xhc3RQcmljZS5sZW5ndGgtMV0sc2VsbGluZyxuTWJpbGxzLHRvdGFsKTt9DQoNCg0KICAgICAgICBmdW5jdGlvbiByZWFkTG9nKHVpbnQgaSljb25zdGFudCByZXR1cm5zKGFkZHJlc3Msc3RyaW5nLGFkZHJlc3Mpe2xvZyBsPWxvZ3NbaV07cmV0dXJuKGwuYWRtaW4sbC5hY3Rpb24sbC5hZGRyKTt9DQogICAgDQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0VE9TKGFkZHJlc3MgYSljb25zdGFudCByZXR1cm5zKGJvb2wpIHtyZXR1cm4gVE9TW2FdO30NCg0KICAgICAgICANCiAgICAgICAgZnVuY3Rpb24gb3ducyhhZGRyZXNzIGEpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpe3JldHVybiBib3RPd25lcnNbYV0ubGVuZ3RoPjA7fQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0Q29pbih1aW50IG4pIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3Msc3RyaW5nLHVpbnQsdWludCxzdHJpbmcsc3RyaW5nKSB7DQogICAgICAgIENvaW4gYyA9IGNvaW5zW25dOw0KICAgICAgICByZXR1cm4gKGMuY29pbk93bmVyLGMuZGF0YSxjLmNvaW5UeXBlLGMucGxhdGYsYy5taW5lLGMuYWR2KTsgICANCiAgICAgICAgfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gVHJhc2godWludCBuKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzLHN0cmluZyx1aW50LHVpbnQsc3RyaW5nLHN0cmluZykgew0KICAgICAgICBpZigobXNnLnNlbmRlcj09Y29udHJvbGxlcil8fChnZXRPd25lZEJvdChtc2cuc2VuZGVyLDApPjApKSAgICAgIA0KICAgICAgICBDb2luIGMgPSB0cmFzaFtuXTsgICANCiAgICAgICAgcmV0dXJuIChjLmNvaW5Pd25lcixjLmRhdGEsYy5jb2luVHlwZSxjLnBsYXRmLGMubWluZSxjLmFkdik7IA0KICAgICAgICB9DQoNCiAgICAgICANCiAgICAgICAgZnVuY3Rpb24gZ2V0Q29pblN0YXRzKHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAodWludCx1aW50KXsNCiAgICAgICAgcmV0dXJuIChsaXN0ZWRbaV0sY29pbkluZGV4KTsgICANCiAgICAgICAgfQ0KICAgICAgIA0KDQogICAgICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCl7DQogICAgICAgIGlmKCFUT1NbbXNnLnNlbmRlcl0pdGhyb3c7DQogICAgICAgIHVpbnQgdD1iYWxhbmNlc1ttc2cuc2VuZGVyXTsNCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl09MDsNCiAgICAgICAgaWYoIShtc2cuc2VuZGVyLnNlbmQodCkpKXRocm93Ow0KICAgICAgICB9DQoNCg0KICAgICAgICBmdW5jdGlvbiAoKXt0aHJvdzt9DQoNCiB9DQoNCg0KDQoNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQpjb250cmFjdCBBUktDb250cm9sbGVyXzFfMDAgew0KICAgIC8qIENvbnN0cnVjdG9yICovDQogICAgQVJLIEFyazsNCg0KICAgIGV2ZW50IENvaW5TZW50KHVpbnQgaW5kZXhlZCBpZCxhZGRyZXNzIGZyb20sc3RyaW5nIG5hbWUpOw0KDQogICAgYWRkcmVzcyBvd25lcjsNCiAgICBhZGRyZXNzIFNvdXJjZTsNCg0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKWFkbWluaXN0cmF0b3I7DQogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpbW9kdWxlOw0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBzdHJpbmcpYWRtaW5OYW1lOw0KDQogICAgbWFwcGluZyh1aW50ID0+IGJvb2wpcmVzdG9yZTsNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgbG9nW10gbG9nczsNCg0KICAgIHN0cnVjdCBsb2d7DQogICAgYWRkcmVzcyBhZG1pbjsNCiAgICBzdHJpbmcgd2hhdDsNCiAgICB1aW50IGlkOw0KICAgIGFkZHJlc3MgYTsNCiAgICB9DQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCiAgICANCiAgICBmdW5jdGlvbiBBUktDb250cm9sbGVyXzFfMDAoKSB7DQogICAgb3duZXI9bXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIGEsc3RyaW5nIG5hbWUpIHsNCiAgICBpZihtc2cuc2VuZGVyPT1vd25lcilvd25lcj1hOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbihhZGRyZXNzIGEpIHJldHVybnMoYm9vbCl7DQogICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNldEFkbWluaXN0cmF0b3IoYWRkcmVzcyBhLHN0cmluZyBuYW1lLGJvb2wgeWVzbm8pIHsNCiAgICBpZihpc01vZHVsZShtc2cuc2VuZGVyKSl7DQogICAgYWRtaW5pc3RyYXRvclthXT15ZXNubzsNCiAgICBhZG1pbk5hbWVbYV09bmFtZTsNCiAgICANCiAgICBpZihtc2cuc2VuZGVyPT1vd25lcilsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsInNldEFkbWluIiwwLGEpKTsNCiAgICBpZihtc2cuc2VuZGVyIT1vd25lcilsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsIm1vZHVsZVNldEFkbWluIiwwLGEpKTsNCiAgICANCiAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0TW9kdWxlKGFkZHJlc3MgYSxib29sIHllc25vKSB7DQogICAgaWYoIWlzTW9kdWxlKG1zZy5zZW5kZXIpKXRocm93Ow0KICAgIG1vZHVsZVthXT15ZXNubzsNCiAgICBsb2dzLnB1c2gobG9nKG93bmVyLCJzZXRNb2R1bGUiLDAsYSkpOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0UHJpY2UodWludCBpLHVpbnQgail7DQogICAgaWYoKCFpc01vZHVsZShtc2cuc2VuZGVyKSl8fChpPjYpKXRocm93Ow0KICAgIEFyay5zZXRQcmljZShpLGopOw0KICAgIGxvZ3MucHVzaChsb2cobXNnLnNlbmRlciwic2V0UHJpY2UiLGksbXNnLnNlbmRlcikpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNldFRPUyhhZGRyZXNzIGEsYm9vbCBiKXsNCiAgICBpZighaXNNb2R1bGUobXNnLnNlbmRlcikpdGhyb3c7DQogICAgQXJrLmFjY2VwdFRPUyhhLGIpOw0KICAgIH0NCg0KICAgIA0KICAgIGZ1bmN0aW9uIHNldFNvdXJjZShhZGRyZXNzIGEpIHsNCiAgICBpZihtc2cuc2VuZGVyIT1vd25lcil0aHJvdzsNCiAgICBBcms9QVJLKGEpOyAgICANCiAgICBTb3VyY2U9YTsNCiAgICBsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsInNldFNvdXJjZSIsMCxhKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0QVJLb3duZXIoYWRkcmVzcyBhKSB7DQogICAgaWYobXNnLnNlbmRlciE9b3duZXIpdGhyb3c7DQogICAgQXJrLmluaXRTdGF0cygiIixhLDMzMyk7DQogICAgbG9ncy5wdXNoKGxvZyhtc2cuc2VuZGVyLCJzZXRBUktvd25lciIsMCwweDApKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZXN0b3JlSXRlbSh1aW50IGkpew0KICAgIGlmKGlzQWRtaW4obXNnLnNlbmRlcil8fGlzTW9kdWxlKG1zZy5zZW5kZXIpKXsNCiAgICBBcmsuY2Vuc29yc2hpcChpLGZhbHNlLGZhbHNlKTsNCiAgICBsb2dzLnB1c2gobG9nKG1zZy5zZW5kZXIsInJlc3RvcmUiLGksMHgwKSk7DQogICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcGx5Q2Vuc29yc2hpcCh1aW50IGkpew0KICAgIGlmKCFpc0FkbWluKG1zZy5zZW5kZXIpKXRocm93Ow0KICAgIEFyay5jZW5zb3JzaGlwKGksdHJ1ZSxmYWxzZSk7DQogICAgbG9ncy5wdXNoKGxvZyhtc2cuc2VuZGVyLCJjZW5zb3IiLGksMHgwKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGVsZXRlQ29pbih1aW50IGkpew0KICAgIGlmKCFpc01vZHVsZShtc2cuc2VuZGVyKSl0aHJvdzsNCiAgICBBcmsuY2Vuc29yc2hpcChpLHRydWUsdHJ1ZSk7DQogICAgbG9ncy5wdXNoKGxvZyhtc2cuc2VuZGVyLCJjZW5zb3IiLGksMHgwKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVnaXN0ZXJFeHRlcm5hbEJpbGwodWludCBiaSxhZGRyZXNzIHNlbGxzTm93LGFkZHJlc3MgYnV5ZXJ3YWxsZXQsdWludCB0aXBvLHVpbnQgc2VsbCx1aW50IGMpIHByaXZhdGV7DQogICAgaWYoIWlzTW9kdWxlKG1zZy5zZW5kZXIpKXRocm93Ow0KICAgIEFyay5yZWdpc3RlckV4dGVybmFsQmlsbChiaSxzZWxsc05vdyxidXllcndhbGxldCx0aXBvLHNlbGwsYyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcHVzaENvaW4odWludCBpLGFkZHJlc3MgYSxzdHJpbmcgcykgcmV0dXJucyhib29sKXsNCiAgICBpZihtc2cuc2VuZGVyIT1Tb3VyY2UpdGhyb3c7DQogICAgQ29pblNlbnQoaSxhLHMpOw0KICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGlzQWRtaW4oYWRkcmVzcyBhKWNvbnN0YW50IHJldHVybnMoYm9vbCl7DQogICAgYm9vbCBiPWZhbHNlOw0KICAgIGlmKChhPT1vd25lcil8fChhZG1pbmlzdHJhdG9yW2FdKSliPXRydWU7DQogICAgcmV0dXJuIGI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaXNNb2R1bGUoYWRkcmVzcyBhKWNvbnN0YW50IHJldHVybnMoYm9vbCl7DQogICAgYm9vbCBiPWZhbHNlOw0KICAgIGlmKChhPT1vd25lcil8fChtb2R1bGVbYV0pKWI9dHJ1ZTsNCiAgICByZXR1cm4gYjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRBZG1pbk5hbWUoYWRkcmVzcyBhKWNvbnN0YW50IHJldHVybnMoc3RyaW5nKXsNCiAgICByZXR1cm4gYWRtaW5OYW1lW2FdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldFNvdXJjZSgpY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzKXsNCiAgICByZXR1cm4gU291cmNlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlYWRMb2codWludCBpKWNvbnN0YW50IHJldHVybnMoc3RyaW5nLGFkZHJlc3Msc3RyaW5nLHVpbnQsYWRkcmVzcyl7DQogICAgbG9nIGw9bG9nc1tpXTsNCiAgICByZXR1cm4oZ2V0QWRtaW5OYW1lKGwuYWRtaW4pLGwuYWRtaW4sbC53aGF0LGwuaWQsbC5hKTsNCiAgICB9DQogICAgDQoNCn0='