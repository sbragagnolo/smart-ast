base 64 content
base64blockjack
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpsaWJyYXJ5IEFycmF5TGliIHsNCiAgLy8gSW5zZXJ0cyB0byBrZWVwIGFycmF5IHNvcnRlZCAoYXNzdW1lcyBpbnB1dCBhcnJheSBpcyBzb3J0ZWQpDQoJZnVuY3Rpb24gaW5zZXJ0SW5QbGFjZSh1aW50OFtdIHN0b3JhZ2Ugc2VsZiwgdWludDggbikgew0KCQl1aW50OCBpbnNlcnRpbmdJbmRleCA9IDA7DQoNCgkJd2hpbGUgKHNlbGYubGVuZ3RoID4gMCAmJiBpbnNlcnRpbmdJbmRleCA8IHNlbGYubGVuZ3RoICYmIHNlbGZbaW5zZXJ0aW5nSW5kZXhdIDwgbikgew0KCQkJaW5zZXJ0aW5nSW5kZXggKz0gMTsNCgkJfQ0KDQoJCXNlbGYubGVuZ3RoICs9IDE7DQoJCWZvciAodWludDggaSA9IHVpbnQ4KHNlbGYubGVuZ3RoKSAtIDE7IGkgPiBpbnNlcnRpbmdJbmRleDsgaS0tKSB7DQoJCQlzZWxmW2ldID0gc2VsZltpIC0gMV07DQoJCX0NCg0KCQlzZWxmW2luc2VydGluZ0luZGV4XSA9IG47DQoJfQ0KfQ0KDQpsaWJyYXJ5IERlY2tMaWIgew0KCXVzaW5nIEFycmF5TGliIGZvciB1aW50OFtdOw0KDQoJZW51bSBTdWl0IHsgU3BhZGVzLCBIZWFydHMsIENsdWJzLCBEaWFtb25kcyB9DQoJdWludDggY29uc3RhbnQgY2FyZHNQZXJTdWl0ID0gMTM7DQoJdWludDggY29uc3RhbnQgc3VpdHMgPSA0Ow0KCXVpbnQ4IGNvbnN0YW50IHRvdGFsQ2FyZHMgPSBjYXJkc1BlclN1aXQgKiBzdWl0czsNCg0KCXN0cnVjdCBEZWNrIHsNCgkJdWludDhbXSB1c2VkQ2FyZHM7IC8vIGFsd2F5cyBoYXMgdG8gYmUgc29ydGVkDQoJCWFkZHJlc3MgcGxheWVyOw0KCQl1aW50MjU2IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBpbml0KERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGdhbWVJRCkgIHsNCgkJc2VsZi51c2VkQ2FyZHMgPSBuZXcgdWludDhbXSgwKTsNCgkJc2VsZi5wbGF5ZXIgPSBtc2cuc2VuZGVyOw0KCQlzZWxmLmdhbWVJRCA9IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBnZXRDYXJkKERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGJsb2NrTnVtYmVyKSAgcmV0dXJucyAodWludDgpICB7DQoJCXVpbnQgY2FyZEluZGV4ID0gc2VsZi51c2VkQ2FyZHMubGVuZ3RoOw0KCQlpZiAoY2FyZEluZGV4ID49IHRvdGFsQ2FyZHMpIHRocm93Ow0KCQl1aW50OCByID0gdWludDgoZ2V0UmFuZG9tTnVtYmVyKGJsb2NrTnVtYmVyLCBzZWxmLnBsYXllciwgc2VsZi5nYW1lSUQsIGNhcmRJbmRleCwgdG90YWxDYXJkcyAtIGNhcmRJbmRleCkpOw0KDQoJCWZvciAodWludDggaSA9IDA7IGkgPCBjYXJkSW5kZXg7IGkrKykgew0KCQkJaWYgKHNlbGYudXNlZENhcmRzW2ldIDw9IHIpIHIgKz0gMTsNCgkJfQ0KDQoJCXNlbGYudXNlZENhcmRzLmluc2VydEluUGxhY2Uocik7DQoNCgkJcmV0dXJuIHI7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZERlc2NyaXB0aW9uKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKFN1aXQsIHVpbnQ4KSB7DQoJCXJldHVybiAoU3VpdChzZWxmIC8gY2FyZHNQZXJTdWl0KSwgY2FyZEZhY2V2YWx1ZShzZWxmKSk7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZEVtb2ppZmllZCh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCwgc3RyaW5nKSB7DQoJCXN0cmluZyBtZW1vcnkgZW1vamlTdWl0Ow0KDQoJCXZhciAoc3VpdCwgbnVtYmVyKSA9IGNhcmREZXNjcmlwdGlvbihzZWxmKTsNCgkJaWYgKHN1aXQgPT0gU3VpdC5DbHVicykgZW1vamlTdWl0ID0gIuKZo++4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5EaWFtb25kcykgZW1vamlTdWl0ID0gIuKZpu+4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5IZWFydHMpIGVtb2ppU3VpdCA9ICLimaXvuI8iOw0KCQllbHNlIGlmIChzdWl0ID09IFN1aXQuU3BhZGVzKSBlbW9qaVN1aXQgPSAi4pmg77iPIjsNCg0KCQlyZXR1cm4gKG51bWJlciwgZW1vamlTdWl0KTsNCgl9DQoNCglmdW5jdGlvbiBjYXJkRmFjZXZhbHVlKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7DQoJCXJldHVybiAxICsgc2VsZiAlIGNhcmRzUGVyU3VpdDsNCgl9DQoNCglmdW5jdGlvbiBibGFja2phY2tWYWx1ZSh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCkgew0KCQl1aW50OCBjYXJkVmFsdWUgPSBjYXJkRmFjZXZhbHVlKHNlbGYpOw0KCQlyZXR1cm4gY2FyZFZhbHVlIDwgMTAgPyBjYXJkVmFsdWUgOiAxMDsNCgl9DQoNCglmdW5jdGlvbiBnZXRSYW5kb21OdW1iZXIodWludCBiLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBnYW1lSUQsIHVpbnQgbiwgdWludCBtKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQoJCS8vIFVzZXMgYmxvY2toYXNoIGFzIHJhbmRvbW5lc3Mgc291cmNlLg0KCQkvLyBDcmVkaXRzOiBodHRwczovL2dpdGh1Yi5jb20vQnVuamluL1JvdWxldGgvYmxvYi9tYXN0ZXIvUHJvdmFibHlfRmFpcl9Ob19DaGVhdGluZy5tZA0KCQlieXRlczMyIGJsb2NrSGFzaCA9IGJsb2NrLmJsb2NraGFzaChiKTsNCgkJaWYgKGJsb2NrSGFzaCA9PSAweDApIHRocm93Ow0KCQlyZXR1cm4gdWludCh1aW50MjU2KGtlY2NhazI1NihibG9ja0hhc2gsIHBsYXllciwgZ2FtZUlELCBuKSkgJSBtKTsNCg0KCX0NCn0NCg0KDQoNCmxpYnJhcnkgR2FtZUxpYiB7DQogIHVzaW5nIERlY2tMaWIgZm9yICo7DQoNCiAgdWludDggY29uc3RhbnQgaG91c2VMaW1pdCA9IDE3Ow0KICB1aW50OCBjb25zdGFudCB0YXJnZXQgPSAyMTsNCg0KICBlbnVtIENvbXBhcmFpc29uUmVzdWx0IHsgRmlyc3QsIFNlY29uZCwgVGllIH0NCiAgZW51bSBHYW1lU3RhdGUgeyBJbml0aWFsQ2FyZHMsIFdhaXRpbmcsIEhpdCwgU3RhbmQsIERvdWJsZURvd24sIEZpbmlzaGVkIH0NCiAgZW51bSBHYW1lUmVzdWx0IHsgT25nb2luZywgSG91c2UsIFRpZSwgUGxheWVyLCBQbGF5ZXJOYXR1cmFsIH0NCg0KICBzdHJ1Y3QgR2FtZSB7DQogICAgYWRkcmVzcyBwbGF5ZXI7DQogICAgdWludDI1NiBiZXQ7DQogICAgdWludDI1NiBwYXlvdXQ7DQogICAgdWludDI1NiBnYW1lSUQ7DQoNCiAgICBEZWNrTGliLkRlY2sgZGVjazsNCiAgICB1aW50OFtdIGhvdXNlQ2FyZHM7DQogICAgdWludDhbXSBwbGF5ZXJDYXJkczsNCg0KICAgIHVpbnQyNTYgYWN0aW9uQmxvY2s7IC8vIEJsb2NrIG9uIHdoaWNoIGNvbW1pdG1lbnQgdG8gcGVyZm9ybSBhbiBhY3Rpb24gaGFwcGVucy4NCg0KICAgIEdhbWVTdGF0ZSBzdGF0ZTsNCiAgICBHYW1lUmVzdWx0IHJlc3VsdDsNCg0KICAgIGJvb2wgY2xvc2VkOw0KICB9DQoNCiAgZnVuY3Rpb24gaW5pdChHYW1lIHN0b3JhZ2Ugc2VsZiwgdWludDI1NiBnYW1lSUQpIHsNCiAgICBzZWxmLnBsYXllciA9IG1zZy5zZW5kZXI7DQogICAgc2VsZi5iZXQgPSBtc2cudmFsdWU7DQogICAgc2VsZi5wYXlvdXQgPSAwOw0KICAgIHNlbGYuaG91c2VDYXJkcyA9IG5ldyB1aW50OFtdKDApOw0KICAgIHNlbGYucGxheWVyQ2FyZHMgPSBuZXcgdWludDhbXSgwKTsNCiAgICBzZWxmLmFjdGlvbkJsb2NrID0gYmxvY2subnVtYmVyOw0KICAgIHNlbGYuc3RhdGUgPSBHYW1lU3RhdGUuSW5pdGlhbENhcmRzOw0KICAgIHNlbGYucmVzdWx0ID0gR2FtZVJlc3VsdC5PbmdvaW5nOw0KICAgIHNlbGYuY2xvc2VkID0gZmFsc2U7DQogICAgc2VsZi5nYW1lSUQgPSBnYW1lSUQ7DQoNCiAgICBzZWxmLmRlY2suaW5pdChnYW1lSUQpOw0KICB9DQoNCiAgZnVuY3Rpb24gdGljayhHYW1lIHN0b3JhZ2Ugc2VsZikgcmV0dXJucyAoYm9vbCkgew0KICAgIGlmIChibG9jay5udW1iZXIgPD0gc2VsZi5hY3Rpb25CbG9jaykgcmV0dXJuIGZhbHNlOyAvLyBDYW4ndCB0aWNrIHlldA0KICAgIGlmIChzZWxmLmFjdGlvbkJsb2NrICsgMjU1IDwgYmxvY2subnVtYmVyKSB7DQogICAgICBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuSG91c2UpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIGlmICghbmVlZHNUaWNrKHNlbGYpKSByZXR1cm4gdHJ1ZTsgLy8gbm90IG5lZWRlZCwgZXZlcnl0aGluZyBpcyBmaW5lDQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLkluaXRpYWxDYXJkcykgZGVhbEluaXRpYWxDYXJkcyhzZWxmKTsNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuSGl0KSBkZWFsSGl0Q2FyZChzZWxmKTsNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuRG91YmxlRG93bikgew0KICAgICAgZGVhbEhpdENhcmQoc2VsZik7DQogICAgICBmb3JjZVN0YW5kKHNlbGYpOw0KICAgIH0NCg0KICAgIGlmIChzZWxmLnN0YXRlID09IEdhbWVTdGF0ZS5TdGFuZCkgew0KICAgICAgZGVhbEhvdXNlQ2FyZHMoc2VsZik7DQogICAgICBjaGVja0dhbWVSZXN1bHQoc2VsZik7DQogICAgfSBlbHNlIHsNCiAgICAgIGNoZWNrR2FtZUNvbnRpbnVlcyhzZWxmKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG5lZWRzVGljayhHYW1lIHN0b3JhZ2Ugc2VsZikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgIGlmIChzZWxmLnN0YXRlID09IEdhbWVTdGF0ZS5XYWl0aW5nKSByZXR1cm4gZmFsc2U7DQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLkZpbmlzaGVkKSByZXR1cm4gZmFsc2U7DQoNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoZWNrR2FtZVJlc3VsdChHYW1lIHN0b3JhZ2Ugc2VsZikgIHsNCiAgICB1aW50OCBob3VzZUhhbmQgPSBjb3VudEhhbmQoc2VsZi5ob3VzZUNhcmRzKTsNCg0KICAgIGlmIChob3VzZUhhbmQgPT0gdGFyZ2V0ICYmIHNlbGYuaG91c2VDYXJkcy5sZW5ndGggPT0gMikgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5Ib3VzZSk7IC8vIEhvdXNlIG5hdHVyYWwNCg0KICAgIENvbXBhcmFpc29uUmVzdWx0IHJlc3VsdCA9IGNvbXBhcmVIYW5kcyhob3VzZUhhbmQsIGNvdW50SGFuZChzZWxmLnBsYXllckNhcmRzKSk7DQogICAgaWYgKHJlc3VsdCA9PSBDb21wYXJhaXNvblJlc3VsdC5GaXJzdCkgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5Ib3VzZSk7DQogICAgaWYgKHJlc3VsdCA9PSBDb21wYXJhaXNvblJlc3VsdC5TZWNvbmQpIHJldHVybiBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuUGxheWVyKTsNCg0KICAgIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5UaWUpOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hlY2tHYW1lQ29udGludWVzKEdhbWUgc3RvcmFnZSBzZWxmKSAgew0KICAgIHVpbnQ4IHBsYXllckhhbmQgPSBjb3VudEhhbmQoc2VsZi5wbGF5ZXJDYXJkcyk7DQogICAgaWYgKHBsYXllckhhbmQgPT0gdGFyZ2V0ICYmIHNlbGYucGxheWVyQ2FyZHMubGVuZ3RoID09IDIpIHJldHVybiBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuUGxheWVyTmF0dXJhbCk7IC8vIHBsYXllciBuYXR1cmFsDQogICAgaWYgKHBsYXllckhhbmQgPiB0YXJnZXQpIHJldHVybiBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuSG91c2UpOyAvLyBQbGF5ZXIgYnVzdGVkDQogICAgaWYgKHBsYXllckhhbmQgPT0gdGFyZ2V0ICYmIHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLldhaXRpbmcpIHsNCiAgICAgIC8vIFBsYXllciBpcyBmb3JjZWQgdG8gc3RhbmQgd2l0aCAyMSAoYnV0IHNob3VsZCBub3QgIGFscmVhZHkgc3RhbmRpbmcsIGllIGluIGRvdWJsZSBkb3duKQ0KICAgICAgZm9yY2VTdGFuZChzZWxmKTsNCiAgICB9DQogIH0NCg0KICBmdW5jdGlvbiBmb3JjZVN0YW5kKEdhbWUgc3RvcmFnZSBzZWxmKSB7DQogICAgdWludDI1NiBjdXJyZW50QWN0aW9uQmxvY2sgPSBzZWxmLmFjdGlvbkJsb2NrOw0KICAgIHBsYXllckRlY2lzaW9uKHNlbGYsIEdhbWVTdGF0ZS5TdGFuZCk7DQogICAgc2VsZi5hY3Rpb25CbG9jayA9IGN1cnJlbnRBY3Rpb25CbG9jazsNCiAgICBpZiAoIXRpY2soc2VsZikpIHRocm93OyAvLyBGb3JjZXMgdGljaywgY29tbWl0bWVudCB0byBwbGF5IGFjdHVhbGx5IGhhcHBlbmVkIHBhc3QgYmxvY2sNCiAgfQ0KDQogIGZ1bmN0aW9uIGNhbkRvdWJsZURvd24oR2FtZSBzdG9yYWdlIHNlbGYpIHJldHVybnMgKGJvb2wpIHsNCiAgICBpZiAoc2VsZi5wbGF5ZXJDYXJkcy5sZW5ndGggPiAyKSByZXR1cm4gZmFsc2U7DQogICAgdWludDggdG90YWxQbGF5ZXIgPSBjb3VudEhhbmQoc2VsZi5wbGF5ZXJDYXJkcyk7DQogICAgaWYgKHRvdGFsUGxheWVyIDwgOSB8fCB0b3RhbFBsYXllciA+IDExKSByZXR1cm4gZmFsc2U7DQogICAgaWYgKG1zZy52YWx1ZSAhPSBzZWxmLmJldCkgcmV0dXJuIGZhbHNlOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gcGxheWVyRGVjaXNpb24oR2FtZSBzdG9yYWdlIHNlbGYsIEdhbWVTdGF0ZSBkZWNpc2lvbikgIHsNCiAgICBpZiAoc2VsZi5zdGF0ZSAhPSBHYW1lU3RhdGUuV2FpdGluZykgdGhyb3c7DQogICAgaWYgKGRlY2lzaW9uICE9IEdhbWVTdGF0ZS5IaXQgJiYgZGVjaXNpb24gIT0gR2FtZVN0YXRlLlN0YW5kICYmIGRlY2lzaW9uICE9IEdhbWVTdGF0ZS5Eb3VibGVEb3duKSB0aHJvdzsNCg0KICAgIGlmIChkZWNpc2lvbiA9PSBHYW1lU3RhdGUuRG91YmxlRG93bil7DQogICAgICBpZiAoIWNhbkRvdWJsZURvd24oc2VsZikpIHRocm93Ow0KICAgICAgc2VsZi5iZXQgKz0gbXNnLnZhbHVlOw0KICAgIH0NCg0KICAgIHNlbGYuc3RhdGUgPSBkZWNpc2lvbjsNCiAgICBzZWxmLmFjdGlvbkJsb2NrID0gYmxvY2subnVtYmVyOw0KICB9DQoNCiAgZnVuY3Rpb24gZGVhbEluaXRpYWxDYXJkcyhHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgc2VsZi5wbGF5ZXJDYXJkcy5wdXNoKHNlbGYuZGVjay5nZXRDYXJkKHNlbGYuYWN0aW9uQmxvY2spKTsNCiAgICBzZWxmLmhvdXNlQ2FyZHMucHVzaChzZWxmLmRlY2suZ2V0Q2FyZChzZWxmLmFjdGlvbkJsb2NrKSk7DQogICAgc2VsZi5wbGF5ZXJDYXJkcy5wdXNoKHNlbGYuZGVjay5nZXRDYXJkKHNlbGYuYWN0aW9uQmxvY2spKTsNCiAgICBzZWxmLnN0YXRlID0gR2FtZVN0YXRlLldhaXRpbmc7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSGl0Q2FyZChHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgc2VsZi5wbGF5ZXJDYXJkcy5wdXNoKHNlbGYuZGVjay5nZXRDYXJkKHNlbGYuYWN0aW9uQmxvY2spKTsNCiAgICBzZWxmLnN0YXRlID0gR2FtZVN0YXRlLldhaXRpbmc7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSG91c2VDYXJkcyhHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgc2VsZi5ob3VzZUNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KICAgIGlmIChjb3VudEhhbmQoc2VsZi5ob3VzZUNhcmRzKSA8IGhvdXNlTGltaXQpIGRlYWxIb3VzZUNhcmRzKHNlbGYpOw0KICB9DQoNCiAgZnVuY3Rpb24gZW5kR2FtZShHYW1lIHN0b3JhZ2Ugc2VsZiwgR2FtZVJlc3VsdCByZXN1bHQpIHsNCiAgICBzZWxmLnJlc3VsdCA9IHJlc3VsdDsNCiAgICBzZWxmLnN0YXRlID0gR2FtZVN0YXRlLkZpbmlzaGVkOw0KICAgIHNlbGYucGF5b3V0ID0gcGF5b3V0Rm9yUmVzdWx0KHNlbGYucmVzdWx0LCBzZWxmLmJldCk7DQoNCiAgICBjbG9zZUdhbWUoc2VsZik7DQogIH0NCg0KICBmdW5jdGlvbiBjbG9zZUdhbWUoR2FtZSBzdG9yYWdlIHNlbGYpIHByaXZhdGUgew0KICAgIGlmIChzZWxmLmNsb3NlZCkgdGhyb3c7IC8vIGNhbm5vdCByZS1jbG9zZQ0KICAgIGlmIChzZWxmLnN0YXRlICE9IEdhbWVTdGF0ZS5GaW5pc2hlZCkgdGhyb3c7IC8vIG5vdCBjbG9zYWJsZQ0KDQogICAgc2VsZi5jbG9zZWQgPSB0cnVlOw0KDQogICAgaWYgKHNlbGYucGF5b3V0ID4gMCkgew0KICAgICAgaWYgKCFzZWxmLnBsYXllci5zZW5kKHNlbGYucGF5b3V0KSkgdGhyb3c7DQogICAgfQ0KICB9DQoNCiAgZnVuY3Rpb24gcGF5b3V0Rm9yUmVzdWx0KEdhbWVSZXN1bHQgcmVzdWx0LCB1aW50MjU2IGJldCkgcHJpdmF0ZSByZXR1cm5zICh1aW50MjU2KSB7DQogICAgaWYgKHJlc3VsdCA9PSBHYW1lUmVzdWx0LlBsYXllck5hdHVyYWwpIHJldHVybiBiZXQgKiA1IC8gMjsgLy8gYmV0ICsgMS41eCBiZXQNCiAgICBpZiAocmVzdWx0ID09IEdhbWVSZXN1bHQuUGxheWVyKSByZXR1cm4gYmV0ICogMjsgLy8gZG91YmxlcyBiZXQNCiAgICBpZiAocmVzdWx0ID09IEdhbWVSZXN1bHQuVGllKSByZXR1cm4gYmV0OyAvLyByZXR1cm5zIGJldA0KDQogICAgcmV0dXJuIDA7DQogIH0NCg0KICBmdW5jdGlvbiBjb3VudEhhbmQodWludDhbXSBtZW1vcnkgaGFuZCkgIHJldHVybnMgKHVpbnQ4KSB7DQogICAgdWludDhbXSBtZW1vcnkgcG9zc2libGVTdW1zID0gbmV3IHVpbnQ4W10oMSk7DQoNCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBoYW5kLmxlbmd0aDsgaSsrKSB7DQogICAgICB1aW50OCB2YWx1ZSA9IGhhbmRbaV0uYmxhY2tqYWNrVmFsdWUoKTsNCiAgICAgIHVpbnQgbCA9IHBvc3NpYmxlU3Vtcy5sZW5ndGg7DQogICAgICBmb3IgKHVpbnQgaiA9IDA7IGogPCBsOyBqKyspIHsNCiAgICAgICAgcG9zc2libGVTdW1zW2pdICs9IHZhbHVlOw0KICAgICAgICBpZiAodmFsdWUgPT0gMSkgeyAvLyBpcyBBY2UNCiAgICAgICAgICBwb3NzaWJsZVN1bXMgPSBhcHBlbmRBcnJheShwb3NzaWJsZVN1bXMsIHBvc3NpYmxlU3Vtc1tqXSArIDEwKTsgLy8gRm9yayBwb3NzaWJsZSBzdW0gd2l0aCAxMSBhcyBhY2UgdmFsdWUuDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm4gYmVzdFN1bShwb3NzaWJsZVN1bXMpOw0KICB9DQoNCiAgZnVuY3Rpb24gYmVzdFN1bSh1aW50OFtdIHBvc3NpYmxlU3VtcykgIHJldHVybnMgKHVpbnQ4IGJlc3RTdW0pIHsNCiAgICBiZXN0U3VtID0gNTA7IC8vIHZlcnkgYmFkIGhhbmQNCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBwb3NzaWJsZVN1bXMubGVuZ3RoOyBpKyspIHsNCiAgICAgIGlmIChjb21wYXJlSGFuZHMoYmVzdFN1bSwgcG9zc2libGVTdW1zW2ldKSA9PSBDb21wYXJhaXNvblJlc3VsdC5TZWNvbmQpIHsNCiAgICAgICAgYmVzdFN1bSA9IHBvc3NpYmxlU3Vtc1tpXTsNCiAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuOw0KICB9DQoNCiAgZnVuY3Rpb24gYXBwZW5kQXJyYXkodWludDhbXSBtZW1vcnkgYXJyYXksIHVpbnQ4IG4pICByZXR1cm5zICh1aW50OFtdIG1lbW9yeSkgew0KICAgIHVpbnQ4W10gbWVtb3J5IG5ld0FycmF5ID0gbmV3IHVpbnQ4W10oYXJyYXkubGVuZ3RoICsgMSk7DQogICAgZm9yICh1aW50OCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7DQogICAgICBuZXdBcnJheVtpXSA9IGFycmF5W2ldOw0KICAgIH0NCiAgICBuZXdBcnJheVthcnJheS5sZW5ndGhdID0gbjsNCiAgICByZXR1cm4gbmV3QXJyYXk7DQogIH0NCg0KICBmdW5jdGlvbiBjb21wYXJlSGFuZHModWludDggYSwgdWludDggYikgIHJldHVybnMgKENvbXBhcmFpc29uUmVzdWx0KSB7DQogICAgaWYgKGEgPD0gdGFyZ2V0ICYmIGIgPD0gdGFyZ2V0KSB7DQogICAgICBpZiAoYSA+IGIpIHJldHVybiBDb21wYXJhaXNvblJlc3VsdC5GaXJzdDsNCiAgICAgIGlmIChhIDwgYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LlNlY29uZDsNCiAgICB9DQoNCiAgICBpZiAoYSA+IHRhcmdldCAmJiBiID4gdGFyZ2V0KSB7DQogICAgICBpZiAoYSA8IGIpIHJldHVybiBDb21wYXJhaXNvblJlc3VsdC5GaXJzdDsNCiAgICAgIGlmIChhID4gYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LlNlY29uZDsNCiAgICB9DQoNCiAgICBpZiAoYSA+IHRhcmdldCkgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LlNlY29uZDsNCiAgICBpZiAoYiA+IHRhcmdldCkgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LkZpcnN0Ow0KDQogICAgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LlRpZTsNCiAgfQ0KfQ0KDQpjb250cmFjdCBCbG9ja2phY2sgew0KICANCiAgZXZlbnQgR2FtZUVuZGVkKHVpbnQyNTYgZ2FtZUlELCBhZGRyZXNzIHBsYXllciwgdWludCBnYW1lUmVzdWx0LCB1aW50MjU2IHdhZ2VyLCB1aW50MjU2IHBheW91dCwgdWludDggcGxheWVySGFuZCwgdWludDggaG91c2VIYW5kKTsNCiAgZXZlbnQgR2FtZU5lZWRzVGljayh1aW50MjU2IGdhbWVJRCwgYWRkcmVzcyBwbGF5ZXIsIHVpbnQyNTYgYWN0aW9uQmxvY2spOw0KDQogIHVzaW5nIEdhbWVMaWIgZm9yIEdhbWVMaWIuR2FtZTsNCg0KICBHYW1lTGliLkdhbWVbXSBnYW1lczsNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgY3VycmVudEdhbWU7DQoNCiAgLy8gSW5pdGlhbCBzZXR0aW5ncw0KICB1aW50MjU2IHB1YmxpYyBtaW5CZXQgPSAxMCBmaW5uZXk7DQogIHVpbnQyNTYgcHVibGljIG1heEJldCA9IDUwMCBmaW5uZXk7DQogIGJvb2wgcHVibGljIGFsbG93c05ld0dhbWVzID0gdHJ1ZTsNCiAgdWludDI1NiBwdWJsaWMgbWF4QmxvY2tBY3Rpb25zID0gMTA7DQoNCiAgbWFwcGluZyAodWludDI1NiA9PiB1aW50MjU2KSBibG9ja0FjdGlvbnM7DQoNCiAgLy9tYWluDQogIGFkZHJlc3MgcHVibGljIERYOw0KICBhZGRyZXNzIHB1YmxpYyBERVY7DQoNCiAgdWludDI1NiBwdWJsaWMgaW5pdGlhbEJhbmtyb2xsOw0KICB1aW50MjU2IHB1YmxpYyBjdXJyZW50QmFua3JvbGw7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgaXNPd25lcjsNCg0KICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgIGlmICghaXNPd25lclttc2cuc2VuZGVyXSkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHkoYWRkcmVzcyB4KSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0geCkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlQbGF5ZXIodWludDI1NiBnYW1lSUQpIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBnYW1lc1tnYW1lSURdLnBsYXllcikgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIGJsb2NrQWN0aW9uUHJvdGVjdGVkIHsNCiAgICBibG9ja0FjdGlvbnNbYmxvY2subnVtYmVyXSArPSAxOw0KICAgIGlmIChibG9ja0FjdGlvbnNbYmxvY2subnVtYmVyXSA+IG1heEJsb2NrQWN0aW9ucykgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIEJsb2NramFjayhhZGRyZXNzIF9EWCwgYWRkcmVzcyBfREVWKSB7DQogICAgRFggPSBfRFg7DQogICAgREVWID0gX0RFVjsNCiAgICBnYW1lcy5sZW5ndGggKz0gMTsNCiAgICBnYW1lc1swXS5pbml0KDApOyAvLyBJbml0IGdhbWUgMCBzbyBpbmRpY2VzIHN0YXJ0IG9uIDENCiAgICBnYW1lc1swXS5wbGF5ZXIgPSB0aGlzOw0KICAgIGlzT3duZXJbRFhdID0gdHJ1ZTsNCiAgICBpc093bmVyW0RFVl0gPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7DQogICAgc3RhcnRHYW1lKCk7DQogIH0NCg0KICBmdW5jdGlvbiBzdGFydEdhbWUoKSBibG9ja0FjdGlvblByb3RlY3RlZCBwYXlhYmxlIHsNCiAgICBpZiAoIWFsbG93c05ld0dhbWVzKSB0aHJvdzsNCiAgICBpZiAobXNnLnZhbHVlIDwgbWluQmV0KSB0aHJvdzsNCiAgICBpZiAobXNnLnZhbHVlID4gbWF4QmV0KSB0aHJvdzsNCg0KICAgIC8vIGNoZWNrIGlmIHBsYXllciBoYXMgZ2FtZSBvcGVuZWQNCiAgICB1aW50MjU2IGN1cnJlbnRHYW1lSWQgPSBjdXJyZW50R2FtZVttc2cuc2VuZGVyXTsNCiAgICBpZiAoZ2FtZXMubGVuZ3RoID4gY3VycmVudEdhbWVJZCkgew0KICAgICAgR2FtZUxpYi5HYW1lIG9wZW5lZEdhbWUgPSBnYW1lc1tjdXJyZW50R2FtZUlkXTsNCiAgICAgIGlmIChvcGVuZWRHYW1lLnBsYXllciA9PSBtc2cuc2VuZGVyICYmICFvcGVuZWRHYW1lLmNsb3NlZCkgeyAvLyBDaGVjayBmb3IgaW5kZXggMCBtYXBwaW5nIHByb2JsZW1zDQoJaWYgKCFvcGVuZWRHYW1lLnRpY2soKSkgdGhyb3c7DQoJaWYgKCFvcGVuZWRHYW1lLmNsb3NlZCkgdGhyb3c7IC8vIGNhbm5vdCBzdGFydCBnYW1lIHdpdGggb24tZ29pbmcgZ2FtZQ0KCXJlY29yZEVuZGVkR2FtZShjdXJyZW50R2FtZUlkKTsNCiAgICAgIH0NCiAgICB9DQogICAgdWludDI1NiBuZXdHYW1lSUQgPSBnYW1lcy5sZW5ndGg7DQoNCiAgICBnYW1lcy5sZW5ndGggKz0gMTsNCiAgICBnYW1lc1tuZXdHYW1lSURdLmluaXQobmV3R2FtZUlEKTsNCiAgICBjdXJyZW50R2FtZVttc2cuc2VuZGVyXSA9IG5ld0dhbWVJRDsNCiAgICB0aWNrUmVxdWlyZWRMb2coZ2FtZXNbbmV3R2FtZUlEXSk7DQogIH0NCg0KICBmdW5jdGlvbiBoaXQodWludDI1NiBnYW1lSUQpIG9ubHlQbGF5ZXIoZ2FtZUlEKSBibG9ja0FjdGlvblByb3RlY3RlZCB7DQogICAgR2FtZUxpYi5HYW1lIGdhbWUgPSBnYW1lc1tnYW1lSURdOw0KICAgIGlmICghZ2FtZS50aWNrKCkpIHRocm93Ow0KICAgIGdhbWUucGxheWVyRGVjaXNpb24oR2FtZUxpYi5HYW1lU3RhdGUuSGl0KTsNCiAgICB0aWNrUmVxdWlyZWRMb2coZ2FtZSk7DQogIH0NCg0KICBmdW5jdGlvbiBkb3VibGVEb3duKHVpbnQyNTYgZ2FtZUlEKSBvbmx5UGxheWVyKGdhbWVJRCkgYmxvY2tBY3Rpb25Qcm90ZWN0ZWQgcGF5YWJsZSB7DQogICAgR2FtZUxpYi5HYW1lIGdhbWUgPSBnYW1lc1tnYW1lSURdOw0KICAgIGlmICghZ2FtZS50aWNrKCkpIHRocm93Ow0KICAgIGdhbWUucGxheWVyRGVjaXNpb24oR2FtZUxpYi5HYW1lU3RhdGUuRG91YmxlRG93bik7DQogICAgdGlja1JlcXVpcmVkTG9nKGdhbWUpOw0KICB9DQoNCiAgZnVuY3Rpb24gc3RhbmQodWludDI1NiBnYW1lSUQpIG9ubHlQbGF5ZXIoZ2FtZUlEKSBibG9ja0FjdGlvblByb3RlY3RlZCB7DQogICAgR2FtZUxpYi5HYW1lIGdhbWUgPSBnYW1lc1tnYW1lSURdOw0KICAgIGlmICghZ2FtZS50aWNrKCkpIHRocm93Ow0KICAgIGdhbWUucGxheWVyRGVjaXNpb24oR2FtZUxpYi5HYW1lU3RhdGUuU3RhbmQpOw0KICAgIHRpY2tSZXF1aXJlZExvZyhnYW1lKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGdhbWVUaWNrKHVpbnQyNTYgZ2FtZUlEKSBibG9ja0FjdGlvblByb3RlY3RlZCB7DQogICAgR2FtZUxpYi5HYW1lIG9wZW5lZEdhbWUgPSBnYW1lc1tnYW1lSURdOw0KICAgIGlmIChvcGVuZWRHYW1lLmNsb3NlZCkgdGhyb3c7DQogICAgaWYgKCFvcGVuZWRHYW1lLnRpY2soKSkgdGhyb3c7DQogICAgaWYgKG9wZW5lZEdhbWUuY2xvc2VkKSByZWNvcmRFbmRlZEdhbWUoZ2FtZUlEKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHJlY29yZEVuZGVkR2FtZSh1aW50IGdhbWVJRCkgcHJpdmF0ZSB7DQogICAgR2FtZUxpYi5HYW1lIG9wZW5lZEdhbWUgPSBnYW1lc1tnYW1lSURdOw0KDQogICAgLy92cyBwb3RlbnRpYWwgb3ZlcmZsb3cgd2hlbiBjcm91cGllciBpcyBub3QgdGlja2luZyBmcmVxdWVudGx5IGVub3VnaA0KICAgIGlmKGN1cnJlbnRCYW5rcm9sbCArIG9wZW5lZEdhbWUuYmV0ID4gb3BlbmVkR2FtZS5wYXlvdXQpew0KICAgICAgY3VycmVudEJhbmtyb2xsID0gY3VycmVudEJhbmtyb2xsICsgb3BlbmVkR2FtZS5iZXQgLSBvcGVuZWRHYW1lLnBheW91dDsNCiAgICB9DQoNCiAgICBHYW1lRW5kZWQoDQoJICAgICAgb3BlbmVkR2FtZS5nYW1lSUQsDQoJICAgICAgb3BlbmVkR2FtZS5wbGF5ZXIsDQoJICAgICAgdWludChvcGVuZWRHYW1lLnJlc3VsdCksDQoJICAgICAgb3BlbmVkR2FtZS5iZXQsDQoJICAgICAgb3BlbmVkR2FtZS5wYXlvdXQsDQoJICAgICAgR2FtZUxpYi5jb3VudEhhbmQob3BlbmVkR2FtZS5wbGF5ZXJDYXJkcyksDQoJICAgICAgR2FtZUxpYi5jb3VudEhhbmQob3BlbmVkR2FtZS5ob3VzZUNhcmRzKQ0KCSAgICAgICk7DQogIH0NCg0KICBmdW5jdGlvbiB0aWNrUmVxdWlyZWRMb2coR2FtZUxpYi5HYW1lIHN0b3JhZ2UgZ2FtZSkgcHJpdmF0ZSB7DQogICAgR2FtZU5lZWRzVGljayhnYW1lLmdhbWVJRCwgZ2FtZS5wbGF5ZXIsIGdhbWUuYWN0aW9uQmxvY2spOw0KICB9DQoNCiAgLy8gQ29uc3RhbnRzDQoNCiAgZnVuY3Rpb24gZ2FtZVN0YXRlKHVpbnQgaSkgY29uc3RhbnQgcmV0dXJucyAodWludDhbXSwgdWludDhbXSwgdWludDgsIHVpbnQ4LCB1aW50MjU2LCB1aW50MjU2LCB1aW50OCwgdWludDgsIGJvb2wsIHVpbnQyNTYpIHsNCiAgICBHYW1lTGliLkdhbWUgZ2FtZSA9IGdhbWVzW2ldOw0KDQogICAgcmV0dXJuICgNCgkgICAgZ2FtZS5ob3VzZUNhcmRzLA0KCSAgICBnYW1lLnBsYXllckNhcmRzLA0KCSAgICBHYW1lTGliLmNvdW50SGFuZChnYW1lLmhvdXNlQ2FyZHMpLA0KCSAgICBHYW1lTGliLmNvdW50SGFuZChnYW1lLnBsYXllckNhcmRzKSwNCgkgICAgZ2FtZS5iZXQsDQoJICAgIGdhbWUucGF5b3V0LA0KCSAgICB1aW50OChnYW1lLnN0YXRlKSwNCgkgICAgdWludDgoZ2FtZS5yZXN1bHQpLA0KCSAgICBnYW1lLmNsb3NlZCwNCgkgICAgZ2FtZS5hY3Rpb25CbG9jaw0KCSAgICApOw0KICB9DQoNCg0KICBmdW5jdGlvbiBjaGFuZ2VEZXYoYWRkcmVzcyBuZXdEZXYpIG9ubHkoREVWKSB7DQogICAgaXNPd25lcltERVZdID0gZmFsc2U7DQogICAgREVWID0gbmV3RGV2Ow0KICAgIGlzT3duZXJbREVWXSA9IHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBjaGFuZ2VEWChhZGRyZXNzIG5ld0RYKSBvbmx5KERYKSB7DQogICAgaXNPd25lcltEWF0gPSBmYWxzZTsNCiAgICBEWCA9IG5ld0RYOw0KICAgIGlzT3duZXJbRFhdID0gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNldFNldHRpbmdzKHVpbnQyNTYgX21pbiwgdWludDI1NiBfbWF4LCB1aW50MjU2IF9tYXhCbG9ja0FjdGlvbnMpIG9ubHkoRFgpIHsNCiAgICBtaW5CZXQgPSBfbWluOw0KICAgIG1heEJldCA9IF9tYXg7DQogICAgbWF4QmxvY2tBY3Rpb25zID0gX21heEJsb2NrQWN0aW9uczsNCiAgfQ0KDQogIGZ1bmN0aW9uIHJlZ2lzdGVyT3duZXIoYWRkcmVzcyBfbmV3X3dhdGNoZXIpIG9ubHkoRFgpIHsNCiAgICBpc093bmVyW19uZXdfd2F0Y2hlcl0gPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBfb2xkX3dhdGNoZXIpIG9ubHkoRFgpIHsNCiAgICBpc093bmVyW19vbGRfd2F0Y2hlcl0gPSBmYWxzZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHN0b3BCbG9ja2phY2soKSBvbmx5T3duZXIgew0KICAgIGFsbG93c05ld0dhbWVzID0gZmFsc2U7DQogIH0NCg0KICBmdW5jdGlvbiBzdGFydEJsb2NramFjaygpIG9ubHkoRFgpIHsNCiAgICBhbGxvd3NOZXdHYW1lcyA9IHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhZGRCYW5rcm9sbCgpIG9ubHkoRFgpIHBheWFibGUgew0KICAgIGluaXRpYWxCYW5rcm9sbCArPSBtc2cudmFsdWU7DQogICAgY3VycmVudEJhbmtyb2xsICs9IG1zZy52YWx1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pZ3JhdGVCbG9ja2phY2soKSBvbmx5KERYKSB7DQogICAgc3RvcEJsb2NramFjaygpOw0KICAgIHNoYXJlUHJvZml0cygpOw0KICAgIHN1aWNpZGUoRFgpOw0KICB9DQoNCiAgdWludDI1NiBEWF9QUk9GSVRTID0gOTA7DQogIHVpbnQyNTYgREVWX1BST0ZJVFMgPSAxMDsNCiAgdWludDI1NiBQUk9GSVRTX0JBU0UgPSAxMDA7DQogIA0KICBmdW5jdGlvbiBzaGFyZVByb2ZpdHMoKSBvbmx5T3duZXJ7DQogICAgaWYgKGN1cnJlbnRCYW5rcm9sbCA8PSBpbml0aWFsQmFua3JvbGwpIHJldHVybjsgLy8gdGhlcmUgYXJlIG5vIHByb2ZpdHMNCiAgICB1aW50MjU2IHByb2ZpdCA9IGN1cnJlbnRCYW5rcm9sbCAtIGluaXRpYWxCYW5rcm9sbDsNCiAgICB1aW50MjU2IG5vdFNlbnQ7DQogICAgaWYgKCFEWC5zZW5kKHByb2ZpdCAqIERYX1BST0ZJVFMgLyBQUk9GSVRTX0JBU0UpKSB7DQogICAgICBub3RTZW50ID0gcHJvZml0ICogRFhfUFJPRklUUyAvIFBST0ZJVFNfQkFTRTsNCiAgICB9DQogICAgaWYgKCFERVYuc2VuZChwcm9maXQgKiBERVZfUFJPRklUUyAvIFBST0ZJVFNfQkFTRSkpew0KICAgICAgbm90U2VudCA9IHByb2ZpdCAqIERFVl9QUk9GSVRTIC8gUFJPRklUU19CQVNFOw0KICAgIH0NCiAgICBjdXJyZW50QmFua3JvbGwgLT0gcHJvZml0IC0gbm90U2VudDsNCiAgfQ0KDQoNCiAgDQp9'