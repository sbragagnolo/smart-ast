base 64 content
base64blockjack2
	^'bGlicmFyeSBBcnJheUxpYiB7DQogIC8vIEluc2VydHMgdG8ga2VlcCBhcnJheSBzb3J0ZWQgKGFzc3VtZXMgaW5wdXQgYXJyYXkgaXMgc29ydGVkKQ0KCWZ1bmN0aW9uIGluc2VydEluUGxhY2UodWludDhbXSBzdG9yYWdlIHNlbGYsIHVpbnQ4IG4pIHsNCgkJdWludDggaW5zZXJ0aW5nSW5kZXggPSAwOw0KDQoJCXdoaWxlIChzZWxmLmxlbmd0aCA+IDAgJiYgaW5zZXJ0aW5nSW5kZXggPCBzZWxmLmxlbmd0aCAmJiBzZWxmW2luc2VydGluZ0luZGV4XSA8IG4pIHsNCgkJCWluc2VydGluZ0luZGV4ICs9IDE7DQoJCX0NCg0KCQlzZWxmLmxlbmd0aCArPSAxOw0KCQlmb3IgKHVpbnQ4IGkgPSB1aW50OChzZWxmLmxlbmd0aCkgLSAxOyBpID4gaW5zZXJ0aW5nSW5kZXg7IGktLSkgew0KCQkJc2VsZltpXSA9IHNlbGZbaSAtIDFdOw0KCQl9DQoNCgkJc2VsZltpbnNlcnRpbmdJbmRleF0gPSBuOw0KCX0NCn0NCg0KDQpsaWJyYXJ5IERlY2tMaWIgew0KCXVzaW5nIEFycmF5TGliIGZvciB1aW50OFtdOw0KDQoJZW51bSBTdWl0IHsgU3BhZGVzLCBIZWFydHMsIENsdWJzLCBEaWFtb25kcyB9DQoJdWludDggY29uc3RhbnQgY2FyZHNQZXJTdWl0ID0gMTM7DQoJdWludDggY29uc3RhbnQgc3VpdHMgPSA0Ow0KCXVpbnQ4IGNvbnN0YW50IHRvdGFsQ2FyZHMgPSBjYXJkc1BlclN1aXQgKiBzdWl0czsNCg0KCXN0cnVjdCBEZWNrIHsNCgkJdWludDhbXSB1c2VkQ2FyZHM7IC8vIGFsd2F5cyBoYXMgdG8gYmUgc29ydGVkDQoJCWFkZHJlc3MgcGxheWVyOw0KCQl1aW50MjU2IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBpbml0KERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGdhbWVJRCkgIHsNCgkJc2VsZi51c2VkQ2FyZHMgPSBuZXcgdWludDhbXSgwKTsNCgkJc2VsZi5wbGF5ZXIgPSBtc2cuc2VuZGVyOw0KCQlzZWxmLmdhbWVJRCA9IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBnZXRDYXJkKERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGJsb2NrTnVtYmVyKSAgcmV0dXJucyAodWludDgpICB7DQoJCXVpbnQgY2FyZEluZGV4ID0gc2VsZi51c2VkQ2FyZHMubGVuZ3RoOw0KCQlpZiAoY2FyZEluZGV4ID49IHRvdGFsQ2FyZHMpIHRocm93Ow0KCQl1aW50OCByID0gdWludDgoZ2V0UmFuZG9tTnVtYmVyKGJsb2NrTnVtYmVyLCBzZWxmLnBsYXllciwgc2VsZi5nYW1lSUQsIGNhcmRJbmRleCwgdG90YWxDYXJkcyAtIGNhcmRJbmRleCkpOw0KDQoJCWZvciAodWludDggaSA9IDA7IGkgPCBjYXJkSW5kZXg7IGkrKykgew0KCQkJaWYgKHNlbGYudXNlZENhcmRzW2ldIDw9IHIpIHIgKz0gMTsNCgkJfQ0KDQoJCXNlbGYudXNlZENhcmRzLmluc2VydEluUGxhY2Uocik7DQoNCgkJcmV0dXJuIHI7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZERlc2NyaXB0aW9uKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKFN1aXQsIHVpbnQ4KSB7DQoJCXJldHVybiAoU3VpdChzZWxmIC8gY2FyZHNQZXJTdWl0KSwgY2FyZEZhY2V2YWx1ZShzZWxmKSk7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZEVtb2ppZmllZCh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCwgc3RyaW5nKSB7DQoJCXN0cmluZyBtZW1vcnkgZW1vamlTdWl0Ow0KDQoJCXZhciAoc3VpdCwgbnVtYmVyKSA9IGNhcmREZXNjcmlwdGlvbihzZWxmKTsNCgkJaWYgKHN1aXQgPT0gU3VpdC5DbHVicykgZW1vamlTdWl0ID0gIuKZo++4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5EaWFtb25kcykgZW1vamlTdWl0ID0gIuKZpu+4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5IZWFydHMpIGVtb2ppU3VpdCA9ICLimaXvuI8iOw0KCQllbHNlIGlmIChzdWl0ID09IFN1aXQuU3BhZGVzKSBlbW9qaVN1aXQgPSAi4pmg77iPIjsNCg0KCQlyZXR1cm4gKG51bWJlciwgZW1vamlTdWl0KTsNCgl9DQoNCglmdW5jdGlvbiBjYXJkRmFjZXZhbHVlKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7DQoJCXJldHVybiAxICsgc2VsZiAlIGNhcmRzUGVyU3VpdDsNCgl9DQoNCglmdW5jdGlvbiBibGFja2phY2tWYWx1ZSh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCkgew0KCQl1aW50OCBjYXJkVmFsdWUgPSBjYXJkRmFjZXZhbHVlKHNlbGYpOw0KCQlyZXR1cm4gY2FyZFZhbHVlIDwgMTAgPyBjYXJkVmFsdWUgOiAxMDsNCgl9DQoNCglmdW5jdGlvbiBnZXRSYW5kb21OdW1iZXIodWludCBiLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBnYW1lSUQsIHVpbnQgbiwgdWludCBtKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQoJCS8vIFVzZXMgYmxvY2toYXNoIGFzIHJhbmRvbW5lc3Mgc291cmNlLg0KCQkvLyBDcmVkaXRzOiBodHRwczovL2dpdGh1Yi5jb20vQnVuamluL1JvdWxldGgvYmxvYi9tYXN0ZXIvUHJvdmFibHlfRmFpcl9Ob19DaGVhdGluZy5tZA0KCQlieXRlczMyIGJsb2NrSGFzaCA9IGJsb2NrLmJsb2NraGFzaChiKTsNCgkJaWYgKGJsb2NrSGFzaCA9PSAweDApIHRocm93Ow0KCQlyZXR1cm4gdWludCh1aW50MjU2KGtlY2NhazI1NihibG9ja0hhc2gsIHBsYXllciwgZ2FtZUlELCBuKSkgJSBtKTsNCg0KCX0NCn0NCg0KbGlicmFyeSBHYW1lTGliIHsNCiAgdXNpbmcgRGVja0xpYiBmb3IgKjsNCg0KICB1aW50OCBjb25zdGFudCBob3VzZUxpbWl0ID0gMTc7DQogIHVpbnQ4IGNvbnN0YW50IHRhcmdldCA9IDIxOw0KDQogIGVudW0gQ29tcGFyYWlzb25SZXN1bHQgeyBGaXJzdCwgU2Vjb25kLCBUaWUgfQ0KICBlbnVtIEdhbWVTdGF0ZSB7IEluaXRpYWxDYXJkcywgV2FpdGluZywgSGl0LCBTdGFuZCwgRmluaXNoZWQgfQ0KICBlbnVtIEdhbWVSZXN1bHQgeyBPbmdvaW5nLCBIb3VzZSwgVGllLCBQbGF5ZXIsIFBsYXllck5hdHVyYWwgfQ0KDQogIHN0cnVjdCBHYW1lIHsNCiAgICBhZGRyZXNzIHBsYXllcjsNCiAgICB1aW50MjU2IGJldDsNCiAgICB1aW50MjU2IHBheW91dDsNCiAgICB1aW50MjU2IGdhbWVJRDsNCg0KICAgIERlY2tMaWIuRGVjayBkZWNrOw0KICAgIHVpbnQ4W10gaG91c2VDYXJkczsNCiAgICB1aW50OFtdIHBsYXllckNhcmRzOw0KDQogICAgdWludDI1NiBhY3Rpb25CbG9jazsgLy8gQmxvY2sgb24gd2hpY2ggY29tbWl0bWVudCB0byBwZXJmb3JtIGFuIGFjdGlvbiBoYXBwZW5zLg0KDQogICAgR2FtZVN0YXRlIHN0YXRlOw0KICAgIEdhbWVSZXN1bHQgcmVzdWx0Ow0KDQogICAgYm9vbCBjbG9zZWQ7DQogIH0NCg0KICBmdW5jdGlvbiBpbml0KEdhbWUgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGdhbWVJRCkgew0KICAgIHNlbGYucGxheWVyID0gbXNnLnNlbmRlcjsNCiAgICBzZWxmLmJldCA9IG1zZy52YWx1ZTsNCiAgICBzZWxmLnBheW91dCA9IDA7DQogICAgc2VsZi5ob3VzZUNhcmRzID0gbmV3IHVpbnQ4W10oMCk7DQogICAgc2VsZi5wbGF5ZXJDYXJkcyA9IG5ldyB1aW50OFtdKDApOw0KICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7DQogICAgc2VsZi5zdGF0ZSA9IEdhbWVTdGF0ZS5Jbml0aWFsQ2FyZHM7DQogICAgc2VsZi5yZXN1bHQgPSBHYW1lUmVzdWx0Lk9uZ29pbmc7DQogICAgc2VsZi5jbG9zZWQgPSBmYWxzZTsNCiAgICBzZWxmLmdhbWVJRCA9IGdhbWVJRDsNCg0KICAgIHNlbGYuZGVjay5pbml0KGdhbWVJRCk7DQogIH0NCg0KICBmdW5jdGlvbiB0aWNrKEdhbWUgc3RvcmFnZSBzZWxmKSAgcmV0dXJucyAoYm9vbCkgew0KICAgIGlmIChibG9jay5udW1iZXIgPD0gc2VsZi5hY3Rpb25CbG9jaykgcmV0dXJuIGZhbHNlOyAvLyBDYW4ndCB0aWNrIHlldA0KICAgIGlmIChzZWxmLmFjdGlvbkJsb2NrICsgMjU1IDwgYmxvY2subnVtYmVyKSB7DQogICAgICBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuSG91c2UpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIGlmICghbmVlZHNUaWNrKHNlbGYpKSByZXR1cm4gdHJ1ZTsgLy8gbm90IG5lZWRlZCwgZXZlcnl0aGluZyBpcyBmaW5lDQoNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuSW5pdGlhbENhcmRzKSBkZWFsSW5pdGlhbENhcmRzKHNlbGYpOw0KICAgIGlmIChzZWxmLnN0YXRlID09IEdhbWVTdGF0ZS5IaXQpIGRlYWxIaXRDYXJkKHNlbGYpOw0KDQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLlN0YW5kKSB7DQogICAgICBkZWFsSG91c2VDYXJkcyhzZWxmKTsNCiAgICAgIGNoZWNrR2FtZVJlc3VsdChzZWxmKTsNCiAgICB9IGVsc2Ugew0KICAgICAgY2hlY2tHYW1lQ29udGludWVzKHNlbGYpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gbmVlZHNUaWNrKEdhbWUgc3RvcmFnZSBzZWxmKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7DQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLldhaXRpbmcpIHJldHVybiBmYWxzZTsNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuRmluaXNoZWQpIHJldHVybiBmYWxzZTsNCg0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hlY2tHYW1lUmVzdWx0KEdhbWUgc3RvcmFnZSBzZWxmKSAgew0KICAgIHVpbnQ4IGhvdXNlSGFuZCA9IGNvdW50SGFuZChzZWxmLmhvdXNlQ2FyZHMpOw0KDQogICAgaWYgKGhvdXNlSGFuZCA9PSB0YXJnZXQgJiYgc2VsZi5ob3VzZUNhcmRzLmxlbmd0aCA9PSAyKSByZXR1cm4gZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LkhvdXNlKTsgLy8gSG91c2UgbmF0dXJhbA0KDQogICAgQ29tcGFyYWlzb25SZXN1bHQgcmVzdWx0ID0gY29tcGFyZUhhbmRzKGhvdXNlSGFuZCwgY291bnRIYW5kKHNlbGYucGxheWVyQ2FyZHMpKTsNCiAgICBpZiAocmVzdWx0ID09IENvbXBhcmFpc29uUmVzdWx0LkZpcnN0KSByZXR1cm4gZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LkhvdXNlKTsNCiAgICBpZiAocmVzdWx0ID09IENvbXBhcmFpc29uUmVzdWx0LlNlY29uZCkgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5QbGF5ZXIpOw0KDQogICAgZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LlRpZSk7DQogIH0NCg0KICBmdW5jdGlvbiBjaGVja0dhbWVDb250aW51ZXMoR2FtZSBzdG9yYWdlIHNlbGYpICB7DQogICAgdWludDggcGxheWVySGFuZCA9IGNvdW50SGFuZChzZWxmLnBsYXllckNhcmRzKTsNCiAgICBpZiAocGxheWVySGFuZCA9PSB0YXJnZXQgJiYgc2VsZi5wbGF5ZXJDYXJkcy5sZW5ndGggPT0gMikgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5QbGF5ZXJOYXR1cmFsKTsgLy8gcGxheWVyIG5hdHVyYWwNCiAgICBpZiAocGxheWVySGFuZCA+IHRhcmdldCkgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5Ib3VzZSk7IC8vIFBsYXllciBidXN0ZWQNCiAgICBpZiAocGxheWVySGFuZCA9PSB0YXJnZXQpIHsNCiAgICAgIC8vIFBsYXllciBpcyBmb3JjZWQgdG8gc3RhbmQgd2l0aCAyMQ0KICAgICAgdWludDI1NiBjdXJyZW50QWN0aW9uQmxvY2sgPSBzZWxmLmFjdGlvbkJsb2NrOw0KICAgICAgcGxheWVyRGVjaXNpb24oc2VsZiwgR2FtZVN0YXRlLlN0YW5kKTsNCiAgICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBjdXJyZW50QWN0aW9uQmxvY2s7DQogICAgICBpZiAoIXRpY2soc2VsZikpIHRocm93OyAvLyBGb3JjZXMgdGljaywgY29tbWl0bWVudCB0byBwbGF5IGFjdHVhbGx5IGhhcHBlbmVkIHBhc3QgYmxvY2sNCiAgICB9DQogIH0NCg0KICBmdW5jdGlvbiBwbGF5ZXJEZWNpc2lvbihHYW1lIHN0b3JhZ2Ugc2VsZiwgR2FtZVN0YXRlIGRlY2lzaW9uKSAgew0KICAgIGlmIChzZWxmLnN0YXRlICE9IEdhbWVTdGF0ZS5XYWl0aW5nKSB0aHJvdzsNCiAgICBpZiAoZGVjaXNpb24gIT0gR2FtZVN0YXRlLkhpdCAmJiBkZWNpc2lvbiAhPSBHYW1lU3RhdGUuU3RhbmQpIHRocm93Ow0KDQogICAgc2VsZi5zdGF0ZSA9IGRlY2lzaW9uOw0KICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSW5pdGlhbENhcmRzKEdhbWUgc3RvcmFnZSBzZWxmKSBwcml2YXRlIHsNCiAgICBzZWxmLnBsYXllckNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KICAgIHNlbGYuaG91c2VDYXJkcy5wdXNoKHNlbGYuZGVjay5nZXRDYXJkKHNlbGYuYWN0aW9uQmxvY2spKTsNCiAgICBzZWxmLnBsYXllckNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KDQogICAgc2VsZi5zdGF0ZSA9IEdhbWVTdGF0ZS5XYWl0aW5nOw0KICB9DQoNCiAgZnVuY3Rpb24gZGVhbEhpdENhcmQoR2FtZSBzdG9yYWdlIHNlbGYpIHByaXZhdGUgew0KICAgIHNlbGYucGxheWVyQ2FyZHMucHVzaChzZWxmLmRlY2suZ2V0Q2FyZChzZWxmLmFjdGlvbkJsb2NrKSk7DQoNCiAgICBzZWxmLnN0YXRlID0gR2FtZVN0YXRlLldhaXRpbmc7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSG91c2VDYXJkcyhHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgc2VsZi5ob3VzZUNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KDQogICAgaWYgKGNvdW50SGFuZChzZWxmLmhvdXNlQ2FyZHMpIDwgaG91c2VMaW1pdCkgZGVhbEhvdXNlQ2FyZHMoc2VsZik7DQogIH0NCg0KICBmdW5jdGlvbiBlbmRHYW1lKEdhbWUgc3RvcmFnZSBzZWxmLCBHYW1lUmVzdWx0IHJlc3VsdCkgew0KICAgIHNlbGYucmVzdWx0ID0gcmVzdWx0Ow0KICAgIHNlbGYuc3RhdGUgPSBHYW1lU3RhdGUuRmluaXNoZWQ7DQogICAgc2VsZi5wYXlvdXQgPSBwYXlvdXRGb3JSZXN1bHQoc2VsZi5yZXN1bHQsIHNlbGYuYmV0KTsNCg0KICAgIGNsb3NlR2FtZShzZWxmKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNsb3NlR2FtZShHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgaWYgKHNlbGYuY2xvc2VkKSB0aHJvdzsgLy8gY2Fubm90IHJlLWNsb3NlDQogICAgaWYgKHNlbGYuc3RhdGUgIT0gR2FtZVN0YXRlLkZpbmlzaGVkKSB0aHJvdzsgLy8gbm90IGNsb3NhYmxlDQoNCiAgICBzZWxmLmNsb3NlZCA9IHRydWU7DQoNCiAgICBpZiAoc2VsZi5wYXlvdXQgPiAwKSB7DQogICAgICBpZiAoIXNlbGYucGxheWVyLnNlbmQoc2VsZi5wYXlvdXQpKSB0aHJvdzsNCiAgICB9DQogIH0NCg0KICBmdW5jdGlvbiBwYXlvdXRGb3JSZXN1bHQoR2FtZVJlc3VsdCByZXN1bHQsIHVpbnQyNTYgYmV0KSBwcml2YXRlIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICBpZiAocmVzdWx0ID09IEdhbWVSZXN1bHQuUGxheWVyTmF0dXJhbCkgcmV0dXJuIGJldCAqIDUgLyAyOyAvLyBiZXQgKyAxLjV4IGJldA0KICAgIGlmIChyZXN1bHQgPT0gR2FtZVJlc3VsdC5QbGF5ZXIpIHJldHVybiBiZXQgKiAyOyAvLyBkb3VibGVzIGJldA0KICAgIGlmIChyZXN1bHQgPT0gR2FtZVJlc3VsdC5UaWUpIHJldHVybiBiZXQ7IC8vIHJldHVybnMgYmV0DQoNCiAgICByZXR1cm4gMDsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNvdW50SGFuZCh1aW50OFtdIG1lbW9yeSBoYW5kKSAgcmV0dXJucyAodWludDgpIHsNCiAgICB1aW50OFtdIG1lbW9yeSBwb3NzaWJsZVN1bXMgPSBuZXcgdWludDhbXSgxKTsNCg0KICAgIGZvciAodWludCBpID0gMDsgaSA8IGhhbmQubGVuZ3RoOyBpKyspIHsNCiAgICAgIHVpbnQ4IHZhbHVlID0gaGFuZFtpXS5ibGFja2phY2tWYWx1ZSgpOw0KICAgICAgdWludCBsID0gcG9zc2libGVTdW1zLmxlbmd0aDsNCiAgICAgIGZvciAodWludCBqID0gMDsgaiA8IGw7IGorKykgew0KICAgICAgICBwb3NzaWJsZVN1bXNbal0gKz0gdmFsdWU7DQogICAgICAgIGlmICh2YWx1ZSA9PSAxKSB7IC8vIGlzIEFjZQ0KICAgICAgICAgIHBvc3NpYmxlU3VtcyA9IGFwcGVuZEFycmF5KHBvc3NpYmxlU3VtcywgcG9zc2libGVTdW1zW2pdICsgMTApOyAvLyBGb3JrIHBvc3NpYmxlIHN1bSB3aXRoIDExIGFzIGFjZSB2YWx1ZS4NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBiZXN0U3VtKHBvc3NpYmxlU3Vtcyk7DQogIH0NCg0KICBmdW5jdGlvbiBiZXN0U3VtKHVpbnQ4W10gcG9zc2libGVTdW1zKSAgcmV0dXJucyAodWludDggYmVzdFN1bSkgew0KICAgIGJlc3RTdW0gPSA1MDsgLy8gdmVyeSBiYWQgaGFuZA0KICAgIGZvciAodWludCBpID0gMDsgaSA8IHBvc3NpYmxlU3Vtcy5sZW5ndGg7IGkrKykgew0KICAgICAgaWYgKGNvbXBhcmVIYW5kcyhiZXN0U3VtLCBwb3NzaWJsZVN1bXNbaV0pID09IENvbXBhcmFpc29uUmVzdWx0LlNlY29uZCkgew0KICAgICAgICBiZXN0U3VtID0gcG9zc2libGVTdW1zW2ldOw0KICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm47DQogIH0NCg0KICBmdW5jdGlvbiBhcHBlbmRBcnJheSh1aW50OFtdIG1lbW9yeSBhcnJheSwgdWludDggbikgIHJldHVybnMgKHVpbnQ4W10gbWVtb3J5KSB7DQogICAgdWludDhbXSBtZW1vcnkgbmV3QXJyYXkgPSBuZXcgdWludDhbXShhcnJheS5sZW5ndGggKyAxKTsNCiAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsNCiAgICAgIG5ld0FycmF5W2ldID0gYXJyYXlbaV07DQogICAgfQ0KICAgIG5ld0FycmF5W2FycmF5Lmxlbmd0aF0gPSBuOw0KICAgIHJldHVybiBuZXdBcnJheTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNvbXBhcmVIYW5kcyh1aW50OCBhLCB1aW50OCBiKSAgcmV0dXJucyAoQ29tcGFyYWlzb25SZXN1bHQpIHsNCiAgICBpZiAoYSA8PSB0YXJnZXQgJiYgYiA8PSB0YXJnZXQpIHsNCiAgICAgIGlmIChhID4gYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LkZpcnN0Ow0KICAgICAgaWYgKGEgPCBiKSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIH0NCg0KICAgIGlmIChhID4gdGFyZ2V0ICYmIGIgPiB0YXJnZXQpIHsNCiAgICAgIGlmIChhIDwgYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LkZpcnN0Ow0KICAgICAgaWYgKGEgPiBiKSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIH0NCg0KICAgIGlmIChhID4gdGFyZ2V0KSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIGlmIChiID4gdGFyZ2V0KSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuRmlyc3Q7DQoNCiAgICByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuVGllOw0KICB9DQp9DQoNCmNvbnRyYWN0IEFic3RyYWN0QmxvY2tqYWNrTG9ncyB7DQogIGV2ZW50IEdhbWVFbmRlZCh1aW50MjU2IGdhbWVJRCwgYWRkcmVzcyBwbGF5ZXIsIHVpbnQgZ2FtZVJlc3VsdCwgdWludDI1NiBwYXlvdXQsIHVpbnQ4IHBsYXllckhhbmQsIHVpbnQ4IGhvdXNlSGFuZCk7DQogIGV2ZW50IEdhbWVOZWVkc1RpY2sodWludDI1NiBnYW1lSUQsIGFkZHJlc3MgcGxheWVyLCB1aW50MjU2IGFjdGlvbkJsb2NrKTsNCg0KICBmdW5jdGlvbiByZWNvcmRMb2codWludDI1NiBnYW1lSUQsIGFkZHJlc3MgcGxheWVyLCB1aW50IGdhbWVSZXN1bHQsIHVpbnQyNTYgcGF5b3V0LCB1aW50OCBwbGF5ZXJIYW5kLCB1aW50OCBob3VzZUhhbmQpOw0KICBmdW5jdGlvbiB0aWNrUmVxdWlyZWRMb2codWludDI1NiBnYW1lSUQsIGFkZHJlc3MgcGxheWVyLCB1aW50MjU2IGFjdGlvbkJsb2NrKTsNCn0NCg0KY29udHJhY3QgQmxvY2tqYWNrIHsNCiAgQWJzdHJhY3RCbG9ja2phY2tMb2dzIGJsb2NramFja2xvZ3M7DQoNCiAgdXNpbmcgR2FtZUxpYiBmb3IgR2FtZUxpYi5HYW1lOw0KDQogIEdhbWVMaWIuR2FtZVtdIGdhbWVzOw0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBjdXJyZW50R2FtZTsNCg0KICBib29sIGNvbnRyYWN0Q2xlYXJlZDsNCiAgLy8gSW5pdGlhbCBzZXR0aW5ncw0KICB1aW50MjU2IHB1YmxpYyBtaW5CZXQgPSA1MCBmaW5uZXk7DQogIHVpbnQyNTYgcHVibGljIG1heEJldCA9IDUwMCBmaW5uZXk7DQogIGJvb2wgcHVibGljIGFsbG93c05ld0dhbWVzID0gZmFsc2U7DQogIHVpbnQyNTYgcHVibGljIG1heEJsb2NrQWN0aW9ucyA9IDEwOw0KDQogIG1hcHBpbmcgKHVpbnQyNTYgPT4gdWludDI1NikgYmxvY2tBY3Rpb25zOw0KDQogIC8vIEFkbWluDQogIGFkZHJlc3MgcHVibGljIERYID0gICAgICAgMHgyOTZBZTFkMkQ5QTg3MDFlMTEzRWNkRjZjRTk4NmE0YTdEMEE2ZEM1Ow0KICBhZGRyZXNzIHB1YmxpYyBERVYgPSAgICAgIDB4QkM0MzQzQjExQjdjZmRkNmRENjM1ZjYxMDM5YjhhNjZhRjZFNzNCYjsNCiAgYWRkcmVzcyBwdWJsaWMgQURNSU5fQ09OVFJBQ1Q7DQoNCiAgdWludDI1NiBwdWJsaWMgQkFOS1JPTExfTE9DS19QRVJJT0QgPSAzMCBkYXlzOw0KDQogIHVpbnQyNTYgcHVibGljIGJhbmtyb2xsTG9ja2VkVW50aWw7DQogIHVpbnQyNTYgcHVibGljIHByb2ZpdHNMb2NrZWRVbnRpbDsNCiAgdWludDI1NiBwdWJsaWMgaW5pdGlhbEJhbmtyb2xsOw0KICB1aW50MjU2IHB1YmxpYyBjdXJyZW50QmFua3JvbGw7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgaXNPd25lcjsNCg0KICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgIGlmICghaXNPd25lclttc2cuc2VuZGVyXSkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHkoYWRkcmVzcyB4KSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0geCkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlQbGF5ZXIodWludDI1NiBnYW1lSUQpIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBnYW1lc1tnYW1lSURdLnBsYXllcikgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIGJsb2NrQWN0aW9uUHJvdGVjdGVkIHsNCiAgICBibG9ja0FjdGlvbnNbYmxvY2subnVtYmVyXSArPSAxOw0KICAgIGlmIChibG9ja0FjdGlvbnNbYmxvY2subnVtYmVyXSA+IG1heEJsb2NrQWN0aW9ucykgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIEJsb2NramFjayhhZGRyZXNzIF9hZG1pbl9jb250cmFjdCwgYWRkcmVzcyBfbG9nc19jb250cmFjdCkgeyAvLyBvbmx5KERFVikgew0KICAgIEFETUlOX0NPTlRSQUNUID0gX2FkbWluX2NvbnRyYWN0Ow0KICAgIGJsb2NramFja2xvZ3MgPSBBYnN0cmFjdEJsb2NramFja0xvZ3MoX2xvZ3NfY29udHJhY3QpOw0KICAgIGdhbWVzLmxlbmd0aCArPSAxOw0KICAgIGdhbWVzWzBdLmluaXQoMCk7IC8vIEluaXQgZ2FtZSAwIHNvIGluZGljZXMgc3RhcnQgb24gMQ0KICAgIGdhbWVzWzBdLnBsYXllciA9IHRoaXM7DQogICAgc2V0dXBUcnVzdGVkQWNjb3VudHMoKTsNCiAgfQ0KDQogIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgIHN0YXJ0R2FtZSgpOw0KICB9DQoNCiAgZnVuY3Rpb24gc3RhcnRHYW1lKCkgYmxvY2tBY3Rpb25Qcm90ZWN0ZWQgcGF5YWJsZSB7DQogICAgaWYgKCFhbGxvd3NOZXdHYW1lcykgdGhyb3c7DQogICAgaWYgKG1zZy52YWx1ZSA8IG1pbkJldCkgdGhyb3c7DQogICAgaWYgKG1zZy52YWx1ZSA+IG1heEJldCkgdGhyb3c7DQoNCiAgICAvLyBjaGVjayBpZiBwbGF5ZXIgaGFzIGdhbWUgb3BlbmVkDQogICAgdWludDI1NiBjdXJyZW50R2FtZUlkID0gY3VycmVudEdhbWVbbXNnLnNlbmRlcl07DQogICAgaWYgKGdhbWVzLmxlbmd0aCA+IGN1cnJlbnRHYW1lSWQpIHsNCiAgICAgIEdhbWVMaWIuR2FtZSBvcGVuZWRHYW1lID0gZ2FtZXNbY3VycmVudEdhbWVJZF07DQogICAgICBpZiAob3BlbmVkR2FtZS5wbGF5ZXIgPT0gbXNnLnNlbmRlciAmJiAhb3BlbmVkR2FtZS5jbG9zZWQpIHsgLy8gQ2hlY2sgZm9yIGluZGV4IDAgbWFwcGluZyBwcm9ibGVtcw0KCWlmICghb3BlbmVkR2FtZS50aWNrKCkpIHRocm93Ow0KCWlmICghb3BlbmVkR2FtZS5jbG9zZWQpIHRocm93OyAvLyBjYW5ub3Qgc3RhcnQgZ2FtZSB3aXRoIG9uLWdvaW5nIGdhbWUNCglyZWNvcmRFbmRlZEdhbWUoY3VycmVudEdhbWVJZCk7DQogICAgICB9DQogICAgfQ0KICAgIHVpbnQyNTYgbmV3R2FtZUlEID0gZ2FtZXMubGVuZ3RoOw0KDQogICAgZ2FtZXMubGVuZ3RoICs9IDE7DQogICAgZ2FtZXNbbmV3R2FtZUlEXS5pbml0KG5ld0dhbWVJRCk7DQogICAgY3VycmVudEdhbWVbbXNnLnNlbmRlcl0gPSBuZXdHYW1lSUQ7DQogICAgdGlja1JlcXVpcmVkTG9nKGdhbWVzW25ld0dhbWVJRF0pOw0KICB9DQoNCiAgZnVuY3Rpb24gaGl0KHVpbnQyNTYgZ2FtZUlEKSBvbmx5UGxheWVyKGdhbWVJRCkgYmxvY2tBY3Rpb25Qcm90ZWN0ZWQgew0KICAgIEdhbWVMaWIuR2FtZSBnYW1lID0gZ2FtZXNbZ2FtZUlEXTsNCg0KICAgIGlmICghZ2FtZS50aWNrKCkpIHRocm93Ow0KICAgIGdhbWUucGxheWVyRGVjaXNpb24oR2FtZUxpYi5HYW1lU3RhdGUuSGl0KTsNCiAgICB0aWNrUmVxdWlyZWRMb2coZ2FtZSk7DQogIH0NCg0KICBmdW5jdGlvbiBkb3VibGVEb3duKHVpbnQyNTYgZ2FtZUlEKSBvbmx5UGxheWVyKGdhbWVJRCkgYmxvY2tBY3Rpb25Qcm90ZWN0ZWQgcGF5YWJsZSB7DQogICAgR2FtZUxpYi5HYW1lIGdhbWUgPSBnYW1lc1tnYW1lSURdOw0KDQogICAgaWYgKG1zZy52YWx1ZSAhPSBnYW1lLmJldCkgdGhyb3c7DQogICAgaWYgKCFnYW1lLnRpY2soKSkgdGhyb3c7DQoNCiAgICB1aW50OCB0b3RhbFBsYXllciA9IEdhbWVMaWIuY291bnRIYW5kKGdhbWUucGxheWVyQ2FyZHMpOw0KICAgIGlmICh0b3RhbFBsYXllciA8IDkgfHwgdG90YWxQbGF5ZXIgPiAxMSkgdGhyb3c7DQogICAgaWYgKGdhbWUuYmV0ID4gbWF4QmV0KSB0aHJvdzsNCg0KICAgIGdhbWUuYmV0ICs9IG1zZy52YWx1ZTsNCiAgICBnYW1lLnBsYXllckRlY2lzaW9uKEdhbWVMaWIuR2FtZVN0YXRlLkhpdCk7DQogICAgdGlja1JlcXVpcmVkTG9nKGdhbWUpOw0KICB9DQoNCiAgZnVuY3Rpb24gc3RhbmQodWludDI1NiBnYW1lSUQpIG9ubHlQbGF5ZXIoZ2FtZUlEKSBibG9ja0FjdGlvblByb3RlY3RlZCB7DQogICAgR2FtZUxpYi5HYW1lIGdhbWUgPSBnYW1lc1tnYW1lSURdOw0KDQogICAgaWYgKCFnYW1lLnRpY2soKSkgdGhyb3c7DQogICAgZ2FtZS5wbGF5ZXJEZWNpc2lvbihHYW1lTGliLkdhbWVTdGF0ZS5TdGFuZCk7DQogICAgdGlja1JlcXVpcmVkTG9nKGdhbWUpOw0KICB9DQoNCiAgZnVuY3Rpb24gZ2FtZVRpY2sodWludDI1NiBnYW1lSUQpIGJsb2NrQWN0aW9uUHJvdGVjdGVkIHsNCiAgICBHYW1lTGliLkdhbWUgb3BlbmVkR2FtZSA9IGdhbWVzW2dhbWVJRF07DQogICAgaWYgKG9wZW5lZEdhbWUuY2xvc2VkKSB0aHJvdzsNCiAgICBpZiAoIW9wZW5lZEdhbWUudGljaygpKSB0aHJvdzsNCiAgICBpZiAob3BlbmVkR2FtZS5jbG9zZWQpIHJlY29yZEVuZGVkR2FtZShnYW1lSUQpOw0KICB9DQoNCiAgZnVuY3Rpb24gcmVjb3JkRW5kZWRHYW1lKHVpbnQgZ2FtZUlEKSBwcml2YXRlIHsNCiAgICBHYW1lTGliLkdhbWUgb3BlbmVkR2FtZSA9IGdhbWVzW2dhbWVJRF07DQogICAgY3VycmVudEJhbmtyb2xsID0gY3VycmVudEJhbmtyb2xsICsgb3BlbmVkR2FtZS5iZXQgLSBvcGVuZWRHYW1lLnBheW91dDsNCg0KICAgIGJsb2NramFja2xvZ3MucmVjb3JkTG9nKA0KCQkJICAgIG9wZW5lZEdhbWUuZ2FtZUlELA0KCQkJICAgIG9wZW5lZEdhbWUucGxheWVyLA0KCQkJICAgIHVpbnQob3BlbmVkR2FtZS5yZXN1bHQpLA0KCQkJICAgIG9wZW5lZEdhbWUucGF5b3V0LA0KCQkJICAgIEdhbWVMaWIuY291bnRIYW5kKG9wZW5lZEdhbWUucGxheWVyQ2FyZHMpLA0KCQkJICAgIEdhbWVMaWIuY291bnRIYW5kKG9wZW5lZEdhbWUuaG91c2VDYXJkcykNCgkJCSAgICApOw0KICB9DQoNCiAgZnVuY3Rpb24gdGlja1JlcXVpcmVkTG9nKEdhbWVMaWIuR2FtZSBzdG9yYWdlIGdhbWUpIHByaXZhdGUgew0KICAgIGJsb2NramFja2xvZ3MudGlja1JlcXVpcmVkTG9nKGdhbWUuZ2FtZUlELCBnYW1lLnBsYXllciwgZ2FtZS5hY3Rpb25CbG9jayk7DQogIH0NCg0KICAvLyBDb25zdGFudHMNCg0KICBmdW5jdGlvbiBnYW1lU3RhdGUodWludCBpKSBjb25zdGFudCByZXR1cm5zICh1aW50OFtdLCB1aW50OFtdLCB1aW50OCwgdWludDgsIHVpbnQyNTYsIHVpbnQyNTYsIHVpbnQ4LCB1aW50OCwgYm9vbCwgdWludDI1Nikgew0KICAgIEdhbWVMaWIuR2FtZSBnYW1lID0gZ2FtZXNbaV07DQoNCiAgICByZXR1cm4gKA0KCSAgICBnYW1lLmhvdXNlQ2FyZHMsDQoJICAgIGdhbWUucGxheWVyQ2FyZHMsDQoJICAgIEdhbWVMaWIuY291bnRIYW5kKGdhbWUuaG91c2VDYXJkcyksDQoJICAgIEdhbWVMaWIuY291bnRIYW5kKGdhbWUucGxheWVyQ2FyZHMpLA0KCSAgICBnYW1lLmJldCwNCgkgICAgZ2FtZS5wYXlvdXQsDQoJICAgIHVpbnQ4KGdhbWUuc3RhdGUpLA0KCSAgICB1aW50OChnYW1lLnJlc3VsdCksDQoJICAgIGdhbWUuY2xvc2VkLA0KCSAgICBnYW1lLmFjdGlvbkJsb2NrDQoJICAgICk7DQogIH0NCg0KICAvLyBBZG1pbg0KICBmdW5jdGlvbiBzZXR1cFRydXN0ZWRBY2NvdW50cygpDQogICAgaW50ZXJuYWwNCiAgew0KICAgIGlzT3duZXJbRFhdID0gdHJ1ZTsNCiAgICBpc093bmVyW0RFVl0gPSB0cnVlOw0KICAgIGlzT3duZXJbQURNSU5fQ09OVFJBQ1RdID0gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZURldihhZGRyZXNzIG5ld0Rldikgb25seShERVYpIHsNCiAgICBpc093bmVyW0RFVl0gPSBmYWxzZTsNCiAgICBERVYgPSBuZXdEZXY7DQogICAgaXNPd25lcltERVZdID0gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZURYKGFkZHJlc3MgbmV3RFgpIG9ubHkoRFgpIHsNCiAgICBpc093bmVyW0RYXSA9IGZhbHNlOw0KICAgIERYID0gbmV3RFg7DQogICAgaXNPd25lcltEWF0gPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hhbmdlQWRtaW5Db250cmFjdChhZGRyZXNzIF9uZXdfYWRtaW5fY29udHJhY3QpIG9ubHkoQURNSU5fQ09OVFJBQ1QpIHsNCiAgICBpc093bmVyW0FETUlOX0NPTlRSQUNUXSA9IGZhbHNlOw0KICAgIEFETUlOX0NPTlRSQUNUID0gX25ld19hZG1pbl9jb250cmFjdDsNCiAgICBpc093bmVyW0FETUlOX0NPTlRSQUNUXSA9IHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBzZXRTZXR0aW5ncyh1aW50MjU2IF9taW4sIHVpbnQyNTYgX21heCwgdWludDI1NiBfbWF4QmxvY2tBY3Rpb25zKSBvbmx5KEFETUlOX0NPTlRSQUNUKSB7DQogICAgbWluQmV0ID0gX21pbjsNCiAgICBtYXhCZXQgPSBfbWF4Ow0KICAgIG1heEJsb2NrQWN0aW9ucyA9IF9tYXhCbG9ja0FjdGlvbnM7DQogIH0NCg0KICBmdW5jdGlvbiByZWdpc3Rlck93bmVyKGFkZHJlc3MgX25ld193YXRjaGVyKSBvbmx5KEFETUlOX0NPTlRSQUNUKSB7DQogICAgaXNPd25lcltfbmV3X3dhdGNoZXJdID0gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3MgX29sZF93YXRjaGVyKSBvbmx5KEFETUlOX0NPTlRSQUNUKSB7DQogICAgaXNPd25lcltfb2xkX3dhdGNoZXJdID0gZmFsc2U7DQogIH0NCg0KICBmdW5jdGlvbiBzdG9wQmxvY2tqYWNrKCkgb25seU93bmVyIHsNCiAgICBhbGxvd3NOZXdHYW1lcyA9IGZhbHNlOw0KICB9DQoNCiAgZnVuY3Rpb24gc3RhcnRCbG9ja2phY2soKSBvbmx5KEFETUlOX0NPTlRSQUNUKSB7DQogICAgYWxsb3dzTmV3R2FtZXMgPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gYWRkQmFua3JvbGwoKSBvbmx5KERYKSBwYXlhYmxlIHsNCiAgICBpbml0aWFsQmFua3JvbGwgKz0gbXNnLnZhbHVlOw0KICAgIGN1cnJlbnRCYW5rcm9sbCArPSBtc2cudmFsdWU7DQogIH0NCg0KICBmdW5jdGlvbiByZW1haW5pbmdCYW5rcm9sbCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gY3VycmVudEJhbmtyb2xsID4gaW5pdGlhbEJhbmtyb2xsID8gaW5pdGlhbEJhbmtyb2xsIDogY3VycmVudEJhbmtyb2xsOw0KICB9DQoNCiAgZnVuY3Rpb24gcmVtb3ZlQmFua3JvbGwoKSBvbmx5KERYKSB7DQogICAgaWYgKGluaXRpYWxCYW5rcm9sbCA+IGN1cnJlbnRCYW5rcm9sbCAtIDUgZXRoZXIgJiYgYmFua3JvbGxMb2NrZWRVbnRpbCA+IG5vdykgdGhyb3c7DQoNCiAgICBzdG9wQmxvY2tqYWNrKCk7DQoNCiAgICBpZiAoY3VycmVudEJhbmtyb2xsID4gaW5pdGlhbEJhbmtyb2xsKSB7IC8vIHRoZXJlIGFyZSBwcm9maXRzDQogICAgICBpZiAoIURFVi5zZW5kKGN1cnJlbnRCYW5rcm9sbCAtIGluaXRpYWxCYW5rcm9sbCkpIHRocm93Ow0KICAgIH0NCg0KICAgIHN1aWNpZGUoRFgpOyAvLyBzZW5kIHJlc3QgdG8gZHgNCiAgICBjb250cmFjdENsZWFyZWQgPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gbWlncmF0ZUJsb2NramFjaygpIG9ubHkoQURNSU5fQ09OVFJBQ1QpIHsNCiAgICBzdG9wQmxvY2tqYWNrKCk7DQoNCiAgICBpZiAoY3VycmVudEJhbmtyb2xsID4gaW5pdGlhbEJhbmtyb2xsKSB7IC8vIHRoZXJlIGFyZSBwcm9maXRzLCBzaGFyZSB0aGVtDQogICAgICBpZiAoIUFETUlOX0NPTlRSQUNULmNhbGwudmFsdWUoY3VycmVudEJhbmtyb2xsIC0gaW5pdGlhbEJhbmtyb2xsKSgpKSB0aHJvdzsNCiAgICB9DQogICAgc3VpY2lkZShEWCk7IC8vIHNlbmQgcmVzdCB0byBkeA0KICAgIC8vRFggd2lsbCBoYXZlIHRvIHJlZnVuZCB0aGUgbm9uIGZpbmFsaXplZCBiZXRzIHRoYXQgbWF5IGhhdmUgYmVlbiBzdG9wcGVkDQogIH0NCg0KICBmdW5jdGlvbiBzaGFyZVByb2ZpdHMoKSBvbmx5T3duZXIgew0KICAgIGlmIChwcm9maXRzTG9ja2VkVW50aWwgPiBub3cpIHRocm93Ow0KICAgIGlmIChjdXJyZW50QmFua3JvbGwgPD0gaW5pdGlhbEJhbmtyb2xsKSB0aHJvdzsgLy8gdGhlcmUgYXJlIG5vIHByb2ZpdHMNCg0KICAgIHVpbnQyNTYgcHJvZml0ID0gY3VycmVudEJhbmtyb2xsIC0gaW5pdGlhbEJhbmtyb2xsOw0KICAgIGlmICghQURNSU5fQ09OVFJBQ1QuY2FsbC52YWx1ZShwcm9maXQpKCkpIHRocm93Ow0KICAgIGN1cnJlbnRCYW5rcm9sbCAtPSBwcm9maXQ7DQoNCiAgICBiYW5rcm9sbExvY2tlZFVudGlsID0gbm93ICsgQkFOS1JPTExfTE9DS19QRVJJT0Q7DQogICAgcHJvZml0c0xvY2tlZFVudGlsID0gYmFua3JvbGxMb2NrZWRVbnRpbCArIEJBTktST0xMX0xPQ0tfUEVSSU9EOw0KICB9DQp9'