base 64 content
base64cHEXToken2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCi8qKg0KICogT3ZlcmZsb3cgYXdhcmUgdWludCBtYXRoIGZ1bmN0aW9ucy4NCiAqLw0KY29udHJhY3QgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgdWludDI1NiBjID0gYSAvIGI7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBwY3QodWludCBudW1lcmF0b3IsIHVpbnQgZGVub21pbmF0b3IsIHVpbnQgcHJlY2lzaW9uKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQgcXVvdGllbnQpIHsNCiAgICB1aW50IF9udW1lcmF0b3IgPSBudW1lcmF0b3IgKiAxMCAqKiAocHJlY2lzaW9uKzEpOw0KICAgIHVpbnQgX3F1b3RpZW50ID0gKChfbnVtZXJhdG9yIC8gZGVub21pbmF0b3IpICsgNSkgLyAxMDsNCiAgICByZXR1cm4gKF9xdW90aWVudCk7DQogIH0NCg0KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYyA+PSBhKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCn0NCg0KLyoqDQogKiBFUkMgMjAgdG9rZW4NCiAqLw0KY29udHJhY3QgVG9rZW4gaXMgU2FmZU1hdGggew0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOw0KICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzdWIoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KDQogICAgLy8gQSB2dWxlcm5hYmlsaXR5IG9mIHRoZSBhcHByb3ZlIG1ldGhvZCBpbiB0aGUgRVJDMjAgc3RhbmRhcmQgd2FzIGlkZW50aWZpZWQgYnkNCiAgICAvLyBNaWtoYWlsIFZsYWRpbWlyb3YgYW5kIERtaXRyeSBLaG92cmF0b3ZpY2ggaGVyZToNCiAgICAvLyBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFZTFB0UXhadTFVQXZPOWNaMU8yUlBYQmJUMG1vb2g0RFlLakFfanAtUkxNDQogICAgLy8gSXQncyBiZXR0ZXIgdG8gdXNlIHRoaXMgbWV0aG9kIHdoaWNoIGlzIG5vdCBzdXNjZXB0aWJsZSB0byBvdmVyLXdpdGhkcmF3aW5nIGJ5IHRoZSBhcHByb3ZlZS4NCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHRvIGFwcHJvdmUNCiAgICAvLy8gQHBhcmFtIF9jdXJyZW50VmFsdWUgVGhlIHByZXZpb3VzIHZhbHVlIGFwcHJvdmVkLCB3aGljaCBjYW4gYmUgcmV0cmlldmVkIHdpdGggYWxsb3dhbmNlKG1zZy5zZW5kZXIsIF9zcGVuZGVyKQ0KICAgIC8vLyBAcGFyYW0gX25ld1ZhbHVlIFRoZSBuZXcgdmFsdWUgdG8gYXBwcm92ZSwgdGhpcyB3aWxsIHJlcGxhY2UgdGhlIF9jdXJyZW50VmFsdWUNCiAgICAvLy8gQHJldHVybiBib29sIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBhIHN1Y2Nlc3MgKHNlZSBFUkMyMCdzIGBhcHByb3ZlYCkNCiAgICBmdW5jdGlvbiBjb21wYXJlQW5kQXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9jdXJyZW50VmFsdWUsIHVpbnQyNTYgX25ld1ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7DQogICAgICAgIGlmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSBfY3VycmVudFZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBhcHByb3ZlKF9zcGVuZGVyLCBfbmV3VmFsdWUpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgQ0hFWFRva2VuIGlzIFRva2VuIHsNCg0KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJDSEVYIFRva2VuIjsNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJDSFgiOw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7DQogICAgdWludCBwdWJsaWMgc3RhcnRCbG9jazsgLy9jcm93ZHNhbGUgc3RhcnQgYmxvY2sNCiAgICB1aW50IHB1YmxpYyBlbmRCbG9jazsgLy9jcm93ZHNhbGUgZW5kIGJsb2NrDQoNCiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGVyOw0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIA0KICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMjAwMDAwMDAwMCAqIDEwKipkZWNpbWFsczsgLy8gMmIgdG9rZW5zLCBlYWNoIGRpdmlkZWQgdG8gdXAgdG8gMTBeZGVjaW1hbHMgdW5pdHMuDQogICAgdWludCBwdWJsaWMgZXRoZXJDYXAgPSAyNTAwMDAwICogMTAqKmRlY2ltYWxzOw0KICAgIA0KICAgIHVpbnQgcHVibGljIHRvdGFsVG9rZW5zID0gMDsNCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlU3VwcGx5ID0gMDsNCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlRXRoZXJSYWlzZWQgPSAwOw0KDQogICAgZXZlbnQgQnV5KGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQgZXRoLCB1aW50IGNoeCk7DQogICAgZXZlbnQgRGVsaXZlcihhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IGNoeCwgc3RyaW5nIF9mb3IpOw0KDQogICAgdWludCBwdWJsaWMgcHJlc2FsZUFsbG9jYXRpb24gPSB0b3RhbFN1cHBseSAvIDI7IC8vNTAlIG9mIHRva2VuIHN1cHBseSBhbGxvY2F0ZWQgZm9yIGNyb3dkc2FsZQ0KICAgIHVpbnQgcHVibGljIHN0cmF0ZWdpY0FsbG9jYXRpb24gPSB0b3RhbFN1cHBseSAvIDQ7IC8vMjUlIG9mIHRva2VuIHN1cHBseSBhbGxvY2F0ZWQgcG9zdC1jcm93ZHNhbGUgZm9yIHN0cmF0ZWdpYyBzdXBwbHkNCiAgICB1aW50IHB1YmxpYyByZXNlcnZlQWxsb2NhdGlvbiA9IHRvdGFsU3VwcGx5IC8gNDsgLy8yNSUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBwb3N0LWNyb3dkc2FsZSBmb3IgaW50ZXJuYWwNCiAgICBib29sIHB1YmxpYyBzdHJhdGVnaWNBbGxvY2F0ZWQgPSBmYWxzZTsNCiAgICBib29sIHB1YmxpYyByZXNlcnZlQWxsb2NhdGVkID0gZmFsc2U7DQoNCiAgICB1aW50IHB1YmxpYyB0cmFuc2ZlckxvY2t1cCA9IDU3NjA7IC8vbm8gdHJhbnNmZXJzIHVudGlsIDEgZGF5IGFmdGVyIHNhbGUgaXMgb3Zlcg0KICAgIHVpbnQgcHVibGljIHN0cmF0ZWdpY0xvY2t1cCA9IDgwNjQwOyAvL3N0cmF0ZWdpYyBzdXBwbHkgbG9ja2VkIHVudGlsIDE0IGRheXMgYWZ0ZXIgc2FsZSBpcyBvdmVyDQogICAgdWludCBwdWJsaWMgcmVzZXJ2ZUxvY2t1cCA9IDI0MTkyMDsgLy9maXJzdCB3YXZlIG9mIHJlc2VydmUgbG9ja2VkIHVudGlsIDQyIGRheXMgYWZ0ZXIgc2FsZSBpcyBvdmVyDQoNCiAgICB1aW50IHB1YmxpYyByZXNlcnZlV2F2ZSA9IDA7IC8vaW5jcmVtZW50cyBlYWNoIHRpbWUgMTAlIG9mIHJlc2VydmUgaXMgYWxsb2NhdGVkLCB0byBhIG1heCBvZiAxMA0KICAgIHVpbnQgcHVibGljIHJlc2VydmVXYXZlVG9rZW5zID0gcmVzZXJ2ZUFsbG9jYXRpb24gLyAxMDsgLy8xMCUgb2YgcmVzZXJ2ZSB3aWxsIGJlIHJlbGVhc2VkIG9uIGVhY2ggd2F2ZQ0KICAgIHVpbnQgcHVibGljIHJlc2VydmVXYXZlTG9ja3VwID0gMTcyODAwOyAvLzMwIGRheSBpbnRlcnZhbHMgYmVmb3JlIHN1YnNlcXVlbnQgd2F2ZSBvZiByZXNlcnZlIHRva2VucyBjYW4gYmUgcmVsZWFzZWQNCg0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9FVEhFUiA9IDEgZmlubmV5Ow0KDQogICAgZW51bSBUb2tlblNhbGVTdGF0ZSB7DQogICAgICAgIEluaXRpYWwsICAgIC8vY29udHJhY3QgaW5pdGlhbGl6ZWQsIGJvbnVzIHRva2VuDQogICAgICAgIFByZXNhbGUsICAgIC8vbGltaXRlZCB0aW1lIGNyb3dkc2FsZQ0KICAgICAgICBMaXZlLCAgICAgICAvL2RlZmF1bHQgcHJpY2UNCiAgICAgICAgRnJvemVuICAgICAgLy9wcmV2ZW50IHNhbGUgb2YgdG9rZW5zDQogICAgfQ0KDQogICAgVG9rZW5TYWxlU3RhdGUgcHVibGljIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsOw0KDQogICAgZnVuY3Rpb24gQ0hFWFRva2VuKGFkZHJlc3MgZm91bmRlcklucHV0LCBhZGRyZXNzIG93bmVySW5wdXQsIHVpbnQgc3RhcnRCbG9ja0lucHV0LCB1aW50IGVuZEJsb2NrSW5wdXQpIHsNCiAgICAgICAgZm91bmRlciA9IGZvdW5kZXJJbnB1dDsNCiAgICAgICAgb3duZXIgPSBvd25lcklucHV0Ow0KICAgICAgICBzdGFydEJsb2NrID0gc3RhcnRCbG9ja0lucHV0Ow0KICAgICAgICBlbmRCbG9jayA9IGVuZEJsb2NrSW5wdXQ7DQogICAgICAgIA0KICAgICAgICB1cGRhdGVUb2tlblNhbGVTdGF0ZSgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHByaWNlKCkgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwpIHJldHVybiA2MDAxOw0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSB7DQogICAgICAgICAgICB1aW50IHBlcmNlbnRSZW1haW5pbmcgPSBwY3QoKGVuZEJsb2NrIC0gYmxvY2subnVtYmVyKSwgKGVuZEJsb2NrIC0gc3RhcnRCbG9jayksIDMpOw0KICAgICAgICAgICAgcmV0dXJuIDMwMDAgKyAzICogcGVyY2VudFJlbWFpbmluZzsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gMzAwMDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB1cGRhdGVUb2tlblNhbGVTdGF0ZSAoKSB7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkZyb3plbikgcmV0dXJuOw0KDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkxpdmUgJiYgYmxvY2subnVtYmVyID4gZW5kQmxvY2spIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgJiYgYmxvY2subnVtYmVyID49IHN0YXJ0QmxvY2spIHsNCiAgICAgICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlICYmIGJsb2NrLm51bWJlciA+IGVuZEJsb2NrKSB7DQogICAgICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuTGl2ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7DQogICAgICAgIGJ1eShtc2cuc2VuZGVyKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBidXkoYWRkcmVzcyByZWNpcGllbnQpIHBheWFibGUgew0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDB4MCkgdGhyb3c7DQogICAgICAgIGlmIChtc2cudmFsdWUgPCBNSU5fRVRIRVIpIHRocm93Ow0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW4pIHRocm93Ow0KICAgICAgICBpZiAoKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCB8fCBfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpICYmIHByZXNhbGVTdXBwbHkgPj0gcHJlc2FsZUFsbG9jYXRpb24pIHRocm93Ow0KICAgICAgICBpZiAoKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCB8fCBfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpICYmIHByZXNhbGVFdGhlclJhaXNlZCA+PSBldGhlckNhcCkgdGhyb3c7DQoNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICAgICAgdWludCB0b2tlbnMgPSBtdWwobXNnLnZhbHVlLCBwcmljZSgpKTsNCg0KICAgICAgICBpZiAodG9rZW5zIDw9IDApIHRocm93Ow0KICAgICAgICANCiAgICAgICAgYmFsYW5jZXNbcmVjaXBpZW50XSA9IGFkZChiYWxhbmNlc1tyZWNpcGllbnRdLCB0b2tlbnMpOw0KICAgICAgICB0b3RhbFRva2VucyA9IGFkZCh0b3RhbFRva2VucywgdG9rZW5zKTsNCg0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsIHx8IF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgew0KICAgICAgICAgICAgcHJlc2FsZUV0aGVyUmFpc2VkID0gYWRkKHByZXNhbGVFdGhlclJhaXNlZCwgbXNnLnZhbHVlKTsNCiAgICAgICAgICAgIHByZXNhbGVTdXBwbHkgPSBhZGQocHJlc2FsZVN1cHBseSwgdG9rZW5zKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvdW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsNCiAgICAgICAgDQogICAgICAgIFRyYW5zZmVyKDAsIHJlY2lwaWVudCwgdG9rZW5zKTsNCiAgICAgICAgQnV5KHJlY2lwaWVudCwgbXNnLnZhbHVlLCB0b2tlbnMpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZW5kQmxvY2sgKyB0cmFuc2ZlckxvY2t1cCAmJiBtc2cuc2VuZGVyICE9IGZvdW5kZXIgJiYgbXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZW5kQmxvY2sgKyB0cmFuc2ZlckxvY2t1cCAmJiBtc2cuc2VuZGVyICE9IGZvdW5kZXIgJiYgbXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlckZyb20oX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5SW50ZXJuYWwgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBmb3VuZGVyKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkZWxpdmVyKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50IHRva2Vucywgc3RyaW5nIF9mb3IpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmICh0b2tlbnMgPD0gMCkgdGhyb3c7DQogICAgICAgIGlmICh0b3RhbFRva2VucyA+PSB0b3RhbFN1cHBseSkgdGhyb3c7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkZyb3plbikgdGhyb3c7DQogICAgICAgIGlmICgoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsIHx8IF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgJiYgcHJlc2FsZVN1cHBseSA+PSBwcmVzYWxlQWxsb2NhdGlvbikgdGhyb3c7DQoNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCg0KICAgICAgICBiYWxhbmNlc1tyZWNpcGllbnRdID0gYWRkKGJhbGFuY2VzW3JlY2lwaWVudF0sIHRva2Vucyk7DQogICAgICAgIHRvdGFsVG9rZW5zID0gYWRkKHRvdGFsVG9rZW5zLCB0b2tlbnMpOw0KDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSB7DQogICAgICAgICAgICBwcmVzYWxlU3VwcGx5ID0gYWRkKHByZXNhbGVTdXBwbHksIHRva2Vucyk7DQogICAgICAgIH0NCg0KICAgICAgICBUcmFuc2ZlcigwLCByZWNpcGllbnQsIHRva2Vucyk7ICAgIA0KICAgICAgICBEZWxpdmVyKHJlY2lwaWVudCwgdG9rZW5zLCBfZm9yKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvY2F0ZVN0cmF0ZWdpY1Rva2VucygpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZW5kQmxvY2sgKyBzdHJhdGVnaWNMb2NrdXApIHRocm93Ow0KICAgICAgICBpZiAoc3RyYXRlZ2ljQWxsb2NhdGVkKSB0aHJvdzsNCg0KICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBhZGQoYmFsYW5jZXNbb3duZXJdLCBzdHJhdGVnaWNBbGxvY2F0aW9uKTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBhZGQodG90YWxUb2tlbnMsIHN0cmF0ZWdpY0FsbG9jYXRpb24pOw0KDQogICAgICAgIHN0cmF0ZWdpY0FsbG9jYXRlZCA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYWxsb2NhdGVSZXNlcnZlVG9rZW5zKCkgb25seUludGVybmFsIHsNCiAgICAgICAgaWYgKGJsb2NrLm51bWJlciA8PSBlbmRCbG9jayArIHJlc2VydmVMb2NrdXAgKyAocmVzZXJ2ZVdhdmVMb2NrdXAgKiByZXNlcnZlV2F2ZSkpIHRocm93Ow0KICAgICAgICBpZiAocmVzZXJ2ZUFsbG9jYXRlZCkgdGhyb3c7DQoNCiAgICAgICAgYmFsYW5jZXNbZm91bmRlcl0gPSBhZGQoYmFsYW5jZXNbZm91bmRlcl0sIHJlc2VydmVXYXZlVG9rZW5zKTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBhZGQodG90YWxUb2tlbnMsIHJlc2VydmVXYXZlVG9rZW5zKTsNCg0KICAgICAgICByZXNlcnZlV2F2ZSsrOw0KICAgICAgICBpZiAocmVzZXJ2ZVdhdmUgPj0gMTApIHsNCiAgICAgICAgICAgIHJlc2VydmVBbGxvY2F0ZWQgPSB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZnJlZXplKCkgb25seUludGVybmFsIHsNCiAgICAgICAgX3NhbGVTdGF0ZSA9IFRva2VuU2FsZVN0YXRlLkZyb3plbjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB1bmZyZWV6ZSgpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlOw0KICAgICAgICB1cGRhdGVUb2tlblNhbGVTdGF0ZSgpOw0KICAgIH0NCg0KfQ=='