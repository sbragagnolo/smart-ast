base 64 content
base64cHEXToken5
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCi8qKg0KICogT3ZlcmZsb3cgYXdhcmUgdWludCBtYXRoIGZ1bmN0aW9ucy4NCiAqLw0KY29udHJhY3QgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgdWludDI1NiBjID0gYSAvIGI7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBwY3QodWludCBudW1lcmF0b3IsIHVpbnQgZGVub21pbmF0b3IsIHVpbnQgcHJlY2lzaW9uKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQgcXVvdGllbnQpIHsNCiAgICB1aW50IF9udW1lcmF0b3IgPSBudW1lcmF0b3IgKiAxMCAqKiAocHJlY2lzaW9uKzEpOw0KICAgIHVpbnQgX3F1b3RpZW50ID0gKChfbnVtZXJhdG9yIC8gZGVub21pbmF0b3IpICsgNSkgLyAxMDsNCiAgICByZXR1cm4gKF9xdW90aWVudCk7DQogIH0NCg0KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYyA+PSBhKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCn0NCg0KLyoqDQogKiBFUkMgMjAgdG9rZW4NCiAqLw0KY29udHJhY3QgVG9rZW4gaXMgU2FmZU1hdGggew0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gYWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gPSBzdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOw0KICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzdWIoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KDQogICAgLy8gQSB2dWxlcm5hYmlsaXR5IG9mIHRoZSBhcHByb3ZlIG1ldGhvZCBpbiB0aGUgRVJDMjAgc3RhbmRhcmQgd2FzIGlkZW50aWZpZWQgYnkNCiAgICAvLyBNaWtoYWlsIFZsYWRpbWlyb3YgYW5kIERtaXRyeSBLaG92cmF0b3ZpY2ggaGVyZToNCiAgICAvLyBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFZTFB0UXhadTFVQXZPOWNaMU8yUlBYQmJUMG1vb2g0RFlLakFfanAtUkxNDQogICAgLy8gSXQncyBiZXR0ZXIgdG8gdXNlIHRoaXMgbWV0aG9kIHdoaWNoIGlzIG5vdCBzdXNjZXB0aWJsZSB0byBvdmVyLXdpdGhkcmF3aW5nIGJ5IHRoZSBhcHByb3ZlZS4NCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHRvIGFwcHJvdmUNCiAgICAvLy8gQHBhcmFtIF9jdXJyZW50VmFsdWUgVGhlIHByZXZpb3VzIHZhbHVlIGFwcHJvdmVkLCB3aGljaCBjYW4gYmUgcmV0cmlldmVkIHdpdGggYWxsb3dhbmNlKG1zZy5zZW5kZXIsIF9zcGVuZGVyKQ0KICAgIC8vLyBAcGFyYW0gX25ld1ZhbHVlIFRoZSBuZXcgdmFsdWUgdG8gYXBwcm92ZSwgdGhpcyB3aWxsIHJlcGxhY2UgdGhlIF9jdXJyZW50VmFsdWUNCiAgICAvLy8gQHJldHVybiBib29sIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBhIHN1Y2Nlc3MgKHNlZSBFUkMyMCdzIGBhcHByb3ZlYCkNCiAgICBmdW5jdGlvbiBjb21wYXJlQW5kQXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9jdXJyZW50VmFsdWUsIHVpbnQyNTYgX25ld1ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7DQogICAgICAgIGlmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSBfY3VycmVudFZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBhcHByb3ZlKF9zcGVuZGVyLCBfbmV3VmFsdWUpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgQ0hFWFRva2VuIGlzIFRva2VuIHsNCg0KICAgIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJDSEVYIFRva2VuIjsNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJDSFgiOw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7DQogICAgdWludCBwdWJsaWMgc3RhcnRCbG9jazsgLy9jcm93ZHNhbGUgc3RhcnQgYmxvY2sNCiAgICB1aW50IHB1YmxpYyBlbmRCbG9jazsgLy9jcm93ZHNhbGUgZW5kIGJsb2NrDQoNCiAgICBhZGRyZXNzIHB1YmxpYyBmb3VuZGVyOw0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIA0KICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMjAwMDAwMDAwMCAqIDEwKipkZWNpbWFsczsgLy8gMmIgdG9rZW5zLCBlYWNoIGRpdmlkZWQgdG8gdXAgdG8gMTBeZGVjaW1hbHMgdW5pdHMuDQogICAgdWludCBwdWJsaWMgZXRoZXJDYXAgPSAyNTAwMDAwICogMTAqKmRlY2ltYWxzOw0KICAgIA0KICAgIHVpbnQgcHVibGljIHRvdGFsVG9rZW5zID0gMDsNCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlU3VwcGx5ID0gMDsNCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlRXRoZXJSYWlzZWQgPSAwOw0KDQogICAgZXZlbnQgQnV5KGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQgZXRoLCB1aW50IGNoeCk7DQogICAgZXZlbnQgRGVsaXZlcihhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IGNoeCwgc3RyaW5nIF9mb3IpOw0KDQogICAgdWludCBwdWJsaWMgcHJlc2FsZUFsbG9jYXRpb24gPSB0b3RhbFN1cHBseSAvIDI7IC8vNTAlIG9mIHRva2VuIHN1cHBseSBhbGxvY2F0ZWQgZm9yIGNyb3dkc2FsZQ0KICAgIHVpbnQgcHVibGljIGVjb3N5c3RlbUFsbG9jYXRpb24gPSB0b3RhbFN1cHBseSAvIDQ7IC8vMjUlIG9mIHRva2VuIHN1cHBseSBhbGxvY2F0ZWQgcG9zdC1jcm93ZHNhbGUgZm9yIHRoZSBlY29zeXN0ZW0gZnVuZA0KICAgIHVpbnQgcHVibGljIHJlc2VydmVkQWxsb2NhdGlvbiA9IHRvdGFsU3VwcGx5IC8gNDsgLy8yNSUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBwb3N0LWNyb3dkc2FsZSBmb3IgaW50ZXJuYWwNCiAgICBib29sIHB1YmxpYyBlY29zeXN0ZW1BbGxvY2F0ZWQgPSBmYWxzZTsNCg0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9FVEhFUiA9IDEwIGZpbm5leTsNCg0KICAgIGVudW0gVG9rZW5TYWxlU3RhdGUgew0KICAgICAgICBJbml0aWFsLCAgICAvL2NvbnRyYWN0IGluaXRpYWxpemVkLCBib251cyB0b2tlbg0KICAgICAgICBQcmVzYWxlLCAgICAvL2xpbWl0ZWQgdGltZSBjcm93ZHNhbGUNCiAgICAgICAgTGl2ZSwgICAgICAgLy9kZWZhdWx0IHByaWNlDQogICAgICAgIEZyb3plbiAgICAgIC8vcHJldmVudCBzYWxlIG9mIHRva2Vucw0KICAgIH0NCg0KICAgIFRva2VuU2FsZVN0YXRlIHB1YmxpYyBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbDsNCg0KICAgIGZ1bmN0aW9uIENIRVhUb2tlbihhZGRyZXNzIGZvdW5kZXJJbnB1dCwgYWRkcmVzcyBvd25lcklucHV0LCB1aW50IHN0YXJ0QmxvY2tJbnB1dCwgdWludCBlbmRCbG9ja0lucHV0KSB7DQogICAgICAgIGZvdW5kZXIgPSBmb3VuZGVySW5wdXQ7DQogICAgICAgIG93bmVyID0gb3duZXJJbnB1dDsNCiAgICAgICAgc3RhcnRCbG9jayA9IHN0YXJ0QmxvY2tJbnB1dDsNCiAgICAgICAgZW5kQmxvY2sgPSBlbmRCbG9ja0lucHV0Ow0KICAgICAgICANCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwcmljZSgpIGNvbnN0YW50IHJldHVybnModWludCkgew0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsKSByZXR1cm4gNjAwMTsNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgew0KICAgICAgICAgICAgdWludCBwZXJjZW50UmVtYWluaW5nID0gcGN0KChlbmRCbG9jayAtIGJsb2NrLm51bWJlciksIChlbmRCbG9jayAtIHN0YXJ0QmxvY2spLCAzKTsNCiAgICAgICAgICAgIHJldHVybiAzMDAwICsgMyAqIHBlcmNlbnRSZW1haW5pbmc7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIDMwMDA7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdXBkYXRlVG9rZW5TYWxlU3RhdGUgKCkgew0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW4pIHJldHVybjsNCg0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5MaXZlICYmIGJsb2NrLm51bWJlciA+IGVuZEJsb2NrKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsICYmIGJsb2NrLm51bWJlciA+PSBzdGFydEJsb2NrKSB7DQogICAgICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSAmJiBibG9jay5udW1iZXIgPiBlbmRCbG9jaykgew0KICAgICAgICAgICAgX3NhbGVTdGF0ZSA9IFRva2VuU2FsZVN0YXRlLkxpdmU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbigpIHBheWFibGUgew0KICAgICAgICBidXkobXNnLnNlbmRlcik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYnV5KGFkZHJlc3MgcmVjaXBpZW50KSBwYXlhYmxlIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAweDApIHRocm93Ow0KICAgICAgICBpZiAobXNnLnZhbHVlIDwgTUlOX0VUSEVSKSB0aHJvdzsNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuRnJvemVuKSB0aHJvdzsNCiAgICAgICAgaWYgKChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSAmJiBwcmVzYWxlU3VwcGx5ID49IHByZXNhbGVBbGxvY2F0aW9uKSB0aHJvdzsNCiAgICAgICAgaWYgKChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSAmJiBwcmVzYWxlRXRoZXJSYWlzZWQgPj0gZXRoZXJDYXApIHRocm93Ow0KDQogICAgICAgIHVwZGF0ZVRva2VuU2FsZVN0YXRlKCk7DQogICAgICAgIHVpbnQgdG9rZW5zID0gbXVsKG1zZy52YWx1ZSwgcHJpY2UoKSk7DQoNCiAgICAgICAgaWYgKHRva2VucyA8PSAwKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGJhbGFuY2VzW3JlY2lwaWVudF0gPSBhZGQoYmFsYW5jZXNbcmVjaXBpZW50XSwgdG9rZW5zKTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBhZGQodG90YWxUb2tlbnMsIHRva2Vucyk7DQoNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCB8fCBfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpIHsNCiAgICAgICAgICAgIHByZXNhbGVFdGhlclJhaXNlZCA9IGFkZChwcmVzYWxlRXRoZXJSYWlzZWQsIG1zZy52YWx1ZSk7DQogICAgICAgICAgICBwcmVzYWxlU3VwcGx5ID0gYWRkKHByZXNhbGVTdXBwbHksIHRva2Vucyk7DQogICAgICAgIH0NCg0KICAgICAgICBmb3VuZGVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7DQogICAgICAgIA0KICAgICAgICBUcmFuc2ZlcigwLCByZWNpcGllbnQsIHRva2Vucyk7DQogICAgICAgIEJ1eShyZWNpcGllbnQsIG1zZy52YWx1ZSwgdG9rZW5zKTsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5SW50ZXJuYWwgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIgfHwgbXNnLnNlbmRlciA9PSBmb3VuZGVyKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkZWxpdmVyKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50IHRva2Vucywgc3RyaW5nIF9mb3IpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmICh0b2tlbnMgPD0gMCkgdGhyb3c7DQogICAgICAgIGlmICh0b3RhbFRva2VucyA+PSB0b3RhbFN1cHBseSkgdGhyb3c7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkZyb3plbikgdGhyb3c7DQogICAgICAgIGlmICgoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsIHx8IF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgJiYgcHJlc2FsZVN1cHBseSA+PSBwcmVzYWxlQWxsb2NhdGlvbikgdGhyb3c7DQoNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCg0KICAgICAgICBiYWxhbmNlc1tyZWNpcGllbnRdID0gYWRkKGJhbGFuY2VzW3JlY2lwaWVudF0sIHRva2Vucyk7DQogICAgICAgIHRvdGFsVG9rZW5zID0gYWRkKHRvdGFsVG9rZW5zLCB0b2tlbnMpOw0KDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSB7DQogICAgICAgICAgICBwcmVzYWxlU3VwcGx5ID0gYWRkKHByZXNhbGVTdXBwbHksIHRva2Vucyk7DQogICAgICAgIH0NCg0KICAgICAgICBUcmFuc2ZlcigwLCByZWNpcGllbnQsIHRva2Vucyk7ICAgIA0KICAgICAgICBEZWxpdmVyKHJlY2lwaWVudCwgdG9rZW5zLCBfZm9yKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvY2F0ZUVjb3N5c3RlbVRva2VucygpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZW5kQmxvY2spIHRocm93Ow0KICAgICAgICBpZiAoZWNvc3lzdGVtQWxsb2NhdGVkKSB0aHJvdzsNCg0KICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBhZGQoYmFsYW5jZXNbb3duZXJdLCBlY29zeXN0ZW1BbGxvY2F0aW9uKTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBhZGQodG90YWxUb2tlbnMsIGVjb3N5c3RlbUFsbG9jYXRpb24pOw0KDQogICAgICAgIGJhbGFuY2VzW2ZvdW5kZXJdID0gYWRkKGJhbGFuY2VzW2ZvdW5kZXJdLCByZXNlcnZlZEFsbG9jYXRpb24pOw0KICAgICAgICB0b3RhbFRva2VucyA9IGFkZCh0b3RhbFRva2VucywgcmVzZXJ2ZWRBbGxvY2F0aW9uKTsNCg0KICAgICAgICBlY29zeXN0ZW1BbGxvY2F0ZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGZyZWV6ZSgpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW47DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdW5mcmVlemUoKSBvbmx5SW50ZXJuYWwgew0KICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZTsNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzdGFydFNhbGVQaGFzZSAodWludCBzdGFydCwgdWludCBsZW5ndGgpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpIHRocm93Ow0KICAgICAgICBpZiAobGVuZ3RoID09IDApIHRocm93Ow0KICAgICAgICBpZiAoc3RhcnQgPT0gMCkgc3RhcnQgPSBibG9jay5udW1iZXI7DQoNCiAgICAgICAgc3RhcnRCbG9jayA9IHN0YXJ0Ow0KICAgICAgICBlbmRCbG9jayA9IHN0YXJ0QmxvY2sgKyBsZW5ndGg7DQoNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICB9DQoNCn0='