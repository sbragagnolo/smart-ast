base 64 content
base64cHEXToken6
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCi8qKg0KICogT3ZlcmZsb3cgYXdhcmUgdWludCBtYXRoIGZ1bmN0aW9ucy4NCiAqLw0KY29udHJhY3QgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgdWludDI1NiBjID0gYSAvIGI7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBwY3QodWludCBudW1lcmF0b3IsIHVpbnQgZGVub21pbmF0b3IsIHVpbnQgcHJlY2lzaW9uKSBpbnRlcm5hbCByZXR1cm5zKHVpbnQgcXVvdGllbnQpIHsNCiAgICB1aW50IF9udW1lcmF0b3IgPSBudW1lcmF0b3IgKiAxMCAqKiAocHJlY2lzaW9uKzEpOw0KICAgIHVpbnQgX3F1b3RpZW50ID0gKChfbnVtZXJhdG9yIC8gZGVub21pbmF0b3IpICsgNSkgLyAxMDsNCiAgICByZXR1cm4gKF9xdW90aWVudCk7DQogIH0NCg0KICBmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYyA+PSBhKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCn0NCg0KLyoqDQogKiBFUkMgMjAgdG9rZW4NCiAqLw0KY29udHJhY3QgVG9rZW4gew0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KDQogICAgLy8gQSB2dWxlcm5hYmlsaXR5IG9mIHRoZSBhcHByb3ZlIG1ldGhvZCBpbiB0aGUgRVJDMjAgc3RhbmRhcmQgd2FzIGlkZW50aWZpZWQgYnkNCiAgICAvLyBNaWtoYWlsIFZsYWRpbWlyb3YgYW5kIERtaXRyeSBLaG92cmF0b3ZpY2ggaGVyZToNCiAgICAvLyBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFZTFB0UXhadTFVQXZPOWNaMU8yUlBYQmJUMG1vb2g0RFlLakFfanAtUkxNDQogICAgLy8gSXQncyBiZXR0ZXIgdG8gdXNlIHRoaXMgbWV0aG9kIHdoaWNoIGlzIG5vdCBzdXNjZXB0aWJsZSB0byBvdmVyLXdpdGhkcmF3aW5nIGJ5IHRoZSBhcHByb3ZlZS4NCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIHRvIGFwcHJvdmUNCiAgICAvLy8gQHBhcmFtIF9jdXJyZW50VmFsdWUgVGhlIHByZXZpb3VzIHZhbHVlIGFwcHJvdmVkLCB3aGljaCBjYW4gYmUgcmV0cmlldmVkIHdpdGggYWxsb3dhbmNlKG1zZy5zZW5kZXIsIF9zcGVuZGVyKQ0KICAgIC8vLyBAcGFyYW0gX25ld1ZhbHVlIFRoZSBuZXcgdmFsdWUgdG8gYXBwcm92ZSwgdGhpcyB3aWxsIHJlcGxhY2UgdGhlIF9jdXJyZW50VmFsdWUNCiAgICAvLy8gQHJldHVybiBib29sIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBhIHN1Y2Nlc3MgKHNlZSBFUkMyMCdzIGBhcHByb3ZlYCkNCiAgICBmdW5jdGlvbiBjb21wYXJlQW5kQXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9jdXJyZW50VmFsdWUsIHVpbnQyNTYgX25ld1ZhbHVlKSBwdWJsaWMgcmV0dXJucyhib29sKSB7DQogICAgICAgIGlmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSBfY3VycmVudFZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBhcHByb3ZlKF9zcGVuZGVyLCBfbmV3VmFsdWUpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgQ0hFWFRva2VuIGlzIFRva2VuLCBTYWZlTWF0aCB7DQoNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiQ0hFWCBUb2tlbiI7DQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiQ0hYIjsNCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4Ow0KICAgIHVpbnQgcHVibGljIHN0YXJ0QmxvY2s7IC8vY3Jvd2RzYWxlIHN0YXJ0IGJsb2NrDQogICAgdWludCBwdWJsaWMgZW5kQmxvY2s7IC8vY3Jvd2RzYWxlIGVuZCBibG9jaw0KDQogICAgYWRkcmVzcyBwdWJsaWMgZm91bmRlcjsNCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCiAgICANCiAgICB1aW50IHB1YmxpYyB0b3RhbFRva2VucyA9IDIwMDAwMDAwMDAgKiAxMCoqZGVjaW1hbHM7IC8vIDJiIHRva2VucywgZWFjaCBkaXZpZGVkIHRvIHVwIHRvIDEwXmRlY2ltYWxzIHVuaXRzLg0KICAgIHVpbnQgcHVibGljIGV0aGVyQ2FwID0gMjUwMDAwMCAqIDEwKipkZWNpbWFsczsNCg0KICAgIHVpbnQgcHVibGljIHByZXNhbGVTdXBwbHkgPSAwOw0KICAgIHVpbnQgcHVibGljIHByZXNhbGVFdGhlclJhaXNlZCA9IDA7DQoNCiAgICBldmVudCBCdXkoYWRkcmVzcyBpbmRleGVkIHJlY2lwaWVudCwgdWludCBldGgsIHVpbnQgY2h4KTsNCiAgICBldmVudCBEZWxpdmVyKGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQgY2h4LCBzdHJpbmcgX2Zvcik7DQoNCiAgICB1aW50IHB1YmxpYyBwcmVzYWxlQWxsb2NhdGlvbiA9IHRvdGFsVG9rZW5zIC8gMjsgLy81MCUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBmb3IgY3Jvd2RzYWxlDQogICAgdWludCBwdWJsaWMgZWNvc3lzdGVtQWxsb2NhdGlvbiA9IHRvdGFsVG9rZW5zIC8gNDsgLy8yNSUgb2YgdG9rZW4gc3VwcGx5IGFsbG9jYXRlZCBwb3N0LWNyb3dkc2FsZSBmb3IgdGhlIGVjb3N5c3RlbSBmdW5kDQogICAgdWludCBwdWJsaWMgcmVzZXJ2ZWRBbGxvY2F0aW9uID0gdG90YWxUb2tlbnMgLyA0OyAvLzI1JSBvZiB0b2tlbiBzdXBwbHkgYWxsb2NhdGVkIHBvc3QtY3Jvd2RzYWxlIGZvciBpbnRlcm5hbA0KICAgIGJvb2wgcHVibGljIGVjb3N5c3RlbUFsbG9jYXRlZCA9IGZhbHNlOw0KDQogICAgZW51bSBUb2tlblNhbGVTdGF0ZSB7DQogICAgICAgIEluaXRpYWwsICAgIC8vY29udHJhY3QgaW5pdGlhbGl6ZWQsIGJvbnVzIHRva2VuDQogICAgICAgIFByZXNhbGUsICAgIC8vbGltaXRlZCB0aW1lIGNyb3dkc2FsZQ0KICAgICAgICBMaXZlLCAgICAgICAvL2RlZmF1bHQgcHJpY2UNCiAgICAgICAgRnJvemVuICAgICAgLy9wcmV2ZW50IHNhbGUgb2YgdG9rZW5zDQogICAgfQ0KDQogICAgVG9rZW5TYWxlU3RhdGUgcHVibGljIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5Jbml0aWFsOw0KDQogICAgZnVuY3Rpb24gQ0hFWFRva2VuKGFkZHJlc3MgZm91bmRlcklucHV0LCBhZGRyZXNzIG93bmVySW5wdXQsIHVpbnQgc3RhcnRCbG9ja0lucHV0LCB1aW50IGVuZEJsb2NrSW5wdXQpIHsNCiAgICAgICAgZm91bmRlciA9IGZvdW5kZXJJbnB1dDsNCiAgICAgICAgb3duZXIgPSBvd25lcklucHV0Ow0KICAgICAgICBzdGFydEJsb2NrID0gc3RhcnRCbG9ja0lucHV0Ow0KICAgICAgICBlbmRCbG9jayA9IGVuZEJsb2NrSW5wdXQ7DQogICAgICAgIHVwZGF0ZVRva2VuU2FsZVN0YXRlKCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcHJpY2UoKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCkgcmV0dXJuIDYwMDE7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpIHsNCiAgICAgICAgICAgIHVpbnQgcGVyY2VudFJlbWFpbmluZyA9IHBjdCgoZW5kQmxvY2sgLSBibG9jay5udW1iZXIpLCAoZW5kQmxvY2sgLSBzdGFydEJsb2NrKSwgMyk7DQogICAgICAgICAgICByZXR1cm4gMzAwMCArIDMgKiBwZXJjZW50UmVtYWluaW5nOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAzMDAwOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHVwZGF0ZVRva2VuU2FsZVN0YXRlICgpIHsNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuRnJvemVuKSByZXR1cm47DQoNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuTGl2ZSAmJiBibG9jay5udW1iZXIgPiBlbmRCbG9jaykgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCAmJiBibG9jay5udW1iZXIgPj0gc3RhcnRCbG9jaykgew0KICAgICAgICAgICAgX3NhbGVTdGF0ZSA9IFRva2VuU2FsZVN0YXRlLlByZXNhbGU7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUgJiYgYmxvY2subnVtYmVyID4gZW5kQmxvY2spIHsNCiAgICAgICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5MaXZlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24oKSBwYXlhYmxlIHsNCiAgICAgICAgYnV5KG1zZy5zZW5kZXIpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJ1eShhZGRyZXNzIHJlY2lwaWVudCkgcGF5YWJsZSB7DQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMHgwKSB0aHJvdzsNCiAgICAgICAgaWYgKHRvdGFsU3VwcGx5ID49IHRvdGFsVG9rZW5zKSB0aHJvdzsNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuRnJvemVuKSB0aHJvdzsNCiAgICAgICAgaWYgKChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSAmJiBwcmVzYWxlU3VwcGx5ID49IHByZXNhbGVBbGxvY2F0aW9uKSB0aHJvdzsNCiAgICAgICAgaWYgKChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSAmJiBwcmVzYWxlRXRoZXJSYWlzZWQgPj0gZXRoZXJDYXApIHRocm93Ow0KDQogICAgICAgIHVwZGF0ZVRva2VuU2FsZVN0YXRlKCk7DQogICAgICAgIHVpbnQgdG9rZW5zID0gbXVsKG1zZy52YWx1ZSwgcHJpY2UoKSk7DQoNCiAgICAgICAgaWYgKHRva2VucyA8PSAwKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGJhbGFuY2VzW3JlY2lwaWVudF0gPSBhZGQoYmFsYW5jZXNbcmVjaXBpZW50XSwgdG9rZW5zKTsNCiAgICAgICAgdG90YWxTdXBwbHkgPSBhZGQodG90YWxTdXBwbHksIHRva2Vucyk7DQoNCiAgICAgICAgaWYgKF9zYWxlU3RhdGUgPD0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZSkgew0KICAgICAgICAgICAgcHJlc2FsZUV0aGVyUmFpc2VkID0gYWRkKHByZXNhbGVFdGhlclJhaXNlZCwgbXNnLnZhbHVlKTsNCiAgICAgICAgICAgIHByZXNhbGVTdXBwbHkgPSBhZGQocHJlc2FsZVN1cHBseSwgdG9rZW5zKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvdW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsNCiAgICAgICAgICAgIA0KICAgICAgICBCdXkocmVjaXBpZW50LCBtc2cudmFsdWUsIHRva2Vucyk7DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seUludGVybmFsIHsNCiAgICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyIHx8IG1zZy5zZW5kZXIgPT0gZm91bmRlcik7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGVsaXZlcihhZGRyZXNzIHJlY2lwaWVudCwgdWludCB0b2tlbnMsIHN0cmluZyBfZm9yKSBvbmx5SW50ZXJuYWwgew0KICAgICAgICBpZiAodG9rZW5zID09IDApIHRocm93Ow0KICAgICAgICBpZiAodG90YWxTdXBwbHkgPj0gdG90YWxUb2tlbnMpIHRocm93Ow0KICAgICAgICBpZiAoX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW4pIHRocm93Ow0KICAgICAgICBpZiAoKF9zYWxlU3RhdGUgPT0gVG9rZW5TYWxlU3RhdGUuSW5pdGlhbCB8fCBfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpICYmIHByZXNhbGVTdXBwbHkgPj0gcHJlc2FsZUFsbG9jYXRpb24pIHRocm93Ow0KDQogICAgICAgIHVwZGF0ZVRva2VuU2FsZVN0YXRlKCk7DQoNCiAgICAgICAgaWYgKGFkZCh0b3RhbFN1cHBseSwgdG9rZW5zKSA+PSB0b3RhbFRva2VucykgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBiYWxhbmNlc1tyZWNpcGllbnRdID0gYWRkKGJhbGFuY2VzW3JlY2lwaWVudF0sIHRva2Vucyk7DQogICAgICAgIHRvdGFsU3VwcGx5ID0gYWRkKHRvdGFsU3VwcGx5LCB0b2tlbnMpOw0KDQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLkluaXRpYWwgfHwgX3NhbGVTdGF0ZSA9PSBUb2tlblNhbGVTdGF0ZS5QcmVzYWxlKSB7DQogICAgICAgICAgICBwcmVzYWxlU3VwcGx5ID0gYWRkKHByZXNhbGVTdXBwbHksIHRva2Vucyk7DQogICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICBEZWxpdmVyKHJlY2lwaWVudCwgdG9rZW5zLCBfZm9yKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvY2F0ZUVjb3N5c3RlbVRva2VucygpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZW5kQmxvY2spIHRocm93Ow0KICAgICAgICBpZiAoZWNvc3lzdGVtQWxsb2NhdGVkKSB0aHJvdzsNCg0KICAgICAgICBiYWxhbmNlc1tvd25lcl0gPSBhZGQoYmFsYW5jZXNbb3duZXJdLCBlY29zeXN0ZW1BbGxvY2F0aW9uKTsNCiAgICAgICAgdG90YWxTdXBwbHkgPSBhZGQodG90YWxTdXBwbHksIGVjb3N5c3RlbUFsbG9jYXRpb24pOw0KDQogICAgICAgIGJhbGFuY2VzW2ZvdW5kZXJdID0gYWRkKGJhbGFuY2VzW2ZvdW5kZXJdLCByZXNlcnZlZEFsbG9jYXRpb24pOw0KICAgICAgICB0b3RhbFN1cHBseSA9IGFkZCh0b3RhbFN1cHBseSwgcmVzZXJ2ZWRBbGxvY2F0aW9uKTsNCg0KICAgICAgICBlY29zeXN0ZW1BbGxvY2F0ZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGZyZWV6ZSgpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIF9zYWxlU3RhdGUgPSBUb2tlblNhbGVTdGF0ZS5Gcm96ZW47DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdW5mcmVlemUoKSBvbmx5SW50ZXJuYWwgew0KICAgICAgICBfc2FsZVN0YXRlID0gVG9rZW5TYWxlU3RhdGUuUHJlc2FsZTsNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzdGFydFNhbGVQaGFzZSAodWludCBzdGFydCwgdWludCBsZW5ndGgpIG9ubHlJbnRlcm5hbCB7DQogICAgICAgIGlmIChfc2FsZVN0YXRlID09IFRva2VuU2FsZVN0YXRlLlByZXNhbGUpIHRocm93Ow0KICAgICAgICBpZiAobGVuZ3RoID09IDApIHRocm93Ow0KICAgICAgICBpZiAoc3RhcnQgPT0gMCkgc3RhcnQgPSBibG9jay5udW1iZXI7DQoNCiAgICAgICAgc3RhcnRCbG9jayA9IHN0YXJ0Ow0KICAgICAgICBlbmRCbG9jayA9IHN0YXJ0QmxvY2sgKyBsZW5ndGg7DQoNCiAgICAgICAgdXBkYXRlVG9rZW5TYWxlU3RhdGUoKTsNCiAgICB9DQoNCn0='