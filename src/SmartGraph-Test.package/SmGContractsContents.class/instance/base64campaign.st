base 64 content
base64campaign
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMDsNCg0KLyoNCiAgICBDb3B5cmlnaHQgMjAxNiwgSm9yZGkgQmF5bGluYQ0KDQogICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCg0KICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KICAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQoNCiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICovDQoNCi8vLyBAdGl0bGUgTWluaU1lVG9rZW4gQ29udHJhY3QNCi8vLyBAYXV0aG9yIEpvcmRpIEJheWxpbmENCi8vLyBAZGV2IFRoaXMgdG9rZW4gY29udHJhY3QncyBnb2FsIGlzIHRvIG1ha2UgaXQgZWFzeSBmb3IgYW55b25lIHRvIGNsb25lIHRoaXMNCi8vLyAgdG9rZW4gdXNpbmcgdGhlIHRva2VuIGRpc3RyaWJ1dGlvbiBhdCBhIGdpdmVuIGJsb2NrLCB0aGlzIHdpbGwgYWxsb3cgREFPJ3MNCi8vLyAgYW5kIERBcHBzIHRvIHVwZ3JhZGUgdGhlaXIgZmVhdHVyZXMgaW4gYSBkZWNlbnRyYWxpemVkIG1hbm5lciB3aXRob3V0DQovLy8gIGFmZmVjdGluZyB0aGUgb3JpZ2luYWwgdG9rZW4NCi8vLyBAZGV2IEl0IGlzIEVSQzIwIGNvbXBsaWFudCwgYnV0IHN0aWxsIG5lZWRzIHRvIHVuZGVyIGdvIGZ1cnRoZXIgdGVzdGluZy4NCg0KDQovLy8gQGRldiBUaGUgdG9rZW4gY29udHJvbGxlciBjb250cmFjdCBtdXN0IGltcGxlbWVudCB0aGVzZSBmdW5jdGlvbnMNCmNvbnRyYWN0IFRva2VuQ29udHJvbGxlciB7DQogICAgLy8vIEBub3RpY2UgQ2FsbGVkIHdoZW4gYF9vd25lcmAgc2VuZHMgZXRoZXIgdG8gdGhlIE1pbmlNZSBUb2tlbiBjb250cmFjdA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRoYXQgc2VudCB0aGUgZXRoZXIgdG8gY3JlYXRlIHRva2Vucw0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIGV0aGVyIGlzIGFjY2VwdGVkLCBmYWxzZSBpZiBpdCB0aHJvd3MNCiAgICBmdW5jdGlvbiBwcm94eVBheW1lbnQoYWRkcmVzcyBfb3duZXIpIHBheWFibGUgcmV0dXJucyhib29sKTsNCg0KICAgIC8vLyBAbm90aWNlIE5vdGlmaWVzIHRoZSBjb250cm9sbGVyIGFib3V0IGEgdG9rZW4gdHJhbnNmZXIgYWxsb3dpbmcgdGhlDQogICAgLy8vICBjb250cm9sbGVyIHRvIHJlYWN0IGlmIGRlc2lyZWQNCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBvcmlnaW4gb2YgdGhlIHRyYW5zZmVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGRlc3RpbmF0aW9uIG9mIHRoZSB0cmFuc2Zlcg0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRoZSB0cmFuc2Zlcg0KICAgIC8vLyBAcmV0dXJuIEZhbHNlIGlmIHRoZSBjb250cm9sbGVyIGRvZXMgbm90IGF1dGhvcml6ZSB0aGUgdHJhbnNmZXINCiAgICBmdW5jdGlvbiBvblRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIHJldHVybnMoYm9vbCk7DQoNCiAgICAvLy8gQG5vdGljZSBOb3RpZmllcyB0aGUgY29udHJvbGxlciBhYm91dCBhbiBhcHByb3ZhbCBhbGxvd2luZyB0aGUNCiAgICAvLy8gIGNvbnRyb2xsZXIgdG8gcmVhY3QgaWYgZGVzaXJlZA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRoYXQgY2FsbHMgYGFwcHJvdmUoKWANCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBzcGVuZGVyIGluIHRoZSBgYXBwcm92ZSgpYCBjYWxsDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgaW4gdGhlIGBhcHByb3ZlKClgIGNhbGwNCiAgICAvLy8gQHJldHVybiBGYWxzZSBpZiB0aGUgY29udHJvbGxlciBkb2VzIG5vdCBhdXRob3JpemUgdGhlIGFwcHJvdmFsDQogICAgZnVuY3Rpb24gb25BcHByb3ZlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hbW91bnQpDQogICAgICAgIHJldHVybnMoYm9vbCk7DQp9DQoNCmNvbnRyYWN0IENvbnRyb2xsZWQgew0KICAgIC8vLyBAbm90aWNlIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cm9sbGVyIGlzIHRoZSBvbmx5IGFkZHJlc3MgdGhhdCBjYW4gY2FsbA0KICAgIC8vLyAgYSBmdW5jdGlvbiB3aXRoIHRoaXMgbW9kaWZpZXINCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlciB7IGlmIChtc2cuc2VuZGVyICE9IGNvbnRyb2xsZXIpIHRocm93OyBfOyB9DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBjb250cm9sbGVyOw0KDQogICAgZnVuY3Rpb24gQ29udHJvbGxlZCgpIHsgY29udHJvbGxlciA9IG1zZy5zZW5kZXI7fQ0KDQogICAgLy8vIEBub3RpY2UgQ2hhbmdlcyB0aGUgY29udHJvbGxlciBvZiB0aGUgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9uZXdDb250cm9sbGVyIFRoZSBuZXcgY29udHJvbGxlciBvZiB0aGUgY29udHJhY3QNCiAgICBmdW5jdGlvbiBjaGFuZ2VDb250cm9sbGVyKGFkZHJlc3MgX25ld0NvbnRyb2xsZXIpIG9ubHlDb250cm9sbGVyIHsNCiAgICAgICAgY29udHJvbGxlciA9IF9uZXdDb250cm9sbGVyOw0KICAgIH0NCn0NCg0KLy8vIEBkZXYgVGhlIGFjdHVhbCB0b2tlbiBjb250cmFjdCwgdGhlIGRlZmF1bHQgY29udHJvbGxlciBpcyB0aGUgbXNnLnNlbmRlcg0KLy8vICB0aGF0IGRlcGxveXMgdGhlIGNvbnRyYWN0LCBzbyB1c3VhbGx5IHRoaXMgdG9rZW4gd2lsbCBiZSBkZXBsb3llZCBieSBhDQovLy8gIHRva2VuIGNvbnRyb2xsZXIgY29udHJhY3QsIHdoaWNoIEdpdmV0aCB3aWxsIGNhbGwgYSAiQ2FtcGFpZ24iDQpjb250cmFjdCBNaW5pTWVUb2tlbiBpcyBDb250cm9sbGVkIHsNCg0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsgICAgICAgICAgICAgICAgLy9UaGUgVG9rZW4ncyBuYW1lOiBlLmcuIERpZ2l4REFPIFRva2Vucw0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsgICAgICAgICAgICAgLy9OdW1iZXIgb2YgZGVjaW1hbHMgb2YgdGhlIHNtYWxsZXN0IHVuaXQNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsgICAgICAgICAgICAgIC8vQW4gaWRlbnRpZmllcjogZS5nLiBSRVANCiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnTU1UXzAuMSc7IC8vQW4gYXJiaXRyYXJ5IHZlcnNpb25pbmcgc2NoZW1lDQoNCg0KICAgIC8vLyBAZGV2IGBDaGVja3BvaW50YCBpcyB0aGUgc3RydWN0dXJlIHRoYXQgYXR0YWNoZXMgYSBibG9jayBudW1iZXIgdG8gYQ0KICAgIC8vLyAgZ2l2ZW4gdmFsdWUsIHRoZSBibG9jayBudW1iZXIgYXR0YWNoZWQgaXMgdGhlIG9uZSB0aGF0IGxhc3QgY2hhbmdlZCB0aGUNCiAgICAvLy8gIHZhbHVlDQogICAgc3RydWN0ICBDaGVja3BvaW50IHsNCg0KICAgICAgICAvLyBgZnJvbUJsb2NrYCBpcyB0aGUgYmxvY2sgbnVtYmVyIHRoYXQgdGhlIHZhbHVlIHdhcyBnZW5lcmF0ZWQgZnJvbQ0KICAgICAgICB1aW50MTI4IGZyb21CbG9jazsNCg0KICAgICAgICAvLyBgdmFsdWVgIGlzIHRoZSBhbW91bnQgb2YgdG9rZW5zIGF0IGEgc3BlY2lmaWMgYmxvY2sgbnVtYmVyDQogICAgICAgIHVpbnQxMjggdmFsdWU7DQogICAgfQ0KDQogICAgLy8gYHBhcmVudFRva2VuYCBpcyB0aGUgVG9rZW4gYWRkcmVzcyB0aGF0IHdhcyBjbG9uZWQgdG8gcHJvZHVjZSB0aGlzIHRva2VuOw0KICAgIC8vICBpdCB3aWxsIGJlIDB4MCBmb3IgYSB0b2tlbiB0aGF0IHdhcyBub3QgY2xvbmVkDQogICAgTWluaU1lVG9rZW4gcHVibGljIHBhcmVudFRva2VuOw0KDQogICAgLy8gYHBhcmVudFNuYXBTaG90QmxvY2tgIGlzIHRoZSBibG9jayBudW1iZXIgZnJvbSB0aGUgUGFyZW50IFRva2VuIHRoYXQgd2FzDQogICAgLy8gIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBpbml0aWFsIGRpc3RyaWJ1dGlvbiBvZiB0aGUgQ2xvbmUgVG9rZW4NCiAgICB1aW50IHB1YmxpYyBwYXJlbnRTbmFwU2hvdEJsb2NrOw0KDQogICAgLy8gYGNyZWF0aW9uQmxvY2tgIGlzIHRoZSBibG9jayBudW1iZXIgdGhhdCB0aGUgQ2xvbmUgVG9rZW4gd2FzIGNyZWF0ZWQNCiAgICB1aW50IHB1YmxpYyBjcmVhdGlvbkJsb2NrOw0KDQogICAgLy8gYGJhbGFuY2VzYCBpcyB0aGUgbWFwIHRoYXQgdHJhY2tzIHRoZSBiYWxhbmNlIG9mIGVhY2ggYWRkcmVzcywgaW4gdGhpcw0KICAgIC8vICBjb250cmFjdCB3aGVuIHRoZSBiYWxhbmNlIGNoYW5nZXMgdGhlIGJsb2NrIG51bWJlciB0aGF0IHRoZSBjaGFuZ2UNCiAgICAvLyAgb2NjdXJyZWQgaXMgYWxzbyBpbmNsdWRlZCBpbiB0aGUgbWFwDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBDaGVja3BvaW50W10pIGJhbGFuY2VzOw0KDQogICAgLy8gYGFsbG93ZWRgIHRyYWNrcyBhbnkgZXh0cmEgdHJhbnNmZXIgcmlnaHRzIGFzIGluIGFsbCBFUkMyMCB0b2tlbnMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7DQoNCiAgICAvLyBUcmFja3MgdGhlIGhpc3Rvcnkgb2YgdGhlIGB0b3RhbFN1cHBseWAgb2YgdGhlIHRva2VuDQogICAgQ2hlY2twb2ludFtdIHRvdGFsU3VwcGx5SGlzdG9yeTsNCg0KICAgIC8vIEZsYWcgdGhhdCBkZXRlcm1pbmVzIGlmIHRoZSB0b2tlbiBpcyB0cmFuc2ZlcmFibGUgb3Igbm90Lg0KICAgIGJvb2wgcHVibGljIHRyYW5zZmVyc0VuYWJsZWQ7DQoNCiAgICAvLyBUaGUgZmFjdG9yeSB1c2VkIHRvIGNyZWF0ZSBuZXcgY2xvbmUgdG9rZW5zDQogICAgTWluaU1lVG9rZW5GYWN0b3J5IHB1YmxpYyB0b2tlbkZhY3Rvcnk7DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIENvbnN0cnVjdG9yDQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvLy8gQG5vdGljZSBDb25zdHJ1Y3RvciB0byBjcmVhdGUgYSBNaW5pTWVUb2tlbg0KICAgIC8vLyBAcGFyYW0gX3Rva2VuRmFjdG9yeSBUaGUgYWRkcmVzcyBvZiB0aGUgTWluaU1lVG9rZW5GYWN0b3J5IGNvbnRyYWN0IHRoYXQNCiAgICAvLy8gIHdpbGwgY3JlYXRlIHRoZSBDbG9uZSB0b2tlbiBjb250cmFjdHMsIHRoZSB0b2tlbiBmYWN0b3J5IG5lZWRzIHRvIGJlDQogICAgLy8vICBkZXBsb3llZCBmaXJzdA0KICAgIC8vLyBAcGFyYW0gX3BhcmVudFRva2VuIEFkZHJlc3Mgb2YgdGhlIHBhcmVudCB0b2tlbiwgc2V0IHRvIDB4MCBpZiBpdCBpcyBhDQogICAgLy8vICBuZXcgdG9rZW4NCiAgICAvLy8gQHBhcmFtIF9wYXJlbnRTbmFwU2hvdEJsb2NrIEJsb2NrIG9mIHRoZSBwYXJlbnQgdG9rZW4gdGhhdCB3aWxsDQogICAgLy8vICBkZXRlcm1pbmUgdGhlIGluaXRpYWwgZGlzdHJpYnV0aW9uIG9mIHRoZSBjbG9uZSB0b2tlbiwgc2V0IHRvIDAgaWYgaXQNCiAgICAvLy8gIGlzIGEgbmV3IHRva2VuDQogICAgLy8vIEBwYXJhbSBfdG9rZW5OYW1lIE5hbWUgb2YgdGhlIG5ldyB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX2RlY2ltYWxVbml0cyBOdW1iZXIgb2YgZGVjaW1hbHMgb2YgdGhlIG5ldyB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX3Rva2VuU3ltYm9sIFRva2VuIFN5bWJvbCBmb3IgdGhlIG5ldyB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX3RyYW5zZmVyc0VuYWJsZWQgSWYgdHJ1ZSwgdG9rZW5zIHdpbGwgYmUgYWJsZSB0byBiZSB0cmFuc2ZlcnJlZA0KICAgIGZ1bmN0aW9uIE1pbmlNZVRva2VuKA0KICAgICAgICBhZGRyZXNzIF90b2tlbkZhY3RvcnksDQogICAgICAgIGFkZHJlc3MgX3BhcmVudFRva2VuLA0KICAgICAgICB1aW50IF9wYXJlbnRTbmFwU2hvdEJsb2NrLA0KICAgICAgICBzdHJpbmcgX3Rva2VuTmFtZSwNCiAgICAgICAgdWludDggX2RlY2ltYWxVbml0cywNCiAgICAgICAgc3RyaW5nIF90b2tlblN5bWJvbCwNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJzRW5hYmxlZA0KICAgICkgew0KICAgICAgICB0b2tlbkZhY3RvcnkgPSBNaW5pTWVUb2tlbkZhY3RvcnkoX3Rva2VuRmFjdG9yeSk7DQogICAgICAgIG5hbWUgPSBfdG9rZW5OYW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgbmFtZQ0KICAgICAgICBkZWNpbWFscyA9IF9kZWNpbWFsVW5pdHM7ICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGRlY2ltYWxzDQogICAgICAgIHN5bWJvbCA9IF90b2tlblN5bWJvbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgc3ltYm9sDQogICAgICAgIHBhcmVudFRva2VuID0gTWluaU1lVG9rZW4oX3BhcmVudFRva2VuKTsNCiAgICAgICAgcGFyZW50U25hcFNob3RCbG9jayA9IF9wYXJlbnRTbmFwU2hvdEJsb2NrOw0KICAgICAgICB0cmFuc2ZlcnNFbmFibGVkID0gX3RyYW5zZmVyc0VuYWJsZWQ7DQogICAgICAgIGNyZWF0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7DQogICAgfQ0KDQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIEVSQzIwIE1ldGhvZHMNCi8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIFNlbmQgYF9hbW91bnRgIHRva2VucyB0byBgX3RvYCBmcm9tIGBtc2cuc2VuZGVyYA0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKCF0cmFuc2ZlcnNFbmFibGVkKSB0aHJvdzsNCiAgICAgICAgcmV0dXJuIGRvVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KTsNCiAgICB9DQoNCiAgICAvLy8gQG5vdGljZSBTZW5kIGBfYW1vdW50YCB0b2tlbnMgdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQNCiAgICAvLy8gIGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWANCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIGhvbGRpbmcgdGhlIHRva2VucyBiZWluZyB0cmFuc2ZlcnJlZA0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50DQogICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCg0KICAgICAgICAvLyBUaGUgY29udHJvbGxlciBvZiB0aGlzIGNvbnRyYWN0IGNhbiBtb3ZlIHRva2VucyBhcm91bmQgYXQgd2lsbCwNCiAgICAgICAgLy8gIHRoaXMgaXMgaW1wb3J0YW50IHRvIHJlY29nbml6ZSEgQ29uZmlybSB0aGF0IHlvdSB0cnVzdCB0aGUNCiAgICAgICAgLy8gIGNvbnRyb2xsZXIgb2YgdGhpcyBjb250cmFjdCwgd2hpY2ggaW4gbW9zdCBzaXR1YXRpb25zIHNob3VsZCBiZQ0KICAgICAgICAvLyAgYW5vdGhlciBvcGVuIHNvdXJjZSBzbWFydCBjb250cmFjdCBvciAweDANCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gY29udHJvbGxlcikgew0KICAgICAgICAgICAgaWYgKCF0cmFuc2ZlcnNFbmFibGVkKSB0aHJvdzsNCg0KICAgICAgICAgICAgLy8gVGhlIHN0YW5kYXJkIEVSQyAyMCB0cmFuc2ZlckZyb20gZnVuY3Rpb25hbGl0eQ0KICAgICAgICAgICAgaWYgKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIDwgX2Ftb3VudCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZG9UcmFuc2ZlcihfZnJvbSwgX3RvLCBfYW1vdW50KTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBUaGlzIGlzIHRoZSBhY3R1YWwgdHJhbnNmZXIgZnVuY3Rpb24gaW4gdGhlIHRva2VuIGNvbnRyYWN0LCBpdCBjYW4NCiAgICAvLy8gIG9ubHkgYmUgY2FsbGVkIGJ5IG90aGVyIGZ1bmN0aW9ucyBpbiB0aGlzIGNvbnRyYWN0Lg0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3MgaG9sZGluZyB0aGUgdG9rZW5zIGJlaW5nIHRyYW5zZmVycmVkDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZA0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsDQogICAgZnVuY3Rpb24gZG9UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50DQogICAgKSBpbnRlcm5hbCByZXR1cm5zKGJvb2wpIHsNCg0KICAgICAgICAgICBpZiAoX2Ftb3VudCA9PSAwKSB7DQogICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgfQ0KDQogICAgICAgICAgIC8vIERvIG5vdCBhbGxvdyB0cmFuc2ZlciB0byAweDAgb3IgdGhlIHRva2VuIGNvbnRyYWN0IGl0c2VsZg0KICAgICAgICAgICBpZiAoKF90byA9PSAwKSB8fCAoX3RvID09IGFkZHJlc3ModGhpcykpKSB0aHJvdzsNCg0KICAgICAgICAgICAvLyBJZiB0aGUgYW1vdW50IGJlaW5nIHRyYW5zZmVyZWQgaXMgbW9yZSB0aGFuIHRoZSBiYWxhbmNlIG9mIHRoZQ0KICAgICAgICAgICAvLyAgYWNjb3VudCB0aGUgdHJhbnNmZXIgcmV0dXJucyBmYWxzZQ0KICAgICAgICAgICB2YXIgcHJldmlvdXNCYWxhbmNlRnJvbSA9IGJhbGFuY2VPZkF0KF9mcm9tLCBibG9jay5udW1iZXIpOw0KICAgICAgICAgICBpZiAocHJldmlvdXNCYWxhbmNlRnJvbSA8IF9hbW91bnQpIHsNCiAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgfQ0KDQogICAgICAgICAgIC8vIEFsZXJ0cyB0aGUgdG9rZW4gY29udHJvbGxlciBvZiB0aGUgdHJhbnNmZXINCiAgICAgICAgICAgaWYgKGlzQ29udHJhY3QoY29udHJvbGxlcikpIHsNCiAgICAgICAgICAgICAgIGlmICghVG9rZW5Db250cm9sbGVyKGNvbnRyb2xsZXIpLm9uVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCkpDQogICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgfQ0KDQogICAgICAgICAgIC8vIEZpcnN0IHVwZGF0ZSB0aGUgYmFsYW5jZSBhcnJheSB3aXRoIHRoZSBuZXcgdmFsdWUgZm9yIHRoZSBhZGRyZXNzDQogICAgICAgICAgIC8vICBzZW5kaW5nIHRoZSB0b2tlbnMNCiAgICAgICAgICAgdXBkYXRlVmFsdWVBdE5vdyhiYWxhbmNlc1tfZnJvbV0sIHByZXZpb3VzQmFsYW5jZUZyb20gLSBfYW1vdW50KTsNCg0KICAgICAgICAgICAvLyBUaGVuIHVwZGF0ZSB0aGUgYmFsYW5jZSBhcnJheSB3aXRoIHRoZSBuZXcgdmFsdWUgZm9yIHRoZSBhZGRyZXNzDQogICAgICAgICAgIC8vICByZWNlaXZpbmcgdGhlIHRva2Vucw0KICAgICAgICAgICB2YXIgcHJldmlvdXNCYWxhbmNlVG8gPSBiYWxhbmNlT2ZBdChfdG8sIGJsb2NrLm51bWJlcik7DQogICAgICAgICAgIHVwZGF0ZVZhbHVlQXROb3coYmFsYW5jZXNbX3RvXSwgcHJldmlvdXNCYWxhbmNlVG8gKyBfYW1vdW50KTsNCg0KICAgICAgICAgICAvLyBBbiBldmVudCB0byBtYWtlIHRoZSB0cmFuc2ZlciBlYXN5IHRvIGZpbmQgb24gdGhlIGJsb2NrY2hhaW4NCiAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX2Ftb3VudCk7DQoNCiAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCdzIGJhbGFuY2UgaXMgYmVpbmcgcmVxdWVzdGVkDQogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2Ugb2YgYF9vd25lcmAgYXQgdGhlIGN1cnJlbnQgYmxvY2sNCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgICAgICByZXR1cm4gYmFsYW5jZU9mQXQoX293bmVyLCBibG9jay5udW1iZXIpOw0KICAgIH0NCg0KICAgIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX3NwZW5kZXJgIHRvIHNwZW5kIGBfYW1vdW50YCB0b2tlbnMgb24NCiAgICAvLy8gIGl0cyBiZWhhbGYuIFRoaXMgaXMgYSBtb2RpZmllZCB2ZXJzaW9uIG9mIHRoZSBFUkMyMCBhcHByb3ZlIGZ1bmN0aW9uDQogICAgLy8vICB0byBiZSBhIGxpdHRsZSBiaXQgc2FmZXINCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bA0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKCF0cmFuc2ZlcnNFbmFibGVkKSB0aHJvdzsNCg0KICAgICAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzJiMxODA7DQogICAgICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLDApYCBpZiBpdCBpcyBub3QNCiAgICAgICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAgICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQ0KICAgICAgICBpZiAoKF9hbW91bnQhPTApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPTApKSB0aHJvdzsNCg0KICAgICAgICAvLyBBbGVydHMgdGhlIHRva2VuIGNvbnRyb2xsZXIgb2YgdGhlIGFwcHJvdmUgZnVuY3Rpb24gY2FsbA0KICAgICAgICBpZiAoaXNDb250cmFjdChjb250cm9sbGVyKSkgew0KICAgICAgICAgICAgaWYgKCFUb2tlbkNvbnRyb2xsZXIoY29udHJvbGxlcikub25BcHByb3ZlKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KSkNCiAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KDQogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX2Ftb3VudDsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9hbW91bnQpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBUaGlzIGZ1bmN0aW9uIG1ha2VzIGl0IGVhc3kgdG8gcmVhZCB0aGUgYGFsbG93ZWRbXWAgbWFwDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgdGhhdCBvd25zIHRoZSB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogICAgLy8vIEByZXR1cm4gQW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgb2YgX293bmVyIHRoYXQgX3NwZW5kZXIgaXMgYWxsb3dlZA0KICAgIC8vLyAgdG8gc3BlbmQNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXINCiAgICApIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX3NwZW5kZXJgIHRvIHNlbmQgYF9hbW91bnRgIHRva2VucyBvbg0KICAgIC8vLyAgaXRzIGJlaGFsZiwgYW5kIHRoZW4gYSBmdW5jdGlvbiBpcyB0cmlnZ2VyZWQgaW4gdGhlIGNvbnRyYWN0IHRoYXQgaXMNCiAgICAvLy8gIGJlaW5nIGFwcHJvdmVkLCBgX3NwZW5kZXJgLiBUaGlzIGFsbG93cyB1c2VycyB0byB1c2UgdGhlaXIgdG9rZW5zIHRvDQogICAgLy8vICBpbnRlcmFjdCB3aXRoIGNvbnRyYWN0cyBpbiBvbmUgZnVuY3Rpb24gY2FsbCBpbnN0ZWFkIG9mIHR3bw0KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSBmdW5jdGlvbiBjYWxsIHdhcyBzdWNjZXNzZnVsDQogICAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50LCBieXRlcyBfZXh0cmFEYXRhDQogICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50Ow0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2Ftb3VudCk7DQoNCiAgICAgICAgLy8gVGhpcyBwb3J0aW9uIGlzIGNvcGllZCBmcm9tIENvbnNlblN5cydzIFN0YW5kYXJkIFRva2VuIENvbnRyYWN0LiBJdA0KICAgICAgICAvLyAgY2FsbHMgdGhlIHJlY2VpdmVBcHByb3ZhbCBmdW5jdGlvbiB0aGF0IGlzIHBhcnQgb2YgdGhlIGNvbnRyYWN0IHRoYXQNCiAgICAgICAgLy8gIGlzIGJlaW5nIGFwcHJvdmVkIChgX3NwZW5kZXJgKS4gVGhlIGZ1bmN0aW9uIHNob3VsZCBsb29rIGxpa2U6DQogICAgICAgIC8vICBgcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX2Ftb3VudCwgYWRkcmVzcw0KICAgICAgICAvLyAgX3Rva2VuQ29udHJhY3QsIGJ5dGVzIF9leHRyYURhdGEpYCBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIGNhbGwNCiAgICAgICAgLy8gICpzaG91bGQqIHN1Y2NlZWQsIG90aGVyd2lzZSB0aGUgcGxhaW4gdmFuaWxsYSBhcHByb3ZlIHdvdWxkIGJlIHVzZWQNCiAgICAgICAgaWYoIV9zcGVuZGVyLmNhbGwoDQogICAgICAgICAgICBieXRlczQoYnl0ZXMzMihzaGEzKCJyZWNlaXZlQXBwcm92YWwoYWRkcmVzcyx1aW50MjU2LGFkZHJlc3MsYnl0ZXMpIikpKSwNCiAgICAgICAgICAgIG1zZy5zZW5kZXIsDQogICAgICAgICAgICBfYW1vdW50LA0KICAgICAgICAgICAgdGhpcywNCiAgICAgICAgICAgIF9leHRyYURhdGENCiAgICAgICAgICAgICkpIHsgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgVGhpcyBmdW5jdGlvbiBtYWtlcyBpdCBlYXN5IHRvIGdldCB0aGUgdG90YWwgbnVtYmVyIG9mIHRva2Vucw0KICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBudW1iZXIgb2YgdG9rZW5zDQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiB0b3RhbFN1cHBseUF0KGJsb2NrLm51bWJlcik7DQogICAgfQ0KDQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIFF1ZXJ5IGJhbGFuY2UgYW5kIHRvdGFsU3VwcGx5IGluIEhpc3RvcnkNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAZGV2IFF1ZXJpZXMgdGhlIGJhbGFuY2Ugb2YgYF9vd25lcmAgYXQgYSBzcGVjaWZpYyBgX2Jsb2NrTnVtYmVyYA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQNCiAgICAvLy8gQHBhcmFtIF9ibG9ja051bWJlciBUaGUgYmxvY2sgbnVtYmVyIHdoZW4gdGhlIGJhbGFuY2UgaXMgcXVlcmllZA0KICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlIGF0IGBfYmxvY2tOdW1iZXJgDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mQXQoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Jsb2NrTnVtYmVyKSBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgLy8gSWYgdGhlIGBfYmxvY2tOdW1iZXJgIHJlcXVlc3RlZCBpcyBiZWZvcmUgdGhlIGdlbmVzaXMgYmxvY2sgZm9yIHRoZQ0KICAgICAgICAvLyAgdGhlIHRva2VuIGJlaW5nIHF1ZXJpZWQsIHRoZSB2YWx1ZSByZXR1cm5lZCBpcyAwDQogICAgICAgIGlmIChfYmxvY2tOdW1iZXIgPCBjcmVhdGlvbkJsb2NrKSB7DQogICAgICAgICAgICByZXR1cm4gMDsNCg0KICAgICAgICAvLyBUaGVzZSBuZXh0IGZldyBsaW5lcyBhcmUgdXNlZCB3aGVuIHRoZSBiYWxhbmNlIG9mIHRoZSB0b2tlbiBpcw0KICAgICAgICAvLyAgcmVxdWVzdGVkIGJlZm9yZSBhIGNoZWNrIHBvaW50IHdhcyBldmVyIGNyZWF0ZWQgZm9yIHRoaXMgdG9rZW4sIGl0DQogICAgICAgIC8vICByZXF1aXJlcyB0aGF0IHRoZSBgcGFyZW50VG9rZW4uYmFsYW5jZU9mQXRgIGJlIHF1ZXJpZWQgYXQgdGhlDQogICAgICAgIC8vICBnZW5lc2lzIGJsb2NrIGZvciB0aGF0IHRva2VuIGFzIHRoaXMgY29udGFpbnMgaW5pdGlhbCBiYWxhbmNlIG9mDQogICAgICAgIC8vICB0aGlzIHRva2VuDQogICAgICAgIH0gZWxzZSBpZiAoKGJhbGFuY2VzW19vd25lcl0ubGVuZ3RoID09IDApDQogICAgICAgICAgICB8fCAoYmFsYW5jZXNbX293bmVyXVswXS5mcm9tQmxvY2sgPiBfYmxvY2tOdW1iZXIpKSB7DQogICAgICAgICAgICBpZiAoYWRkcmVzcyhwYXJlbnRUb2tlbikgIT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnRUb2tlbi5iYWxhbmNlT2ZBdChfb3duZXIsIHBhcmVudFNuYXBTaG90QmxvY2spOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBIYXMgbm8gcGFyZW50DQogICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgLy8gVGhpcyB3aWxsIHJldHVybiB0aGUgZXhwZWN0ZWQgYmFsYW5jZSBkdXJpbmcgbm9ybWFsIHNpdHVhdGlvbnMNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZUF0KGJhbGFuY2VzW19vd25lcl0sIF9ibG9ja051bWJlcik7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIC8vLyBAbm90aWNlIFRvdGFsIGFtb3VudCBvZiB0b2tlbnMgYXQgYSBzcGVjaWZpYyBgX2Jsb2NrTnVtYmVyYC4NCiAgICAvLy8gQHBhcmFtIF9ibG9ja051bWJlciBUaGUgYmxvY2sgbnVtYmVyIHdoZW4gdGhlIHRvdGFsU3VwcGx5IGlzIHF1ZXJpZWQNCiAgICAvLy8gQHJldHVybiBUaGUgdG90YWwgYW1vdW50IG9mIHRva2VucyBhdCBgX2Jsb2NrTnVtYmVyYA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5QXQodWludCBfYmxvY2tOdW1iZXIpIGNvbnN0YW50IHJldHVybnModWludCkgew0KDQogICAgICAgIC8vIElmIHRoZSBgX2Jsb2NrTnVtYmVyYCByZXF1ZXN0ZWQgaXMgYmVmb3JlIHRoZSBnZW5lc2lzIGJsb2NrIGZvciB0aGUNCiAgICAgICAgLy8gIHRoZSB0b2tlbiBiZWluZyBxdWVyaWVkLCB0aGUgdmFsdWUgcmV0dXJuZWQgaXMgMA0KICAgICAgICBpZiAoX2Jsb2NrTnVtYmVyIDwgY3JlYXRpb25CbG9jaykgew0KICAgICAgICAgICAgcmV0dXJuIDA7DQoNCiAgICAgICAgLy8gVGhlc2UgbmV4dCBmZXcgbGluZXMgYXJlIHVzZWQgd2hlbiB0aGUgdG90YWxTdXBwbHkgb2YgdGhlIHRva2VuIGlzDQogICAgICAgIC8vICByZXF1ZXN0ZWQgYmVmb3JlIGEgY2hlY2sgcG9pbnQgd2FzIGV2ZXIgY3JlYXRlZCBmb3IgdGhpcyB0b2tlbiwgaXQNCiAgICAgICAgLy8gIHJlcXVpcmVzIHRoYXQgdGhlIGBwYXJlbnRUb2tlbi50b3RhbFN1cHBseUF0YCBiZSBxdWVyaWVkIGF0IHRoZQ0KICAgICAgICAvLyAgZ2VuZXNpcyBibG9jayBmb3IgdGhpcyB0b2tlbiBhcyB0aGF0IGNvbnRhaW5zIHRvdGFsU3VwcGx5IG9mIHRoaXMNCiAgICAgICAgLy8gIHRva2VuIGF0IHRoaXMgYmxvY2sgbnVtYmVyLg0KICAgICAgICB9IGVsc2UgaWYgKCh0b3RhbFN1cHBseUhpc3RvcnkubGVuZ3RoID09IDApDQogICAgICAgICAgICB8fCAodG90YWxTdXBwbHlIaXN0b3J5WzBdLmZyb21CbG9jayA+IF9ibG9ja051bWJlcikpIHsNCiAgICAgICAgICAgIGlmIChhZGRyZXNzKHBhcmVudFRva2VuKSAhPSAwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudFRva2VuLnRvdGFsU3VwcGx5QXQocGFyZW50U25hcFNob3RCbG9jayk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC8vIFRoaXMgd2lsbCByZXR1cm4gdGhlIGV4cGVjdGVkIHRvdGFsU3VwcGx5IGR1cmluZyBub3JtYWwgc2l0dWF0aW9ucw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGdldFZhbHVlQXQodG90YWxTdXBwbHlIaXN0b3J5LCBfYmxvY2tOdW1iZXIpOw0KICAgICAgICB9DQogICAgfQ0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBDbG9uZSBUb2tlbiBNZXRob2QNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIENyZWF0ZXMgYSBuZXcgY2xvbmUgdG9rZW4gd2l0aCB0aGUgaW5pdGlhbCBkaXN0cmlidXRpb24gYmVpbmcNCiAgICAvLy8gIHRoaXMgdG9rZW4gYXQgYF9zbmFwc2hvdEJsb2NrYA0KICAgIC8vLyBAcGFyYW0gX2Nsb25lVG9rZW5OYW1lIE5hbWUgb2YgdGhlIGNsb25lIHRva2VuDQogICAgLy8vIEBwYXJhbSBfY2xvbmVEZWNpbWFsVW5pdHMgTnVtYmVyIG9mIGRlY2ltYWxzIG9mIHRoZSBzbWFsbGVzdCB1bml0DQogICAgLy8vIEBwYXJhbSBfY2xvbmVUb2tlblN5bWJvbCBTeW1ib2wgb2YgdGhlIGNsb25lIHRva2VuDQogICAgLy8vIEBwYXJhbSBfc25hcHNob3RCbG9jayBCbG9jayB3aGVuIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIHBhcmVudCB0b2tlbiBpcw0KICAgIC8vLyAgY29waWVkIHRvIHNldCB0aGUgaW5pdGlhbCBkaXN0cmlidXRpb24gb2YgdGhlIG5ldyBjbG9uZSB0b2tlbjsNCiAgICAvLy8gIGlmIHRoZSBibG9jayBpcyBoaWdoZXIgdGhhbiB0aGUgYWN0dWFsIGJsb2NrLCB0aGUgY3VycmVudCBibG9jayBpcyB1c2VkDQogICAgLy8vIEBwYXJhbSBfdHJhbnNmZXJzRW5hYmxlZCBUcnVlIGlmIHRyYW5zZmVycyBhcmUgYWxsb3dlZCBpbiB0aGUgY2xvbmUNCiAgICAvLy8gQHJldHVybiBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IE1pbmlNZVRva2VuIENvbnRyYWN0DQogICAgZnVuY3Rpb24gY3JlYXRlQ2xvbmVUb2tlbigNCiAgICAgICAgc3RyaW5nIF9jbG9uZVRva2VuTmFtZSwNCiAgICAgICAgdWludDggX2Nsb25lRGVjaW1hbFVuaXRzLA0KICAgICAgICBzdHJpbmcgX2Nsb25lVG9rZW5TeW1ib2wsDQogICAgICAgIHVpbnQgX3NuYXBzaG90QmxvY2ssDQogICAgICAgIGJvb2wgX3RyYW5zZmVyc0VuYWJsZWQNCiAgICAgICAgKSByZXR1cm5zKGFkZHJlc3MpIHsNCiAgICAgICAgaWYgKF9zbmFwc2hvdEJsb2NrID4gYmxvY2subnVtYmVyKSBfc25hcHNob3RCbG9jayA9IGJsb2NrLm51bWJlcjsNCiAgICAgICAgTWluaU1lVG9rZW4gY2xvbmVUb2tlbiA9IHRva2VuRmFjdG9yeS5jcmVhdGVDbG9uZVRva2VuKA0KICAgICAgICAgICAgdGhpcywNCiAgICAgICAgICAgIF9zbmFwc2hvdEJsb2NrLA0KICAgICAgICAgICAgX2Nsb25lVG9rZW5OYW1lLA0KICAgICAgICAgICAgX2Nsb25lRGVjaW1hbFVuaXRzLA0KICAgICAgICAgICAgX2Nsb25lVG9rZW5TeW1ib2wsDQogICAgICAgICAgICBfdHJhbnNmZXJzRW5hYmxlZA0KICAgICAgICAgICAgKTsNCg0KICAgICAgICBjbG9uZVRva2VuLmNoYW5nZUNvbnRyb2xsZXIobXNnLnNlbmRlcik7DQoNCiAgICAgICAgLy8gQW4gZXZlbnQgdG8gbWFrZSB0aGUgdG9rZW4gZWFzeSB0byBmaW5kIG9uIHRoZSBibG9ja2NoYWluDQogICAgICAgIE5ld0Nsb25lVG9rZW4oYWRkcmVzcyhjbG9uZVRva2VuKSwgX3NuYXBzaG90QmxvY2spOw0KICAgICAgICByZXR1cm4gYWRkcmVzcyhjbG9uZVRva2VuKTsNCiAgICB9DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIEdlbmVyYXRlIGFuZCBkZXN0cm95IHRva2Vucw0KLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgLy8vIEBub3RpY2UgR2VuZXJhdGVzIGBfYW1vdW50YCB0b2tlbnMgdGhhdCBhcmUgYXNzaWduZWQgdG8gYF9vd25lcmANCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgYmUgYXNzaWduZWQgdGhlIG5ldyB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIHF1YW50aXR5IG9mIHRva2VucyBnZW5lcmF0ZWQNCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSB0b2tlbnMgYXJlIGdlbmVyYXRlZCBjb3JyZWN0bHkNCiAgICBmdW5jdGlvbiBnZW5lcmF0ZVRva2VucyhhZGRyZXNzIF9vd25lciwgdWludCBfYW1vdW50DQogICAgKSBvbmx5Q29udHJvbGxlciByZXR1cm5zIChib29sKSB7DQogICAgICAgIHVpbnQgY3VyVG90YWxTdXBwbHkgPSBnZXRWYWx1ZUF0KHRvdGFsU3VwcGx5SGlzdG9yeSwgYmxvY2subnVtYmVyKTsNCiAgICAgICAgdXBkYXRlVmFsdWVBdE5vdyh0b3RhbFN1cHBseUhpc3RvcnksIGN1clRvdGFsU3VwcGx5ICsgX2Ftb3VudCk7DQogICAgICAgIHZhciBwcmV2aW91c0JhbGFuY2VUbyA9IGJhbGFuY2VPZihfb3duZXIpOw0KICAgICAgICB1cGRhdGVWYWx1ZUF0Tm93KGJhbGFuY2VzW19vd25lcl0sIHByZXZpb3VzQmFsYW5jZVRvICsgX2Ftb3VudCk7DQogICAgICAgIFRyYW5zZmVyKDAsIF9vd25lciwgX2Ftb3VudCk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KDQogICAgLy8vIEBub3RpY2UgQnVybnMgYF9hbW91bnRgIHRva2VucyBmcm9tIGBfb3duZXJgDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCB3aWxsIGxvc2UgdGhlIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIHRvIGJ1cm4NCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIHRoZSB0b2tlbnMgYXJlIGJ1cm5lZCBjb3JyZWN0bHkNCiAgICBmdW5jdGlvbiBkZXN0cm95VG9rZW5zKGFkZHJlc3MgX293bmVyLCB1aW50IF9hbW91bnQNCiAgICApIG9ubHlDb250cm9sbGVyIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgdWludCBjdXJUb3RhbFN1cHBseSA9IGdldFZhbHVlQXQodG90YWxTdXBwbHlIaXN0b3J5LCBibG9jay5udW1iZXIpOw0KICAgICAgICBpZiAoY3VyVG90YWxTdXBwbHkgPCBfYW1vdW50KSB0aHJvdzsNCiAgICAgICAgdXBkYXRlVmFsdWVBdE5vdyh0b3RhbFN1cHBseUhpc3RvcnksIGN1clRvdGFsU3VwcGx5IC0gX2Ftb3VudCk7DQogICAgICAgIHZhciBwcmV2aW91c0JhbGFuY2VGcm9tID0gYmFsYW5jZU9mKF9vd25lcik7DQogICAgICAgIGlmIChwcmV2aW91c0JhbGFuY2VGcm9tIDwgX2Ftb3VudCkgdGhyb3c7DQogICAgICAgIHVwZGF0ZVZhbHVlQXROb3coYmFsYW5jZXNbX293bmVyXSwgcHJldmlvdXNCYWxhbmNlRnJvbSAtIF9hbW91bnQpOw0KICAgICAgICBUcmFuc2Zlcihfb3duZXIsIDAsIF9hbW91bnQpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIEVuYWJsZSB0b2tlbnMgdHJhbnNmZXJzDQovLy8vLy8vLy8vLy8vLy8vDQoNCg0KICAgIC8vLyBAbm90aWNlIEVuYWJsZXMgdG9rZW4gaG9sZGVycyB0byB0cmFuc2ZlciB0aGVpciB0b2tlbnMgZnJlZWx5IGlmIHRydWUNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcnNFbmFibGVkIFRydWUgaWYgdHJhbnNmZXJzIGFyZSBhbGxvd2VkIGluIHRoZSBjbG9uZQ0KICAgIGZ1bmN0aW9uIGVuYWJsZVRyYW5zZmVycyhib29sIF90cmFuc2ZlcnNFbmFibGVkKSBvbmx5Q29udHJvbGxlciB7DQogICAgICAgIHRyYW5zZmVyc0VuYWJsZWQgPSBfdHJhbnNmZXJzRW5hYmxlZDsNCiAgICB9DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIEludGVybmFsIGhlbHBlciBmdW5jdGlvbnMgdG8gcXVlcnkgYW5kIHNldCBhIHZhbHVlIGluIGEgc25hcHNob3QgYXJyYXkNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAZGV2IGBnZXRWYWx1ZUF0YCByZXRyaWV2ZXMgdGhlIG51bWJlciBvZiB0b2tlbnMgYXQgYSBnaXZlbiBibG9jayBudW1iZXINCiAgICAvLy8gQHBhcmFtIGNoZWNrcG9pbnRzIFRoZSBoaXN0b3J5IG9mIHZhbHVlcyBiZWluZyBxdWVyaWVkDQogICAgLy8vIEBwYXJhbSBfYmxvY2sgVGhlIGJsb2NrIG51bWJlciB0byByZXRyaWV2ZSB0aGUgdmFsdWUgYXQNCiAgICAvLy8gQHJldHVybiBUaGUgbnVtYmVyIG9mIHRva2VucyBiZWluZyBxdWVyaWVkDQogICAgZnVuY3Rpb24gZ2V0VmFsdWVBdChDaGVja3BvaW50W10gc3RvcmFnZSBjaGVja3BvaW50cywgdWludCBfYmxvY2sNCiAgICApIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgaWYgKGNoZWNrcG9pbnRzLmxlbmd0aCA9PSAwKSByZXR1cm4gMDsNCg0KICAgICAgICAvLyBTaG9ydGN1dCBmb3IgdGhlIGFjdHVhbCB2YWx1ZQ0KICAgICAgICBpZiAoX2Jsb2NrID49IGNoZWNrcG9pbnRzW2NoZWNrcG9pbnRzLmxlbmd0aC0xXS5mcm9tQmxvY2spDQogICAgICAgICAgICByZXR1cm4gY2hlY2twb2ludHNbY2hlY2twb2ludHMubGVuZ3RoLTFdLnZhbHVlOw0KICAgICAgICBpZiAoX2Jsb2NrIDwgY2hlY2twb2ludHNbMF0uZnJvbUJsb2NrKSByZXR1cm4gMDsNCg0KICAgICAgICAvLyBCaW5hcnkgc2VhcmNoIG9mIHRoZSB2YWx1ZSBpbiB0aGUgYXJyYXkNCiAgICAgICAgdWludCBtaW4gPSAwOw0KICAgICAgICB1aW50IG1heCA9IGNoZWNrcG9pbnRzLmxlbmd0aC0xOw0KICAgICAgICB3aGlsZSAobWF4ID4gbWluKSB7DQogICAgICAgICAgICB1aW50IG1pZCA9IChtYXggKyBtaW4gKyAxKS8gMjsNCiAgICAgICAgICAgIGlmIChjaGVja3BvaW50c1ttaWRdLmZyb21CbG9jazw9X2Jsb2NrKSB7DQogICAgICAgICAgICAgICAgbWluID0gbWlkOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBtYXggPSBtaWQtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gY2hlY2twb2ludHNbbWluXS52YWx1ZTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBgdXBkYXRlVmFsdWVBdE5vd2AgdXNlZCB0byB1cGRhdGUgdGhlIGBiYWxhbmNlc2AgbWFwIGFuZCB0aGUNCiAgICAvLy8gIGB0b3RhbFN1cHBseUhpc3RvcnlgDQogICAgLy8vIEBwYXJhbSBjaGVja3BvaW50cyBUaGUgaGlzdG9yeSBvZiBkYXRhIGJlaW5nIHVwZGF0ZWQNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgbmV3IG51bWJlciBvZiB0b2tlbnMNCiAgICBmdW5jdGlvbiB1cGRhdGVWYWx1ZUF0Tm93KENoZWNrcG9pbnRbXSBzdG9yYWdlIGNoZWNrcG9pbnRzLCB1aW50IF92YWx1ZQ0KICAgICkgaW50ZXJuYWwgIHsNCiAgICAgICAgaWYgKChjaGVja3BvaW50cy5sZW5ndGggPT0gMCkNCiAgICAgICAgfHwgKGNoZWNrcG9pbnRzW2NoZWNrcG9pbnRzLmxlbmd0aCAtMV0uZnJvbUJsb2NrIDwgYmxvY2subnVtYmVyKSkgew0KICAgICAgICAgICAgICAgQ2hlY2twb2ludCBuZXdDaGVja1BvaW50ID0gY2hlY2twb2ludHNbIGNoZWNrcG9pbnRzLmxlbmd0aCsrIF07DQogICAgICAgICAgICAgICBuZXdDaGVja1BvaW50LmZyb21CbG9jayA9ICB1aW50MTI4KGJsb2NrLm51bWJlcik7DQogICAgICAgICAgICAgICBuZXdDaGVja1BvaW50LnZhbHVlID0gdWludDEyOChfdmFsdWUpOw0KICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgQ2hlY2twb2ludCBvbGRDaGVja1BvaW50ID0gY2hlY2twb2ludHNbY2hlY2twb2ludHMubGVuZ3RoLTFdOw0KICAgICAgICAgICAgICAgb2xkQ2hlY2tQb2ludC52YWx1ZSA9IHVpbnQxMjgoX3ZhbHVlKTsNCiAgICAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhbiBhZGRyZXNzIGlzIGEgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9hZGRyIFRoZSBhZGRyZXNzIGJlaW5nIHF1ZXJpZWQNCiAgICAvLy8gQHJldHVybiBUcnVlIGlmIGBfYWRkcmAgaXMgYSBjb250cmFjdA0KICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyhib29sKSB7DQogICAgICAgIHVpbnQgc2l6ZTsNCiAgICAgICAgaWYgKF9hZGRyID09IDApIHJldHVybiBmYWxzZTsNCiAgICAgICAgYXNzZW1ibHkgew0KICAgICAgICAgICAgc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYWRkcikNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gc2l6ZT4wOw0KICAgIH0NCg0KICAgIC8vLyBAbm90aWNlIFRoZSBmYWxsYmFjayBmdW5jdGlvbjogSWYgdGhlIGNvbnRyYWN0J3MgY29udHJvbGxlciBoYXMgbm90IGJlZW4NCiAgICAvLy8gIHNldCB0byAwLCB0aGVuIHRoZSBgcHJveHlQYXltZW50YCBtZXRob2QgaXMgY2FsbGVkIHdoaWNoIHJlbGF5cyB0aGUNCiAgICAvLy8gIGV0aGVyIGFuZCBjcmVhdGVzIHRva2VucyBhcyBkZXNjcmliZWQgaW4gdGhlIHRva2VuIGNvbnRyb2xsZXIgY29udHJhY3QNCiAgICBmdW5jdGlvbiAoKSAgcGF5YWJsZSB7DQogICAgICAgIGlmIChpc0NvbnRyYWN0KGNvbnRyb2xsZXIpKSB7DQogICAgICAgICAgICBpZiAoISBUb2tlbkNvbnRyb2xsZXIoY29udHJvbGxlcikucHJveHlQYXltZW50LnZhbHVlKG1zZy52YWx1ZSkobXNnLnNlbmRlcikpDQogICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBFdmVudHMNCi8vLy8vLy8vLy8vLy8vLy8NCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX2Ftb3VudCk7DQogICAgZXZlbnQgTmV3Q2xvbmVUb2tlbihhZGRyZXNzIGluZGV4ZWQgX2Nsb25lVG9rZW4sIHVpbnQgX3NuYXBzaG90QmxvY2spOw0KICAgIGV2ZW50IEFwcHJvdmFsKA0KICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX293bmVyLA0KICAgICAgICBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsDQogICAgICAgIHVpbnQyNTYgX2Ftb3VudA0KICAgICAgICApOw0KDQp9DQoNCg0KLy8vLy8vLy8vLy8vLy8vLw0KLy8gTWluaU1lVG9rZW5GYWN0b3J5DQovLy8vLy8vLy8vLy8vLy8vDQoNCi8vLyBAZGV2IFRoaXMgY29udHJhY3QgaXMgdXNlZCB0byBnZW5lcmF0ZSBjbG9uZSBjb250cmFjdHMgZnJvbSBhIGNvbnRyYWN0Lg0KLy8vICBJbiBzb2xpZGl0eSB0aGlzIGlzIHRoZSB3YXkgdG8gY3JlYXRlIGEgY29udHJhY3QgZnJvbSBhIGNvbnRyYWN0IG9mIHRoZQ0KLy8vICBzYW1lIGNsYXNzDQpjb250cmFjdCBNaW5pTWVUb2tlbkZhY3Rvcnkgew0KDQogICAgLy8vIEBub3RpY2UgVXBkYXRlIHRoZSBEQXBwIGJ5IGNyZWF0aW5nIGEgbmV3IHRva2VuIHdpdGggbmV3IGZ1bmN0aW9uYWxpdGllcw0KICAgIC8vLyAgdGhlIG1zZy5zZW5kZXIgYmVjb21lcyB0aGUgY29udHJvbGxlciBvZiB0aGlzIGNsb25lIHRva2VuDQogICAgLy8vIEBwYXJhbSBfcGFyZW50VG9rZW4gQWRkcmVzcyBvZiB0aGUgdG9rZW4gYmVpbmcgY2xvbmVkDQogICAgLy8vIEBwYXJhbSBfc25hcHNob3RCbG9jayBCbG9jayBvZiB0aGUgcGFyZW50IHRva2VuIHRoYXQgd2lsbA0KICAgIC8vLyAgZGV0ZXJtaW5lIHRoZSBpbml0aWFsIGRpc3RyaWJ1dGlvbiBvZiB0aGUgY2xvbmUgdG9rZW4NCiAgICAvLy8gQHBhcmFtIF90b2tlbk5hbWUgTmFtZSBvZiB0aGUgbmV3IHRva2VuDQogICAgLy8vIEBwYXJhbSBfZGVjaW1hbFVuaXRzIE51bWJlciBvZiBkZWNpbWFscyBvZiB0aGUgbmV3IHRva2VuDQogICAgLy8vIEBwYXJhbSBfdG9rZW5TeW1ib2wgVG9rZW4gU3ltYm9sIGZvciB0aGUgbmV3IHRva2VuDQogICAgLy8vIEBwYXJhbSBfdHJhbnNmZXJzRW5hYmxlZCBJZiB0cnVlLCB0b2tlbnMgd2lsbCBiZSBhYmxlIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8vIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyB0b2tlbiBjb250cmFjdA0KICAgIGZ1bmN0aW9uIGNyZWF0ZUNsb25lVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3BhcmVudFRva2VuLA0KICAgICAgICB1aW50IF9zbmFwc2hvdEJsb2NrLA0KICAgICAgICBzdHJpbmcgX3Rva2VuTmFtZSwNCiAgICAgICAgdWludDggX2RlY2ltYWxVbml0cywNCiAgICAgICAgc3RyaW5nIF90b2tlblN5bWJvbCwNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJzRW5hYmxlZA0KICAgICkgcmV0dXJucyAoTWluaU1lVG9rZW4pIHsNCiAgICAgICAgTWluaU1lVG9rZW4gbmV3VG9rZW4gPSBuZXcgTWluaU1lVG9rZW4oDQogICAgICAgICAgICB0aGlzLA0KICAgICAgICAgICAgX3BhcmVudFRva2VuLA0KICAgICAgICAgICAgX3NuYXBzaG90QmxvY2ssDQogICAgICAgICAgICBfdG9rZW5OYW1lLA0KICAgICAgICAgICAgX2RlY2ltYWxVbml0cywNCiAgICAgICAgICAgIF90b2tlblN5bWJvbCwNCiAgICAgICAgICAgIF90cmFuc2ZlcnNFbmFibGVkDQogICAgICAgICAgICApOw0KDQogICAgICAgIG5ld1Rva2VuLmNoYW5nZUNvbnRyb2xsZXIobXNnLnNlbmRlcik7DQogICAgICAgIHJldHVybiBuZXdUb2tlbjsNCiAgICB9DQp9DQoNCg0KDQpjb250cmFjdCBPd25lZCB7DQogICAgLy8vIFByZXZlbnRzIG1ldGhvZHMgZnJvbSBwZXJmb21pbmcgYW55IHZhbHVlIHRyYW5zZmVyDQogICAgbW9kaWZpZXIgbm9FdGhlcigpIHtpZiAobXNnLnZhbHVlID4gMCkgdGhyb3c7IF87IH0NCiAgICAvLy8gQWxsb3dzIG9ubHkgdGhlIG93bmVyIHRvIGNhbGwgYSBmdW5jdGlvbg0KICAgIG1vZGlmaWVyIG9ubHlPd25lciB7IGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB0aHJvdzsgXzsgfQ0KDQogICAgYWRkcmVzcyBvd25lcjsNCg0KICAgIGZ1bmN0aW9uIE93bmVkKCkgeyBvd25lciA9IG1zZy5zZW5kZXI7fQ0KDQoNCg0KICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBvd25lciA9IF9uZXdPd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRPd25lcigpIG5vRXRoZXIgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gb3duZXI7DQogICAgfQ0KfQ0KDQoNCi8vLyBAdGl0bGUgQ2FtcGFpZ25Ub2tlbiBDb250cmFjdA0KLy8vIEBhdXRob3IgSm9yZGkgQmF5bGluYQ0KLy8vIEBkZXYgVGhpcyBpcyBkZXNpZ25lZCB0byBjb250cm9sIHRoZSBDaGFpcnR5VG9rZW4gY29udHJhY3QuDQoNCmNvbnRyYWN0IENhbXBhaWduIGlzIFRva2VuQ29udHJvbGxlciwgT3duZWQgew0KDQogICAgdWludCBwdWJsaWMgc3RhcnRGdW5kaW5nVGltZTsgICAgICAgLy8gSW4gVU5JWCBUaW1lIEZvcm1hdA0KICAgIHVpbnQgcHVibGljIGVuZEZ1bmRpbmdUaW1lOyAgICAgICAgIC8vIEluIFVOSVggVGltZSBGb3JtYXQNCiAgICB1aW50IHB1YmxpYyBtYXhpbXVtRnVuZGluZzsgICAgICAgICAvLyBJbiB3ZWkNCiAgICB1aW50IHB1YmxpYyB0b3RhbENvbGxlY3RlZDsgICAgICAgICAvLyBJbiB3ZWkNCiAgICBNaW5pTWVUb2tlbiBwdWJsaWMgdG9rZW5Db250cmFjdDsgIC8vIFRoZSBuZXcgdG9rZW4gZm9yIHRoaXMgQ2FtcGFpZ24NCiAgICBhZGRyZXNzIHB1YmxpYyB2YXVsdEFkZHJlc3M7ICAgICAgIC8vIFRoZSBhZGRyZXNzIHRvIGhvbGQgdGhlIGZ1bmRzIGRvbmF0ZWQNCg0KLy8vIEBub3RpY2UgJ0NhbXBhaWduKCknIGluaXRpYXRlcyB0aGUgQ2FtcGFpZ24gYnkgc2V0dGluZyBpdHMgZnVuZGluZw0KLy8vIHBhcmFtZXRlcnMgYW5kIGNyZWF0aW5nIHRoZSBkZXBsb3lpbmcgdGhlIHRva2VuIGNvbnRyYWN0DQovLy8gQGRldiBUaGVyZSBhcmUgc2V2ZXJhbCBjaGVja3MgdG8gbWFrZSBzdXJlIHRoZSBwYXJhbWV0ZXJzIGFyZSBhY2NlcHRhYmxlDQovLy8gQHBhcmFtIF9zdGFydEZ1bmRpbmdUaW1lIFRoZSBVTklYIHRpbWUgdGhhdCB0aGUgQ2FtcGFpZ24gd2lsbCBiZSBhYmxlIHRvDQovLy8gc3RhcnQgcmVjZWl2aW5nIGZ1bmRzDQovLy8gQHBhcmFtIF9lbmRGdW5kaW5nVGltZSBUaGUgVU5JWCB0aW1lIHRoYXQgdGhlIENhbXBhaWduIHdpbGwgc3RvcCBiZWluZyBhYmxlDQovLy8gdG8gcmVjZWl2ZSBmdW5kcw0KLy8vIEBwYXJhbSBfbWF4aW11bUZ1bmRpbmcgSW4gd2VpLCB0aGUgTWF4aW11bSBhbW91bnQgdGhhdCB0aGUgQ2FtcGFpZ24gY2FuDQovLy8gcmVjZWl2ZSAoY3VycmVudGx5IHRoZSBtYXggaXMgc2V0IGF0IDEwLDAwMCBFVEggZm9yIHRoZSBiZXRhKQ0KLy8vIEBwYXJhbSBfdmF1bHRBZGRyZXNzIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBzdG9yZSB0aGUgZG9uYXRlZCBmdW5kcw0KLy8vIEBwYXJhbSBfdG9rZW5BZGRyZXNzIEFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0DQoNCiAgICBmdW5jdGlvbiBDYW1wYWlnbigNCiAgICAgICAgdWludCBfc3RhcnRGdW5kaW5nVGltZSwNCiAgICAgICAgdWludCBfZW5kRnVuZGluZ1RpbWUsDQogICAgICAgIHVpbnQgX21heGltdW1GdW5kaW5nLA0KICAgICAgICBhZGRyZXNzIF92YXVsdEFkZHJlc3MsDQogICAgICAgIGFkZHJlc3MgX3Rva2VuQWRkcmVzcw0KICAgICkgew0KICAgICAgICBpZiAoKF9lbmRGdW5kaW5nVGltZSA8IG5vdykgfHwgICAgICAgICAgICAgICAgLy8gQ2Fubm90IHN0YXJ0IGluIHRoZSBwYXN0DQogICAgICAgICAgICAoX2VuZEZ1bmRpbmdUaW1lIDw9IF9zdGFydEZ1bmRpbmdUaW1lKSB8fA0KICAgICAgICAgICAgKF9tYXhpbXVtRnVuZGluZyA+IDEwMDAwMCBldGhlcikgfHwgICAgICAgIC8vIFRoZSBCZXRhIGlzIGxpbWl0ZWQNCiAgICAgICAgICAgIChfdmF1bHRBZGRyZXNzID09IDApKSAgICAgICAgICAgICAgICAgICAgLy8gVG8gcHJldmVudCBidXJuaW5nIEVUSA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICB9DQogICAgICAgIHN0YXJ0RnVuZGluZ1RpbWUgPSBfc3RhcnRGdW5kaW5nVGltZTsNCiAgICAgICAgZW5kRnVuZGluZ1RpbWUgPSBfZW5kRnVuZGluZ1RpbWU7DQogICAgICAgIG1heGltdW1GdW5kaW5nID0gX21heGltdW1GdW5kaW5nOw0KICAgICAgICB0b2tlbkNvbnRyYWN0ID0gTWluaU1lVG9rZW4oX3Rva2VuQWRkcmVzcyk7IC8vIERlcGxveXMgdGhlIFRva2VuIENvbnRyYWN0DQogICAgICAgIHZhdWx0QWRkcmVzcyA9IF92YXVsdEFkZHJlc3M7DQogICAgfQ0KDQovLy8gQGRldiBUaGUgZmFsbGJhY2sgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gZXRoZXIgaXMgc2VudCB0byB0aGUgY29udHJhY3QsIGl0DQovLy8gc2ltcGx5IGNhbGxzIGBkb1BheW1lbnQoKWAgd2l0aCB0aGUgYWRkcmVzcyB0aGF0IHNlbnQgdGhlIGV0aGVyIGFzIHRoZQ0KLy8vIGBfb3duZXJgLiBQYXlhYmxlIGlzIGEgcmVxdWlyZWQgc29saWRpdHkgbW9kaWZpZXIgZm9yIGZ1bmN0aW9ucyB0byByZWNlaXZlDQovLy8gZXRoZXIsIHdpdGhvdXQgdGhpcyBtb2RpZmllciB0aGV5IHdpbGwgdGhyb3cNCg0KICAgIGZ1bmN0aW9uICgpICBwYXlhYmxlIHsNCiAgICAgICAgZG9QYXltZW50KG1zZy5zZW5kZXIpOw0KICAgIH0NCg0KLy8vLy8vLy8vLy8vLy8vLy8NCi8vIFRva2VuQ29udHJvbGxlciBpbnRlcmZhY2UNCi8vLy8vLy8vLy8vLy8vLy8vDQoNCi8vLyBAbm90aWNlIGBwcm94eVBheW1lbnQoKWAgYWxsb3dzIHRoZSBjYWxsZXIgdG8gc2VuZCBldGhlciB0byB0aGUgQ2FtcGFpZ24gYW5kDQovLy8gaGF2ZSB0aGUgQ2FtcGFpZ25Ub2tlbnMgY3JlYXRlZCBpbiBhbiBhZGRyZXNzIG9mIHRoZWlyIGNob29zaW5nDQovLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgaG9sZCB0aGUgbmV3bHkgY3JlYXRlZCBDYW1wYWlnblRva2Vucw0KDQogICAgZnVuY3Rpb24gcHJveHlQYXltZW50KGFkZHJlc3MgX293bmVyKSBwYXlhYmxlIHJldHVybnMoYm9vbCkgew0KICAgICAgICBkb1BheW1lbnQoX293bmVyKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQovLy8gQG5vdGljZSBOb3RpZmllcyB0aGUgY29udHJvbGxlciBhYm91dCBhIHRyYW5zZmVyDQovLy8gQHBhcmFtIF9mcm9tIFRoZSBvcmlnaW4gb2YgdGhlIHRyYW5zZmVyDQovLy8gQHBhcmFtIF90byBUaGUgZGVzdGluYXRpb24gb2YgdGhlIHRyYW5zZmVyDQovLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0aGUgdHJhbnNmZXINCi8vLyBAcmV0dXJuIEZhbHNlIGlmIHRoZSBjb250cm9sbGVyIGRvZXMgbm90IGF1dGhvcml6ZSB0aGUgdHJhbnNmZXINCiAgICBmdW5jdGlvbiBvblRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIHJldHVybnMoYm9vbCkgew0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCi8vLyBAbm90aWNlIE5vdGlmaWVzIHRoZSBjb250cm9sbGVyIGFib3V0IGFuIGFwcHJvdmFsDQovLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IGNhbGxzIGBhcHByb3ZlKClgDQovLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBzcGVuZGVyIGluIHRoZSBgYXBwcm92ZSgpYCBjYWxsDQovLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtbW91bnQgaW4gdGhlIGBhcHByb3ZlKClgIGNhbGwNCi8vLyBAcmV0dXJuIEZhbHNlIGlmIHRoZSBjb250cm9sbGVyIGRvZXMgbm90IGF1dGhvcml6ZSB0aGUgYXBwcm92YWwNCiAgICBmdW5jdGlvbiBvbkFwcHJvdmUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2Ftb3VudCkNCiAgICAgICAgcmV0dXJucyhib29sKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQoNCi8vLyBAZGV2IGBkb1BheW1lbnQoKWAgaXMgYW4gaW50ZXJuYWwgZnVuY3Rpb24gdGhhdCBzZW5kcyB0aGUgZXRoZXIgdGhhdCB0aGlzDQovLy8gY29udHJhY3QgcmVjZWl2ZXMgdG8gdGhlIGB2YXVsdGAgYW5kIGNyZWF0ZXMgY2FtcGFpZ25Ub2tlbnMgaW4gdGhlDQovLy8gYWRkcmVzcyBvZiB0aGUgYF9vd25lcmAgYXNzdW1pbmcgdGhlIENhbXBhaWduIGlzIHN0aWxsIGFjY2VwdGluZyBmdW5kcw0KLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCB3aWxsIGhvbGQgdGhlIG5ld2x5IGNyZWF0ZWQgQ2FtcGFpZ25Ub2tlbnMNCg0KICAgIGZ1bmN0aW9uIGRvUGF5bWVudChhZGRyZXNzIF9vd25lcikgaW50ZXJuYWwgew0KDQovLyBGaXJzdCB3ZSBjaGVjayB0aGF0IHRoZSBDYW1wYWlnbiBpcyBhbGxvd2VkIHRvIHJlY2VpdmUgdGhpcyBkb25hdGlvbg0KICAgICAgICBpZiAoKG5vdzxzdGFydEZ1bmRpbmdUaW1lKSB8fA0KICAgICAgICAgICAgKG5vdz5lbmRGdW5kaW5nVGltZSkgfHwNCiAgICAgICAgICAgICh0b2tlbkNvbnRyYWN0LmNvbnRyb2xsZXIoKSA9PSAwKSB8fCAgICAgICAgICAgLy8gRXh0cmEgY2hlY2sNCiAgICAgICAgICAgIChtc2cudmFsdWUgPT0gMCkgfHwNCiAgICAgICAgICAgICh0b3RhbENvbGxlY3RlZCArIG1zZy52YWx1ZSA+IG1heGltdW1GdW5kaW5nKSkNCiAgICAgICAgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCg0KLy9UcmFjayBob3cgbXVjaCB0aGUgQ2FtcGFpZ24gaGFzIGNvbGxlY3RlZA0KICAgICAgICB0b3RhbENvbGxlY3RlZCArPSBtc2cudmFsdWU7DQoNCi8vU2VuZCB0aGUgZXRoZXIgdG8gdGhlIHZhdWx0DQogICAgICAgIGlmICghdmF1bHRBZGRyZXNzLnNlbmQobXNnLnZhbHVlKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCg0KLy8gQ3JlYXRlcyBhbiBlcXVhbCBhbW91bnQgb2YgQ2FtcGFpZ25Ub2tlbnMgYXMgZXRoZXIgc2VudC4gVGhlIG5ldyBDYW1wYWlnblRva2Vucw0KLy8gYXJlIGNyZWF0ZWQgaW4gdGhlIGBfb3duZXJgIGFkZHJlc3MNCiAgICAgICAgaWYgKCF0b2tlbkNvbnRyYWN0LmdlbmVyYXRlVG9rZW5zKF9vd25lciwgbXNnLnZhbHVlKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQovLy8gQG5vdGljZSBgZmluYWxpemVGdW5kaW5nKClgIGVuZHMgdGhlIENhbXBhaWduIGJ5IGNhbGxpbmcgcmVtb3ZpbmcgaGltc2VsZg0KLy8vIGFzIGEgY29udHJvbGxlci4NCi8vLyBAZGV2IGBmaW5hbGl6ZUZ1bmRpbmcoKWAgY2FuIG9ubHkgYmUgY2FsbGVkIGFmdGVyIHRoZSBlbmQgb2YgdGhlIGZ1bmRpbmcgcGVyaW9kLg0KDQogICAgZnVuY3Rpb24gZmluYWxpemVGdW5kaW5nKCkgew0KICAgICAgICBpZiAobm93IDwgZW5kRnVuZGluZ1RpbWUpIHRocm93Ow0KICAgICAgICB0b2tlbkNvbnRyYWN0LmNoYW5nZUNvbnRyb2xsZXIoMCk7DQogICAgfQ0KDQovLy8vLy8vLy8vLy8NCi8vIEluaXRpYWwgaW1wb3J0IGZyb20gdGhlIG9sZCB0b2tlbg0KLy8vLy8vLy8vLy8vDQoNCiAgICBib29sIHB1YmxpYyBzZWFsZWQ7DQoNCg0KICAgIGZ1bmN0aW9uIGZpbGwodWludFtdIGRhdGEpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChzZWFsZWQpDQogICAgICAgICAgICB0aHJvdzsNCg0KICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPCBkYXRhLmxlbmd0aDsgaSs9IDIpIHsNCiAgICAgICAgICAgIGFkZHJlc3MgZHRoID0gYWRkcmVzcyhkYXRhW2ldKTsNCiAgICAgICAgICAgIHVpbnQgYW1vdW50ID0gdWludChkYXRhW2krMV0pOw0KICAgICAgICAgICAgaWYgKCF0b2tlbkNvbnRyYWN0LmdlbmVyYXRlVG9rZW5zKGR0aCwgYW1vdW50KSkgew0KICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdG90YWxDb2xsZWN0ZWQgKz0gYW1vdW50Ow0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2VhbCgpIHsNCiAgICAgICAgaWYgKHNlYWxlZCkNCiAgICAgICAgICAgIHRocm93Ow0KDQogICAgICAgIHNlYWxlZD0gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRWYXVsdChhZGRyZXNzIF9uZXdWYXVsdEFkZHJlc3MpIG9ubHlPd25lciB7DQogICAgICAgIHZhdWx0QWRkcmVzcyA9IF9uZXdWYXVsdEFkZHJlc3M7DQogICAgfQ0KDQp9'