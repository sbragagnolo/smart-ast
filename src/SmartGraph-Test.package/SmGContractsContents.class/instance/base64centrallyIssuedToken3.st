base 64 content
base64centrallyIssuedToken3
	^'LyoNCiAqIEVSQzIwIGludGVyZmFjZQ0KICogc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KICovDQpjb250cmFjdCBFUkMyMCB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCg0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQoNCg0KLyoqDQogKiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzDQogKi8NCmNvbnRyYWN0IFNhZmVNYXRoIHsNCiAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPiAwKTsNCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSArIGI7DQogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogIH0NCn0NCg0KDQoNCi8qKg0KICogU3RhbmRhcmQgRVJDMjAgdG9rZW4gd2l0aCBTaG9ydCBIYW5kIEF0dGFjayBhbmQgYXBwcm92ZSgpIHJhY2UgY29uZGl0aW9uIG1pdGlnYXRpb24uDQogKg0KICogQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOg0KICogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sDQogKi8NCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgRVJDMjAsIFNhZmVNYXRoIHsNCg0KICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCg0KICAvLyBJbnRlcmZhY2UgbWFya2VyDQogIGJvb2wgcHVibGljIGNvbnN0YW50IGlzVG9rZW4gPSB0cnVlOw0KDQogIC8qKg0KICAgKg0KICAgKiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjaw0KICAgKg0KICAgKiBodHRwOi8vdmVzc2VuZXMuY29tL3RoZS1lcmMyMC1zaG9ydC1hZGRyZXNzLWF0dGFjay1leHBsYWluZWQvDQogICAqLw0KICBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7DQogICAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7DQogICAgICAgdGhyb3c7DQogICAgIH0NCiAgICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQoNCiAgICAvLyBDaGVjayBpcyBub3QgbmVlZGVkIGJlY2F1c2Ugc2FmZVN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0DQogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93Ow0KDQogICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsNCiAgICBiYWxhbmNlc1tfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VzW19mcm9tXSwgX3ZhbHVlKTsNCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoX2FsbG93YW5jZSwgX3ZhbHVlKTsNCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsNCiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2ANCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdA0KICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOg0KICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQ0KICAgIGlmICgoX3ZhbHVlICE9IDApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgdGhyb3c7DQoNCiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsNCiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgfQ0KDQp9DQoNCg0KDQovKioNCiAqIEEgdHJhaXQgdGhhdCBhbGxvd3MgYW55IHRva2VuIG93bmVyIHRvIGRlY3JlYXNlIHRoZSB0b2tlbiBzdXBwbHkuDQogKg0KICogV2UgYWRkIGEgQnVybmVkIGV2ZW50IHRvIGRpZmZlcmVudGlhdGUgZnJvbSBub3JtYWwgdHJhbnNmZXJzLg0KICogSG93ZXZlciwgd2Ugc3RpbGwgdHJ5IHRvIHN1cHBvcnQgc29tZSBsZWdhY3kgRXRoZXJldW0gZWNvY3N5c3RlbSwNCiAqIGFzIEVSQy0yMCBoYXMgbm90IHN0YW5kYXJkaXplZCBvbiB0aGUgYnVybiBldmVudCB5ZXQuDQogKg0KICovDQpjb250cmFjdCBCdXJuYWJsZVRva2VuIGlzIFN0YW5kYXJkVG9rZW4gew0KDQogIGFkZHJlc3MgcHVibGljIGNvbnN0YW50IEJVUk5fQUREUkVTUyA9IDA7DQoNCiAgLyoqIEhvdyBtYW55IHRva2VucyB3ZSBidXJuZWQgKi8NCiAgZXZlbnQgQnVybmVkKGFkZHJlc3MgYnVybmVyLCB1aW50IGJ1cm5lZEFtb3VudCk7DQoNCiAgLyoqDQogICAqIEJ1cm4gZXh0cmEgdG9rZW5zIGZyb20gYSBiYWxhbmNlLg0KICAgKg0KICAgKi8NCiAgZnVuY3Rpb24gYnVybih1aW50IGJ1cm5BbW91bnQpIHsNCiAgICBhZGRyZXNzIGJ1cm5lciA9IG1zZy5zZW5kZXI7DQogICAgYmFsYW5jZXNbYnVybmVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbYnVybmVyXSwgYnVybkFtb3VudCk7DQogICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBidXJuQW1vdW50KTsNCiAgICBCdXJuZWQoYnVybmVyLCBidXJuQW1vdW50KTsNCg0KICAgIC8vIEtlZXAgdG9rZW4gYmFsYW5jZSB0cmFja2luZyBzZXJ2aWNlcyBoYXBweSBieSBzZW5kaW5nIHRoZSBidXJuZWQgYW1vdW50IHRvDQogICAgLy8gImJ1cm4gYWRkcmVzcyIsIHNvIHRoYXQgaXQgd2lsbCBzaG93IHVwIGFzIGEgRVJDLTIwIHRyYW5zYWN0aW9uDQogICAgLy8gaW4gZXRoZXJzY2FuLCBldGMuIGFzIHRoZXJlIGlzIG5vIHN0YW5kYXJpemVkIGJ1cm4gZXZlbnQgeWV0DQogICAgVHJhbnNmZXIoYnVybmVyLCBCVVJOX0FERFJFU1MsIGJ1cm5BbW91bnQpOw0KICB9DQp9DQoNCg0KDQoNCi8qKg0KICogVXBncmFkZSBhZ2VudCBpbnRlcmZhY2UgaW5zcGlyZWQgYnkgTHVueXIuDQogKg0KICogVXBncmFkZSBhZ2VudCB0cmFuc2ZlcnMgdG9rZW5zIHRvIGEgbmV3IGNvbnRyYWN0Lg0KICogVXBncmFkZSBhZ2VudCBpdHNlbGYgY2FuIGJlIHRoZSB0b2tlbiBjb250cmFjdCwgb3IganVzdCBhIG1pZGRsZSBtYW4gY29udHJhY3QgZG9pbmcgdGhlIGhlYXZ5IGxpZnRpbmcuDQogKi8NCmNvbnRyYWN0IFVwZ3JhZGVBZ2VudCB7DQoNCiAgdWludCBwdWJsaWMgb3JpZ2luYWxTdXBwbHk7DQoNCiAgLyoqIEludGVyZmFjZSBtYXJrZXIgKi8NCiAgZnVuY3Rpb24gaXNVcGdyYWRlQWdlbnQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gdXBncmFkZUZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIHB1YmxpYzsNCg0KfQ0KDQoNCi8qKg0KICogQSB0b2tlbiB1cGdyYWRlIG1lY2hhbmlzbSB3aGVyZSB1c2VycyBjYW4gb3B0LWluIGFtb3VudCBvZiB0b2tlbnMgdG8gdGhlIG5leHQgc21hcnQgY29udHJhY3QgcmV2aXNpb24uDQogKg0KICogRmlyc3QgZW52aXNpb25lZCBieSBHb2xlbSBhbmQgTHVueXIgcHJvamVjdHMuDQogKi8NCmNvbnRyYWN0IFVwZ3JhZGVhYmxlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7DQoNCiAgLyoqIENvbnRyYWN0IC8gcGVyc29uIHdobyBjYW4gc2V0IHRoZSB1cGdyYWRlIHBhdGguIFRoaXMgY2FuIGJlIHRoZSBzYW1lIGFzIHRlYW0gbXVsdGlzaWcgd2FsbGV0LCBhcyB3aGF0IGl0IGlzIHdpdGggaXRzIGRlZmF1bHQgdmFsdWUuICovDQogIGFkZHJlc3MgcHVibGljIHVwZ3JhZGVNYXN0ZXI7DQoNCiAgLyoqIFRoZSBuZXh0IGNvbnRyYWN0IHdoZXJlIHRoZSB0b2tlbnMgd2lsbCBiZSBtaWdyYXRlZC4gKi8NCiAgVXBncmFkZUFnZW50IHB1YmxpYyB1cGdyYWRlQWdlbnQ7DQoNCiAgLyoqIEhvdyBtYW55IHRva2VucyB3ZSBoYXZlIHVwZ3JhZGVkIGJ5IG5vdy4gKi8NCiAgdWludDI1NiBwdWJsaWMgdG90YWxVcGdyYWRlZDsNCg0KICAvKioNCiAgICogVXBncmFkZSBzdGF0ZXMuDQogICAqDQogICAqIC0gTm90QWxsb3dlZDogVGhlIGNoaWxkIGNvbnRyYWN0IGhhcyBub3QgcmVhY2hlZCBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgdXBncmFkZSBjYW4gYmd1bg0KICAgKiAtIFdhaXRpbmdGb3JBZ2VudDogVG9rZW4gYWxsb3dzIHVwZ3JhZGUsIGJ1dCB3ZSBkb24ndCBoYXZlIGEgbmV3IGFnZW50IHlldA0KICAgKiAtIFJlYWR5VG9VcGdyYWRlOiBUaGUgYWdlbnQgaXMgc2V0LCBidXQgbm90IGEgc2luZ2xlIHRva2VuIGhhcyBiZWVuIHVwZ3JhZGVkIHlldA0KICAgKiAtIFVwZ3JhZGluZzogVXBncmFkZSBhZ2VudCBpcyBzZXQgYW5kIHRoZSBiYWxhbmNlIGhvbGRlcnMgY2FuIHVwZ3JhZGUgdGhlaXIgdG9rZW5zDQogICAqDQogICAqLw0KICBlbnVtIFVwZ3JhZGVTdGF0ZSB7VW5rbm93biwgTm90QWxsb3dlZCwgV2FpdGluZ0ZvckFnZW50LCBSZWFkeVRvVXBncmFkZSwgVXBncmFkaW5nfQ0KDQogIC8qKg0KICAgKiBTb21lYm9keSBoYXMgdXBncmFkZWQgc29tZSBvZiBoaXMgdG9rZW5zLg0KICAgKi8NCiAgZXZlbnQgVXBncmFkZShhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCg0KICAvKioNCiAgICogTmV3IHVwZ3JhZGUgYWdlbnQgYXZhaWxhYmxlLg0KICAgKi8NCiAgZXZlbnQgVXBncmFkZUFnZW50U2V0KGFkZHJlc3MgYWdlbnQpOw0KDQogIC8qKg0KICAgKiBEbyBub3QgYWxsb3cgY29uc3RydWN0aW9uIHdpdGhvdXQgdXBncmFkZSBtYXN0ZXIgc2V0Lg0KICAgKi8NCiAgZnVuY3Rpb24gVXBncmFkZWFibGVUb2tlbihhZGRyZXNzIF91cGdyYWRlTWFzdGVyKSB7DQogICAgdXBncmFkZU1hc3RlciA9IF91cGdyYWRlTWFzdGVyOw0KICB9DQoNCiAgLyoqDQogICAqIEFsbG93IHRoZSB0b2tlbiBob2xkZXIgdG8gdXBncmFkZSBzb21lIG9mIHRoZWlyIHRva2VucyB0byBhIG5ldyBjb250cmFjdC4NCiAgICovDQogIGZ1bmN0aW9uIHVwZ3JhZGUodWludDI1NiB2YWx1ZSkgcHVibGljIHsNCg0KICAgICAgVXBncmFkZVN0YXRlIHN0YXRlID0gZ2V0VXBncmFkZVN0YXRlKCk7DQogICAgICBpZighKHN0YXRlID09IFVwZ3JhZGVTdGF0ZS5SZWFkeVRvVXBncmFkZSB8fCBzdGF0ZSA9PSBVcGdyYWRlU3RhdGUuVXBncmFkaW5nKSkgew0KICAgICAgICAvLyBDYWxsZWQgaW4gYSBiYWQgc3RhdGUNCiAgICAgICAgdGhyb3c7DQogICAgICB9DQoNCiAgICAgIC8vIFZhbGlkYXRlIGlucHV0IHZhbHVlLg0KICAgICAgaWYgKHZhbHVlID09IDApIHRocm93Ow0KDQogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIHZhbHVlKTsNCg0KICAgICAgLy8gVGFrZSB0b2tlbnMgb3V0IGZyb20gY2lyY3VsYXRpb24NCiAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgdmFsdWUpOw0KICAgICAgdG90YWxVcGdyYWRlZCA9IHNhZmVBZGQodG90YWxVcGdyYWRlZCwgdmFsdWUpOw0KDQogICAgICAvLyBVcGdyYWRlIGFnZW50IHJlaXNzdWVzIHRoZSB0b2tlbnMNCiAgICAgIHVwZ3JhZGVBZ2VudC51cGdyYWRlRnJvbShtc2cuc2VuZGVyLCB2YWx1ZSk7DQogICAgICBVcGdyYWRlKG1zZy5zZW5kZXIsIHVwZ3JhZGVBZ2VudCwgdmFsdWUpOw0KICB9DQoNCiAgLyoqDQogICAqIFNldCBhbiB1cGdyYWRlIGFnZW50IHRoYXQgaGFuZGxlcw0KICAgKi8NCiAgZnVuY3Rpb24gc2V0VXBncmFkZUFnZW50KGFkZHJlc3MgYWdlbnQpIGV4dGVybmFsIHsNCg0KICAgICAgaWYoIWNhblVwZ3JhZGUoKSkgew0KICAgICAgICAvLyBUaGUgdG9rZW4gaXMgbm90IHlldCBpbiBhIHN0YXRlIHRoYXQgd2UgY291bGQgdGhpbmsgdXBncmFkaW5nDQogICAgICAgIHRocm93Ow0KICAgICAgfQ0KDQogICAgICBpZiAoYWdlbnQgPT0gMHgwKSB0aHJvdzsNCiAgICAgIC8vIE9ubHkgYSBtYXN0ZXIgY2FuIGRlc2lnbmF0ZSB0aGUgbmV4dCBhZ2VudA0KICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gdXBncmFkZU1hc3RlcikgdGhyb3c7DQogICAgICAvLyBVcGdyYWRlIGhhcyBhbHJlYWR5IGJlZ3VuIGZvciBhbiBhZ2VudA0KICAgICAgaWYgKGdldFVwZ3JhZGVTdGF0ZSgpID09IFVwZ3JhZGVTdGF0ZS5VcGdyYWRpbmcpIHRocm93Ow0KDQogICAgICB1cGdyYWRlQWdlbnQgPSBVcGdyYWRlQWdlbnQoYWdlbnQpOw0KDQogICAgICAvLyBCYWQgaW50ZXJmYWNlDQogICAgICBpZighdXBncmFkZUFnZW50LmlzVXBncmFkZUFnZW50KCkpIHRocm93Ow0KICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdG9rZW4gc3VwcGxpZXMgbWF0Y2ggaW4gc291cmNlIGFuZCB0YXJnZXQNCiAgICAgIGlmICh1cGdyYWRlQWdlbnQub3JpZ2luYWxTdXBwbHkoKSAhPSB0b3RhbFN1cHBseSkgdGhyb3c7DQoNCiAgICAgIFVwZ3JhZGVBZ2VudFNldCh1cGdyYWRlQWdlbnQpOw0KICB9DQoNCiAgLyoqDQogICAqIEdldCB0aGUgc3RhdGUgb2YgdGhlIHRva2VuIHVwZ3JhZGUuDQogICAqLw0KICBmdW5jdGlvbiBnZXRVcGdyYWRlU3RhdGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyhVcGdyYWRlU3RhdGUpIHsNCiAgICBpZighY2FuVXBncmFkZSgpKSByZXR1cm4gVXBncmFkZVN0YXRlLk5vdEFsbG93ZWQ7DQogICAgZWxzZSBpZihhZGRyZXNzKHVwZ3JhZGVBZ2VudCkgPT0gMHgwMCkgcmV0dXJuIFVwZ3JhZGVTdGF0ZS5XYWl0aW5nRm9yQWdlbnQ7DQogICAgZWxzZSBpZih0b3RhbFVwZ3JhZGVkID09IDApIHJldHVybiBVcGdyYWRlU3RhdGUuUmVhZHlUb1VwZ3JhZGU7DQogICAgZWxzZSByZXR1cm4gVXBncmFkZVN0YXRlLlVwZ3JhZGluZzsNCiAgfQ0KDQogIC8qKg0KICAgKiBDaGFuZ2UgdGhlIHVwZ3JhZGUgbWFzdGVyLg0KICAgKg0KICAgKiBUaGlzIGFsbG93cyB1cyB0byBzZXQgYSBuZXcgb3duZXIgZm9yIHRoZSB1cGdyYWRlIG1lY2hhbmlzbS4NCiAgICovDQogIGZ1bmN0aW9uIHNldFVwZ3JhZGVNYXN0ZXIoYWRkcmVzcyBtYXN0ZXIpIHB1YmxpYyB7DQogICAgICBpZiAobWFzdGVyID09IDB4MCkgdGhyb3c7DQogICAgICBpZiAobXNnLnNlbmRlciAhPSB1cGdyYWRlTWFzdGVyKSB0aHJvdzsNCiAgICAgIHVwZ3JhZGVNYXN0ZXIgPSBtYXN0ZXI7DQogIH0NCg0KICAvKioNCiAgICogQ2hpbGQgY29udHJhY3QgY2FuIGVuYWJsZSB0byBwcm92aWRlIHRoZSBjb25kaXRpb24gd2hlbiB0aGUgdXBncmFkZSBjYW4gYmVndW4uDQogICAqLw0KICBmdW5jdGlvbiBjYW5VcGdyYWRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgew0KICAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQp9DQoNCg0KDQovKioNCiAqIENlbnRyYWxseSBpc3N1ZWQgRXRoZXJldW0gdG9rZW4uDQogKg0KICogV2UgbWl4IGluIGJ1cm5hYmxlIGFuZCB1cGdyYWRlYWJsZSB0cmFpdHMuDQogKg0KICogVG9rZW4gc3VwcGx5IGlzIGNyZWF0ZWQgaW4gdGhlIHRva2VuIGNvbnRyYWN0IGNyZWF0aW9uIGFuZCBhbGxvY2F0ZWQgdG8gb3duZXIuDQogKiBUaGUgb3duZXIgY2FuIHRoZW4gdHJhbnNmZXIgZnJvbSBpdHMgc3VwcGx5IHRvIGNyb3dkc2FsZSBwYXJ0aWNpcGFudHMuDQogKiBUaGUgb3duZXIsIG9yIGFueWJvZHksIGNhbiBidXJuIGFueSBleGNlc3NpdmUgdG9rZW5zIHRoZXkgYXJlIGhvbGRpbmcuDQogKg0KICovDQpjb250cmFjdCBDZW50cmFsbHlJc3N1ZWRUb2tlbiBpcyBCdXJuYWJsZVRva2VuLCBVcGdyYWRlYWJsZVRva2VuIHsNCg0KICBzdHJpbmcgcHVibGljIG5hbWU7DQogIHN0cmluZyBwdWJsaWMgc3ltYm9sOw0KICB1aW50IHB1YmxpYyBkZWNpbWFsczsNCg0KICBmdW5jdGlvbiBDZW50cmFsbHlJc3N1ZWRUb2tlbihhZGRyZXNzIF9vd25lciwgc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCwgdWludCBfdG90YWxTdXBwbHksIHVpbnQgX2RlY2ltYWxzKSAgVXBncmFkZWFibGVUb2tlbihfb3duZXIpIHsNCiAgICBuYW1lID0gX25hbWU7DQogICAgc3ltYm9sID0gX3N5bWJvbDsNCiAgICB0b3RhbFN1cHBseSA9IF90b3RhbFN1cHBseTsNCiAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsNCg0KICAgIC8vIEFsbG9jYXRlIGluaXRpYWwgYmFsYW5jZSB0byB0aGUgb3duZXINCiAgICBiYWxhbmNlc1tfb3duZXJdID0gX3RvdGFsU3VwcGx5Ow0KICB9DQp9'