base 64 content
base64certificationDb
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4yOw0KDQovKioNCiAqIEBub3RpY2UgRGVjbGFyZXMgYSBjb250cmFjdCB0aGF0IGNhbiBoYXZlIGFuIG93bmVyLg0KICovDQpjb250cmFjdCBPd25lZEkgew0KICAgIGV2ZW50IExvZ093bmVyQ2hhbmdlZChhZGRyZXNzIGluZGV4ZWQgcHJldmlvdXNPd25lciwgYWRkcmVzcyBpbmRleGVkIG5ld093bmVyKTsNCg0KICAgIGZ1bmN0aW9uIGdldE93bmVyKCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyk7DQoNCiAgICBmdW5jdGlvbiBzZXRPd25lcihhZGRyZXNzIG5ld093bmVyKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOyANCn0NCg0KLyoqDQogKiBAbm90aWNlIERlZmluZXMgYSBjb250cmFjdCB0aGF0IGNhbiBoYXZlIGFuIG93bmVyLg0KICovDQpjb250cmFjdCBPd25lZCBpcyBPd25lZEkgew0KICAgIC8qKg0KICAgICAqIEBkZXYgTWFkZSBwcml2YXRlIHRvIHByb3RlY3QgYWdhaW5zdCBjaGlsZCBjb250cmFjdCBzZXR0aW5nIGl0IHRvIDAgYnkgbWlzdGFrZS4NCiAgICAgKi8NCiAgICBhZGRyZXNzIHByaXZhdGUgb3duZXI7DQoNCiAgICBmdW5jdGlvbiBPd25lZCgpIHsNCiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGZyb21Pd25lciB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldE93bmVyKCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gb3duZXI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0T3duZXIoYWRkcmVzcyBuZXdPd25lcikNCiAgICAgICAgZnJvbU93bmVyIA0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKG5ld093bmVyID09IDApIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIGlmIChvd25lciAhPSBuZXdPd25lcikgew0KICAgICAgICAgICAgTG9nT3duZXJDaGFuZ2VkKG93bmVyLCBuZXdPd25lcik7DQogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgICAgICB9DQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOw0KICAgIH0NCn0NCg0KY29udHJhY3QgV2l0aEJlbmVmaWNpYXJ5IGlzIE93bmVkIHsNCiAgICAvKioNCiAgICAgKiBAbm90aWNlIEFkZHJlc3MgdGhhdCBpcyBmb3J3YXJkZWQgYWxsIHZhbHVlLg0KICAgICAqIEBkZXYgTWFkZSBwcml2YXRlIHRvIHByb3RlY3QgYWdhaW5zdCBjaGlsZCBjb250cmFjdCBzZXR0aW5nIGl0IHRvIDAgYnkgbWlzdGFrZS4NCiAgICAgKi8NCiAgICBhZGRyZXNzIHByaXZhdGUgYmVuZWZpY2lhcnk7DQogICAgDQogICAgZXZlbnQgTG9nQmVuZWZpY2lhcnlTZXQoYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzQmVuZWZpY2lhcnksIGFkZHJlc3MgaW5kZXhlZCBuZXdCZW5lZmljaWFyeSk7DQoNCiAgICBmdW5jdGlvbiBXaXRoQmVuZWZpY2lhcnkoYWRkcmVzcyBfYmVuZWZpY2lhcnkpIHBheWFibGUgew0KICAgICAgICBpZiAoX2JlbmVmaWNpYXJ5ID09IDApIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5Ow0KICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkgew0KICAgICAgICAgICAgYXN5bmNTZW5kKGJlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXN5bmNTZW5kKGFkZHJlc3MgZGVzdCwgdWludCBhbW91bnQpIGludGVybmFsOw0KDQogICAgZnVuY3Rpb24gZ2V0QmVuZWZpY2lhcnkoKQ0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zIChhZGRyZXNzKSB7DQogICAgICAgIHJldHVybiBiZW5lZmljaWFyeTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRCZW5lZmljaWFyeShhZGRyZXNzIG5ld0JlbmVmaWNpYXJ5KQ0KICAgICAgICBmcm9tT3duZXIgDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAobmV3QmVuZWZpY2lhcnkgPT0gMCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGJlbmVmaWNpYXJ5ICE9IG5ld0JlbmVmaWNpYXJ5KSB7DQogICAgICAgICAgICBMb2dCZW5lZmljaWFyeVNldChiZW5lZmljaWFyeSwgbmV3QmVuZWZpY2lhcnkpOw0KICAgICAgICAgICAgYmVuZWZpY2lhcnkgPSBuZXdCZW5lZmljaWFyeTsNCiAgICAgICAgfQ0KICAgICAgICBzdWNjZXNzID0gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCiAgICAgICAgYXN5bmNTZW5kKGJlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgV2l0aEZlZSBpcyBXaXRoQmVuZWZpY2lhcnkgew0KICAgIC8vIEBub3RpY2UgQ29udHJhY3RzIGFza2luZyBmb3IgYSBjb25maXJtYXRpb24gb2YgYSBjZXJ0aWZpY2F0aW9uIG5lZWQgdG8gcGFzcyB0aGlzIGZlZS4NCiAgICB1aW50MjU2IHByaXZhdGUgcXVlcnlGZWU7DQoNCiAgICBldmVudCBMb2dRdWVyeUZlZVNldCh1aW50MjU2IHByZXZpb3VzUXVlcnlGZWUsIHVpbnQyNTYgbmV3UXVlcnlGZWUpOw0KDQogICAgZnVuY3Rpb24gV2l0aEZlZSgNCiAgICAgICAgICAgIGFkZHJlc3MgYmVuZWZpY2lhcnksDQogICAgICAgICAgICB1aW50MjU2IF9xdWVyeUZlZSkNCiAgICAgICAgV2l0aEJlbmVmaWNpYXJ5KGJlbmVmaWNpYXJ5KSB7DQogICAgICAgIHF1ZXJ5RmVlID0gX3F1ZXJ5RmVlOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHJlcXVlc3RGZWVQYWlkIHsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IHF1ZXJ5RmVlKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBhc3luY1NlbmQoZ2V0QmVuZWZpY2lhcnkoKSwgbXNnLnZhbHVlKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRRdWVyeUZlZSgpDQogICAgICAgIGNvbnN0YW50DQogICAgICAgIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICAgICAgcmV0dXJuIHF1ZXJ5RmVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNldFF1ZXJ5RmVlKHVpbnQyNTYgbmV3UXVlcnlGZWUpDQogICAgICAgIGZyb21Pd25lcg0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKHF1ZXJ5RmVlICE9IG5ld1F1ZXJ5RmVlKSB7DQogICAgICAgICAgICBMb2dRdWVyeUZlZVNldChxdWVyeUZlZSwgbmV3UXVlcnlGZWUpOw0KICAgICAgICAgICAgcXVlcnlGZWUgPSBuZXdRdWVyeUZlZTsNCiAgICAgICAgfQ0KICAgICAgICBzdWNjZXNzID0gdHJ1ZTsNCiAgICB9DQp9DQoNCi8qDQogKiBAbm90aWNlIEJhc2UgY29udHJhY3Qgc3VwcG9ydGluZyBhc3luYyBzZW5kIGZvciBwdWxsIHBheW1lbnRzLg0KICogSW5oZXJpdCBmcm9tIHRoaXMgY29udHJhY3QgYW5kIHVzZSBhc3luY1NlbmQgaW5zdGVhZCBvZiBzZW5kLg0KICogaHR0cHM6Ly9naXRodWIuY29tL09wZW5aZXBwZWxpbi96ZXAtc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL1B1bGxQYXltZW50Q2FwYWJsZS5zb2wNCiAqLw0KY29udHJhY3QgUHVsbFBheW1lbnRDYXBhYmxlIHsNCiAgICB1aW50MjU2IHByaXZhdGUgdG90YWxCYWxhbmNlOw0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBwcml2YXRlIHBheW1lbnRzOw0KDQogICAgZXZlbnQgTG9nUGF5bWVudFJlY2VpdmVkKGFkZHJlc3MgaW5kZXhlZCBkZXN0LCB1aW50MjU2IGFtb3VudCk7DQoNCiAgICBmdW5jdGlvbiBQdWxsUGF5bWVudENhcGFibGUoKSB7DQogICAgICAgIGlmICgwIDwgdGhpcy5iYWxhbmNlKSB7DQogICAgICAgICAgICBhc3luY1NlbmQobXNnLnNlbmRlciwgdGhpcy5iYWxhbmNlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIHN0b3JlIHNlbnQgYW1vdW50IGFzIGNyZWRpdCB0byBiZSBwdWxsZWQsIGNhbGxlZCBieSBwYXllcg0KICAgIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQyNTYgYW1vdW50KSBpbnRlcm5hbCB7DQogICAgICAgIGlmIChhbW91bnQgPiAwKSB7DQogICAgICAgICAgICB0b3RhbEJhbGFuY2UgKz0gYW1vdW50Ow0KICAgICAgICAgICAgcGF5bWVudHNbZGVzdF0gKz0gYW1vdW50Ow0KICAgICAgICAgICAgTG9nUGF5bWVudFJlY2VpdmVkKGRlc3QsIGFtb3VudCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRUb3RhbEJhbGFuY2UoKQ0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50MjU2KSB7DQogICAgICAgIHJldHVybiB0b3RhbEJhbGFuY2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0UGF5bWVudE9mKGFkZHJlc3MgYmVuZWZpY2lhcnkpIA0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50MjU2KSB7DQogICAgICAgIHJldHVybiBwYXltZW50c1tiZW5lZmljaWFyeV07DQogICAgfQ0KDQogICAgLy8gd2l0aGRyYXcgYWNjdW11bGF0ZWQgYmFsYW5jZSwgY2FsbGVkIGJ5IHBheWVlDQogICAgZnVuY3Rpb24gd2l0aGRyYXdQYXltZW50cygpDQogICAgICAgIGV4dGVybmFsIA0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgdWludDI1NiBwYXltZW50ID0gcGF5bWVudHNbbXNnLnNlbmRlcl07DQogICAgICAgIHBheW1lbnRzW21zZy5zZW5kZXJdID0gMDsNCiAgICAgICAgdG90YWxCYWxhbmNlIC09IHBheW1lbnQ7DQogICAgICAgIGlmICghbXNnLnNlbmRlci5jYWxsLnZhbHVlKHBheW1lbnQpKCkpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGZpeEJhbGFuY2UoKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gZml4QmFsYW5jZUludGVybmFsKGFkZHJlc3MgZGVzdCkNCiAgICAgICAgaW50ZXJuYWwNCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmICh0b3RhbEJhbGFuY2UgPCB0aGlzLmJhbGFuY2UpIHsNCiAgICAgICAgICAgIHVpbnQyNTYgYW1vdW50ID0gdGhpcy5iYWxhbmNlIC0gdG90YWxCYWxhbmNlOw0KICAgICAgICAgICAgcGF5bWVudHNbZGVzdF0gKz0gYW1vdW50Ow0KICAgICAgICAgICAgTG9nUGF5bWVudFJlY2VpdmVkKGRlc3QsIGFtb3VudCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KfQ0KDQovLyBAbm90aWNlIEludGVyZmFjZSBmb3IgYSBjZXJ0aWZpZXIgZGF0YWJhc2UNCmNvbnRyYWN0IENlcnRpZmllckRiSSB7DQogICAgZXZlbnQgTG9nQ2VydGlmaWVyQWRkZWQoYWRkcmVzcyBpbmRleGVkIGNlcnRpZmllcik7DQoNCiAgICBldmVudCBMb2dDZXJ0aWZpZXJSZW1vdmVkKGFkZHJlc3MgaW5kZXhlZCBjZXJ0aWZpZXIpOw0KDQogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWVyKGFkZHJlc3MgY2VydGlmaWVyKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWVyKGFkZHJlc3MgY2VydGlmaWVyKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWVyc0NvdW50KCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCk7DQoNCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpZXJTdGF0dXMoYWRkcmVzcyBjZXJ0aWZpZXJBZGRyKQ0KICAgICAgICBjb25zdGFudCANCiAgICAgICAgcmV0dXJucyAoYm9vbCBhdXRob3Jpc2VkLCB1aW50MjU2IGluZGV4KTsNCg0KICAgIGZ1bmN0aW9uIGdldENlcnRpZmllckF0SW5kZXgodWludDI1NiBpbmRleCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyk7DQoNCiAgICBmdW5jdGlvbiBpc0NlcnRpZmllcihhZGRyZXNzIGNlcnRpZmllcikNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYm9vbCBpc0luZGVlZCk7DQp9DQoNCmNvbnRyYWN0IENlcnRpZmljYXRpb25EYkkgew0KICAgIGV2ZW50IExvZ0NlcnRpZmllckRiQ2hhbmdlZCgNCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHByZXZpb3VzQ2VydGlmaWVyRGIsDQogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBuZXdDZXJ0aWZpZXJEYik7DQoNCiAgICBldmVudCBMb2dTdHVkZW50Q2VydGlmaWVkKA0KICAgICAgICBhZGRyZXNzIGluZGV4ZWQgc3R1ZGVudCwgdWludCB0aW1lc3RhbXAsDQogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBjZXJ0aWZpZXIsIGJ5dGVzMzIgaW5kZXhlZCBkb2N1bWVudCk7DQoNCiAgICBldmVudCBMb2dTdHVkZW50VW5jZXJ0aWZpZWQoDQogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBzdHVkZW50LCB1aW50IHRpbWVzdGFtcCwNCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIGNlcnRpZmllcik7DQoNCiAgICBldmVudCBMb2dDZXJ0aWZpY2F0aW9uRG9jdW1lbnRBZGRlZCgNCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHN0dWRlbnQsIGJ5dGVzMzIgaW5kZXhlZCBkb2N1bWVudCk7DQoNCiAgICBldmVudCBMb2dDZXJ0aWZpY2F0aW9uRG9jdW1lbnRSZW1vdmVkKA0KICAgICAgICBhZGRyZXNzIGluZGV4ZWQgc3R1ZGVudCwgYnl0ZXMzMiBpbmRleGVkIGRvY3VtZW50KTsNCg0KICAgIGZ1bmN0aW9uIGdldENlcnRpZmllckRiKCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcyk7DQoNCiAgICBmdW5jdGlvbiBzZXRDZXJ0aWZpZXJEYihhZGRyZXNzIG5ld0NlcnRpZmllckRiKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gY2VydGlmeShhZGRyZXNzIHN0dWRlbnQsIGJ5dGVzMzIgZG9jdW1lbnQpDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICBmdW5jdGlvbiB1bmNlcnRpZnkoYWRkcmVzcyBzdHVkZW50KQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkNCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIGZ1bmN0aW9uIGFkZENlcnRpZmljYXRpb25Eb2N1bWVudFRvU2VsZihieXRlczMyIGRvY3VtZW50KQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkNCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIGZ1bmN0aW9uIHJlbW92ZUNlcnRpZmljYXRpb25Eb2N1bWVudEZyb21TZWxmKGJ5dGVzMzIgZG9jdW1lbnQpDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpZWRTdHVkZW50c0NvdW50KCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCk7DQoNCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpZWRTdHVkZW50QXRJbmRleCh1aW50IGluZGV4KQ0KICAgICAgICBwYXlhYmxlDQogICAgICAgIHJldHVybnMgKGFkZHJlc3Mgc3R1ZGVudCk7DQoNCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpY2F0aW9uKGFkZHJlc3Mgc3R1ZGVudCkNCiAgICAgICAgcGF5YWJsZQ0KICAgICAgICByZXR1cm5zIChib29sIGNlcnRpZmllZCwgdWludCB0aW1lc3RhbXAsIGFkZHJlc3MgY2VydGlmaWVyLCB1aW50IGRvY3VtZW50Q291bnQpOw0KDQogICAgZnVuY3Rpb24gaXNDZXJ0aWZpZWQoYWRkcmVzcyBzdHVkZW50KQ0KICAgICAgICBwYXlhYmxlDQogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpOw0KDQogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWNhdGlvbkRvY3VtZW50QXRJbmRleChhZGRyZXNzIHN0dWRlbnQsIHVpbnQyNTYgaW5kZXgpDQogICAgICAgIHBheWFibGUNCiAgICAgICAgcmV0dXJucyAoYnl0ZXMzMiBkb2N1bWVudCk7DQoNCiAgICBmdW5jdGlvbiBpc0NlcnRpZmljYXRpb24oYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQ0KICAgICAgICBwYXlhYmxlDQogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpOw0KfQ0KDQpjb250cmFjdCBDZXJ0aWZpY2F0aW9uRGIgaXMgQ2VydGlmaWNhdGlvbkRiSSwgV2l0aEZlZSwgUHVsbFBheW1lbnRDYXBhYmxlIHsNCiAgICAvLyBAbm90aWNlIFdoZXJlIHdlIGNoZWNrIGZvciBjZXJ0aWZpZXJzLg0KICAgIENlcnRpZmllckRiSSBwcml2YXRlIGNlcnRpZmllckRiOw0KDQogICAgc3RydWN0IERvY3VtZW50U3RhdHVzIHsNCiAgICAgICAgYm9vbCBpc1ZhbGlkOw0KICAgICAgICB1aW50MjU2IGluZGV4Ow0KICAgIH0NCg0KICAgIHN0cnVjdCBDZXJ0aWZpY2F0aW9uIHsNCiAgICAgICAgYm9vbCBjZXJ0aWZpZWQ7DQogICAgICAgIHVpbnQyNTYgdGltZXN0YW1wOw0KICAgICAgICBhZGRyZXNzIGNlcnRpZmllcjsNCiAgICAgICAgbWFwcGluZyhieXRlczMyID0+IERvY3VtZW50U3RhdHVzKSBkb2N1bWVudFN0YXR1c2VzOw0KICAgICAgICBieXRlczMyW10gZG9jdW1lbnRzOw0KICAgICAgICB1aW50MjU2IGluZGV4Ow0KICAgIH0NCg0KICAgIC8vIEBub3RpY2UgQWRkcmVzcyBvZiBjZXJ0aWZpZWQgc3R1ZGVudHMuDQogICAgbWFwcGluZyhhZGRyZXNzID0+IENlcnRpZmljYXRpb24pIHN0dWRlbnRDZXJ0aWZpY2F0aW9uczsNCiAgICAvLyBAbm90aWNlIFRoZSBwb3RlbnRpYWxseSBsb25nIGxpc3Qgb2YgYWxsIGNlcnRpZmllZCBzdHVkZW50cy4NCiAgICBhZGRyZXNzW10gY2VydGlmaWVkU3R1ZGVudHM7DQoNCiAgICBmdW5jdGlvbiBDZXJ0aWZpY2F0aW9uRGIoDQogICAgICAgICAgICBhZGRyZXNzIGJlbmVmaWNpYXJ5LA0KICAgICAgICAgICAgdWludDI1NiBjZXJ0aWZpY2F0aW9uUXVlcnlGZWUsDQogICAgICAgICAgICBhZGRyZXNzIF9jZXJ0aWZpZXJEYikNCiAgICAgICAgICAgIFdpdGhGZWUoYmVuZWZpY2lhcnksIGNlcnRpZmljYXRpb25RdWVyeUZlZSkgew0KICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKF9jZXJ0aWZpZXJEYiA9PSAwKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBjZXJ0aWZpZXJEYiA9IENlcnRpZmllckRiSShfY2VydGlmaWVyRGIpOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGZyb21DZXJ0aWZpZXIgew0KICAgICAgICBpZiAoIWNlcnRpZmllckRiLmlzQ2VydGlmaWVyKG1zZy5zZW5kZXIpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldENlcnRpZmllckRiKCkNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gY2VydGlmaWVyRGI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0Q2VydGlmaWVyRGIoYWRkcmVzcyBuZXdDZXJ0aWZpZXJEYikNCiAgICAgICAgZnJvbU93bmVyDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAobmV3Q2VydGlmaWVyRGIgPT0gMCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNlcnRpZmllckRiICE9IG5ld0NlcnRpZmllckRiKSB7DQogICAgICAgICAgICBMb2dDZXJ0aWZpZXJEYkNoYW5nZWQoY2VydGlmaWVyRGIsIG5ld0NlcnRpZmllckRiKTsNCiAgICAgICAgICAgIGNlcnRpZmllckRiID0gQ2VydGlmaWVyRGJJKG5ld0NlcnRpZmllckRiKTsNCiAgICAgICAgfQ0KICAgICAgICBzdWNjZXNzID0gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjZXJ0aWZ5KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkgDQogICAgICAgIGZyb21DZXJ0aWZpZXINCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChzdHVkZW50ID09IDAgfHwgc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmNlcnRpZmllZCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgYm9vbCBkb2N1bWVudEV4aXN0cyA9IGRvY3VtZW50ICE9IDA7DQogICAgICAgIHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XSA9IENlcnRpZmljYXRpb24oew0KICAgICAgICAgICAgY2VydGlmaWVkOiB0cnVlLA0KICAgICAgICAgICAgdGltZXN0YW1wOiBub3csDQogICAgICAgICAgICBjZXJ0aWZpZXI6IG1zZy5zZW5kZXIsDQogICAgICAgICAgICBkb2N1bWVudHM6IG5ldyBieXRlczMyW10oMCksDQogICAgICAgICAgICBpbmRleDogY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoDQogICAgICAgIH0pOw0KICAgICAgICBpZiAoZG9jdW1lbnRFeGlzdHMpIHsNCiAgICAgICAgICAgIHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XS5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XSA9IERvY3VtZW50U3RhdHVzKHsNCiAgICAgICAgICAgICAgICBpc1ZhbGlkOiB0cnVlLA0KICAgICAgICAgICAgICAgIGluZGV4OiBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uZG9jdW1lbnRzLmxlbmd0aA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uZG9jdW1lbnRzLnB1c2goZG9jdW1lbnQpOw0KICAgICAgICB9DQogICAgICAgIGNlcnRpZmllZFN0dWRlbnRzLnB1c2goc3R1ZGVudCk7DQogICAgICAgIExvZ1N0dWRlbnRDZXJ0aWZpZWQoc3R1ZGVudCwgbm93LCBtc2cuc2VuZGVyLCBkb2N1bWVudCk7DQogICAgICAgIHN1Y2Nlc3MgPSB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHVuY2VydGlmeShhZGRyZXNzIHN0dWRlbnQpIA0KICAgICAgICBmcm9tQ2VydGlmaWVyIA0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKCFzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uY2VydGlmaWVkDQogICAgICAgICAgICAvLyBZb3UgbmVlZCB0byB1bmNlcnRpZnkgYWxsIGRvY3VtZW50cyBmaXJzdA0KICAgICAgICAgICAgfHwgc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmRvY3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICB1aW50MjU2IGluZGV4ID0gc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmluZGV4Ow0KICAgICAgICBkZWxldGUgc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdOw0KICAgICAgICBpZiAoY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoID4gMSkgew0KICAgICAgICAgICAgY2VydGlmaWVkU3R1ZGVudHNbaW5kZXhdID0gY2VydGlmaWVkU3R1ZGVudHNbY2VydGlmaWVkU3R1ZGVudHMubGVuZ3RoIC0gMV07DQogICAgICAgICAgICBzdHVkZW50Q2VydGlmaWNhdGlvbnNbY2VydGlmaWVkU3R1ZGVudHNbaW5kZXhdXS5pbmRleCA9IGluZGV4Ow0KICAgICAgICB9DQogICAgICAgIGNlcnRpZmllZFN0dWRlbnRzLmxlbmd0aC0tOw0KICAgICAgICBMb2dTdHVkZW50VW5jZXJ0aWZpZWQoc3R1ZGVudCwgbm93LCBtc2cuc2VuZGVyKTsNCiAgICAgICAgc3VjY2VzcyA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkNCiAgICAgICAgZnJvbUNlcnRpZmllcg0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgc3VjY2VzcyA9IGFkZENlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKHN0dWRlbnQsIGRvY3VtZW50KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhZGRDZXJ0aWZpY2F0aW9uRG9jdW1lbnRUb1NlbGYoYnl0ZXMzMiBkb2N1bWVudCkNCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHN1Y2Nlc3MgPSBhZGRDZXJ0aWZpY2F0aW9uRG9jdW1lbnRJbnRlcm5hbChtc2cuc2VuZGVyLCBkb2N1bWVudCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYWRkQ2VydGlmaWNhdGlvbkRvY3VtZW50SW50ZXJuYWwoYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQ0KICAgICAgICBpbnRlcm5hbA0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKCFzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uY2VydGlmaWVkDQogICAgICAgICAgICB8fCBkb2N1bWVudCA9PSAwKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBDZXJ0aWZpY2F0aW9uIGNlcnRpZmljYXRpb24gPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF07DQogICAgICAgIGlmICghY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XS5pc1ZhbGlkKSB7DQogICAgICAgICAgICBjZXJ0aWZpY2F0aW9uLmRvY3VtZW50U3RhdHVzZXNbZG9jdW1lbnRdID0gRG9jdW1lbnRTdGF0dXMoew0KICAgICAgICAgICAgICAgIGlzVmFsaWQ6ICB0cnVlLA0KICAgICAgICAgICAgICAgIGluZGV4OiBjZXJ0aWZpY2F0aW9uLmRvY3VtZW50cy5sZW5ndGgNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudHMucHVzaChkb2N1bWVudCk7DQogICAgICAgICAgICBMb2dDZXJ0aWZpY2F0aW9uRG9jdW1lbnRBZGRlZChzdHVkZW50LCBkb2N1bWVudCk7DQogICAgICAgIH0NCiAgICAgICAgc3VjY2VzcyA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVtb3ZlQ2VydGlmaWNhdGlvbkRvY3VtZW50KGFkZHJlc3Mgc3R1ZGVudCwgYnl0ZXMzMiBkb2N1bWVudCkNCiAgICAgICAgZnJvbUNlcnRpZmllcg0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgc3VjY2VzcyA9IHJlbW92ZUNlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKHN0dWRlbnQsIGRvY3VtZW50KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZW1vdmVDZXJ0aWZpY2F0aW9uRG9jdW1lbnRGcm9tU2VsZihieXRlczMyIGRvY3VtZW50KQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgc3VjY2VzcyA9IHJlbW92ZUNlcnRpZmljYXRpb25Eb2N1bWVudEludGVybmFsKG1zZy5zZW5kZXIsIGRvY3VtZW50KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZW1vdmVDZXJ0aWZpY2F0aW9uRG9jdW1lbnRJbnRlcm5hbChhZGRyZXNzIHN0dWRlbnQsIGJ5dGVzMzIgZG9jdW1lbnQpDQogICAgICAgIGludGVybmFsDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoIXN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XS5jZXJ0aWZpZWQpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIENlcnRpZmljYXRpb24gY2VydGlmaWNhdGlvbiA9IHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XTsNCiAgICAgICAgaWYgKGNlcnRpZmljYXRpb24uZG9jdW1lbnRTdGF0dXNlc1tkb2N1bWVudF0uaXNWYWxpZCkgew0KICAgICAgICAgICAgdWludDI1NiBpbmRleCA9IGNlcnRpZmljYXRpb24uZG9jdW1lbnRTdGF0dXNlc1tkb2N1bWVudF0uaW5kZXg7DQogICAgICAgICAgICBkZWxldGUgY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2RvY3VtZW50XTsNCiAgICAgICAgICAgIGlmIChjZXJ0aWZpY2F0aW9uLmRvY3VtZW50cy5sZW5ndGggPiAxKSB7DQogICAgICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudHNbaW5kZXhdID0NCiAgICAgICAgICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudHNbY2VydGlmaWNhdGlvbi5kb2N1bWVudHMubGVuZ3RoIC0gMV07DQogICAgICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5kb2N1bWVudFN0YXR1c2VzW2NlcnRpZmljYXRpb24uZG9jdW1lbnRzW2luZGV4XV0uaW5kZXggPSBpbmRleDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNlcnRpZmljYXRpb24uZG9jdW1lbnRzLmxlbmd0aC0tOw0KICAgICAgICAgICAgTG9nQ2VydGlmaWNhdGlvbkRvY3VtZW50UmVtb3ZlZChzdHVkZW50LCBkb2N1bWVudCk7DQogICAgICAgIH0NCiAgICAgICAgc3VjY2VzcyA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWVkU3R1ZGVudHNDb3VudCgpDQogICAgICAgIGNvbnN0YW50DQogICAgICAgIHJldHVybnMgKHVpbnQyNTYgY291bnQpIHsNCiAgICAgICAgY291bnQgPSBjZXJ0aWZpZWRTdHVkZW50cy5sZW5ndGg7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWVkU3R1ZGVudEF0SW5kZXgodWludDI1NiBpbmRleCkNCiAgICAgICAgcGF5YWJsZQ0KICAgICAgICByZXF1ZXN0RmVlUGFpZA0KICAgICAgICByZXR1cm5zIChhZGRyZXNzIHN0dWRlbnQpIHsNCiAgICAgICAgc3R1ZGVudCA9IGNlcnRpZmllZFN0dWRlbnRzW2luZGV4XTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAbm90aWNlIFJlcXVlc3RpbmcgYSBjZXJ0aWZpY2F0aW9uIGlzIGEgcGF5aW5nIGZlYXR1cmUuDQogICAgICovDQogICAgZnVuY3Rpb24gZ2V0Q2VydGlmaWNhdGlvbihhZGRyZXNzIHN0dWRlbnQpDQogICAgICAgIHBheWFibGUNCiAgICAgICAgcmVxdWVzdEZlZVBhaWQNCiAgICAgICAgcmV0dXJucyAoYm9vbCBjZXJ0aWZpZWQsIHVpbnQyNTYgdGltZXN0YW1wLCBhZGRyZXNzIGNlcnRpZmllciwgdWludDI1NiBkb2N1bWVudENvdW50KSB7DQogICAgICAgIENlcnRpZmljYXRpb24gY2VydGlmaWNhdGlvbiA9IHN0dWRlbnRDZXJ0aWZpY2F0aW9uc1tzdHVkZW50XTsNCiAgICAgICAgcmV0dXJuIChjZXJ0aWZpY2F0aW9uLmNlcnRpZmllZCwNCiAgICAgICAgICAgIGNlcnRpZmljYXRpb24udGltZXN0YW1wLA0KICAgICAgICAgICAgY2VydGlmaWNhdGlvbi5jZXJ0aWZpZXIsDQogICAgICAgICAgICBjZXJ0aWZpY2F0aW9uLmRvY3VtZW50cy5sZW5ndGgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBub3RpY2UgUmVxdWVzdGluZyBhIGNlcnRpZmljYXRpb24gY29uZmlybWF0aW9uIGlzIGEgcGF5aW5nIGZlYXR1cmUuDQogICAgICovDQogICAgZnVuY3Rpb24gaXNDZXJ0aWZpZWQoYWRkcmVzcyBzdHVkZW50KQ0KICAgICAgICBwYXlhYmxlDQogICAgICAgIHJlcXVlc3RGZWVQYWlkDQogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpIHsNCiAgICAgICAgaXNJbmRlZWQgPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uY2VydGlmaWVkOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBub3RpY2UgUmVxdWVzdGluZyBhIGNlcnRpZmljYXRpb24gZG9jdW1lbnQgYnkgaW5kZXggaXMgYSBwYXlpbmcgZmVhdHVyZS4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBnZXRDZXJ0aWZpY2F0aW9uRG9jdW1lbnRBdEluZGV4KGFkZHJlc3Mgc3R1ZGVudCwgdWludDI1NiBpbmRleCkNCiAgICAgICAgcGF5YWJsZQ0KICAgICAgICByZXF1ZXN0RmVlUGFpZA0KICAgICAgICByZXR1cm5zIChieXRlczMyIGRvY3VtZW50KSB7DQogICAgICAgIGRvY3VtZW50ID0gc3R1ZGVudENlcnRpZmljYXRpb25zW3N0dWRlbnRdLmRvY3VtZW50c1tpbmRleF07DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQG5vdGljZSBSZXF1ZXN0aW5nIGEgY29uZmlybWF0aW9uIHRoYXQgYSBkb2N1bWVudCBpcyBhIGNlcnRpZmljYXRpb24gaXMgYSBwYXlpbmcgZmVhdHVyZS4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBpc0NlcnRpZmljYXRpb24oYWRkcmVzcyBzdHVkZW50LCBieXRlczMyIGRvY3VtZW50KQ0KICAgICAgICBwYXlhYmxlDQogICAgICAgIHJlcXVlc3RGZWVQYWlkDQogICAgICAgIHJldHVybnMgKGJvb2wgaXNJbmRlZWQpIHsNCiAgICAgICAgaXNJbmRlZWQgPSBzdHVkZW50Q2VydGlmaWNhdGlvbnNbc3R1ZGVudF0uZG9jdW1lbnRTdGF0dXNlc1tkb2N1bWVudF0uaXNWYWxpZDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBmaXhCYWxhbmNlKCkNCiAgICAgICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHJldHVybiBmaXhCYWxhbmNlSW50ZXJuYWwoZ2V0QmVuZWZpY2lhcnkoKSk7DQogICAgfQ0KfQ=='