base 64 content
base64contribution1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLyoNCiAgQ29weXJpZ2h0IDIwMTcsIEFudG9uIEVnb3JvdiAoTW90aGVyc2hpcCBGb3VuZGF0aW9uKQ0KICBDb3B5cmlnaHQgMjAxNywgS2xhdXMgSG90dCAoQmxvY2tjaGFpbkxhYnMubnopDQogIENvcHlyaWdodCAyMDE3LCBKb3JnZSBJenF1aWVyZG8gKEFyYWdvbiBGb3VuZGF0aW9uKQ0KICBDb3B5cmlnaHQgMjAxNywgSm9yZGkgQmF5bGluYSAoR2l2ZXRoKQ0KDQogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNCiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCg0KICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCg0KICBCYXNlZCBvbiBTYW1wbGVDYW1wYWlnbi1Ub2tlbkNvbnRyb2xsZXIuc29sIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0dpdmV0aC9taW5pbWUNCiAgT3JpZ2luYWwgY29udHJhY3QgaXMgaHR0cHM6Ly9naXRodWIuY29tL3N0YXR1cy1pbS9zdGF0dXMtbmV0d29yay10b2tlbi9ibG9iL21hc3Rlci9jb250cmFjdHMvU3RhdHVzQ29udHJpYnV0aW9uLnNvbA0KKi8NCg0KbGlicmFyeSBTYWZlTWF0aCB7DQogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDANCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZA0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgcmV0dXJuIGEgLSBiOw0KICB9DQoNCiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSArIGI7DQogICAgYXNzZXJ0KGMgPj0gYSk7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KfQ0KDQpjb250cmFjdCBDb250cm9sbGVkIHsNCiAgLy8vIEBub3RpY2UgVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyb2xsZXIgaXMgdGhlIG9ubHkgYWRkcmVzcyB0aGF0IGNhbiBjYWxsDQogIC8vLyAgYSBmdW5jdGlvbiB3aXRoIHRoaXMgbW9kaWZpZXINCiAgbW9kaWZpZXIgb25seUNvbnRyb2xsZXIgeyBpZiAobXNnLnNlbmRlciAhPSBjb250cm9sbGVyKSB0aHJvdzsgXzsgfQ0KDQogIGFkZHJlc3MgcHVibGljIGNvbnRyb2xsZXI7DQoNCiAgZnVuY3Rpb24gQ29udHJvbGxlZCgpIHsgY29udHJvbGxlciA9IG1zZy5zZW5kZXI7fQ0KDQogIC8vLyBAbm90aWNlIENoYW5nZXMgdGhlIGNvbnRyb2xsZXIgb2YgdGhlIGNvbnRyYWN0DQogIC8vLyBAcGFyYW0gX25ld0NvbnRyb2xsZXIgVGhlIG5ldyBjb250cm9sbGVyIG9mIHRoZSBjb250cmFjdA0KICBmdW5jdGlvbiBjaGFuZ2VDb250cm9sbGVyKGFkZHJlc3MgX25ld0NvbnRyb2xsZXIpIG9ubHlDb250cm9sbGVyIHsNCiAgICBjb250cm9sbGVyID0gX25ld0NvbnRyb2xsZXI7DQogIH0NCn0NCg0KY29udHJhY3QgUmVmdW5kYWJsZSB7DQogIGZ1bmN0aW9uIHJlZnVuZChhZGRyZXNzIHRoLCB1aW50IGFtb3VudCkgcmV0dXJucyAoYm9vbCk7DQp9DQoNCi8vLyBAZGV2IFRoZSB0b2tlbiBjb250cm9sbGVyIGNvbnRyYWN0IG11c3QgaW1wbGVtZW50IHRoZXNlIGZ1bmN0aW9ucw0KY29udHJhY3QgVG9rZW5Db250cm9sbGVyIHsNCiAgLy8vIEBub3RpY2UgQ2FsbGVkIHdoZW4gYF9vd25lcmAgc2VuZHMgZXRoZXIgdG8gdGhlIE1pbmlNZSBUb2tlbiBjb250cmFjdA0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IHNlbnQgdGhlIGV0aGVyIHRvIGNyZWF0ZSB0b2tlbnMNCiAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgZXRoZXIgaXMgYWNjZXB0ZWQsIGZhbHNlIGlmIGl0IHRocm93cw0KICBmdW5jdGlvbiBwcm94eVBheW1lbnQoYWRkcmVzcyBfb3duZXIpIHBheWFibGUgcmV0dXJucyhib29sKTsNCg0KICAvLy8gQG5vdGljZSBOb3RpZmllcyB0aGUgY29udHJvbGxlciBhYm91dCBhIHRva2VuIHRyYW5zZmVyIGFsbG93aW5nIHRoZQ0KICAvLy8gIGNvbnRyb2xsZXIgdG8gcmVhY3QgaWYgZGVzaXJlZA0KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBvcmlnaW4gb2YgdGhlIHRyYW5zZmVyDQogIC8vLyBAcGFyYW0gX3RvIFRoZSBkZXN0aW5hdGlvbiBvZiB0aGUgdHJhbnNmZXINCiAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdGhlIHRyYW5zZmVyDQogIC8vLyBAcmV0dXJuIEZhbHNlIGlmIHRoZSBjb250cm9sbGVyIGRvZXMgbm90IGF1dGhvcml6ZSB0aGUgdHJhbnNmZXINCiAgZnVuY3Rpb24gb25UcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfYW1vdW50KSByZXR1cm5zKGJvb2wpOw0KDQogIC8vLyBAbm90aWNlIE5vdGlmaWVzIHRoZSBjb250cm9sbGVyIGFib3V0IGFuIGFwcHJvdmFsIGFsbG93aW5nIHRoZQ0KICAvLy8gIGNvbnRyb2xsZXIgdG8gcmVhY3QgaWYgZGVzaXJlZA0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IGNhbGxzIGBhcHByb3ZlKClgDQogIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIHNwZW5kZXIgaW4gdGhlIGBhcHByb3ZlKClgIGNhbGwNCiAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgaW4gdGhlIGBhcHByb3ZlKClgIGNhbGwNCiAgLy8vIEByZXR1cm4gRmFsc2UgaWYgdGhlIGNvbnRyb2xsZXIgZG9lcyBub3QgYXV0aG9yaXplIHRoZSBhcHByb3ZhbA0KICBmdW5jdGlvbiBvbkFwcHJvdmUoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2Ftb3VudCkNCiAgICByZXR1cm5zKGJvb2wpOw0KfQ0KDQpjb250cmFjdCBFUkMyMFRva2VuIHsNCiAgLyogVGhpcyBpcyBhIHNsaWdodCBjaGFuZ2UgdG8gdGhlIEVSQzIwIGJhc2Ugc3RhbmRhcmQuDQogICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOw0KICAgICBpcyByZXBsYWNlZCB3aXRoOg0KICAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsNCiAgICAgVGhpcyBhdXRvbWF0aWNhbGx5IGNyZWF0ZXMgYSBnZXR0ZXIgZnVuY3Rpb24gZm9yIHRoZSB0b3RhbFN1cHBseS4NCiAgICAgVGhpcyBpcyBtb3ZlZCB0byB0aGUgYmFzZSBjb250cmFjdCBzaW5jZSBwdWJsaWMgZ2V0dGVyIGZ1bmN0aW9ucyBhcmUgbm90DQogICAgIGN1cnJlbnRseSByZWNvZ25pc2VkIGFzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBtYXRjaGluZyBhYnN0cmFjdA0KICAgICBmdW5jdGlvbiBieSB0aGUgY29tcGlsZXIuDQogICovDQogIC8vLyB0b3RhbCBhbW91bnQgb2YgdG9rZW5zDQogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCg0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCg0KICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgDQogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZA0KICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYA0KICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXINCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkDQogIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX3NwZW5kZXJgIHRvIHNwZW5kIGBfdmFsdWVgIHRva2Vucw0KICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2Vucw0KICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAvLy8gQHJldHVybiBBbW91bnQgb2YgcmVtYWluaW5nIHRva2VucyBhbGxvd2VkIHRvIHNwZW50DQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsNCn0NCg0KY29udHJhY3QgQnVybmFibGUgaXMgQ29udHJvbGxlZCB7DQogIC8vLyBAbm90aWNlIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cm9sbGVyIGlzIHRoZSBvbmx5IGFkZHJlc3MgdGhhdCBjYW4gY2FsbA0KICAvLy8gIGEgZnVuY3Rpb24gd2l0aCB0aGlzIG1vZGlmaWVyLCBhbHNvIHRoZSBidXJuZXIgY2FuIGNhbGwgYnV0IGFsc28gdGhlDQogIC8vLyB0YXJnZXQgb2YgdGhlIGZ1bmN0aW9uIG11c3QgYmUgdGhlIGJ1cm5lcg0KICBtb2RpZmllciBvbmx5Q29udHJvbGxlck9yQnVybmVyKGFkZHJlc3MgdGFyZ2V0KSB7DQogICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gY29udHJvbGxlciB8fCAobXNnLnNlbmRlciA9PSBidXJuZXIgJiYgbXNnLnNlbmRlciA9PSB0YXJnZXQpKTsNCiAgICBfOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seUJ1cm5lciB7DQogICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gYnVybmVyKTsNCiAgICBfOw0KICB9DQogIGFkZHJlc3MgcHVibGljIGJ1cm5lcjsNCg0KICBmdW5jdGlvbiBCdXJuYWJsZSgpIHsgYnVybmVyID0gbXNnLnNlbmRlcjt9DQoNCiAgLy8vIEBub3RpY2UgQ2hhbmdlcyB0aGUgYnVybmVyIG9mIHRoZSBjb250cmFjdA0KICAvLy8gQHBhcmFtIF9uZXdCdXJuZXIgVGhlIG5ldyBidXJuZXIgb2YgdGhlIGNvbnRyYWN0DQogIGZ1bmN0aW9uIGNoYW5nZUJ1cm5lcihhZGRyZXNzIF9uZXdCdXJuZXIpIG9ubHlCdXJuZXIgew0KICAgIGJ1cm5lciA9IF9uZXdCdXJuZXI7DQogIH0NCn0NCg0KY29udHJhY3QgTWluaU1lVG9rZW5JIGlzIEVSQzIwVG9rZW4sIEJ1cm5hYmxlIHsNCg0KICAgICAgc3RyaW5nIHB1YmxpYyBuYW1lOyAgICAgICAgICAgICAgICAvL1RoZSBUb2tlbidzIG5hbWU6IGUuZy4gRGlnaXhEQU8gVG9rZW5zDQogICAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7ICAgICAgICAgICAgIC8vTnVtYmVyIG9mIGRlY2ltYWxzIG9mIHRoZSBzbWFsbGVzdCB1bml0DQogICAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsgICAgICAgICAgICAgIC8vQW4gaWRlbnRpZmllcjogZS5nLiBSRVANCiAgICAgIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICdNTVRfMC4xJzsgLy9BbiBhcmJpdHJhcnkgdmVyc2lvbmluZyBzY2hlbWUNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gRVJDMjAgTWV0aG9kcw0KLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQoNCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzZW5kIGBfYW1vdW50YCB0b2tlbnMgb24NCiAgICAvLy8gIGl0cyBiZWhhbGYsIGFuZCB0aGVuIGEgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGluIHRoZSBjb250cmFjdCB0aGF0IGlzDQogICAgLy8vICBiZWluZyBhcHByb3ZlZCwgYF9zcGVuZGVyYC4gVGhpcyBhbGxvd3MgdXNlcnMgdG8gdXNlIHRoZWlyIHRva2VucyB0bw0KICAgIC8vLyAgaW50ZXJhY3Qgd2l0aCBjb250cmFjdHMgaW4gb25lIGZ1bmN0aW9uIGNhbGwgaW5zdGVhZCBvZiB0d28NCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyDQogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgZnVuY3Rpb24gY2FsbCB3YXMgc3VjY2Vzc2Z1bA0KICAgIGZ1bmN0aW9uIGFwcHJvdmVBbmRDYWxsKA0KICAgICAgICBhZGRyZXNzIF9zcGVuZGVyLA0KICAgICAgICB1aW50MjU2IF9hbW91bnQsDQogICAgICAgIGJ5dGVzIF9leHRyYURhdGENCiAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIFF1ZXJ5IGJhbGFuY2UgYW5kIHRvdGFsU3VwcGx5IGluIEhpc3RvcnkNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAZGV2IFF1ZXJpZXMgdGhlIGJhbGFuY2Ugb2YgYF9vd25lcmAgYXQgYSBzcGVjaWZpYyBgX2Jsb2NrTnVtYmVyYA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIGZyb20gd2hpY2ggdGhlIGJhbGFuY2Ugd2lsbCBiZSByZXRyaWV2ZWQNCiAgICAvLy8gQHBhcmFtIF9ibG9ja051bWJlciBUaGUgYmxvY2sgbnVtYmVyIHdoZW4gdGhlIGJhbGFuY2UgaXMgcXVlcmllZA0KICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlIGF0IGBfYmxvY2tOdW1iZXJgDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mQXQoDQogICAgICAgIGFkZHJlc3MgX293bmVyLA0KICAgICAgICB1aW50IF9ibG9ja051bWJlcg0KICAgICkgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQG5vdGljZSBUb3RhbCBhbW91bnQgb2YgdG9rZW5zIGF0IGEgc3BlY2lmaWMgYF9ibG9ja051bWJlcmAuDQogICAgLy8vIEBwYXJhbSBfYmxvY2tOdW1iZXIgVGhlIGJsb2NrIG51bWJlciB3aGVuIHRoZSB0b3RhbFN1cHBseSBpcyBxdWVyaWVkDQogICAgLy8vIEByZXR1cm4gVGhlIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMgYXQgYF9ibG9ja051bWJlcmANCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseUF0KHVpbnQgX2Jsb2NrTnVtYmVyKSBjb25zdGFudCByZXR1cm5zKHVpbnQpOw0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBDbG9uZSBUb2tlbiBNZXRob2QNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIENyZWF0ZXMgYSBuZXcgY2xvbmUgdG9rZW4gd2l0aCB0aGUgaW5pdGlhbCBkaXN0cmlidXRpb24gYmVpbmcNCiAgICAvLy8gIHRoaXMgdG9rZW4gYXQgYF9zbmFwc2hvdEJsb2NrYA0KICAgIC8vLyBAcGFyYW0gX2Nsb25lVG9rZW5OYW1lIE5hbWUgb2YgdGhlIGNsb25lIHRva2VuDQogICAgLy8vIEBwYXJhbSBfY2xvbmVEZWNpbWFsVW5pdHMgTnVtYmVyIG9mIGRlY2ltYWxzIG9mIHRoZSBzbWFsbGVzdCB1bml0DQogICAgLy8vIEBwYXJhbSBfY2xvbmVUb2tlblN5bWJvbCBTeW1ib2wgb2YgdGhlIGNsb25lIHRva2VuDQogICAgLy8vIEBwYXJhbSBfc25hcHNob3RCbG9jayBCbG9jayB3aGVuIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIHBhcmVudCB0b2tlbiBpcw0KICAgIC8vLyAgY29waWVkIHRvIHNldCB0aGUgaW5pdGlhbCBkaXN0cmlidXRpb24gb2YgdGhlIG5ldyBjbG9uZSB0b2tlbjsNCiAgICAvLy8gIGlmIHRoZSBibG9jayBpcyB6ZXJvIHRoYW4gdGhlIGFjdHVhbCBibG9jaywgdGhlIGN1cnJlbnQgYmxvY2sgaXMgdXNlZA0KICAgIC8vLyBAcGFyYW0gX3RyYW5zZmVyc0VuYWJsZWQgVHJ1ZSBpZiB0cmFuc2ZlcnMgYXJlIGFsbG93ZWQgaW4gdGhlIGNsb25lDQogICAgLy8vIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBNaW5pTWVUb2tlbiBDb250cmFjdA0KICAgIGZ1bmN0aW9uIGNyZWF0ZUNsb25lVG9rZW4oDQogICAgICAgIHN0cmluZyBfY2xvbmVUb2tlbk5hbWUsDQogICAgICAgIHVpbnQ4IF9jbG9uZURlY2ltYWxVbml0cywNCiAgICAgICAgc3RyaW5nIF9jbG9uZVRva2VuU3ltYm9sLA0KICAgICAgICB1aW50IF9zbmFwc2hvdEJsb2NrLA0KICAgICAgICBib29sIF90cmFuc2ZlcnNFbmFibGVkDQogICAgKSByZXR1cm5zKGFkZHJlc3MpOw0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBHZW5lcmF0ZSBhbmQgZGVzdHJveSB0b2tlbnMNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIEdlbmVyYXRlcyBgX2Ftb3VudGAgdG9rZW5zIHRoYXQgYXJlIGFzc2lnbmVkIHRvIGBfb3duZXJgDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCB3aWxsIGJlIGFzc2lnbmVkIHRoZSBuZXcgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBxdWFudGl0eSBvZiB0b2tlbnMgZ2VuZXJhdGVkDQogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgdG9rZW5zIGFyZSBnZW5lcmF0ZWQgY29ycmVjdGx5DQogICAgZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbnMoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCk7DQoNCg0KICAgIC8vLyBAbm90aWNlIEJ1cm5zIGBfYW1vdW50YCB0b2tlbnMgZnJvbSBgX293bmVyYA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBsb3NlIHRoZSB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIHF1YW50aXR5IG9mIHRva2VucyB0byBidXJuDQogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0aGUgdG9rZW5zIGFyZSBidXJuZWQgY29ycmVjdGx5DQogICAgZnVuY3Rpb24gZGVzdHJveVRva2VucyhhZGRyZXNzIF9vd25lciwgdWludCBfYW1vdW50KSByZXR1cm5zIChib29sKTsNCg0KLy8vLy8vLy8vLy8vLy8vLw0KLy8gRW5hYmxlIHRva2VucyB0cmFuc2ZlcnMNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIEVuYWJsZXMgdG9rZW4gaG9sZGVycyB0byB0cmFuc2ZlciB0aGVpciB0b2tlbnMgZnJlZWx5IGlmIHRydWUNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcnNFbmFibGVkIFRydWUgaWYgdHJhbnNmZXJzIGFyZSBhbGxvd2VkIGluIHRoZSBjbG9uZQ0KICAgIGZ1bmN0aW9uIGVuYWJsZVRyYW5zZmVycyhib29sIF90cmFuc2ZlcnNFbmFibGVkKTsNCg0KLy8vLy8vLy8vLw0KLy8gU2FmZXR5IE1ldGhvZHMNCi8vLy8vLy8vLy8NCg0KICAgIC8vLyBAbm90aWNlIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGJ5IHRoZSBjb250cm9sbGVyIHRvIGV4dHJhY3QgbWlzdGFrZW5seQ0KICAgIC8vLyAgc2VudCB0b2tlbnMgdG8gdGhpcyBjb250cmFjdC4NCiAgICAvLy8gQHBhcmFtIF90b2tlbiBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QgdGhhdCB5b3Ugd2FudCB0byByZWNvdmVyDQogICAgLy8vICBzZXQgdG8gMCBpbiBjYXNlIHlvdSB3YW50IHRvIGV4dHJhY3QgZXRoZXIuDQogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pOw0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBFdmVudHMNCi8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIGV2ZW50IENsYWltZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9jb250cm9sbGVyLCB1aW50IF9hbW91bnQpOw0KICAgIGV2ZW50IE5ld0Nsb25lVG9rZW4oYWRkcmVzcyBpbmRleGVkIF9jbG9uZVRva2VuLCB1aW50IF9zbmFwc2hvdEJsb2NrKTsNCn0NCg0KY29udHJhY3QgRmluYWxpemFibGUgew0KICB1aW50MjU2IHB1YmxpYyBmaW5hbGl6ZWRCbG9jazsNCiAgYm9vbCBwdWJsaWMgZ29hbE1ldDsNCg0KICBmdW5jdGlvbiBmaW5hbGl6ZSgpOw0KfQ0KDQpjb250cmFjdCBDb250cmlidXRpb24gaXMgQ29udHJvbGxlZCwgVG9rZW5Db250cm9sbGVyLCBGaW5hbGl6YWJsZSB7DQogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2Ow0KDQogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Q2FwOyAvLyBUb3RhbCBNU1Agc3VwcGx5IHRvIGJlIGdlbmVyYXRlZA0KICB1aW50MjU2IHB1YmxpYyBleGNoYW5nZVJhdGU7IC8vIEVUSC1NU1AgZXhjaGFuZ2UgcmF0ZQ0KICB1aW50MjU2IHB1YmxpYyB0b3RhbFNvbGQ7IC8vIEhvdyBtdWNoIHRva2VucyBzb2xkDQogIHVpbnQyNTYgcHVibGljIHRvdGFsU2FsZVN1cHBseUNhcDsgLy8gVG9rZW4gc2FsZSBjYXANCg0KICBNaW5pTWVUb2tlbkkgcHVibGljIHNpdDsNCiAgTWluaU1lVG9rZW5JIHB1YmxpYyBtc3A7DQoNCiAgdWludDI1NiBwdWJsaWMgc3RhcnRCbG9jazsNCiAgdWludDI1NiBwdWJsaWMgZW5kQmxvY2s7DQoNCiAgYWRkcmVzcyBwdWJsaWMgZGVzdEV0aERldnM7DQogIGFkZHJlc3MgcHVibGljIGRlc3RUb2tlbnNTaXQ7DQogIGFkZHJlc3MgcHVibGljIGRlc3RUb2tlbnNUZWFtOw0KICBhZGRyZXNzIHB1YmxpYyBkZXN0VG9rZW5zUmVmZXJhbHM7DQoNCiAgYWRkcmVzcyBwdWJsaWMgbXNwQ29udHJvbGxlcjsNCg0KICB1aW50MjU2IHB1YmxpYyBpbml0aWFsaXplZEJsb2NrOw0KICB1aW50MjU2IHB1YmxpYyBmaW5hbGl6ZWRUaW1lOw0KDQogIHVpbnQyNTYgcHVibGljIG1pbmltdW1faW52ZXN0bWVudDsNCiAgdWludDI1NiBwdWJsaWMgbWluaW11bV9nb2FsOw0KDQogIGJvb2wgcHVibGljIHBhdXNlZDsNCg0KICBtb2RpZmllciBpbml0aWFsaXplZCgpIHsNCiAgICBhc3NlcnQoYWRkcmVzcyhtc3ApICE9IDB4MCk7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIGNvbnRyaWJ1dGlvbk9wZW4oKSB7DQogICAgYXNzZXJ0KGdldEJsb2NrTnVtYmVyKCkgPj0gc3RhcnRCbG9jayAmJg0KICAgICAgICAgICAgZ2V0QmxvY2tOdW1iZXIoKSA8PSBlbmRCbG9jayAmJg0KICAgICAgICAgICAgZmluYWxpemVkQmxvY2sgPT0gMCAmJg0KICAgICAgICAgICAgYWRkcmVzcyhtc3ApICE9IDB4MCk7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG5vdFBhdXNlZCgpIHsNCiAgICByZXF1aXJlKCFwYXVzZWQpOw0KICAgIF87DQogIH0NCg0KICBmdW5jdGlvbiBDb250cmlidXRpb24oKSB7DQogICAgLy8gQm9vbGVhbnMgYXJlIGZhbHNlIGJ5IGRlZmF1bHQgY29uc2lkZXIgcmVtb3ZpbmcgdGhpcw0KICAgIHBhdXNlZCA9IGZhbHNlOw0KICB9DQoNCiAgLy8vIEBub3RpY2UgVGhpcyBtZXRob2Qgc2hvdWxkIGJlIGNhbGxlZCBieSB0aGUgY29udHJvbGxlciBiZWZvcmUgdGhlIGNvbnRyaWJ1dGlvbg0KICAvLy8gIHBlcmlvZCBzdGFydHMgVGhpcyBpbml0aWFsaXplcyBtb3N0IG9mIHRoZSBwYXJhbWV0ZXJzDQogIC8vLyBAcGFyYW0gX21zcCBBZGRyZXNzIG9mIHRoZSBNU1AgdG9rZW4gY29udHJhY3QNCiAgLy8vIEBwYXJhbSBfbXNwQ29udHJvbGxlciBUb2tlbiBjb250cm9sbGVyIGZvciB0aGUgTVNQIHRoYXQgd2lsbCBiZSB0cmFuc2ZlcnJlZCBhZnRlcg0KICAvLy8gIHRoZSBjb250cmlidXRpb24gZmluYWxpemVzLg0KICAvLy8gQHBhcmFtIF90b3RhbFN1cHBseUNhcCBNYXhpbXVtIGFtb3VudCBvZiB0b2tlbnMgdG8gZ2VuZXJhdGUgZHVyaW5nIHRoZSBjb250cmlidXRpb24NCiAgLy8vIEBwYXJhbSBfZXhjaGFuZ2VSYXRlIEVUSCB0byBNU1AgcmF0ZSBmb3IgdGhlIHRva2VuIHNhbGUNCiAgLy8vIEBwYXJhbSBfc3RhcnRCbG9jayBCbG9jayB3aGVuIHRoZSBjb250cmlidXRpb24gcGVyaW9kIHN0YXJ0cw0KICAvLy8gQHBhcmFtIF9lbmRCbG9jayBUaGUgbGFzdCBibG9jayB0aGF0IHRoZSBjb250cmlidXRpb24gcGVyaW9kIGlzIGFjdGl2ZQ0KICAvLy8gQHBhcmFtIF9kZXN0RXRoRGV2cyBEZXN0aW5hdGlvbiBhZGRyZXNzIHdoZXJlIHRoZSBjb250cmlidXRpb24gZXRoZXIgaXMgc2VudA0KICAvLy8gQHBhcmFtIF9kZXN0VG9rZW5zU2l0IEFkZHJlc3Mgb2YgdGhlIGV4Y2hhbmdlciBTSVQtTVNQIHdoZXJlIHRoZSBNU1AgYXJlIHNlbnQNCiAgLy8vICB0byBiZSBkaXN0cmlidXRlZCB0byB0aGUgU0lUIGhvbGRlcnMuDQogIC8vLyBAcGFyYW0gX2Rlc3RUb2tlbnNUZWFtIEFkZHJlc3Mgd2hlcmUgdGhlIHRva2VucyBmb3IgdGhlIHRlYW0gYXJlIHNlbnQNCiAgLy8vIEBwYXJhbSBfZGVzdFRva2Vuc1JlZmVyYWxzIEFkZHJlc3Mgd2hlcmUgdGhlIHRva2VucyBmb3IgdGhlIHJlZmVyYWwgc3lzdGVtIGFyZSBzZW50DQogIC8vLyBAcGFyYW0gX3NpdCBBZGRyZXNzIG9mIHRoZSBTSVQgdG9rZW4gY29udHJhY3QNCiAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgNCiAgICAgIGFkZHJlc3MgX21zcCwNCiAgICAgIGFkZHJlc3MgX21zcENvbnRyb2xsZXIsDQoNCiAgICAgIHVpbnQyNTYgX3RvdGFsU3VwcGx5Q2FwLA0KICAgICAgdWludDI1NiBfZXhjaGFuZ2VSYXRlLA0KICAgICAgdWludDI1NiBfbWluaW11bV9nb2FsLA0KDQogICAgICB1aW50MjU2IF9zdGFydEJsb2NrLA0KICAgICAgdWludDI1NiBfZW5kQmxvY2ssDQoNCiAgICAgIGFkZHJlc3MgX2Rlc3RFdGhEZXZzLA0KICAgICAgYWRkcmVzcyBfZGVzdFRva2Vuc1NpdCwNCiAgICAgIGFkZHJlc3MgX2Rlc3RUb2tlbnNUZWFtLA0KICAgICAgYWRkcmVzcyBfZGVzdFRva2Vuc1JlZmVyYWxzLA0KDQogICAgICBhZGRyZXNzIF9zaXQNCiAgKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgew0KICAgIC8vIEluaXRpYWxpemUgb25seSBvbmNlDQogICAgYXNzZXJ0KGFkZHJlc3MobXNwKSA9PSAweDApOw0KDQogICAgbXNwID0gTWluaU1lVG9rZW5JKF9tc3ApOw0KICAgIGFzc2VydChtc3AudG90YWxTdXBwbHkoKSA9PSAwKTsNCiAgICBhc3NlcnQobXNwLmNvbnRyb2xsZXIoKSA9PSBhZGRyZXNzKHRoaXMpKTsNCiAgICBhc3NlcnQobXNwLmRlY2ltYWxzKCkgPT0gMTgpOyAgLy8gU2FtZSBhbW91bnQgb2YgZGVjaW1hbHMgYXMgRVRIDQoNCiAgICByZXF1aXJlKF9tc3BDb250cm9sbGVyICE9IDB4MCk7DQogICAgbXNwQ29udHJvbGxlciA9IF9tc3BDb250cm9sbGVyOw0KDQogICAgcmVxdWlyZShfZXhjaGFuZ2VSYXRlID4gMCk7DQogICAgZXhjaGFuZ2VSYXRlID0gX2V4Y2hhbmdlUmF0ZTsNCg0KICAgIGFzc2VydChfc3RhcnRCbG9jayA+PSBnZXRCbG9ja051bWJlcigpKTsNCiAgICByZXF1aXJlKF9zdGFydEJsb2NrIDwgX2VuZEJsb2NrKTsNCiAgICBzdGFydEJsb2NrID0gX3N0YXJ0QmxvY2s7DQogICAgZW5kQmxvY2sgPSBfZW5kQmxvY2s7DQoNCiAgICByZXF1aXJlKF9kZXN0RXRoRGV2cyAhPSAweDApOw0KICAgIGRlc3RFdGhEZXZzID0gX2Rlc3RFdGhEZXZzOw0KDQogICAgcmVxdWlyZShfZGVzdFRva2Vuc1NpdCAhPSAweDApOw0KICAgIGRlc3RUb2tlbnNTaXQgPSBfZGVzdFRva2Vuc1NpdDsNCg0KICAgIHJlcXVpcmUoX2Rlc3RUb2tlbnNUZWFtICE9IDB4MCk7DQogICAgZGVzdFRva2Vuc1RlYW0gPSBfZGVzdFRva2Vuc1RlYW07DQoNCiAgICByZXF1aXJlKF9kZXN0VG9rZW5zUmVmZXJhbHMgIT0gMHgwKTsNCiAgICBkZXN0VG9rZW5zUmVmZXJhbHMgPSBfZGVzdFRva2Vuc1JlZmVyYWxzOw0KDQogICAgcmVxdWlyZShfc2l0ICE9IDB4MCk7DQogICAgc2l0ID0gTWluaU1lVG9rZW5JKF9zaXQpOw0KDQogICAgaW5pdGlhbGl6ZWRCbG9jayA9IGdldEJsb2NrTnVtYmVyKCk7DQogICAgLy8gU0lUIGFtb3VudCBzaG91bGQgYmUgbm8gbW9yZSB0aGFuIDIwJSBvZiBNU1AgdG90YWwgc3VwcGx5IGNhcA0KICAgIGFzc2VydChzaXQudG90YWxTdXBwbHlBdChpbml0aWFsaXplZEJsb2NrKSAqIDUgPD0gX3RvdGFsU3VwcGx5Q2FwKTsNCiAgICB0b3RhbFN1cHBseUNhcCA9IF90b3RhbFN1cHBseUNhcDsNCg0KICAgIC8vIFdlIGFyZSBnb2luZyB0byBzYWxlIDcwJSBvZiB0b3RhbCBzdXBwbHkgY2FwDQogICAgdG90YWxTYWxlU3VwcGx5Q2FwID0gcGVyY2VudCg3MCkubXVsKF90b3RhbFN1cHBseUNhcCkuZGl2KHBlcmNlbnQoMTAwKSk7DQoNCiAgICBtaW5pbXVtX2dvYWwgPSBfbWluaW11bV9nb2FsOw0KICB9DQoNCiAgZnVuY3Rpb24gc2V0TWluaW11bUludmVzdG1lbnQoDQogICAgICB1aW50IF9taW5pbXVtX2ludmVzdG1lbnQNCiAgKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgew0KICAgIG1pbmltdW1faW52ZXN0bWVudCA9IF9taW5pbXVtX2ludmVzdG1lbnQ7DQogIH0NCg0KICBmdW5jdGlvbiBzZXRFeGNoYW5nZVJhdGUoDQogICAgICB1aW50IF9leGNoYW5nZVJhdGUNCiAgKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgew0KICAgIGFzc2VydChnZXRCbG9ja051bWJlcigpIDwgc3RhcnRCbG9jayk7DQogICAgZXhjaGFuZ2VSYXRlID0gX2V4Y2hhbmdlUmF0ZTsNCiAgfQ0KDQogIC8vLyBAbm90aWNlIElmIGFueWJvZHkgc2VuZHMgRXRoZXIgZGlyZWN0bHkgdG8gdGhpcyBjb250cmFjdCwgY29uc2lkZXIgaGUgaXMNCiAgLy8vICBnZXR0aW5nIE1TUHMuDQogIGZ1bmN0aW9uICgpIHB1YmxpYyBwYXlhYmxlIG5vdFBhdXNlZCB7DQogICAgcHJveHlQYXltZW50KG1zZy5zZW5kZXIpOw0KICB9DQoNCg0KICAvLy8vLy8vLy8vDQogIC8vIFRva2VuQ29udHJvbGxlciBmdW5jdGlvbnMNCiAgLy8vLy8vLy8vLw0KDQogIC8vLyBAbm90aWNlIFRoaXMgbWV0aG9kIHdpbGwgZ2VuZXJhbGx5IGJlIGNhbGxlZCBieSB0aGUgTVNQIHRva2VuIGNvbnRyYWN0IHRvDQogIC8vLyAgYWNxdWlyZSBNU1BzLiBPciBkaXJlY3RseSBmcm9tIHRoaXJkIHBhcnRpZXMgdGhhdCB3YW50IHRvIGFjcXVpcmUgTVNQcyBpbg0KICAvLy8gIGJlaGFsZiBvZiBhIHRva2VuIGhvbGRlci4NCiAgLy8vIEBwYXJhbSBfdGggTVNQIGhvbGRlciB3aGVyZSB0aGUgTVNQcyB3aWxsIGJlIG1pbnRlZC4NCiAgZnVuY3Rpb24gcHJveHlQYXltZW50KGFkZHJlc3MgX3RoKSBwdWJsaWMgcGF5YWJsZSBub3RQYXVzZWQgaW5pdGlhbGl6ZWQgY29udHJpYnV0aW9uT3BlbiByZXR1cm5zIChib29sKSB7DQogICAgcmVxdWlyZShfdGggIT0gMHgwKTsNCiAgICBkb0J1eShfdGgpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gb25UcmFuc2ZlcihhZGRyZXNzLCBhZGRyZXNzLCB1aW50MjU2KSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG9uQXBwcm92ZShhZGRyZXNzLCBhZGRyZXNzLCB1aW50MjU2KSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGRvQnV5KGFkZHJlc3MgX3RoKSBpbnRlcm5hbCB7DQogICAgcmVxdWlyZShtc2cudmFsdWUgPj0gbWluaW11bV9pbnZlc3RtZW50KTsNCg0KICAgIC8vIEFudGlzcGFtIG1lY2hhbmlzbQ0KICAgIGFkZHJlc3MgY2FsbGVyOw0KICAgIGlmIChtc2cuc2VuZGVyID09IGFkZHJlc3MobXNwKSkgew0KICAgICAgY2FsbGVyID0gX3RoOw0KICAgIH0gZWxzZSB7DQogICAgICBjYWxsZXIgPSBtc2cuc2VuZGVyOw0KICAgIH0NCg0KICAgIC8vIERvIG5vdCBhbGxvdyBjb250cmFjdHMgdG8gZ2FtZSB0aGUgc3lzdGVtDQogICAgYXNzZXJ0KCFpc0NvbnRyYWN0KGNhbGxlcikpOw0KDQogICAgdWludDI1NiB0b0Z1bmQgPSBtc2cudmFsdWU7DQogICAgdWludDI1NiBsZWZ0Rm9yU2FsZSA9IHRva2Vuc0ZvclNhbGUoKTsNCiAgICBpZiAodG9GdW5kID4gMCkgew0KICAgICAgaWYgKGxlZnRGb3JTYWxlID4gMCkgew0KICAgICAgICB1aW50MjU2IHRva2Vuc0dlbmVyYXRlZCA9IHRvRnVuZC5tdWwoZXhjaGFuZ2VSYXRlKTsNCg0KICAgICAgICAvLyBDaGVjayB0b3RhbCBzdXBwbHkgY2FwIHJlYWNoZWQsIHNlbGwgdGhlIGFsbCByZW1haW5pbmcgdG9rZW5zDQogICAgICAgIGlmICh0b2tlbnNHZW5lcmF0ZWQgPiBsZWZ0Rm9yU2FsZSkgew0KICAgICAgICAgIHRva2Vuc0dlbmVyYXRlZCA9IGxlZnRGb3JTYWxlOw0KICAgICAgICAgIHRvRnVuZCA9IGxlZnRGb3JTYWxlLmRpdihleGNoYW5nZVJhdGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgYXNzZXJ0KG1zcC5nZW5lcmF0ZVRva2VucyhfdGgsIHRva2Vuc0dlbmVyYXRlZCkpOw0KICAgICAgICB0b3RhbFNvbGQgPSB0b3RhbFNvbGQuYWRkKHRva2Vuc0dlbmVyYXRlZCk7DQogICAgICAgIGlmICh0b3RhbFNvbGQgPj0gbWluaW11bV9nb2FsKSB7DQogICAgICAgICAgZ29hbE1ldCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAgZGVzdEV0aERldnMudHJhbnNmZXIodG9GdW5kKTsNCiAgICAgICAgTmV3U2FsZShfdGgsIHRvRnVuZCwgdG9rZW5zR2VuZXJhdGVkKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRvRnVuZCA9IDA7DQogICAgICB9DQogICAgfQ0KDQogICAgdWludDI1NiB0b1JldHVybiA9IG1zZy52YWx1ZS5zdWIodG9GdW5kKTsNCiAgICBpZiAodG9SZXR1cm4gPiAwKSB7DQogICAgICAvLyBJZiB0aGUgY2FsbCBjb21lcyBmcm9tIHRoZSBUb2tlbiBjb250cm9sbGVyLA0KICAgICAgLy8gdGhlbiB3ZSByZXR1cm4gaXQgdG8gdGhlIHRva2VuIEhvbGRlci4NCiAgICAgIC8vIE90aGVyd2lzZSB3ZSByZXR1cm4gdG8gdGhlIHNlbmRlci4NCiAgICAgIGlmIChtc2cuc2VuZGVyID09IGFkZHJlc3MobXNwKSkgew0KICAgICAgICBfdGgudHJhbnNmZXIodG9SZXR1cm4pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcih0b1JldHVybik7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGFuIGFkZHJlc3MgaXMgYSBjb250cmFjdA0KICAvLy8gQHBhcmFtIF9hZGRyIFRoZSBhZGRyZXNzIGJlaW5nIHF1ZXJpZWQNCiAgLy8vIEByZXR1cm4gVHJ1ZSBpZiBgX2FkZHJgIGlzIGEgY29udHJhY3QNCiAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7DQogICAgaWYgKF9hZGRyID09IDApIHJldHVybiBmYWxzZTsNCiAgICB1aW50MjU2IHNpemU7DQogICAgYXNzZW1ibHkgew0KICAgICAgc2l6ZSA6PSBleHRjb2Rlc2l6ZShfYWRkcikNCiAgICB9DQogICAgcmV0dXJuIChzaXplID4gMCk7DQogIH0NCg0KICBmdW5jdGlvbiByZWZ1bmQoKSBwdWJsaWMgew0KICAgIHJlcXVpcmUoZmluYWxpemVkQmxvY2sgIT0gMCk7DQogICAgcmVxdWlyZSghZ29hbE1ldCk7DQoNCiAgICB1aW50MjU2IGFtb3VudFRva2VucyA9IG1zcC5iYWxhbmNlT2YobXNnLnNlbmRlcik7DQogICAgcmVxdWlyZShhbW91bnRUb2tlbnMgPiAwKTsNCiAgICB1aW50MjU2IGFtb3VudEV0aGVyID0gYW1vdW50VG9rZW5zLmRpdihleGNoYW5nZVJhdGUpOw0KICAgIGFkZHJlc3MgdGggPSBtc2cuc2VuZGVyOw0KDQogICAgUmVmdW5kYWJsZShtc3BDb250cm9sbGVyKS5yZWZ1bmQodGgsIGFtb3VudFRva2Vucyk7DQogICAgUmVmdW5kYWJsZShkZXN0RXRoRGV2cykucmVmdW5kKHRoLCBhbW91bnRFdGhlcik7DQoNCiAgICBSZWZ1bmQodGgsIGFtb3VudFRva2VucywgYW1vdW50RXRoZXIpOw0KICB9DQoNCiAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgX3Rva2VuX2hvbGRlciwgdWludDI1NiBfYW1vdW50X3Rva2VucywgdWludDI1NiBfYW1vdW50X2V0aGVyKTsNCg0KICAvLy8gQG5vdGljZSBUaGlzIG1ldGhvZCB3aWxsIGNhbiBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyb2xsZXIgYmVmb3JlIHRoZSBjb250cmlidXRpb24gcGVyaW9kDQogIC8vLyAgZW5kIG9yIGJ5IGFueWJvZHkgYWZ0ZXIgdGhlIGBlbmRCbG9ja2AuIFRoaXMgbWV0aG9kIGZpbmFsaXplcyB0aGUgY29udHJpYnV0aW9uIHBlcmlvZA0KICAvLy8gIGJ5IGNyZWF0aW5nIHRoZSByZW1haW5pbmcgdG9rZW5zIGFuZCB0cmFuc2ZlcnJpbmcgdGhlIGNvbnRyb2xsZXIgdG8gdGhlIGNvbmZpZ3VyZWQNCiAgLy8vICBjb250cm9sbGVyLg0KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIHB1YmxpYyBpbml0aWFsaXplZCB7DQogICAgYXNzZXJ0KGdldEJsb2NrTnVtYmVyKCkgPj0gc3RhcnRCbG9jayk7DQogICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gY29udHJvbGxlciB8fCBnZXRCbG9ja051bWJlcigpID4gZW5kQmxvY2sgfHwgdG9rZW5zRm9yU2FsZSgpID09IDApOw0KICAgIHJlcXVpcmUoZmluYWxpemVkQmxvY2sgPT0gMCk7DQoNCiAgICBmaW5hbGl6ZWRCbG9jayA9IGdldEJsb2NrTnVtYmVyKCk7DQogICAgZmluYWxpemVkVGltZSA9IG5vdzsNCg0KICAgIGlmIChnb2FsTWV0KSB7DQogICAgICAvLyBHZW5lcmF0ZSA1JSBmb3IgdGhlIHRlYW0NCiAgICAgIGFzc2VydChtc3AuZ2VuZXJhdGVUb2tlbnMoDQogICAgICAgIGRlc3RUb2tlbnNUZWFtLA0KICAgICAgICBwZXJjZW50KDUpLm11bCh0b3RhbFN1cHBseUNhcCkuZGl2KHBlcmNlbnQoMTAwKSkpKTsNCg0KICAgICAgLy8gR2VuZXJhdGUgNSUgZm9yIHRoZSByZWZlcmFsIGJvbnVzZXMNCiAgICAgIGFzc2VydChtc3AuZ2VuZXJhdGVUb2tlbnMoDQogICAgICAgIGRlc3RUb2tlbnNSZWZlcmFscywNCiAgICAgICAgcGVyY2VudCg1KS5tdWwodG90YWxTdXBwbHlDYXApLmRpdihwZXJjZW50KDEwMCkpKSk7DQoNCiAgICAgIC8vIEdlbmVyYXRlIHRva2VucyBmb3IgU0lUIGV4Y2hhbmdlcg0KICAgICAgYXNzZXJ0KG1zcC5nZW5lcmF0ZVRva2VucygNCiAgICAgICAgZGVzdFRva2Vuc1NpdCwNCiAgICAgICAgc2l0LnRvdGFsU3VwcGx5QXQoaW5pdGlhbGl6ZWRCbG9jaykpKTsNCiAgICB9DQoNCiAgICBtc3AuY2hhbmdlQ29udHJvbGxlcihtc3BDb250cm9sbGVyKTsNCiAgICBGaW5hbGl6ZWQoKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHBlcmNlbnQodWludDI1NiBwKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIHAubXVsKDEwKioxNik7DQogIH0NCg0KDQogIC8vLy8vLy8vLy8NCiAgLy8gQ29uc3RhbnQgZnVuY3Rpb25zDQogIC8vLy8vLy8vLy8NCg0KICAvLy8gQHJldHVybiBUb3RhbCB0b2tlbnMgaXNzdWVkIGluIHdlaXMuDQogIGZ1bmN0aW9uIHRva2Vuc0lzc3VlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIG1zcC50b3RhbFN1cHBseSgpOw0KICB9DQoNCiAgLy8vIEByZXR1cm4gVG90YWwgdG9rZW5zIGF2YWlsYWxlIGZvciB0aGUgc2FsZSBpbiB3ZWlzLg0KICBmdW5jdGlvbiB0b2tlbnNGb3JTYWxlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnModWludDI1Nikgew0KICAgIHJldHVybiB0b3RhbFNhbGVTdXBwbHlDYXAgPiB0b3RhbFNvbGQgPyB0b3RhbFNhbGVTdXBwbHlDYXAgLSB0b3RhbFNvbGQgOiAwOw0KICB9DQoNCg0KICAvLy8vLy8vLy8vDQogIC8vIFRlc3Rpbmcgc3BlY2lmaWMgbWV0aG9kcw0KICAvLy8vLy8vLy8vDQoNCiAgLy8vIEBub3RpY2UgVGhpcyBmdW5jdGlvbiBpcyBvdmVycmlkZGVuIGJ5IHRoZSB0ZXN0IE1vY2tzLg0KICBmdW5jdGlvbiBnZXRCbG9ja051bWJlcigpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYmxvY2subnVtYmVyOw0KICB9DQoNCg0KICAvLy8vLy8vLy8vDQogIC8vIFNhZmV0eSBNZXRob2RzDQogIC8vLy8vLy8vLy8NCg0KICAvLy8gQG5vdGljZSBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBieSB0aGUgY29udHJvbGxlciB0byBleHRyYWN0IG1pc3Rha2VubHkNCiAgLy8vICBzZW50IHRva2VucyB0byB0aGlzIGNvbnRyYWN0Lg0KICAvLy8gQHBhcmFtIF90b2tlbiBUaGUgYWRkcmVzcyBvZiB0aGUgdG9rZW4gY29udHJhY3QgdGhhdCB5b3Ugd2FudCB0byByZWNvdmVyDQogIC8vLyAgc2V0IHRvIDAgaW4gY2FzZSB5b3Ugd2FudCB0byBleHRyYWN0IGV0aGVyLg0KICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIF90b2tlbikgcHVibGljIG9ubHlDb250cm9sbGVyIHsNCiAgICBpZiAobXNwLmNvbnRyb2xsZXIoKSA9PSBhZGRyZXNzKHRoaXMpKSB7DQogICAgICBtc3AuY2xhaW1Ub2tlbnMoX3Rva2VuKTsNCiAgICB9DQogICAgaWYgKF90b2tlbiA9PSAweDApIHsNCiAgICAgIGNvbnRyb2xsZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsNCiAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBFUkMyMFRva2VuIHRva2VuID0gRVJDMjBUb2tlbihfdG9rZW4pOw0KICAgIHVpbnQyNTYgYmFsYW5jZSA9IHRva2VuLmJhbGFuY2VPZih0aGlzKTsNCiAgICB0b2tlbi50cmFuc2Zlcihjb250cm9sbGVyLCBiYWxhbmNlKTsNCiAgICBDbGFpbWVkVG9rZW5zKF90b2tlbiwgY29udHJvbGxlciwgYmFsYW5jZSk7DQogIH0NCg0KDQogIC8vLyBAbm90aWNlIFBhdXNlcyB0aGUgY29udHJpYnV0aW9uIGlmIHRoZXJlIGlzIGFueSBpc3N1ZQ0KICBmdW5jdGlvbiBwYXVzZUNvbnRyaWJ1dGlvbigpIG9ubHlDb250cm9sbGVyIHsNCiAgICBwYXVzZWQgPSB0cnVlOw0KICB9DQoNCiAgLy8vIEBub3RpY2UgUmVzdW1lcyB0aGUgY29udHJpYnV0aW9uDQogIGZ1bmN0aW9uIHJlc3VtZUNvbnRyaWJ1dGlvbigpIG9ubHlDb250cm9sbGVyIHsNCiAgICBwYXVzZWQgPSBmYWxzZTsNCiAgfQ0KDQogIGV2ZW50IENsYWltZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9jb250cm9sbGVyLCB1aW50MjU2IF9hbW91bnQpOw0KICBldmVudCBOZXdTYWxlKGFkZHJlc3MgaW5kZXhlZCBfdGgsIHVpbnQyNTYgX2Ftb3VudCwgdWludDI1NiBfdG9rZW5zKTsNCiAgZXZlbnQgRmluYWxpemVkKCk7DQp9'