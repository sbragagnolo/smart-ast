base 64 content
base64contribution3
	^'Y29udHJhY3QgU3RhbmRhcmRUb2tlblByb3RvY29sIHsNCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFN1cHBseSkge30NCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkge30NCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3JlY2lwaWVudCwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30NCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHt9DQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykge30NCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF9yZWNpcGllbnQsIHVpbnQyNTYgX3ZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsNCg0KfQ0KDQoNCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgU3RhbmRhcmRUb2tlblByb3RvY29sIHsNCg0KICAgIG1vZGlmaWVyIHdoZW5fY2FuX3RyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlKSBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHdoZW5fY2FuX3JlY2VpdmUoYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSkgew0KICAgICAgICBpZiAoYmFsYW5jZXNbX3JlY2lwaWVudF0gKyBfdmFsdWUgPiBiYWxhbmNlc1tfcmVjaXBpZW50XSkgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciB3aGVuX2lzX2FsbG93ZWQoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfZGVsZWdhdGUsIHVpbnQyNTYgX3ZhbHVlKSB7DQogICAgICAgIGlmIChhbGxvd2VkW19mcm9tXVtfZGVsZWdhdGVdID49IF92YWx1ZSkgXzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQyNTYgX3ZhbHVlKQ0KICAgICAgICB3aGVuX2Nhbl90cmFuc2Zlcihtc2cuc2VuZGVyLCBfdmFsdWUpDQogICAgICAgIHdoZW5fY2FuX3JlY2VpdmUoX3JlY2lwaWVudCwgX3ZhbHVlKQ0KICAgICAgICByZXR1cm5zIChib29sIG9fc3VjY2VzcykNCiAgICB7DQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgYmFsYW5jZXNbX3JlY2lwaWVudF0gKz0gX3ZhbHVlOw0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfcmVjaXBpZW50LCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50MjU2IF92YWx1ZSkNCiAgICAgICAgd2hlbl9jYW5fdHJhbnNmZXIoX2Zyb20sIF92YWx1ZSkNCiAgICAgICAgd2hlbl9jYW5fcmVjZWl2ZShfcmVjaXBpZW50LCBfdmFsdWUpDQogICAgICAgIHdoZW5faXNfYWxsb3dlZChfZnJvbSwgbXNnLnNlbmRlciwgX3ZhbHVlKQ0KICAgICAgICByZXR1cm5zIChib29sIG9fc3VjY2VzcykNCiAgICB7DQogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsNCiAgICAgICAgYmFsYW5jZXNbX3JlY2lwaWVudF0gKz0gX3ZhbHVlOw0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3JlY2lwaWVudCwgX3ZhbHVlKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBvX3N1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgb19yZW1haW5pbmcpIHsNCiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgfQ0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7DQogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQoNCn0NCg0KY29udHJhY3QgR1VQVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiB7DQoNCiAgLy9GSUVMRFMNCiAgLy9DT05TVEFOVFMNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTE9DS09VVF9QRVJJT0QgPSAxIHllYXJzOyAvL3RpbWUgYWZ0ZXIgZW5kIGRhdGUgdGhhdCBpbGxpcXVpZCBHVVAgY2FuIGJlIHRyYW5zZmVycmVkDQoNCiAgLy9BU1NJR05FRCBJTiBJTklUSUFMSVpBVElPTg0KICB1aW50IHB1YmxpYyBlbmRNaW50aW5nVGltZTsgLy9UaW1lIGluIHNlY29uZHMgbm8gbW9yZSB0b2tlbnMgY2FuIGJlIGNyZWF0ZWQNCiAgYWRkcmVzcyBwdWJsaWMgbWludGVyOyAvL2FkZHJlc3Mgb2YgdGhlIGFjY291bnQgd2hpY2ggbWF5IG1pbnQgbmV3IHRva2Vucw0KDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGlsbGlxdWlkQmFsYW5jZTsgLy9CYWxhbmNlIG9mICdGcm96ZW4gZnVuZHMnDQoNCiAgLy9NT0RJRklFUlMNCiAgLy9DYW4gb25seSBiZSBjYWxsZWQgYnkgY29udHJpYnV0aW9uIGNvbnRyYWN0Lg0KICBtb2RpZmllciBvbmx5X21pbnRlciB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gbWludGVyKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLy8gQ2FuIG9ubHkgYmUgY2FsbGVkIGlmIGlsbGlxdWlkIHRva2VucyBtYXkgYmUgdHJhbnNmb3JtZWQgaW50byBsaXF1aWQuDQogIC8vIFRoaXMgaGFwcGVucyB3aGVuIGBMT0NLT1VUX1BFUklPRGAgb2YgdGltZSBwYXNzZXMgYWZ0ZXIgYGVuZE1pbnRpbmdUaW1lYC4NCiAgbW9kaWZpZXIgd2hlbl90aGF3YWJsZSB7DQogICAgaWYgKG5vdyA8IGVuZE1pbnRpbmdUaW1lICsgTE9DS09VVF9QRVJJT0QpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvLyBDYW4gb25seSBiZSBjYWxsZWQgaWYgKGxpcXVpZCkgdG9rZW5zIG1heSBiZSB0cmFuc2ZlcnJlZC4gSGFwcGVucw0KICAvLyBpbW1lZGlhdGVseSBhZnRlciBgZW5kTWludGluZ1RpbWVgLg0KICBtb2RpZmllciB3aGVuX3RyYW5zZmVyYWJsZSB7DQogICAgaWYgKG5vdyA8IGVuZE1pbnRpbmdUaW1lKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLy8gQ2FuIG9ubHkgYmUgY2FsbGVkIGlmIHRoZSBgY3Jvd2RmdW5kZXJgIGlzIGFsbG93ZWQgdG8gbWludCB0b2tlbnMuIEFueQ0KICAvLyB0aW1lIGJlZm9yZSBgZW5kTWludGluZ1RpbWVgLg0KICBtb2RpZmllciB3aGVuX21pbnRhYmxlIHsNCiAgICBpZiAobm93ID49IGVuZE1pbnRpbmdUaW1lKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLy8gSW5pdGlhbGl6YXRpb24gY29udHJhY3QgYXNzaWducyBhZGRyZXNzIG9mIGNyb3dkZnVuZCBjb250cmFjdCBhbmQgZW5kIHRpbWUuDQogIGZ1bmN0aW9uIEdVUFRva2VuKGFkZHJlc3MgX21pbnRlciwgdWludCBfZW5kTWludGluZ1RpbWUpIHsNCiAgICBlbmRNaW50aW5nVGltZSA9IF9lbmRNaW50aW5nVGltZTsNCiAgICBtaW50ZXIgPSBfbWludGVyOw0KICB9DQoNCiAgLy8gRmFsbGJhY2sgZnVuY3Rpb24gdGhyb3dzIHdoZW4gY2FsbGVkLg0KICBmdW5jdGlvbigpIHsNCiAgICB0aHJvdzsNCiAgfQ0KDQogIC8vIENyZWF0ZSBuZXcgdG9rZW5zIHdoZW4gY2FsbGVkIGJ5IHRoZSBjcm93ZGZ1bmQgY29udHJhY3QuDQogIC8vIE9ubHkgY2FsbGFibGUgYmVmb3JlIHRoZSBlbmQgdGltZS4NCiAgZnVuY3Rpb24gY3JlYXRlVG9rZW4oYWRkcmVzcyBfcmVjaXBpZW50LCB1aW50IF92YWx1ZSkNCiAgICB3aGVuX21pbnRhYmxlDQogICAgb25seV9taW50ZXINCiAgICByZXR1cm5zIChib29sIG9fc3VjY2VzcykNCiAgew0KICAgIGJhbGFuY2VzW19yZWNpcGllbnRdICs9IF92YWx1ZTsNCiAgICB0b3RhbFN1cHBseSArPSBfdmFsdWU7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvLyBDcmVhdGUgYW4gaWxsaXF1aWRCYWxhbmNlIHdoaWNoIGNhbm5vdCBiZSB0cmFkZWQgdW50aWwgZW5kIG9mIGxvY2tvdXQgcGVyaW9kLg0KICAvLyBDYW4gb25seSBiZSBjYWxsZWQgYnkgY3Jvd2RmdW5kIGNvbnRyYWN0IGJlZm9yIHRoZSBlbmQgdGltZS4NCiAgZnVuY3Rpb24gY3JlYXRlSWxsaXF1aWRUb2tlbihhZGRyZXNzIF9yZWNpcGllbnQsIHVpbnQgX3ZhbHVlKQ0KICAgIHdoZW5fbWludGFibGUNCiAgICBvbmx5X21pbnRlcg0KICAgIHJldHVybnMgKGJvb2wgb19zdWNjZXNzKQ0KICB7DQogICAgaWxsaXF1aWRCYWxhbmNlW19yZWNpcGllbnRdICs9IF92YWx1ZTsNCiAgICB0b3RhbFN1cHBseSArPSBfdmFsdWU7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvLyBNYWtlIHNlbmRlcidzIGlsbGlxdWlkIGJhbGFuY2UgbGlxdWlkIHdoZW4gY2FsbGVkIGFmdGVyIGxvY2tvdXQgcGVyaW9kLg0KICBmdW5jdGlvbiBtYWtlTGlxdWlkKCkNCiAgICB3aGVuX3RoYXdhYmxlDQogICAgcmV0dXJucyAoYm9vbCBvX3N1Y2Nlc3MpDQogIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSArPSBpbGxpcXVpZEJhbGFuY2VbbXNnLnNlbmRlcl07DQogICAgaWxsaXF1aWRCYWxhbmNlW21zZy5zZW5kZXJdID0gMDsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIC8vIFRyYW5zZmVyIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBzZW5kZXIgYWNjb3VudCB0byByZWNpcGllbnQuDQogIC8vIE9ubHkgY2FsbGFibGUgYWZ0ZXIgdGhlIGNyb3dkIGZ1bmQgZW5kIGRhdGUuDQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KQ0KICAgIHdoZW5fdHJhbnNmZXJhYmxlDQogICAgcmV0dXJucyAoYm9vbCBvX3N1Y2Nlc3MpDQogIHsNCiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3JlY2lwaWVudCwgX2Ftb3VudCk7DQogIH0NCg0KICAvLyBUcmFuc2ZlciBhbW91bnQgb2YgdG9rZW5zIGZyb20gYSBzcGVjaWZpZWQgYWRkcmVzcyB0byBhIHJlY2lwaWVudC4NCiAgLy8gT25seSBjYWxsYWJsZSBhZnRlciB0aGUgY3Jvd2QgZnVuZCBlbmQgZGF0ZS4NCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KQ0KICAgIHdoZW5fdHJhbnNmZXJhYmxlDQogICAgcmV0dXJucyAoYm9vbCBvX3N1Y2Nlc3MpDQogIHsNCiAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfcmVjaXBpZW50LCBfYW1vdW50KTsNCiAgfQ0KfQ0KDQpjb250cmFjdCBTYWZlTWF0aCB7DQoNCiAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7DQogICAgaWYgKCFhc3NlcnRpb24pIHRocm93Ow0KICB9DQoNCiAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPiAwKTsNCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQp9DQoNCmNvbnRyYWN0IENvbnRyaWJ1dGlvbiBpcyBTYWZlTWF0aCB7DQoNCiAgLy9GSUVMRFMNCg0KICAvL0NPTlNUQU5UUw0KICAvL1RpbWUgbGltaXRzDQogIHVpbnQgcHVibGljIGNvbnN0YW50IFNUQUdFX09ORV9USU1FX0VORCA9IDEgaG91cnM7DQogIHVpbnQgcHVibGljIGNvbnN0YW50IFNUQUdFX1RXT19USU1FX0VORCA9IDMgZGF5czsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgU1RBR0VfVEhSRUVfVElNRV9FTkQgPSAyIHdlZWtzOw0KICB1aW50IHB1YmxpYyBjb25zdGFudCBTVEFHRV9GT1VSX1RJTUVfRU5EID0gNCB3ZWVrczsNCiAgLy9QcmljZXMgb2YgR1VQDQogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSSUNFX1NUQUdFX09ORSA9IDQwMDAwMDsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfU1RBR0VfVFdPID0gMzY2MDAwOw0KICB1aW50IHB1YmxpYyBjb25zdGFudCBQUklDRV9TVEFHRV9USFJFRSA9IDMzMzAwMDsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfU1RBR0VfRk9VUiA9IDMwMDAwMDsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgUFJJQ0VfQlRDUyA9IDQwMDAwMDsNCiAgLy9HVVAgVG9rZW4gTGltaXRzDQogIHVpbnQgcHVibGljIGNvbnN0YW50IE1BWF9TVVBQTFkgPSAgICAgICAgMTAwMDAwMDAwMDAwOw0KICB1aW50IHB1YmxpYyBjb25zdGFudCBBTExPQ19JTExJUVVJRF9URUFNID0gODAwMDAwMDAwMDsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgQUxMT0NfTElRVUlEX1RFQU0gPSAgMTMwMDAwMDAwMDA7DQogIHVpbnQgcHVibGljIGNvbnN0YW50IEFMTE9DX0JPVU5USUVTID0gICAgICAyMDAwMDAwMDAwOw0KICB1aW50IHB1YmxpYyBjb25zdGFudCBBTExPQ19ORVdfVVNFUlMgPSAgICAxNzAwMDAwMDAwMDsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgQUxMT0NfQ1JPV0RTQUxFID0gICAgNjAwMDAwMDAwMDA7DQogIHVpbnQgcHVibGljIGNvbnN0YW50IEJUQ1NfUE9SVElPTl9NQVggPSAzNzUwMCAqIFBSSUNFX0JUQ1M7DQogIC8vQVNTSUdORUQgSU4gSU5JVElBTElaQVRJT04NCiAgLy9TdGFydCBhbmQgZW5kIHRpbWVzDQogIHVpbnQgcHVibGljIHB1YmxpY1N0YXJ0VGltZSA9IDE0OTA0NDY4MDA7IC8vVGltZSBpbiBzZWNvbmRzIHB1YmxpYyBjcm93ZCBmdW5kIHN0YXJ0cy4NCiAgdWludCBwdWJsaWMgcHJpdmF0ZVN0YXJ0VGltZSA9IDE0OTA0MzI0MDA7IC8vVGltZSBpbiBzZWNvbmRzIHdoZW4gQlRDU3Vpc3NlIGNhbiBwdXJjaGFzZSB1cCB0byAxMjUwMDAgRVRIIHdvcnRoIG9mIEdVUDsNCiAgdWludCBwdWJsaWMgcHVibGljRW5kVGltZTsgLy9UaW1lIGluIHNlY29uZHMgY3Jvd2RzYWxlIGVuZHMNCiAgLy9TcGVjaWFsIEFkZHJlc3Nlcw0KICBhZGRyZXNzIHB1YmxpYyBidGNzQWRkcmVzcyA9IDB4MDBhODhFRGFBOWVBZDAwQTFkMTE0ZTQ4MjBCMEIwZjJlMzY1MUVDRTsgLy9BZGRyZXNzIHVzZWQgYnkgQlRDU3Vpc3NlDQogIGFkZHJlc3MgcHVibGljIG11bHRpc2lnQWRkcmVzcyA9IDB4MkNBZmRDMzJhQzllQzU1ZTkxNTcxNmJDNDMwMzdCZDJDNjg5NTEyRTsgLy9BZGRyZXNzIHRvIHdoaWNoIGFsbCBldGhlciBmbG93cy4NCiAgYWRkcmVzcyBwdWJsaWMgbWF0Y2hwb29sQWRkcmVzcyA9IDB4MDBjZTYzM2I0Nzg5RDFhMTZhMGFEM0FFQzU4NTk5Qjc2ZDVENjY5RTsgLy9BZGRyZXNzIHRvIHdoaWNoIEFMTE9DX0JPVU5USUVTLCBBTExPQ19MSVFVSURfVEVBTSwgQUxMT0NfTkVXX1VTRVJTLCBBTExPQ19JTExJUVVJRF9URUFNIGlzIHNlbnQgdG8uDQogIGFkZHJlc3MgcHVibGljIG93bmVyQWRkcmVzcyA9IDB4MDBjZTYzM2I0Nzg5RDFhMTZhMGFEM0FFQzU4NTk5Qjc2ZDVENjY5RTsgLy9BZGRyZXNzIG9mIHRoZSBjb250cmFjdCBvd25lci4gQ2FuIGhhbHQgdGhlIGNyb3dkc2FsZS4NCiAgLy9Db250cmFjdHMNCiAgR1VQVG9rZW4gcHVibGljIGd1cFRva2VuOyAvL0V4dGVybmFsIHRva2VuIGNvbnRyYWN0IGhvbGxkaW5nIHRoZSBHVVANCiAgLy9SdW5uaW5nIHRvdGFscw0KICB1aW50IHB1YmxpYyBldGhlclJhaXNlZDsgLy9Ub3RhbCBFdGhlciByYWlzZWQuDQogIHVpbnQgcHVibGljIGd1cFNvbGQ7IC8vVG90YWwgR1VQIGNyZWF0ZWQNCiAgdWludCBwdWJsaWMgYnRjc1BvcnRpb25Ub3RhbDsgLy9Ub3RhbCBvZiBUb2tlbnMgcHVyY2hhc2VkIGJ5IEJUQyBTdWlzc2UuIE5vdCB0byBleGNlZWQgQlRDU19QT1JUSU9OX01BWC4NCiAgLy9ib29sZWFucw0KICBib29sIHB1YmxpYyBoYWx0ZWQ7IC8vaGFsdHMgdGhlIGNyb3dkIHNhbGUgaWYgdHJ1ZS4NCg0KICAvL0ZVTkNUSU9OIE1PRElGSUVSUw0KDQogIC8vSXMgY3VycmVudGx5IGluIHRoZSBwZXJpb2QgYWZ0ZXIgdGhlIHByaXZhdGUgc3RhcnQgdGltZSBhbmQgYmVmb3JlIHRoZSBwdWJsaWMgc3RhcnQgdGltZS4NCiAgbW9kaWZpZXIgaXNfcHJlX2Nyb3dkZnVuZF9wZXJpb2QoKSB7DQogICAgaWYgKG5vdyA+PSBwdWJsaWNTdGFydFRpbWUgfHwgbm93IDwgcHJpdmF0ZVN0YXJ0VGltZSkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIC8vSXMgY3VycmVudGx5IHRoZSBjcm93ZGZ1bmQgcGVyaW9kDQogIG1vZGlmaWVyIGlzX2Nyb3dkZnVuZF9wZXJpb2QoKSB7DQogICAgaWYgKG5vdyA8IHB1YmxpY1N0YXJ0VGltZSB8fCBub3cgPj0gcHVibGljRW5kVGltZSkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIC8vTWF5IG9ubHkgYmUgY2FsbGVkIGJ5IEJUQyBTdWlzc2UNCiAgbW9kaWZpZXIgb25seV9idGNzKCkgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IGJ0Y3NBZGRyZXNzKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLy9NYXkgb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyIGFkZHJlc3MNCiAgbW9kaWZpZXIgb25seV9vd25lcigpIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lckFkZHJlc3MpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvL01heSBvbmx5IGJlIGNhbGxlZCBpZiB0aGUgY3Jvd2RmdW5kIGhhcyBub3QgYmVlbiBoYWx0ZWQNCiAgbW9kaWZpZXIgaXNfbm90X2hhbHRlZCgpIHsNCiAgICBpZiAoaGFsdGVkKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLy8gRVZFTlRTDQoNCiAgZXZlbnQgUHJlQnV5KHVpbnQgX2Ftb3VudCk7DQogIGV2ZW50IEJ1eShhZGRyZXNzIGluZGV4ZWQgX3JlY2lwaWVudCwgdWludCBfYW1vdW50KTsNCg0KDQogIC8vIEZVTkNUSU9OUw0KDQogIC8vSW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uIERlcGxveXMgR1VQVG9rZW4gY29udHJhY3QgYXNzaWducyB2YWx1ZXMsIHRvIGFsbCByZW1haW5pbmcgZmllbGRzLCBjcmVhdGVzIGZpcnN0IGVudGl0bGVtZW50cyBpbiB0aGUgR1VQIFRva2VuIGNvbnRyYWN0Lg0KICBmdW5jdGlvbiBDb250cmlidXRpb24oKSB7DQogICAgcHVibGljRW5kVGltZSA9IHB1YmxpY1N0YXJ0VGltZSArIFNUQUdFX0ZPVVJfVElNRV9FTkQ7DQogICAgZ3VwVG9rZW4gPSBuZXcgR1VQVG9rZW4odGhpcywgcHVibGljRW5kVGltZSk7DQogICAgZ3VwVG9rZW4uY3JlYXRlSWxsaXF1aWRUb2tlbihtYXRjaHBvb2xBZGRyZXNzLCBBTExPQ19JTExJUVVJRF9URUFNKTsNCiAgICBndXBUb2tlbi5jcmVhdGVUb2tlbihtYXRjaHBvb2xBZGRyZXNzLCBBTExPQ19CT1VOVElFUyk7DQogICAgZ3VwVG9rZW4uY3JlYXRlVG9rZW4obWF0Y2hwb29sQWRkcmVzcywgQUxMT0NfTElRVUlEX1RFQU0pOw0KICAgIGd1cFRva2VuLmNyZWF0ZVRva2VuKG1hdGNocG9vbEFkZHJlc3MsIEFMTE9DX05FV19VU0VSUyk7DQogIH0NCg0KICAvL01heSBiZSB1c2VkIGJ5IG93bmVyIG9mIGNvbnRyYWN0IHRvIGhhbHQgY3Jvd2RzYWxlIGFuZCBubyBsb25nZXIgZXhjZXB0IGV0aGVyLg0KICBmdW5jdGlvbiB0b2dnbGVIYWx0KGJvb2wgX2hhbHRlZCkNCiAgICBvbmx5X293bmVyDQogIHsNCiAgICBoYWx0ZWQgPSBfaGFsdGVkOw0KICB9DQoNCiAgLy9jb25zdGFudCBmdW5jdGlvbiByZXR1cm5zIHRoZSBjdXJyZW50IEdVUCBwcmljZS4NCiAgZnVuY3Rpb24gZ2V0UHJpY2VSYXRlKCkNCiAgICBjb25zdGFudA0KICAgIHJldHVybnMgKHVpbnQgb19yYXRlKQ0KICB7DQogICAgaWYgKG5vdyA8PSBwdWJsaWNTdGFydFRpbWUgKyBTVEFHRV9PTkVfVElNRV9FTkQpIHJldHVybiBQUklDRV9TVEFHRV9PTkU7DQogICAgaWYgKG5vdyA8PSBwdWJsaWNTdGFydFRpbWUgKyBTVEFHRV9UV09fVElNRV9FTkQpIHJldHVybiBQUklDRV9TVEFHRV9UV087DQogICAgaWYgKG5vdyA8PSBwdWJsaWNTdGFydFRpbWUgKyBTVEFHRV9USFJFRV9USU1FX0VORCkgcmV0dXJuIFBSSUNFX1NUQUdFX1RIUkVFOw0KICAgIGlmIChub3cgPD0gcHVibGljU3RhcnRUaW1lICsgU1RBR0VfRk9VUl9USU1FX0VORCkgcmV0dXJuIFBSSUNFX1NUQUdFX0ZPVVI7DQogICAgZWxzZSByZXR1cm4gMDsNCiAgfQ0KDQogIC8vIEdpdmVuIHRoZSByYXRlIG9mIGEgcHVyY2hhc2UgYW5kIHRoZSByZW1haW5pbmcgdG9rZW5zIGluIHRoaXMgdHJhbmNoZSwgaXQNCiAgLy8gd2lsbCB0aHJvdyBpZiB0aGUgc2FsZSB3b3VsZCB0YWtlIGl0IHBhc3QgdGhlIGxpbWl0IG9mIHRoZSB0cmFuY2hlLg0KICAvLyBJdCBleGVjdXRlcyB0aGUgcHVyY2hhc2UgZm9yIHRoZSBhcHByb3ByaWF0ZSBhbW91bnQgb2YgdG9rZW5zLCB3aGljaA0KICAvLyBpbnZvbHZlcyBhZGRpbmcgaXQgdG8gdGhlIHRvdGFsLCBtaW50aW5nIEdVUCB0b2tlbnMgYW5kIHN0YXNoaW5nIHRoZQ0KICAvLyBldGhlci4NCiAgLy8gUmV0dXJucyBgYW1vdW50YCBpbiBzY29wZSBhcyB0aGUgbnVtYmVyIG9mIEdVUCB0b2tlbnMgdGhhdCBpdCB3aWxsDQogIC8vIHB1cmNoYXNlLg0KICBmdW5jdGlvbiBwcm9jZXNzUHVyY2hhc2UodWludCBfcmF0ZSwgdWludCBfcmVtYWluaW5nKQ0KICAgIGludGVybmFsDQogICAgcmV0dXJucyAodWludCBvX2Ftb3VudCkNCiAgew0KICAgIG9fYW1vdW50ID0gc2FmZURpdihzYWZlTXVsKG1zZy52YWx1ZSwgX3JhdGUpLCAxIGV0aGVyKTsNCiAgICBpZiAob19hbW91bnQgPiBfcmVtYWluaW5nKSB0aHJvdzsNCiAgICBpZiAoIW11bHRpc2lnQWRkcmVzcy5zZW5kKG1zZy52YWx1ZSkpIHRocm93Ow0KICAgIGlmICghZ3VwVG9rZW4uY3JlYXRlVG9rZW4obXNnLnNlbmRlciwgb19hbW91bnQpKSB0aHJvdzsgLy9jaGFuZ2UgdG8gbWF0Y2ggY3JlYXRlIHRva2VuDQogICAgZ3VwU29sZCArPSBvX2Ftb3VudDsNCiAgfQ0KDQogIC8vU3BlY2lhbCBGdW5jdGlvbiBjYW4gb25seSBiZSBjYWxsZWQgYnkgQlRDIFN1aXNzZSBhbmQgb25seSBkdXJpbmcgdGhlIHByZS1jcm93ZHNhbGUgcGVyaW9kLg0KICAvL0FsbG93cyB0aGUgcHVyY2hhc2Ugb2YgdXAgdG8gMTI1MDAwIEV0aGVyIHdvcnRoIG9mIEdVUCBUb2tlbnMuDQogIGZ1bmN0aW9uIHByZUJ1eSgpDQogICAgcGF5YWJsZQ0KICAgIGlzX3ByZV9jcm93ZGZ1bmRfcGVyaW9kDQogICAgb25seV9idGNzDQogICAgaXNfbm90X2hhbHRlZA0KICB7DQogICAgdWludCBhbW91bnQgPSBwcm9jZXNzUHVyY2hhc2UoUFJJQ0VfQlRDUywgQlRDU19QT1JUSU9OX01BWCAtIGJ0Y3NQb3J0aW9uVG90YWwpOw0KICAgIGJ0Y3NQb3J0aW9uVG90YWwgKz0gYW1vdW50Ow0KICAgIFByZUJ1eShhbW91bnQpOw0KICB9DQoNCiAgLy9EZWZhdWx0IGZ1bmN0aW9uIGNhbGxlZCBieSBzZW5kaW5nIEV0aGVyIHRvIHRoaXMgYWRkcmVzcyB3aXRoIG5vIGFyZ3VtZW50cy4NCiAgLy9SZXN1bHRzIGluIGNyZWF0aW9uIG9mIG5ldyBHVVAgVG9rZW5zIGlmIHRyYW5zYWN0aW9uIHdvdWxkIG5vdCBleGNlZWQgaGFyZCBsaW1pdCBvZiBHVVAgVG9rZW4uDQogIGZ1bmN0aW9uKCkNCiAgICBwYXlhYmxlDQogICAgaXNfY3Jvd2RmdW5kX3BlcmlvZA0KICAgIGlzX25vdF9oYWx0ZWQNCiAgew0KICAgIHVpbnQgYW1vdW50ID0gcHJvY2Vzc1B1cmNoYXNlKGdldFByaWNlUmF0ZSgpLCBBTExPQ19DUk9XRFNBTEUgLSBndXBTb2xkKTsNCiAgICBCdXkobXNnLnNlbmRlciwgYW1vdW50KTsNCiAgfQ0KDQogIC8vZmFpbHNhZmUgZHJhaW4NCiAgZnVuY3Rpb24gZHJhaW4oKQ0KICAgIG9ubHlfb3duZXINCiAgew0KICAgIGlmICghb3duZXJBZGRyZXNzLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7DQogIH0NCn0='