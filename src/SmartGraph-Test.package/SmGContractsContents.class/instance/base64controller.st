base 64 content
base64controller
	^'cHJhZ21hIHNvbGlkaXR5ID49MC40LjQ7DQoNCi8vZnJvbSBaZXBwZWxpbg0KY29udHJhY3QgU2FmZU1hdGggew0KICAgIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgdWludCBjID0gYSAqIGI7DQogICAgICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgICAgIHJldHVybiBjOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgICAgIHJldHVybiBhIC0gYjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgICAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7DQogICAgICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IE93bmVkIHsNCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCg0KICAgIGZ1bmN0aW9uIE93bmVkKCkgew0KICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgYWRkcmVzcyBuZXdPd25lcjsNCg0KICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyID09IG5ld093bmVyKSB7DQogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpjb250cmFjdCBGaW5hbGl6YWJsZSBpcyBPd25lZCB7DQogICAgYm9vbCBwdWJsaWMgZmluYWxpemVkOw0KDQogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgew0KICAgICAgICBmaW5hbGl6ZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG5vdEZpbmFsaXplZCgpIHsNCiAgICAgICAgaWYgKGZpbmFsaXplZCkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KfQ0KDQpjb250cmFjdCBJVG9rZW4gew0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCk7DQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgb3duZXIpIHJldHVybnModWludCk7DQp9DQoNCmNvbnRyYWN0IFRva2VuUmVjZWl2YWJsZSBpcyBPd25lZCB7DQogICAgZXZlbnQgbG9nVG9rZW5UcmFuc2ZlcihhZGRyZXNzIHRva2VuLCBhZGRyZXNzIHRvLCB1aW50IGFtb3VudCk7DQoNCiAgICBmdW5jdGlvbiBjbGFpbVRva2VucyhhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfdG8pIG9ubHlPd25lciByZXR1cm5zIChib29sKSB7DQogICAgICAgIElUb2tlbiB0b2tlbiA9IElUb2tlbihfdG9rZW4pOw0KICAgICAgICB1aW50IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7DQogICAgICAgIGlmICh0b2tlbi50cmFuc2ZlcihfdG8sIGJhbGFuY2UpKSB7DQogICAgICAgICAgICBsb2dUb2tlblRyYW5zZmVyKF90b2tlbiwgX3RvLCBiYWxhbmNlKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IEV2ZW50RGVmaW5pdGlvbnMgew0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQpjb250cmFjdCBUb2tlbiBpcyBGaW5hbGl6YWJsZSwgVG9rZW5SZWNlaXZhYmxlLCBTYWZlTWF0aCwgRXZlbnREZWZpbml0aW9ucyB7DQoNCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAiRnVuRmFpciI7DQogICAgdWludDggcHVibGljIGRlY2ltYWxzID0gODsNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJGVU4iOw0KDQogICAgQ29udHJvbGxlciBjb250cm9sbGVyOw0KICAgIGFkZHJlc3Mgb3duZXI7DQoNCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlcigpIHsNCiAgICAgICAgYXNzZXJ0KG1zZy5zZW5kZXIgPT0gYWRkcmVzcyhjb250cm9sbGVyKSk7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0Q29udHJvbGxlcihhZGRyZXNzIF9jKSBvbmx5T3duZXIgbm90RmluYWxpemVkIHsNCiAgICAgICAgY29udHJvbGxlciA9IENvbnRyb2xsZXIoX2MpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIGEpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIuYmFsYW5jZU9mKGEpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gY29udHJvbGxlci50b3RhbFN1cHBseSgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gY29udHJvbGxlci5hbGxvd2FuY2UoX293bmVyLCBfc3BlbmRlcik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQ0KICAgIG9ubHlQYXlsb2FkU2l6ZSgyKQ0KICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgIHN1Y2Nlc3MgPSBjb250cm9sbGVyLnRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICAgICAgaWYgKHN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpDQogICAgb25seVBheWxvYWRTaXplKDMpDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgc3VjY2VzcyA9IGNvbnRyb2xsZXIudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgIGlmIChzdWNjZXNzKSB7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkNCiAgICBvbmx5UGF5bG9hZFNpemUoMikNCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgLy9wcm9tb3RlIHNhZmUgdXNlciBiZWhhdmlvcg0KICAgICAgICBpZiAoY29udHJvbGxlci5hbGxvd2FuY2UobXNnLnNlbmRlciwgX3NwZW5kZXIpID4gMCkgdGhyb3c7DQoNCiAgICAgICAgc3VjY2VzcyA9IGNvbnRyb2xsZXIuYXBwcm92ZShtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgICAgICAgaWYgKHN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkNCiAgICBvbmx5UGF5bG9hZFNpemUoMikNCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgc3VjY2VzcyA9IGNvbnRyb2xsZXIuaW5jcmVhc2VBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2FkZGVkVmFsdWUpOw0KICAgICAgICBpZiAoc3VjY2Vzcykgew0KICAgICAgICAgICAgdWludCBuZXd2YWwgPSBjb250cm9sbGVyLmFsbG93YW5jZShtc2cuc2VuZGVyLCBfc3BlbmRlcik7DQogICAgICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgbmV3dmFsKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkNCiAgICBvbmx5UGF5bG9hZFNpemUoMikNCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgc3VjY2VzcyA9IGNvbnRyb2xsZXIuZGVjcmVhc2VBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3N1YnRyYWN0ZWRWYWx1ZSk7DQogICAgICAgIGlmIChzdWNjZXNzKSB7DQogICAgICAgICAgICB1aW50IG5ld3ZhbCA9IGNvbnRyb2xsZXIuYWxsb3dhbmNlKG1zZy5zZW5kZXIsIF9zcGVuZGVyKTsNCiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBuZXd2YWwpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgbnVtd29yZHMpIHsNCiAgICAgICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA+PSBudW13b3JkcyAqIDMyICsgNCk7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYnVybih1aW50IF9hbW91bnQpIHsNCiAgICAgICAgY29udHJvbGxlci5idXJuKG1zZy5zZW5kZXIsIF9hbW91bnQpOw0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIF9hbW91bnQpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXJUcmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpDQogICAgb25seUNvbnRyb2xsZXIgew0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXJBcHByb3ZlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkNCiAgICBvbmx5Q29udHJvbGxlciB7DQogICAgICAgIEFwcHJvdmFsKF9vd25lciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgfQ0KDQogICAgLy9tdWx0aS1hcHByb3ZlLCBtdWx0aS10cmFuc2Zlcg0KDQogICAgYm9vbCBwdWJsaWMgbXVsdGlsb2NrZWQ7DQoNCiAgICBtb2RpZmllciBub3RNdWx0aWxvY2tlZCB7DQogICAgICAgIGFzc2VydCghbXVsdGlsb2NrZWQpOw0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8vZG8gd2Ugd2FudCBsb2NrIHBlcm1hbmVudD8gSSB0aGluayBzby4NCiAgICBmdW5jdGlvbiBsb2NrTXVsdGlzKCkgb25seU93bmVyIHsNCiAgICAgICAgbXVsdGlsb2NrZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIC8vbXVsdGkgZnVuY3Rpb25zIGp1c3QgaXNzdWUgZXZlbnRzLCB0byBmaXggaW5pdGlhbCBldmVudCBoaXN0b3J5DQoNCiAgICBmdW5jdGlvbiBtdWx0aVRyYW5zZmVyKHVpbnRbXSBiaXRzKSBvbmx5T3duZXIgbm90TXVsdGlsb2NrZWQgew0KICAgICAgICBpZiAoYml0cy5sZW5ndGggJSAzICE9IDApIHRocm93Ow0KICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPGJpdHMubGVuZ3RoOyBpICs9IDMpIHsNCiAgICAgICAgICAgIGFkZHJlc3MgZnJvbSA9IGFkZHJlc3MoYml0c1tpXSk7DQogICAgICAgICAgICBhZGRyZXNzIHRvID0gYWRkcmVzcyhiaXRzW2krMV0pOw0KICAgICAgICAgICAgdWludCBhbW91bnQgPSBiaXRzW2krMl07DQogICAgICAgICAgICBUcmFuc2Zlcihmcm9tLCB0bywgYW1vdW50KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG11bHRpQXBwcm92ZSh1aW50W10gYml0cykgb25seU93bmVyIG5vdE11bHRpbG9ja2VkIHsNCiAgICAgICAgaWYgKGJpdHMubGVuZ3RoICUgMyAhPSAwKSB0aHJvdzsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxiaXRzLmxlbmd0aDsgaSArPSAzKSB7DQogICAgICAgICAgICBhZGRyZXNzIG93bmVyID0gYWRkcmVzcyhiaXRzW2ldKTsNCiAgICAgICAgICAgIGFkZHJlc3Mgc3BlbmRlciA9IGFkZHJlc3MoYml0c1tpKzFdKTsNCiAgICAgICAgICAgIHVpbnQgYW1vdW50ID0gYml0c1tpKzJdOw0KICAgICAgICAgICAgQXBwcm92YWwob3duZXIsIHNwZW5kZXIsIGFtb3VudCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBzdHJpbmcgcHVibGljIG1vdGQ7DQogICAgZXZlbnQgTW90ZChzdHJpbmcgbWVzc2FnZSk7DQogICAgZnVuY3Rpb24gc2V0TW90ZChzdHJpbmcgX20pIG9ubHlPd25lciB7DQogICAgICAgIG1vdGQgPSBfbTsNCiAgICAgICAgTW90ZChfbSk7DQogICAgfQ0KfQ0KDQpjb250cmFjdCBDb250cm9sbGVyIGlzIE93bmVkLCBGaW5hbGl6YWJsZSB7DQogICAgTGVkZ2VyIHB1YmxpYyBsZWRnZXI7DQogICAgVG9rZW4gcHVibGljIHRva2VuOw0KICAgIGFkZHJlc3MgcHVibGljIG9sZFRva2VuOw0KICAgIGFkZHJlc3MgcHVibGljIEV0aGVyRGVsdGE7DQoNCiAgICBmdW5jdGlvbiBzZXRFdGhlckRlbHRhKGFkZHJlc3MgX2FkZHIpIG9ubHlPd25lciB7DQogICAgICAgIEV0aGVyRGVsdGEgPSBfYWRkcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRPbGRUb2tlbihhZGRyZXNzIF90b2tlbikgb25seU93bmVyIHsNCiAgICAgICAgb2xkVG9rZW4gPSBfdG9rZW47DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0VG9rZW4oYWRkcmVzcyBfdG9rZW4pIG9ubHlPd25lciB7DQogICAgICAgIHRva2VuID0gVG9rZW4oX3Rva2VuKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRMZWRnZXIoYWRkcmVzcyBfbGVkZ2VyKSBvbmx5T3duZXIgew0KICAgICAgICBsZWRnZXIgPSBMZWRnZXIoX2xlZGdlcik7DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seVRva2VuKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBhZGRyZXNzKHRva2VuKSAmJiBtc2cuc2VuZGVyICE9IG9sZFRva2VuKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5TmV3VG9rZW4oKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGFkZHJlc3ModG9rZW4pKSB0aHJvdzsNCglfOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gbGVkZ2VyLnRvdGFsU3VwcGx5KCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX2EpIG9ubHlUb2tlbiBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBMZWRnZXIobGVkZ2VyKS5iYWxhbmNlT2YoX2EpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikNCiAgICBvbmx5VG9rZW4gY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gbGVkZ2VyLmFsbG93YW5jZShfb3duZXIsIF9zcGVuZGVyKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpDQogICAgb25seVRva2VuDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGFzc2VydChtc2cuc2VuZGVyICE9IG9sZFRva2VuIHx8IF9mcm9tID09IEV0aGVyRGVsdGEpOw0KICAgICAgICBib29sIG9rID0gbGVkZ2VyLnRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQoJaWYgKG9rICYmIG1zZy5zZW5kZXIgPT0gb2xkVG9rZW4pDQoJICAgIHRva2VuLmNvbnRyb2xsZXJUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KCXJldHVybiBvazsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfc3BlbmRlciwgYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQ0KICAgIG9ubHlUb2tlbg0KICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhc3NlcnQobXNnLnNlbmRlciAhPSBvbGRUb2tlbiB8fCBfZnJvbSA9PSBFdGhlckRlbHRhKTsNCiAgICAgICAgYm9vbCBvayA9IGxlZGdlci50cmFuc2ZlckZyb20oX3NwZW5kZXIsIF9mcm9tLCBfdG8sIF92YWx1ZSk7DQoJaWYgKG9rICYmIG1zZy5zZW5kZXIgPT0gb2xkVG9rZW4pDQoJICAgIHRva2VuLmNvbnRyb2xsZXJUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KCXJldHVybiBvazsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkNCiAgICBvbmx5TmV3VG9rZW4NCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgcmV0dXJuIGxlZGdlci5hcHByb3ZlKF9vd25lciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaW5jcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpDQogICAgb25seU5ld1Rva2VuDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHJldHVybiBsZWRnZXIuaW5jcmVhc2VBcHByb3ZhbChfb3duZXIsIF9zcGVuZGVyLCBfYWRkZWRWYWx1ZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGVjcmVhc2VBcHByb3ZhbCAoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkNCiAgICBvbmx5TmV3VG9rZW4NCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgcmV0dXJuIGxlZGdlci5kZWNyZWFzZUFwcHJvdmFsKF9vd25lciwgX3NwZW5kZXIsIF9zdWJ0cmFjdGVkVmFsdWUpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJ1cm4oYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Ftb3VudCkgb25seU5ld1Rva2VuIHsNCiAgICAgICAgbGVkZ2VyLmJ1cm4oX293bmVyLCBfYW1vdW50KTsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IExlZGdlciBpcyBPd25lZCwgU2FmZU1hdGgsIEZpbmFsaXphYmxlIHsNCiAgICBhZGRyZXNzIHB1YmxpYyBjb250cm9sbGVyOw0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYmFsYW5jZU9mOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgcHVibGljIGFsbG93YW5jZTsNCiAgICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsNCg0KICAgIGZ1bmN0aW9uIHNldENvbnRyb2xsZXIoYWRkcmVzcyBfY29udHJvbGxlcikgb25seU93bmVyIG5vdEZpbmFsaXplZCB7DQogICAgICAgIGNvbnRyb2xsZXIgPSBfY29udHJvbGxlcjsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5Q29udHJvbGxlcigpIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gY29udHJvbGxlcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQ0KICAgIG9ubHlDb250cm9sbGVyDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlT2ZbX2Zyb21dIDwgX3ZhbHVlKSByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZU9mW19mcm9tXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBzYWZlQWRkKGJhbGFuY2VPZltfdG9dLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfc3BlbmRlciwgYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKQ0KICAgIG9ubHlDb250cm9sbGVyDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlT2ZbX2Zyb21dIDwgX3ZhbHVlKSByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgdmFyIGFsbG93ZWQgPSBhbGxvd2FuY2VbX2Zyb21dW19zcGVuZGVyXTsNCiAgICAgICAgaWYgKGFsbG93ZWQgPCBfdmFsdWUpIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZU9mW190b10sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VPZltfZnJvbV0sIF92YWx1ZSk7DQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bX3NwZW5kZXJdID0gc2FmZVN1YihhbGxvd2VkLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkNCiAgICBvbmx5Q29udHJvbGxlcg0KICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICAvL3JlcXVpcmUgdXNlciB0byBzZXQgdG8gemVybyBiZWZvcmUgcmVzZXR0aW5nIHRvIG5vbnplcm8NCiAgICAgICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93YW5jZVtfb3duZXJdW19zcGVuZGVyXSAhPSAwKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgYWxsb3dhbmNlW19vd25lcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpbmNyZWFzZUFwcHJvdmFsIChhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlciwgdWludCBfYWRkZWRWYWx1ZSkNCiAgICBvbmx5Q29udHJvbGxlcg0KICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICB1aW50IG9sZFZhbHVlID0gYWxsb3dhbmNlW19vd25lcl1bX3NwZW5kZXJdOw0KICAgICAgICBhbGxvd2FuY2VbX293bmVyXVtfc3BlbmRlcl0gPSBzYWZlQWRkKG9sZFZhbHVlLCBfYWRkZWRWYWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9zdWJ0cmFjdGVkVmFsdWUpDQogICAgb25seUNvbnRyb2xsZXINCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93YW5jZVtfb3duZXJdW19zcGVuZGVyXTsNCiAgICAgICAgaWYgKF9zdWJ0cmFjdGVkVmFsdWUgPiBvbGRWYWx1ZSkgew0KICAgICAgICAgICAgYWxsb3dhbmNlW19vd25lcl1bX3NwZW5kZXJdID0gMDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGFsbG93YW5jZVtfb3duZXJdW19zcGVuZGVyXSA9IHNhZmVTdWIob2xkVmFsdWUsIF9zdWJ0cmFjdGVkVmFsdWUpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGV2ZW50IExvZ01pbnQoYWRkcmVzcyBpbmRleGVkIG93bmVyLCB1aW50IGFtb3VudCk7DQogICAgZXZlbnQgTG9nTWludGluZ1N0b3BwZWQoKTsNCg0KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBfYSwgdWludCBfYW1vdW50KSBvbmx5T3duZXIgbWludGluZ0FjdGl2ZSB7DQogICAgICAgIGJhbGFuY2VPZltfYV0gKz0gX2Ftb3VudDsNCiAgICAgICAgdG90YWxTdXBwbHkgKz0gX2Ftb3VudDsNCiAgICAgICAgTG9nTWludChfYSwgX2Ftb3VudCk7DQogICAgfQ0KDQogICAgLyoNCiAgICBmdW5jdGlvbiBtdWx0aU1pbnQodWludFtdIGJpdHMpIG9ubHlPd25lciBtaW50aW5nQWN0aXZlIHsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxiaXRzLmxlbmd0aDsgaSsrKSB7DQoJICAgIGFkZHJlc3MgYSA9IGFkZHJlc3MoYml0c1tpXT4+OTYpOw0KCSAgICB1aW50IGFtb3VudCA9IGJpdHNbaV0mKCgxPDw5NikgLSAxKTsNCgkgICAgbWludChhLCBhbW91bnQpOw0KICAgICAgICB9DQogICAgfQ0KICAgICovDQoNCiAgICBib29sIHB1YmxpYyBtaW50aW5nU3RvcHBlZDsNCg0KICAgIGZ1bmN0aW9uIHN0b3BNaW50aW5nKCkgb25seU93bmVyIHsNCiAgICAgICAgbWludGluZ1N0b3BwZWQgPSB0cnVlOw0KICAgICAgICBMb2dNaW50aW5nU3RvcHBlZCgpOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG1pbnRpbmdBY3RpdmUoKSB7DQogICAgICAgIGlmIChtaW50aW5nU3RvcHBlZCkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYnVybihhZGRyZXNzIF9vd25lciwgdWludCBfYW1vdW50KSBvbmx5Q29udHJvbGxlciB7DQogICAgICAgIGJhbGFuY2VPZltfb3duZXJdID0gc2FmZVN1YihiYWxhbmNlT2ZbX293bmVyXSwgX2Ftb3VudCk7DQogICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX2Ftb3VudCk7DQogICAgfQ0KfQ=='