base 64 content
base64crowdWallet
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMzsNCg0KDQovKioNCiAqIEB0aXRsZSBPd25hYmxlDQogKiBAZGV2IFRoZSBPd25hYmxlIGNvbnRyYWN0IGhhcyBhbiBvd25lciBhZGRyZXNzLCBhbmQgcHJvdmlkZXMgYmFzaWMgYXV0aG9yaXphdGlvbiBjb250cm9sIA0KICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4gDQogKi8NCmNvbnRyYWN0IE93bmFibGUgew0KICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCg0KDQogIC8qKiANCiAgICogQGRldiBUaGUgT3duYWJsZSBjb25zdHJ1Y3RvciBzZXRzIHRoZSBvcmlnaW5hbCBgb3duZXJgIG9mIHRoZSBjb250cmFjdCB0byB0aGUgc2VuZGVyDQogICAqIGFjY291bnQuDQogICAqLw0KICBmdW5jdGlvbiBPd25hYmxlKCkgew0KICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgfQ0KDQoNCiAgLyoqDQogICAqIEBkZXYgVGhyb3dzIGlmIGNhbGxlZCBieSBhbnkgYWNjb3VudCBvdGhlciB0aGFuIHRoZSBvd25lci4gDQogICAqLw0KICBtb2RpZmllciBvbmx5T3duZXIoKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCg0KICAvKioNCiAgICogQGRldiBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gdHJhbnNmZXIgY29udHJvbCBvZiB0aGUgY29udHJhY3QgdG8gYSBuZXdPd25lci4NCiAgICogQHBhcmFtIG5ld093bmVyIFRoZSBhZGRyZXNzIHRvIHRyYW5zZmVyIG93bmVyc2hpcCB0by4gDQogICAqLw0KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgew0KICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7DQogICAgICBvd25lciA9IG5ld093bmVyOw0KICAgIH0NCiAgfQ0KDQp9DQoNCg0KY29udHJhY3QgRVJDMjBCYXNpYyB7DQogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQp9DQoNCg0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7DQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOw0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sKTsNCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wpOw0KICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCn0NCg0KLyoqDQogKiBAdGl0bGUgU2FmZU1hdGgNCiAqIEBkZXYgTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcyB0aGF0IHRocm93IG9uIGVycm9yDQogKi8NCmxpYnJhcnkgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICB1aW50MjU2IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwDQogICAgdWludDI1NiBjID0gYSAvIGI7DQogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHN1Yih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFkZCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgIHVpbnQyNTYgYyA9IGEgKyBiOw0KICAgIGFzc2VydChjID49IGEpOw0KICAgIHJldHVybiBjOw0KICB9DQp9DQoNCg0KLyoqDQogKiBAdGl0bGUgQmFzaWMgdG9rZW4NCiAqIEBkZXYgQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMuIA0KICovDQpjb250cmFjdCBCYXNpY1Rva2VuIGlzIEVSQzIwQmFzaWMgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsNCg0KICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQoNCiAgLyoqDQogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcw0KICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uDQogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLg0KICAqLw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIC8qKg0KICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuDQogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIA0KICAqIEByZXR1cm4gQW4gdWludDI1NiByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuDQogICovDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogIH0NCg0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIFN0YW5kYXJkIEVSQzIwIHRva2VuDQogKg0KICogQGRldiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgYmFzaWMgc3RhbmRhcmQgdG9rZW4uDQogKiBAZGV2IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KICogQGRldiBCYXNlZCBvbiBjb2RlIGJ5IEZpcnN0Qmxvb2Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9GaXJzdGJsb29kaW8vdG9rZW4vYmxvYi9tYXN0ZXIvc21hcnRfY29udHJhY3QvRmlyc3RCbG9vZFRva2VuLnNvbA0KICovDQpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIEVSQzIwLCBCYXNpY1Rva2VuIHsNCg0KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7DQoNCg0KICAvKioNCiAgICogQGRldiBUcmFuc2ZlciB0b2tlbnMgZnJvbSBvbmUgYWRkcmVzcyB0byBhbm90aGVyDQogICAqIEBwYXJhbSBfZnJvbSBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHNlbmQgdG9rZW5zIGZyb20NCiAgICogQHBhcmFtIF90byBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRvDQogICAqIEBwYXJhbSBfdmFsdWUgdWludDI1NiB0aGUgYW1vdXQgb2YgdG9rZW5zIHRvIGJlIHRyYW5zZmVyZWQNCiAgICovDQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsNCiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOw0KDQogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0DQogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93Ow0KDQogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7DQogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOw0KICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsNCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgLyoqDQogICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuDQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4NCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4NCiAgICovDQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wpIHsNCg0KICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgDQogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QNCiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToNCiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkNCiAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHRocm93Ow0KDQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvKioNCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLg0KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuDQogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLg0KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuDQogICAqLw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogIH0NCg0KfQ0KDQoNCmNvbnRyYWN0IEdlbmVzaXNUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsNCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQyNTY7DQoNCiAgLy8gbWV0YWRhdGENCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gJ0dlbmVzaXMnOw0KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICdHTlMnOw0KICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDE4Ow0KICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnMC4wLjEnOw0KDQogIC8vIGV2ZW50cw0KICBldmVudCBFYXJuZWRHTlMoYWRkcmVzcyBpbmRleGVkIGNvbnRyaWJ1dG9yLCB1aW50MjU2IGFtb3VudCk7DQogIGV2ZW50IFRyYW5zZmVycmVkR05TKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpOw0KDQogIC8vIGNvbnN0cnVjdG9yDQogIGZ1bmN0aW9uIEdlbmVzaXNUb2tlbigNCiAgICBhZGRyZXNzIF9vd25lciwNCiAgICB1aW50MjU2IGluaXRpYWxCYWxhbmNlKQ0KICB7DQogICAgb3duZXIgPSBfb3duZXI7DQogICAgdG90YWxTdXBwbHkgPSBpbml0aWFsQmFsYW5jZTsNCiAgICBiYWxhbmNlc1tfb3duZXJdID0gaW5pdGlhbEJhbGFuY2U7DQogICAgRWFybmVkR05TKF9vd25lciwgaW5pdGlhbEJhbGFuY2UpOw0KICB9DQoNCiAgLyoqDQogICAqIEBkZXYgRnVuY3Rpb24gdG8gbWludCB0b2tlbnMNCiAgICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgcmVjaWV2ZSB0aGUgbWludGVkIHRva2Vucy4NCiAgICogQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gbWludC4NCiAgICogQHJldHVybiBBIGJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4NCiAgICovDQogIGZ1bmN0aW9uIGdpdmVUb2tlbnMoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsNCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZChfYW1vdW50KTsNCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX2Ftb3VudCk7DQogICAgRWFybmVkR05TKF90bywgX2Ftb3VudCk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCn0NCg0KLyoqDQogKiBUaGlzIGNvbnRyYWN0IGhvbGRzIGFsbCB0aGUgcmV2ZW51ZXMgZ2VuZXJhdGVkIGJ5IHRoZSBEQU8sIGFuZCBwYXlzIG91dCB0bw0KICogdG9rZW4gaG9sZGVycyBvbiBhIHBlcmlvZGljIGJhc2lzLg0KICovDQpjb250cmFjdCBDcm93ZFdhbGxldCBpcyBPd25hYmxlIHsNCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7DQoNCiAgc3RydWN0IERlcG9zaXQgew0KICAgIHVpbnQgYW1vdW50Ow0KICAgIHVpbnQgYmxvY2s7DQogIH0NCg0KICBzdHJ1Y3QgUGF5b3V0IHsNCiAgICB1aW50IGFtb3VudDsNCiAgICB1aW50IGJsb2NrOw0KICB9DQoNCiAgLy8gR2VuZXNpcyBUb2tlbnMgZGV0ZXJtaW5lIHRoZSBwYXlvdXQgZm9yIGVhY2ggY29udHJpYnV0b3IuDQogIEdlbmVzaXNUb2tlbiBwdWJsaWMgdG9rZW47DQoNCiAgLy8gVHJhY2sgZGVwb3NpdHMvcGF5b3V0cyBieSBhZGRyZXNzDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gRGVwb3NpdFtdKSBwdWJsaWMgZGVwb3NpdHM7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gUGF5b3V0W10pIHB1YmxpYyBwYXlvdXRzOw0KDQogIC8vIFRyYWNrIHRoZSBzdW0gb2YgYWxsIHBheW91dHMgJiBkZXBvc2l0cyBldmVyIG1hZGUgdG8gdGhpcyBjb250cmFjdC4NCiAgdWludCBwdWJsaWMgbGlmZXRpbWVEZXBvc2l0czsNCiAgdWludCBwdWJsaWMgbGlmZXRpbWVQYXlvdXRzOw0KDQogIC8vIFRpbWUgYmV0d2VlbiBwYXkgcGVyaW9kcyBhcmUgZGVmaW5lZCBhcyBhIG51bWJlciBvZiBibG9ja3MuDQogIHVpbnQgcHVibGljIGJsb2Nrc1BlclBheVBlcmlvZCA9IDE3MjgwMDsgLy8gfjMwIGRheXMNCiAgdWludCBwdWJsaWMgcHJldmlvdXNQYXlvdXRCbG9jazsNCiAgdWludCBwdWJsaWMgbmV4dFBheW91dEJsb2NrOw0KDQogIC8vIFRoZSBiYWxhbmNlIGF0IHRoZSBlbmQgb2YgZWFjaCBwZXJpb2QgaXMgc2F2ZWQgaGVyZSBhbmQgYWxsb2NhdGVkIHRvIHRva2VuDQogIC8vIGhvbGRlcnMgZnJvbSB0aGUgcHJldmlvdXMgcGVyaW9kLg0KICB1aW50IHB1YmxpYyBwYXlvdXRQb29sOw0KDQogIC8vIEZvciBkb2luZyBkaXZpc2lvbi4gTnVtZXJhdG9yIHNob3VsZCBiZSBtdWx0aXBsaWVkIGJ5IHRoaXMuDQogIHVpbnQgbXVsdGlwbGllciA9IDEwKioxODsNCg0KICAvLyBTZXQgYSBtaW5pbXVtIHRoYXQgYSB1c2VyIG11c3QgaGF2ZSBlYXJuZWQgaW4gb3JkZXIgdG8gd2l0aGRyYXcgaXQuDQogIHVpbnQgcHVibGljIG1pbldpdGhkcmF3YWxUaHJlc2hvbGQgPSAxMDAwMDAwMDAwMDAwMDAwMDA7IC8vIDAuMSBFVEggaW4gd2VpDQoNCiAgLy8gRXZlbnRzDQogIGV2ZW50IG9uRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHVpbnQgX2Ftb3VudCk7DQogIGV2ZW50IG9uUGF5b3V0KGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQgX2Ftb3VudCk7DQogIGV2ZW50IG9uUGF5b3V0RmFpbHVyZShhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IGFtb3VudCk7DQoNCiAgLyoqDQogICAqIENvbnN0cnVjdG9yIC0gc2V0IHRoZSBHTlMgdG9rZW4gYWRkcmVzcyBhbmQgdGhlIGluaXRpYWwgbnVtYmVyIG9mIGJsb2Nrcw0KICAgKiBpbi1iZXR3ZWVuIGVhY2ggcGF5IHBlcmlvZC4NCiAgICovDQogIGZ1bmN0aW9uIENyb3dkV2FsbGV0KGFkZHJlc3MgX2ducywgYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Jsb2Nrc1BlclBheVBlcmlvZCkgew0KICAgIHRva2VuID0gR2VuZXNpc1Rva2VuKF9nbnMpOw0KICAgIG93bmVyID0gX293bmVyOw0KICAgIGJsb2Nrc1BlclBheVBlcmlvZCA9IF9ibG9ja3NQZXJQYXlQZXJpb2Q7DQogICAgbmV4dFBheW91dEJsb2NrID0gbm93LmFkZChibG9ja3NQZXJQYXlQZXJpb2QpOw0KICB9DQoNCiAgZnVuY3Rpb24gc2V0TWluaW11bVdpdGhkcmF3YWwodWludCBfd2VpQW1vdW50KSBvbmx5T3duZXIgew0KICAgIG1pbldpdGhkcmF3YWxUaHJlc2hvbGQgPSBfd2VpQW1vdW50Ow0KICB9DQoNCiAgZnVuY3Rpb24gc2V0QmxvY2tzUGVyUGF5UGVyaW9kKHVpbnQgX2Jsb2Nrc1BlclBheVBlcmlvZCkgb25seU93bmVyIHsNCiAgICBibG9ja3NQZXJQYXlQZXJpb2QgPSBfYmxvY2tzUGVyUGF5UGVyaW9kOw0KICB9DQoNCiAgLyoqDQogICAqIFRvIHByZXZlbnQgY2hlYXRpbmcsIHdoZW4gYSB3aXRoZHJhd2FsIGlzIG1hZGUsIHRoZSB0b2tlbnMgZm9yIHRoYXQgYWRkcmVzcw0KICAgKiBiZWNvbWUgaW1tZWRpYXRlbHkgbG9ja2VkIHVudGlsIHRoZSBuZXh0IHBlcmlvZC4gT3RoZXJ3aXNlLCB0aGV5IGNvdWxkIHNlbmQNCiAgICogdGhlaXIgdG9rZW5zIHRvIGFub3RoZXIgd2FsbGV0IGFuZCB3aXRoZHJhdyBhZ2Fpbi4NCiAgICovDQogIGZ1bmN0aW9uIHdpdGhkcmF3KCkgew0KICAgIHJlcXVpcmUocHJldmlvdXNQYXlvdXRCbG9jayA+IDApOw0KDQogICAgLy8gRW5zdXJlIHRoZSB1c2VyIGhhcyBub3QgYWxyZWFkeSBtYWRlIGEgd2l0aGRyYXdhbCB0aGlzIHBlcmlvZC4NCiAgICByZXF1aXJlKCFpc0FkZHJlc3NMb2NrZWQobXNnLnNlbmRlcikpOw0KDQogICAgdWludCBwYXlvdXRBbW91bnQgPSBjYWxjdWxhdGVQYXlvdXRGb3JBZGRyZXNzKG1zZy5zZW5kZXIpOw0KDQogICAgLy8gRW5zdXJlIHVzZXIncyBwYXlvdXQgaXMgYWJvdmUgdGhlIG1pbmltdW0gdGhyZXNob2xkIGZvciB3aXRoZHJhd2Fscy4NCiAgICByZXF1aXJlKHBheW91dEFtb3VudCA+IG1pbldpdGhkcmF3YWxUaHJlc2hvbGQpOw0KDQogICAgLy8gVXNlciBxdWFsaWZpZXMuIFNhdmUgdGhlIHRyYW5zYWN0aW9uIHdpdGggdGhlIGN1cnJlbnQgYmxvY2sgbnVtYmVyLA0KICAgIC8vIGVmZmVjdGl2ZWx5IGxvY2tpbmcgdGhlaXIgdG9rZW5zIHVudGlsIHRoZSBuZXh0IHBheW91dCBkYXRlLg0KICAgIHBheW91dHNbbXNnLnNlbmRlcl0ucHVzaChQYXlvdXQoeyBhbW91bnQ6IHBheW91dEFtb3VudCwgYmxvY2s6IG5vdyB9KSk7DQoNCiAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+PSBwYXlvdXRBbW91bnQpOw0KDQogICAgb25QYXlvdXQobXNnLnNlbmRlciwgcGF5b3V0QW1vdW50KTsNCg0KICAgIGxpZmV0aW1lUGF5b3V0cyArPSBwYXlvdXRBbW91bnQ7DQoNCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHBheW91dEFtb3VudCk7DQogIH0NCg0KICAvKioNCiAgICogT25jZSBhIHVzZXIgZ2V0cyBwYWlkIG91dCBmb3IgYSBwZXJpb2QsIHdlIGxvY2sgdXAgdGhlIHRva2VucyB0aGV5IG93bg0KICAgKiB1bnRpbCB0aGUgbmV4dCBwZXJpb2QuIE90aGVyd2lzZSwgdGhleSBjYW4gc2VuZCB0aGVpciB0b2tlbnMgdG8gYSBmcmVzaA0KICAgKiBhZGRyZXNzIGFuZCB0aGVuIGRvdWJsZSBkaXAuDQogICAqLw0KICBmdW5jdGlvbiBpc0FkZHJlc3NMb2NrZWQoYWRkcmVzcyBjb250cmlidXRvcikgY29uc3RhbnQgcmV0dXJucyhib29sKSB7DQogICAgdmFyIHBheW1lbnRIaXN0b3J5ID0gcGF5b3V0c1tjb250cmlidXRvcl07DQoNCiAgICBpZiAocGF5bWVudEhpc3RvcnkubGVuZ3RoID09IDApIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICB2YXIgbGFzdFBheW1lbnQgPSBwYXltZW50SGlzdG9yeVtwYXltZW50SGlzdG9yeS5sZW5ndGggLSAxXTsNCg0KICAgIHJldHVybiAobGFzdFBheW1lbnQuYmxvY2sgPj0gcHJldmlvdXNQYXlvdXRCbG9jaykgJiYgKGxhc3RQYXltZW50LmJsb2NrIDwgbmV4dFBheW91dEJsb2NrKTsNCiAgfQ0KDQogIC8qKg0KICAgKiBDaGVjayBpZiB3ZSBhcmUgaW4gYSBuZXcgcGF5b3V0IGN5Y2xlLg0KICAgKi8NCiAgZnVuY3Rpb24gaXNOZXdQYXlvdXRQZXJpb2QoKSBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsNCiAgICByZXR1cm4gbm93ID49IG5leHRQYXlvdXRCbG9jazsNCiAgfQ0KDQogIC8qKg0KICAgKiBTdGFydCBhIG5ldyBwYXlvdXQgY3ljbGUNCiAgICovDQogIGZ1bmN0aW9uIHN0YXJ0TmV3UGF5b3V0UGVyaW9kKCkgew0KICAgIHJlcXVpcmUoaXNOZXdQYXlvdXRQZXJpb2QoKSk7DQoNCiAgICBwcmV2aW91c1BheW91dEJsb2NrID0gbmV4dFBheW91dEJsb2NrOw0KICAgIG5leHRQYXlvdXRCbG9jayA9IG5leHRQYXlvdXRCbG9jay5hZGQoYmxvY2tzUGVyUGF5UGVyaW9kKTsNCiAgICBwYXlvdXRQb29sID0gdGhpcy5iYWxhbmNlOw0KICB9DQoNCiAgLyoqDQogICAqIERldGVybWluZSB0aGUgYW1vdW50IHRoYXQgc2hvdWxkIGJlIHBhaWQgb3V0Lg0KICAgKi8NCiAgZnVuY3Rpb24gY2FsY3VsYXRlUGF5b3V0Rm9yQWRkcmVzcyhhZGRyZXNzIHBheWVlKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICB1aW50IG93bmVkQW1vdW50ID0gdG9rZW4uYmFsYW5jZU9mKHBheWVlKTsNCiAgICB1aW50IHRvdGFsU3VwcGx5ID0gdG9rZW4udG90YWxTdXBwbHkoKTsNCiAgICB1aW50IHBlcmNlbnRhZ2UgPSAob3duZWRBbW91bnQgKiBtdWx0aXBsaWVyKSAvIHRvdGFsU3VwcGx5Ow0KICAgIHVpbnQgcGF5b3V0ID0gKHBheW91dFBvb2wgKiBwZXJjZW50YWdlKSAvIG11bHRpcGxpZXI7DQoNCiAgICByZXR1cm4gcGF5b3V0Ow0KICB9DQoNCiAgLyoqDQogICAqIENoZWNrIHRoZSBjb250cmFjdCdzIEVUSCBiYWxhbmNlLg0KICAgKi8NCiAgZnVuY3Rpb24gZXRoQmFsYW5jZSgpIGNvbnN0YW50IHJldHVybnModWludCkgew0KICAgIHJldHVybiB0aGlzLmJhbGFuY2U7DQogIH0NCg0KICAvKioNCiAgICogSW5jb21lIHNob3VsZCBnbyBoZXJlLg0KICAgKi8NCiAgZnVuY3Rpb24gZGVwb3NpdCgpIHBheWFibGUgew0KICAgIG9uRGVwb3NpdChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOw0KICAgIGxpZmV0aW1lRGVwb3NpdHMgKz0gbXNnLnZhbHVlOw0KICAgIGRlcG9zaXRzW21zZy5zZW5kZXJdLnB1c2goRGVwb3NpdCh7IGFtb3VudDogbXNnLnZhbHVlLCBibG9jazogbm93IH0pKTsNCiAgfQ0KDQogIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgIGRlcG9zaXQoKTsNCiAgfQ0KfQ=='