base 64 content
base64crowdsale
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KDQovKioNCiAqIEB0aXRsZSBTYWZlTWF0aA0KICogQGRldiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzIHRoYXQgdGhyb3cgb24gZXJyb3INCiAqLw0KbGlicmFyeSBTYWZlTWF0aCB7DQoJZnVuY3Rpb24gbXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQoJCXVpbnQgYyA9IGEgKiBiOw0KCQlhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KCQlyZXR1cm4gYzsNCgl9DQoJZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KCQlhc3NlcnQoYiA8PSBhKTsNCgkJcmV0dXJuIGEgLSBiOw0KCX0NCglmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCgkJYXNzZXJ0KGIgPiAwKTsNCgkJdWludCBjID0gYSAvIGI7DQoJCWFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOw0KCQlyZXR1cm4gYzsNCgl9DQoJZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQoJCWFzc2VydChiIDw9IGEpOw0KCQlyZXR1cm4gYSAtIGI7DQoJfQ0KCWZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KCQl1aW50IGMgPSBhICsgYjsNCgkJYXNzZXJ0KGMgPj0gYSk7DQoJCXJldHVybiBjOw0KCX0NCglmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KCQlyZXR1cm4gYSA+PSBiID8gYSA6IGI7DQoJfQ0KCWZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQoJCXJldHVybiBhIDwgYiA/IGEgOiBiOw0KCX0NCglmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCgkJcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KCX0NCglmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCgkJcmV0dXJuIGEgPCBiID8gYSA6IGI7DQoJfQ0KCWZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KCQlpZiAoIWFzc2VydGlvbikgew0KCQkJdGhyb3c7DQoJCX0NCgl9DQp9DQoNCg0KLyoqDQogKiBAdGl0bGUgT3duYWJsZQ0KICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbA0KICogZnVuY3Rpb25zLCB0aGlzIHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIG9mICJ1c2VyIHBlcm1pc3Npb25zIi4NCiAqLw0KY29udHJhY3QgT3duYWJsZSB7DQogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQogICAgZnVuY3Rpb24gT3duYWJsZSgpIHsNCiAgICAgICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICAgIH0NCiAgICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSB7DQogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIFBhdXNhYmxlDQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQogKi8NCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgew0KCWJvb2wgcHVibGljIHN0b3BwZWQ7DQoJbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsNCgkJaWYgKHN0b3BwZWQpIHsNCgkJCXRocm93Ow0KCQl9DQoJCV87DQoJfQ0KDQoJbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsNCgkJaWYgKCFzdG9wcGVkKSB7DQoJCSAgdGhyb3c7DQoJCX0NCglfOw0KCX0NCgkvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQ0KCWZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgew0KCQlzdG9wcGVkID0gdHJ1ZTsNCgl9DQoJLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbmQgb2YgZW1lcmdlbmN5LCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQ0KCWZ1bmN0aW9uIHJlbGVhc2UoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsNCgkJc3RvcHBlZCA9IGZhbHNlOw0KCX0NCn0NCg0KLyoqDQogKiBAdGl0bGUgRVJDMjBCYXNpYw0KICogQGRldiBTaW1wbGVyIHZlcnNpb24gb2YgRVJDMjAgaW50ZXJmYWNlDQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMTc5DQogKi8NCmNvbnRyYWN0IEVSQzIwQmFzaWMgew0KCXVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoJZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7DQoJZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQp9DQoNCg0KLyoqDQogKiBAdGl0bGUgRVJDMjAgaW50ZXJmYWNlDQogKiBAZGV2IHNlZSBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCiAqLw0KY29udHJhY3QgRVJDMjAgaXMgRVJDMjBCYXNpYyB7DQoJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7DQoJZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KCWV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIEJhc2ljIHRva2VuDQogKiBAZGV2IEJhc2ljIHZlcnNpb24gb2YgU3RhbmRhcmRUb2tlbiwgd2l0aCBubyBhbGxvd2FuY2VzLiANCiAqLw0KY29udHJhY3QgQmFzaWNUb2tlbiBpcyBFUkMyMEJhc2ljIHsNCiAgDQoJdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7DQoNCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgYmFsYW5jZXM7DQoNCgkvKg0KCSogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIA0KCSovDQoJbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgew0KCSAgIGlmKG1zZy5kYXRhLmxlbmd0aCA8IHNpemUgKyA0KSB7DQoJICAgICB0aHJvdzsNCgkgICB9DQoJIF87DQoJfQ0KCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgew0KCQliYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOw0KCQliYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsNCgkJVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KCX0NCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSkgew0KCQlyZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCgl9DQp9DQoNCg0KLyoqDQogKiBAdGl0bGUgU3RhbmRhcmQgRVJDMjAgdG9rZW4NCiAqDQogKiBAZGV2IEltcGxlbWVudGF0aW9uIG9mIHRoZSBiYXNpYyBzdGFuZGFyZCB0b2tlbi4NCiAqIEBkZXYgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwDQogKiBAZGV2IEJhc2VkIG9uIGNvZGUgYnkgRmlyc3RCbG9vZDogaHR0cHM6Ly9naXRodWIuY29tL0ZpcnN0Ymxvb2Rpby90b2tlbi9ibG9iL21hc3Rlci9zbWFydF9jb250cmFjdC9GaXJzdEJsb29kVG9rZW4uc29sDQogKi8NCmNvbnRyYWN0IFN0YW5kYXJkVG9rZW4gaXMgQmFzaWNUb2tlbiwgRVJDMjAgew0KCW1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCglmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSB7DQoJCXZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQoJCWJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KCQliYWxhbmNlc1tfZnJvbV0gPSBiYWxhbmNlc1tfZnJvbV0uc3ViKF92YWx1ZSk7DQoJCWFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsNCgkJVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICB9DQoJZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF92YWx1ZSkgew0KCQlpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHRocm93Ow0KCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCgkJQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQoJfQ0KCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsNCgkJcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQoJfQ0KfQ0KDQoNCi8qKg0KICogIFJlc2lsaXVtIHRva2VuIGNvbnRyYWN0LiBJbXBsZW1lbnRzDQogKi8NCmNvbnRyYWN0IFJlc2lsaXVtIGlzIFN0YW5kYXJkVG9rZW4sIE93bmFibGUgew0KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUmVzaWxpdW0iOw0KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJSRVMiOw0KICB1aW50IHB1YmxpYyBjb25zdGFudCBkZWNpbWFscyA9IDY7DQoNCg0KICAvLyBDb25zdHJ1Y3Rvcg0KICBmdW5jdGlvbiBSZXNpbGl1bSgpIHsNCiAgICAgIHRvdGFsU3VwcGx5ID0gMTAwMDAwMDAwMDAwMDAwMDsNCiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7IC8vIFNlbmQgYWxsIHRva2VucyB0byBvd25lcg0KICB9DQoNCiAgLyoqDQogICAqICBCdXJuIGF3YXkgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zDQogICAqLw0KICBmdW5jdGlvbiBidXJuKHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgew0KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7DQogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIFB1bGxQYXltZW50DQogKiBAZGV2IEJhc2UgY29udHJhY3Qgc3VwcG9ydGluZyBhc3luYyBzZW5kIGZvciBwdWxsIHBheW1lbnRzLiBJbmhlcml0IGZyb20gdGhpcw0KICogY29udHJhY3QgYW5kIHVzZSBhc3luY1NlbmQgaW5zdGVhZCBvZiBzZW5kLg0KICovDQpjb250cmFjdCBQdWxsUGF5bWVudCB7DQoJdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7DQoNCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHBheW1lbnRzOw0KCWV2ZW50IExvZ1JlZnVuZEVUSChhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCgkvKioNCgkqICBTdG9yZSBzZW50IGFtb3VudCBhcyBjcmVkaXQgdG8gYmUgcHVsbGVkLCBjYWxsZWQgYnkgcGF5ZXIgDQoJKiovDQoJZnVuY3Rpb24gYXN5bmNTZW5kKGFkZHJlc3MgZGVzdCwgdWludCBhbW91bnQpIGludGVybmFsIHsNCgkJcGF5bWVudHNbZGVzdF0gPSBwYXltZW50c1tkZXN0XS5hZGQoYW1vdW50KTsNCgl9DQoJLy8gd2l0aGRyYXcgYWNjdW11bGF0ZWQgYmFsYW5jZSwgY2FsbGVkIGJ5IHBheWVlDQoJZnVuY3Rpb24gd2l0aGRyYXdQYXltZW50cygpIHsNCgkJYWRkcmVzcyBwYXllZSA9IG1zZy5zZW5kZXI7DQoJCXVpbnQgcGF5bWVudCA9IHBheW1lbnRzW3BheWVlXTsNCg0KCQlpZiAocGF5bWVudCA9PSAwKSB7DQoJCQl0aHJvdzsNCgkJfQ0KCQlpZiAodGhpcy5iYWxhbmNlIDwgcGF5bWVudCkgew0KCQkgICAgdGhyb3c7DQoJCX0NCgkJcGF5bWVudHNbcGF5ZWVdID0gMDsNCgkJaWYgKCFwYXllZS5zZW5kKHBheW1lbnQpKSB7DQoJCSAgICB0aHJvdzsNCgkJfQ0KCQlMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7DQoJfQ0KfQ0KDQoNCi8qDQogIENyb3dkc2FsZSBTbWFydCBDb250cmFjdCBmb3IgdGhlIHNraW5jb2luLm9yZyBwcm9qZWN0DQogIFRoaXMgc21hcnQgY29udHJhY3QgY29sbGVjdHMgRVRILCBhbmQgaW4gcmV0dXJuIGVtaXRzIFJlc2lsaXVtIHRva2VucyB0byB0aGUgYmFja2Vycw0KKi8NCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgUHVsbFBheW1lbnQgew0KICAgIA0KICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50Ow0KDQogIAlzdHJ1Y3QgQmFja2VyIHsNCgkJdWludCB3ZWlSZWNlaXZlZDsgLy8gQW1vdW50IG9mIEV0aGVyIGdpdmVuDQoJCXVpbnQgY29pblNlbnQ7DQoJfQ0KDQoJLyoNCgkqIENvbnN0YW50cw0KCSovDQoJLyogTWluaW11bSBudW1iZXIgb2YgUmVzaWxpdW0gdG8gc2VsbCAqLw0KCXVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DQVAgPSAxMDAwMDAwMDAwMDsgLy8gMTAuMDAwIFJlc2lsaXVtcw0KCS8qIE1heGltdW0gbnVtYmVyIG9mIFJlc2lsaXVtIHRvIHNlbGwgKi8NCgl1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gMTAwMDAwMDAwMDAwOyAvLyAxMDAwMDAgUmVzaWxpdW1zDQoJLyogTWluaW11bSBhbW91bnQgdG8gaW52ZXN0ICovDQoJdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lOVkVTVF9FVEhFUiA9IDEwMCBmaW5uZXk7DQoJLyogQ3Jvd2RzYWxlIHBlcmlvZCAqLw0KCXVpbnQgcHJpdmF0ZSBjb25zdGFudCBDUk9XRFNBTEVfUEVSSU9EID0gMzAgZGF5czsNCgkvKiBOdW1iZXIgb2YgUmVzaWxpdW1zIHBlciBFdGhlciAqLw0KCXVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSID0gMTAwMDAwMDAwMDsgLy8gMSwwMDAgUmVzaWxpdW1zDQoNCg0KCS8qDQoJKiBWYXJpYWJsZXMNCgkqLw0KCS8qIFJlc2lsaXVtIGNvbnRyYWN0IHJlZmVyZW5jZSAqLw0KCVJlc2lsaXVtIHB1YmxpYyBjb2luOw0KICAgIC8qIE11bHRpc2lnIGNvbnRyYWN0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFdGhlciAqLw0KCWFkZHJlc3MgcHVibGljIG11bHRpc2lnRXRoZXI7DQoJLyogTnVtYmVyIG9mIEV0aGVyIHJlY2VpdmVkICovDQoJdWludCBwdWJsaWMgZXRoZXJSZWNlaXZlZDsNCgkvKiBOdW1iZXIgb2YgUmVzaWxpdW1zIHNlbnQgdG8gRXRoZXIgY29udHJpYnV0b3JzICovDQoJdWludCBwdWJsaWMgY29pblNlbnRUb0V0aGVyOw0KCS8qIENyb3dkc2FsZSBzdGFydCB0aW1lICovDQoJdWludCBwdWJsaWMgc3RhcnRUaW1lOw0KCS8qIENyb3dkc2FsZSBlbmQgdGltZSAqLw0KCXVpbnQgcHVibGljIGVuZFRpbWU7DQogCS8qIElzIGNyb3dkc2FsZSBzdGlsbCBvbiBnb2luZyAqLw0KCWJvb2wgcHVibGljIGNyb3dkc2FsZUNsb3NlZDsNCg0KCS8qIEJhY2tlcnMgRXRoZXIgaW5kZXhlZCBieSB0aGVpciBFdGhlcmV1bSBhZGRyZXNzICovDQoJbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7DQoNCg0KCS8qDQoJKiBNb2RpZmllcnMNCgkqLw0KCW1vZGlmaWVyIG1pbkNhcE5vdFJlYWNoZWQoKSB7DQoJCWlmICgobm93IDwgZW5kVGltZSkgfHwgY29pblNlbnRUb0V0aGVyID49IE1JTl9DQVAgKSB0aHJvdzsNCgkJXzsNCgl9DQoNCgltb2RpZmllciByZXNwZWN0VGltZUZyYW1lKCkgew0KCQlpZiAoKG5vdyA8IHN0YXJ0VGltZSkgfHwgKG5vdyA+IGVuZFRpbWUgKSkgdGhyb3c7DQoJCV87DQoJfQ0KDQoJLyoNCgkgKiBFdmVudA0KCSovDQoJZXZlbnQgTG9nUmVjZWl2ZWRFVEgoYWRkcmVzcyBhZGRyLCB1aW50IHZhbHVlKTsNCglldmVudCBMb2dDb2luc0VtaXRlZChhZGRyZXNzIGluZGV4ZWQgZnJvbSwgdWludCBhbW91bnQpOw0KDQoJLyoNCgkgKiBDb25zdHJ1Y3Rvcg0KCSovDQoJZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuQWRkcmVzcywgYWRkcmVzcyBfdG8pIHsNCgkJY29pbiA9IFJlc2lsaXVtKF90b2tlbkFkZHJlc3MpOw0KCQltdWx0aXNpZ0V0aGVyID0gX3RvOw0KCX0NCg0KCS8qIA0KCSAqIFRoZSBmYWxsYmFjayBmdW5jdGlvbiBjb3JyZXNwb25kcyB0byBhIGRvbmF0aW9uIGluIEVUSA0KCSAqLw0KCWZ1bmN0aW9uKCkgc3RvcEluRW1lcmdlbmN5IHJlc3BlY3RUaW1lRnJhbWUgcGF5YWJsZSB7DQoJCXJlY2VpdmVFVEgobXNnLnNlbmRlcik7DQoJfQ0KDQoJLyogDQoJICogVG8gY2FsbCB0byBzdGFydCB0aGUgY3Jvd2RzYWxlDQoJICovDQoJZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgew0KCQlpZiAoc3RhcnRUaW1lICE9IDApIHRocm93OyAvLyBDcm93ZHNhbGUgd2FzIGFscmVhZHkgc3RhcnRlZA0KDQoJCXN0YXJ0VGltZSA9IG5vdyA7ICAgICAgICAgICAgDQoJCWVuZFRpbWUgPSAgbm93ICsgQ1JPV0RTQUxFX1BFUklPRDsgICAgDQoJfQ0KDQoJLyoNCgkgKglSZWNlaXZlcyBhIGRvbmF0aW9uIGluIEV0aGVyDQoJKi8NCglmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsNCgkJaWYgKG1zZy52YWx1ZSA8IE1JTl9JTlZFU1RfRVRIRVIpIHRocm93OyAvLyBEb24ndCBhY2NlcHQgZnVuZGluZyB1bmRlciBhIHByZWRlZmluZWQgdGhyZXNob2xkDQoJCQ0KCQl1aW50IGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSKS5kaXYoMSBldGhlcikpOyAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgUmVzaWxpdW0gdG8gc2VuZA0KCQlpZiAoY29pblRvU2VuZC5hZGQoY29pblNlbnRUb0V0aGVyKSA+IE1BWF9DQVApIHRocm93OwkNCg0KCQlCYWNrZXIgYmFja2VyID0gYmFja2Vyc1tiZW5lZmljaWFyeV07DQoJCWNvaW4udHJhbnNmZXIoYmVuZWZpY2lhcnksIGNvaW5Ub1NlbmQpOyAvLyBUcmFuc2ZlciBSZXNpbGl1bXMgcmlnaHQgbm93IA0KDQoJCWJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQoY29pblRvU2VuZCk7DQoJCWJhY2tlci53ZWlSZWNlaXZlZCA9IGJhY2tlci53ZWlSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nIGZvciB0aGlzIGJhY2tlciAgICANCg0KCQlldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nDQoJCWNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQoY29pblRvU2VuZCk7DQoNCgkJLy8gU2VuZCBldmVudHMNCgkJTG9nQ29pbnNFbWl0ZWQobXNnLnNlbmRlciAsY29pblRvU2VuZCk7DQoJCUxvZ1JlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LCBldGhlclJlY2VpdmVkKTsgDQoJfQ0KCQ0KDQoJLyoNCgkgKkNvbXB1dGUgdGhlIFJlc2lsaXVtIGJvbnVzIGFjY29yZGluZyB0byB0aGUgaW52ZXN0bWVudCBwZXJpb2QNCgkgKi8NCglmdW5jdGlvbiBib251cyh1aW50IGFtb3VudCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KCQlyZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDIpKTsgLy8gQm9udXMgcHJlLWljbyA1MCUNCgl9DQoNCgkvKgkNCgkgKiBGaW5hbGl6ZSB0aGUgY3Jvd2RzYWxlLCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoZSByZWZ1bmQgcGVyaW9kDQoJKi8NCglmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciBwdWJsaWMgew0KDQoJCWlmIChub3cgPCBlbmRUaW1lKSB7IC8vIENhbm5vdCBmaW5hbGlzZSBiZWZvcmUgQ1JPV0RTQUxFX1BFUklPRCBvciBiZWZvcmUgc2VsbGluZyBhbGwgY29pbnMNCgkJCWlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgew0KCQkJfSBlbHNlIHsNCgkJCQl0aHJvdzsNCgkJCX0NCgkJfQ0KDQoJCWlmIChjb2luU2VudFRvRXRoZXIgPCBNSU5fQ0FQICYmIG5vdyA8IGVuZFRpbWUgKyAxNSBkYXlzKSB0aHJvdzsgLy8gSWYgTUlOX0NBUCBpcyBub3QgcmVhY2hlZCBkb25vcnMgaGF2ZSAxNWRheXMgdG8gZ2V0IHJlZnVuZCBiZWZvcmUgd2UgY2FuIGZpbmFsaXNlDQoNCgkJaWYgKCFtdWx0aXNpZ0V0aGVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7IC8vIE1vdmUgdGhlIHJlbWFpbmluZyBFdGhlciB0byB0aGUgbXVsdGlzaWcgYWRkcmVzcw0KCQkNCgkJdWludCByZW1haW5zID0gY29pbi5iYWxhbmNlT2YodGhpcyk7DQoJCWlmIChyZW1haW5zID4gMCkgeyAvLyBCdXJuIHRoZSByZXN0IG9mIFJlc2lsaXVtcw0KCQkJaWYgKCFjb2luLmJ1cm4ocmVtYWlucykpIHRocm93IDsNCgkJfQ0KCQljcm93ZHNhbGVDbG9zZWQgPSB0cnVlOw0KCX0NCg0KCS8qCQ0KCSogRmFpbHNhZmUgZHJhaW4NCgkqLw0KCWZ1bmN0aW9uIGRyYWluKCkgb25seU93bmVyIHsNCgkJaWYgKCFvd25lci5zZW5kKHRoaXMuYmFsYW5jZSkpIHRocm93Ow0KCX0NCg0KCS8qKg0KCSAqIEFsbG93IHRvIGNoYW5nZSB0aGUgdGVhbSBtdWx0aXNpZyBhZGRyZXNzIGluIHRoZSBjYXNlIG9mIGVtZXJnZW5jeS4NCgkgKi8NCglmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIG9ubHlPd25lciBwdWJsaWMgew0KCQlpZiAoYWRkciA9PSBhZGRyZXNzKDApKSB0aHJvdzsNCgkJbXVsdGlzaWdFdGhlciA9IGFkZHI7DQoJfQ0KDQoJLyoqDQoJICogTWFudWFsbHkgYmFjayBSZXNpbGl1bSBvd25lciBhZGRyZXNzLg0KCSAqLw0KCWZ1bmN0aW9uIGJhY2tSZXNpbGl1bU93bmVyKCkgb25seU93bmVyIHB1YmxpYyB7DQoJCWNvaW4udHJhbnNmZXJPd25lcnNoaXAob3duZXIpOw0KCX0NCg0KCS8qKg0KCSAqIFRyYW5zZmVyIHJlbWFpbnMgdG8gb3duZXIgaW4gY2FzZSBpZiBpbXBvc3NpYmxlIHRvIGRvIG1pbiBpbnZlc3QNCgkgKi8NCglmdW5jdGlvbiBnZXRSZW1haW5Db2lucygpIG9ubHlPd25lciBwdWJsaWMgew0KCQl2YXIgcmVtYWlucyA9IE1BWF9DQVAgLSBjb2luU2VudFRvRXRoZXI7DQoJCXVpbnQgbWluQ29pbnNUb1NlbGwgPSBib251cyhNSU5fSU5WRVNUX0VUSEVSLm11bChDT0lOX1BFUl9FVEhFUikgLyAoMSBldGhlcikpOw0KDQoJCWlmKHJlbWFpbnMgPiBtaW5Db2luc1RvU2VsbCkgdGhyb3c7DQoNCgkJQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbb3duZXJdOw0KCQljb2luLnRyYW5zZmVyKG93bmVyLCByZW1haW5zKTsgLy8gVHJhbnNmZXIgUmVzaWxpdW1zIHJpZ2h0IG5vdyANCg0KCQliYWNrZXIuY29pblNlbnQgPSBiYWNrZXIuY29pblNlbnQuYWRkKHJlbWFpbnMpOw0KDQoJCWNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQocmVtYWlucyk7DQoNCgkJLy8gU2VuZCBldmVudHMNCgkJTG9nQ29pbnNFbWl0ZWQodGhpcyAscmVtYWlucyk7DQoJCUxvZ1JlY2VpdmVkRVRIKG93bmVyLCBldGhlclJlY2VpdmVkKTsgDQoJfQ0KDQoNCgkvKiANCiAgCSAqIFdoZW4gTUlOX0NBUCBpcyBub3QgcmVhY2g6DQogIAkgKiAxKSBiYWNrZXIgY2FsbCB0aGUgImFwcHJvdmUiIGZ1bmN0aW9uIG9mIHRoZSBSZXNpbGl1bSB0b2tlbiBjb250cmFjdCB3aXRoIHRoZSBhbW91bnQgb2YgYWxsIFJlc2lsaXVtcyB0aGV5IGdvdCBpbiBvcmRlciB0byBiZSByZWZ1bmQNCiAgCSAqIDIpIGJhY2tlciBjYWxsIHRoZSAicmVmdW5kIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHdpdGggdGhlIHNhbWUgYW1vdW50IG9mIFJlc2lsaXVtcw0KICAgCSAqIDMpIGJhY2tlciBjYWxsIHRoZSAid2l0aGRyYXdQYXltZW50cyIgZnVuY3Rpb24gb2YgdGhlIENyb3dkc2FsZSBjb250cmFjdCB0byBnZXQgYSByZWZ1bmQgaW4gRVRIDQogICAJICovDQoJZnVuY3Rpb24gcmVmdW5kKHVpbnQgX3ZhbHVlKSBtaW5DYXBOb3RSZWFjaGVkIHB1YmxpYyB7DQoJCQ0KCQlpZiAoX3ZhbHVlICE9IGJhY2tlcnNbbXNnLnNlbmRlcl0uY29pblNlbnQpIHRocm93OyAvLyBjb21wYXJlIHZhbHVlIGZyb20gYmFja2VyIGJhbGFuY2UNCg0KCQljb2luLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpOyAvLyBnZXQgdGhlIHRva2VuIGJhY2sgdG8gdGhlIGNyb3dkc2FsZSBjb250cmFjdA0KDQoJCWlmICghY29pbi5idXJuKF92YWx1ZSkpIHRocm93IDsgLy8gdG9rZW4gc2VudCBmb3IgcmVmdW5kIGFyZSBidXJudA0KDQoJCXVpbnQgRVRIVG9TZW5kID0gYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZDsNCgkJYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZD0wOw0KDQoJCWlmIChFVEhUb1NlbmQgPiAwKSB7DQoJCQlhc3luY1NlbmQobXNnLnNlbmRlciwgRVRIVG9TZW5kKTsgLy8gcHVsbCBwYXltZW50IHRvIGdldCByZWZ1bmQgaW4gRVRIDQoJCX0NCgl9DQoNCn0='