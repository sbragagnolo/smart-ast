base 64 content
base64crowdsale16
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBFUkMyMCB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCg0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQoNCmNvbnRyYWN0IE93bmFibGUgew0KICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCg0KICBmdW5jdGlvbiBPd25hYmxlKCkgew0KICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsNCiAgICBpZiAobXNnLnNlbmRlciA9PSBvd25lcikNCiAgICAgIF87DQogIH0NCg0KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgew0KICAgIGlmIChuZXdPd25lciAhPSBhZGRyZXNzKDApKSBvd25lciA9IG5ld093bmVyOw0KICB9DQoNCn0NCg0KY29udHJhY3QgVG9rZW5TcGVuZGVyIHsNCiAgICBmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKTsNCn0NCg0KY29udHJhY3QgU2FmZU1hdGggew0KICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSAqIGI7DQogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICBhc3NlcnQoYiA+IDApOw0KICAgIHVpbnQgYyA9IGEgLyBiOw0KICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7DQogICAgaWYgKCFhc3NlcnRpb24pIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgfQ0KfQ0KDQpjb250cmFjdCBQdWxsUGF5bWVudCB7DQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcGF5bWVudHM7DQogIGV2ZW50IFJlZnVuZEVUSChhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCiAgLy8gc3RvcmUgc2VudCBhbW91bnQgYXMgY3JlZGl0IHRvIGJlIHB1bGxlZCwgY2FsbGVkIGJ5IHBheWVyDQogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7DQogICAgcGF5bWVudHNbZGVzdF0gKz0gYW1vdW50Ow0KICB9DQoNCiAgLy8gd2l0aGRyYXcgYWNjdW11bGF0ZWQgYmFsYW5jZSwgY2FsbGVkIGJ5IHBheWVlDQogIGZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudHMoKSB7DQogICAgYWRkcmVzcyBwYXllZSA9IG1zZy5zZW5kZXI7DQogICAgdWludCBwYXltZW50ID0gcGF5bWVudHNbcGF5ZWVdOw0KICAgIA0KICAgIGlmIChwYXltZW50ID09IDApIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCg0KICAgIGlmICh0aGlzLmJhbGFuY2UgPCBwYXltZW50KSB7DQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBwYXltZW50c1twYXllZV0gPSAwOw0KDQogICAgaWYgKCFwYXllZS5zZW5kKHBheW1lbnQpKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgUmVmdW5kRVRIKHBheWVlLHBheW1lbnQpOw0KICB9DQp9DQoNCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgew0KICBib29sIHB1YmxpYyBzdG9wcGVkOw0KDQogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7DQogICAgaWYgKHN0b3BwZWQpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQogIA0KICBtb2RpZmllciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIGlmICghc3RvcHBlZCkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KICAgIF87DQogIH0NCg0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQ0KICBmdW5jdGlvbiBlbWVyZ2VuY3lTdG9wKCkgZXh0ZXJuYWwgb25seU93bmVyIHsNCiAgICBzdG9wcGVkID0gdHJ1ZTsNCiAgfQ0KDQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUNCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIHN0b3BwZWQgPSBmYWxzZTsNCiAgfQ0KDQp9DQoNCg0KY29udHJhY3QgUkxDIGlzIEVSQzIwLCBTYWZlTWF0aCwgT3duYWJsZSB7DQoNCiAgICAvKiBQdWJsaWMgdmFyaWFibGVzIG9mIHRoZSB0b2tlbiAqLw0KICBzdHJpbmcgcHVibGljIG5hbWU7ICAgICAgIC8vZmFuY3kgbmFtZQ0KICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCiAgdWludDggcHVibGljIGRlY2ltYWxzOyAgICAvL0hvdyBtYW55IGRlY2ltYWxzIHRvIHNob3cuDQogIHN0cmluZyBwdWJsaWMgdmVyc2lvbiA9ICd2MC4xJzsgDQogIHVpbnQgcHVibGljIGluaXRpYWxTdXBwbHk7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBib29sIHB1YmxpYyBsb2NrZWQ7DQogIC8vdWludCBwdWJsaWMgdW5sb2NrQmxvY2s7DQoNCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIGFsbG93ZWQ7DQoNCiAgLy8gbG9jayB0cmFuc2ZlciBkdXJpbmcgdGhlIElDTw0KICBtb2RpZmllciBvbmx5VW5sb2NrZWQoKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbG9ja2VkKSB0aHJvdzsNCiAgICBfOw0KICB9DQoNCiAgLyoNCiAgICogIFRoZSBSTEMgVG9rZW4gY3JlYXRlZCB3aXRoIHRoZSB0aW1lIGF0IHdoaWNoIHRoZSBjcm93ZHNhbGUgZW5kDQogICAqLw0KDQogIGZ1bmN0aW9uIFJMQygpIHsNCiAgICAvLyBsb2NrIHRoZSB0cmFuc2ZlciBmdW5jdGlvbiBkdXJpbmcgdGhlIGNyb3dkc2FsZQ0KICAgIGxvY2tlZCA9IHRydWU7DQogICAgLy91bmxvY2tCbG9jaz0gIG5vdyArIDQ1IGRheXM7IC8vICh0ZXN0bmV0KSAtIGZvciBtYWlubmV0IHB1dCB0aGUgYmxvY2sgbnVtYmVyDQoNCiAgICBpbml0aWFsU3VwcGx5ID0gODcwMDAwMDAwMDAwMDAwMDA7DQogICAgdG90YWxTdXBwbHkgPSBpbml0aWFsU3VwcGx5Ow0KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gaW5pdGlhbFN1cHBseTsvLyBHaXZlIHRoZSBjcmVhdG9yIGFsbCBpbml0aWFsIHRva2VucyAgICAgICAgICAgICAgICAgICAgDQogICAgbmFtZSA9ICdpRXguZWMgTmV0d29yayBUb2tlbic7ICAgICAgICAvLyBTZXQgdGhlIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZXMgICAgIA0KICAgIHN5bWJvbCA9ICdSTEMnOyAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZXMgIA0KICAgIGRlY2ltYWxzID0gOTsgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbW91bnQgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZXMNCiAgfQ0KDQogIGZ1bmN0aW9uIHVubG9jaygpIG9ubHlPd25lciB7DQogICAgbG9ja2VkID0gZmFsc2U7DQogIH0NCg0KICBmdW5jdGlvbiBidXJuKHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sKXsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSkgOw0KICAgIHRvdGFsU3VwcGx5ID0gc2FmZVN1Yih0b3RhbFN1cHBseSwgX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlVbmxvY2tlZCByZXR1cm5zIChib29sKSB7DQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVVubG9ja2VkIHJldHVybnMgKGJvb2wpIHsNCiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOw0KICAgIA0KICAgIGJhbGFuY2VzW190b10gPSBzYWZlQWRkKGJhbGFuY2VzW190b10sIF92YWx1ZSk7DQogICAgYmFsYW5jZXNbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlc1tfZnJvbV0sIF92YWx1ZSk7DQogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKF9hbGxvd2FuY2UsIF92YWx1ZSk7DQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7DQogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogIH0NCg0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAgIC8qIEFwcHJvdmUgYW5kIHRoZW4gY29tdW5pY2F0ZSB0aGUgYXBwcm92ZWQgY29udHJhY3QgaW4gYSBzaW5nbGUgdHggKi8NCiAgZnVuY3Rpb24gYXBwcm92ZUFuZENhbGwoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9leHRyYURhdGEpeyAgICANCiAgICAgIFRva2VuU3BlbmRlciBzcGVuZGVyID0gVG9rZW5TcGVuZGVyKF9zcGVuZGVyKTsNCiAgICAgIGlmIChhcHByb3ZlKF9zcGVuZGVyLCBfdmFsdWUpKSB7DQogICAgICAgICAgc3BlbmRlci5yZWNlaXZlQXBwcm92YWwobXNnLnNlbmRlciwgX3ZhbHVlLCB0aGlzLCBfZXh0cmFEYXRhKTsNCiAgICAgIH0NCiAgfQ0KDQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsNCiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgfQ0KICANCn0NCg0KDQoNCg0KY29udHJhY3QgQ3Jvd2RzYWxlIGlzIFNhZmVNYXRoLCBQdWxsUGF5bWVudCwgUGF1c2FibGUgew0KDQogIAlzdHJ1Y3QgQmFja2VyIHsNCgkJdWludCB3ZWlSZWNlaXZlZDsJLy8gQW1vdW50IG9mIEVUSCBnaXZlbg0KCQlzdHJpbmcgYnRjX2FkZHJlc3M7ICAvL3N0b3JlIHRoZSBidGMgYWRkcmVzcyBmb3IgZnVsbCB0cmFjZWFiaWxpdHkNCgkJdWludCBzYXRvc2hpUmVjZWl2ZWQ7CS8vIEFtb3VudCBvZiBCVEMgZ2l2ZW4NCgkJdWludCBybGNTZW50Ow0KCX0NCg0KCVJMQyAJcHVibGljIHJsYzsgICAgICAgICAvLyBSTEMgY29udHJhY3QgcmVmZXJlbmNlDQoJYWRkcmVzcyBwdWJsaWMgb3duZXI7ICAgICAgIC8vIENvbnRyYWN0IG93bmVyIChpRXguZWMgdGVhbSkNCglhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ0VUSDsgLy8gTXVsdGlzaWcgY29udHJhY3QgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIEVUSA0KCWFkZHJlc3MgcHVibGljIEJUQ3Byb3h5OwkvLyBhZGRyZXNzIG9mIHRoZSBCVEMgUHJveHkNCg0KCXVpbnQgcHVibGljIFJMQ1BlckVUSDsgICAgICAvLyBOdW1iZXIgb2YgUkxDIHBlciBFVEgNCgl1aW50IHB1YmxpYyBSTENQZXJTQVRPU0hJOyAgLy8gTnVtYmVyIG9mIFJMQyBwZXIgU0FUT1NISQ0KCXVpbnQgcHVibGljIEVUSFJlY2VpdmVkOyAgICAvLyBOdW1iZXIgb2YgRVRIIHJlY2VpdmVkDQoJdWludCBwdWJsaWMgQlRDUmVjZWl2ZWQ7ICAgIC8vIE51bWJlciBvZiBCVEMgcmVjZWl2ZWQNCgl1aW50IHB1YmxpYyBSTENTZW50VG9FVEg7ICAgLy8gTnVtYmVyIG9mIFJMQyBzZW50IHRvIEVUSCBjb250cmlidXRvcnMNCgl1aW50IHB1YmxpYyBSTENTZW50VG9CVEM7ICAgLy8gTnVtYmVyIG9mIFJMQyBzZW50IHRvIEJUQyBjb250cmlidXRvcnMNCgl1aW50IHB1YmxpYyBzdGFydEJsb2NrOyAgICAgLy8gQ3Jvd2RzYWxlIHN0YXJ0IGJsb2NrDQoJdWludCBwdWJsaWMgZW5kQmxvY2s7ICAgICAgIC8vIENyb3dkc2FsZSBlbmQgYmxvY2sNCgl1aW50IHB1YmxpYyBtaW5DYXA7ICAgICAgICAgLy8gTWluaW11bSBudW1iZXIgb2YgUkxDIHRvIHNlbGwNCgl1aW50IHB1YmxpYyBtYXhDYXA7ICAgICAgICAgLy8gTWF4aW11bSBudW1iZXIgb2YgUkxDIHRvIHNlbGwNCglib29sIHB1YmxpYyBtYXhDYXBSZWFjaGVkOyAgLy8gTWF4IGNhcCBoYXMgYmVlbiByZWFjaGVkDQoJdWludCBwdWJsaWMgbWluSW52ZXN0RVRIOyAgIC8vIE1pbmltdW0gYW1vdW50IHRvIGludmVzdA0KCXVpbnQgcHVibGljIG1pbkludmVzdEJUQzsgICAvLyBNaW5pbXVtIGFtb3VudCB0byBpbnZlc3QNCglib29sIHB1YmxpYyBjcm93ZHNhbGVDbG9zZWQ7Ly8gSXMgY3Jvd2RzYWxlIHN0aWxsIG9uIGdvaW5nDQoNCglhZGRyZXNzIHB1YmxpYyBib3VudHk7CQkvLyBhZGRyZXNzIGF0IHdoaWNoIHRoZSBib3VudHkgUkxDIHdpbGwgYmUgc2VudA0KCWFkZHJlc3MgcHVibGljIHJlc2VydmU7IAkvLyBhZGRyZXNzIGF0IHdoaWNoIHRoZSBjb250aW5nZW5jeSByZXNlcnZlIHdpbGwgYmUgc2VudA0KCWFkZHJlc3MgcHVibGljIHRlYW07CQkvLyBhZGRyZXNzIGF0IHdoaWNoIHRoZSB0ZWFtIFJMQyB3aWxsIGJlIHNlbnQNCg0KCXVpbnQgcHVibGljIHJsY19ib3VudHk7CQkvLyBhbW91bnQgb2YgYm91bnRpZXMgUkxDDQoJdWludCBwdWJsaWMgcmxjX3Jlc2VydmU7CS8vIGFtb3VudCBvZiB0aGUgY29udGluZ2VuY3kgcmVzZXJ2ZQ0KCXVpbnQgcHVibGljIHJsY190ZWFtOwkJLy8gYW1vdW50IG9mIHRoZSB0ZWFtIFJMQyANCgltYXBwaW5nKGFkZHJlc3MgPT4gQmFja2VyKSBwdWJsaWMgYmFja2VyczsgLy9iYWNrZXJzRVRIIGluZGV4ZWQgYnkgdGhlaXIgRVRIIGFkZHJlc3MNCg0KCW1vZGlmaWVyIG9ubHlCeShhZGRyZXNzIGEpew0KCQlpZiAobXNnLnNlbmRlciAhPSBhKSB0aHJvdzsgIA0KCQlfOw0KCX0NCg0KCW1vZGlmaWVyIG1pbkNhcE5vdFJlYWNoZWQoKSB7DQoJCWlmICgobm93PGVuZEJsb2NrKSB8fCBSTENTZW50VG9FVEggKyBSTENTZW50VG9CVEMgPj0gbWluQ2FwICkgdGhyb3c7DQoJCV87DQoJfQ0KDQoJbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsNCgkJaWYgKChub3cgPCBzdGFydEJsb2NrKSB8fCAobm93ID4gZW5kQmxvY2sgKSkgdGhyb3c7DQoJCV87DQoJfQ0KDQoJLyoNCgkqIEV2ZW50DQoJKi8NCglldmVudCBSZWNlaXZlZEVUSChhZGRyZXNzIGFkZHIsIHVpbnQgdmFsdWUpOw0KCWV2ZW50IFJlY2VpdmVkQlRDKGFkZHJlc3MgYWRkciwgc3RyaW5nIGZyb20sIHVpbnQgdmFsdWUsIHN0cmluZyB0eGlkKTsNCglldmVudCBSZWZ1bmRCVEMoc3RyaW5nIHRvLCB1aW50IHZhbHVlKTsNCglldmVudCBMb2dzKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50IGFtb3VudCwgc3RyaW5nIHZhbHVlKTsNCg0KCS8qDQoJKglDb25zdHJ1Y3Rvcg0KCSovDQoJLy9mdW5jdGlvbiBDcm93ZHNhbGUoKSB7DQoJZnVuY3Rpb24gQ3Jvd2RzYWxlKCkgew0KCQlvd25lciA9IG1zZy5zZW5kZXI7DQoJCUJUQ3Byb3h5ID0gMHg3NWM2Y2NlYjFhMzNmMTc3MzY5MDUzZjhhMGU4NDBkZTk2YjRlZDBlOw0KCQlybGMgPSBSTEMoMHg3RWJCNjA3OUU2ZDZDN0NGOGY1OENEQmQyMzNhQzNFZGFGMWQ5QTYwKTsNCgkJbXVsdGlzaWdFVEggPSAweEFlMzA3ZTM4NzFFNUEzMjFjMDU1OUZCZjAyMzNBMzhjOTM3QjgyNkE7DQoJCXRlYW0gPSAweGQ2NTM4MEQ3NzMyMDhhNkFhNDk0NzJCZjU1MTg2Yjg1NUIzOTMyOTg7DQoJCXJlc2VydmUgPSAweDI0RjZiMzc3NzBDNjA2N0QwNUFDYzJhRDJDNDJkMUJhZmRlOTVkNDg7DQoJCWJvdW50eSA9IDB4ODIyNmEyNGRBMDg3MEZiOEExMjhFNEZjMTUyMjhhOWM0YTViYUMyOTsNCgkJUkxDU2VudFRvRVRIID0gMDsNCgkJUkxDU2VudFRvQlRDID0gMDsNCgkJbWluSW52ZXN0RVRIID0gMSBldGhlcjsNCgkJbWluSW52ZXN0QlRDID0gNTAwMDAwMDsJCQkvLyBhcHByb3ggNTAgVVNEIG9yIDAuMDUwMDAwMDAgQlRDDQoJCXN0YXJ0QmxvY2sgPSAwIDsgICAgICAgICAgICAJLy8gc2hvdWxkIHdhaXQgZm9yIHRoZSBjYWxsIG9mIHRoZSBmdW5jdGlvbiBzdGFydA0KCQllbmRCbG9jayA9ICAwOyAgCQkJCS8vIHNob3VsZCB3YWl0IGZvciB0aGUgY2FsbCBvZiB0aGUgZnVuY3Rpb24gc3RhcnQNCgkJUkxDUGVyRVRIID0gMjAwMDAwMDAwMDAwOwkJLy8gd2lsbCBiZSB1cGRhdGUgZXZlcnkgMTBtaW4gYmFzZWQgb24gdGhlIGtyYWtlbiBFVEhCVEMNCgkJUkxDUGVyU0FUT1NISSA9IDUwMDAwOwkJCS8vIDUwMDAgUkxDIHBhciBCVEMgPT0gNTAsMDAwIFJMQyBwZXIgc2F0b3NoaQ0KCQltaW5DYXA9MTIwMDAwMDAwMDAwMDAwMDA7DQoJCW1heENhcD02MDAwMDAwMDAwMDAwMDAwMDsNCgkJcmxjX2JvdW50eT0xNzAwMDAwMDAwMDAwMDAwOwkvLyBtYXggNjAwMDAwMCBSTEMNCgkJcmxjX3Jlc2VydmU9MTcwMDAwMDAwMDAwMDAwMDsJLy8gbWF4IDYwMDAwMDAgUkxDDQoJCXJsY190ZWFtPTEyMDAwMDAwMDAwMDAwMDAwOw0KCX0NCg0KCS8qIA0KCSAqIFRoZSBmYWxsYmFjayBmdW5jdGlvbiBjb3JyZXNwb25kcyB0byBhIGRvbmF0aW9uIGluIEVUSA0KCSAqLw0KCWZ1bmN0aW9uKCkgcGF5YWJsZSB7DQoJCWlmIChub3cgPiBlbmRCbG9jaykgdGhyb3c7DQoJCXJlY2VpdmVFVEgobXNnLnNlbmRlcik7DQoJfQ0KDQoJLyogDQoJICogVG8gY2FsbCB0byBzdGFydCB0aGUgY3Jvd2RzYWxlDQoJICovDQoJZnVuY3Rpb24gc3RhcnQoKSBvbmx5Qnkob3duZXIpIHsNCgkJc3RhcnRCbG9jayA9IG5vdyA7ICAgICAgICAgICAgDQoJCWVuZEJsb2NrID0gIG5vdyArIDMwIGRheXM7ICAgIA0KCX0NCg0KCS8qDQoJKglSZWNlaXZlcyBhIGRvbmF0aW9uIGluIEVUSA0KCSovDQoJZnVuY3Rpb24gcmVjZWl2ZUVUSChhZGRyZXNzIGJlbmVmaWNpYXJ5KSBpbnRlcm5hbCBzdG9wSW5FbWVyZ2VuY3kgIHJlc3BlY3RUaW1lRnJhbWUgIHsNCgkJaWYgKG1zZy52YWx1ZSA8IG1pbkludmVzdEVUSCkgdGhyb3c7CQkJCQkJCQkvL2Rvbid0IGFjY2VwdCBmdW5kaW5nIHVuZGVyIGEgcHJlZGVmaW5lZCB0aHJlc2hvbGQNCgkJdWludCBybGNUb1NlbmQgPSBib251cyhzYWZlTXVsKG1zZy52YWx1ZSxSTENQZXJFVEgpLygxIGV0aGVyKSk7CQkvL2NvbXB1dGUgdGhlIG51bWJlciBvZiBSTEMgdG8gc2VuZA0KCQlpZiAoc2FmZUFkZChybGNUb1NlbmQsIHNhZmVBZGQoUkxDU2VudFRvRVRILCBSTENTZW50VG9CVEMpKSA+IG1heENhcCkgdGhyb3c7CQ0KDQoJCUJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW2JlbmVmaWNpYXJ5XTsNCgkJaWYgKCFybGMudHJhbnNmZXIoYmVuZWZpY2lhcnksIHJsY1RvU2VuZCkpIHRocm93OyAgICAgCQkJCS8vIERvIHRoZSBSTEMgdHJhbnNmZXIgcmlnaHQgbm93IA0KCQliYWNrZXIucmxjU2VudCA9IHNhZmVBZGQoYmFja2VyLnJsY1NlbnQsIHJsY1RvU2VuZCk7DQoJCWJhY2tlci53ZWlSZWNlaXZlZCA9IHNhZmVBZGQoYmFja2VyLndlaVJlY2VpdmVkLCBtc2cudmFsdWUpOwkJLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nIGZvciB0aGlzIGJhY2tlciAgICANCgkJRVRIUmVjZWl2ZWQgPSBzYWZlQWRkKEVUSFJlY2VpdmVkLCBtc2cudmFsdWUpOwkJCQkJCS8vIFVwZGF0ZSB0aGUgdG90YWwgd2VpIGNvbGxlY3RlZCBkdXJpbmcgdGhlIGNyb3dkZnVuZGluZw0KCQlSTENTZW50VG9FVEggPSBzYWZlQWRkKFJMQ1NlbnRUb0VUSCwgcmxjVG9TZW5kKTsNCg0KCQllbWl0UkxDKHJsY1RvU2VuZCk7CQkJCQkJCQkJCQkJCS8vIGNvbXB1dGUgdGhlIHZhcmlhYmxlIHBhcnQgDQoJCVJlY2VpdmVkRVRIKGJlbmVmaWNpYXJ5LEVUSFJlY2VpdmVkKTsJCQkJCQkJCS8vIHNlbmQgdGhlIGNvcnJlc3BvbmRpbmcgY29udHJpYnV0aW9uIGV2ZW50DQoJfQ0KCQ0KCS8qDQoJKiByZWNlaXZlcyBhIGRvbmF0aW9uIGluIEJUQw0KCSovDQoJZnVuY3Rpb24gcmVjZWl2ZUJUQyhhZGRyZXNzIGJlbmVmaWNpYXJ5LCBzdHJpbmcgYnRjX2FkZHJlc3MsIHVpbnQgdmFsdWUsIHN0cmluZyB0eGlkKSBzdG9wSW5FbWVyZ2VuY3kgcmVzcGVjdFRpbWVGcmFtZSBvbmx5QnkoQlRDcHJveHkpIHJldHVybnMgKGJvb2wgcmVzKXsNCgkJaWYgKHZhbHVlIDwgbWluSW52ZXN0QlRDKSB0aHJvdzsJCQkJCQkJCQkJCS8vIHRoaXMgdmVyaWYgaXMgYWxzbyBtYWRlIG9uIHRoZSBidGNwcm94eQ0KDQoJCXVpbnQgcmxjVG9TZW5kID0gYm9udXMoc2FmZU11bCh2YWx1ZSxSTENQZXJTQVRPU0hJKSk7CQkJCQkJLy9jb21wdXRlIHRoZSBudW1iZXIgb2YgUkxDIHRvIHNlbmQNCgkJaWYgKHNhZmVBZGQocmxjVG9TZW5kLCBzYWZlQWRkKFJMQ1NlbnRUb0VUSCwgUkxDU2VudFRvQlRDKSkgPiBtYXhDYXApIHsJCS8vIGNoZWNrIGlmIHdlIGFyZSBub3QgcmVhY2hpbmcgdGhlIG1heENhcCBieSBhY2NlcHRpbmcgdGhpcyBkb25hdGlvbg0KCQkJUmVmdW5kQlRDKGJ0Y19hZGRyZXNzICwgdmFsdWUpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoNCgkJQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbYmVuZWZpY2lhcnldOw0KCQlpZiAoIXJsYy50cmFuc2ZlcihiZW5lZmljaWFyeSwgcmxjVG9TZW5kKSkgdGhyb3c7CQkJCQkJCS8vIERvIHRoZSB0cmFuc2ZlciByaWdodCBub3cgDQoJCWJhY2tlci5ybGNTZW50ID0gc2FmZUFkZChiYWNrZXIucmxjU2VudCAsIHJsY1RvU2VuZCk7DQoJCWJhY2tlci5idGNfYWRkcmVzcyA9IGJ0Y19hZGRyZXNzOw0KCQliYWNrZXIuc2F0b3NoaVJlY2VpdmVkID0gc2FmZUFkZChiYWNrZXIuc2F0b3NoaVJlY2VpdmVkLCB2YWx1ZSk7DQoJCUJUQ1JlY2VpdmVkID0gIHNhZmVBZGQoQlRDUmVjZWl2ZWQsIHZhbHVlKTsJCQkJCQkJCQkvLyBVcGRhdGUgdGhlIHRvdGFsIHNhdG9zaGkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nIGZvciB0aGlzIGJhY2tlcg0KCQlSTENTZW50VG9CVEMgPSBzYWZlQWRkKFJMQ1NlbnRUb0JUQywgcmxjVG9TZW5kKTsJCQkJCQkJLy8gVXBkYXRlIHRoZSB0b3RhbCBzYXRvc2hpIGNvbGxlY3RlZCBkdXJpbmcgdGhlIGNyb3dkZnVuZGluZw0KCQllbWl0UkxDKHJsY1RvU2VuZCk7DQoJCVJlY2VpdmVkQlRDKGJlbmVmaWNpYXJ5LCBidGNfYWRkcmVzcywgQlRDUmVjZWl2ZWQsIHR4aWQpOw0KCQlyZXR1cm4gdHJ1ZTsNCgl9DQoNCgkvKg0KCSAqQ29tcHV0ZSB0aGUgdmFyaWFibGUgcGFydA0KCSAqLw0KCWZ1bmN0aW9uIGVtaXRSTEModWludCBhbW91bnQpIGludGVybmFsIHsNCgkJcmxjX2JvdW50eSA9IHNhZmVBZGQocmxjX2JvdW50eSwgYW1vdW50LzEwKTsNCgkJcmxjX3RlYW0gPSBzYWZlQWRkKHJsY190ZWFtLCBhbW91bnQvMjApOw0KCQlybGNfcmVzZXJ2ZSA9IHNhZmVBZGQocmxjX3Jlc2VydmUsIGFtb3VudC8xMCk7DQoJCUxvZ3MobXNnLnNlbmRlciAsYW1vdW50LCAiZW1pdFJMQyIpOw0KCX0NCg0KCS8qDQoJICpDb21wdXRlIHRoZSBSTEMgYm9udXMgYWNjb3JkaW5nIHRvIHRoZSBpbnZlc3RtZW50IHBlcmlvZA0KCSAqLw0KCWZ1bmN0aW9uIGJvbnVzKHVpbnQgYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQoJCWlmIChub3cgPCBzYWZlQWRkKHN0YXJ0QmxvY2ssIDEwIGRheXMpKSByZXR1cm4gKHNhZmVBZGQoYW1vdW50LCBhbW91bnQvNSkpOyAgIC8vIGJvbnVzIDIwJQ0KCQlpZiAobm93IDwgc2FmZUFkZChzdGFydEJsb2NrLCAyMCBkYXlzKSkgcmV0dXJuIChzYWZlQWRkKGFtb3VudCwgYW1vdW50LzEwKSk7ICAvLyBib251cyAxMCUNCgkJcmV0dXJuIGFtb3VudDsNCgl9DQoNCgkvKiANCgkgKiBXaGVuIG1pbmNhcCBpcyBub3QgcmVhY2ggYmFja2VyIGNhbiBjYWxsIHRoZSBhcHByb3ZlQW5kQ2FsbCBmdW5jdGlvbiBvZiB0aGUgUkxDIHRva2VuIGNvbnRyYWN0DQoJICogd2l0aCB0aGlzIGNyb3dkc2FsZSBjb250cmFjdCBvbiBwYXJhbWV0ZXIgd2l0aCBhbGwgdGhlIFJMQyB0aGV5IGdldCBpbiBvcmRlciB0byBiZSByZWZ1bmQNCgkgKi8NCglmdW5jdGlvbiByZWNlaXZlQXBwcm92YWwoYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUsIGFkZHJlc3MgX3Rva2VuLCBieXRlcyBfZXh0cmFEYXRhKSBtaW5DYXBOb3RSZWFjaGVkIHB1YmxpYyB7DQoJCWlmIChtc2cuc2VuZGVyICE9IGFkZHJlc3MocmxjKSkgdGhyb3c7IA0KCQlpZiAoX2V4dHJhRGF0YS5sZW5ndGggIT0gMCkgdGhyb3c7CQkJCQkJCQkvLyBubyBleHRyYWRhdGEgbmVlZGVkDQoJCWlmIChfdmFsdWUgIT0gYmFja2Vyc1tfZnJvbV0ucmxjU2VudCkgdGhyb3c7CQkJCQkvLyBjb21wYXJlIHZhbHVlIGZyb20gYmFja2VyIGJhbGFuY2UNCgkJaWYgKCFybGMudHJhbnNmZXJGcm9tKF9mcm9tLCBhZGRyZXNzKHRoaXMpLCBfdmFsdWUpKSB0aHJvdyA7CS8vIGdldCB0aGUgdG9rZW4gYmFjayB0byB0aGUgY3Jvd2RzYWxlIGNvbnRyYWN0DQoJCWlmICghcmxjLmJ1cm4oX3ZhbHVlKSkgdGhyb3cgOwkJCQkJCQkJCS8vIHRva2VuIHNlbnQgZm9yIHJlZnVuZCBhcmUgYnVybnQNCgkJdWludCBFVEhUb1NlbmQgPSBiYWNrZXJzW19mcm9tXS53ZWlSZWNlaXZlZDsNCgkJYmFja2Vyc1tfZnJvbV0ud2VpUmVjZWl2ZWQ9MDsNCgkJdWludCBCVENUb1NlbmQgPSBiYWNrZXJzW19mcm9tXS5zYXRvc2hpUmVjZWl2ZWQ7DQoJCWJhY2tlcnNbX2Zyb21dLnNhdG9zaGlSZWNlaXZlZCA9IDA7DQoJCWlmIChFVEhUb1NlbmQgPiAwKSB7DQoJCQlhc3luY1NlbmQoX2Zyb20sRVRIVG9TZW5kKTsJCQkJCQkJCQkvLyBwdWxsIHBheW1lbnQgdG8gZ2V0IHJlZnVuZCBpbiBFVEgNCgkJfQ0KCQlpZiAoQlRDVG9TZW5kID4gMCkNCgkJCVJlZnVuZEJUQyhiYWNrZXJzW19mcm9tXS5idGNfYWRkcmVzcyAsQlRDVG9TZW5kKTsJCQkvLyBldmVudCBtZXNzYWdlIHRvIG1hbnVhbGx5IHJlZnVuZCBCVEMNCgl9DQoNCgkvKg0KCSogVXBkYXRlIHRoZSByYXRlIFJMQyBwZXIgRVRILCBjb21wdXRlZCBleHRlcm5hbGx5IGJ5IHVzaW5nIHRoZSBFVEhCVEMgaW5kZXggb24ga3Jha2VuIGV2ZXJ5IDEwbWluDQoJKi8NCglmdW5jdGlvbiBzZXRSTENQZXJFVEgodWludCByYXRlKSBvbmx5QnkoQlRDcHJveHkpIHsNCgkJUkxDUGVyRVRIPXJhdGU7DQoJfQ0KCQ0KCS8qCQ0KCSogRmluYWxpemUgdGhlIGNyb3dkc2FsZSwgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGUgcmVmdW5kIHBlcmlvZA0KCSovDQoJZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5Qnkob3duZXIpIHsNCgkJLy8gY2hlY2sNCgkJaWYgKFJMQ1NlbnRUb0VUSCArIFJMQ1NlbnRUb0JUQyA8IG1heENhcCAtIDUwMDAwMDAwMDAwMDAgJiYgbm93IDwgZW5kQmxvY2spIHRocm93OwkvLyBjYW5ub3QgZmluYWxpc2UgYmVmb3JlIDMwIGRheSB1bnRpbCBtYXhjYXAgaXMgcmVhY2hlZCBtaW51cyAxQlRDDQoJCWlmIChSTENTZW50VG9FVEggKyBSTENTZW50VG9CVEMgPCBtaW5DYXAgJiYgbm93IDwgZW5kQmxvY2sgKyAxNSBkYXlzKSB0aHJvdyA7CQkvLyBpZiBtaW5jYXAgaXMgbm90IHJlYWNoZWQgZG9ub3JzIGhhdmUgMTVkYXlzIHRvIGdldCByZWZ1bmQgYmVmb3JlIHdlIGNhbiBmaW5hbGlzZQ0KCQlpZiAoIW11bHRpc2lnRVRILnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7CQkJCQkJCQkJCQkvLyBtb3ZlcyB0aGUgcmVtYWluaW5nIEVUSCB0byB0aGUgbXVsdGlzaWcgYWRkcmVzcw0KCQlpZiAocmxjX3Jlc2VydmUgPiA2MDAwMDAwMDAwMDAwMDAwKXsJCQkJCQkJCQkJCQkvLyBtb3ZlcyBSTEMgdG8gdGhlIHRlYW0sIHJlc2VydmUgYW5kIGJvdW50eSBhZGRyZXNzDQoJCQlpZighcmxjLnRyYW5zZmVyKHJlc2VydmUsNjAwMDAwMDAwMDAwMDAwMCkpIHRocm93OwkJCQkJCQkJLy8gbWF4IGNhcCA2MDAwMDAwUkxDDQoJCQlybGNfcmVzZXJ2ZSA9IDYwMDAwMDAwMDAwMDAwMDA7DQoJCX0gZWxzZSB7DQoJCQlpZighcmxjLnRyYW5zZmVyKHJlc2VydmUscmxjX3Jlc2VydmUpKSB0aHJvdzsgIA0KCQl9DQoJCWlmIChybGNfYm91bnR5ID4gNjAwMDAwMDAwMDAwMDAwMCl7DQoJCQlpZighcmxjLnRyYW5zZmVyKGJvdW50eSw2MDAwMDAwMDAwMDAwMDAwKSkgdGhyb3c7CQkJCQkJCQkvLyBtYXggY2FwIDYwMDAwMDBSTEMNCgkJCXJsY19ib3VudHkgPSA2MDAwMDAwMDAwMDAwMDAwOw0KCQl9IGVsc2Ugew0KCQkJaWYoIXJsYy50cmFuc2Zlcihib3VudHkscmxjX2JvdW50eSkpIHRocm93Ow0KCQl9DQoJCWlmICghcmxjLnRyYW5zZmVyKHRlYW0scmxjX3RlYW0pKSB0aHJvdzsNCgkJdWludCBSTENFbWl0dGVkID0gcmxjX3Jlc2VydmUgKyBybGNfYm91bnR5ICsgcmxjX3RlYW0gKyBSTENTZW50VG9CVEMgKyBSTENTZW50VG9FVEg7DQoJCWlmIChSTENFbWl0dGVkIDwgcmxjLnRvdGFsU3VwcGx5KCkpCQkJCQkJCQkJCQkJCS8vIGJ1cm4gdGhlIHJlc3Qgb2YgUkxDDQoJCQkgIHJsYy5idXJuKHJsYy50b3RhbFN1cHBseSgpIC0gUkxDRW1pdHRlZCk7DQoJCXJsYy51bmxvY2soKTsNCgkJY3Jvd2RzYWxlQ2xvc2VkID0gdHJ1ZTsNCgl9DQoNCgkvKgkNCgkqIEZhaWxzYWZlIGRyYWluDQoJKi8NCglmdW5jdGlvbiBkcmFpbigpIG9ubHlCeShvd25lcikgew0KCQlpZiAoIW93bmVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7DQoJfQ0KfQ=='