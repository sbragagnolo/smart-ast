base 64 content
base64dAS1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KDQovKiBJbnRlcmZhY2Ugb2YgdGhlIEVSQzIyMyB0b2tlbiAqLw0KY29udHJhY3QgRVJDMjIzVG9rZW5JbnRlcmZhY2Ugew0KICAgIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX25hbWUpOw0KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKTsNCiAgICBmdW5jdGlvbiBkZWNpbWFscygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4IF9kZWNpbWFscyk7DQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF9zdXBwbHkpOw0KDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF9iYWxhbmNlKTsNCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgX3N1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF9yZW1haW5pbmcpOw0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIF9zdWNjZXNzKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9tZXRhZGF0YSkgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcyk7DQoNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBtZXRhZGF0YSk7DQp9DQoNCg0KLyogSW50ZXJmYWNlIG9mIHRoZSBjb250cmFjdCB0aGF0IGlzIGdvaW5nIHRvIHJlY2VpdmUgRVJDMjIzIHRva2VucyAqLw0KY29udHJhY3QgRVJDMjIzQ29udHJhY3RJbnRlcmZhY2Ugew0KICAgIGZ1bmN0aW9uIGVyYzIyM0ZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSl7DQogICAgICAgIC8vIHRvIGF2b2lkIHdhcm5pbmdzIGR1cmluZyBjb21waWxhdGlvbg0KICAgICAgICBfZnJvbSA9IF9mcm9tOw0KICAgICAgICBfdmFsdWUgPSBfdmFsdWU7DQogICAgICAgIF9kYXRhID0gX2RhdGE7DQogICAgICAgIC8vIEluY29taW5nIHRyYW5zYWN0aW9uIGNvZGUgaGVyZQ0KICAgICAgICB0aHJvdzsNCiAgICB9DQp9DQoNCg0KLyogaHR0cHM6Ly9naXRodWIuY29tL0x5a2tlQ2l0eS9FdGhlcmV1bUFwaURvdE5ldENvcmUvYmxvYi9tYXN0ZXIvc3JjL0NvbnRyYWN0QnVpbGRlci9jb250cmFjdHMvdG9rZW4vU2FmZU1hdGguc29sICovDQpjb250cmFjdCBTYWZlTWF0aCB7DQogICAgdWludDI1NiBjb25zdGFudCBwdWJsaWMgTUFYX1VJTlQyNTYgPQ0KICAgIDB4RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRjsNCg0KICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICBpZiAoeCA+IE1BWF9VSU5UMjU2IC0geSkgdGhyb3c7DQogICAgICAgIHJldHVybiB4ICsgeTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsNCiAgICAgICAgaWYgKHggPCB5KSB0aHJvdzsNCiAgICAgICAgcmV0dXJuIHggLSB5Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNhZmVNdWwodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICBpZiAoeSA9PSAwKSByZXR1cm4gMDsNCiAgICAgICAgaWYgKHggPiBNQVhfVUlOVDI1NiAvIHkpIHRocm93Ow0KICAgICAgICByZXR1cm4geCAqIHk7DQogICAgfQ0KfQ0KDQoNCmNvbnRyYWN0IEVSQzIyM1Rva2VuIGlzIEVSQzIyM1Rva2VuSW50ZXJmYWNlLCBTYWZlTWF0aCB7DQoNCiAgICAvKg0KICAgICAgU3RvcmFnZSBvZiB0aGUgY29udHJhY3QNCiAgICAqLw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93YW5jZXM7DQoNCiAgICBzdHJpbmcgcHVibGljIG5hbWU7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7DQogICAgdWludDggcHVibGljIGRlY2ltYWxzOw0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KDQoNCiAgICAvKg0KICAgICAgR2V0dGVycw0KICAgICovDQoNCiAgICBmdW5jdGlvbiBuYW1lKCkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9uYW1lKSB7DQogICAgICAgIHJldHVybiBuYW1lOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN5bWJvbCgpIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBfc3ltYm9sKSB7DQogICAgICAgIHJldHVybiBzeW1ib2w7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGVjaW1hbHMoKSBjb25zdGFudCByZXR1cm5zICh1aW50OCBfZGVjaW1hbHMpIHsNCiAgICAgICAgcmV0dXJuIGRlY2ltYWxzOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfc3VwcGx5KSB7DQogICAgICAgIHJldHVybiB0b3RhbFN1cHBseTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgX2JhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgfQ0KDQoNCiAgICAvKg0KICAgICAgQWxsb3cgdG8gc3BlbmQNCiAgICAqLw0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2FuY2VzW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2FuY2VzW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KDQogICAgLyoNCiAgICAgIFRyYW5zZmVyDQogICAgKi8NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcykgew0KICAgICAgICBieXRlcyBtZW1vcnkgZW1wdHlNZXRhZGF0YTsNCiAgICAgICAgX190cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgZW1wdHlNZXRhZGF0YSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX21ldGFkYXRhKSByZXR1cm5zIChib29sIF9zdWNjZXNzKQ0KICAgIHsNCiAgICAgICAgX190cmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgX21ldGFkYXRhKTsNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUsIF9tZXRhZGF0YSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgX3N1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKGFsbG93YW5jZXNbX2Zyb21dW21zZy5zZW5kZXJdIDwgX3ZhbHVlKSB0aHJvdzsNCg0KICAgICAgICBhbGxvd2FuY2VzW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYWxsb3dhbmNlc1tfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eU1ldGFkYXRhOw0KICAgICAgICBfX3RyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSwgZW1wdHlNZXRhZGF0YSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIF9fdHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfbWV0YWRhdGEpIGludGVybmFsDQogICAgew0KICAgICAgICBpZiAoX2Zyb20gPT0gX3RvKSB0aHJvdzsNCiAgICAgICAgaWYgKF92YWx1ZSA9PSAwKSB0aHJvdzsNCiAgICAgICAgaWYgKGJhbGFuY2VPZihfZnJvbSkgPCBfdmFsdWUpIHRocm93Ow0KDQogICAgICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZU9mKF9mcm9tKSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZU9mKF90byksIF92YWx1ZSk7DQoNCiAgICAgICAgaWYgKGlzQ29udHJhY3QoX3RvKSkgew0KICAgICAgICAgICAgRVJDMjIzQ29udHJhY3RJbnRlcmZhY2UgcmVjZWl2ZXJDb250cmFjdCA9IEVSQzIyM0NvbnRyYWN0SW50ZXJmYWNlKF90byk7DQogICAgICAgICAgICByZWNlaXZlckNvbnRyYWN0LmVyYzIyM0ZhbGxiYWNrKF9mcm9tLCBfdmFsdWUsIF9tZXRhZGF0YSk7DQogICAgICAgIH0NCg0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgIH0NCg0KDQogICAgLyoNCiAgICAgIEhlbHBlcnMNCiAgICAqLw0KDQogICAgLy8gQXNzZW1ibGUgdGhlIGdpdmVuIGFkZHJlc3MgYnl0ZWNvZGUuIElmIGJ5dGVjb2RlIGV4aXN0cyB0aGVuIHRoZSBfYWRkciBpcyBhIGNvbnRyYWN0Lg0KICAgIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBfaXNDb250cmFjdCkgew0KICAgICAgICBfYWRkciA9IF9hZGRyOyAvLyB0byBhdm9pZCB3YXJuaW5ncyBkdXJpbmcgY29tcGlsYXRpb24NCg0KICAgICAgICB1aW50MjU2IGxlbmd0aDsNCiAgICAgICAgYXNzZW1ibHkgew0KICAgICAgICAgICAgLy9yZXRyaWV2ZSB0aGUgc2l6ZSBvZiB0aGUgY29kZSBvbiB0YXJnZXQgYWRkcmVzcywgdGhpcyBuZWVkcyBhc3NlbWJseQ0KICAgICAgICAgICAgbGVuZ3RoIDo9IGV4dGNvZGVzaXplKF9hZGRyKQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAobGVuZ3RoID4gMCk7DQogICAgfQ0KfQ0KDQoNCi8vIEVSQzIyMyB0b2tlbiB3aXRoIHRoZSBhYmlsaXR5IGZvciB0aGUgb3duZXIgdG8gYmxvY2sgYW55IGFjY291bnQNCmNvbnRyYWN0IERBU1Rva2VuIGlzIEVSQzIyM1Rva2VuIHsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGJsb2NrZWRBY2NvdW50czsNCiAgICBhZGRyZXNzIHB1YmxpYyBzZWNyZXRhcnlHZW5lcmFsOw0KDQoNCiAgICAvLyBDb25zdHJ1Y3Rvcg0KICAgIGZ1bmN0aW9uIERBU1Rva2VuKA0KICAgICAgICAgICAgc3RyaW5nIF9uYW1lLA0KICAgICAgICAgICAgc3RyaW5nIF9zeW1ib2wsDQogICAgICAgICAgICB1aW50OCBfZGVjaW1hbHMsDQogICAgICAgICAgICB1aW50MjU2IF90b3RhbFN1cHBseSwNCiAgICAgICAgICAgIGFkZHJlc3MgX2luaXRpYWxUb2tlbnNIb2xkZXIpIHsNCiAgICAgICAgc2VjcmV0YXJ5R2VuZXJhbCA9IG1zZy5zZW5kZXI7DQogICAgICAgIG5hbWUgPSBfbmFtZTsNCiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsNCiAgICAgICAgZGVjaW1hbHMgPSBfZGVjaW1hbHM7DQogICAgICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5Ow0KICAgICAgICBiYWxhbmNlc1tfaW5pdGlhbFRva2Vuc0hvbGRlcl0gPSBfdG90YWxTdXBwbHk7DQogICAgfQ0KDQoNCiAgICBtb2RpZmllciBvbmx5U2VjcmV0YXJ5R2VuZXJhbCB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IHNlY3JldGFyeUdlbmVyYWwpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KDQogICAgLy8gYmxvY2sgYWNjb3VudA0KICAgIGZ1bmN0aW9uIGJsb2NrQWNjb3VudChhZGRyZXNzIF9hY2NvdW50KSBvbmx5U2VjcmV0YXJ5R2VuZXJhbCB7DQogICAgICAgIGJsb2NrZWRBY2NvdW50c1tfYWNjb3VudF0gPSB0cnVlOw0KICAgIH0NCg0KICAgIC8vIHVuYmxvY2sgYWNjb3VudA0KICAgIGZ1bmN0aW9uIHVuYmxvY2tBY2NvdW50KGFkZHJlc3MgX2FjY291bnQpIG9ubHlTZWNyZXRhcnlHZW5lcmFsIHsNCiAgICAgICAgYmxvY2tlZEFjY291bnRzW19hY2NvdW50XSA9IGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIGNoZWNrIGlzIGFjY291bnQgYmxvY2tlZA0KICAgIGZ1bmN0aW9uIGlzQWNjb3VudEJsb2NrZWQoYWRkcmVzcyBfYWNjb3VudCkgcmV0dXJucyAoYm9vbCl7DQogICAgICAgIHJldHVybiBibG9ja2VkQWNjb3VudHNbX2FjY291bnRdOw0KICAgIH0NCg0KICAgIC8vIG92ZXJyaWRlIHRyYW5zZmVyIG1ldGhvZHMgdG8gdGhyb3cgb24gYmxvY2tlZCBhY2NvdW50cw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmxvY2tlZEFjY291bnRzW21zZy5zZW5kZXJdKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX21ldGFkYXRhKSByZXR1cm5zIChib29sIF9zdWNjZXNzKSB7DQogICAgICAgIGlmIChibG9ja2VkQWNjb3VudHNbbXNnLnNlbmRlcl0pIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiBzdXBlci50cmFuc2ZlcihfdG8sIF92YWx1ZSwgX21ldGFkYXRhKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIF9zdWNjZXNzKSB7DQogICAgICAgIGlmIChibG9ja2VkQWNjb3VudHNbX2Zyb21dKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gc3VwZXIudHJhbnNmZXJGcm9tKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgfQ0KfQ0KDQoNCmNvbnRyYWN0IEFCQ1Rva2VuIGlzIEVSQzIyM1Rva2VuIHsNCiAgICAvLyBDb25zdHJ1Y3Rvcg0KICAgIGZ1bmN0aW9uIEFCQ1Rva2VuKA0KICAgICAgICAgICAgc3RyaW5nIF9uYW1lLA0KICAgICAgICAgICAgc3RyaW5nIF9zeW1ib2wsDQogICAgICAgICAgICB1aW50OCBfZGVjaW1hbHMsDQogICAgICAgICAgICB1aW50MjU2IF90b3RhbFN1cHBseSwNCiAgICAgICAgICAgIGFkZHJlc3MgX2luaXRpYWxUb2tlbnNIb2xkZXIpIHsNCiAgICAgICAgbmFtZSA9IF9uYW1lOw0KICAgICAgICBzeW1ib2wgPSBfc3ltYm9sOw0KICAgICAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsNCiAgICAgICAgdG90YWxTdXBwbHkgPSBfdG90YWxTdXBwbHk7DQogICAgICAgIGJhbGFuY2VzW19pbml0aWFsVG9rZW5zSG9sZGVyXSA9IF90b3RhbFN1cHBseTsNCiAgICB9DQp9DQoNCg0KLy8gQ29udHJhY3Qgd2l0aCB2b3Rpbmcgb24gcHJvcG9zYWxzIGFuZCBleGVjdXRpb24gb2YgcGFzc2VkIHByb3Bvc2Fscw0KY29udHJhY3QgREFTIGlzIEVSQzIyM0NvbnRyYWN0SW50ZXJmYWNlIHsNCg0KICAgIC8qIENvbnRyYWN0IFZhcmlhYmxlcyAqLw0KDQogICAgc3RyaW5nIG5hbWUgPSAiRGVjZW50cmFsaXplZCBBdXRvbm9tb3VzIFN0YXRlIjsNCiAgICAvLyBTb3VyY2Ugb2YgZGVtb2NyYWN5DQogICAgREFTVG9rZW4gcHVibGljIGRhc1Rva2VuOw0KICAgIEFCQ1Rva2VuIHB1YmxpYyBhYmNUb2tlbjsNCiAgICAvLyBEZW1vY3JhY3kgcnVsZXMNCiAgICB1aW50MjU2IHB1YmxpYyBjb25ncmVzc01lbWJlclRocmVzaG9sZDsgLy8gVXNlciBtdXN0IGhhdmUgbW9yZSB0aGFuIHRoaXMgYW1vdW50IG9mIHRva2VucyB0byBiZSBpbmNsdWRlZCBpbnRvIGNvbmdyZXNzDQogICAgdWludDI1NiBwdWJsaWMgbWluaW11bVF1b3J1bTsgICAgICAgICAgIC8vIFRoZSBtaW5pbXVtIG51bWJlciBvZiB0b2tlbnMgdGhhdCBtdXN0IHBhcnRpY2lwYXRlIGluIGEgdm90ZSB0byBhY2hpZXZlIGEgcXVvcnVtDQogICAgdWludDI1NiBwdWJsaWMgZGViYXRpbmdQZXJpb2Q7ICAgICAgICAgIC8vIE1pbiB0aW1lIHRvIHZvdGUgZm9yIGFuIHByb3Bvc2FsIFtzZWNdDQogICAgdWludDI1NiBwdWJsaWMgbWFyZ2luRm9yTWFqb3JpdHk7ICAgICAgIC8vIE1pbiBzdXBlcmlvcml0eSBvZiB2b3RlcyAiZm9yIiB0byBwYXNzIHRoZSBwcm9wb3NhbCBbbnVtYmVyIG9mIHRva2Vuc10NCiAgICAvLyBQcm9wb3NhbHMNCiAgICBQcm9wb3NhbFtdIHB1YmxpYyBwcm9wb3NhbHM7DQogICAgdWludDI1NiBwdWJsaWMgcHJvcG9zYWxzTnVtYmVyID0gMDsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQzMikgdG9rZW5zTG9ja3M7ICAgICAgICAgLy8gY29uZ3Jlc3MgbWVtYmVyID0+IG51bWJlciBvZiBsb2NrcyAocmVjdXJzaXZlIG11dGV4KQ0KDQogICAgLyogQ29udHJhY3QgRXZlbnRzICovDQogICAgZXZlbnQgUHJvcG9zYWxBZGRlZEV2ZW50KHVpbnQyNTYgcHJvcG9zYWxJRCwgYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDI1NiBldGhlckFtb3VudCwgc3RyaW5nIGRlc2NyaXB0aW9uKTsNCiAgICBldmVudCBWb3RlZEV2ZW50KHVpbnQyNTYgcHJvcG9zYWxJRCwgYWRkcmVzcyB2b3RlciwgYm9vbCBpblN1cHBvcnQsIHVpbnQyNTYgdm90ZXJUb2tlbnMsIHN0cmluZyBqdXN0aWZpY2F0aW9uVGV4dCk7DQogICAgZXZlbnQgUHJvcG9zYWxUYWxsaWVkRXZlbnQodWludDI1NiBwcm9wb3NhbElELCBib29sIHF1b3J1bSwgYm9vbCByZXN1bHQpOw0KICAgIGV2ZW50IFByb3Bvc2FsRXhlY3V0ZWRFdmVudCh1aW50MjU2IHByb3Bvc2FsSUQpOw0KICAgIGV2ZW50IFJ1bGVzQ2hhbmdlZEV2ZW50KHVpbnQyNTYgY29uZ3Jlc3NNZW1iZXJUaHJlc2hvbGQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBtaW5pbXVtUXVvcnVtLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgZGViYXRpbmdQZXJpb2QsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDI1NiBtYXJnaW5Gb3JNYWpvcml0eSk7DQoNCiAgICAvKiBDb250cmFjdCBTdHJ1Y3R1cmVzICovDQogICAgZW51bSBQcm9wb3NhbFN0YXRlIHtQcm9wb3NlZCwgTm9RdW9ydW0sIFJlamVjdGVkLCBQYXNzZWQsIEV4ZWN1dGVkfQ0KDQogICAgc3RydWN0IFByb3Bvc2FsIHsNCiAgICAgICAgLyogUHJvcG9zYWwgY29udGVudCAqLw0KICAgICAgICBhZGRyZXNzIGJlbmVmaWNpYXJ5Ow0KICAgICAgICB1aW50MjU2IGV0aGVyQW1vdW50Ow0KICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb247DQogICAgICAgIGJ5dGVzMzIgcHJvcG9zYWxIYXNoOw0KDQogICAgICAgIC8qIFByb3Bvc2FsIHN0YXRlICovDQogICAgICAgIFByb3Bvc2FsU3RhdGUgc3RhdGU7DQoNCiAgICAgICAgLyogVm90aW5nIHN0YXRlICovDQogICAgICAgIHVpbnQyNTYgdm90aW5nRGVhZGxpbmU7DQogICAgICAgIFZvdGVbXSB2b3RlczsNCiAgICAgICAgdWludDI1NiB2b3Rlc051bWJlcjsNCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSB2b3RlZDsNCiAgICB9DQoNCiAgICBzdHJ1Y3QgVm90ZSB7DQogICAgICAgIGFkZHJlc3Mgdm90ZXI7DQogICAgICAgIGJvb2wgaW5TdXBwb3J0Ow0KICAgICAgICB1aW50MjU2IHZvdGVyVG9rZW5zOw0KICAgICAgICBzdHJpbmcganVzdGlmaWNhdGlvblRleHQ7DQogICAgfQ0KDQogICAgLyogbW9kaWZpZXIgdGhhdCBhbGxvd3Mgb25seSBjb25ncmVzcyBtZW1iZXJzIHRvIHZvdGUgYW5kIGNyZWF0ZSBuZXcgcHJvcG9zYWxzICovDQogICAgbW9kaWZpZXIgb25seUNvbmdyZXNzTWVtYmVycyB7DQogICAgICAgIGlmIChkYXNUb2tlbi5iYWxhbmNlT2YobXNnLnNlbmRlcikgPCBjb25ncmVzc01lbWJlclRocmVzaG9sZCkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLyogQ29uc3RydWN0b3IgKi8NCiAgICBmdW5jdGlvbiBEQVMoDQogICAgICAgIHVpbnQyNTYgX2NvbmdyZXNzTWVtYmVyVGhyZXNob2xkLA0KICAgICAgICB1aW50MjU2IF9taW5pbXVtUXVvcnVtLA0KICAgICAgICB1aW50MjU2IF9kZWJhdGluZ1BlcmlvZCwNCiAgICAgICAgdWludDI1NiBfbWFyZ2luRm9yTWFqb3JpdHksDQogICAgICAgIGFkZHJlc3MgX2NvbmdyZXNzTGVhZGVyDQogICAgKSBwYXlhYmxlIHsNCiAgICAgICAgLy8gY3JlYXRlIGEgc291cmNlIG9mIGRlbW9jcmFjeQ0KICAgICAgICBkYXNUb2tlbiA9IG5ldyBEQVNUb2tlbignREEkJywgJ0RBJCcsIDE4LCAxMDAwMDAwMDAwICogKDEwICoqIDE4KSwgX2NvbmdyZXNzTGVhZGVyKTsNCiAgICAgICAgYWJjVG9rZW4gPSBuZXcgQUJDVG9rZW4oJ0FscGhhYml0JywgJ0FCQycsIDE4LCAyMTAwMDAwMDAgKiAoMTAgKiogMTgpLCBfY29uZ3Jlc3NMZWFkZXIpOw0KDQogICAgICAgIC8vIHNldHVwIHJ1bGVzDQogICAgICAgIGNvbmdyZXNzTWVtYmVyVGhyZXNob2xkID0gX2NvbmdyZXNzTWVtYmVyVGhyZXNob2xkOw0KICAgICAgICBtaW5pbXVtUXVvcnVtID0gX21pbmltdW1RdW9ydW07DQogICAgICAgIGRlYmF0aW5nUGVyaW9kID0gX2RlYmF0aW5nUGVyaW9kOw0KICAgICAgICBtYXJnaW5Gb3JNYWpvcml0eSA9IF9tYXJnaW5Gb3JNYWpvcml0eTsNCg0KICAgICAgICBSdWxlc0NoYW5nZWRFdmVudChjb25ncmVzc01lbWJlclRocmVzaG9sZCwgbWluaW11bVF1b3J1bSwgZGViYXRpbmdQZXJpb2QsIG1hcmdpbkZvck1ham9yaXR5KTsNCiAgICB9DQoNCiAgICAvLyBibGFuayBmYWxsYmFjayBmdW5jdGlvbnMgdG8gcmVjZWl2ZSBFVEggYW5kIHRva2Vucw0KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7IH0NCg0KICAgIGZ1bmN0aW9uIGVyYzIyM0ZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSl7DQogICAgICAgIC8vIHRvIGF2b2lkIHdhcm5pbmdzIGR1cmluZyBjb21waWxhdGlvbg0KICAgICAgICBfZnJvbSA9IF9mcm9tOw0KICAgICAgICBfdmFsdWUgPSBfdmFsdWU7DQogICAgICAgIF9kYXRhID0gX2RhdGE7DQogICAgfQ0KDQoNCiAgICAvKiBQcm9wb3NhbC1yZWxhdGVkIGZ1bmN0aW9ucyAqLw0KDQogICAgLy8gY2FsY3VsYXRlIGhhc2ggb2YgYW4gcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbEhhc2goDQogICAgICAgIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LA0KICAgICAgICB1aW50MjU2IF9ldGhlckFtb3VudCwNCiAgICAgICAgYnl0ZXMgX3RyYW5zYWN0aW9uQnl0ZWNvZGUNCiAgICApDQogICAgICAgIGNvbnN0YW50DQogICAgICAgIHJldHVybnMgKGJ5dGVzMzIpDQogICAgew0KICAgICAgICByZXR1cm4gc2hhMyhfYmVuZWZpY2lhcnksIF9ldGhlckFtb3VudCwgX3RyYW5zYWN0aW9uQnl0ZWNvZGUpOw0KICAgIH0NCg0KICAgIC8vIGJsb2NrIHRva2VucyBvZiBhbiB2b3Rlcg0KICAgIGZ1bmN0aW9uIGJsb2NrVG9rZW5zKGFkZHJlc3MgX3ZvdGVyKSBpbnRlcm5hbCB7DQogICAgICAgIGlmICh0b2tlbnNMb2Nrc1tfdm90ZXJdICsgMSA8IHRva2Vuc0xvY2tzW192b3Rlcl0pIHRocm93Ow0KDQogICAgICAgIHRva2Vuc0xvY2tzW192b3Rlcl0gKz0gMTsNCiAgICAgICAgaWYgKHRva2Vuc0xvY2tzW192b3Rlcl0gPT0gMSkgew0KICAgICAgICAgICAgZGFzVG9rZW4uYmxvY2tBY2NvdW50KF92b3Rlcik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyB1bmJsb2NrIHRva2VucyBvZiBhbiB2b3Rlcg0KICAgIGZ1bmN0aW9uIHVuYmxvY2tUb2tlbnMoYWRkcmVzcyBfdm90ZXIpIGludGVybmFsIHsNCiAgICAgICAgaWYgKHRva2Vuc0xvY2tzW192b3Rlcl0gPD0gMCkgdGhyb3c7DQoNCiAgICAgICAgdG9rZW5zTG9ja3NbX3ZvdGVyXSAtPSAxOw0KICAgICAgICBpZiAodG9rZW5zTG9ja3NbX3ZvdGVyXSA9PSAwKSB7DQogICAgICAgICAgICBkYXNUb2tlbi51bmJsb2NrQWNjb3VudChfdm90ZXIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gY3JlYXRlIG5ldyBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIGNyZWF0ZVByb3Bvc2FsKA0KICAgICAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwNCiAgICAgICAgdWludDI1NiBfZXRoZXJBbW91bnQsDQogICAgICAgIHN0cmluZyBfZGVzY3JpcHRpb24sDQogICAgICAgIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlDQogICAgKQ0KICAgICAgICBvbmx5Q29uZ3Jlc3NNZW1iZXJzDQogICAgICAgIHJldHVybnMgKHVpbnQyNTYgX3Byb3Bvc2FsSUQpDQogICAgew0KICAgICAgICBfcHJvcG9zYWxJRCA9IHByb3Bvc2Fscy5sZW5ndGg7DQogICAgICAgIHByb3Bvc2Fscy5sZW5ndGggKz0gMTsNCiAgICAgICAgcHJvcG9zYWxzTnVtYmVyID0gX3Byb3Bvc2FsSUQgKyAxOw0KDQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uZXRoZXJBbW91bnQgPSBfZXRoZXJBbW91bnQ7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0ucHJvcG9zYWxIYXNoID0gZ2V0UHJvcG9zYWxIYXNoKF9iZW5lZmljaWFyeSwgX2V0aGVyQW1vdW50LCBfdHJhbnNhY3Rpb25CeXRlY29kZSk7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uc3RhdGUgPSBQcm9wb3NhbFN0YXRlLlByb3Bvc2VkOw0KICAgICAgICBwcm9wb3NhbHNbX3Byb3Bvc2FsSURdLnZvdGluZ0RlYWRsaW5lID0gbm93ICsgZGViYXRpbmdQZXJpb2QgKiAxIHNlY29uZHM7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0udm90ZXNOdW1iZXIgPSAwOw0KDQogICAgICAgIFByb3Bvc2FsQWRkZWRFdmVudChfcHJvcG9zYWxJRCwgX2JlbmVmaWNpYXJ5LCBfZXRoZXJBbW91bnQsIF9kZXNjcmlwdGlvbik7DQoNCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgIH0NCg0KICAgIC8vIHZvdGUgZm9yIGFuIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gdm90ZSgNCiAgICAgICAgdWludDI1NiBfcHJvcG9zYWxJRCwNCiAgICAgICAgYm9vbCBfaW5TdXBwb3J0LA0KICAgICAgICBzdHJpbmcgX2p1c3RpZmljYXRpb25UZXh0DQogICAgKQ0KICAgICAgICBvbmx5Q29uZ3Jlc3NNZW1iZXJzDQogICAgew0KICAgICAgICBQcm9wb3NhbCBwID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBpZiAocC5zdGF0ZSAhPSBQcm9wb3NhbFN0YXRlLlByb3Bvc2VkKSB0aHJvdzsNCiAgICAgICAgaWYgKHAudm90ZWRbbXNnLnNlbmRlcl0gPT0gdHJ1ZSkgdGhyb3c7DQoNCiAgICAgICAgdmFyIHZvdGVyVG9rZW5zID0gZGFzVG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpOw0KICAgICAgICBibG9ja1Rva2Vucyhtc2cuc2VuZGVyKTsNCg0KICAgICAgICBwLnZvdGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsNCiAgICAgICAgcC52b3Rlcy5wdXNoKFZvdGUobXNnLnNlbmRlciwgX2luU3VwcG9ydCwgdm90ZXJUb2tlbnMsIF9qdXN0aWZpY2F0aW9uVGV4dCkpOw0KICAgICAgICBwLnZvdGVzTnVtYmVyICs9IDE7DQoNCiAgICAgICAgVm90ZWRFdmVudChfcHJvcG9zYWxJRCwgbXNnLnNlbmRlciwgX2luU3VwcG9ydCwgdm90ZXJUb2tlbnMsIF9qdXN0aWZpY2F0aW9uVGV4dCk7DQogICAgfQ0KDQogICAgLy8gZmluaXNoIHZvdGluZyBvbiBhbiBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIGZpbmlzaFByb3Bvc2FsVm90aW5nKHVpbnQyNTYgX3Byb3Bvc2FsSUQpIG9ubHlDb25ncmVzc01lbWJlcnMgew0KICAgICAgICBQcm9wb3NhbCBwID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBpZiAobm93IDwgcC52b3RpbmdEZWFkbGluZSkgdGhyb3c7DQogICAgICAgIGlmIChwLnN0YXRlICE9IFByb3Bvc2FsU3RhdGUuUHJvcG9zZWQpIHRocm93Ow0KDQogICAgICAgIHZhciBfdm90ZXNOdW1iZXIgPSBwLnZvdGVzLmxlbmd0aDsNCiAgICAgICAgdWludDI1NiB0b2tlbnNGb3IgPSAwOw0KICAgICAgICB1aW50MjU2IHRva2Vuc0FnYWluc3QgPSAwOw0KICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBfdm90ZXNOdW1iZXI7IGkrKykgew0KICAgICAgICAgICAgaWYgKHAudm90ZXNbaV0uaW5TdXBwb3J0KSB7DQogICAgICAgICAgICAgICAgdG9rZW5zRm9yICs9IHAudm90ZXNbaV0udm90ZXJUb2tlbnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICB0b2tlbnNBZ2FpbnN0ICs9IHAudm90ZXNbaV0udm90ZXJUb2tlbnM7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHVuYmxvY2tUb2tlbnMocC52b3Rlc1tpXS52b3Rlcik7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoKHRva2Vuc0ZvciArIHRva2Vuc0FnYWluc3QpIDwgbWluaW11bVF1b3J1bSkgew0KICAgICAgICAgICAgcC5zdGF0ZSA9IFByb3Bvc2FsU3RhdGUuTm9RdW9ydW07DQogICAgICAgICAgICBQcm9wb3NhbFRhbGxpZWRFdmVudChfcHJvcG9zYWxJRCwgZmFsc2UsIGZhbHNlKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoKHRva2Vuc0ZvciAtIHRva2Vuc0FnYWluc3QpIDwgbWFyZ2luRm9yTWFqb3JpdHkpIHsNCiAgICAgICAgICAgIHAuc3RhdGUgPSBQcm9wb3NhbFN0YXRlLlJlamVjdGVkOw0KICAgICAgICAgICAgUHJvcG9zYWxUYWxsaWVkRXZlbnQoX3Byb3Bvc2FsSUQsIHRydWUsIGZhbHNlKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBwLnN0YXRlID0gUHJvcG9zYWxTdGF0ZS5QYXNzZWQ7DQogICAgICAgIFByb3Bvc2FsVGFsbGllZEV2ZW50KF9wcm9wb3NhbElELCB0cnVlLCB0cnVlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIGV4ZWN1dGUgcGFzc2VkIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gZXhlY3V0ZVByb3Bvc2FsKHVpbnQyNTYgX3Byb3Bvc2FsSUQsIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlKSBvbmx5Q29uZ3Jlc3NNZW1iZXJzIHsNCiAgICAgICAgUHJvcG9zYWwgcCA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQoNCiAgICAgICAgaWYgKHAuc3RhdGUgIT0gUHJvcG9zYWxTdGF0ZS5QYXNzZWQpIHRocm93Ow0KDQogICAgICAgIHAuc3RhdGUgPSBQcm9wb3NhbFN0YXRlLkV4ZWN1dGVkOw0KICAgICAgICBpZiAoIXAuYmVuZWZpY2lhcnkuY2FsbC52YWx1ZShwLmV0aGVyQW1vdW50ICogMSBldGhlcikoX3RyYW5zYWN0aW9uQnl0ZWNvZGUpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KDQogICAgICAgIFByb3Bvc2FsRXhlY3V0ZWRFdmVudChfcHJvcG9zYWxJRCk7DQogICAgfQ0KfQ=='