base 64 content
base64dAS2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KIC8qIFJlY2VpdmVyIG11c3QgaW1wbGVtZW50IHRoaXMgZnVuY3Rpb24gdG8gcmVjZWl2ZSB0b2tlbnMNCiAqICBvdGhlcndpc2UgdG9rZW4gdHJhbnNhY3Rpb24gd2lsbCBmYWlsDQogKi8NCiANCiBjb250cmFjdCBDb250cmFjdFJlY2VpdmVyIHsNCiAgICBmdW5jdGlvbiB0b2tlbkZhbGxiYWNrKGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSl7DQogICAgICBfZnJvbSA9IF9mcm9tOw0KICAgICAgX3ZhbHVlID0gX3ZhbHVlOw0KICAgICAgX2RhdGEgPSBfZGF0YTsNCiAgICAgIC8vIEluY29taW5nIHRyYW5zYWN0aW9uIGNvZGUgaGVyZQ0KICAgIH0NCn0NCiANCiAvKiBOZXcgRVJDMjMgY29udHJhY3QgaW50ZXJmYWNlICovDQoNCmNvbnRyYWN0IEVSQzIzIHsNCiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nik7DQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIG93bmVyLCBhZGRyZXNzIHNwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOw0KDQogIGZ1bmN0aW9uIG5hbWUoKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX25hbWUpOw0KICBmdW5jdGlvbiBzeW1ib2woKSBjb25zdGFudCByZXR1cm5zIChzdHJpbmcgX3N5bWJvbCk7DQogIGZ1bmN0aW9uIGRlY2ltYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludDggX2RlY2ltYWxzKTsNCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF9zdXBwbHkpOw0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQyNTYgdmFsdWUpIHJldHVybnMgKGJvb2wgb2spOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlLCBieXRlcyBkYXRhKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUsIGJ5dGVzIGRhdGEpOw0KICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCn0NCg0KDQogLyoqDQogKiBFUkMyMyB0b2tlbiBieSBEZXhhcmFuDQogKg0KICogaHR0cHM6Ly9naXRodWIuY29tL0RleGFyYW4vRVJDMjMtdG9rZW5zDQogKi8NCiANCmNvbnRyYWN0IEVSQzIzVG9rZW4gaXMgRVJDMjMgew0KDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQogIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7DQogIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsNCiAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQoNCiAgLy8gRnVuY3Rpb24gdG8gYWNjZXNzIG5hbWUgb2YgdG9rZW4gLg0KICBmdW5jdGlvbiBuYW1lKCkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9uYW1lKSB7DQogICAgICByZXR1cm4gbmFtZTsNCiAgfQ0KICAvLyBGdW5jdGlvbiB0byBhY2Nlc3Mgc3ltYm9sIG9mIHRva2VuIC4NCiAgZnVuY3Rpb24gc3ltYm9sKCkgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIF9zeW1ib2wpIHsNCiAgICAgIHJldHVybiBzeW1ib2w7DQogIH0NCiAgLy8gRnVuY3Rpb24gdG8gYWNjZXNzIGRlY2ltYWxzIG9mIHRva2VuIC4NCiAgZnVuY3Rpb24gZGVjaW1hbHMoKSBjb25zdGFudCByZXR1cm5zICh1aW50OCBfZGVjaW1hbHMpIHsNCiAgICAgIHJldHVybiBkZWNpbWFsczsNCiAgfQ0KICAvLyBGdW5jdGlvbiB0byBhY2Nlc3MgdG90YWwgc3VwcGx5IG9mIHRva2VucyAuDQogIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfdG90YWxTdXBwbHkpIHsNCiAgICAgIHJldHVybiB0b3RhbFN1cHBseTsNCiAgfQ0KDQogIC8vZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIHVzZXIgb3IgYW5vdGhlciBjb250cmFjdCB3YW50cyB0byB0cmFuc2ZlciBmdW5kcw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUsIGJ5dGVzIF9kYXRhKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgDQogICAgLy9maWx0ZXJpbmcgaWYgdGhlIHRhcmdldCBpcyBhIGNvbnRyYWN0IHdpdGggYnl0ZWNvZGUgaW5zaWRlIGl0DQogICAgaWYoaXNDb250cmFjdChfdG8pKSB7DQogICAgICAgIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgX2RhdGEpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIF9kYXRhKTsNCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQogIH0NCiAgDQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICANCiAgICAvL3N0YW5kYXJkIGZ1bmN0aW9uIHRyYW5zZmVyIHNpbWlsYXIgdG8gRVJDMjAgdHJhbnNmZXIgd2l0aCBubyBfZGF0YQ0KICAgIC8vYWRkZWQgZHVlIHRvIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHJlYXNvbnMNCiAgICBieXRlcyBtZW1vcnkgZW1wdHk7DQogICAgaWYoaXNDb250cmFjdChfdG8pKSB7DQogICAgICAgIHRyYW5zZmVyVG9Db250cmFjdChfdG8sIF92YWx1ZSwgZW1wdHkpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgdHJhbnNmZXJUb0FkZHJlc3MoX3RvLCBfdmFsdWUsIGVtcHR5KTsNCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvL2Z1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gdHJhbnNhY3Rpb24gdGFyZ2V0IGlzIGFuIGFkZHJlc3MNCiAgZnVuY3Rpb24gdHJhbnNmZXJUb0FkZHJlc3MoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHJpdmF0ZSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlLCBfZGF0YSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCiAgDQogIC8vZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiB0cmFuc2FjdGlvbiB0YXJnZXQgaXMgYSBjb250cmFjdA0KICBmdW5jdGlvbiB0cmFuc2ZlclRvQ29udHJhY3QoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlLCBieXRlcyBfZGF0YSkgcHJpdmF0ZSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgQ29udHJhY3RSZWNlaXZlciByZWNpZXZlciA9IENvbnRyYWN0UmVjZWl2ZXIoX3RvKTsNCiAgICByZWNpZXZlci50b2tlbkZhbGxiYWNrKG1zZy5zZW5kZXIsIF92YWx1ZSwgX2RhdGEpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSwgX2RhdGEpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIA0KICAvL2Fzc2VtYmxlIHRoZSBnaXZlbiBhZGRyZXNzIGJ5dGVjb2RlLiBJZiBieXRlY29kZSBleGlzdHMgdGhlbiB0aGUgX2FkZHIgaXMgYSBjb250cmFjdC4NCiAgZnVuY3Rpb24gaXNDb250cmFjdChhZGRyZXNzIF9hZGRyKSBwcml2YXRlIHJldHVybnMgKGJvb2wgaXNfY29udHJhY3QpIHsNCiAgICAgIF9hZGRyID0gX2FkZHI7DQogICAgICB1aW50MjU2IGxlbmd0aDsNCiAgICAgIGFzc2VtYmx5IHsNCiAgICAgICAgICAgIC8vcmV0cmlldmUgdGhlIHNpemUgb2YgdGhlIGNvZGUgb24gdGFyZ2V0IGFkZHJlc3MsIHRoaXMgbmVlZHMgYXNzZW1ibHkNCiAgICAgICAgICAgIGxlbmd0aCA6PSBleHRjb2Rlc2l6ZShfYWRkcikNCiAgICAgICAgfQ0KICAgICAgICBpZihsZW5ndGg+MCkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsNCiAgICANCiAgICBpZihfdmFsdWUgPiBfYWxsb3dhbmNlKSB7DQogICAgICAgIHRocm93Ow0KICAgIH0NCg0KICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOw0KICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQogICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICB9DQoNCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogIH0NCn0NCg0KDQovLyBFUkMyMjMgdG9rZW4gd2l0aCB0aGUgYWJpbGl0eSBmb3IgdGhlIG93bmVyIHRvIGJsb2NrIGFueSBhY2NvdW50DQpjb250cmFjdCBEQVNUb2tlbiBpcyBFUkMyM1Rva2VuIHsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGJsb2NrZWRBY2NvdW50czsNCiAgICBhZGRyZXNzIHB1YmxpYyBzZWNyZXRhcnlHZW5lcmFsOw0KDQoNCiAgICAvLyBDb25zdHJ1Y3Rvcg0KICAgIGZ1bmN0aW9uIERBU1Rva2VuKA0KICAgICAgICAgICAgc3RyaW5nIF9uYW1lLA0KICAgICAgICAgICAgc3RyaW5nIF9zeW1ib2wsDQogICAgICAgICAgICB1aW50OCBfZGVjaW1hbHMsDQogICAgICAgICAgICB1aW50MjU2IF90b3RhbFN1cHBseSwNCiAgICAgICAgICAgIGFkZHJlc3MgX2luaXRpYWxUb2tlbnNIb2xkZXIpIHsNCiAgICAgICAgc2VjcmV0YXJ5R2VuZXJhbCA9IG1zZy5zZW5kZXI7DQogICAgICAgIG5hbWUgPSBfbmFtZTsNCiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsNCiAgICAgICAgZGVjaW1hbHMgPSBfZGVjaW1hbHM7DQogICAgICAgIHRvdGFsU3VwcGx5ID0gX3RvdGFsU3VwcGx5Ow0KICAgICAgICBiYWxhbmNlc1tfaW5pdGlhbFRva2Vuc0hvbGRlcl0gPSBfdG90YWxTdXBwbHk7DQogICAgfQ0KDQoNCiAgICBtb2RpZmllciBvbmx5U2VjcmV0YXJ5R2VuZXJhbCB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IHNlY3JldGFyeUdlbmVyYWwpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KDQogICAgLy8gYmxvY2sgYWNjb3VudA0KICAgIGZ1bmN0aW9uIGJsb2NrQWNjb3VudChhZGRyZXNzIF9hY2NvdW50KSBvbmx5U2VjcmV0YXJ5R2VuZXJhbCB7DQogICAgICAgIGJsb2NrZWRBY2NvdW50c1tfYWNjb3VudF0gPSB0cnVlOw0KICAgIH0NCg0KICAgIC8vIHVuYmxvY2sgYWNjb3VudA0KICAgIGZ1bmN0aW9uIHVuYmxvY2tBY2NvdW50KGFkZHJlc3MgX2FjY291bnQpIG9ubHlTZWNyZXRhcnlHZW5lcmFsIHsNCiAgICAgICAgYmxvY2tlZEFjY291bnRzW19hY2NvdW50XSA9IGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIGNoZWNrIGlzIGFjY291bnQgYmxvY2tlZA0KICAgIGZ1bmN0aW9uIGlzQWNjb3VudEJsb2NrZWQoYWRkcmVzcyBfYWNjb3VudCkgcmV0dXJucyAoYm9vbCl7DQogICAgICAgIHJldHVybiBibG9ja2VkQWNjb3VudHNbX2FjY291bnRdOw0KICAgIH0NCg0KICAgIC8vIG92ZXJyaWRlIHRyYW5zZmVyIG1ldGhvZHMgdG8gdGhyb3cgb24gYmxvY2tlZCBhY2NvdW50cw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmxvY2tlZEFjY291bnRzW21zZy5zZW5kZXJdKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gRVJDMjNUb2tlbi50cmFuc2ZlcihfdG8sIF92YWx1ZSwgX2RhdGEpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChibG9ja2VkQWNjb3VudHNbbXNnLnNlbmRlcl0pIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIGJ5dGVzIG1lbW9yeSBlbXB0eTsNCiAgICAgICAgcmV0dXJuIEVSQzIzVG9rZW4udHJhbnNmZXIoX3RvLCBfdmFsdWUsIGVtcHR5KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKGJsb2NrZWRBY2NvdW50c1tfZnJvbV0pIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiBFUkMyM1Rva2VuLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgIH0NCn0NCg0KDQoNCmNvbnRyYWN0IEFCQ1Rva2VuIGlzIEVSQzIzVG9rZW4gew0KICAgIC8vIENvbnN0cnVjdG9yDQogICAgZnVuY3Rpb24gQUJDVG9rZW4oDQogICAgICAgICAgICBzdHJpbmcgX25hbWUsDQogICAgICAgICAgICBzdHJpbmcgX3N5bWJvbCwNCiAgICAgICAgICAgIHVpbnQ4IF9kZWNpbWFscywNCiAgICAgICAgICAgIHVpbnQyNTYgX3RvdGFsU3VwcGx5LA0KICAgICAgICAgICAgYWRkcmVzcyBfaW5pdGlhbFRva2Vuc0hvbGRlcikgew0KICAgICAgICBuYW1lID0gX25hbWU7DQogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7DQogICAgICAgIGRlY2ltYWxzID0gX2RlY2ltYWxzOw0KICAgICAgICB0b3RhbFN1cHBseSA9IF90b3RhbFN1cHBseTsNCiAgICAgICAgYmFsYW5jZXNbX2luaXRpYWxUb2tlbnNIb2xkZXJdID0gX3RvdGFsU3VwcGx5Ow0KICAgIH0NCn0NCg0KDQovLyBDb250cmFjdCB3aXRoIHZvdGluZyBvbiBwcm9wb3NhbHMgYW5kIGV4ZWN1dGlvbiBvZiBwYXNzZWQgcHJvcG9zYWxzDQpjb250cmFjdCBEQVMgaXMgQ29udHJhY3RSZWNlaXZlciB7DQoNCiAgICAvKiBDb250cmFjdCBWYXJpYWJsZXMgKi8NCg0KICAgIHN0cmluZyBuYW1lID0gIkRlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBTdGF0ZSI7DQogICAgLy8gU291cmNlIG9mIGRlbW9jcmFjeQ0KICAgIERBU1Rva2VuIHB1YmxpYyBkYXNUb2tlbjsNCiAgICBBQkNUb2tlbiBwdWJsaWMgYWJjVG9rZW47DQogICAgLy8gRGVtb2NyYWN5IHJ1bGVzDQogICAgdWludDI1NiBwdWJsaWMgY29uZ3Jlc3NNZW1iZXJUaHJlc2hvbGQ7IC8vIFVzZXIgbXVzdCBoYXZlIG1vcmUgdGhhbiB0aGlzIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgaW5jbHVkZWQgaW50byBjb25ncmVzcw0KICAgIHVpbnQyNTYgcHVibGljIG1pbmltdW1RdW9ydW07ICAgICAgICAgICAvLyBUaGUgbWluaW11bSBudW1iZXIgb2YgdG9rZW5zIHRoYXQgbXVzdCBwYXJ0aWNpcGF0ZSBpbiBhIHZvdGUgdG8gYWNoaWV2ZSBhIHF1b3J1bQ0KICAgIHVpbnQyNTYgcHVibGljIGRlYmF0aW5nUGVyaW9kOyAgICAgICAgICAvLyBNaW4gdGltZSB0byB2b3RlIGZvciBhbiBwcm9wb3NhbCBbc2VjXQ0KICAgIHVpbnQyNTYgcHVibGljIG1hcmdpbkZvck1ham9yaXR5OyAgICAgICAvLyBNaW4gc3VwZXJpb3JpdHkgb2Ygdm90ZXMgImZvciIgdG8gcGFzcyB0aGUgcHJvcG9zYWwgW251bWJlciBvZiB0b2tlbnNdDQogICAgLy8gUHJvcG9zYWxzDQogICAgUHJvcG9zYWxbXSBwdWJsaWMgcHJvcG9zYWxzOw0KICAgIHVpbnQyNTYgcHVibGljIHByb3Bvc2Fsc051bWJlciA9IDA7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MzIpIHRva2Vuc0xvY2tzOyAgICAgICAgIC8vIGNvbmdyZXNzIG1lbWJlciA9PiBudW1iZXIgb2YgbG9ja3MgKHJlY3Vyc2l2ZSBtdXRleCkNCg0KICAgIC8qIENvbnRyYWN0IEV2ZW50cyAqLw0KICAgIGV2ZW50IFByb3Bvc2FsQWRkZWRFdmVudCh1aW50MjU2IHByb3Bvc2FsSUQsIGFkZHJlc3MgYmVuZWZpY2lhcnksIHVpbnQyNTYgZXRoZXJBbW91bnQsIHN0cmluZyBkZXNjcmlwdGlvbik7DQogICAgZXZlbnQgVm90ZWRFdmVudCh1aW50MjU2IHByb3Bvc2FsSUQsIGFkZHJlc3Mgdm90ZXIsIGJvb2wgaW5TdXBwb3J0LCB1aW50MjU2IHZvdGVyVG9rZW5zLCBzdHJpbmcganVzdGlmaWNhdGlvblRleHQpOw0KICAgIGV2ZW50IFByb3Bvc2FsVGFsbGllZEV2ZW50KHVpbnQyNTYgcHJvcG9zYWxJRCwgYm9vbCBxdW9ydW0sIGJvb2wgcmVzdWx0KTsNCiAgICBldmVudCBQcm9wb3NhbEV4ZWN1dGVkRXZlbnQodWludDI1NiBwcm9wb3NhbElEKTsNCiAgICBldmVudCBSdWxlc0NoYW5nZWRFdmVudCh1aW50MjU2IGNvbmdyZXNzTWVtYmVyVGhyZXNob2xkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgbWluaW11bVF1b3J1bSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MjU2IGRlYmF0aW5nUGVyaW9kLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQyNTYgbWFyZ2luRm9yTWFqb3JpdHkpOw0KDQogICAgLyogQ29udHJhY3QgU3RydWN0dXJlcyAqLw0KICAgIGVudW0gUHJvcG9zYWxTdGF0ZSB7UHJvcG9zZWQsIE5vUXVvcnVtLCBSZWplY3RlZCwgUGFzc2VkLCBFeGVjdXRlZH0NCg0KICAgIHN0cnVjdCBQcm9wb3NhbCB7DQogICAgICAgIC8qIFByb3Bvc2FsIGNvbnRlbnQgKi8NCiAgICAgICAgYWRkcmVzcyBiZW5lZmljaWFyeTsNCiAgICAgICAgdWludDI1NiBldGhlckFtb3VudDsNCiAgICAgICAgc3RyaW5nIGRlc2NyaXB0aW9uOw0KICAgICAgICBieXRlczMyIHByb3Bvc2FsSGFzaDsNCg0KICAgICAgICAvKiBQcm9wb3NhbCBzdGF0ZSAqLw0KICAgICAgICBQcm9wb3NhbFN0YXRlIHN0YXRlOw0KDQogICAgICAgIC8qIFZvdGluZyBzdGF0ZSAqLw0KICAgICAgICB1aW50MjU2IHZvdGluZ0RlYWRsaW5lOw0KICAgICAgICBWb3RlW10gdm90ZXM7DQogICAgICAgIHVpbnQyNTYgdm90ZXNOdW1iZXI7DQogICAgICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgdm90ZWQ7DQogICAgfQ0KDQogICAgc3RydWN0IFZvdGUgew0KICAgICAgICBhZGRyZXNzIHZvdGVyOw0KICAgICAgICBib29sIGluU3VwcG9ydDsNCiAgICAgICAgdWludDI1NiB2b3RlclRva2VuczsNCiAgICAgICAgc3RyaW5nIGp1c3RpZmljYXRpb25UZXh0Ow0KICAgIH0NCg0KICAgIC8qIG1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgY29uZ3Jlc3MgbWVtYmVycyB0byB2b3RlIGFuZCBjcmVhdGUgbmV3IHByb3Bvc2FscyAqLw0KICAgIG1vZGlmaWVyIG9ubHlDb25ncmVzc01lbWJlcnMgew0KICAgICAgICBpZiAoZGFzVG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpIDwgY29uZ3Jlc3NNZW1iZXJUaHJlc2hvbGQpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8qIENvbnN0cnVjdG9yICovDQogICAgZnVuY3Rpb24gREFTKA0KICAgICAgICB1aW50MjU2IF9jb25ncmVzc01lbWJlclRocmVzaG9sZCwNCiAgICAgICAgdWludDI1NiBfbWluaW11bVF1b3J1bSwNCiAgICAgICAgdWludDI1NiBfZGViYXRpbmdQZXJpb2QsDQogICAgICAgIHVpbnQyNTYgX21hcmdpbkZvck1ham9yaXR5LA0KICAgICAgICBhZGRyZXNzIF9jb25ncmVzc0xlYWRlcg0KICAgICkgcGF5YWJsZSB7DQogICAgICAgIC8vIGNyZWF0ZSBhIHNvdXJjZSBvZiBkZW1vY3JhY3kNCiAgICAgICAgZGFzVG9rZW4gPSBuZXcgREFTVG9rZW4oJ0RBJCcsICdEQSQnLCAxOCwgMTAwMDAwMDAwMCAqICgxMCAqKiAxOCksIF9jb25ncmVzc0xlYWRlcik7DQogICAgICAgIGFiY1Rva2VuID0gbmV3IEFCQ1Rva2VuKCdBbHBoYWJpdCcsICdBQkMnLCAxOCwgMjEwMDAwMDAwICogKDEwICoqIDE4KSwgX2NvbmdyZXNzTGVhZGVyKTsNCg0KICAgICAgICAvLyBzZXR1cCBydWxlcw0KICAgICAgICBjb25ncmVzc01lbWJlclRocmVzaG9sZCA9IF9jb25ncmVzc01lbWJlclRocmVzaG9sZDsNCiAgICAgICAgbWluaW11bVF1b3J1bSA9IF9taW5pbXVtUXVvcnVtOw0KICAgICAgICBkZWJhdGluZ1BlcmlvZCA9IF9kZWJhdGluZ1BlcmlvZDsNCiAgICAgICAgbWFyZ2luRm9yTWFqb3JpdHkgPSBfbWFyZ2luRm9yTWFqb3JpdHk7DQoNCiAgICAgICAgUnVsZXNDaGFuZ2VkRXZlbnQoY29uZ3Jlc3NNZW1iZXJUaHJlc2hvbGQsIG1pbmltdW1RdW9ydW0sIGRlYmF0aW5nUGVyaW9kLCBtYXJnaW5Gb3JNYWpvcml0eSk7DQogICAgfQ0KDQogICAgLy8gYmxhbmsgZmFsbGJhY2sgdG8gcmVjZWl2ZSBFVEgNCiAgICBmdW5jdGlvbigpIHBheWFibGUgeyB9DQoNCiAgICAvKiBQcm9wb3NhbC1yZWxhdGVkIGZ1bmN0aW9ucyAqLw0KDQogICAgLy8gY2FsY3VsYXRlIGhhc2ggb2YgYW4gcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBnZXRQcm9wb3NhbEhhc2goDQogICAgICAgIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LA0KICAgICAgICB1aW50MjU2IF9ldGhlckFtb3VudCwNCiAgICAgICAgYnl0ZXMgX3RyYW5zYWN0aW9uQnl0ZWNvZGUNCiAgICApDQogICAgICAgIGNvbnN0YW50DQogICAgICAgIHJldHVybnMgKGJ5dGVzMzIpDQogICAgew0KICAgICAgICByZXR1cm4gc2hhMyhfYmVuZWZpY2lhcnksIF9ldGhlckFtb3VudCwgX3RyYW5zYWN0aW9uQnl0ZWNvZGUpOw0KICAgIH0NCg0KICAgIC8vIGJsb2NrIHRva2VucyBvZiBhbiB2b3Rlcg0KICAgIGZ1bmN0aW9uIGJsb2NrVG9rZW5zKGFkZHJlc3MgX3ZvdGVyKSBpbnRlcm5hbCB7DQogICAgICAgIGlmICh0b2tlbnNMb2Nrc1tfdm90ZXJdICsgMSA8IHRva2Vuc0xvY2tzW192b3Rlcl0pIHRocm93Ow0KDQogICAgICAgIHRva2Vuc0xvY2tzW192b3Rlcl0gKz0gMTsNCiAgICAgICAgaWYgKHRva2Vuc0xvY2tzW192b3Rlcl0gPT0gMSkgew0KICAgICAgICAgICAgZGFzVG9rZW4uYmxvY2tBY2NvdW50KF92b3Rlcik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyB1bmJsb2NrIHRva2VucyBvZiBhbiB2b3Rlcg0KICAgIGZ1bmN0aW9uIHVuYmxvY2tUb2tlbnMoYWRkcmVzcyBfdm90ZXIpIGludGVybmFsIHsNCiAgICAgICAgaWYgKHRva2Vuc0xvY2tzW192b3Rlcl0gPD0gMCkgdGhyb3c7DQoNCiAgICAgICAgdG9rZW5zTG9ja3NbX3ZvdGVyXSAtPSAxOw0KICAgICAgICBpZiAodG9rZW5zTG9ja3NbX3ZvdGVyXSA9PSAwKSB7DQogICAgICAgICAgICBkYXNUb2tlbi51bmJsb2NrQWNjb3VudChfdm90ZXIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gY3JlYXRlIG5ldyBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIGNyZWF0ZVByb3Bvc2FsKA0KICAgICAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwNCiAgICAgICAgdWludDI1NiBfZXRoZXJBbW91bnQsDQogICAgICAgIHN0cmluZyBfZGVzY3JpcHRpb24sDQogICAgICAgIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlDQogICAgKQ0KICAgICAgICBvbmx5Q29uZ3Jlc3NNZW1iZXJzDQogICAgICAgIHJldHVybnMgKHVpbnQyNTYgX3Byb3Bvc2FsSUQpDQogICAgew0KICAgICAgICBfcHJvcG9zYWxJRCA9IHByb3Bvc2Fscy5sZW5ndGg7DQogICAgICAgIHByb3Bvc2Fscy5sZW5ndGggKz0gMTsNCiAgICAgICAgcHJvcG9zYWxzTnVtYmVyID0gX3Byb3Bvc2FsSUQgKyAxOw0KDQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uZXRoZXJBbW91bnQgPSBfZXRoZXJBbW91bnQ7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0ucHJvcG9zYWxIYXNoID0gZ2V0UHJvcG9zYWxIYXNoKF9iZW5lZmljaWFyeSwgX2V0aGVyQW1vdW50LCBfdHJhbnNhY3Rpb25CeXRlY29kZSk7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uc3RhdGUgPSBQcm9wb3NhbFN0YXRlLlByb3Bvc2VkOw0KICAgICAgICBwcm9wb3NhbHNbX3Byb3Bvc2FsSURdLnZvdGluZ0RlYWRsaW5lID0gbm93ICsgZGViYXRpbmdQZXJpb2QgKiAxIHNlY29uZHM7DQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0udm90ZXNOdW1iZXIgPSAwOw0KDQogICAgICAgIFByb3Bvc2FsQWRkZWRFdmVudChfcHJvcG9zYWxJRCwgX2JlbmVmaWNpYXJ5LCBfZXRoZXJBbW91bnQsIF9kZXNjcmlwdGlvbik7DQoNCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgIH0NCg0KICAgIC8vIHZvdGUgZm9yIGFuIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gdm90ZSgNCiAgICAgICAgdWludDI1NiBfcHJvcG9zYWxJRCwNCiAgICAgICAgYm9vbCBfaW5TdXBwb3J0LA0KICAgICAgICBzdHJpbmcgX2p1c3RpZmljYXRpb25UZXh0DQogICAgKQ0KICAgICAgICBvbmx5Q29uZ3Jlc3NNZW1iZXJzDQogICAgew0KICAgICAgICBQcm9wb3NhbCBwID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBpZiAocC5zdGF0ZSAhPSBQcm9wb3NhbFN0YXRlLlByb3Bvc2VkKSB0aHJvdzsNCiAgICAgICAgaWYgKHAudm90ZWRbbXNnLnNlbmRlcl0gPT0gdHJ1ZSkgdGhyb3c7DQoNCiAgICAgICAgdmFyIHZvdGVyVG9rZW5zID0gZGFzVG9rZW4uYmFsYW5jZU9mKG1zZy5zZW5kZXIpOw0KICAgICAgICBibG9ja1Rva2Vucyhtc2cuc2VuZGVyKTsNCg0KICAgICAgICBwLnZvdGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsNCiAgICAgICAgcC52b3Rlcy5wdXNoKFZvdGUobXNnLnNlbmRlciwgX2luU3VwcG9ydCwgdm90ZXJUb2tlbnMsIF9qdXN0aWZpY2F0aW9uVGV4dCkpOw0KICAgICAgICBwLnZvdGVzTnVtYmVyICs9IDE7DQoNCiAgICAgICAgVm90ZWRFdmVudChfcHJvcG9zYWxJRCwgbXNnLnNlbmRlciwgX2luU3VwcG9ydCwgdm90ZXJUb2tlbnMsIF9qdXN0aWZpY2F0aW9uVGV4dCk7DQogICAgfQ0KDQogICAgLy8gZmluaXNoIHZvdGluZyBvbiBhbiBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIGZpbmlzaFByb3Bvc2FsVm90aW5nKHVpbnQyNTYgX3Byb3Bvc2FsSUQpIG9ubHlDb25ncmVzc01lbWJlcnMgew0KICAgICAgICBQcm9wb3NhbCBwID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBpZiAobm93IDwgcC52b3RpbmdEZWFkbGluZSkgdGhyb3c7DQogICAgICAgIGlmIChwLnN0YXRlICE9IFByb3Bvc2FsU3RhdGUuUHJvcG9zZWQpIHRocm93Ow0KDQogICAgICAgIHZhciBfdm90ZXNOdW1iZXIgPSBwLnZvdGVzLmxlbmd0aDsNCiAgICAgICAgdWludDI1NiB0b2tlbnNGb3IgPSAwOw0KICAgICAgICB1aW50MjU2IHRva2Vuc0FnYWluc3QgPSAwOw0KICAgICAgICBmb3IgKHVpbnQyNTYgaSA9IDA7IGkgPCBfdm90ZXNOdW1iZXI7IGkrKykgew0KICAgICAgICAgICAgaWYgKHAudm90ZXNbaV0uaW5TdXBwb3J0KSB7DQogICAgICAgICAgICAgICAgdG9rZW5zRm9yICs9IHAudm90ZXNbaV0udm90ZXJUb2tlbnM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICB0b2tlbnNBZ2FpbnN0ICs9IHAudm90ZXNbaV0udm90ZXJUb2tlbnM7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHVuYmxvY2tUb2tlbnMocC52b3Rlc1tpXS52b3Rlcik7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoKHRva2Vuc0ZvciArIHRva2Vuc0FnYWluc3QpIDwgbWluaW11bVF1b3J1bSkgew0KICAgICAgICAgICAgcC5zdGF0ZSA9IFByb3Bvc2FsU3RhdGUuTm9RdW9ydW07DQogICAgICAgICAgICBQcm9wb3NhbFRhbGxpZWRFdmVudChfcHJvcG9zYWxJRCwgZmFsc2UsIGZhbHNlKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoKHRva2Vuc0ZvciAtIHRva2Vuc0FnYWluc3QpIDwgbWFyZ2luRm9yTWFqb3JpdHkpIHsNCiAgICAgICAgICAgIHAuc3RhdGUgPSBQcm9wb3NhbFN0YXRlLlJlamVjdGVkOw0KICAgICAgICAgICAgUHJvcG9zYWxUYWxsaWVkRXZlbnQoX3Byb3Bvc2FsSUQsIHRydWUsIGZhbHNlKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBwLnN0YXRlID0gUHJvcG9zYWxTdGF0ZS5QYXNzZWQ7DQogICAgICAgIFByb3Bvc2FsVGFsbGllZEV2ZW50KF9wcm9wb3NhbElELCB0cnVlLCB0cnVlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIGV4ZWN1dGUgcGFzc2VkIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gZXhlY3V0ZVByb3Bvc2FsKHVpbnQyNTYgX3Byb3Bvc2FsSUQsIGJ5dGVzIF90cmFuc2FjdGlvbkJ5dGVjb2RlKSBvbmx5Q29uZ3Jlc3NNZW1iZXJzIHsNCiAgICAgICAgUHJvcG9zYWwgcCA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQoNCiAgICAgICAgaWYgKHAuc3RhdGUgIT0gUHJvcG9zYWxTdGF0ZS5QYXNzZWQpIHRocm93Ow0KDQogICAgICAgIHAuc3RhdGUgPSBQcm9wb3NhbFN0YXRlLkV4ZWN1dGVkOw0KICAgICAgICBpZiAoIXAuYmVuZWZpY2lhcnkuY2FsbC52YWx1ZShwLmV0aGVyQW1vdW50ICogMSBldGhlcikoX3RyYW5zYWN0aW9uQnl0ZWNvZGUpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KDQogICAgICAgIFByb3Bvc2FsRXhlY3V0ZWRFdmVudChfcHJvcG9zYWxJRCk7DQogICAgfQ0KfQ=='