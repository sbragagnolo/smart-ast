base 64 content
base64deCenterToken
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3Qgb3duZWQgew0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogICAgZnVuY3Rpb24gb3duZWQoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOw0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KfQ0KDQpjb250cmFjdCBEU01hdGggew0KDQogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsNCiAgICAgICAgYXNzZXJ0KCh6ID0geCArIHkpID49IHgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7DQogICAgICAgIGFzc2VydCgoeiA9IHggLSB5KSA8PSB4KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICBhc3NlcnQoKHogPSB4ICogeSkgPj0geCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsNCiAgICAgICAgeiA9IHggLyB5Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG1pbih1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7DQogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBtYXgodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICByZXR1cm4geCA+PSB5ID8geCA6IHk7DQogICAgfQ0KfQ0KDQoNCmNvbnRyYWN0IHF1ZXVlIHsNCiAgICBRdWV1ZSBwdWJsaWMgcTsNCg0KICAgIHN0cnVjdCBCdXlUaWNrZXQgew0KICAgICAgICBhZGRyZXNzIGFjY291bnQ7DQogICAgICAgIHVpbnQgYW1vdW50Ow0KICAgICAgICB1aW50IHRpbWU7DQogICAgfQ0KDQogICAgc3RydWN0IFF1ZXVlIHsNCiAgICAgICAgQnV5VGlja2V0W10gZGF0YTsNCiAgICAgICAgdWludCBmcm9udDsNCiAgICAgICAgdWludCBiYWNrOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHF1ZXVlU2l6ZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcikgew0KICAgICAgICByID0gcS5iYWNrIC0gcS5mcm9udDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBxdWV1ZSgpIHsNCiAgICAgICAgcS5kYXRhLmxlbmd0aCA9IDYwMDAwMDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwdXNoUXVldWUoQnV5VGlja2V0IHRpY2tldCkgaW50ZXJuYWwgew0KICAgICAgICByZXF1aXJlKChxLmJhY2sgKyAxKSAlIHEuZGF0YS5sZW5ndGggIT0gcS5mcm9udCk7DQoNCiAgICAgICAgcS5kYXRhW3EuYmFja10gPSB0aWNrZXQ7DQogICAgICAgIHEuYmFjayA9IChxLmJhY2sgKyAxKSAlIHEuZGF0YS5sZW5ndGg7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcGVla1F1ZXVlKCkgaW50ZXJuYWwgcmV0dXJucyAoQnV5VGlja2V0IHIpIHsNCiAgICAgICAgcmVxdWlyZShxLmJhY2sgIT0gcS5mcm9udCk7DQoNCiAgICAgICAgciA9IHEuZGF0YVtxLmZyb250XTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwb3BRdWV1ZSgpIGludGVybmFsIHsNCiAgICAgICAgcmVxdWlyZShxLmJhY2sgIT0gcS5mcm9udCk7DQoNCiAgICAgICAgZGVsZXRlIHEuZGF0YVtxLmZyb250XTsNCiAgICAgICAgcS5mcm9udCA9IChxLmZyb250ICsgMSkgJSBxLmRhdGEubGVuZ3RoOw0KICAgIH0NCn0NCg0KY29udHJhY3QgRGVDZW50ZXJUb2tlbiBpcyBvd25lZCwgcXVldWUsIERTTWF0aCB7DQogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICdUb2tlbiAwLjEnOw0KICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICdEZUNlbnRlcic7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAnREMnOw0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDg7DQoNCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDAwMDAwOyAvLyAxMDAgbWlsbGlvbg0KICAgIHVpbnQyNTYgcHVibGljIGF2YWlsYWJsZVRva2VucyA9IDYwMDAwMDAwMDAwMDAwMDA7IC8vIDYwIG1pbGxpb24NCiAgICB1aW50MjU2IHB1YmxpYyB0ZWFtQW5kRXhwZXJ0c1Rva2VucyA9IDQwMDAwMDAwMDAwMDAwMDA7IC8vIDQwIG1pbGxpb24NCiAgICB1aW50MjU2IHB1YmxpYyBwcmljZSA9IDAuMDAwMDAwMDAwMSBldGhlcjsgLy8gMC4wMSBldGhlciBwZXIgdG9rZW4NCg0KICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsNCiAgICB1aW50IHB1YmxpYyByZWZ1bmRTdGFydFRpbWU7DQogICAgdWludCBwdWJsaWMgcmVmdW5kRHVyYXRpb24gPSAzIGRheXM7IC8vIDMgeWVhcnMNCiAgICB1aW50IHB1YmxpYyBmaXJzdFN0YWdlRHVyYXRpb24gPSAzIGRheXM7IC8vIDMxIGRheXMNCiAgICB1aW50IHB1YmxpYyBsYXN0U2NoZWR1bGVkVG9wVXA7DQogICAgdWludCBwdWJsaWMgbGFzdFByb2Nlc3NlZERheSA9IDM7DQoNCiAgICB1aW50IHB1YmxpYyBtYXhEYWlseUNhcCA9IDMzMzMzMDAwMDAwMDA7IC8vIDMzIDMzMyBEQw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gdWludCkgcHVibGljIGRhaWx5VG90YWxzOw0KDQogICAgdWludCBwdWJsaWMgcXVldWVkQW1vdW50Ow0KDQogICAgYWRkcmVzcyBwdWJsaWMgYmVuZWZpY2lhcnk7DQogICAgYWRkcmVzcyBwdWJsaWMgZXhwZXJ0c0FjY291bnQ7DQogICAgYWRkcmVzcyBwdWJsaWMgdGVhbUFjY291bnQ7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIHB1YmxpYyBhbGxvd2FuY2U7DQoNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsNCg0KICAgIC8vIGZvciB0ZXN0aW5nDQogICAgdWludCBwdWJsaWMgY1RpbWUgPSAwOw0KICAgIGZ1bmN0aW9uIHNldENUaW1lKHVpbnQgX2NUaW1lKSBvbmx5T3duZXIgew0KICAgICAgICBjVGltZSA9IF9jVGltZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBEZUNlbnRlclRva2VuKA0KICAgIGFkZHJlc3MgX2JlbmVmaWNpYXJ5LA0KICAgIGFkZHJlc3MgX2V4cGVydHNBY2NvdW50LA0KICAgIGFkZHJlc3MgX3RlYW1BY2NvdW50LA0KICAgIHVpbnQgX3N0YXJ0VGltZSwNCiAgICB1aW50IF9yZWZ1bmRTdGFydFRpbWUNCiAgICApIHsNCiAgICAgICAgYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7DQogICAgICAgIGV4cGVydHNBY2NvdW50ID0gX2V4cGVydHNBY2NvdW50Ow0KICAgICAgICB0ZWFtQWNjb3VudCA9IF90ZWFtQWNjb3VudDsNCg0KICAgICAgICBzdGFydFRpbWUgPSBfc3RhcnRUaW1lOw0KICAgICAgICByZWZ1bmRTdGFydFRpbWUgPSBfcmVmdW5kU3RhcnRUaW1lOw0KDQogICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IHRvdGFsU3VwcGx5Ow0KDQogICAgICAgIHNjaGVkdWxlZFRvcFVwKCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdGltZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgLy8gZm9yIHRlc3RpbmcNCiAgICAgICAgaWYoY1RpbWUgPiAwKSB7DQogICAgICAgICAgICByZXR1cm4gY1RpbWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gYmxvY2sudGltZXN0YW1wOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvZGF5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gZGF5Rm9yKHRpbWUoKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGF5Rm9yKHVpbnQgdGltZXN0YW1wKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBzdWIodGltZXN0YW1wLCBzdGFydFRpbWUpIC8gMjQgaG91cnM7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbG93ZXJMaW1pdEZvclRvZGF5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gdG9kYXkoKSAqIDEgZXRoZXI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2NoZWR1bGVkVG9wVXAoKSBvbmx5T3duZXIgew0KICAgICAgICB1aW50IHBheW1lbnQgPSA0MDAwMDAwMDAwMDAwMDA7IC8vIDQgbWlsbGlvbiB0b2tlbnMNCg0KICAgICAgICByZXF1aXJlKHN1Yih0aW1lKCksIGxhc3RTY2hlZHVsZWRUb3BVcCkgPj0gMSB5ZWFycyk7DQogICAgICAgIHJlcXVpcmUodGVhbUFuZEV4cGVydHNUb2tlbnMgPj0gcGF5bWVudCAqIDIpOw0KDQogICAgICAgIGxhc3RTY2hlZHVsZWRUb3BVcCA9IHRpbWUoKTsNCg0KICAgICAgICB0ZWFtQW5kRXhwZXJ0c1Rva2VucyAtPSBwYXltZW50Ow0KICAgICAgICBiYWxhbmNlT2ZbdGhpc10gPSBzdWIoYmFsYW5jZU9mW3RoaXNdLCBwYXltZW50KTsNCiAgICAgICAgYmFsYW5jZU9mW2V4cGVydHNBY2NvdW50XSA9IGFkZChiYWxhbmNlT2ZbZXhwZXJ0c0FjY291bnRdLCBwYXltZW50KTsNCg0KICAgICAgICB0ZWFtQW5kRXhwZXJ0c1Rva2VucyAtPSBwYXltZW50Ow0KICAgICAgICBiYWxhbmNlT2ZbdGhpc10gPSBzdWIoYmFsYW5jZU9mW3RoaXNdLCBwYXltZW50KTsNCiAgICAgICAgYmFsYW5jZU9mW3RlYW1BY2NvdW50XSA9IGFkZChiYWxhbmNlT2ZbdGVhbUFjY291bnRdLCBwYXltZW50KTsNCg0KICAgICAgICBUcmFuc2Zlcih0aGlzLCBleHBlcnRzQWNjb3VudCwgcGF5bWVudCk7IC8vIGV4ZWN1dGUgYW4gZXZlbnQgcmVmbGVjdGluZyB0aGUgY2hhbmdlDQogICAgICAgIFRyYW5zZmVyKHRoaXMsIHRlYW1BY2NvdW50LCBwYXltZW50KTsgLy8gZXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UNCiAgICB9DQoNCiAgICAvKiBBbGxvdyBhbm90aGVyIGNvbnRyYWN0IHRvIHNwZW5kIHNvbWUgdG9rZW5zIGluIHlvdXIgYmVoYWxmICovDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVmdW5kKHVpbnQyNTYgX3ZhbHVlKSBpbnRlcm5hbCB7DQogICAgICAgIHJlcXVpcmUodGltZSgpID4gcmVmdW5kU3RhcnRUaW1lKTsNCiAgICAgICAgcmVxdWlyZSh0aGlzLmJhbGFuY2UgPj0gX3ZhbHVlICogcHJpY2UpOw0KDQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IHN1YihiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IGFkZChiYWxhbmNlT2ZbdGhpc10sIF92YWx1ZSk7DQogICAgICAgIGF2YWlsYWJsZVRva2VucyA9IGFkZChhdmFpbGFibGVUb2tlbnMsIF92YWx1ZSk7DQoNCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihfdmFsdWUgKiBwcmljZSk7DQoNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgdGhpcywgX3ZhbHVlKTsgLy8gTm90aWZ5IGFueW9uZSBsaXN0ZW5pbmcgdGhhdCB0aGlzIHRyYW5zZmVyIHRvb2sgcGxhY2UNCiAgICB9DQoNCiAgICAvKiBTZW5kIHRva2VucyAqLw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgew0KICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOyAvLyBDaGVjayBpZiB0aGUgc2VuZGVyIGhhcyBlbm91Z2gNCg0KICAgICAgICBpZiAoX3RvID09IGFkZHJlc3ModGhpcykpIHsNCiAgICAgICAgICAgIHJlZnVuZChfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gc3ViKGJhbGFuY2VPZlttc2cuc2VuZGVyXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBhZGQoYmFsYW5jZU9mW190b10sIF92YWx1ZSk7DQoNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOyAvLyBOb3RpZnkgYW55b25lIGxpc3RlbmluZyB0aGF0IHRoaXMgdHJhbnNmZXIgdG9vayBwbGFjZQ0KICAgIH0NCg0KICAgIC8qIEEgY29udHJhY3QgYXR0ZW1wdHMgdG8gZ2V0IHRoZSB0b2tlbnMgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbX2Zyb21dID49IF92YWx1ZSk7IC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaA0KICAgICAgICByZXF1aXJlKF92YWx1ZSA8PSBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdKTsgLy8gQ2hlY2sgYWxsb3dhbmNlDQoNCiAgICAgICAgYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSA9IHN1YihhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdLCBfdmFsdWUpOyAvLyAgU3VidHJhY3QgZnJvbSB0aGUgYWxsb3dhbmNlDQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gPSBzdWIoYmFsYW5jZU9mW19mcm9tXSwgX3ZhbHVlKTsgLy8gU3VidHJhY3QgZnJvbSB0aGUgc2VuZGVyDQogICAgICAgIGJhbGFuY2VPZltfdG9dID0gYWRkKGJhbGFuY2VPZltfdG9dLCBfdmFsdWUpOyAvLyBBZGQgdGhlIHNhbWUgdG8gdGhlIHJlY2lwaWVudA0KDQogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2xvc2VSZWZ1bmQoKSBvbmx5T3duZXIgew0KICAgICAgICByZXF1aXJlKHRpbWUoKSAtIHJlZnVuZFN0YXJ0VGltZSA+IHJlZnVuZER1cmF0aW9uKTsNCg0KICAgICAgICBiZW5lZmljaWFyeS50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOw0KICAgIH0NCg0KICAgIC8qDQogICAgICogICAgVG9rZW4gcHVyY2hhc2luZyBoYXMgMiBzdGFnZXM6DQogICAgICogICAgICAgLSBGaXJzdCBzdGFnZSBob2xkcyAzMSBkYXlzLiBUaGVyZSBpcyBubyBsaW1pdCBvZiBidXlpbmcuDQogICAgICogICAgICAgLSBTZWNvbmQgc3RhZ2UgaG9sZHMgfjUgeWVhcnMgYWZ0ZXIuIFRoZXJlIHdpbGwgYmUgbGltaXQgb2YgMzMzLjMzIGV0aGVyIHBlciBkYXkuDQogICAgICovDQogICAgZnVuY3Rpb24gYnV5KCkgcGF5YWJsZSB7DQogICAgICAgIHJlcXVpcmUoc3RhcnRUaW1lIDw9IHRpbWUoKSk7IC8vIGNoZWNrIGlmIElDTyBpcyBnb2luZw0KDQogICAgICAgIHVpbnQgYW1vdW50ID0gZGl2KG1zZy52YWx1ZSwgcHJpY2UpOw0KDQogICAgICAgIGlmICh0aW1lKCkgLSBzdGFydFRpbWUgPiBmaXJzdFN0YWdlRHVyYXRpb24pIHsgLy8gc2Vjb25kIHN0YWdlDQogICAgICAgICAgICByZXF1aXJlKDEgZXRoZXIgPD0gbXNnLnZhbHVlKTsgLy8gY2hlY2sgbWluLiBsaW1pdA0KICAgICAgICAgICAgcmVxdWlyZShtc2cudmFsdWUgPD0gMzAwIGV0aGVyKTsgLy8gY2hlY2sgbWF4LiBsaW1pdA0KDQogICAgICAgICAgICAvLyBzZW5kIDgwJSB0byBiZW5lZmljaWFyeSBhY2NvdW50LCBhbm90aGVyIDIwJSBzdGF5cyBmb3IgcmVmdW5kaW5nDQogICAgICAgICAgICBiZW5lZmljaWFyeS50cmFuc2ZlcihtdWwoZGl2KG1zZy52YWx1ZSwgNSksIDQpKTsNCg0KICAgICAgICAgICAgdWludCBjdXJyZW50RGF5ID0gbGFzdFByb2Nlc3NlZERheSArIDE7DQogICAgICAgICAgICB1aW50IGxpbWl0ID0gbWF4RGFpbHlDYXAgLSBkYWlseVRvdGFsc1tjdXJyZW50RGF5XTsNCg0KICAgICAgICAgICAgaWYgKGxpbWl0ID49IGFtb3VudCkgew0KICAgICAgICAgICAgICAgIGF2YWlsYWJsZVRva2VucyA9IHN1YihhdmFpbGFibGVUb2tlbnMsIGFtb3VudCk7DQogICAgICAgICAgICAgICAgYmFsYW5jZU9mW3RoaXNdID0gc3ViKGJhbGFuY2VPZlt0aGlzXSwgYW1vdW50KTsgLy8gc3VidHJhY3RzIGFtb3VudCBmcm9tIHNlbGxlcidzIGJhbGFuY2UNCiAgICAgICAgICAgICAgICBkYWlseVRvdGFsc1tjdXJyZW50RGF5XSA9IGFkZChkYWlseVRvdGFsc1tjdXJyZW50RGF5XSwgYW1vdW50KTsNCiAgICAgICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBhZGQoYmFsYW5jZU9mW21zZy5zZW5kZXJdLCBhbW91bnQpOyAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlDQoNCiAgICAgICAgICAgICAgICBUcmFuc2Zlcih0aGlzLCBtc2cuc2VuZGVyLCBhbW91bnQpOyAvLyBleGVjdXRlIGFuIGV2ZW50IHJlZmxlY3RpbmcgdGhlIGNoYW5nZQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBxdWV1ZWRBbW91bnQgPSBhZGQocXVldWVkQW1vdW50LCBhbW91bnQpOw0KICAgICAgICAgICAgICAgIHJlcXVpcmUocXVldWVkQW1vdW50IDw9IGF2YWlsYWJsZVRva2Vucyk7DQogICAgICAgICAgICAgICAgQnV5VGlja2V0IG1lbW9yeSB0aWNrZXQgPSBCdXlUaWNrZXQoe2FjY291bnQ6IG1zZy5zZW5kZXIsIGFtb3VudDogYW1vdW50LCB0aW1lOiB0aW1lKCl9KTsNCiAgICAgICAgICAgICAgICBwdXNoUXVldWUodGlja2V0KTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9IGVsc2UgeyAvLyBmaXJzdCBzdGFnZQ0KICAgICAgICAgICAgcmVxdWlyZShsb3dlckxpbWl0Rm9yVG9kYXkoKSA8PSBtc2cudmFsdWUpOyAvLyBjaGVjayBtaW4uIGxpbWl0DQogICAgICAgICAgICByZXF1aXJlKGFtb3VudCA8PSBhdmFpbGFibGVUb2tlbnMpOw0KDQogICAgICAgICAgICAvLyBzZW5kIDgwJSB0byBiZW5lZmljaWFyeSBhY2NvdW50LCBhbm90aGVyIDIwJSBzdGF5cyBmb3IgcmVmdW5kaW5nDQogICAgICAgICAgICBiZW5lZmljaWFyeS50cmFuc2ZlcihtdWwoZGl2KG1zZy52YWx1ZSwgNSksIDQpKTsNCg0KICAgICAgICAgICAgYXZhaWxhYmxlVG9rZW5zID0gc3ViKGF2YWlsYWJsZVRva2VucywgYW1vdW50KTsNCiAgICAgICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IHN1YihiYWxhbmNlT2ZbdGhpc10sIGFtb3VudCk7IC8vIHN1YnRyYWN0cyBhbW91bnQgZnJvbSBzZWxsZXIncyBiYWxhbmNlDQogICAgICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBhZGQoYmFsYW5jZU9mW21zZy5zZW5kZXJdLCBhbW91bnQpOyAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlDQoNCiAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7IC8vIGV4ZWN1dGUgYW4gZXZlbnQgcmVmbGVjdGluZyB0aGUgY2hhbmdlDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwcm9jZXNzUGVuZGluZ1RpY2tldHMoKSBvbmx5T3duZXIgew0KDQogICAgICAgIHVpbnQgc2l6ZSA9IHF1ZXVlU2l6ZSgpOw0KICAgICAgICB1aW50IHB0ciA9IDA7DQogICAgICAgIHVpbnQgY3VycmVudERheTsNCiAgICAgICAgdWludCBsaW1pdDsNCiAgICAgICAgQnV5VGlja2V0IG1lbW9yeSB0aWNrZXQ7DQoNCiAgICAgICAgd2hpbGUgKHB0ciA8IHNpemUpIHsNCiAgICAgICAgICAgIGN1cnJlbnREYXkgPSBsYXN0UHJvY2Vzc2VkRGF5ICsgMTsNCiAgICAgICAgICAgIGxpbWl0ID0gbWF4RGFpbHlDYXAgLSBkYWlseVRvdGFsc1tjdXJyZW50RGF5XTsNCg0KICAgICAgICAgICAgLy8gc3RvcCB0aGVuIHRyeWluZyB0byBwcm9jZXNzIGZ1dHVyZQ0KICAgICAgICAgICAgaWYgKHN0YXJ0VGltZSArIChjdXJyZW50RGF5IC0gMSkgKiAxIGRheXMgPiB0aW1lKCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIGxpbWl0IHRvIHByZXZlbnQgb3V0IG9mIGdhcyBlcnJvcg0KICAgICAgICAgICAgaWYgKHB0ciA+IDUwKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aWNrZXQgPSBwZWVrUXVldWUoKTsNCg0KICAgICAgICAgICAgaWYgKGxpbWl0IDwgdGlja2V0LmFtb3VudCB8fCB0aWNrZXQudGltZSAtIDEwMDAgc2Vjb25kcyA+IHN0YXJ0VGltZSArIChjdXJyZW50RGF5IC0gMSkgKiAxIGRheXMpIHsNCiAgICAgICAgICAgICAgICBsYXN0UHJvY2Vzc2VkRGF5ICs9IDE7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHBvcFF1ZXVlKCk7DQogICAgICAgICAgICBwdHIgKz0gMTsNCg0KICAgICAgICAgICAgYXZhaWxhYmxlVG9rZW5zID0gc3ViKGF2YWlsYWJsZVRva2VucywgdGlja2V0LmFtb3VudCk7DQogICAgICAgICAgICBxdWV1ZWRBbW91bnQgPSBzdWIocXVldWVkQW1vdW50LCB0aWNrZXQuYW1vdW50KTsNCiAgICAgICAgICAgIGRhaWx5VG90YWxzW2N1cnJlbnREYXldID0gYWRkKGRhaWx5VG90YWxzW2N1cnJlbnREYXldLCB0aWNrZXQuYW1vdW50KTsNCiAgICAgICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IHN1YihiYWxhbmNlT2ZbdGhpc10sIHRpY2tldC5hbW91bnQpOw0KICAgICAgICAgICAgYmFsYW5jZU9mW3RpY2tldC5hY2NvdW50XSA9IGFkZChiYWxhbmNlT2ZbdGlja2V0LmFjY291bnRdLCB0aWNrZXQuYW1vdW50KTsgLy8gYWRkcyB0aGUgYW1vdW50IHRvIGJ1eWVyJ3MgYmFsYW5jZQ0KDQogICAgICAgICAgICBUcmFuc2Zlcih0aGlzLCB0aWNrZXQuYWNjb3VudCwgdGlja2V0LmFtb3VudCk7IC8vIGV4ZWN1dGUgYW4gZXZlbnQgcmVmbGVjdGluZyB0aGUgY2hhbmdlDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbigpIHBheWFibGUgew0KICAgICAgICBidXkoKTsNCiAgICB9DQp9'