base 64 content
base64deCenterToken2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3Qgb3duZWQgew0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogICAgZnVuY3Rpb24gb3duZWQoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOw0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KfQ0KDQpjb250cmFjdCBEU01hdGggew0KDQogICAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsNCiAgICAgICAgYXNzZXJ0KCh6ID0geCArIHkpID49IHgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN1Yih1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7DQogICAgICAgIGFzc2VydCgoeiA9IHggLSB5KSA8PSB4KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBtdWwodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICBhc3NlcnQoKHogPSB4ICogeSkgPj0geCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGl2KHVpbnQyNTYgeCwgdWludDI1NiB5KSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2IHopIHsNCiAgICAgICAgeiA9IHggLyB5Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG1pbih1aW50MjU2IHgsIHVpbnQyNTYgeSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiB6KSB7DQogICAgICAgIHJldHVybiB4IDw9IHkgPyB4IDogeTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBtYXgodWludDI1NiB4LCB1aW50MjU2IHkpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgeikgew0KICAgICAgICByZXR1cm4geCA+PSB5ID8geCA6IHk7DQogICAgfQ0KfQ0KDQoNCmNvbnRyYWN0IHF1ZXVlIHsNCiAgICBRdWV1ZSBwdWJsaWMgcTsNCg0KICAgIHN0cnVjdCBCdXlUaWNrZXQgew0KICAgICAgICBhZGRyZXNzIGFjY291bnQ7DQogICAgICAgIHVpbnQgYW1vdW50Ow0KICAgICAgICB1aW50IHRpbWU7DQogICAgfQ0KDQogICAgc3RydWN0IFF1ZXVlIHsNCiAgICAgICAgQnV5VGlja2V0W10gZGF0YTsNCiAgICAgICAgdWludCBmcm9udDsNCiAgICAgICAgdWludCBiYWNrOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHF1ZXVlU2l6ZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgcikgew0KICAgICAgICByID0gcS5iYWNrIC0gcS5mcm9udDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBxdWV1ZSgpIHsNCiAgICAgICAgcS5kYXRhLmxlbmd0aCA9IDYwMDAwMDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwdXNoUXVldWUoQnV5VGlja2V0IHRpY2tldCkgaW50ZXJuYWwgew0KICAgICAgICByZXF1aXJlKChxLmJhY2sgKyAxKSAlIHEuZGF0YS5sZW5ndGggIT0gcS5mcm9udCk7DQoNCiAgICAgICAgcS5kYXRhW3EuYmFja10gPSB0aWNrZXQ7DQogICAgICAgIHEuYmFjayA9IChxLmJhY2sgKyAxKSAlIHEuZGF0YS5sZW5ndGg7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcGVla1F1ZXVlKCkgaW50ZXJuYWwgcmV0dXJucyAoQnV5VGlja2V0IHIpIHsNCiAgICAgICAgcmVxdWlyZShxLmJhY2sgIT0gcS5mcm9udCk7DQoNCiAgICAgICAgciA9IHEuZGF0YVtxLmZyb250XTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwb3BRdWV1ZSgpIGludGVybmFsIHsNCiAgICAgICAgcmVxdWlyZShxLmJhY2sgIT0gcS5mcm9udCk7DQoNCiAgICAgICAgZGVsZXRlIHEuZGF0YVtxLmZyb250XTsNCiAgICAgICAgcS5mcm9udCA9IChxLmZyb250ICsgMSkgJSBxLmRhdGEubGVuZ3RoOw0KICAgIH0NCn0NCg0KY29udHJhY3QgRGVDZW50ZXJUb2tlbiBpcyBvd25lZCwgcXVldWUsIERTTWF0aCB7DQogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICdUb2tlbiAwLjEnOw0KICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICdEZUNlbnRlcic7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAnREMnOw0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFscyA9IDg7DQoNCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDAwMDAwOyAvLyAxMDAgbWlsbGlvbg0KICAgIHVpbnQyNTYgcHVibGljIGF2YWlsYWJsZVRva2VucyA9IDYwMDAwMDAwMDAwMDAwMDA7IC8vIDYwIG1pbGxpb24NCiAgICB1aW50MjU2IHB1YmxpYyB0ZWFtQW5kRXhwZXJ0c1Rva2VucyA9IDQwMDAwMDAwMDAwMDAwMDA7IC8vIDQwIG1pbGxpb24NCiAgICB1aW50MjU2IHB1YmxpYyBwcmljZSA9IDAuMDAwMDAwMDAwMSBldGhlcjsgLy8gMC4wMSBldGhlciBwZXIgdG9rZW4NCg0KICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsNCiAgICB1aW50IHB1YmxpYyByZWZ1bmRTdGFydFRpbWU7DQogICAgdWludCBwdWJsaWMgcmVmdW5kRHVyYXRpb24gPSAzIGRheXM7IC8vIDMgeWVhcnMNCiAgICB1aW50IHB1YmxpYyBmaXJzdFN0YWdlRHVyYXRpb24gPSAzIGRheXM7IC8vIDMxIGRheXMNCg0KICAgIHVpbnQgcHVibGljIG1heERhaWx5Q2FwID0gMzMzMzMwMDAwMDAwMDsgLy8gMzMgMzMzIERDDQogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBwdWJsaWMgZGFpbHlUb3RhbHM7DQoNCiAgICB1aW50IHB1YmxpYyBxdWV1ZWRBbW91bnQ7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsNCiAgICBhZGRyZXNzIHB1YmxpYyBleHBlcnRzQWNjb3VudDsNCiAgICBhZGRyZXNzIHB1YmxpYyB0ZWFtQWNjb3VudDsNCg0KICAgIHVpbnQgcHVibGljIGxhc3RTY2hlZHVsZWRUb3BVcDsNCiAgICB1aW50IHB1YmxpYyBsYXN0UHJvY2Vzc2VkRGF5Ow0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZU9mOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dhbmNlOw0KDQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQoNCiAgICAvLyBmb3IgdGVzdGluZw0KICAgIHVpbnQgcHVibGljIGNUaW1lID0gMDsNCiAgICBmdW5jdGlvbiBzZXRDVGltZSh1aW50IF9jVGltZSkgb25seU93bmVyIHsNCiAgICAgICAgY1RpbWUgPSBfY1RpbWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gRGVDZW50ZXJUb2tlbigNCiAgICBhZGRyZXNzIF9iZW5lZmljaWFyeSwNCiAgICBhZGRyZXNzIF9leHBlcnRzQWNjb3VudCwNCiAgICBhZGRyZXNzIF90ZWFtQWNjb3VudCwNCiAgICB1aW50IF9zdGFydFRpbWUsDQogICAgdWludCBfcmVmdW5kU3RhcnRUaW1lDQogICAgKSB7DQogICAgICAgIGJlbmVmaWNpYXJ5ID0gX2JlbmVmaWNpYXJ5Ow0KICAgICAgICBleHBlcnRzQWNjb3VudCA9IF9leHBlcnRzQWNjb3VudDsNCiAgICAgICAgdGVhbUFjY291bnQgPSBfdGVhbUFjY291bnQ7DQoNCiAgICAgICAgc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsNCiAgICAgICAgcmVmdW5kU3RhcnRUaW1lID0gX3JlZnVuZFN0YXJ0VGltZTsNCg0KICAgICAgICBiYWxhbmNlT2ZbdGhpc10gPSB0b3RhbFN1cHBseTsNCg0KICAgICAgICBsYXN0UHJvY2Vzc2VkRGF5ID0gZGF5Rm9yKHN0YXJ0VGltZSArIGZpcnN0U3RhZ2VEdXJhdGlvbiAqIDEgZGF5cyk7DQoNCiAgICAgICAgc2NoZWR1bGVkVG9wVXAoKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0aW1lKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICAvLyBmb3IgdGVzdGluZw0KICAgICAgICBpZihjVGltZSA+IDApIHsNCiAgICAgICAgICAgIHJldHVybiBjVGltZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBibG9jay50aW1lc3RhbXA7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdG9kYXkoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBkYXlGb3IodGltZSgpKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkYXlGb3IodWludCB0aW1lc3RhbXApIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIHN1Yih0aW1lc3RhbXAsIHN0YXJ0VGltZSkgLyAyNCBob3VyczsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBsb3dlckxpbWl0Rm9yVG9kYXkoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiB0b2RheSgpICogMSBldGhlcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzY2hlZHVsZWRUb3BVcCgpIG9ubHlPd25lciB7DQogICAgICAgIHVpbnQgcGF5bWVudCA9IDQwMDAwMDAwMDAwMDAwMDsgLy8gNCBtaWxsaW9uIHRva2Vucw0KDQogICAgICAgIHJlcXVpcmUoc3ViKHRpbWUoKSwgbGFzdFNjaGVkdWxlZFRvcFVwKSA+PSAxIHllYXJzKTsNCiAgICAgICAgcmVxdWlyZSh0ZWFtQW5kRXhwZXJ0c1Rva2VucyA+PSBwYXltZW50ICogMik7DQoNCiAgICAgICAgbGFzdFNjaGVkdWxlZFRvcFVwID0gdGltZSgpOw0KDQogICAgICAgIHRlYW1BbmRFeHBlcnRzVG9rZW5zIC09IHBheW1lbnQ7DQogICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IHN1YihiYWxhbmNlT2ZbdGhpc10sIHBheW1lbnQpOw0KICAgICAgICBiYWxhbmNlT2ZbZXhwZXJ0c0FjY291bnRdID0gYWRkKGJhbGFuY2VPZltleHBlcnRzQWNjb3VudF0sIHBheW1lbnQpOw0KDQogICAgICAgIHRlYW1BbmRFeHBlcnRzVG9rZW5zIC09IHBheW1lbnQ7DQogICAgICAgIGJhbGFuY2VPZlt0aGlzXSA9IHN1YihiYWxhbmNlT2ZbdGhpc10sIHBheW1lbnQpOw0KICAgICAgICBiYWxhbmNlT2ZbdGVhbUFjY291bnRdID0gYWRkKGJhbGFuY2VPZlt0ZWFtQWNjb3VudF0sIHBheW1lbnQpOw0KDQogICAgICAgIFRyYW5zZmVyKHRoaXMsIGV4cGVydHNBY2NvdW50LCBwYXltZW50KTsgLy8gZXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UNCiAgICAgICAgVHJhbnNmZXIodGhpcywgdGVhbUFjY291bnQsIHBheW1lbnQpOyAvLyBleGVjdXRlIGFuIGV2ZW50IHJlZmxlY3RpbmcgdGhlIGNoYW5nZQ0KICAgIH0NCg0KICAgIC8qIEFsbG93IGFub3RoZXIgY29udHJhY3QgdG8gc3BlbmQgc29tZSB0b2tlbnMgaW4geW91ciBiZWhhbGYgKi8NCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZWZ1bmQodWludDI1NiBfdmFsdWUpIGludGVybmFsIHsNCiAgICAgICAgcmVxdWlyZSh0aW1lKCkgPiByZWZ1bmRTdGFydFRpbWUpOw0KICAgICAgICByZXF1aXJlKHRoaXMuYmFsYW5jZSA+PSBfdmFsdWUgKiBwcmljZSk7DQoNCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gc3ViKGJhbGFuY2VPZlttc2cuc2VuZGVyXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW3RoaXNdID0gYWRkKGJhbGFuY2VPZlt0aGlzXSwgX3ZhbHVlKTsNCiAgICAgICAgYXZhaWxhYmxlVG9rZW5zID0gYWRkKGF2YWlsYWJsZVRva2VucywgX3ZhbHVlKTsNCg0KICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKF92YWx1ZSAqIHByaWNlKTsNCg0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCB0aGlzLCBfdmFsdWUpOyAvLyBOb3RpZnkgYW55b25lIGxpc3RlbmluZyB0aGF0IHRoaXMgdHJhbnNmZXIgdG9vayBwbGFjZQ0KICAgIH0NCg0KICAgIC8qIFNlbmQgdG9rZW5zICovDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSB7DQogICAgICAgIHJlcXVpcmUoYmFsYW5jZU9mW21zZy5zZW5kZXJdID49IF92YWx1ZSk7IC8vIENoZWNrIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaA0KDQogICAgICAgIGlmIChfdG8gPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgICAgICAgcmVmdW5kKF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBzdWIoYmFsYW5jZU9mW21zZy5zZW5kZXJdLCBfdmFsdWUpOw0KICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IGFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsNCg0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7IC8vIE5vdGlmeSBhbnlvbmUgbGlzdGVuaW5nIHRoYXQgdGhpcyB0cmFuc2ZlciB0b29rIHBsYWNlDQogICAgfQ0KDQogICAgLyogQSBjb250cmFjdCBhdHRlbXB0cyB0byBnZXQgdGhlIHRva2VucyAqLw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICByZXF1aXJlKGJhbGFuY2VPZltfZnJvbV0gPj0gX3ZhbHVlKTsgLy8gQ2hlY2sgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoDQogICAgICAgIHJlcXVpcmUoX3ZhbHVlIDw9IGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0pOyAvLyBDaGVjayBhbGxvd2FuY2UNCg0KICAgICAgICBhbGxvd2FuY2VbX2Zyb21dW21zZy5zZW5kZXJdID0gc3ViKGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7IC8vICBTdWJ0cmFjdCBmcm9tIHRoZSBhbGxvd2FuY2UNCiAgICAgICAgYmFsYW5jZU9mW19mcm9tXSA9IHN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfdmFsdWUpOyAvLyBTdWJ0cmFjdCBmcm9tIHRoZSBzZW5kZXINCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBhZGQoYmFsYW5jZU9mW190b10sIF92YWx1ZSk7IC8vIEFkZCB0aGUgc2FtZSB0byB0aGUgcmVjaXBpZW50DQoNCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbG9zZVJlZnVuZCgpIG9ubHlPd25lciB7DQogICAgICAgIHJlcXVpcmUodGltZSgpIC0gcmVmdW5kU3RhcnRUaW1lID4gcmVmdW5kRHVyYXRpb24pOw0KDQogICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7DQogICAgfQ0KDQogICAgLyoNCiAgICAgKiAgICBUb2tlbiBwdXJjaGFzaW5nIGhhcyAyIHN0YWdlczoNCiAgICAgKiAgICAgICAtIEZpcnN0IHN0YWdlIGhvbGRzIDMxIGRheXMuIFRoZXJlIGlzIG5vIGxpbWl0IG9mIGJ1eWluZy4NCiAgICAgKiAgICAgICAtIFNlY29uZCBzdGFnZSBob2xkcyB+NSB5ZWFycyBhZnRlci4gVGhlcmUgd2lsbCBiZSBsaW1pdCBvZiAzMzMuMzMgZXRoZXIgcGVyIGRheS4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBidXkoKSBwYXlhYmxlIHsNCiAgICAgICAgcmVxdWlyZShzdGFydFRpbWUgPD0gdGltZSgpKTsgLy8gY2hlY2sgaWYgSUNPIGlzIGdvaW5nDQoNCiAgICAgICAgdWludCBhbW91bnQgPSBkaXYobXNnLnZhbHVlLCBwcmljZSk7DQoNCiAgICAgICAgaWYgKHRpbWUoKSAtIHN0YXJ0VGltZSA+IGZpcnN0U3RhZ2VEdXJhdGlvbikgeyAvLyBzZWNvbmQgc3RhZ2UNCiAgICAgICAgICAgIHJlcXVpcmUoMSBldGhlciA8PSBtc2cudmFsdWUpOyAvLyBjaGVjayBtaW4uIGxpbWl0DQogICAgICAgICAgICByZXF1aXJlKG1zZy52YWx1ZSA8PSAzMDAgZXRoZXIpOyAvLyBjaGVjayBtYXguIGxpbWl0DQoNCiAgICAgICAgICAgIC8vIHNlbmQgODAlIHRvIGJlbmVmaWNpYXJ5IGFjY291bnQsIGFub3RoZXIgMjAlIHN0YXlzIGZvciByZWZ1bmRpbmcNCiAgICAgICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKG11bChkaXYobXNnLnZhbHVlLCA1KSwgNCkpOw0KDQogICAgICAgICAgICB1aW50IGN1cnJlbnREYXkgPSBsYXN0UHJvY2Vzc2VkRGF5ICsgMTsNCiAgICAgICAgICAgIHVpbnQgbGltaXQgPSBtYXhEYWlseUNhcCAtIGRhaWx5VG90YWxzW2N1cnJlbnREYXldOw0KDQogICAgICAgICAgICBpZiAobGltaXQgPj0gYW1vdW50KSB7DQogICAgICAgICAgICAgICAgYXZhaWxhYmxlVG9rZW5zID0gc3ViKGF2YWlsYWJsZVRva2VucywgYW1vdW50KTsNCiAgICAgICAgICAgICAgICBiYWxhbmNlT2ZbdGhpc10gPSBzdWIoYmFsYW5jZU9mW3RoaXNdLCBhbW91bnQpOyAvLyBzdWJ0cmFjdHMgYW1vdW50IGZyb20gc2VsbGVyJ3MgYmFsYW5jZQ0KICAgICAgICAgICAgICAgIGRhaWx5VG90YWxzW2N1cnJlbnREYXldID0gYWRkKGRhaWx5VG90YWxzW2N1cnJlbnREYXldLCBhbW91bnQpOw0KICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGFkZChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIGFtb3VudCk7IC8vIGFkZHMgdGhlIGFtb3VudCB0byBidXllcidzIGJhbGFuY2UNCg0KICAgICAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7IC8vIGV4ZWN1dGUgYW4gZXZlbnQgcmVmbGVjdGluZyB0aGUgY2hhbmdlDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHF1ZXVlZEFtb3VudCA9IGFkZChxdWV1ZWRBbW91bnQsIGFtb3VudCk7DQogICAgICAgICAgICAgICAgcmVxdWlyZShxdWV1ZWRBbW91bnQgPD0gYXZhaWxhYmxlVG9rZW5zKTsNCiAgICAgICAgICAgICAgICBCdXlUaWNrZXQgbWVtb3J5IHRpY2tldCA9IEJ1eVRpY2tldCh7YWNjb3VudDogbXNnLnNlbmRlciwgYW1vdW50OiBhbW91bnQsIHRpbWU6IHRpbWUoKX0pOw0KICAgICAgICAgICAgICAgIHB1c2hRdWV1ZSh0aWNrZXQpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSB7IC8vIGZpcnN0IHN0YWdlDQogICAgICAgICAgICByZXF1aXJlKGxvd2VyTGltaXRGb3JUb2RheSgpIDw9IG1zZy52YWx1ZSk7IC8vIGNoZWNrIG1pbi4gbGltaXQNCiAgICAgICAgICAgIHJlcXVpcmUoYW1vdW50IDw9IGF2YWlsYWJsZVRva2Vucyk7DQoNCiAgICAgICAgICAgIC8vIHNlbmQgODAlIHRvIGJlbmVmaWNpYXJ5IGFjY291bnQsIGFub3RoZXIgMjAlIHN0YXlzIGZvciByZWZ1bmRpbmcNCiAgICAgICAgICAgIGJlbmVmaWNpYXJ5LnRyYW5zZmVyKG11bChkaXYobXNnLnZhbHVlLCA1KSwgNCkpOw0KDQogICAgICAgICAgICBhdmFpbGFibGVUb2tlbnMgPSBzdWIoYXZhaWxhYmxlVG9rZW5zLCBhbW91bnQpOw0KICAgICAgICAgICAgYmFsYW5jZU9mW3RoaXNdID0gc3ViKGJhbGFuY2VPZlt0aGlzXSwgYW1vdW50KTsgLy8gc3VidHJhY3RzIGFtb3VudCBmcm9tIHNlbGxlcidzIGJhbGFuY2UNCiAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IGFkZChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIGFtb3VudCk7IC8vIGFkZHMgdGhlIGFtb3VudCB0byBidXllcidzIGJhbGFuY2UNCg0KICAgICAgICAgICAgVHJhbnNmZXIodGhpcywgbXNnLnNlbmRlciwgYW1vdW50KTsgLy8gZXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHByb2Nlc3NQZW5kaW5nVGlja2V0cygpIG9ubHlPd25lciB7DQoNCiAgICAgICAgdWludCBzaXplID0gcXVldWVTaXplKCk7DQogICAgICAgIHVpbnQgcHRyID0gMDsNCiAgICAgICAgdWludCBjdXJyZW50RGF5Ow0KICAgICAgICB1aW50IGxpbWl0Ow0KICAgICAgICBCdXlUaWNrZXQgbWVtb3J5IHRpY2tldDsNCg0KICAgICAgICB3aGlsZSAocHRyIDwgc2l6ZSkgew0KICAgICAgICAgICAgY3VycmVudERheSA9IGxhc3RQcm9jZXNzZWREYXkgKyAxOw0KICAgICAgICAgICAgbGltaXQgPSBtYXhEYWlseUNhcCAtIGRhaWx5VG90YWxzW2N1cnJlbnREYXldOw0KDQogICAgICAgICAgICAvLyBzdG9wIHRoZW4gdHJ5aW5nIHRvIHByb2Nlc3MgZnV0dXJlDQogICAgICAgICAgICBpZiAoc3RhcnRUaW1lICsgKGN1cnJlbnREYXkgLSAxKSAqIDEgZGF5cyA+IHRpbWUoKSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gbGltaXQgdG8gcHJldmVudCBvdXQgb2YgZ2FzIGVycm9yDQogICAgICAgICAgICBpZiAocHRyID4gNTApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRpY2tldCA9IHBlZWtRdWV1ZSgpOw0KDQogICAgICAgICAgICBpZiAobGltaXQgPCB0aWNrZXQuYW1vdW50IHx8IHRpY2tldC50aW1lIC0gMTAwMCBzZWNvbmRzID4gc3RhcnRUaW1lICsgKGN1cnJlbnREYXkgLSAxKSAqIDEgZGF5cykgew0KICAgICAgICAgICAgICAgIGxhc3RQcm9jZXNzZWREYXkgKz0gMTsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcG9wUXVldWUoKTsNCiAgICAgICAgICAgIHB0ciArPSAxOw0KDQogICAgICAgICAgICBhdmFpbGFibGVUb2tlbnMgPSBzdWIoYXZhaWxhYmxlVG9rZW5zLCB0aWNrZXQuYW1vdW50KTsNCiAgICAgICAgICAgIHF1ZXVlZEFtb3VudCA9IHN1YihxdWV1ZWRBbW91bnQsIHRpY2tldC5hbW91bnQpOw0KICAgICAgICAgICAgZGFpbHlUb3RhbHNbY3VycmVudERheV0gPSBhZGQoZGFpbHlUb3RhbHNbY3VycmVudERheV0sIHRpY2tldC5hbW91bnQpOw0KICAgICAgICAgICAgYmFsYW5jZU9mW3RoaXNdID0gc3ViKGJhbGFuY2VPZlt0aGlzXSwgdGlja2V0LmFtb3VudCk7DQogICAgICAgICAgICBiYWxhbmNlT2ZbdGlja2V0LmFjY291bnRdID0gYWRkKGJhbGFuY2VPZlt0aWNrZXQuYWNjb3VudF0sIHRpY2tldC5hbW91bnQpOyAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlDQoNCiAgICAgICAgICAgIFRyYW5zZmVyKHRoaXMsIHRpY2tldC5hY2NvdW50LCB0aWNrZXQuYW1vdW50KTsgLy8gZXhlY3V0ZSBhbiBldmVudCByZWZsZWN0aW5nIHRoZSBjaGFuZ2UNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7DQogICAgICAgIGJ1eSgpOw0KICAgIH0NCn0='