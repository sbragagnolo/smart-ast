base 64 content
base64decentrEx
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBTYWZlTWF0aCB7DQogIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsNCiAgfQ0KfQ0KDQpjb250cmFjdCBUb2tlbiB7DQogIC8vLyBAcmV0dXJuIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMNCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkge30NCg0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7fQ0KDQogIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmANCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkDQogIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30NCg0KICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWANCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZA0KICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQ0KDQogIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX2FkZHJgIHRvIHNwZW5kIGBfdmFsdWVgIHRva2Vucw0KICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHdlaSB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30NCg0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zDQogIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykge30NCg0KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQoNCiAgdWludCBwdWJsaWMgZGVjaW1hbHM7DQogIHN0cmluZyBwdWJsaWMgbmFtZTsNCn0NCg0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4NCiAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLg0KICAgIC8vUmVwbGFjZSB0aGUgaWYgd2l0aCB0aGlzIG9uZSBpbnN0ZWFkLg0KICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCiAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0NCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgIC8vc2FtZSBhcyBhYm92ZS4gUmVwbGFjZSB0aGlzIGxpbmUgd2l0aCB0aGUgZm9sbG93aW5nIGlmIHlvdSB3YW50IHRvIHByb3RlY3QgYWdhaW5zdCB3cmFwcGluZyB1aW50cy4NCiAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCiAgICAvL2lmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQogICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogIH0NCg0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICB9DQoNCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogIH0NCg0KICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KfQ0KDQpjb250cmFjdCBSZXNlcnZlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgU2FmZU1hdGggew0KICBhZGRyZXNzIHB1YmxpYyBtaW50ZXI7DQogIGZ1bmN0aW9uIFJlc2VydmVUb2tlbigpIHsNCiAgICBtaW50ZXIgPSBtc2cuc2VuZGVyOw0KICB9DQogIGZ1bmN0aW9uIGNyZWF0ZShhZGRyZXNzIGFjY291bnQsIHVpbnQgYW1vdW50KSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gbWludGVyKSB0aHJvdzsNCiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVBZGQoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7DQogICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCBhbW91bnQpOw0KICB9DQogIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBhY2NvdW50LCB1aW50IGFtb3VudCkgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG1pbnRlcikgdGhyb3c7DQogICAgaWYgKGJhbGFuY2VzW2FjY291bnRdIDwgYW1vdW50KSB0aHJvdzsNCiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVTdWIoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7DQogICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBhbW91bnQpOw0KICB9DQp9DQoNCmNvbnRyYWN0IEFjY291bnRMZXZlbHMgew0KICAvL2dpdmVuIGEgdXNlciwgcmV0dXJucyBhbiBhY2NvdW50IGxldmVsDQogIC8vMCA9IHJlZ3VsYXIgdXNlciAocGF5cyB0YWtlIGZlZSBhbmQgbWFrZSBmZWUpDQogIC8vMSA9IG1hcmtldCBtYWtlciBzaWx2ZXIgKHBheXMgdGFrZSBmZWUsIG5vIG1ha2UgZmVlLCBnZXRzIHJlYmF0ZSkNCiAgLy8yID0gbWFya2V0IG1ha2VyIGdvbGQgKHBheXMgdGFrZSBmZWUsIG5vIG1ha2UgZmVlLCBnZXRzIGVudGlyZSBjb3VudGVycGFydHkncyB0YWtlIGZlZSBhcyByZWJhdGUpDQogIGZ1bmN0aW9uIGFjY291bnRMZXZlbChhZGRyZXNzIHVzZXIpIGNvbnN0YW50IHJldHVybnModWludCkge30NCn0NCg0KY29udHJhY3QgQWNjb3VudExldmVsc1Rlc3QgaXMgQWNjb3VudExldmVscyB7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGFjY291bnRMZXZlbHM7DQoNCiAgZnVuY3Rpb24gc2V0QWNjb3VudExldmVsKGFkZHJlc3MgdXNlciwgdWludCBsZXZlbCkgew0KICAgIGFjY291bnRMZXZlbHNbdXNlcl0gPSBsZXZlbDsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFjY291bnRMZXZlbChhZGRyZXNzIHVzZXIpIGNvbnN0YW50IHJldHVybnModWludCkgew0KICAgIHJldHVybiBhY2NvdW50TGV2ZWxzW3VzZXJdOw0KICB9DQp9DQoNCmNvbnRyYWN0IERlY2VudHJFeCBpcyBTYWZlTWF0aCB7DQogIGFkZHJlc3MgcHVibGljIGFkbWluOyAvL3RoZSBhZG1pbiBhZGRyZXNzDQogIGFkZHJlc3MgcHVibGljIGZlZUFjY291bnQ7IC8vdGhlIGFjY291bnQgdGhhdCB3aWxsIHJlY2VpdmUgZmVlcw0KICBhZGRyZXNzIHB1YmxpYyBhY2NvdW50TGV2ZWxzQWRkcjsgLy90aGUgYWRkcmVzcyBvZiB0aGUgQWNjb3VudExldmVscyBjb250cmFjdA0KICB1aW50IHB1YmxpYyBmZWVNYWtlOyAvL3BlcmNlbnRhZ2UgdGltZXMgKDEgZXRoZXIpDQogIHVpbnQgcHVibGljIGZlZVRha2U7IC8vcGVyY2VudGFnZSB0aW1lcyAoMSBldGhlcikNCiAgdWludCBwdWJsaWMgZmVlUmViYXRlOyAvL3BlcmNlbnRhZ2UgdGltZXMgKDEgZXRoZXIpDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgcHVibGljIHRva2VuczsgLy9tYXBwaW5nIG9mIHRva2VuIGFkZHJlc3NlcyB0byBtYXBwaW5nIG9mIGFjY291bnQgYmFsYW5jZXMgKHRva2VuPTAgbWVhbnMgRXRoZXIpDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYnl0ZXMzMiA9PiBib29sKSkgcHVibGljIG9yZGVyczsgLy9tYXBwaW5nIG9mIHVzZXIgYWNjb3VudHMgdG8gbWFwcGluZyBvZiBvcmRlciBoYXNoZXMgdG8gYm9vbGVhbnMgKHRydWUgPSBzdWJtaXR0ZWQgYnkgdXNlciwgZXF1aXZhbGVudCB0byBvZmZjaGFpbiBzaWduYXR1cmUpDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYnl0ZXMzMiA9PiB1aW50KSkgcHVibGljIG9yZGVyRmlsbHM7IC8vbWFwcGluZyBvZiB1c2VyIGFjY291bnRzIHRvIG1hcHBpbmcgb2Ygb3JkZXIgaGFzaGVzIHRvIHVpbnRzIChhbW91bnQgb2Ygb3JkZXIgdGhhdCBoYXMgYmVlbiBmaWxsZWQpDQoNCiAgZXZlbnQgT3JkZXIoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgYWRkcmVzcyB1c2VyKTsNCiAgZXZlbnQgQ2FuY2VsKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIGFkZHJlc3MgdXNlciwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpOw0KICBldmVudCBUcmFkZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgYWRkcmVzcyBnZXQsIGFkZHJlc3MgZ2l2ZSk7DQogIGV2ZW50IERlcG9zaXQoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyLCB1aW50IGFtb3VudCwgdWludCBiYWxhbmNlKTsNCiAgZXZlbnQgV2l0aGRyYXcoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyLCB1aW50IGFtb3VudCwgdWludCBiYWxhbmNlKTsNCg0KICBmdW5jdGlvbiBEZWNlbnRyRXgoYWRkcmVzcyBhZG1pbl8sIGFkZHJlc3MgZmVlQWNjb3VudF8sIGFkZHJlc3MgYWNjb3VudExldmVsc0FkZHJfLCB1aW50IGZlZU1ha2VfLCB1aW50IGZlZVRha2VfLCB1aW50IGZlZVJlYmF0ZV8pIHsNCiAgICBhZG1pbiA9IGFkbWluXzsNCiAgICBmZWVBY2NvdW50ID0gZmVlQWNjb3VudF87DQogICAgYWNjb3VudExldmVsc0FkZHIgPSBhY2NvdW50TGV2ZWxzQWRkcl87DQogICAgZmVlTWFrZSA9IGZlZU1ha2VfOw0KICAgIGZlZVRha2UgPSBmZWVUYWtlXzsNCiAgICBmZWVSZWJhdGUgPSBmZWVSZWJhdGVfOw0KICB9DQoNCiAgZnVuY3Rpb24oKSB7DQogICAgdGhyb3c7DQogIH0NCg0KICBmdW5jdGlvbiBjaGFuZ2VBZG1pbihhZGRyZXNzIGFkbWluXykgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IGFkbWluKSB0aHJvdzsNCiAgICBhZG1pbiA9IGFkbWluXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZUFjY291bnRMZXZlbHNBZGRyKGFkZHJlc3MgYWNjb3VudExldmVsc0FkZHJfKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93Ow0KICAgIGFjY291bnRMZXZlbHNBZGRyID0gYWNjb3VudExldmVsc0FkZHJfOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hhbmdlRmVlQWNjb3VudChhZGRyZXNzIGZlZUFjY291bnRfKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93Ow0KICAgIGZlZUFjY291bnQgPSBmZWVBY2NvdW50XzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZUZlZU1ha2UodWludCBmZWVNYWtlXykgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IGFkbWluKSB0aHJvdzsNCiAgICBpZiAoZmVlTWFrZV8gPiBmZWVNYWtlKSB0aHJvdzsNCiAgICBmZWVNYWtlID0gZmVlTWFrZV87DQogIH0NCg0KICBmdW5jdGlvbiBjaGFuZ2VGZWVUYWtlKHVpbnQgZmVlVGFrZV8pIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7DQogICAgaWYgKGZlZVRha2VfID4gZmVlVGFrZSB8fCBmZWVUYWtlXyA8IGZlZVJlYmF0ZSkgdGhyb3c7DQogICAgZmVlVGFrZSA9IGZlZVRha2VfOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hhbmdlRmVlUmViYXRlKHVpbnQgZmVlUmViYXRlXykgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IGFkbWluKSB0aHJvdzsNCiAgICBpZiAoZmVlUmViYXRlXyA8IGZlZVJlYmF0ZSB8fCBmZWVSZWJhdGVfID4gZmVlVGFrZSkgdGhyb3c7DQogICAgZmVlUmViYXRlID0gZmVlUmViYXRlXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGRlcG9zaXQoKSBwYXlhYmxlIHsNCiAgICB0b2tlbnNbMF1bbXNnLnNlbmRlcl0gPSBzYWZlQWRkKHRva2Vuc1swXVttc2cuc2VuZGVyXSwgbXNnLnZhbHVlKTsNCiAgICBEZXBvc2l0KDAsIG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgdG9rZW5zWzBdW21zZy5zZW5kZXJdKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgYW1vdW50KSB7DQogICAgaWYgKHRva2Vuc1swXVttc2cuc2VuZGVyXSA8IGFtb3VudCkgdGhyb3c7DQogICAgdG9rZW5zWzBdW21zZy5zZW5kZXJdID0gc2FmZVN1Yih0b2tlbnNbMF1bbXNnLnNlbmRlcl0sIGFtb3VudCk7DQogICAgaWYgKCFtc2cuc2VuZGVyLmNhbGwudmFsdWUoYW1vdW50KSgpKSB0aHJvdzsNCiAgICBXaXRoZHJhdygwLCBtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vuc1swXVttc2cuc2VuZGVyXSk7DQogIH0NCg0KICBmdW5jdGlvbiBkZXBvc2l0VG9rZW4oYWRkcmVzcyB0b2tlbiwgdWludCBhbW91bnQpIHsNCiAgICAvL3JlbWVtYmVyIHRvIGNhbGwgVG9rZW4oYWRkcmVzcykuYXBwcm92ZSh0aGlzLCBhbW91bnQpIG9yIHRoaXMgY29udHJhY3Qgd2lsbCBub3QgYmUgYWJsZSB0byBkbyB0aGUgdHJhbnNmZXIgb24geW91ciBiZWhhbGYuDQogICAgaWYgKHRva2VuPT0wKSB0aHJvdzsNCiAgICBpZiAoIVRva2VuKHRva2VuKS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgdGhpcywgYW1vdW50KSkgdGhyb3c7DQogICAgdG9rZW5zW3Rva2VuXVttc2cuc2VuZGVyXSA9IHNhZmVBZGQodG9rZW5zW3Rva2VuXVttc2cuc2VuZGVyXSwgYW1vdW50KTsNCiAgICBEZXBvc2l0KHRva2VuLCBtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0pOw0KICB9DQoNCiAgZnVuY3Rpb24gd2l0aGRyYXdUb2tlbihhZGRyZXNzIHRva2VuLCB1aW50IGFtb3VudCkgew0KICAgIGlmICh0b2tlbj09MCkgdGhyb3c7DQogICAgaWYgKHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0gPCBhbW91bnQpIHRocm93Ow0KICAgIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0sIGFtb3VudCk7DQogICAgaWYgKCFUb2tlbih0b2tlbikudHJhbnNmZXIobXNnLnNlbmRlciwgYW1vdW50KSkgdGhyb3c7DQogICAgV2l0aGRyYXcodG9rZW4sIG1zZy5zZW5kZXIsIGFtb3VudCwgdG9rZW5zW3Rva2VuXVttc2cuc2VuZGVyXSk7DQogIH0NCg0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB1c2VyKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgcmV0dXJuIHRva2Vuc1t0b2tlbl1bdXNlcl07DQogIH0NCg0KICBmdW5jdGlvbiBvcmRlcihhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlKSB7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIG9yZGVyc1ttc2cuc2VuZGVyXVtoYXNoXSA9IHRydWU7DQogICAgT3JkZXIodG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSwgbXNnLnNlbmRlcik7DQogIH0NCg0KICBmdW5jdGlvbiB0cmFkZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzLCB1aW50IGFtb3VudCkgew0KICAgIC8vYW1vdW50IGlzIGluIGFtb3VudEdldCB0ZXJtcw0KICAgIGJ5dGVzMzIgaGFzaCA9IHNoYTI1Nih0aGlzLCB0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlKTsNCiAgICBpZiAoISgNCiAgICAgIChvcmRlcnNbdXNlcl1baGFzaF0gfHwgZWNyZWNvdmVyKHNoYTMoIlx4MTlFdGhlcmV1bSBTaWduZWQgTWVzc2FnZTpcbjMyIiwgaGFzaCksdixyLHMpID09IHVzZXIpICYmDQogICAgICBibG9jay5udW1iZXIgPD0gZXhwaXJlcyAmJg0KICAgICAgc2FmZUFkZChvcmRlckZpbGxzW3VzZXJdW2hhc2hdLCBhbW91bnQpIDw9IGFtb3VudEdldA0KICAgICkpIHRocm93Ow0KICAgIHRyYWRlQmFsYW5jZXModG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCB1c2VyLCBhbW91bnQpOw0KICAgIG9yZGVyRmlsbHNbdXNlcl1baGFzaF0gPSBzYWZlQWRkKG9yZGVyRmlsbHNbdXNlcl1baGFzaF0sIGFtb3VudCk7DQogICAgVHJhZGUodG9rZW5HZXQsIGFtb3VudCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlICogYW1vdW50IC8gYW1vdW50R2V0LCB1c2VyLCBtc2cuc2VuZGVyKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYWRlQmFsYW5jZXMoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIGFkZHJlc3MgdXNlciwgdWludCBhbW91bnQpIHByaXZhdGUgew0KICAgIHVpbnQgZmVlTWFrZVhmZXIgPSBzYWZlTXVsKGFtb3VudCwgZmVlTWFrZSkgLyAoMSBldGhlcik7DQogICAgdWludCBmZWVUYWtlWGZlciA9IHNhZmVNdWwoYW1vdW50LCBmZWVUYWtlKSAvICgxIGV0aGVyKTsNCiAgICB1aW50IGZlZVJlYmF0ZVhmZXIgPSAwOw0KICAgIGlmIChhY2NvdW50TGV2ZWxzQWRkciAhPSAweDApIHsNCiAgICAgIHVpbnQgYWNjb3VudExldmVsID0gQWNjb3VudExldmVscyhhY2NvdW50TGV2ZWxzQWRkcikuYWNjb3VudExldmVsKHVzZXIpOw0KICAgICAgaWYgKGFjY291bnRMZXZlbD09MSkgZmVlUmViYXRlWGZlciA9IHNhZmVNdWwoYW1vdW50LCBmZWVSZWJhdGUpIC8gKDEgZXRoZXIpOw0KICAgICAgaWYgKGFjY291bnRMZXZlbD09MikgZmVlUmViYXRlWGZlciA9IGZlZVRha2VYZmVyOw0KICAgIH0NCiAgICB0b2tlbnNbdG9rZW5HZXRdW21zZy5zZW5kZXJdID0gc2FmZVN1Yih0b2tlbnNbdG9rZW5HZXRdW21zZy5zZW5kZXJdLCBzYWZlQWRkKGFtb3VudCwgZmVlVGFrZVhmZXIpKTsNCiAgICB0b2tlbnNbdG9rZW5HZXRdW3VzZXJdID0gc2FmZUFkZCh0b2tlbnNbdG9rZW5HZXRdW3VzZXJdLCBzYWZlU3ViKHNhZmVBZGQoYW1vdW50LCBmZWVSZWJhdGVYZmVyKSwgZmVlTWFrZVhmZXIpKTsNCiAgICB0b2tlbnNbdG9rZW5HZXRdW2ZlZUFjY291bnRdID0gc2FmZUFkZCh0b2tlbnNbdG9rZW5HZXRdW2ZlZUFjY291bnRdLCBzYWZlU3ViKHNhZmVBZGQoZmVlTWFrZVhmZXIsIGZlZVRha2VYZmVyKSwgZmVlUmViYXRlWGZlcikpOw0KICAgIHRva2Vuc1t0b2tlbkdpdmVdW3VzZXJdID0gc2FmZVN1Yih0b2tlbnNbdG9rZW5HaXZlXVt1c2VyXSwgc2FmZU11bChhbW91bnRHaXZlLCBhbW91bnQpIC8gYW1vdW50R2V0KTsNCiAgICB0b2tlbnNbdG9rZW5HaXZlXVttc2cuc2VuZGVyXSA9IHNhZmVBZGQodG9rZW5zW3Rva2VuR2l2ZV1bbXNnLnNlbmRlcl0sIHNhZmVNdWwoYW1vdW50R2l2ZSwgYW1vdW50KSAvIGFtb3VudEdldCk7DQogIH0NCg0KICBmdW5jdGlvbiB0ZXN0VHJhZGUoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgYWRkcmVzcyB1c2VyLCB1aW50OCB2LCBieXRlczMyIHIsIGJ5dGVzMzIgcywgdWludCBhbW91bnQsIGFkZHJlc3Mgc2VuZGVyKSBjb25zdGFudCByZXR1cm5zKGJvb2wpIHsNCiAgICBpZiAoISgNCiAgICAgIHRva2Vuc1t0b2tlbkdldF1bc2VuZGVyXSA+PSBhbW91bnQgJiYNCiAgICAgIGF2YWlsYWJsZVZvbHVtZSh0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlLCB1c2VyLCB2LCByLCBzKSA+PSBhbW91bnQNCiAgICApKSByZXR1cm4gZmFsc2U7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhdmFpbGFibGVWb2x1bWUoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgYWRkcmVzcyB1c2VyLCB1aW50OCB2LCBieXRlczMyIHIsIGJ5dGVzMzIgcykgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIGlmICghKA0KICAgICAgKG9yZGVyc1t1c2VyXVtoYXNoXSB8fCBlY3JlY292ZXIoc2hhMygiXHgxOUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuMzIiLCBoYXNoKSx2LHIscykgPT0gdXNlcikgJiYNCiAgICAgIGJsb2NrLm51bWJlciA8PSBleHBpcmVzDQogICAgKSkgcmV0dXJuIDA7DQogICAgdWludCBhdmFpbGFibGUxID0gc2FmZVN1YihhbW91bnRHZXQsIG9yZGVyRmlsbHNbdXNlcl1baGFzaF0pOw0KICAgIHVpbnQgYXZhaWxhYmxlMiA9IHNhZmVNdWwodG9rZW5zW3Rva2VuR2l2ZV1bdXNlcl0sIGFtb3VudEdldCkgLyBhbW91bnRHaXZlOw0KICAgIGlmIChhdmFpbGFibGUxPGF2YWlsYWJsZTIpIHJldHVybiBhdmFpbGFibGUxOw0KICAgIHJldHVybiBhdmFpbGFibGUyOw0KICB9DQoNCiAgZnVuY3Rpb24gYW1vdW50RmlsbGVkKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIGFkZHJlc3MgdXNlciwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpIGNvbnN0YW50IHJldHVybnModWludCkgew0KICAgIGJ5dGVzMzIgaGFzaCA9IHNoYTI1Nih0aGlzLCB0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlKTsNCiAgICByZXR1cm4gb3JkZXJGaWxsc1t1c2VyXVtoYXNoXTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNhbmNlbE9yZGVyKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKSB7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIGlmICghKG9yZGVyc1ttc2cuc2VuZGVyXVtoYXNoXSB8fCBlY3JlY292ZXIoc2hhMygiXHgxOUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuMzIiLCBoYXNoKSx2LHIscykgPT0gbXNnLnNlbmRlcikpIHRocm93Ow0KICAgIG9yZGVyRmlsbHNbbXNnLnNlbmRlcl1baGFzaF0gPSBhbW91bnRHZXQ7DQogICAgQ2FuY2VsKHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UsIG1zZy5zZW5kZXIsIHYsIHIsIHMpOw0KICB9DQp9'