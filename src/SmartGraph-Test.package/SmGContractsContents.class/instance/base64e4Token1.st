base 64 content
base64e4Token1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQoNCi8vDQovLyBGT1IgUkVGRVJFTkNFIC0gSU5DTFVERSAgaUU0Um93RXNjcm93ICAoaW50ZXJmYWNlKSBDT05UUkFDVCBhdCB0aGUgdG9wIC4uLi4uDQovLw0KDQpjb250cmFjdCBpRTRSb3dFc2Nyb3cgew0KCWZ1bmN0aW9uIGdldE51bUdhbWVzU3RhcnRlZCgpIGNvbnN0YW50IHJldHVybnMgKGludCBuZ2FtZXMpOw0KfQ0KDQovLyBBYnN0cmFjdCBjb250cmFjdCBmb3IgdGhlIGZ1bGwgRVJDIDIwIFRva2VuIHN0YW5kYXJkDQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBBQlNUUkFDVCBzdGFuZGFyZCB0b2tlbiBjbGFzcw0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBUb2tlbiB7IA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7DQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQp9DQoNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBFNFJvd1Jld2FyZHMgLSBhYnN0cmFjdCBlNCBkaXZpZGVuZCBjb250cmFjdA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmNvbnRyYWN0IEU0Um93UmV3YXJkcw0Kew0KCWZ1bmN0aW9uIGNoZWNrRGl2aWRlbmRzKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHJldHVybnModWludCBfYW1vdW50KTsNCglmdW5jdGlvbiB3aXRoZHJhd0RpdmlkZW5kcygpIHB1YmxpYyByZXR1cm5zICh1aW50IG5hbW91bnQpOw0KfQ0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gIEZpbm5leSBDaGlwIC0gdG9rZW4gY29udHJhY3QNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBFNFRva2VuIGlzIFRva2VuLCBFNFJvd1Jld2FyZHMgew0KICAgIAlldmVudCBTdGF0RXZlbnQoc3RyaW5nIG1zZyk7DQogICAgCWV2ZW50IFN0YXRFdmVudEkoc3RyaW5nIG1zZywgdWludCB2YWwpOw0KDQoJZW51bSBTZXR0aW5nU3RhdGVWYWx1ZSAge2RlYnVnLCByZWxlYXNlLCBsb2NrZWRSZWxlYXNlfQ0KCWVudW0gSWNvU3RhdHVzVmFsdWUge2Fub3VuY2VtZW50LCBzYWxlT3Blbiwgc2FsZUNsb3NlZCwgZmFpbGVkLCBzdWNjZWVkZWR9DQoNCg0KDQoNCglzdHJ1Y3QgdG9rZW5BY2NvdW50IHsNCgkJYm9vbCBhbGxvY2VkOyAvLyBmbGFnIHRvIGFzY2VydCBwcmlvciBhbGxvY2F0aW9uDQoJCXVpbnQgdG9rZW5zOyAvLyBudW0gdG9rZW5zDQoJCXVpbnQgYmFsYW5jZTsgLy8gcmV3YXJkcyBiYWxhbmNlDQoJfQ0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBkYXRhIHN0b3JhZ2UNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglhZGRyZXNzIGRldmVsb3BlcnM7IC8vIGRldmVsb3BlcnMgdG9rZW4gaG9sZGluZyBhZGRyZXNzDQoJYWRkcmVzcyBwdWJsaWMgb3duZXI7IC8vIGRlcGxveWVyIGV4ZWN1dG9yDQoJYWRkcmVzcyBmb3VuZGVyT3JnOyAvLyBmb3VuZGVyIG9yZ2luYWl6YXRpb24gY29udHJhY3QNCglhZGRyZXNzIGF1eFBhcnRuZXI7IC8vIGF1eCBwYXJ0bmVyIChwci9hdWRpdGluZykgLSAxIHBlcmNlbnQgdXBvbiBjbG9zZQ0KCWFkZHJlc3MgZTRfcGFydG5lcjsgLy8gZTRyb3cgIGNvbnRyYWN0IGFkZHJlc3Nlcw0KDQoNCgltYXBwaW5nIChhZGRyZXNzID0+IHRva2VuQWNjb3VudCkgaG9sZGVyQWNjb3VudHMgOyAvLyB3aG8gaG9sZHMgaG93IG1hbnkgdG9rZW5zIChoaWdoIHR3byBieXRlcyBjb250YWluIGN1clBheUlkKQ0KCW1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaG9sZGVySW5kZXhlcyA7IC8vIGZvciBpdGVyYXRpb24gdGhydSBob2xkZXINCgl1aW50IG51bUFjY291bnRzOw0KDQoJdWludCBwYXJ0bmVyQ3JlZGl0czsgLy8gYW1vdW50IHBhcnRuZXIgKGU0cm93KSAgaGFzIHBhaWQNCgltYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7IC8vIGFwcHJvdmFscw0KDQoNCgl1aW50IG1heE1pbnRhYmxlVG9rZW5zOyAvLyAuLi4NCgl1aW50IG1pbkljb1Rva2VuR29hbDsvLyB0b2tlbiBnb2FsIGJ5IHNhbGUgZW5kDQoJdWludCBtaW5Vc2FnZUdvYWw7IC8vICBudW0gZ2FtZXMgZ29hbCBieSB1c2FnZSBkZWFkbGluZQ0KCXVpbnQgcHVibGljICB0b2tlblByaWNlOyAvLyBwcmljZSBwZXIgdG9rZW4NCgl1aW50IHB1YmxpYyBwYXlvdXRUaHJlc2hvbGQ7IC8vIHRocmVzaG9sZCB0aWxsIHBheW91dA0KDQoJdWludCB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZDsgCS8vIHJ1bm5pbmcgdG90YWwgb2YgdG9rZW4gZnVuZHMgcmVjZWl2ZWQNCgl1aW50IHB1YmxpYyB0b3RhbFRva2Vuc01pbnRlZDsgCS8vIHRvdGFsIG51bWJlciBvZiB0b2tlbnMgbWludGVkDQoJdWludCBwdWJsaWMgaG9sZG92ZXJCYWxhbmNlOyAJCS8vIGhvbGQgdGhpcyBhbW91bnQgdW50aWwgdGhyZXNoaG9sZCBiZWZvcmUgcmV3YXJkIHBheW91dA0KCWludCBwdWJsaWMgcGF5b3V0QmFsYW5jZTsgCQkvLyBob2xkIHRoaXMgYW1vdW50IHVudGlsIHRocmVzaGhvbGQgYmVmb3JlIHJld2FyZCBwYXlvdXQNCglpbnQgcHJPcmlnUGF5b3V0QmFsOwkJCS8vIG9yaWdpbmFsIHBheW91dCBiYWxhbmNlIGJlZm9yZSBydW4NCgl1aW50IHByT3JpZ1Rva2Vuc01pbnQ7IAkJCS8vIHRva2VucyBtaW50ZWQgYXQgc3RhcnQgb2YgcGF5IHJ1bg0KCXVpbnQgcHVibGljIGN1clBheW91dElkOwkJLy8gY3VycmVudCBwYXlvdXQgaWQNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0SW5kZXg7CQkvLyBwYXlvdXQgaWR4IGJldHdlZW4gcnVuIHNlZ21lbnRzDQoJdWludCBwdWJsaWMgbWF4UGF5c1BlcjsJCQkvLyBudW0gcGF5cyBwZXIgc2VnbWVudA0KCXVpbnQgcHVibGljIG1pblBheUludGVydmFsOwkJLy8gbWluIGludGVydmFsIGJldHdlZW4gc3RhcnQgcGF5IHJ1bg0KDQoNCgl1aW50IGZ1bmRpbmdTdGFydDsgCQkvLyBmdW5kaW5nIHN0YXJ0IHRpbWUgaW1tZWRpYXRlbHkgYWZ0ZXIgYW5vdW5jZW1lbnQNCgl1aW50IGZ1bmRpbmdEZWFkbGluZTsgCQkvLyBmdW5kaW5nIGVuZCB0aW1lDQoJdWludCB1c2FnZURlYWRsaW5lOyAJCS8vIGRlYWRsaW5lIHdoZXJlIG1pbmltdW0gdXNhZ2UgbmVlZHMgdG8gYmUgbWV0IGJlZm9yZSBjb25zaWRlcmVkIHN1Y2Nlc3MNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0VGltZTsgCS8vIHRpbWVzdGFtcCBvZiBsYXN0IHBheW91dCB0aW1lDQoJdWludCB2ZXN0VGltZTsgCQkvLyAxIHllYXIgcGFzdCBzYWxlIHZlc3QgZGV2ZWxvcGVyIHRva2Vucw0KCXVpbnQgbnVtRGV2VG9rZW5zOyAJLy8gMTAgcGVyIGNlbnQgb2YgdG9rZW5zIGFmdGVyIGNsb3NlIHRvIGRldmVsb3BlcnMNCglib29sIGRldmVsb3BlcnNHcmFudGVkOyAJCS8vIGZsYWcNCgl1aW50IHJlbXVuZXJhdGlvblN0YWdlOyAJLy8gMCBmb3Igbm90IHlldCwgMSBmb3IgMTAgcGVyY2VudCwgMiBmb3IgcmVtYWluaW5nICB1cG9uIHN1Y2NlZWRlZC4NCgl1aW50IHB1YmxpYyByZW11bmVyYXRpb25CYWxhbmNlOyAJLy8gcmVtdW5lcmF0aW9uIGJhbGFuY2UgdG8gcmVsZWFzZSB0b2tlbiBmdW5kcw0KCXVpbnQgYXV4UGFydG5lckJhbGFuY2U7IAkvLyBhdXggcGFydG5lciBiYWxhbmNlIC0gMSBwZXJjZW50DQoJdWludCBybUdhczsgLy8gcmVtdW5lcmF0aW9uIGdhcw0KCXVpbnQgcndHYXM7IC8vIHJld2FyZCBnYXMNCgl1aW50IHJmR2FzOyAvLyByZWZ1bmQgZ2FzDQoNCglJY29TdGF0dXNWYWx1ZSBpY29TdGF0dXM7ICAvLyBjdXJyZW50IHN0YXR1cyBvZiBpY28NCglTZXR0aW5nU3RhdGVWYWx1ZSBwdWJsaWMgc2V0dGluZ3NTdGF0ZTsNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjb250cmFjdCBjb25zdHJ1Y3Rvcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gRTRUb2tlbigpIA0KCXsNCgkJb3duZXIgPSBtc2cuc2VuZGVyOw0KCQlkZXZlbG9wZXJzID0gbXNnLnNlbmRlcjsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHVzZSB0aGlzIHRvIHJlc2V0IGV2ZXJ5dGhpbmcsIHdpbGwgbmV2ZXIgYmUgY2FsbGVkIGFmdGVyIGxvY2tSZWxlYXNlDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBhcHBseVNldHRpbmdzKFNldHRpbmdTdGF0ZVZhbHVlIHFTdGF0ZSwgdWludCBfc2FsZVN0YXJ0LCB1aW50IF9zYWxlRW5kLCB1aW50IF91c2FnZUVuZCwgdWludCBfbWluVXNhZ2UsIHVpbnQgX3Rva0dvYWwsIHVpbnQgIF9tYXhNaW50YWJsZSwgdWludCBfdGhyZXNob2xkLCB1aW50IF9wcmljZSwgdWludCBfbXBwLCB1aW50IF9tcGkgKQ0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIA0KCQkJcmV0dXJuOw0KDQoJCS8vIHRoZXNlIHNldHRpbmdzIGFyZSBwZXJtYW5lbnRseSB0d2Vha2FibGUgZm9yIHBlcmZvcm1hbmNlIGFkanVzdG1lbnRzDQoJCXBheW91dFRocmVzaG9sZCA9IF90aHJlc2hvbGQ7DQoJCW1heFBheXNQZXIgPSBfbXBwOw0KCQltaW5QYXlJbnRlcnZhbCA9IF9tcGk7DQoNCgkJLy8gdGhpcyBmaXJzdCB0ZXN0IGNoZWNrcyBpZiBhbHJlYWR5IGxvY2tlZA0KCQlpZiAoc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJcmV0dXJuOw0KDQogCSAJc2V0dGluZ3NTdGF0ZSA9IHFTdGF0ZTsNCg0KCQkvLyB0aGlzIHNlY29uZCB0ZXN0IGFsbG93cyBsb2NraW5nIHdpdGhvdXQgY2hhbmdpbmcgb3RoZXIgcGVybWFuZW50IHNldHRpbmdzDQoJCS8vIFdBUk5JTkcsIE1BS0UgU1VSRSBZT1VSJ1JFIEhBUFBZIFdJVEggQUxMIFNFVFRJTkdTIA0KCQkvLyBCRUZPUkUgTE9DS0lORw0KDQoJCWlmIChxU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkgew0KCQkJU3RhdEV2ZW50KCJMb2NraW5nISIpOw0KCQkJcmV0dXJuOw0KCQl9DQoNCgkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQ7DQoNCgkJcm1HYXMgPSAxMDAwMDA7IC8vIHJlbXVuZXJhdGlvbiBnYXMNCgkJcndHYXMgPSAxMDAwMDsgLy8gcmV3YXJkIGdhcw0KCQlyZkdhcyA9IDEwMDAwOyAvLyByZWZ1bmQgZ2FzDQoNCg0KCQkvLyB6ZXJvIG91dCBhbGwgdG9rZW4gaG9sZGVycy4gIA0KCQkvLyBsZWF2ZSBhbGxvY2VkIG9uLCBsZWF2ZSBudW0gYWNjb3VudHMNCgkJLy8gY2FudCBkZWxldGUgdGhlbSBhbnl3YXlzDQoJDQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCA+IDApIHsNCgkJCWZvciAodWludCBpID0gMDsgaSA8IG51bUFjY291bnRzOyBpKysgKSB7DQoJCQkJYWRkcmVzcyBhID0gaG9sZGVySW5kZXhlc1tpXTsNCgkJCQlpZiAoYSAhPSBhZGRyZXNzKDApKSB7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLnRva2VucyA9IDA7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLmJhbGFuY2UgPSAwOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkvLyBkbyBub3QgcmVzZXQgbnVtQWNjb3VudHMhDQoNCgkJdG90YWxUb2tlbnNNaW50ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UNCgkJdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UuDQoJCXBhcnRuZXJDcmVkaXRzID0gMDsgLy8gcmVzZXQgYWxsIHBhcnRuZXIgY3JlZGl0cw0KDQoJCWZ1bmRpbmdTdGFydCA9ICBfc2FsZVN0YXJ0Ow0KCQlmdW5kaW5nRGVhZGxpbmUgPSBfc2FsZUVuZDsNCgkJdXNhZ2VEZWFkbGluZSA9IF91c2FnZUVuZDsNCgkJbWluVXNhZ2VHb2FsID0gX21pblVzYWdlOw0KCQltaW5JY29Ub2tlbkdvYWwgPSBfdG9rR29hbDsNCgkJbWF4TWludGFibGVUb2tlbnMgPSBfbWF4TWludGFibGU7DQoJCXRva2VuUHJpY2UgPSBfcHJpY2U7DQoNCgkJdmVzdFRpbWUgPSBmdW5kaW5nU3RhcnQgKyAoMzY1IGRheXMpOw0KCQludW1EZXZUb2tlbnMgPSAwOw0KCQkNCgkJaG9sZG92ZXJCYWxhbmNlID0gMDsNCgkJcGF5b3V0QmFsYW5jZSA9IDA7DQoJCWN1clBheW91dElkID0gMTsNCgkJbGFzdFBheW91dEluZGV4ID0gMDsNCgkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAwOw0KCQlyZW11bmVyYXRpb25CYWxhbmNlID0gMDsNCgkJYXV4UGFydG5lckJhbGFuY2UgPSAwOw0KCQlkZXZlbG9wZXJzR3JhbnRlZCA9IGZhbHNlOw0KCQlsYXN0UGF5b3V0VGltZSA9IDA7DQoNCgkJaWYgKHRoaXMuYmFsYW5jZSA+IDApIHsNCgkJCWlmICghb3duZXIuY2FsbC5nYXMocmZHYXMpLnZhbHVlKHRoaXMuYmFsYW5jZSkoKSkNCgkJCQlTdGF0RXZlbnQoIkVSUk9SISIpOw0KCQl9DQoJCVN0YXRFdmVudCgib2siKTsNCg0KCX0NCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gdG9rZW5zIGhlbGQgcmVzZXJ2ZSB0aGUgdG9wIHR3byBieXRlcyBmb3IgdGhlIHBheWlkIGxhc3QgcGFpZC4NCgkvLyB0aGlzIGlzIHNvIGhvbGRlcnMgYXQgdGhlIHRvcCBvZiB0aGUgbGlzdCBkb250IHRyYW5zZmVyIHRva2VucyANCgkvLyB0byB0aGVtc2VsdmVzIG9uIHRoZSBib3R0b20gb2YgdGhlIGxpc3QgdGh1cyBzY2FtbWluZyB0aGUgDQoJLy8gc3lzdGVtLiB0aGlzIGZ1bmN0aW9uIGRlY29uc3RydWN0cyB0aGUgdG9rZW5oZWxkIHZhbHVlLg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldFBheUlkQW5kSGVsZCh1aW50IF90b2tIZWxkKSBpbnRlcm5hbCByZXR1cm5zICh1aW50IF9wYXlJZCwgdWludCBfaGVsZCkNCgl7DQoJCV9wYXlJZCA9IChfdG9rSGVsZCAvICgyICoqIDQ4KSkgJiAweGZmZmY7DQoJCV9oZWxkID0gX3Rva0hlbGQgJiAweGZmZmZmZmZmZmZmZjsNCgl9DQoJZnVuY3Rpb24gZ2V0SGVsZCh1aW50IF90b2tIZWxkKSBpbnRlcm5hbCAgcmV0dXJucyAodWludCBfaGVsZCkNCgl7DQoJCV9oZWxkID0gX3Rva0hlbGQgJiAweGZmZmZmZmZmZmZmZjsNCgl9DQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gYWxsb2NhdGUgYSBuZXcgYWNjb3VudCBieSBzZXR0aW5nIGFsbG9jIHRvIHRydWUNCgkvLyBzZXQgdGhlIHRvcCB0byBieXRlcyBvZiB0b2tlbnMgdG8gY3VyIHBheSBpZCB0byBsZWF2ZSBvdXQgb2YgY3VycmVudCByb3VuZA0KCS8vIGFkZCBob2xkZXIgaW5kZXgsIGJ1bXAgdGhlIG51bSBhY2NvdW50cw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGFkZEFjY291bnQoYWRkcmVzcyBfYWRkcikgaW50ZXJuYWwgIHsNCgkJaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQgPSB0cnVlOw0KCQlob2xkZXJBY2NvdW50c1tfYWRkcl0udG9rZW5zID0gKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCgkJaG9sZGVySW5kZXhlc1tudW1BY2NvdW50cysrXSA9IF9hZGRyOw0KCX0NCgkNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIEJFR0lOIEVSQy0yMCBmcm9tIFN0YW5kYXJkVG9rZW4NCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkNCgl7DQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4NCgkJCXx8IGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5hbm91bmNlbWVudCkNCgkJCXN1cHBseSA9IG1heE1pbnRhYmxlVG9rZW5zOw0KCQllbHNlDQoJCQlzdXBwbHkgPSB0b3RhbFRva2Vuc01pbnRlZDsNCgl9DQoNCglmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQoJCWlmICgobXNnLnNlbmRlciA9PSBkZXZlbG9wZXJzKSANCgkJCSYmICAobm93IDwgdmVzdFRpbWUpKSB7DQoJCQkvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoNCg0KCSAgICAgICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuDQoJICAgICAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLg0KCSAgICAgICAgLy9SZXBsYWNlIHRoZSBpZiB3aXRoIHRoaXMgb25lIGluc3RlYWQuDQoJICAgICAgICAvL2lmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGhvbGRlckFjY291bnRzW190b10pIHsNCg0KCQl2YXIgKHBpZEZyb20sIGhlbGRGcm9tKSA9IGdldFBheUlkQW5kSGVsZChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMpOw0KCSAgICAgICAgaWYgKGhlbGRGcm9tID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQoNCgkgICAgICAgICAgICBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMgLT0gX3ZhbHVlOw0KDQoJCSAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkgew0KCQkJYWRkQWNjb3VudChfdG8pOw0KCQkgICAgfQ0KDQoJCSAgICB1aW50IG5ld0hlbGQgPSBfdmFsdWUgKyBnZXRIZWxkKGhvbGRlckFjY291bnRzW190b10udG9rZW5zKTsNCgkJICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIGF2b2lkIG1jZ2VlcyBnYW1iaXQNCgkJICAgIAlwaWRGcm9tID0gY3VyUGF5b3V0SWQ7DQoJCSAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyA9IG5ld0hlbGQgfCAocGlkRnJvbSAqICgyICoqIDQ4KSk7DQoNCgkgICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQoJICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoJICAgICAgICB9IGVsc2UgeyANCgkJCXJldHVybiBmYWxzZTsgDQoJCX0NCiAgICAJfQ0KDQogICAgCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQoJCWlmICgoX2Zyb20gPT0gZGV2ZWxvcGVycykgDQoJCQkmJiAgKG5vdyA8IHZlc3RUaW1lKSkgew0KCQkJLy9zdGF0RXZlbnQoIlRva2VucyBub3QgeWV0IHZlc3RlZC4iKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoNCiAgICAgICAgLy9zYW1lIGFzIGFib3ZlLiBSZXBsYWNlIHRoaXMgbGluZSB3aXRoIHRoZSBmb2xsb3dpbmcgaWYgeW91IHdhbnQgdG8gcHJvdGVjdCBhZ2FpbnN0IHdyYXBwaW5nIHVpbnRzLg0KICAgICAgICAvL2lmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSkgew0KDQoJCXZhciAocGlkRnJvbSwgaGVsZEZyb20pID0gZ2V0UGF5SWRBbmRIZWxkKGhvbGRlckFjY291bnRzW19mcm9tXS50b2tlbnMpOw0KICAgICAgICAJaWYgKGhlbGRGcm9tID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KCSAgICAgICAgICAgIGhvbGRlckFjY291bnRzW19mcm9tXS50b2tlbnMgLT0gX3ZhbHVlOw0KDQoJCSAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkNCgkJCWFkZEFjY291bnQoX3RvKTsNCg0KCQkgICAgdWludCBuZXdIZWxkID0gX3ZhbHVlICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tfdG9dLnRva2Vucyk7DQoNCgkJICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIGF2b2lkIG1jZ2VlcyBnYW1iaXQNCgkJICAgIAlwaWRGcm9tID0gY3VyUGF5b3V0SWQ7DQoJCSAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyA9IG5ld0hlbGQgfCAocGlkRnJvbSAqICgyICoqIDQ4KSk7DQoNCgkgICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQoJICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCgkgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCgkgICAgICAgIH0gZWxzZSB7IA0KCQkgICAgcmV0dXJuIGZhbHNlOyANCgkJfQ0KCX0NCg0KDQogICAgCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQoJCS8vIHZhcnMgZGVmYXVsdCB0byAwDQoJCWlmIChob2xkZXJBY2NvdW50c1tfb3duZXJdLmFsbG9jZWQpIHsNCgkgICAgICAgIAliYWxhbmNlID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tfb3duZXJdLnRva2Vucyk7DQoJCX0gDQogICAgCX0NCg0KICAgIAlmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgCWFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgICAgICAJQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIAlyZXR1cm4gdHJ1ZTsNCiAgICAJfQ0KDQogICAgCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIAkJcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgCX0NCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIEVORCBFUkMyMA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQogIA0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBkZWZhdWx0IHBheWFibGUgZnVuY3Rpb24uDQoJLy8gaWYgc2VuZGVyIGlzIGU0cm93ICBwYXJ0bmVyLCB0aGlzIGlzIGEgcmFrZSBmZWUgcGF5bWVudA0KCS8vIG90aGVyd2lzZSB0aGlzIGlzIGEgdG9rZW4gcHVyY2hhc2UuDQoJLy8gdG9rZW5zIG9ubHkgcHVyY2hhc2VhYmxlIGJldHdlZW4gdG9rZW5mdW5kaW5nc3RhcnQgYW5kIGVuZA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCgkJaWYgKG1zZy5zZW5kZXIgPT0gZTRfcGFydG5lcikgew0KCQkgICAgIGZlZVBheW1lbnQoKTsgLy8gZnJvbSBlNHJvdyBnYW1lIGVzY3JvdyBjb250cmFjdA0KCQl9IGVsc2Ugew0KCQkgICAgIHB1cmNoYXNlVG9rZW4oKTsNCgkJfQ0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcHVyY2hhc2UgdG9rZW4gZnVuY3Rpb24gLSB0b2tlbnMgb25seSBzb2xkIGR1cmluZyBzYWxlIHBlcmlvZCB1cCB1bnRpbCB0aGUgbWF4IHRva2Vucw0KCS8vIHB1cmNoYXNlIHByaWNlIGlzIHRva2VuUHJpY2UuICBhbGwgdW5pdHMgaW4gd2VpLg0KCS8vIHB1cmNoYXNlciB3aWxsIG5vdCBiZSBpbmNsdWRlZCBpbiBjdXJyZW50IHBheSBydW4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHB1cmNoYXNlVG9rZW4oKSBwYXlhYmxlIHsNCg0KCQl1aW50IG52YWx1ZSA9IG1zZy52YWx1ZTsgLy8gYmVpbmcgY2FyZWZ1bCB0byBwcmVzZXJ2ZSBtc2cudmFsdWUNCgkJYWRkcmVzcyBucHVyY2hhc2VyID0gbXNnLnNlbmRlcjsNCgkJaWYgKG52YWx1ZSA8IHRva2VuUHJpY2UpIA0KCQkJdGhyb3c7DQoNCgkJdWludCBxdHkgPSBudmFsdWUvdG9rZW5QcmljZTsNCgkJdXBkYXRlSWNvU3RhdHVzKCk7DQoJCWlmIChpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIHB1cmNoYXNlIGlzIGNsb3NlZA0KCQkJdGhyb3c7DQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCArIHF0eSA+IG1heE1pbnRhYmxlVG9rZW5zKQ0KCQkJdGhyb3c7DQoJCWlmICghaG9sZGVyQWNjb3VudHNbbnB1cmNoYXNlcl0uYWxsb2NlZCkNCgkJCWFkZEFjY291bnQobnB1cmNoYXNlcik7DQoJCQ0KCQkvLyBwdXJjaGFzZXIgd2FpdHMgZm9yIG5leHQgcGF5cnVuLiBvdGhlcndpc2UgY2FuIGRpc3J1cHQgY3VyIHBheSBydW4NCgkJdWludCBuZXdIZWxkID0gcXR5ICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMpOw0KCQlob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMgPSBuZXdIZWxkIHwgKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCg0KCQl0b3RhbFRva2Vuc01pbnRlZCArPSBxdHk7DQoJCXRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkICs9IG52YWx1ZTsNCg0KCQlpZiAodG90YWxUb2tlbnNNaW50ZWQgPT0gbWF4TWludGFibGVUb2tlbnMpIHsNCgkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7DQoJCQkvL3Rlc3QgdW5uZWNlc3NhcnkgLSAgaWYgKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkNCgkJCWRvRGV2ZWxvcGVyR3JhbnQoKTsNCgkJCVN0YXRFdmVudEkoIlB1cmNoYXNlZCxHcmFudGVkIiwgcXR5KTsNCgkJfSBlbHNlDQoJCQlTdGF0RXZlbnRJKCJQdXJjaGFzZWQiLCBxdHkpOw0KDQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBhY2NlcHQgcGF5bWVudCBmcm9tIGU0cm93IGNvbnRyYWN0DQoJLy8gV0FSTklORyEgRE8gTk9UIENBTEwgVEhJUyBGVU5DVElPTiBMRVNUIFlPVSBMT1NFIFlPVVIgTU9ORVkNCgkvLyBIT1dFVkVSIEFERCBUSElTIEdJRlQgVE8gVEhFIEhPTERPVkVSQkFMQU5DRQ0KCS8vIFlPVSBIQVZFIEJFRU4gV0FSTkVEDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZmVlUGF5bWVudCgpIHBheWFibGUgIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gZTRfcGFydG5lcikgew0KCQkJaWYgKG1zZy52YWx1ZSA+IDApDQoJCQkJaG9sZG92ZXJCYWxhbmNlICs9IG1zZy52YWx1ZTsNCgkJCVN0YXRFdmVudCgiZm9yYmlkZGVuIik7DQoJCQlyZXR1cm47IC8vIHRoYW5rIHlvdQ0KCQl9DQoJCXVpbnQgbmZ2YWx1ZSA9IG1zZy52YWx1ZTsgLy8gcHJlc2VydmUgdmFsdWUgaW4gY2FzZSBjaGFuZ2VkIGluIGRldiBncmFudA0KDQoJCXVwZGF0ZUljb1N0YXR1cygpOw0KDQoJCWhvbGRvdmVyQmFsYW5jZSArPSBuZnZhbHVlOw0KCQlwYXJ0bmVyQ3JlZGl0cyArPSBuZnZhbHVlOw0KCQlTdGF0RXZlbnRJKCJQYXltZW50IiwgbmZ2YWx1ZSk7DQoNCgkJaWYgKGhvbGRvdmVyQmFsYW5jZSA+IHBheW91dFRocmVzaG9sZA0KCQkJfHwgcGF5b3V0QmFsYW5jZSA+IDApDQoJCQlkb1BheW91dChtYXhQYXlzUGVyKTsNCgkJDQoJDQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc2V0IHRoZSBlNHJvdyBwYXJ0bmVyLCB0aGlzIGlzIG9ubHkgZG9uZSBvbmNlDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gc2V0RTRSb3dQYXJ0bmVyKGFkZHJlc3MgX2FkZHIpIHB1YmxpYwkNCgl7DQoJLy8gT05MWSBvd25lciBjYW4gc2V0IGFuZCBPTkxZIE9OQ0UhICh1bmxlc3MgInVubG9ja2VkIiBkZWJ1ZykNCgkvLyBvbmNlIGl0cyBsb2NrZWQuIE9OTFkgT05DRSENCgkJaWYgKG1zZy5zZW5kZXIgPT0gb3duZXIpIHsNCgkJCWlmICgoZTRfcGFydG5lciA9PSBhZGRyZXNzKDApKSB8fCAoc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5kZWJ1ZykpIHsNCgkJCQllNF9wYXJ0bmVyID0gX2FkZHI7DQoJCQkJcGFydG5lckNyZWRpdHMgPSAwOw0KCQkJCS8vU3RhdEV2ZW50SSgiRTQtU2V0IiwgMCk7DQoJCQl9IGVsc2Ugew0KCQkJCVN0YXRFdmVudCgiQWxyZWFkeSBTZXQiKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyByZXR1cm4gdGhlIHRvdGFsIHRva2VucyBwdXJjaGFzZWQNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCkgY29uc3RhbnQgcmV0dXJucyh1aW50IF9wdXJjaGFzZWQpDQoJew0KCQlfcHVyY2hhc2VkID0gdG90YWxUb2tlbnNNaW50ZWQtbnVtRGV2VG9rZW5zOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyByZXR1cm4gdGhlIG51bSBnYW1lcyBhcyByZXBvcnRlZCBmcm9tIHRoZSBlNHJvdyAgY29udHJhY3QNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0TnVtR2FtZXMoKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX2dhbWVzKQ0KCXsNCgkJLy9fZ2FtZXMgPSAwOw0KCQlpZiAoZTRfcGFydG5lciAhPSBhZGRyZXNzKDApKSB7DQoJCQlpRTRSb3dFc2Nyb3cgcGU0ID0gaUU0Um93RXNjcm93KGU0X3BhcnRuZXIpOw0KCQkJX2dhbWVzID0gdWludChwZTQuZ2V0TnVtR2FtZXNTdGFydGVkKCkpOw0KCQl9IA0KCQkvL2Vsc2UNCgkJLy9TdGF0RXZlbnQoIkVtcHR5IEU0Iik7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gZ2V0IHRoZSBmb3VuZGVycywgYXV4UGFydG5lciwgZGV2ZWxvcGVyDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBnZXRTcGVjaWFsQWRkcmVzc2VzKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyBfZm5kciwgYWRkcmVzcyBfYXV4LCBhZGRyZXNzIF9kZXYsIGFkZHJlc3MgX2U0KQ0KCXsNCgkJLy9pZiAoX3NlbmRlciA9PSBvd25lcikgeyAvLyBubyBtc2cuc2VuZGVyIG9uIGNvbnN0YW50IGZ1bmN0aW9ucyBhdCBsZWFzdCBpbiBtZXcNCgkJCV9mbmRyID0gZm91bmRlck9yZzsNCgkJCV9hdXggPSBhdXhQYXJ0bmVyOw0KCQkJX2RldiA9IGRldmVsb3BlcnM7DQoJCQlfZTQgID0gZTRfcGFydG5lcjsNCgkJLy99DQoJfQ0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyB1cGRhdGUgdGhlIGljbyBzdGF0dXMNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gdXBkYXRlSWNvU3RhdHVzKCkgcHVibGljDQoJew0KCQlpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLnN1Y2NlZWRlZCANCgkJCXx8IGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5mYWlsZWQpDQoJCQlyZXR1cm47DQoJCWVsc2UgaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5hbm91bmNlbWVudCkgew0KCQkJaWYgKG5vdyA+IGZ1bmRpbmdTdGFydCAmJiBub3cgPD0gZnVuZGluZ0RlYWRsaW5lKSB7DQoJCQkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW47DQoJCQkJDQoJCQl9IGVsc2UgaWYgKG5vdyA+IGZ1bmRpbmdEZWFkbGluZSkgew0KCQkJCS8vIHNob3VsZCBub3QgYmUgaGVyZSAtIHRoaXMgd2lsbCBldmVudHVhbGx5IGZhaWwNCgkJCQlpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5zYWxlQ2xvc2VkOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJdWludCBudW1QID0gZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCk7DQoJCQl1aW50IG51bUcgPSBnZXROdW1HYW1lcygpOw0KCQkJaWYgKChub3cgPiBmdW5kaW5nRGVhZGxpbmUgJiYgbnVtUCA8IG1pbkljb1Rva2VuR29hbCkNCgkJCQl8fCAobm93ID4gdXNhZ2VEZWFkbGluZSAmJiBudW1HIDwgbWluVXNhZ2VHb2FsKSkgew0KCQkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLmZhaWxlZDsNCgkJCX0gZWxzZSBpZiAoKG5vdyA+IGZ1bmRpbmdEZWFkbGluZSkgLy8gZG9udCB3YW50IHRvIHByZXZlbnQgbW9yZSB0b2tlbiBzYWxlcw0KCQkJCSYmIChudW1QID49IG1pbkljb1Rva2VuR29hbCkNCgkJCQkmJiAobnVtRyA+PSBtaW5Vc2FnZUdvYWwpKSB7DQoJCQkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkOyAvLyBob29yYXkNCgkJCX0NCgkJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4NCgkJCQkmJiAoKG51bVAgPj0gbWF4TWludGFibGVUb2tlbnMpDQoJCQkJfHwgKG5vdyA+IGZ1bmRpbmdEZWFkbGluZSkpKSB7DQoJCQkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7DQoJCQkJfQ0KCQl9DQoNCgkJaWYgKCFkZXZlbG9wZXJzR3JhbnRlZA0KCQkJJiYgaWNvU3RhdHVzICE9IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuIA0KCQkJJiYgaWNvU3RhdHVzICE9IEljb1N0YXR1c1ZhbHVlLmFub3VuY2VtZW50DQoJCQkmJiBnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpIHsNCgkJCQlkb0RldmVsb3BlckdyYW50KCk7IC8vIGdyYW50IHdoZW5ldmVyIHN0YXR1cyBnb2VzIGZyb20gb3BlbiB0byBhbnl0aGluZy4uLg0KCQl9DQoNCgkNCgl9DQoNCgkNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcmVxdWVzdCByZWZ1bmQuIENhbGxlciBtdXN0IGNhbGwgdG8gcmVxdWVzdCBhbmQgcmVjZWl2ZSByZWZ1bmQgDQoJLy8gV0FSTklORyAtIHdpdGhkcmF3IHJld2FyZHMvZGl2aWRlbmRzIGJlZm9yZSBjYWxsaW5nLg0KCS8vIFlPVSBIQVZFIEJFRU4gV0FSTkVEDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHJlcXVlc3RSZWZ1bmQoKQ0KCXsNCgkJYWRkcmVzcyBucmVxdWVzdGVyID0gbXNnLnNlbmRlcjsNCgkJdXBkYXRlSWNvU3RhdHVzKCk7DQoNCgkJdWludCBudG9rZW5zID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS50b2tlbnMpOw0KCQlpZiAoaWNvU3RhdHVzICE9IEljb1N0YXR1c1ZhbHVlLmZhaWxlZCkNCgkJCVN0YXRFdmVudCgiTm8gUmVmdW5kIik7DQoJCWVsc2UgaWYgKG50b2tlbnMgPT0gMCkNCgkJCVN0YXRFdmVudCgiTm8gVG9rZW5zIik7DQoJCWVsc2Ugew0KCQkJdWludCBucmVmdW5kID0gbnRva2VucyAqIHRva2VuUHJpY2U7DQoJCQlpZiAoZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCkgPj0gbWluSWNvVG9rZW5Hb2FsKQ0KCQkJCW5yZWZ1bmQgLT0gKG5yZWZ1bmQgLzEwKTsgLy8gb25seSA5MCBwZXJjZW50IGIvYyAxMCBwZXJjZW50IHBheW91dA0KDQoJCQlpZiAoIWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmFsbG9jZWQpIA0KCQkJCWFkZEFjY291bnQoZGV2ZWxvcGVycyk7DQoJCQlob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMgKz0gbnRva2VuczsNCgkJCWhvbGRlckFjY291bnRzW25yZXF1ZXN0ZXJdLnRva2VucyA9IDA7DQoJCQlpZiAoaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0uYmFsYW5jZSA+IDApIHsNCgkJCQkvLyBzZWUgYWJvdmUgd2FybmluZyEhDQoJCQkJaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10uYmFsYW5jZSArPSBob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS5iYWxhbmNlOw0KCQkJCWhvbGRlckFjY291bnRzW25yZXF1ZXN0ZXJdLmJhbGFuY2UgPSAwOw0KCQkJfQ0KDQoJCQlpZiAoIW5yZXF1ZXN0ZXIuY2FsbC5nYXMocmZHYXMpLnZhbHVlKG5yZWZ1bmQpKCkpDQoJCQkJdGhyb3c7DQoJCQkvL1N0YXRFdmVudEkoIlJlZnVuZGVkIiwgbnJlZnVuZCk7DQoJCX0NCgl9DQoNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcGF5b3V0IHJld2FyZHMgdG8gYWxsIHRva2VuIGhvbGRlcnMNCgkvLyB1c2UgYSBzZWNvbmQgaG9sZGluZyB2YXJpYWJsZSBjYWxsZWQgUGF5b3V0QmFsYW5jZSB0byBkbyANCgkvLyB0aGUgYWN0dWFsIHBheW91dCBmcm9tIGIvYyB0b28gbXVjaCBnYXMgdG8gaXRlcmF0ZSB0aHJ1IA0KCS8vIGVhY2ggcGF5ZWUuIE9ubHkgc3RhcnQgYSBuZXcgcnVuIGF0IG1vc3Qgb25jZSBwZXIgIm1pbnBheWludGVydmFsIi4NCgkvLyBJdHMgZG9uZSBpbiBydW5zIG9mICJfbnVtUGF5cyINCgkvLyB3ZSB1c2Ugc3BlY2lhbCBjb2RpbmcgZm9yIHRoZSBob2xkZXJBY2NvdW50cyB0byBhdm9pZCBhIGhhY2sNCgkvLyBvZiBnZXR0aW5nIHBhaWQgYXQgdGhlIHRvcCBvZiB0aGUgbGlzdCB0aGVuIHRyYW5zZmVyaW5nIHRva2Vucw0KCS8vIHRvIGFub3RoZXIgYWRkcmVzcyBhdCB0aGUgYm90dG9tIG9mIHRoZSBsaXN0Lg0KCS8vIGJlY2F1c2Ugb2YgdGhhdCBlYWNoIGhvbGRlckFjY291bnRzIGVudHJ5IGdldHMgdGhlIHBheW91dGlkIHN0YW1wZWQgdXBvbiBpdCAodG9wIHR3byBieXRlcykNCgkvLyBhbHNvIGEgdG9rZW4gdHJhbnNmZXIgd2lsbCB0cmFuc2ZlciB0aGUgcGF5b3V0IGlkLg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGRvUGF5b3V0KHVpbnQgX251bVBheXMpICBpbnRlcm5hbA0KCXsNCgkJaWYgKHRvdGFsVG9rZW5zTWludGVkID09IDApDQoJCQlyZXR1cm47DQoNCgkJaWYgKChob2xkb3ZlckJhbGFuY2UgPiAwKSANCgkJCSYmIChwYXlvdXRCYWxhbmNlID09IDApDQoJCQkmJiAobm93ID4gKGxhc3RQYXlvdXRUaW1lK21pblBheUludGVydmFsKSkpIHsNCgkJCS8vIHN0YXJ0IGEgbmV3IHJ1bg0KCQkJY3VyUGF5b3V0SWQrKzsNCgkJCWlmIChjdXJQYXlvdXRJZCA+PSAzMjc2OCkNCgkJCQljdXJQYXlvdXRJZCA9IDE7DQoJCQlsYXN0UGF5b3V0VGltZSA9IG5vdzsNCgkJCXBheW91dEJhbGFuY2UgPSBpbnQoaG9sZG92ZXJCYWxhbmNlKTsNCgkJCXByT3JpZ1BheW91dEJhbCA9IHBheW91dEJhbGFuY2U7DQoJCQlwck9yaWdUb2tlbnNNaW50ID0gdG90YWxUb2tlbnNNaW50ZWQ7DQoJCQlob2xkb3ZlckJhbGFuY2UgPSAwOw0KCQkJbGFzdFBheW91dEluZGV4ID0gMDsNCgkJCVN0YXRFdmVudEkoIlN0YXJ0UnVuIiwgdWludChjdXJQYXlvdXRJZCkpOw0KCQl9IGVsc2UgaWYgKHBheW91dEJhbGFuY2UgPiAwKSB7DQoJCQkvLyB3b3JrIGRvd24gdGhlIHAuby5iDQoJCQl1aW50IG5BbW91bnQ7DQoJCQl1aW50IG5QZXJUb2tEaXN0cmliID0gdWludChwck9yaWdQYXlvdXRCYWwpL3ByT3JpZ1Rva2Vuc01pbnQ7DQoJCQl1aW50IHBhaWRzID0gMDsNCgkJCXVpbnQgaTsgLy8gaW50ZW50aW9uYWwNCgkJCWZvciAoaSA9IGxhc3RQYXlvdXRJbmRleDsgKHBhaWRzIDwgX251bVBheXMpICYmIChpIDwgbnVtQWNjb3VudHMpICYmIChwYXlvdXRCYWxhbmNlID4gMCk7IGkrKyApIHsNCgkJCQlhZGRyZXNzIGEgPSBob2xkZXJJbmRleGVzW2ldOw0KCQkJCWlmIChhID09IGFkZHJlc3MoMCkpIHsNCgkJCQkJY29udGludWU7DQoJCQkJfQ0KCQkJCXZhciAocGlkLCBoZWxkKSA9IGdldFBheUlkQW5kSGVsZChob2xkZXJBY2NvdW50c1thXS50b2tlbnMpOw0KCQkJCWlmICgoaGVsZCA+IDApICYmIChwaWQgIT0gY3VyUGF5b3V0SWQpKSB7DQoJCQkJCW5BbW91bnQgPSBuUGVyVG9rRGlzdHJpYiAqIGhlbGQ7DQoJCQkJCWlmIChpbnQobkFtb3VudCkgPD0gcGF5b3V0QmFsYW5jZSl7DQoJCQkJCQlob2xkZXJBY2NvdW50c1thXS5iYWxhbmNlICs9IG5BbW91bnQ7IA0KCQkJCQkJaG9sZGVyQWNjb3VudHNbYV0udG9rZW5zID0gKGN1clBheW91dElkICogKDIgKiogNDgpKSB8IGhlbGQ7DQoJCQkJCQlwYXlvdXRCYWxhbmNlIC09IGludChuQW1vdW50KTsJCQkJCQ0KCQkJCQkJcGFpZHMrKzsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCWxhc3RQYXlvdXRJbmRleCA9IGk7DQoJCQlpZiAobGFzdFBheW91dEluZGV4ID49IG51bUFjY291bnRzIHx8IHBheW91dEJhbGFuY2UgPD0gMCkgew0KCQkJCWxhc3RQYXlvdXRJbmRleCA9IDA7DQoJCQkJaWYgKHBheW91dEJhbGFuY2UgPiAwKQ0KCQkJCQlob2xkb3ZlckJhbGFuY2UgKz0gdWludChwYXlvdXRCYWxhbmNlKTsvLyBwdXQgYmFjayBhbnkgbGVmdG92ZXJzDQoJCQkJcGF5b3V0QmFsYW5jZSA9IDA7DQoJCQkJU3RhdEV2ZW50SSgiUnVuQ29tcGxldGUiLCB1aW50KHByT3JpZ1BheW91dEJhbCkgKTsNCg0KCQkJfSBlbHNlIHsNCgkJCQlTdGF0RXZlbnRJKCJQYXlSdW4iLCBwYWlkcyApOw0KCQkJfQ0KCQl9DQoJCQ0KCX0NCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHNlbmRlciB3aXRoZHJhdyBlbnRpcmUgcmV3YXJkcy9kaXZpZGVuZHMNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gd2l0aGRyYXdEaXZpZGVuZHMoKSBwdWJsaWMgcmV0dXJucyAodWludCBfYW1vdW50KQ0KCXsNCgkJaWYgKGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmJhbGFuY2UgPT0gMCkgeyANCgkJCS8vX2Ftb3VudCA9IDA7DQoJCQlTdGF0RXZlbnQoIjAgQmFsYW5jZSIpOw0KCQkJcmV0dXJuOw0KCQl9IGVsc2Ugew0KCQkJaWYgKChtc2cuc2VuZGVyID09IGRldmVsb3BlcnMpIA0KCQkJCSYmICAobm93IDwgdmVzdFRpbWUpKSB7DQoJCQkJLy9zdGF0RXZlbnQoIlRva2VucyBub3QgeWV0IHZlc3RlZC4iKTsNCgkJCQkvL19hbW91bnQgPSAwOw0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJX2Ftb3VudCA9IGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmJhbGFuY2U7IA0KCQkJaG9sZGVyQWNjb3VudHNbbXNnLnNlbmRlcl0uYmFsYW5jZSA9IDA7IA0KCQkJaWYgKCFtc2cuc2VuZGVyLmNhbGwuZ2FzKHJ3R2FzKS52YWx1ZShfYW1vdW50KSgpKQ0KCQkJCXRocm93Ow0KCQkJLy9TdGF0RXZlbnRJKCJQYWlkIiwgX2Ftb3VudCk7DQoJDQoJCX0NCg0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzZXQgZ2FzIGZvciBvcGVyYXRpb25zDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHNldE9wR2FzKHVpbnQgX3JtLCB1aW50IF9yZiwgdWludCBfcncpDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lciAmJiBtc2cuc2VuZGVyICE9IGRldmVsb3BlcnMpIHsNCgkJCS8vU3RhdEV2ZW50KCJvbmx5IG93bmVyIGNhbGxzIik7DQoJCQlyZXR1cm47DQoJCX0gZWxzZSB7DQoJCQlybUdhcyA9IF9ybTsNCgkJCXJmR2FzID0gX3JmOw0KCQkJcndHYXMgPSBfcnc7DQoJCX0NCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gZ2V0IGdhcyBmb3Igb3BlcmF0aW9ucw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBnZXRPcEdhcygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgX3JtLCB1aW50IF9yZiwgdWludCBfcncpDQoJew0KCQlfcm0gPSBybUdhczsNCgkJX3JmID0gcmZHYXM7DQoJCV9ydyA9IHJ3R2FzOw0KCX0NCiANCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjaGVjayByZXdhcmRzLiAgcGFzcyBpbiBhZGRyZXNzIG9mIHRva2VuIGhvbGRlcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGVja0RpdmlkZW5kcyhhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX2Ftb3VudCkNCgl7DQoJCWlmIChob2xkZXJBY2NvdW50c1tfYWRkcl0uYWxsb2NlZCkNCgkJCV9hbW91bnQgPSBob2xkZXJBY2NvdW50c1tfYWRkcl0uYmFsYW5jZTsNCgl9CQkNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gaWNvQ2hlY2t1cCAtIGNoZWNrIHVwIGNhbGwgZm9yIGFkbWluaXN0cmF0b3JzDQoJLy8gYWZ0ZXIgc2FsZSBpcyBjbG9zZWQgaWYgbWluIGljbyB0b2tlbnMgc29sZCwgMTAgcGVyY2VudCB3aWxsIGJlIGRpc3RyaWJ1dGVkIHRvIA0KCS8vIGNvbXBhbnkgdG8gY292ZXIgdmFyaW91cyBvcGVyYXRpbmcgZXhwZW5zZXMNCgkvLyBhZnRlciBzYWxlIGFuZCB1c2FnZSBkZWFsaW5lcyBoYXZlIGJlZW4gbWV0LCByZW1haW5pbmcgOTAgcGVyY2VudCB3aWxsIGJlIGRpc3RyaWJ1dGVkIHRvDQoJLy8gY29tcGFueS4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBpY29DaGVja3VwKCkgcHVibGljDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lciAmJiBtc2cuc2VuZGVyICE9IGRldmVsb3BlcnMpDQoJCQl0aHJvdzsNCg0KCQl1aW50IG5tc2dtYXNrOw0KCQkvL25tc2dtYXNrID0gMDsNCgkNCgkJaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zYWxlQ2xvc2VkKSB7DQoJCQlpZiAoKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkNCgkJCQkmJiAocmVtdW5lcmF0aW9uU3RhZ2UgPT0gMCApKSB7DQoJCQkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAxOw0KCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKSo5OyAvLyA5IHBlcmNlbnQNCgkJCQlhdXhQYXJ0bmVyQmFsYW5jZSA9ICAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKTsgLy8gMSBwZXJjZW50DQoJCQkJbm1zZ21hc2sgfD0gMTsNCgkJCX0gDQoJCX0NCgkJaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zdWNjZWVkZWQpIHsNCgkJDQoJCQlpZiAocmVtdW5lcmF0aW9uU3RhZ2UgPT0gMCApIHsNCgkJCQlyZW11bmVyYXRpb25TdGFnZSA9IDE7DQoJCQkJcmVtdW5lcmF0aW9uQmFsYW5jZSA9ICh0b3RhbFRva2VuRnVuZHNSZWNlaXZlZC8xMDApKjk7IA0KCQkJCWF1eFBhcnRuZXJCYWxhbmNlID0gICh0b3RhbFRva2VuRnVuZHNSZWNlaXZlZC8xMDApOw0KCQkJCW5tc2dtYXNrIHw9IDQ7DQoJCQl9DQoJCQlpZiAocmVtdW5lcmF0aW9uU3RhZ2UgPT0gMSkgeyAvLyB3ZSBoYXZlIGFscmVhZHkgc3VjZWVkZWQNCgkJCQlyZW11bmVyYXRpb25TdGFnZSA9IDI7DQoJCQkJcmVtdW5lcmF0aW9uQmFsYW5jZSArPSB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZCAtICh0b3RhbFRva2VuRnVuZHNSZWNlaXZlZC8xMCk7IC8vIDkwIHBlcmNlbnQNCgkJCQlubXNnbWFzayB8PSA4Ow0KCQkJfQ0KDQoJCX0NCg0KCQl1aW50IG50bXA7DQoNCgkJaWYgKHJlbXVuZXJhdGlvbkJhbGFuY2UgPiAwKSB7IA0KCQkvLyBvbmx5IHBheSBvbmUgZW50aXR5IHBlciBjYWxsLCBkb250IHdhbnQgdG8gcnVuIG91dCBvZiBnYXMNCgkJCQludG1wID0gcmVtdW5lcmF0aW9uQmFsYW5jZTsNCgkJCQlyZW11bmVyYXRpb25CYWxhbmNlID0gMDsNCgkJCQlpZiAoIWZvdW5kZXJPcmcuY2FsbC5nYXMocm1HYXMpLnZhbHVlKG50bXApKCkpIHsNCgkJCQkJcmVtdW5lcmF0aW9uQmFsYW5jZSA9IG50bXA7DQoJCQkJCW5tc2dtYXNrIHw9IDMyOw0KCQkJCX0gZWxzZSB7DQoJCQkJCW5tc2dtYXNrIHw9IDY0Ow0KCQkJCX0JDQoJCX0gZWxzZSAJaWYgKGF1eFBhcnRuZXJCYWxhbmNlID4gMCkgew0KCQkvLyBub3RlIHRoZSAiZWxzZSIgb25seSBwYXkgb25lIGVudGl0eSBwZXIgY2FsbCwgZG9udCB3YW50IHRvIHJ1biBvdXQgb2YgZ2FzDQoJCQludG1wID0gYXV4UGFydG5lckJhbGFuY2U7DQoJCQlhdXhQYXJ0bmVyQmFsYW5jZSA9IDA7DQoJCQlpZiAoIWF1eFBhcnRuZXIuY2FsbC5nYXMocm1HYXMpLnZhbHVlKG50bXApKCkpIHsNCgkJCQlhdXhQYXJ0bmVyQmFsYW5jZSA9IG50bXA7DQoJCQkJbm1zZ21hc2sgfD0gMTI4Ow0KCQkJfSAgZWxzZSB7DQoJCQkJbm1zZ21hc2sgfD0gMjU2Ow0KCQkJfQ0KDQoJCX0gDQoJCQ0KCQlTdGF0RXZlbnRJKCJpY28tY2hlY2t1cCIsIG5tc2dtYXNrKTsNCgl9DQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzd2FwIGV4ZWN1dG9yDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX2FkZHIpIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXINCgkJCXx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkNCgkJCSB0aHJvdzsNCg0KCQlvd25lciA9IF9hZGRyOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzd2FwIGRldmVsb3BlcnMgYWNjb3VudA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VEZXZldm9wZXJBY2NvbnQoYWRkcmVzcyBfYWRkcikgDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcg0KCQkJfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJIHRocm93Ow0KCQlkZXZlbG9wZXJzID0gX2FkZHI7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGNoYW5nZSBmb3VuZGVyDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGNoYW5nZUZvdW5kZXIoYWRkcmVzcyBfYWRkcikgDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcg0KCQkJfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJIHRocm93Ow0KCQlmb3VuZGVyT3JnID0gX2FkZHI7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGNoYW5nZSBhdXhQYXJ0bmVyDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGNoYW5nZUF1eFBhcnRuZXIoYWRkcmVzcyBfYXV4KSANCgl7DQoJCWlmIChtc2cuc2VuZGVyICE9IG93bmVyDQoJCQl8fCBzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpDQoJCQkgdGhyb3c7DQoJCWF1eFBhcnRuZXIgPSBfYXV4Ow0KCX0NCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIERFQlVHIE9OTFkgLSBlbmQgdGhpcyBjb250cmFjdCwgc3VpY2lkZSB0byBkZXZlbG9wZXJzDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGhhcmFLaXJpKCkNCgl7DQoJCWlmIChzZXR0aW5nc1N0YXRlICE9IFNldHRpbmdTdGF0ZVZhbHVlLmRlYnVnKQ0KCQkJdGhyb3c7DQoJCWlmIChtc2cuc2VuZGVyICE9IG93bmVyKQ0KCQkJIHRocm93Ow0KCQlzdWljaWRlKGRldmVsb3BlcnMpOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBnZXQgYWxsIGljbyBzdGF0dXMsIGZ1bmRpbmcgYW5kIHVzYWdlIGluZm8NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0SWNvSW5mbygpIGNvbnN0YW50IHJldHVybnMoSWNvU3RhdHVzVmFsdWUgX3N0YXR1cywgdWludCBfc2FsZVN0YXJ0LCB1aW50IF9zYWxlRW5kLCB1aW50IF91c2FnZUVuZCwgdWludCBfc2FsZUdvYWwsIHVpbnQgX3VzYWdlR29hbCwgdWludCBfc29sZCwgdWludCBfdXNlZCwgdWludCBfZnVuZHMsIHVpbnQgX2NyZWRpdHMsIHVpbnQgX3JlbXVTdGFnZSwgdWludCBfdmVzdCkNCgl7DQoJCV9zdGF0dXMgPSBpY29TdGF0dXM7DQoJCV9zYWxlU3RhcnQgPSBmdW5kaW5nU3RhcnQ7DQoJCV9zYWxlRW5kID0gZnVuZGluZ0RlYWRsaW5lOw0KCQlfdXNhZ2VFbmQgPSB1c2FnZURlYWRsaW5lOw0KCQlfdmVzdCA9IHZlc3RUaW1lOw0KCQlfc2FsZUdvYWwgPSBtaW5JY29Ub2tlbkdvYWw7DQoJCV91c2FnZUdvYWwgPSBtaW5Vc2FnZUdvYWw7DQoJCV9zb2xkID0gZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCk7DQoJCV91c2VkID0gZ2V0TnVtR2FtZXMoKTsNCgkJX2Z1bmRzID0gdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQ7DQoJCV9jcmVkaXRzID0gcGFydG5lckNyZWRpdHM7DQoJCV9yZW11U3RhZ2UgPSByZW11bmVyYXRpb25TdGFnZTsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gTk9URSEgQ0FMTCBBVCBUSEUgUklTSyBPRiBSVU5OSU5HIE9VVCBPRiBHQVMuDQoJLy8gQU5ZT05FIENBTiBDQUxMIFRISVMgRlVOQ1RJT04gQlVUIFlPVSBIQVZFIFRPIFNVUFBMWSANCgkvLyBUSEUgQ09SUkVDVCBBTU9VTlQgT0YgR0FTIFdISUNIIE1BWSBERVBFTkQgT04gDQoJLy8gVEhFIF9OVU1QQVlTIFBBUkFNRVRFUi4gIFdISUNIIE1VU1QgQkUgQkVUV0VFTiAxIEFORCAxMDAwDQoJLy8gVEhFIFNUQU5EQVJEIFZBTFVFIElTIFNUT1JFRCBJTiAibWF4UGF5c1BlciINCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZmx1c2hEaXZpZGVuZHModWludCBfbnVtUGF5cykNCgl7DQoJCWlmICgoX251bVBheXMgPT0gMCkgfHwgKF9udW1QYXlzID4gMTAwMCkpIHsNCgkJCVN0YXRFdmVudCgiSW52YWxpZC4iKTsNCgkJfSBlbHNlIGlmIChob2xkb3ZlckJhbGFuY2UgPiAwIHx8IHBheW91dEJhbGFuY2UgPiAwKSB7DQoJCQlkb1BheW91dChfbnVtUGF5cyk7DQoJCX0gZWxzZSB7DQoJCQlTdGF0RXZlbnQoIk5vdGhpbmcgdG8gZG8uIik7DQoJCX0NCgkJCQkNCgl9DQoNCglmdW5jdGlvbiBkb0RldmVsb3BlckdyYW50KCkgaW50ZXJuYWwNCgl7DQoJCWlmICghZGV2ZWxvcGVyc0dyYW50ZWQpIHsNCgkJCWRldmVsb3BlcnNHcmFudGVkID0gdHJ1ZTsNCgkJCW51bURldlRva2VucyA9ICh0b3RhbFRva2Vuc01pbnRlZCAqIDE1KS8xMDA7DQoJCQl0b3RhbFRva2Vuc01pbnRlZCArPSBudW1EZXZUb2tlbnM7DQoJCQlpZiAoIWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmFsbG9jZWQpIA0KCQkJCWFkZEFjY291bnQoZGV2ZWxvcGVycyk7DQoJCQl1aW50IG5ld0hlbGQgPSBnZXRIZWxkKGhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLnRva2VucykgKyBudW1EZXZUb2tlbnM7DQoJCQlob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMgPSBuZXdIZWxkIHwgIChjdXJQYXlvdXRJZCAqICgyICoqIDQ4KSk7DQoNCgkJfQ0KCX0NCg0KDQp9'