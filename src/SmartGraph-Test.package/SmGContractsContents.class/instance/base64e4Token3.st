base 64 content
base64e4Token3
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQoNCi8vDQovLyBGT1IgUkVGRVJFTkNFIC0gSU5DTFVERSAgaUU0Um93RXNjcm93ICAoaW50ZXJmYWNlKSBDT05UUkFDVCBhdCB0aGUgdG9wIC4uLi4uDQovLw0KDQpjb250cmFjdCBpRTRSb3dFc2Nyb3cgew0KCWZ1bmN0aW9uIGdldE51bUdhbWVzU3RhcnRlZCgpIGNvbnN0YW50IHJldHVybnMgKGludCBuZ2FtZXMpOw0KfQ0KDQovLyBBYnN0cmFjdCBjb250cmFjdCBmb3IgdGhlIGZ1bGwgRVJDIDIwIFRva2VuIHN0YW5kYXJkDQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBBQlNUUkFDVCBzdGFuZGFyZCB0b2tlbiBjbGFzcw0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBUb2tlbiB7IA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7DQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQp9DQoNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBFNFJvd1Jld2FyZHMgLSBhYnN0cmFjdCBlNCBkaXZpZGVuZCBjb250cmFjdA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmNvbnRyYWN0IEU0Um93UmV3YXJkcw0Kew0KCWZ1bmN0aW9uIGNoZWNrRGl2aWRlbmRzKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHJldHVybnModWludCBfYW1vdW50KTsNCglmdW5jdGlvbiB3aXRoZHJhd0RpdmlkZW5kcygpIHB1YmxpYyByZXR1cm5zICh1aW50IG5hbW91bnQpOw0KfQ0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gIEZpbm5leSBDaGlwIC0gdG9rZW4gY29udHJhY3QNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBFNFRva2VuIGlzIFRva2VuLCBFNFJvd1Jld2FyZHMgew0KICAgIAlldmVudCBTdGF0RXZlbnQoc3RyaW5nIG1zZyk7DQogICAgCWV2ZW50IFN0YXRFdmVudEkoc3RyaW5nIG1zZywgdWludCB2YWwpOw0KDQoJZW51bSBTZXR0aW5nU3RhdGVWYWx1ZSAge2RlYnVnLCByZWxlYXNlLCBsb2NrZWRSZWxlYXNlfQ0KCWVudW0gSWNvU3RhdHVzVmFsdWUge2Fub3VuY2VtZW50LCBzYWxlT3Blbiwgc2FsZUNsb3NlZCwgZmFpbGVkLCBzdWNjZWVkZWR9DQoNCg0KDQoNCglzdHJ1Y3QgdG9rZW5BY2NvdW50IHsNCgkJYm9vbCBhbGxvY2VkOyAvLyBmbGFnIHRvIGFzY2VydCBwcmlvciBhbGxvY2F0aW9uDQoJCXVpbnQgdG9rZW5zOyAvLyBudW0gdG9rZW5zDQoJCXVpbnQgYmFsYW5jZTsgLy8gcmV3YXJkcyBiYWxhbmNlDQoJfQ0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBkYXRhIHN0b3JhZ2UNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglhZGRyZXNzIGRldmVsb3BlcnM7IC8vIGRldmVsb3BlcnMgdG9rZW4gaG9sZGluZyBhZGRyZXNzDQoJYWRkcmVzcyBwdWJsaWMgb3duZXI7IC8vIGRlcGxveWVyIGV4ZWN1dG9yDQoJYWRkcmVzcyBmb3VuZGVyT3JnOyAvLyBmb3VuZGVyIG9yZ2luYWl6YXRpb24gY29udHJhY3QNCglhZGRyZXNzIGF1eFBhcnRuZXI7IC8vIGF1eCBwYXJ0bmVyIChwci9hdWRpdGluZykgLSAxIHBlcmNlbnQgdXBvbiBjbG9zZQ0KCWFkZHJlc3MgZTRfcGFydG5lcjsgLy8gZTRyb3cgIGNvbnRyYWN0IGFkZHJlc3Nlcw0KDQoNCgltYXBwaW5nIChhZGRyZXNzID0+IHRva2VuQWNjb3VudCkgaG9sZGVyQWNjb3VudHMgOyAvLyB3aG8gaG9sZHMgaG93IG1hbnkgdG9rZW5zIChoaWdoIHR3byBieXRlcyBjb250YWluIGN1clBheUlkKQ0KCW1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaG9sZGVySW5kZXhlcyA7IC8vIGZvciBpdGVyYXRpb24gdGhydSBob2xkZXINCgl1aW50IG51bUFjY291bnRzOw0KDQoJdWludCBwYXJ0bmVyQ3JlZGl0czsgLy8gYW1vdW50IHBhcnRuZXIgKGU0cm93KSAgaGFzIHBhaWQNCgltYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7IC8vIGFwcHJvdmFscw0KDQoNCgl1aW50IG1heE1pbnRhYmxlVG9rZW5zOyAvLyAuLi4NCgl1aW50IG1pbkljb1Rva2VuR29hbDsvLyB0b2tlbiBnb2FsIGJ5IHNhbGUgZW5kDQoJdWludCBtaW5Vc2FnZUdvYWw7IC8vICBudW0gZ2FtZXMgZ29hbCBieSB1c2FnZSBkZWFkbGluZQ0KCXVpbnQgcHVibGljICB0b2tlblByaWNlOyAvLyBwcmljZSBwZXIgdG9rZW4NCgl1aW50IHB1YmxpYyBwYXlvdXRUaHJlc2hvbGQ7IC8vIHRocmVzaG9sZCB0aWxsIHBheW91dA0KDQoJdWludCB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZDsgCS8vIHJ1bm5pbmcgdG90YWwgb2YgdG9rZW4gZnVuZHMgcmVjZWl2ZWQNCgl1aW50IHB1YmxpYyB0b3RhbFRva2Vuc01pbnRlZDsgCS8vIHRvdGFsIG51bWJlciBvZiB0b2tlbnMgbWludGVkDQoJdWludCBwdWJsaWMgaG9sZG92ZXJCYWxhbmNlOyAJCS8vIGhvbGQgdGhpcyBhbW91bnQgdW50aWwgdGhyZXNoaG9sZCBiZWZvcmUgcmV3YXJkIHBheW91dA0KCWludCBwdWJsaWMgcGF5b3V0QmFsYW5jZTsgCQkvLyBob2xkIHRoaXMgYW1vdW50IHVudGlsIHRocmVzaGhvbGQgYmVmb3JlIHJld2FyZCBwYXlvdXQNCglpbnQgcHJPcmlnUGF5b3V0QmFsOwkJCS8vIG9yaWdpbmFsIHBheW91dCBiYWxhbmNlIGJlZm9yZSBydW4NCgl1aW50IHByT3JpZ1Rva2Vuc01pbnQ7IAkJCS8vIHRva2VucyBtaW50ZWQgYXQgc3RhcnQgb2YgcGF5IHJ1bg0KCXVpbnQgcHVibGljIGN1clBheW91dElkOwkJLy8gY3VycmVudCBwYXlvdXQgaWQNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0SW5kZXg7CQkvLyBwYXlvdXQgaWR4IGJldHdlZW4gcnVuIHNlZ21lbnRzDQoJdWludCBwdWJsaWMgbWF4UGF5c1BlcjsJCQkvLyBudW0gcGF5cyBwZXIgc2VnbWVudA0KCXVpbnQgcHVibGljIG1pblBheUludGVydmFsOwkJLy8gbWluIGludGVydmFsIGJldHdlZW4gc3RhcnQgcGF5IHJ1bg0KDQoNCgl1aW50IGZ1bmRpbmdTdGFydDsgCQkvLyBmdW5kaW5nIHN0YXJ0IHRpbWUgaW1tZWRpYXRlbHkgYWZ0ZXIgYW5vdW5jZW1lbnQNCgl1aW50IGZ1bmRpbmdEZWFkbGluZTsgCQkvLyBmdW5kaW5nIGVuZCB0aW1lDQoJdWludCB1c2FnZURlYWRsaW5lOyAJCS8vIGRlYWRsaW5lIHdoZXJlIG1pbmltdW0gdXNhZ2UgbmVlZHMgdG8gYmUgbWV0IGJlZm9yZSBjb25zaWRlcmVkIHN1Y2Nlc3MNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0VGltZTsgCS8vIHRpbWVzdGFtcCBvZiBsYXN0IHBheW91dCB0aW1lDQoJdWludCB2ZXN0VGltZTsgCQkvLyAxIHllYXIgcGFzdCBzYWxlIHZlc3QgZGV2ZWxvcGVyIHRva2Vucw0KCXVpbnQgbnVtRGV2VG9rZW5zOyAJLy8gMTAgcGVyIGNlbnQgb2YgdG9rZW5zIGFmdGVyIGNsb3NlIHRvIGRldmVsb3BlcnMNCglib29sIGRldmVsb3BlcnNHcmFudGVkOyAJCS8vIGZsYWcNCgl1aW50IHJlbXVuZXJhdGlvblN0YWdlOyAJLy8gMCBmb3Igbm90IHlldCwgMSBmb3IgMTAgcGVyY2VudCwgMiBmb3IgcmVtYWluaW5nICB1cG9uIHN1Y2NlZWRlZC4NCgl1aW50IHB1YmxpYyByZW11bmVyYXRpb25CYWxhbmNlOyAJLy8gcmVtdW5lcmF0aW9uIGJhbGFuY2UgdG8gcmVsZWFzZSB0b2tlbiBmdW5kcw0KCXVpbnQgYXV4UGFydG5lckJhbGFuY2U7IAkvLyBhdXggcGFydG5lciBiYWxhbmNlIC0gMSBwZXJjZW50DQoJdWludCBybUdhczsgLy8gcmVtdW5lcmF0aW9uIGdhcw0KCXVpbnQgcndHYXM7IC8vIHJld2FyZCBnYXMNCgl1aW50IHJmR2FzOyAvLyByZWZ1bmQgZ2FzDQoNCglJY29TdGF0dXNWYWx1ZSBpY29TdGF0dXM7ICAvLyBjdXJyZW50IHN0YXR1cyBvZiBpY28NCglTZXR0aW5nU3RhdGVWYWx1ZSBwdWJsaWMgc2V0dGluZ3NTdGF0ZTsNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjb250cmFjdCBjb25zdHJ1Y3Rvcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gRTRUb2tlbigpIA0KCXsNCgkJb3duZXIgPSBtc2cuc2VuZGVyOw0KCQlkZXZlbG9wZXJzID0gbXNnLnNlbmRlcjsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHVzZSB0aGlzIHRvIHJlc2V0IGV2ZXJ5dGhpbmcsIHdpbGwgbmV2ZXIgYmUgY2FsbGVkIGFmdGVyIGxvY2tSZWxlYXNlDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBhcHBseVNldHRpbmdzKFNldHRpbmdTdGF0ZVZhbHVlIHFTdGF0ZSwgdWludCBfc2FsZVN0YXJ0LCB1aW50IF9zYWxlRW5kLCB1aW50IF91c2FnZUVuZCwgdWludCBfbWluVXNhZ2UsIHVpbnQgX3Rva0dvYWwsIHVpbnQgIF9tYXhNaW50YWJsZSwgdWludCBfdGhyZXNob2xkLCB1aW50IF9wcmljZSwgdWludCBfbXBwLCB1aW50IF9tcGkgKQ0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIA0KCQkJcmV0dXJuOw0KDQoJCS8vIHRoZXNlIHNldHRpbmdzIGFyZSBwZXJtYW5lbnRseSB0d2Vha2FibGUgZm9yIHBlcmZvcm1hbmNlIGFkanVzdG1lbnRzDQoJCXBheW91dFRocmVzaG9sZCA9IF90aHJlc2hvbGQ7DQoJCW1heFBheXNQZXIgPSBfbXBwOw0KCQltaW5QYXlJbnRlcnZhbCA9IF9tcGk7DQoNCgkJLy8gdGhpcyBmaXJzdCB0ZXN0IGNoZWNrcyBpZiBhbHJlYWR5IGxvY2tlZA0KCQlpZiAoc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJcmV0dXJuOw0KDQogCSAJc2V0dGluZ3NTdGF0ZSA9IHFTdGF0ZTsNCg0KCQkvLyB0aGlzIHNlY29uZCB0ZXN0IGFsbG93cyBsb2NraW5nIHdpdGhvdXQgY2hhbmdpbmcgb3RoZXIgcGVybWFuZW50IHNldHRpbmdzDQoJCS8vIFdBUk5JTkcsIE1BS0UgU1VSRSBZT1VSJ1JFIEhBUFBZIFdJVEggQUxMIFNFVFRJTkdTIA0KCQkvLyBCRUZPUkUgTE9DS0lORw0KDQoJCWlmIChxU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkgew0KCQkJU3RhdEV2ZW50KCJMb2NraW5nISIpOw0KCQkJcmV0dXJuOw0KCQl9DQoNCgkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQ7DQoNCgkJcm1HYXMgPSAxMDAwMDA7IC8vIHJlbXVuZXJhdGlvbiBnYXMNCgkJcndHYXMgPSAxMDAwMDsgLy8gcmV3YXJkIGdhcw0KCQlyZkdhcyA9IDEwMDAwOyAvLyByZWZ1bmQgZ2FzDQoNCg0KCQkvLyB6ZXJvIG91dCBhbGwgdG9rZW4gaG9sZGVycy4gIA0KCQkvLyBsZWF2ZSBhbGxvY2VkIG9uLCBsZWF2ZSBudW0gYWNjb3VudHMNCgkJLy8gY2FudCBkZWxldGUgdGhlbSBhbnl3YXlzDQoJDQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCA+IDApIHsNCgkJCWZvciAodWludCBpID0gMDsgaSA8IG51bUFjY291bnRzOyBpKysgKSB7DQoJCQkJYWRkcmVzcyBhID0gaG9sZGVySW5kZXhlc1tpXTsNCgkJCQlpZiAoYSAhPSBhZGRyZXNzKDApKSB7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLnRva2VucyA9IDA7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLmJhbGFuY2UgPSAwOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkvLyBkbyBub3QgcmVzZXQgbnVtQWNjb3VudHMhDQoNCgkJdG90YWxUb2tlbnNNaW50ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UNCgkJdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UuDQoJCXBhcnRuZXJDcmVkaXRzID0gMDsgLy8gcmVzZXQgYWxsIHBhcnRuZXIgY3JlZGl0cw0KDQoJCWZ1bmRpbmdTdGFydCA9ICBfc2FsZVN0YXJ0Ow0KCQlmdW5kaW5nRGVhZGxpbmUgPSBfc2FsZUVuZDsNCgkJdXNhZ2VEZWFkbGluZSA9IF91c2FnZUVuZDsNCgkJbWluVXNhZ2VHb2FsID0gX21pblVzYWdlOw0KCQltaW5JY29Ub2tlbkdvYWwgPSBfdG9rR29hbDsNCgkJbWF4TWludGFibGVUb2tlbnMgPSBfbWF4TWludGFibGU7DQoJCXRva2VuUHJpY2UgPSBfcHJpY2U7DQoNCgkJdmVzdFRpbWUgPSBmdW5kaW5nU3RhcnQgKyAoMzY1IGRheXMpOw0KCQludW1EZXZUb2tlbnMgPSAwOw0KCQkNCgkJaG9sZG92ZXJCYWxhbmNlID0gMDsNCgkJcGF5b3V0QmFsYW5jZSA9IDA7DQoJCWN1clBheW91dElkID0gMTsNCgkJbGFzdFBheW91dEluZGV4ID0gMDsNCgkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAwOw0KCQlyZW11bmVyYXRpb25CYWxhbmNlID0gMDsNCgkJYXV4UGFydG5lckJhbGFuY2UgPSAwOw0KCQlkZXZlbG9wZXJzR3JhbnRlZCA9IGZhbHNlOw0KCQlsYXN0UGF5b3V0VGltZSA9IDA7DQoNCgkJaWYgKHRoaXMuYmFsYW5jZSA+IDApIHsNCgkJCWlmICghb3duZXIuY2FsbC5nYXMocmZHYXMpLnZhbHVlKHRoaXMuYmFsYW5jZSkoKSkNCgkJCQlTdGF0RXZlbnQoIkVSUk9SISIpOw0KCQl9DQoJCVN0YXRFdmVudCgib2siKTsNCg0KCX0NCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gdG9rZW5zIGhlbGQgcmVzZXJ2ZSB0aGUgdG9wIHR3byBieXRlcyBmb3IgdGhlIHBheWlkIGxhc3QgcGFpZC4NCgkvLyB0aGlzIGlzIHNvIGhvbGRlcnMgYXQgdGhlIHRvcCBvZiB0aGUgbGlzdCBkb250IHRyYW5zZmVyIHRva2VucyANCgkvLyB0byB0aGVtc2VsdmVzIG9uIHRoZSBib3R0b20gb2YgdGhlIGxpc3QgdGh1cyBzY2FtbWluZyB0aGUgDQoJLy8gc3lzdGVtLiB0aGlzIGZ1bmN0aW9uIGRlY29uc3RydWN0cyB0aGUgdG9rZW5oZWxkIHZhbHVlLg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldFBheUlkQW5kSGVsZCh1aW50IF90b2tIZWxkKSBpbnRlcm5hbCByZXR1cm5zICh1aW50IF9wYXlJZCwgdWludCBfaGVsZCkNCgl7DQoJCV9wYXlJZCA9IChfdG9rSGVsZCAvICgyICoqIDQ4KSkgJiAweGZmZmY7DQoJCV9oZWxkID0gX3Rva0hlbGQgJiAweGZmZmZmZmZmZmZmZjsNCgl9DQoJZnVuY3Rpb24gZ2V0SGVsZCh1aW50IF90b2tIZWxkKSBpbnRlcm5hbCAgcmV0dXJucyAodWludCBfaGVsZCkNCgl7DQoJCV9oZWxkID0gX3Rva0hlbGQgJiAweGZmZmZmZmZmZmZmZjsNCgl9DQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gYWxsb2NhdGUgYSBuZXcgYWNjb3VudCBieSBzZXR0aW5nIGFsbG9jIHRvIHRydWUNCgkvLyBzZXQgdGhlIHRvcCB0byBieXRlcyBvZiB0b2tlbnMgdG8gY3VyIHBheSBpZCB0byBsZWF2ZSBvdXQgb2YgY3VycmVudCByb3VuZA0KCS8vIGFkZCBob2xkZXIgaW5kZXgsIGJ1bXAgdGhlIG51bSBhY2NvdW50cw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGFkZEFjY291bnQoYWRkcmVzcyBfYWRkcikgaW50ZXJuYWwgIHsNCgkJaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQgPSB0cnVlOw0KCQlob2xkZXJBY2NvdW50c1tfYWRkcl0udG9rZW5zID0gKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCgkJaG9sZGVySW5kZXhlc1tudW1BY2NvdW50cysrXSA9IF9hZGRyOw0KCX0NCgkNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIEJFR0lOIEVSQy0yMCBmcm9tIFN0YW5kYXJkVG9rZW4NCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkNCgl7DQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4NCgkJCXx8IGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5hbm91bmNlbWVudCkNCgkJCXN1cHBseSA9IG1heE1pbnRhYmxlVG9rZW5zOw0KCQllbHNlDQoJCQlzdXBwbHkgPSB0b3RhbFRva2Vuc01pbnRlZDsNCgl9DQoNCglmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQoJCWlmICgobXNnLnNlbmRlciA9PSBkZXZlbG9wZXJzKSANCgkJCSYmICAobm93IDwgdmVzdFRpbWUpKSB7DQoJCQkvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoNCg0KCSAgICAgICAgLy9EZWZhdWx0IGFzc3VtZXMgdG90YWxTdXBwbHkgY2FuJ3QgYmUgb3ZlciBtYXggKDJeMjU2IC0gMSkuDQoJICAgICAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLg0KCSAgICAgICAgLy9SZXBsYWNlIHRoZSBpZiB3aXRoIHRoaXMgb25lIGluc3RlYWQuDQoJICAgICAgICAvL2lmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGhvbGRlckFjY291bnRzW190b10pIHsNCg0KCQl2YXIgKHBpZEZyb20sIGhlbGRGcm9tKSA9IGdldFBheUlkQW5kSGVsZChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMpOw0KCSAgICAgICAgaWYgKGhlbGRGcm9tID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQoNCgkgICAgICAgICAgICBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS50b2tlbnMgLT0gX3ZhbHVlOw0KDQoJCSAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkgew0KCQkJYWRkQWNjb3VudChfdG8pOw0KCQkgICAgfQ0KDQoJCSAgICB1aW50IG5ld0hlbGQgPSBfdmFsdWUgKyBnZXRIZWxkKGhvbGRlckFjY291bnRzW190b10udG9rZW5zKTsNCgkJICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIGF2b2lkIG1jZ2VlcyBnYW1iaXQNCgkJICAgIAlwaWRGcm9tID0gY3VyUGF5b3V0SWQ7DQoJCSAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyA9IG5ld0hlbGQgfCAocGlkRnJvbSAqICgyICoqIDQ4KSk7DQoNCgkgICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQoJICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoJICAgICAgICB9IGVsc2UgeyANCgkJCXJldHVybiBmYWxzZTsgDQoJCX0NCiAgICAJfQ0KDQogICAgCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQoJCWlmICgoX2Zyb20gPT0gZGV2ZWxvcGVycykgDQoJCQkmJiAgKG5vdyA8IHZlc3RUaW1lKSkgew0KCQkJLy9zdGF0RXZlbnQoIlRva2VucyBub3QgeWV0IHZlc3RlZC4iKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoNCiAgICAgICAgLy9zYW1lIGFzIGFib3ZlLiBSZXBsYWNlIHRoaXMgbGluZSB3aXRoIHRoZSBmb2xsb3dpbmcgaWYgeW91IHdhbnQgdG8gcHJvdGVjdCBhZ2FpbnN0IHdyYXBwaW5nIHVpbnRzLg0KICAgICAgICAvL2lmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXSkgew0KDQoJCXZhciAocGlkRnJvbSwgaGVsZEZyb20pID0gZ2V0UGF5SWRBbmRIZWxkKGhvbGRlckFjY291bnRzW19mcm9tXS50b2tlbnMpOw0KICAgICAgICAJaWYgKGhlbGRGcm9tID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KCSAgICAgICAgICAgIGhvbGRlckFjY291bnRzW19mcm9tXS50b2tlbnMgLT0gX3ZhbHVlOw0KDQoJCSAgICBpZiAoIWhvbGRlckFjY291bnRzW190b10uYWxsb2NlZCkNCgkJCWFkZEFjY291bnQoX3RvKTsNCg0KCQkgICAgdWludCBuZXdIZWxkID0gX3ZhbHVlICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tfdG9dLnRva2Vucyk7DQoNCgkJICAgIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIGF2b2lkIG1jZ2VlcyBnYW1iaXQNCgkJICAgIAlwaWRGcm9tID0gY3VyUGF5b3V0SWQ7DQoJCSAgICBob2xkZXJBY2NvdW50c1tfdG9dLnRva2VucyA9IG5ld0hlbGQgfCAocGlkRnJvbSAqICgyICoqIDQ4KSk7DQoNCgkgICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQoJICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCgkgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCgkgICAgICAgIH0gZWxzZSB7IA0KCQkgICAgcmV0dXJuIGZhbHNlOyANCgkJfQ0KCX0NCg0KDQogICAgCWZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQoJCS8vIHZhcnMgZGVmYXVsdCB0byAwDQoJCWlmIChob2xkZXJBY2NvdW50c1tfb3duZXJdLmFsbG9jZWQpIHsNCgkgICAgICAgIAliYWxhbmNlID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tfb3duZXJdLnRva2Vucyk7DQoJCX0gDQogICAgCX0NCg0KICAgIAlmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgCWFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgICAgICAJQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIAlyZXR1cm4gdHJ1ZTsNCiAgICAJfQ0KDQogICAgCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIAkJcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgCX0NCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIEVORCBFUkMyMA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQogIA0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBkZWZhdWx0IHBheWFibGUgZnVuY3Rpb24uDQoJLy8gaWYgc2VuZGVyIGlzIGU0cm93ICBwYXJ0bmVyLCB0aGlzIGlzIGEgcmFrZSBmZWUgcGF5bWVudA0KCS8vIG90aGVyd2lzZSB0aGlzIGlzIGEgdG9rZW4gcHVyY2hhc2UuDQoJLy8gdG9rZW5zIG9ubHkgcHVyY2hhc2VhYmxlIGJldHdlZW4gdG9rZW5mdW5kaW5nc3RhcnQgYW5kIGVuZA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCgkJaWYgKG1zZy5zZW5kZXIgPT0gZTRfcGFydG5lcikgew0KCQkgICAgIGZlZVBheW1lbnQoKTsgLy8gZnJvbSBlNHJvdyBnYW1lIGVzY3JvdyBjb250cmFjdA0KCQl9IGVsc2Ugew0KCQkgICAgIHB1cmNoYXNlVG9rZW4oKTsNCgkJfQ0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcHVyY2hhc2UgdG9rZW4gZnVuY3Rpb24gLSB0b2tlbnMgb25seSBzb2xkIGR1cmluZyBzYWxlIHBlcmlvZCB1cCB1bnRpbCB0aGUgbWF4IHRva2Vucw0KCS8vIHB1cmNoYXNlIHByaWNlIGlzIHRva2VuUHJpY2UuICBhbGwgdW5pdHMgaW4gd2VpLg0KCS8vIHB1cmNoYXNlciB3aWxsIG5vdCBiZSBpbmNsdWRlZCBpbiBjdXJyZW50IHBheSBydW4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHB1cmNoYXNlVG9rZW4oKSBwYXlhYmxlIHsNCg0KCQl1aW50IG52YWx1ZSA9IG1zZy52YWx1ZTsgLy8gYmVpbmcgY2FyZWZ1bCB0byBwcmVzZXJ2ZSBtc2cudmFsdWUNCgkJYWRkcmVzcyBucHVyY2hhc2VyID0gbXNnLnNlbmRlcjsNCgkJaWYgKG52YWx1ZSA8IHRva2VuUHJpY2UpIA0KCQkJdGhyb3c7DQoNCgkJdWludCBxdHkgPSBudmFsdWUvdG9rZW5QcmljZTsNCgkJdXBkYXRlSWNvU3RhdHVzKCk7DQoJCWlmIChpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIHB1cmNoYXNlIGlzIGNsb3NlZA0KCQkJdGhyb3c7DQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCArIHF0eSA+IG1heE1pbnRhYmxlVG9rZW5zKQ0KCQkJdGhyb3c7DQoJCWlmICghaG9sZGVyQWNjb3VudHNbbnB1cmNoYXNlcl0uYWxsb2NlZCkNCgkJCWFkZEFjY291bnQobnB1cmNoYXNlcik7DQoJCQ0KCQkvLyBwdXJjaGFzZXIgd2FpdHMgZm9yIG5leHQgcGF5cnVuLiBvdGhlcndpc2UgY2FuIGRpc3J1cHQgY3VyIHBheSBydW4NCgkJdWludCBuZXdIZWxkID0gcXR5ICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMpOw0KCQlob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMgPSBuZXdIZWxkIHwgKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCg0KCQl0b3RhbFRva2Vuc01pbnRlZCArPSBxdHk7DQoJCXRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkICs9IG52YWx1ZTsNCg0KCQlpZiAodG90YWxUb2tlbnNNaW50ZWQgPT0gbWF4TWludGFibGVUb2tlbnMpIHsNCgkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7DQoJCQkvL3Rlc3QgdW5uZWNlc3NhcnkgLSAgaWYgKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkNCgkJCWRvRGV2ZWxvcGVyR3JhbnQoKTsNCgkJCVN0YXRFdmVudEkoIlB1cmNoYXNlZCxHcmFudGVkIiwgcXR5KTsNCgkJfSBlbHNlDQoJCQlTdGF0RXZlbnRJKCJQdXJjaGFzZWQiLCBxdHkpOw0KDQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBhY2NlcHQgcGF5bWVudCBmcm9tIGU0cm93IGNvbnRyYWN0DQoJLy8gRE8gTk9UIENBTEwgVEhJUyBGVU5DVElPTiBMRVNUIFlPVSBMT1NFIFlPVVIgTU9ORVkNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBmZWVQYXltZW50KCkgcGF5YWJsZSAgDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBlNF9wYXJ0bmVyKSB7DQoJCQlTdGF0RXZlbnQoImZvcmJpZGRlbiIpOw0KCQkJcmV0dXJuOyAvLyB0aGFuayB5b3UNCgkJfQ0KCQl1aW50IG5mdmFsdWUgPSBtc2cudmFsdWU7IC8vIHByZXNlcnZlIHZhbHVlIGluIGNhc2UgY2hhbmdlZCBpbiBkZXYgZ3JhbnQNCg0KCQl1cGRhdGVJY29TdGF0dXMoKTsNCg0KCQlob2xkb3ZlckJhbGFuY2UgKz0gbmZ2YWx1ZTsNCgkJcGFydG5lckNyZWRpdHMgKz0gbmZ2YWx1ZTsNCgkJU3RhdEV2ZW50SSgiUGF5bWVudCIsIG5mdmFsdWUpOw0KDQoJCWlmIChob2xkb3ZlckJhbGFuY2UgPiBwYXlvdXRUaHJlc2hvbGQNCgkJCXx8IHBheW91dEJhbGFuY2UgPiAwKQ0KCQkJZG9QYXlvdXQobWF4UGF5c1Blcik7DQoJCQ0KCQ0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHNldCB0aGUgZTRyb3cgcGFydG5lciwgdGhpcyBpcyBvbmx5IGRvbmUgb25jZQ0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHNldEU0Um93UGFydG5lcihhZGRyZXNzIF9hZGRyKSBwdWJsaWMJDQoJew0KCS8vIE9OTFkgb3duZXIgY2FuIHNldCBhbmQgT05MWSBPTkNFISAodW5sZXNzICJ1bmxvY2tlZCIgZGVidWcpDQoJLy8gb25jZSBpdHMgbG9ja2VkLiBPTkxZIE9OQ0UhDQoJCWlmIChtc2cuc2VuZGVyID09IG93bmVyKSB7DQoJCQlpZiAoKGU0X3BhcnRuZXIgPT0gYWRkcmVzcygwKSkgfHwgKHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUuZGVidWcpKSB7DQoJCQkJZTRfcGFydG5lciA9IF9hZGRyOw0KCQkJCXBhcnRuZXJDcmVkaXRzID0gMDsNCgkJCQkvL1N0YXRFdmVudEkoIkU0LVNldCIsIDApOw0KCQkJfSBlbHNlIHsNCgkJCQlTdGF0RXZlbnQoIkFscmVhZHkgU2V0Iik7DQoJCQl9DQoJCX0NCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcmV0dXJuIHRoZSB0b3RhbCB0b2tlbnMgcHVyY2hhc2VkDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldE51bVRva2Vuc1B1cmNoYXNlZCgpIGNvbnN0YW50IHJldHVybnModWludCBfcHVyY2hhc2VkKQ0KCXsNCgkJX3B1cmNoYXNlZCA9IHRvdGFsVG9rZW5zTWludGVkLW51bURldlRva2VuczsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcmV0dXJuIHRoZSBudW0gZ2FtZXMgYXMgcmVwb3J0ZWQgZnJvbSB0aGUgZTRyb3cgIGNvbnRyYWN0DQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldE51bUdhbWVzKCkgY29uc3RhbnQgcmV0dXJucyh1aW50IF9nYW1lcykNCgl7DQoJCS8vX2dhbWVzID0gMDsNCgkJaWYgKGU0X3BhcnRuZXIgIT0gYWRkcmVzcygwKSkgew0KCQkJaUU0Um93RXNjcm93IHBlNCA9IGlFNFJvd0VzY3JvdyhlNF9wYXJ0bmVyKTsNCgkJCV9nYW1lcyA9IHVpbnQocGU0LmdldE51bUdhbWVzU3RhcnRlZCgpKTsNCgkJfSANCgkJLy9lbHNlDQoJCS8vU3RhdEV2ZW50KCJFbXB0eSBFNCIpOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGdldCB0aGUgZm91bmRlcnMsIGF1eFBhcnRuZXIsIGRldmVsb3Blcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0U3BlY2lhbEFkZHJlc3NlcygpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MgX2ZuZHIsIGFkZHJlc3MgX2F1eCwgYWRkcmVzcyBfZGV2LCBhZGRyZXNzIF9lNCkNCgl7DQoJCS8vaWYgKF9zZW5kZXIgPT0gb3duZXIpIHsgLy8gbm8gbXNnLnNlbmRlciBvbiBjb25zdGFudCBmdW5jdGlvbnMgYXQgbGVhc3QgaW4gbWV3DQoJCQlfZm5kciA9IGZvdW5kZXJPcmc7DQoJCQlfYXV4ID0gYXV4UGFydG5lcjsNCgkJCV9kZXYgPSBkZXZlbG9wZXJzOw0KCQkJX2U0ICA9IGU0X3BhcnRuZXI7DQoJCS8vfQ0KCX0NCg0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gdXBkYXRlIHRoZSBpY28gc3RhdHVzDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHVwZGF0ZUljb1N0YXR1cygpIHB1YmxpYw0KCXsNCgkJaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zdWNjZWVkZWQgDQoJCQl8fCBpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuZmFpbGVkKQ0KCQkJcmV0dXJuOw0KCQllbHNlIGlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQpIHsNCgkJCWlmIChub3cgPiBmdW5kaW5nU3RhcnQgJiYgbm93IDw9IGZ1bmRpbmdEZWFkbGluZSkgew0KCQkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuOw0KCQkJCQ0KCQkJfSBlbHNlIGlmIChub3cgPiBmdW5kaW5nRGVhZGxpbmUpIHsNCgkJCQkvLyBzaG91bGQgbm90IGJlIGhlcmUgLSB0aGlzIHdpbGwgZXZlbnR1YWxseSBmYWlsDQoJCQkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZDsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXVpbnQgbnVtUCA9IGdldE51bVRva2Vuc1B1cmNoYXNlZCgpOw0KCQkJdWludCBudW1HID0gZ2V0TnVtR2FtZXMoKTsNCgkJCWlmICgobm93ID4gZnVuZGluZ0RlYWRsaW5lICYmIG51bVAgPCBtaW5JY29Ub2tlbkdvYWwpDQoJCQkJfHwgKG5vdyA+IHVzYWdlRGVhZGxpbmUgJiYgbnVtRyA8IG1pblVzYWdlR29hbCkpIHsNCgkJCQlpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5mYWlsZWQ7DQoJCQl9IGVsc2UgaWYgKChub3cgPiBmdW5kaW5nRGVhZGxpbmUpIC8vIGRvbnQgd2FudCB0byBwcmV2ZW50IG1vcmUgdG9rZW4gc2FsZXMNCgkJCQkmJiAobnVtUCA+PSBtaW5JY29Ub2tlbkdvYWwpDQoJCQkJJiYgKG51bUcgPj0gbWluVXNhZ2VHb2FsKSkgew0KCQkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnN1Y2NlZWRlZDsgLy8gaG9vcmF5DQoJCQl9DQoJCQlpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLnNhbGVPcGVuDQoJCQkJJiYgKChudW1QID49IG1heE1pbnRhYmxlVG9rZW5zKQ0KCQkJCXx8IChub3cgPiBmdW5kaW5nRGVhZGxpbmUpKSkgew0KCQkJCQlpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5zYWxlQ2xvc2VkOw0KCQkJCX0NCgkJfQ0KDQoJCWlmICghZGV2ZWxvcGVyc0dyYW50ZWQNCgkJCSYmIGljb1N0YXR1cyAhPSBJY29TdGF0dXNWYWx1ZS5zYWxlT3BlbiANCgkJCSYmIGljb1N0YXR1cyAhPSBJY29TdGF0dXNWYWx1ZS5hbm91bmNlbWVudA0KCQkJJiYgZ2V0TnVtVG9rZW5zUHVyY2hhc2VkKCkgPj0gbWluSWNvVG9rZW5Hb2FsKSB7DQoJCQkJZG9EZXZlbG9wZXJHcmFudCgpOyAvLyBncmFudCB3aGVuZXZlciBzdGF0dXMgZ29lcyBmcm9tIG9wZW4gdG8gYW55dGhpbmcuLi4NCgkJfQ0KDQoJDQoJfQ0KDQoJDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHJlcXVlc3QgcmVmdW5kLiBDYWxsZXIgbXVzdCBjYWxsIHRvIHJlcXVlc3QgYW5kIHJlY2VpdmUgcmVmdW5kIA0KCS8vIFdBUk5JTkcgLSB3aXRoZHJhdyByZXdhcmRzL2RpdmlkZW5kcyBiZWZvcmUgY2FsbGluZy4NCgkvLyBZT1UgSEFWRSBCRUVOIFdBUk5FRA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiByZXF1ZXN0UmVmdW5kKCkNCgl7DQoJCWFkZHJlc3MgbnJlcXVlc3RlciA9IG1zZy5zZW5kZXI7DQoJCXVwZGF0ZUljb1N0YXR1cygpOw0KDQoJCXVpbnQgbnRva2VucyA9IGdldEhlbGQoaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0udG9rZW5zKTsNCgkJaWYgKGljb1N0YXR1cyAhPSBJY29TdGF0dXNWYWx1ZS5mYWlsZWQpDQoJCQlTdGF0RXZlbnQoIk5vIFJlZnVuZCIpOw0KCQllbHNlIGlmIChudG9rZW5zID09IDApDQoJCQlTdGF0RXZlbnQoIk5vIFRva2VucyIpOw0KCQllbHNlIHsNCgkJCXVpbnQgbnJlZnVuZCA9IG50b2tlbnMgKiB0b2tlblByaWNlOw0KCQkJaWYgKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkNCgkJCQlucmVmdW5kIC09IChucmVmdW5kIC8xMCk7IC8vIG9ubHkgOTAgcGVyY2VudCBiL2MgMTAgcGVyY2VudCBwYXlvdXQNCg0KCQkJaWYgKCFob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS5hbGxvY2VkKSANCgkJCQlhZGRBY2NvdW50KGRldmVsb3BlcnMpOw0KCQkJaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10udG9rZW5zICs9IG50b2tlbnM7DQoJCQlob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS50b2tlbnMgPSAwOw0KCQkJaWYgKGhvbGRlckFjY291bnRzW25yZXF1ZXN0ZXJdLmJhbGFuY2UgPiAwKSB7DQoJCQkJLy8gc2VlIGFib3ZlIHdhcm5pbmchIQ0KCQkJCWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmJhbGFuY2UgKz0gaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0uYmFsYW5jZTsNCgkJCQlob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS5iYWxhbmNlID0gMDsNCgkJCX0NCg0KCQkJaWYgKCFucmVxdWVzdGVyLmNhbGwuZ2FzKHJmR2FzKS52YWx1ZShucmVmdW5kKSgpKQ0KCQkJCXRocm93Ow0KCQkJLy9TdGF0RXZlbnRJKCJSZWZ1bmRlZCIsIG5yZWZ1bmQpOw0KCQl9DQoJfQ0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHBheW91dCByZXdhcmRzIHRvIGFsbCB0b2tlbiBob2xkZXJzDQoJLy8gdXNlIGEgc2Vjb25kIGhvbGRpbmcgdmFyaWFibGUgY2FsbGVkIFBheW91dEJhbGFuY2UgdG8gZG8gDQoJLy8gdGhlIGFjdHVhbCBwYXlvdXQgZnJvbSBiL2MgdG9vIG11Y2ggZ2FzIHRvIGl0ZXJhdGUgdGhydSANCgkvLyBlYWNoIHBheWVlLiBPbmx5IHN0YXJ0IGEgbmV3IHJ1biBhdCBtb3N0IG9uY2UgcGVyICJtaW5wYXlpbnRlcnZhbCIuDQoJLy8gSXRzIGRvbmUgaW4gcnVucyBvZiAiX251bVBheXMiDQoJLy8gd2UgdXNlIHNwZWNpYWwgY29kaW5nIGZvciB0aGUgaG9sZGVyQWNjb3VudHMgdG8gYXZvaWQgYSBoYWNrDQoJLy8gb2YgZ2V0dGluZyBwYWlkIGF0IHRoZSB0b3Agb2YgdGhlIGxpc3QgdGhlbiB0cmFuc2ZlcmluZyB0b2tlbnMNCgkvLyB0byBhbm90aGVyIGFkZHJlc3MgYXQgdGhlIGJvdHRvbSBvZiB0aGUgbGlzdC4NCgkvLyBiZWNhdXNlIG9mIHRoYXQgZWFjaCBob2xkZXJBY2NvdW50cyBlbnRyeSBnZXRzIHRoZSBwYXlvdXRpZCBzdGFtcGVkIHVwb24gaXQgKHRvcCB0d28gYnl0ZXMpDQoJLy8gYWxzbyBhIHRva2VuIHRyYW5zZmVyIHdpbGwgdHJhbnNmZXIgdGhlIHBheW91dCBpZC4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBkb1BheW91dCh1aW50IF9udW1QYXlzKSAgaW50ZXJuYWwNCgl7DQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCA9PSAwKQ0KCQkJcmV0dXJuOw0KDQoJCWlmICgoaG9sZG92ZXJCYWxhbmNlID4gMCkgDQoJCQkmJiAocGF5b3V0QmFsYW5jZSA9PSAwKQ0KCQkJJiYgKG5vdyA+IChsYXN0UGF5b3V0VGltZSttaW5QYXlJbnRlcnZhbCkpKSB7DQoJCQkvLyBzdGFydCBhIG5ldyBydW4NCgkJCWN1clBheW91dElkKys7DQoJCQlpZiAoY3VyUGF5b3V0SWQgPj0gMzI3NjgpDQoJCQkJY3VyUGF5b3V0SWQgPSAxOw0KCQkJbGFzdFBheW91dFRpbWUgPSBub3c7DQoJCQlwYXlvdXRCYWxhbmNlID0gaW50KGhvbGRvdmVyQmFsYW5jZSk7DQoJCQlwck9yaWdQYXlvdXRCYWwgPSBwYXlvdXRCYWxhbmNlOw0KCQkJcHJPcmlnVG9rZW5zTWludCA9IHRvdGFsVG9rZW5zTWludGVkOw0KCQkJaG9sZG92ZXJCYWxhbmNlID0gMDsNCgkJCWxhc3RQYXlvdXRJbmRleCA9IDA7DQoJCQlTdGF0RXZlbnRJKCJTdGFydFJ1biIsIHVpbnQoY3VyUGF5b3V0SWQpKTsNCgkJfSBlbHNlIGlmIChwYXlvdXRCYWxhbmNlID4gMCkgew0KCQkJLy8gd29yayBkb3duIHRoZSBwLm8uYg0KCQkJdWludCBuQW1vdW50Ow0KCQkJdWludCBuUGVyVG9rRGlzdHJpYiA9IHVpbnQocHJPcmlnUGF5b3V0QmFsKS9wck9yaWdUb2tlbnNNaW50Ow0KCQkJdWludCBwYWlkcyA9IDA7DQoJCQl1aW50IGk7IC8vIGludGVudGlvbmFsDQoJCQlmb3IgKGkgPSBsYXN0UGF5b3V0SW5kZXg7IChwYWlkcyA8IF9udW1QYXlzKSAmJiAoaSA8IG51bUFjY291bnRzKSAmJiAocGF5b3V0QmFsYW5jZSA+IDApOyBpKysgKSB7DQoJCQkJYWRkcmVzcyBhID0gaG9sZGVySW5kZXhlc1tpXTsNCgkJCQlpZiAoYSA9PSBhZGRyZXNzKDApKSB7DQoJCQkJCWNvbnRpbnVlOw0KCQkJCX0NCgkJCQl2YXIgKHBpZCwgaGVsZCkgPSBnZXRQYXlJZEFuZEhlbGQoaG9sZGVyQWNjb3VudHNbYV0udG9rZW5zKTsNCgkJCQlpZiAoKGhlbGQgPiAwKSAmJiAocGlkICE9IGN1clBheW91dElkKSkgew0KCQkJCQluQW1vdW50ID0gblBlclRva0Rpc3RyaWIgKiBoZWxkOw0KCQkJCQlpZiAoaW50KG5BbW91bnQpIDw9IHBheW91dEJhbGFuY2Upew0KCQkJCQkJaG9sZGVyQWNjb3VudHNbYV0uYmFsYW5jZSArPSBuQW1vdW50OyANCgkJCQkJCWhvbGRlckFjY291bnRzW2FdLnRva2VucyA9IChjdXJQYXlvdXRJZCAqICgyICoqIDQ4KSkgfCBoZWxkOw0KCQkJCQkJcGF5b3V0QmFsYW5jZSAtPSBpbnQobkFtb3VudCk7CQkJCQkNCgkJCQkJCXBhaWRzKys7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoJCQlsYXN0UGF5b3V0SW5kZXggPSBpOw0KCQkJaWYgKGxhc3RQYXlvdXRJbmRleCA+PSBudW1BY2NvdW50cyB8fCBwYXlvdXRCYWxhbmNlIDw9IDApIHsNCgkJCQlsYXN0UGF5b3V0SW5kZXggPSAwOw0KCQkJCWlmIChwYXlvdXRCYWxhbmNlID4gMCkNCgkJCQkJaG9sZG92ZXJCYWxhbmNlICs9IHVpbnQocGF5b3V0QmFsYW5jZSk7Ly8gcHV0IGJhY2sgYW55IGxlZnRvdmVycw0KCQkJCXBheW91dEJhbGFuY2UgPSAwOw0KCQkJCVN0YXRFdmVudEkoIlJ1bkNvbXBsZXRlIiwgdWludChwck9yaWdQYXlvdXRCYWwpICk7DQoNCgkJCX0gZWxzZSB7DQoJCQkJU3RhdEV2ZW50SSgiUGF5UnVuIiwgcGFpZHMgKTsNCgkJCX0NCgkJfQ0KCQkNCgl9DQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzZW5kZXIgd2l0aGRyYXcgZW50aXJlIHJld2FyZHMvZGl2aWRlbmRzDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHdpdGhkcmF3RGl2aWRlbmRzKCkgcHVibGljIHJldHVybnMgKHVpbnQgX2Ftb3VudCkNCgl7DQoJCWlmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlID09IDApIHsgDQoJCQkvL19hbW91bnQgPSAwOw0KCQkJU3RhdEV2ZW50KCIwIEJhbGFuY2UiKTsNCgkJCXJldHVybjsNCgkJfSBlbHNlIHsNCgkJCWlmICgobXNnLnNlbmRlciA9PSBkZXZlbG9wZXJzKSANCgkJCQkmJiAgKG5vdyA8IHZlc3RUaW1lKSkgew0KCQkJCS8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7DQoJCQkJLy9fYW1vdW50ID0gMDsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCV9hbW91bnQgPSBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlOyANCgkJCWhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmJhbGFuY2UgPSAwOyANCgkJCWlmICghbXNnLnNlbmRlci5jYWxsLmdhcyhyd0dhcykudmFsdWUoX2Ftb3VudCkoKSkNCgkJCQl0aHJvdzsNCgkJCS8vU3RhdEV2ZW50SSgiUGFpZCIsIF9hbW91bnQpOw0KCQ0KCQl9DQoNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc2V0IGdhcyBmb3Igb3BlcmF0aW9ucw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBzZXRPcEdhcyh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQ0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbXNnLnNlbmRlciAhPSBkZXZlbG9wZXJzKSB7DQoJCQkvL1N0YXRFdmVudCgib25seSBvd25lciBjYWxscyIpOw0KCQkJcmV0dXJuOw0KCQl9IGVsc2Ugew0KCQkJcm1HYXMgPSBfcm07DQoJCQlyZkdhcyA9IF9yZjsNCgkJCXJ3R2FzID0gX3J3Ow0KCQl9DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGdldCBnYXMgZm9yIG9wZXJhdGlvbnMNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0T3BHYXMoKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQ0KCXsNCgkJX3JtID0gcm1HYXM7DQoJCV9yZiA9IHJmR2FzOw0KCQlfcncgPSByd0dhczsNCgl9DQogDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gY2hlY2sgcmV3YXJkcy4gIHBhc3MgaW4gYWRkcmVzcyBvZiB0b2tlbiBob2xkZXINCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gY2hlY2tEaXZpZGVuZHMoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcmV0dXJucyh1aW50IF9hbW91bnQpDQoJew0KCQlpZiAoaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQpDQoJCQlfYW1vdW50ID0gaG9sZGVyQWNjb3VudHNbX2FkZHJdLmJhbGFuY2U7DQoJfQkJDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGljb0NoZWNrdXAgLSBjaGVjayB1cCBjYWxsIGZvciBhZG1pbmlzdHJhdG9ycw0KCS8vIGFmdGVyIHNhbGUgaXMgY2xvc2VkIGlmIG1pbiBpY28gdG9rZW5zIHNvbGQsIDEwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0byANCgkvLyBjb21wYW55IHRvIGNvdmVyIHZhcmlvdXMgb3BlcmF0aW5nIGV4cGVuc2VzDQoJLy8gYWZ0ZXIgc2FsZSBhbmQgdXNhZ2UgZGVhbGluZXMgaGF2ZSBiZWVuIG1ldCwgcmVtYWluaW5nIDkwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0bw0KCS8vIGNvbXBhbnkuDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gaWNvQ2hlY2t1cCgpIHB1YmxpYw0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbXNnLnNlbmRlciAhPSBkZXZlbG9wZXJzKQ0KCQkJdGhyb3c7DQoNCgkJdWludCBubXNnbWFzazsNCgkJLy9ubXNnbWFzayA9IDA7DQoJDQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZCkgew0KCQkJaWYgKChnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpDQoJCQkJJiYgKHJlbXVuZXJhdGlvblN0YWdlID09IDAgKSkgew0KCQkJCXJlbXVuZXJhdGlvblN0YWdlID0gMTsNCgkJCQlyZW11bmVyYXRpb25CYWxhbmNlID0gKHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkLzEwMCkqOTsgLy8gOSBwZXJjZW50DQoJCQkJYXV4UGFydG5lckJhbGFuY2UgPSAgKHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkLzEwMCk7IC8vIDEgcGVyY2VudA0KCQkJCW5tc2dtYXNrIHw9IDE7DQoJCQl9IA0KCQl9DQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkKSB7DQoJCQ0KCQkJaWYgKHJlbXVuZXJhdGlvblN0YWdlID09IDAgKSB7DQoJCQkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAxOw0KCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKSo5OyANCgkJCQlhdXhQYXJ0bmVyQmFsYW5jZSA9ICAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKTsNCgkJCQlubXNnbWFzayB8PSA0Ow0KCQkJfQ0KCQkJaWYgKHJlbXVuZXJhdGlvblN0YWdlID09IDEpIHsgLy8gd2UgaGF2ZSBhbHJlYWR5IHN1Y2VlZGVkDQoJCQkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAyOw0KCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgKz0gdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgLSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTApOyAvLyA5MCBwZXJjZW50DQoJCQkJbm1zZ21hc2sgfD0gODsNCgkJCX0NCg0KCQl9DQoNCgkJdWludCBudG1wOw0KDQoJCWlmIChyZW11bmVyYXRpb25CYWxhbmNlID4gMCkgeyANCgkJLy8gb25seSBwYXkgb25lIGVudGl0eSBwZXIgY2FsbCwgZG9udCB3YW50IHRvIHJ1biBvdXQgb2YgZ2FzDQoJCQkJbnRtcCA9IHJlbXVuZXJhdGlvbkJhbGFuY2U7DQoJCQkJcmVtdW5lcmF0aW9uQmFsYW5jZSA9IDA7DQoJCQkJaWYgKCFmb3VuZGVyT3JnLmNhbGwuZ2FzKHJtR2FzKS52YWx1ZShudG1wKSgpKSB7DQoJCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSBudG1wOw0KCQkJCQlubXNnbWFzayB8PSAzMjsNCgkJCQl9IGVsc2Ugew0KCQkJCQlubXNnbWFzayB8PSA2NDsNCgkJCQl9CQ0KCQl9IGVsc2UgCWlmIChhdXhQYXJ0bmVyQmFsYW5jZSA+IDApIHsNCgkJLy8gbm90ZSB0aGUgImVsc2UiIG9ubHkgcGF5IG9uZSBlbnRpdHkgcGVyIGNhbGwsIGRvbnQgd2FudCB0byBydW4gb3V0IG9mIGdhcw0KCQkJbnRtcCA9IGF1eFBhcnRuZXJCYWxhbmNlOw0KCQkJYXV4UGFydG5lckJhbGFuY2UgPSAwOw0KCQkJaWYgKCFhdXhQYXJ0bmVyLmNhbGwuZ2FzKHJtR2FzKS52YWx1ZShudG1wKSgpKSB7DQoJCQkJYXV4UGFydG5lckJhbGFuY2UgPSBudG1wOw0KCQkJCW5tc2dtYXNrIHw9IDEyODsNCgkJCX0gIGVsc2Ugew0KCQkJCW5tc2dtYXNrIHw9IDI1NjsNCgkJCX0NCg0KCQl9IA0KCQkNCgkJU3RhdEV2ZW50SSgiaWNvLWNoZWNrdXAiLCBubXNnbWFzayk7DQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc3dhcCBleGVjdXRvcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9hZGRyKSANCgl7DQoJCWlmIChtc2cuc2VuZGVyICE9IG93bmVyDQoJCQl8fCBzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpDQoJCQkgdGhyb3c7DQoNCgkJb3duZXIgPSBfYWRkcjsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc3dhcCBkZXZlbG9wZXJzIGFjY291bnQNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gY2hhbmdlRGV2ZXZvcGVyQWNjb250KGFkZHJlc3MgX2FkZHIpIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXINCgkJCXx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkNCgkJCSB0aHJvdzsNCgkJZGV2ZWxvcGVycyA9IF9hZGRyOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjaGFuZ2UgZm91bmRlcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VGb3VuZGVyKGFkZHJlc3MgX2FkZHIpIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXINCgkJCXx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkNCgkJCSB0aHJvdzsNCgkJZm91bmRlck9yZyA9IF9hZGRyOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjaGFuZ2UgYXV4UGFydG5lcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VBdXhQYXJ0bmVyKGFkZHJlc3MgX2F1eCkgDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcg0KCQkJfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJIHRocm93Ow0KCQlhdXhQYXJ0bmVyID0gX2F1eDsNCgl9DQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBERUJVRyBPTkxZIC0gZW5kIHRoaXMgY29udHJhY3QsIHN1aWNpZGUgdG8gZGV2ZWxvcGVycw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBoYXJhS2lyaSgpDQoJew0KCQlpZiAoc2V0dGluZ3NTdGF0ZSAhPSBTZXR0aW5nU3RhdGVWYWx1ZS5kZWJ1ZykNCgkJCXRocm93Ow0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcikNCgkJCSB0aHJvdzsNCgkJc3VpY2lkZShkZXZlbG9wZXJzKTsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gZ2V0IGFsbCBpY28gc3RhdHVzLCBmdW5kaW5nIGFuZCB1c2FnZSBpbmZvDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldEljb0luZm8oKSBjb25zdGFudCByZXR1cm5zKEljb1N0YXR1c1ZhbHVlIF9zdGF0dXMsIHVpbnQgX3NhbGVTdGFydCwgdWludCBfc2FsZUVuZCwgdWludCBfdXNhZ2VFbmQsIHVpbnQgX3NhbGVHb2FsLCB1aW50IF91c2FnZUdvYWwsIHVpbnQgX3NvbGQsIHVpbnQgX3VzZWQsIHVpbnQgX2Z1bmRzLCB1aW50IF9jcmVkaXRzLCB1aW50IF9yZW11U3RhZ2UsIHVpbnQgX3Zlc3QpDQoJew0KCQlfc3RhdHVzID0gaWNvU3RhdHVzOw0KCQlfc2FsZVN0YXJ0ID0gZnVuZGluZ1N0YXJ0Ow0KCQlfc2FsZUVuZCA9IGZ1bmRpbmdEZWFkbGluZTsNCgkJX3VzYWdlRW5kID0gdXNhZ2VEZWFkbGluZTsNCgkJX3Zlc3QgPSB2ZXN0VGltZTsNCgkJX3NhbGVHb2FsID0gbWluSWNvVG9rZW5Hb2FsOw0KCQlfdXNhZ2VHb2FsID0gbWluVXNhZ2VHb2FsOw0KCQlfc29sZCA9IGdldE51bVRva2Vuc1B1cmNoYXNlZCgpOw0KCQlfdXNlZCA9IGdldE51bUdhbWVzKCk7DQoJCV9mdW5kcyA9IHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkOw0KCQlfY3JlZGl0cyA9IHBhcnRuZXJDcmVkaXRzOw0KCQlfcmVtdVN0YWdlID0gcmVtdW5lcmF0aW9uU3RhZ2U7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIE5PVEUhIENBTEwgQVQgVEhFIFJJU0sgT0YgUlVOTklORyBPVVQgT0YgR0FTLg0KCS8vIEFOWU9ORSBDQU4gQ0FMTCBUSElTIEZVTkNUSU9OIEJVVCBZT1UgSEFWRSBUTyBTVVBQTFkgDQoJLy8gVEhFIENPUlJFQ1QgQU1PVU5UIE9GIEdBUyBXSElDSCBNQVkgREVQRU5EIE9OIA0KCS8vIFRIRSBfTlVNUEFZUyBQQVJBTUVURVIuICBXSElDSCBNVVNUIEJFIEJFVFdFRU4gMSBBTkQgMTAwMA0KCS8vIFRIRSBTVEFOREFSRCBWQUxVRSBJUyBTVE9SRUQgSU4gIm1heFBheXNQZXIiDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGZsdXNoRGl2aWRlbmRzKHVpbnQgX251bVBheXMpDQoJew0KCQlpZiAoKF9udW1QYXlzID09IDApIHx8IChfbnVtUGF5cyA+IDEwMDApKSB7DQoJCQlTdGF0RXZlbnQoIkludmFsaWQuIik7DQoJCX0gZWxzZSBpZiAoaG9sZG92ZXJCYWxhbmNlID4gMCB8fCBwYXlvdXRCYWxhbmNlID4gMCkgew0KCQkJZG9QYXlvdXQoX251bVBheXMpOw0KCQl9IGVsc2Ugew0KCQkJU3RhdEV2ZW50KCJOb3RoaW5nIHRvIGRvLiIpOw0KCQl9DQoJCQkJDQoJfQ0KDQoJZnVuY3Rpb24gZG9EZXZlbG9wZXJHcmFudCgpIGludGVybmFsDQoJew0KCQlpZiAoIWRldmVsb3BlcnNHcmFudGVkKSB7DQoJCQlkZXZlbG9wZXJzR3JhbnRlZCA9IHRydWU7DQoJCQludW1EZXZUb2tlbnMgPSAodG90YWxUb2tlbnNNaW50ZWQgKiAxNSkvMTAwOw0KCQkJdG90YWxUb2tlbnNNaW50ZWQgKz0gbnVtRGV2VG9rZW5zOw0KCQkJaWYgKCFob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS5hbGxvY2VkKSANCgkJCQlhZGRBY2NvdW50KGRldmVsb3BlcnMpOw0KCQkJdWludCBuZXdIZWxkID0gZ2V0SGVsZChob2xkZXJBY2NvdW50c1tkZXZlbG9wZXJzXS50b2tlbnMpICsgbnVtRGV2VG9rZW5zOw0KCQkJaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10udG9rZW5zID0gbmV3SGVsZCB8ICAoY3VyUGF5b3V0SWQgKiAoMiAqKiA0OCkpOw0KDQoJCX0NCgl9DQoNCg0KfQ=='