base 64 content
base64e4Token5
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQoNCi8vDQovLyBGT1IgUkVGRVJFTkNFIC0gSU5DTFVERSAgaUU0Um93RXNjcm93ICAoaW50ZXJmYWNlKSBDT05UUkFDVCBhdCB0aGUgdG9wIC4uLi4uDQovLw0KDQpjb250cmFjdCBpRTRSb3dFc2Nyb3cgew0KCWZ1bmN0aW9uIGdldE51bUdhbWVzU3RhcnRlZCgpIGNvbnN0YW50IHJldHVybnMgKGludCBuZ2FtZXMpOw0KfQ0KDQovLyBBYnN0cmFjdCBjb250cmFjdCBmb3IgdGhlIGZ1bGwgRVJDIDIwIFRva2VuIHN0YW5kYXJkDQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBBQlNUUkFDVCBzdGFuZGFyZCB0b2tlbiBjbGFzcw0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBUb2tlbiB7IA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7DQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQp9DQoNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBFNFJvd1Jld2FyZHMgLSBhYnN0cmFjdCBlNCBkaXZpZGVuZCBjb250cmFjdA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmNvbnRyYWN0IEU0Um93UmV3YXJkcw0Kew0KCWZ1bmN0aW9uIGNoZWNrRGl2aWRlbmRzKGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IHJldHVybnModWludCBfYW1vdW50KTsNCglmdW5jdGlvbiB3aXRoZHJhd0RpdmlkZW5kcygpIHB1YmxpYyByZXR1cm5zICh1aW50IG5hbW91bnQpOw0KfQ0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gIEZpbm5leSBDaGlwIC0gdG9rZW4gY29udHJhY3QNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjb250cmFjdCBFNFRva2VuIGlzIFRva2VuLCBFNFJvd1Jld2FyZHMgew0KICAgIAlldmVudCBTdGF0RXZlbnQoc3RyaW5nIG1zZyk7DQogICAgCWV2ZW50IFN0YXRFdmVudEkoc3RyaW5nIG1zZywgdWludCB2YWwpOw0KDQoJZW51bSBTZXR0aW5nU3RhdGVWYWx1ZSAge2RlYnVnLCByZWxlYXNlLCBsb2NrZWRSZWxlYXNlfQ0KCWVudW0gSWNvU3RhdHVzVmFsdWUge2Fub3VuY2VtZW50LCBzYWxlT3Blbiwgc2FsZUNsb3NlZCwgZmFpbGVkLCBzdWNjZWVkZWR9DQoNCg0KDQoNCglzdHJ1Y3QgdG9rZW5BY2NvdW50IHsNCgkJYm9vbCBhbGxvY2VkOyAvLyBmbGFnIHRvIGFzY2VydCBwcmlvciBhbGxvY2F0aW9uDQoJCXVpbnQgdG9rZW5zOyAvLyBudW0gdG9rZW5zDQoJCXVpbnQgYmFsYW5jZTsgLy8gcmV3YXJkcyBiYWxhbmNlDQoJfQ0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vICBkYXRhIHN0b3JhZ2UNCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglhZGRyZXNzIGRldmVsb3BlcnM7IC8vIGRldmVsb3BlcnMgdG9rZW4gaG9sZGluZyBhZGRyZXNzDQoJYWRkcmVzcyBwdWJsaWMgb3duZXI7IC8vIGRlcGxveWVyIGV4ZWN1dG9yDQoJYWRkcmVzcyBmb3VuZGVyT3JnOyAvLyBmb3VuZGVyIG9yZ2luYWl6YXRpb24gY29udHJhY3QNCglhZGRyZXNzIGF1eFBhcnRuZXI7IC8vIGF1eCBwYXJ0bmVyIChwci9hdWRpdGluZykgLSAxIHBlcmNlbnQgdXBvbiBjbG9zZQ0KCWFkZHJlc3MgZTRfcGFydG5lcjsgLy8gZTRyb3cgIGNvbnRyYWN0IGFkZHJlc3Nlcw0KDQoNCgltYXBwaW5nIChhZGRyZXNzID0+IHRva2VuQWNjb3VudCkgaG9sZGVyQWNjb3VudHMgOyAvLyB3aG8gaG9sZHMgaG93IG1hbnkgdG9rZW5zIChoaWdoIHR3byBieXRlcyBjb250YWluIGN1clBheUlkKQ0KCW1hcHBpbmcgKHVpbnQgPT4gYWRkcmVzcykgaG9sZGVySW5kZXhlcyA7IC8vIGZvciBpdGVyYXRpb24gdGhydSBob2xkZXINCgl1aW50IG51bUFjY291bnRzOw0KDQoJdWludCBwYXJ0bmVyQ3JlZGl0czsgLy8gYW1vdW50IHBhcnRuZXIgKGU0cm93KSAgaGFzIHBhaWQNCgltYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7IC8vIGFwcHJvdmFscw0KDQoNCgl1aW50IG1heE1pbnRhYmxlVG9rZW5zOyAvLyAuLi4NCgl1aW50IG1pbkljb1Rva2VuR29hbDsvLyB0b2tlbiBnb2FsIGJ5IHNhbGUgZW5kDQoJdWludCBtaW5Vc2FnZUdvYWw7IC8vICBudW0gZ2FtZXMgZ29hbCBieSB1c2FnZSBkZWFkbGluZQ0KCXVpbnQgcHVibGljICB0b2tlblByaWNlOyAvLyBwcmljZSBwZXIgdG9rZW4NCgl1aW50IHB1YmxpYyBwYXlvdXRUaHJlc2hvbGQ7IC8vIHRocmVzaG9sZCB0aWxsIHBheW91dA0KDQoJdWludCB0b3RhbFRva2VuRnVuZHNSZWNlaXZlZDsgCS8vIHJ1bm5pbmcgdG90YWwgb2YgdG9rZW4gZnVuZHMgcmVjZWl2ZWQNCgl1aW50IHB1YmxpYyB0b3RhbFRva2Vuc01pbnRlZDsgCS8vIHRvdGFsIG51bWJlciBvZiB0b2tlbnMgbWludGVkDQoJdWludCBwdWJsaWMgaG9sZG92ZXJCYWxhbmNlOyAJCS8vIGhvbGQgdGhpcyBhbW91bnQgdW50aWwgdGhyZXNoaG9sZCBiZWZvcmUgcmV3YXJkIHBheW91dA0KCWludCBwdWJsaWMgcGF5b3V0QmFsYW5jZTsgCQkvLyBob2xkIHRoaXMgYW1vdW50IHVudGlsIHRocmVzaGhvbGQgYmVmb3JlIHJld2FyZCBwYXlvdXQNCglpbnQgcHJPcmlnUGF5b3V0QmFsOwkJCS8vIG9yaWdpbmFsIHBheW91dCBiYWxhbmNlIGJlZm9yZSBydW4NCgl1aW50IHByT3JpZ1Rva2Vuc01pbnQ7IAkJCS8vIHRva2VucyBtaW50ZWQgYXQgc3RhcnQgb2YgcGF5IHJ1bg0KCXVpbnQgcHVibGljIGN1clBheW91dElkOwkJLy8gY3VycmVudCBwYXlvdXQgaWQNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0SW5kZXg7CQkvLyBwYXlvdXQgaWR4IGJldHdlZW4gcnVuIHNlZ21lbnRzDQoJdWludCBwdWJsaWMgbWF4UGF5c1BlcjsJCQkvLyBudW0gcGF5cyBwZXIgc2VnbWVudA0KCXVpbnQgcHVibGljIG1pblBheUludGVydmFsOwkJLy8gbWluIGludGVydmFsIGJldHdlZW4gc3RhcnQgcGF5IHJ1bg0KDQoNCgl1aW50IGZ1bmRpbmdTdGFydDsgCQkvLyBmdW5kaW5nIHN0YXJ0IHRpbWUgaW1tZWRpYXRlbHkgYWZ0ZXIgYW5vdW5jZW1lbnQNCgl1aW50IGZ1bmRpbmdEZWFkbGluZTsgCQkvLyBmdW5kaW5nIGVuZCB0aW1lDQoJdWludCB1c2FnZURlYWRsaW5lOyAJCS8vIGRlYWRsaW5lIHdoZXJlIG1pbmltdW0gdXNhZ2UgbmVlZHMgdG8gYmUgbWV0IGJlZm9yZSBjb25zaWRlcmVkIHN1Y2Nlc3MNCgl1aW50IHB1YmxpYyBsYXN0UGF5b3V0VGltZTsgCS8vIHRpbWVzdGFtcCBvZiBsYXN0IHBheW91dCB0aW1lDQoJdWludCB2ZXN0VGltZTsgCQkvLyAxIHllYXIgcGFzdCBzYWxlIHZlc3QgZGV2ZWxvcGVyIHRva2Vucw0KCXVpbnQgbnVtRGV2VG9rZW5zOyAJLy8gMTAgcGVyIGNlbnQgb2YgdG9rZW5zIGFmdGVyIGNsb3NlIHRvIGRldmVsb3BlcnMNCglib29sIGRldmVsb3BlcnNHcmFudGVkOyAJCS8vIGZsYWcNCgl1aW50IHJlbXVuZXJhdGlvblN0YWdlOyAJLy8gMCBmb3Igbm90IHlldCwgMSBmb3IgMTAgcGVyY2VudCwgMiBmb3IgcmVtYWluaW5nICB1cG9uIHN1Y2NlZWRlZC4NCgl1aW50IHB1YmxpYyByZW11bmVyYXRpb25CYWxhbmNlOyAJLy8gcmVtdW5lcmF0aW9uIGJhbGFuY2UgdG8gcmVsZWFzZSB0b2tlbiBmdW5kcw0KCXVpbnQgYXV4UGFydG5lckJhbGFuY2U7IAkvLyBhdXggcGFydG5lciBiYWxhbmNlIC0gMSBwZXJjZW50DQoJdWludCBybUdhczsgLy8gcmVtdW5lcmF0aW9uIGdhcw0KCXVpbnQgcndHYXM7IC8vIHJld2FyZCBnYXMNCgl1aW50IHJmR2FzOyAvLyByZWZ1bmQgZ2FzDQoNCglJY29TdGF0dXNWYWx1ZSBpY29TdGF0dXM7ICAvLyBjdXJyZW50IHN0YXR1cyBvZiBpY28NCglTZXR0aW5nU3RhdGVWYWx1ZSBwdWJsaWMgc2V0dGluZ3NTdGF0ZTsNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjb250cmFjdCBjb25zdHJ1Y3Rvcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gRTRUb2tlbigpIA0KCXsNCgkJb3duZXIgPSBtc2cuc2VuZGVyOw0KCQlkZXZlbG9wZXJzID0gbXNnLnNlbmRlcjsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHVzZSB0aGlzIHRvIHJlc2V0IGV2ZXJ5dGhpbmcsIHdpbGwgbmV2ZXIgYmUgY2FsbGVkIGFmdGVyIGxvY2tSZWxlYXNlDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBhcHBseVNldHRpbmdzKFNldHRpbmdTdGF0ZVZhbHVlIHFTdGF0ZSwgdWludCBfc2FsZVN0YXJ0LCB1aW50IF9zYWxlRW5kLCB1aW50IF91c2FnZUVuZCwgdWludCBfbWluVXNhZ2UsIHVpbnQgX3Rva0dvYWwsIHVpbnQgIF9tYXhNaW50YWJsZSwgdWludCBfdGhyZXNob2xkLCB1aW50IF9wcmljZSwgdWludCBfbXBwLCB1aW50IF9tcGkgKQ0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIA0KCQkJcmV0dXJuOw0KDQoJCS8vIHRoZXNlIHNldHRpbmdzIGFyZSBwZXJtYW5lbnRseSB0d2Vha2FibGUgZm9yIHBlcmZvcm1hbmNlIGFkanVzdG1lbnRzDQoJCXBheW91dFRocmVzaG9sZCA9IF90aHJlc2hvbGQ7DQoJCW1heFBheXNQZXIgPSBfbXBwOw0KCQltaW5QYXlJbnRlcnZhbCA9IF9tcGk7DQoNCgkJLy8gdGhpcyBmaXJzdCB0ZXN0IGNoZWNrcyBpZiBhbHJlYWR5IGxvY2tlZA0KCQlpZiAoc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJcmV0dXJuOw0KDQogCSAJc2V0dGluZ3NTdGF0ZSA9IHFTdGF0ZTsNCg0KCQkvLyB0aGlzIHNlY29uZCB0ZXN0IGFsbG93cyBsb2NraW5nIHdpdGhvdXQgY2hhbmdpbmcgb3RoZXIgcGVybWFuZW50IHNldHRpbmdzDQoJCS8vIFdBUk5JTkcsIE1BS0UgU1VSRSBZT1VSJ1JFIEhBUFBZIFdJVEggQUxMIFNFVFRJTkdTIA0KCQkvLyBCRUZPUkUgTE9DS0lORw0KDQoJCWlmIChxU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkgew0KCQkJU3RhdEV2ZW50KCJMb2NraW5nISIpOw0KCQkJcmV0dXJuOw0KCQl9DQoNCgkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQ7DQoNCgkJcm1HYXMgPSAxMDAwMDA7IC8vIHJlbXVuZXJhdGlvbiBnYXMNCgkJcndHYXMgPSAxMDAwMDsgLy8gcmV3YXJkIGdhcw0KCQlyZkdhcyA9IDEwMDAwOyAvLyByZWZ1bmQgZ2FzDQoNCg0KCQkvLyB6ZXJvIG91dCBhbGwgdG9rZW4gaG9sZGVycy4gIA0KCQkvLyBsZWF2ZSBhbGxvY2VkIG9uLCBsZWF2ZSBudW0gYWNjb3VudHMNCgkJLy8gY2FudCBkZWxldGUgdGhlbSBhbnl3YXlzDQoJDQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCA+IDApIHsNCgkJCWZvciAodWludCBpID0gMDsgaSA8IG51bUFjY291bnRzOyBpKysgKSB7DQoJCQkJYWRkcmVzcyBhID0gaG9sZGVySW5kZXhlc1tpXTsNCgkJCQlpZiAoYSAhPSBhZGRyZXNzKDApKSB7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLnRva2VucyA9IDA7DQoJCQkJCWhvbGRlckFjY291bnRzW2FdLmJhbGFuY2UgPSAwOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkvLyBkbyBub3QgcmVzZXQgbnVtQWNjb3VudHMhDQoNCgkJdG90YWxUb2tlbnNNaW50ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UNCgkJdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgPSAwOyAvLyB0aGlzIHdpbGwgZXJhc2UuDQoJCWU0X3BhcnRuZXIgPSBhZGRyZXNzKDApOyAvLyBtdXN0IGJlIHJlc2V0IGFnYWluDQoNCgkJZnVuZGluZ1N0YXJ0ID0gIF9zYWxlU3RhcnQ7DQoJCWZ1bmRpbmdEZWFkbGluZSA9IF9zYWxlRW5kOw0KCQl1c2FnZURlYWRsaW5lID0gX3VzYWdlRW5kOw0KCQltaW5Vc2FnZUdvYWwgPSBfbWluVXNhZ2U7DQoJCW1pbkljb1Rva2VuR29hbCA9IF90b2tHb2FsOw0KCQltYXhNaW50YWJsZVRva2VucyA9IF9tYXhNaW50YWJsZTsNCgkJdG9rZW5QcmljZSA9IF9wcmljZTsNCg0KCQl2ZXN0VGltZSA9IGZ1bmRpbmdTdGFydCArICgzNjUgZGF5cyk7DQoJCW51bURldlRva2VucyA9IDA7DQoJCQ0KCQlob2xkb3ZlckJhbGFuY2UgPSAwOw0KCQlwYXlvdXRCYWxhbmNlID0gMDsNCgkJY3VyUGF5b3V0SWQgPSAxOw0KCQlsYXN0UGF5b3V0SW5kZXggPSAwOw0KCQlyZW11bmVyYXRpb25TdGFnZSA9IDA7DQoJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSAwOw0KCQlhdXhQYXJ0bmVyQmFsYW5jZSA9IDA7DQoJCWRldmVsb3BlcnNHcmFudGVkID0gZmFsc2U7DQoJCWxhc3RQYXlvdXRUaW1lID0gMDsNCg0KCQlpZiAodGhpcy5iYWxhbmNlID4gMCkgew0KCQkJaWYgKCFvd25lci5jYWxsLmdhcyhyZkdhcykudmFsdWUodGhpcy5iYWxhbmNlKSgpKQ0KCQkJCVN0YXRFdmVudCgiRVJST1IhIik7DQoJCX0NCgkJU3RhdEV2ZW50KCJvayIpOw0KDQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyB0b2tlbnMgaGVsZCByZXNlcnZlIHRoZSB0b3AgdHdvIGJ5dGVzIGZvciB0aGUgcGF5aWQgbGFzdCBwYWlkLg0KCS8vIHRoaXMgaXMgc28gaG9sZGVycyBhdCB0aGUgdG9wIG9mIHRoZSBsaXN0IGRvbnQgdHJhbnNmZXIgdG9rZW5zIA0KCS8vIHRvIHRoZW1zZWx2ZXMgb24gdGhlIGJvdHRvbSBvZiB0aGUgbGlzdCB0aHVzIHNjYW1taW5nIHRoZSANCgkvLyBzeXN0ZW0uIHRoaXMgZnVuY3Rpb24gZGVjb25zdHJ1Y3RzIHRoZSB0b2tlbmhlbGQgdmFsdWUuDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0UGF5SWRBbmRIZWxkKHVpbnQgX3Rva0hlbGQpIGludGVybmFsIHJldHVybnMgKHVpbnQgX3BheUlkLCB1aW50IF9oZWxkKQ0KCXsNCgkJX3BheUlkID0gKF90b2tIZWxkIC8gKDIgKiogNDgpKSAmIDB4ZmZmZjsNCgkJX2hlbGQgPSBfdG9rSGVsZCAmIDB4ZmZmZmZmZmZmZmZmOw0KCX0NCglmdW5jdGlvbiBnZXRIZWxkKHVpbnQgX3Rva0hlbGQpIGludGVybmFsICByZXR1cm5zICh1aW50IF9oZWxkKQ0KCXsNCgkJX2hlbGQgPSBfdG9rSGVsZCAmIDB4ZmZmZmZmZmZmZmZmOw0KCX0NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBhbGxvY2F0ZSBhIG5ldyBhY2NvdW50IGJ5IHNldHRpbmcgYWxsb2MgdG8gdHJ1ZQ0KCS8vIHNldCB0aGUgdG9wIHRvIGJ5dGVzIG9mIHRva2VucyB0byBjdXIgcGF5IGlkIHRvIGxlYXZlIG91dCBvZiBjdXJyZW50IHJvdW5kDQoJLy8gYWRkIGhvbGRlciBpbmRleCwgYnVtcCB0aGUgbnVtIGFjY291bnRzDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gYWRkQWNjb3VudChhZGRyZXNzIF9hZGRyKSBpbnRlcm5hbCAgew0KCQlob2xkZXJBY2NvdW50c1tfYWRkcl0uYWxsb2NlZCA9IHRydWU7DQoJCWhvbGRlckFjY291bnRzW19hZGRyXS50b2tlbnMgPSAoY3VyUGF5b3V0SWQgKiAoMiAqKiA0OCkpOw0KCQlob2xkZXJJbmRleGVzW251bUFjY291bnRzKytdID0gX2FkZHI7DQoJfQ0KCQ0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gQkVHSU4gRVJDLTIwIGZyb20gU3RhbmRhcmRUb2tlbg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KQ0KCXsNCgkJaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zYWxlT3Blbg0KCQkJfHwgaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLmFub3VuY2VtZW50KQ0KCQkJc3VwcGx5ID0gbWF4TWludGFibGVUb2tlbnM7DQoJCWVsc2UNCgkJCXN1cHBseSA9IHRvdGFsVG9rZW5zTWludGVkOw0KCX0NCg0KCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQoNCgkJaWYgKChtc2cuc2VuZGVyID09IGRldmVsb3BlcnMpIA0KCQkJJiYgIChub3cgPCB2ZXN0VGltZSkpIHsNCgkJCS8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCg0KDQoJICAgICAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4NCgkgICAgICAgIC8vSWYgeW91ciB0b2tlbiBsZWF2ZXMgb3V0IHRvdGFsU3VwcGx5IGFuZCBjYW4gaXNzdWUgbW9yZSB0b2tlbnMgYXMgdGltZSBnb2VzIG9uLCB5b3UgbmVlZCB0byBjaGVjayBpZiBpdCBkb2Vzbid0IHdyYXAuDQoJICAgICAgICAvL1JlcGxhY2UgdGhlIGlmIHdpdGggdGhpcyBvbmUgaW5zdGVhZC4NCgkgICAgICAgIC8vaWYgKGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gaG9sZGVyQWNjb3VudHNbX3RvXSkgew0KDQoJCXZhciAocGlkRnJvbSwgaGVsZEZyb20pID0gZ2V0UGF5SWRBbmRIZWxkKGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLnRva2Vucyk7DQoJICAgICAgICBpZiAoaGVsZEZyb20gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsNCg0KCSAgICAgICAgICAgIGhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLnRva2VucyAtPSBfdmFsdWU7DQoNCgkJICAgIGlmICghaG9sZGVyQWNjb3VudHNbX3RvXS5hbGxvY2VkKSB7DQoJCQlhZGRBY2NvdW50KF90byk7DQoJCSAgICB9DQoNCgkJICAgIHVpbnQgbmV3SGVsZCA9IF92YWx1ZSArIGdldEhlbGQoaG9sZGVyQWNjb3VudHNbX3RvXS50b2tlbnMpOw0KCQkgICAgaG9sZGVyQWNjb3VudHNbX3RvXS50b2tlbnMgPSBuZXdIZWxkIHwgKHBpZEZyb20gKiAoMiAqKiA0OCkpOw0KCSAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCgkgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCgkgICAgICAgIH0gZWxzZSB7IA0KCQkJcmV0dXJuIGZhbHNlOyANCgkJfQ0KICAgIAl9DQoNCiAgICAJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQoNCgkJaWYgKChfZnJvbSA9PSBkZXZlbG9wZXJzKSANCgkJCSYmICAobm93IDwgdmVzdFRpbWUpKSB7DQoJCQkvL3N0YXRFdmVudCgiVG9rZW5zIG5vdCB5ZXQgdmVzdGVkLiIpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoNCg0KICAgICAgICAvL3NhbWUgYXMgYWJvdmUuIFJlcGxhY2UgdGhpcyBsaW5lIHdpdGggdGhlIGZvbGxvd2luZyBpZiB5b3Ugd2FudCB0byBwcm90ZWN0IGFnYWluc3Qgd3JhcHBpbmcgdWludHMuDQogICAgICAgIC8vaWYgKGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUgJiYgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7DQoNCgkJdmFyIChwaWRGcm9tLCBoZWxkRnJvbSkgPSBnZXRQYXlJZEFuZEhlbGQoaG9sZGVyQWNjb3VudHNbX2Zyb21dLnRva2Vucyk7DQogICAgICAgIAlpZiAoaGVsZEZyb20gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQoJICAgICAgICAgICAgaG9sZGVyQWNjb3VudHNbX2Zyb21dLnRva2VucyAtPSBfdmFsdWU7DQoNCgkJICAgIGlmICghaG9sZGVyQWNjb3VudHNbX3RvXS5hbGxvY2VkKQ0KCQkJYWRkQWNjb3VudChfdG8pOw0KDQoJCSAgICB1aW50IG5ld0hlbGQgPSBfdmFsdWUgKyBnZXRIZWxkKGhvbGRlckFjY291bnRzW190b10udG9rZW5zKTsNCg0KCQkgICAgaG9sZGVyQWNjb3VudHNbX3RvXS50b2tlbnMgPSBuZXdIZWxkIHwgKHBpZEZyb20gKiAoMiAqKiA0OCkpOw0KCSAgICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCgkgICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KCSAgICAgICAgICAgIHJldHVybiB0cnVlOw0KCSAgICAgICAgfSBlbHNlIHsgDQoJCSAgICByZXR1cm4gZmFsc2U7IA0KCQl9DQoJfQ0KDQoNCiAgICAJZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCgkJLy8gdmFycyBkZWZhdWx0IHRvIDANCgkJaWYgKGhvbGRlckFjY291bnRzW19vd25lcl0uYWxsb2NlZCkgew0KCSAgICAgICAgCWJhbGFuY2UgPSBnZXRIZWxkKGhvbGRlckFjY291bnRzW19vd25lcl0udG9rZW5zKTsNCgkJfSANCiAgICAJfQ0KDQogICAgCWZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICAJYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIAlBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgICAgICAgCXJldHVybiB0cnVlOw0KICAgIAl9DQoNCiAgICAJZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgew0KICAgICAgCQlyZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgICAJfQ0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gRU5EIEVSQzIwDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiAgDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGNoZWNrIHRoZSBhbGxvY2VkDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGhvbGRlckV4aXN0cyhhZGRyZXNzIF9hZGRyKSByZXR1cm5zKGJvb2wgX2V4aXN0KQ0KCXsNCgkJX2V4aXN0ID0gaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQ7DQoJfQ0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBkZWZhdWx0IHBheWFibGUgZnVuY3Rpb24uDQoJLy8gaWYgc2VuZGVyIGlzIGU0cm93ICBwYXJ0bmVyLCB0aGlzIGlzIGEgcmFrZSBmZWUgcGF5bWVudA0KCS8vIG90aGVyd2lzZSB0aGlzIGlzIGEgdG9rZW4gcHVyY2hhc2UuDQoJLy8gdG9rZW5zIG9ubHkgcHVyY2hhc2VhYmxlIGJldHdlZW4gdG9rZW5mdW5kaW5nc3RhcnQgYW5kIGVuZA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCgkJaWYgKG1zZy5zZW5kZXIgPT0gZTRfcGFydG5lcikgew0KCQkgICAgIGZlZVBheW1lbnQoKTsgLy8gZnJvbSBlNHJvdyBnYW1lIGVzY3JvdyBjb250cmFjdA0KCQl9IGVsc2Ugew0KCQkgICAgIHB1cmNoYXNlVG9rZW4oKTsNCgkJfQ0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gcHVyY2hhc2UgdG9rZW4gZnVuY3Rpb24gLSB0b2tlbnMgb25seSBzb2xkIGR1cmluZyBzYWxlIHBlcmlvZCB1cCB1bnRpbCB0aGUgbWF4IHRva2Vucw0KCS8vIHB1cmNoYXNlIHByaWNlIGlzIHRva2VuUHJpY2UuICBhbGwgdW5pdHMgaW4gd2VpLg0KCS8vIHB1cmNoYXNlciB3aWxsIG5vdCBiZSBpbmNsdWRlZCBpbiBjdXJyZW50IHBheSBydW4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHB1cmNoYXNlVG9rZW4oKSBwYXlhYmxlIHsNCg0KCQl1aW50IG52YWx1ZSA9IG1zZy52YWx1ZTsgLy8gYmVpbmcgY2FyZWZ1bCB0byBwcmVzZXJ2ZSBtc2cudmFsdWUNCgkJYWRkcmVzcyBucHVyY2hhc2VyID0gbXNnLnNlbmRlcjsNCgkJaWYgKG52YWx1ZSA8IHRva2VuUHJpY2UpIA0KCQkJdGhyb3c7DQoNCgkJdWludCBxdHkgPSBudmFsdWUvdG9rZW5QcmljZTsNCgkJdXBkYXRlSWNvU3RhdHVzKCk7DQoJCWlmIChpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4pIC8vIHB1cmNoYXNlIGlzIGNsb3NlZA0KCQkJdGhyb3c7DQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCArIHF0eSA+IG1heE1pbnRhYmxlVG9rZW5zKQ0KCQkJdGhyb3c7DQoJCWlmICghaG9sZGVyQWNjb3VudHNbbnB1cmNoYXNlcl0uYWxsb2NlZCkNCgkJCWFkZEFjY291bnQobnB1cmNoYXNlcik7DQoJCQ0KCQkvLyBwdXJjaGFzZXIgd2FpdHMgZm9yIG5leHQgcGF5cnVuLiBvdGhlcndpc2UgY2FuIGRpc3J1cHQgY3VyIHBheSBydW4NCgkJdWludCBuZXdIZWxkID0gcXR5ICsgZ2V0SGVsZChob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMpOw0KCQlob2xkZXJBY2NvdW50c1tucHVyY2hhc2VyXS50b2tlbnMgPSBuZXdIZWxkIHwgKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCg0KCQl0b3RhbFRva2Vuc01pbnRlZCArPSBxdHk7DQoJCXRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkICs9IG52YWx1ZTsNCg0KCQlpZiAodG90YWxUb2tlbnNNaW50ZWQgPT0gbWF4TWludGFibGVUb2tlbnMpIHsNCgkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7DQoJCQkvL3Rlc3QgdW5uZWNlc3NhcnkgLSAgaWYgKGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkNCgkJCWRvRGV2ZWxvcGVyR3JhbnQoKTsNCgkJCVN0YXRFdmVudEkoIlB1cmNoYXNlZCxHcmFudGVkIiwgcXR5KTsNCgkJfSBlbHNlDQoJCQlTdGF0RXZlbnRJKCJQdXJjaGFzZWQiLCBxdHkpOw0KDQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBhY2NlcHQgcGF5bWVudCBmcm9tIGU0cm93IGNvbnRyYWN0DQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZmVlUGF5bWVudCgpIHBheWFibGUgIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gZTRfcGFydG5lcikgew0KCQkJU3RhdEV2ZW50KCJmb3JiaWRkZW4iKTsNCgkJCXJldHVybjsgLy8gdGhhbmsgeW91DQoJCX0NCgkJdWludCBuZnZhbHVlID0gbXNnLnZhbHVlOyAvLyBwcmVzZXJ2ZSB2YWx1ZSBpbiBjYXNlIGNoYW5nZWQgaW4gZGV2IGdyYW50DQoNCgkJdXBkYXRlSWNvU3RhdHVzKCk7DQoNCgkJaG9sZG92ZXJCYWxhbmNlICs9IG5mdmFsdWU7DQoJCXBhcnRuZXJDcmVkaXRzICs9IG5mdmFsdWU7DQoJCVN0YXRFdmVudEkoIlBheW1lbnQiLCBuZnZhbHVlKTsNCg0KCQlpZiAoaG9sZG92ZXJCYWxhbmNlID4gcGF5b3V0VGhyZXNob2xkDQoJCQl8fCBwYXlvdXRCYWxhbmNlID4gMCkNCgkJCWRvUGF5b3V0KG1heFBheXNQZXIpOw0KCQkNCgkNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzZXQgdGhlIGU0cm93IHBhcnRuZXIsIHRoaXMgaXMgb25seSBkb25lIG9uY2UNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBzZXRFNFJvd1BhcnRuZXIoYWRkcmVzcyBfYWRkcikgcHVibGljCQ0KCXsNCgkvLyBPTkxZIG93bmVyIGNhbiBzZXQgYW5kIE9OTFkgT05DRSEgKHVubGVzcyAidW5sb2NrZWQiIGRlYnVnKQ0KCS8vIG9uY2UgaXRzIGxvY2tlZC4gT05MWSBPTkNFIQ0KCQlpZiAobXNnLnNlbmRlciA9PSBvd25lcikgew0KCQkJaWYgKChlNF9wYXJ0bmVyID09IGFkZHJlc3MoMCkpIHx8IChzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmRlYnVnKSkgew0KCQkJCWU0X3BhcnRuZXIgPSBfYWRkcjsNCgkJCQlwYXJ0bmVyQ3JlZGl0cyA9IDA7DQoJCQkJLy9TdGF0RXZlbnRJKCJFNC1TZXQiLCAwKTsNCgkJCX0gZWxzZSB7DQoJCQkJU3RhdEV2ZW50KCJBbHJlYWR5IFNldCIpOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHJldHVybiB0aGUgdG90YWwgdG9rZW5zIHB1cmNoYXNlZA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSBjb25zdGFudCByZXR1cm5zKHVpbnQgX3B1cmNoYXNlZCkNCgl7DQoJCV9wdXJjaGFzZWQgPSB0b3RhbFRva2Vuc01pbnRlZC1udW1EZXZUb2tlbnM7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHJldHVybiB0aGUgbnVtIGdhbWVzIGFzIHJlcG9ydGVkIGZyb20gdGhlIGU0cm93ICBjb250cmFjdA0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBnZXROdW1HYW1lcygpIGNvbnN0YW50IHJldHVybnModWludCBfZ2FtZXMpDQoJew0KCQkvL19nYW1lcyA9IDA7DQoJCWlmIChlNF9wYXJ0bmVyICE9IGFkZHJlc3MoMCkpIHsNCgkJCWlFNFJvd0VzY3JvdyBwZTQgPSBpRTRSb3dFc2Nyb3coZTRfcGFydG5lcik7DQoJCQlfZ2FtZXMgPSB1aW50KHBlNC5nZXROdW1HYW1lc1N0YXJ0ZWQoKSk7DQoJCX0gDQoJCS8vZWxzZQ0KCQkvL1N0YXRFdmVudCgiRW1wdHkgRTQiKTsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBnZXQgdGhlIGZvdW5kZXJzLCBhdXhQYXJ0bmVyLCBkZXZlbG9wZXINCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldFNwZWNpYWxBZGRyZXNzZXMoKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIF9mbmRyLCBhZGRyZXNzIF9hdXgsIGFkZHJlc3MgX2RldiwgYWRkcmVzcyBfZTQpDQoJew0KCQkvL2lmIChfc2VuZGVyID09IG93bmVyKSB7IC8vIG5vIG1zZy5zZW5kZXIgb24gY29uc3RhbnQgZnVuY3Rpb25zIGF0IGxlYXN0IGluIG1ldw0KCQkJX2ZuZHIgPSBmb3VuZGVyT3JnOw0KCQkJX2F1eCA9IGF1eFBhcnRuZXI7DQoJCQlfZGV2ID0gZGV2ZWxvcGVyczsNCgkJCV9lNCAgPSBlNF9wYXJ0bmVyOw0KCQkvL30NCgl9DQoNCg0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHVwZGF0ZSB0aGUgaWNvIHN0YXR1cw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiB1cGRhdGVJY29TdGF0dXMoKSBwdWJsaWMNCgl7DQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkIA0KCQkJfHwgaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLmZhaWxlZCkNCgkJCXJldHVybjsNCgkJZWxzZSBpZiAoaWNvU3RhdHVzID09IEljb1N0YXR1c1ZhbHVlLmFub3VuY2VtZW50KSB7DQoJCQlpZiAobm93ID4gZnVuZGluZ1N0YXJ0ICYmIG5vdyA8PSBmdW5kaW5nRGVhZGxpbmUpIHsNCgkJCQlpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5zYWxlT3BlbjsNCgkJCQkNCgkJCX0gZWxzZSBpZiAobm93ID4gZnVuZGluZ0RlYWRsaW5lKSB7DQoJCQkJLy8gc2hvdWxkIG5vdCBiZSBoZXJlIC0gdGhpcyB3aWxsIGV2ZW50dWFsbHkgZmFpbA0KCQkJCWljb1N0YXR1cyA9IEljb1N0YXR1c1ZhbHVlLnNhbGVDbG9zZWQ7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQl1aW50IG51bVAgPSBnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKTsNCgkJCXVpbnQgbnVtRyA9IGdldE51bUdhbWVzKCk7DQoJCQlpZiAoKG5vdyA+IGZ1bmRpbmdEZWFkbGluZSAmJiBudW1QIDwgbWluSWNvVG9rZW5Hb2FsKQ0KCQkJCXx8IChub3cgPiB1c2FnZURlYWRsaW5lICYmIG51bUcgPCBtaW5Vc2FnZUdvYWwpKSB7DQoJCQkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuZmFpbGVkOw0KCQkJfSBlbHNlIGlmICgobm93ID4gZnVuZGluZ0RlYWRsaW5lKSAvLyBkb250IHdhbnQgdG8gcHJldmVudCBtb3JlIHRva2VuIHNhbGVzDQoJCQkJJiYgKG51bVAgPj0gbWluSWNvVG9rZW5Hb2FsKQ0KCQkJCSYmIChudW1HID49IG1pblVzYWdlR29hbCkpIHsNCgkJCQlpY29TdGF0dXMgPSBJY29TdGF0dXNWYWx1ZS5zdWNjZWVkZWQ7IC8vIGhvb3JheQ0KCQkJfQ0KCQkJaWYgKGljb1N0YXR1cyA9PSBJY29TdGF0dXNWYWx1ZS5zYWxlT3Blbg0KCQkJCSYmICgobnVtUCA+PSBtYXhNaW50YWJsZVRva2VucykNCgkJCQl8fCAobm93ID4gZnVuZGluZ0RlYWRsaW5lKSkpIHsNCgkJCQkJaWNvU3RhdHVzID0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZDsNCgkJCQl9DQoJCX0NCg0KCQlpZiAoIWRldmVsb3BlcnNHcmFudGVkDQoJCQkmJiBpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuc2FsZU9wZW4gDQoJCQkmJiBpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuYW5vdW5jZW1lbnQNCgkJCSYmIGdldE51bVRva2Vuc1B1cmNoYXNlZCgpID49IG1pbkljb1Rva2VuR29hbCkgew0KCQkJCWRvRGV2ZWxvcGVyR3JhbnQoKTsgLy8gZ3JhbnQgd2hlbmV2ZXIgc3RhdHVzIGdvZXMgZnJvbSBvcGVuIHRvIGFueXRoaW5nLi4uDQoJCX0NCg0KCQ0KCX0NCg0KCQ0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyByZXF1ZXN0IHJlZnVuZC4gQ2FsbGVyIG11c3QgY2FsbCB0byByZXF1ZXN0IGFuZCByZWNlaXZlIHJlZnVuZCANCgkvLyBXQVJOSU5HIC0gd2l0aGRyYXcgcmV3YXJkcy9kaXZpZGVuZHMgYmVmb3JlIGNhbGxpbmcuDQoJLy8gWU9VIEhBVkUgQkVFTiBXQVJORUQNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gcmVxdWVzdFJlZnVuZCgpDQoJew0KCQlhZGRyZXNzIG5yZXF1ZXN0ZXIgPSBtc2cuc2VuZGVyOw0KCQl1cGRhdGVJY29TdGF0dXMoKTsNCg0KCQl1aW50IG50b2tlbnMgPSBnZXRIZWxkKGhvbGRlckFjY291bnRzW25yZXF1ZXN0ZXJdLnRva2Vucyk7DQoJCWlmIChpY29TdGF0dXMgIT0gSWNvU3RhdHVzVmFsdWUuZmFpbGVkKQ0KCQkJU3RhdEV2ZW50KCJObyBSZWZ1bmQiKTsNCgkJZWxzZSBpZiAobnRva2VucyA9PSAwKQ0KCQkJU3RhdEV2ZW50KCJObyBUb2tlbnMiKTsNCgkJZWxzZSB7DQoJCQl1aW50IG5yZWZ1bmQgPSBudG9rZW5zICogdG9rZW5QcmljZTsNCgkJCWlmIChnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpDQoJCQkJbnJlZnVuZCAtPSAobnJlZnVuZCAvMTApOyAvLyBvbmx5IDkwIHBlcmNlbnQgYi9jIDEwIHBlcmNlbnQgcGF5b3V0DQoNCgkJCWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLnRva2VucyArPSBudG9rZW5zOw0KCQkJaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0udG9rZW5zID0gMDsNCgkJCWlmIChob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS5iYWxhbmNlID4gMCkgew0KCQkJCS8vIHNlZSBhYm92ZSB3YXJuaW5nISENCgkJCQlpZiAoIWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmFsbG9jZWQpIA0KCQkJCQlhZGRBY2NvdW50KGRldmVsb3BlcnMpOw0KCQkJCWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLmJhbGFuY2UgKz0gaG9sZGVyQWNjb3VudHNbbnJlcXVlc3Rlcl0uYmFsYW5jZTsNCgkJCQlob2xkZXJBY2NvdW50c1tucmVxdWVzdGVyXS5iYWxhbmNlID0gMDsNCgkJCX0NCg0KCQkJaWYgKCFucmVxdWVzdGVyLmNhbGwuZ2FzKHJmR2FzKS52YWx1ZShucmVmdW5kKSgpKQ0KCQkJCXRocm93Ow0KCQkJLy9TdGF0RXZlbnRJKCJSZWZ1bmRlZCIsIG5yZWZ1bmQpOw0KCQl9DQoJfQ0KDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIHBheW91dCByZXdhcmRzIHRvIGFsbCB0b2tlbiBob2xkZXJzDQoJLy8gdXNlIGEgc2Vjb25kIGhvbGRpbmcgdmFyaWFibGUgY2FsbGVkIFBheW91dEJhbGFuY2UgdG8gZG8gDQoJLy8gdGhlIGFjdHVhbCBwYXlvdXQgZnJvbSBiL2MgdG9vIG11Y2ggZ2FzIHRvIGl0ZXJhdGUgdGhydSANCgkvLyBlYWNoIHBheWVlLiBPbmx5IHN0YXJ0IGEgbmV3IHJ1biBhdCBtb3N0IG9uY2UgcGVyICJtaW5wYXlpbnRlcnZhbCIuDQoJLy8gSXRzIGRvbmUgaW4gcnVucyBvZiAiX251bVBheXMiDQoJLy8gd2UgdXNlIHNwZWNpYWwgY29kaW5nIGZvciB0aGUgaG9sZGVyQWNjb3VudHMgdG8gYXZvaWQgYSBoYWNrDQoJLy8gb2YgZ2V0dGluZyBwYWlkIGF0IHRoZSB0b3Agb2YgdGhlIGxpc3QgdGhlbiB0cmFuc2ZlcmluZyB0b2tlbnMNCgkvLyB0byBhbm90aGVyIGFkZHJlc3MgYXQgdGhlIGJvdHRvbSBvZiB0aGUgbGlzdC4NCgkvLyBiZWNhdXNlIG9mIHRoYXQgZWFjaCBob2xkZXJBY2NvdW50cyBlbnRyeSBnZXRzIHRoZSBwYXlvdXRpZCBzdGFtcGVkIHVwb24gaXQgKHRvcCB0d28gYnl0ZXMpDQoJLy8gYWxzbyBhIHRva2VuIHRyYW5zZmVyIHdpbGwgdHJhbnNmZXIgdGhlIHBheW91dCBpZC4NCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBkb1BheW91dCh1aW50IF9udW1QYXlzKSAgaW50ZXJuYWwNCgl7DQoJCWlmICh0b3RhbFRva2Vuc01pbnRlZCA9PSAwKQ0KCQkJcmV0dXJuOw0KDQoJCWlmICgoaG9sZG92ZXJCYWxhbmNlID4gMCkgDQoJCQkmJiAocGF5b3V0QmFsYW5jZSA9PSAwKQ0KCQkJJiYgKG5vdyA+IChsYXN0UGF5b3V0VGltZSttaW5QYXlJbnRlcnZhbCkpKSB7DQoJCQkvLyBzdGFydCBhIG5ldyBydW4NCgkJCWN1clBheW91dElkKys7DQoJCQlpZiAoY3VyUGF5b3V0SWQgPj0gMzI3NjgpDQoJCQkJY3VyUGF5b3V0SWQgPSAxOw0KCQkJbGFzdFBheW91dFRpbWUgPSBub3c7DQoJCQlwYXlvdXRCYWxhbmNlID0gaW50KGhvbGRvdmVyQmFsYW5jZSk7DQoJCQlwck9yaWdQYXlvdXRCYWwgPSBwYXlvdXRCYWxhbmNlOw0KCQkJcHJPcmlnVG9rZW5zTWludCA9IHRvdGFsVG9rZW5zTWludGVkOw0KCQkJaG9sZG92ZXJCYWxhbmNlID0gMDsNCgkJCWxhc3RQYXlvdXRJbmRleCA9IDA7DQoJCQlTdGF0RXZlbnRJKCJTdGFydFJ1biIsIHVpbnQoY3VyUGF5b3V0SWQpKTsNCgkJfSBlbHNlIGlmIChwYXlvdXRCYWxhbmNlID4gMCkgew0KCQkJLy8gd29yayBkb3duIHRoZSBwLm8uYg0KCQkJdWludCBuQW1vdW50Ow0KCQkJdWludCBuUGVyVG9rRGlzdHJpYiA9IHVpbnQocHJPcmlnUGF5b3V0QmFsKS9wck9yaWdUb2tlbnNNaW50Ow0KCQkJdWludCBwYWlkcyA9IDA7DQoJCQl1aW50IGk7IC8vIGludGVudGlvbmFsDQoJCQlmb3IgKGkgPSBsYXN0UGF5b3V0SW5kZXg7IChwYWlkcyA8IF9udW1QYXlzKSAmJiAoaSA8IG51bUFjY291bnRzKSAmJiAocGF5b3V0QmFsYW5jZSA+IDApOyBpKysgKSB7DQoJCQkJYWRkcmVzcyBhID0gaG9sZGVySW5kZXhlc1tpXTsNCgkJCQlpZiAoYSA9PSBhZGRyZXNzKDApKSB7DQoJCQkJCWNvbnRpbnVlOw0KCQkJCX0NCgkJCQl2YXIgKHBpZCwgaGVsZCkgPSBnZXRQYXlJZEFuZEhlbGQoaG9sZGVyQWNjb3VudHNbYV0udG9rZW5zKTsNCgkJCQlpZiAoKGhlbGQgPiAwKSAmJiAocGlkICE9IGN1clBheW91dElkKSkgew0KCQkJCQluQW1vdW50ID0gblBlclRva0Rpc3RyaWIgKiBoZWxkOw0KCQkJCQlpZiAoaW50KG5BbW91bnQpIDw9IHBheW91dEJhbGFuY2Upew0KCQkJCQkJaG9sZGVyQWNjb3VudHNbYV0uYmFsYW5jZSArPSBuQW1vdW50OyANCgkJCQkJCWhvbGRlckFjY291bnRzW2FdLnRva2VucyA9IChjdXJQYXlvdXRJZCAqICgyICoqIDQ4KSkgfCBoZWxkOw0KCQkJCQkJcGF5b3V0QmFsYW5jZSAtPSBpbnQobkFtb3VudCk7CQkJCQkNCgkJCQkJCXBhaWRzKys7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoJCQlsYXN0UGF5b3V0SW5kZXggPSBpOw0KCQkJaWYgKGxhc3RQYXlvdXRJbmRleCA+PSBudW1BY2NvdW50cyB8fCBwYXlvdXRCYWxhbmNlIDw9IDApIHsNCgkJCQlsYXN0UGF5b3V0SW5kZXggPSAwOw0KCQkJCWlmIChwYXlvdXRCYWxhbmNlID4gMCkNCgkJCQkJaG9sZG92ZXJCYWxhbmNlICs9IHVpbnQocGF5b3V0QmFsYW5jZSk7Ly8gcHV0IGJhY2sgYW55IGxlZnRvdmVycw0KCQkJCXBheW91dEJhbGFuY2UgPSAwOw0KCQkJCVN0YXRFdmVudEkoIlJ1bkNvbXBsZXRlIiwgdWludChwck9yaWdQYXlvdXRCYWwpICk7DQoNCgkJCX0gZWxzZSB7DQoJCQkJU3RhdEV2ZW50SSgiUGF5UnVuIiwgcGFpZHMgKTsNCgkJCX0NCgkJfQ0KCQkNCgl9DQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBzZW5kZXIgd2l0aGRyYXcgZW50aXJlIHJld2FyZHMvZGl2aWRlbmRzDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIHdpdGhkcmF3RGl2aWRlbmRzKCkgcHVibGljIHJldHVybnMgKHVpbnQgX2Ftb3VudCkNCgl7DQoJCWlmIChob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlID09IDApIHsgDQoJCQkvL19hbW91bnQgPSAwOw0KCQkJU3RhdEV2ZW50KCIwIEJhbGFuY2UiKTsNCgkJCXJldHVybjsNCgkJfSBlbHNlIHsNCgkJCWlmICgobXNnLnNlbmRlciA9PSBkZXZlbG9wZXJzKSANCgkJCQkmJiAgKG5vdyA8IHZlc3RUaW1lKSkgew0KCQkJCS8vc3RhdEV2ZW50KCJUb2tlbnMgbm90IHlldCB2ZXN0ZWQuIik7DQoJCQkJLy9fYW1vdW50ID0gMDsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCV9hbW91bnQgPSBob2xkZXJBY2NvdW50c1ttc2cuc2VuZGVyXS5iYWxhbmNlOyANCgkJCWhvbGRlckFjY291bnRzW21zZy5zZW5kZXJdLmJhbGFuY2UgPSAwOyANCgkJCWlmICghbXNnLnNlbmRlci5jYWxsLmdhcyhyd0dhcykudmFsdWUoX2Ftb3VudCkoKSkNCgkJCQl0aHJvdzsNCgkJCS8vU3RhdEV2ZW50SSgiUGFpZCIsIF9hbW91bnQpOw0KCQ0KCQl9DQoNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc2V0IGdhcyBmb3Igb3BlcmF0aW9ucw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBzZXRPcEdhcyh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQ0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbXNnLnNlbmRlciAhPSBkZXZlbG9wZXJzKSB7DQoJCQkvL1N0YXRFdmVudCgib25seSBvd25lciBjYWxscyIpOw0KCQkJcmV0dXJuOw0KCQl9IGVsc2Ugew0KCQkJcm1HYXMgPSBfcm07DQoJCQlyZkdhcyA9IF9yZjsNCgkJCXJ3R2FzID0gX3J3Ow0KCQl9DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGdldCBnYXMgZm9yIG9wZXJhdGlvbnMNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gZ2V0T3BHYXMoKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9ybSwgdWludCBfcmYsIHVpbnQgX3J3KQ0KCXsNCgkJX3JtID0gcm1HYXM7DQoJCV9yZiA9IHJmR2FzOw0KCQlfcncgPSByd0dhczsNCgl9DQogDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gY2hlY2sgcmV3YXJkcy4gIHBhc3MgaW4gYWRkcmVzcyBvZiB0b2tlbiBob2xkZXINCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gY2hlY2tEaXZpZGVuZHMoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgcmV0dXJucyh1aW50IF9hbW91bnQpDQoJew0KCQlpZiAoaG9sZGVyQWNjb3VudHNbX2FkZHJdLmFsbG9jZWQpDQoJCQlfYW1vdW50ID0gaG9sZGVyQWNjb3VudHNbX2FkZHJdLmJhbGFuY2U7DQoJfQkJDQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIGljb0NoZWNrdXAgLSBjaGVjayB1cCBjYWxsIGZvciBhZG1pbmlzdHJhdG9ycw0KCS8vIGFmdGVyIHNhbGUgaXMgY2xvc2VkIGlmIG1pbiBpY28gdG9rZW5zIHNvbGQsIDEwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0byANCgkvLyBjb21wYW55IHRvIGNvdmVyIHZhcmlvdXMgb3BlcmF0aW5nIGV4cGVuc2VzDQoJLy8gYWZ0ZXIgc2FsZSBhbmQgdXNhZ2UgZGVhbGluZXMgaGF2ZSBiZWVuIG1ldCwgcmVtYWluaW5nIDkwIHBlcmNlbnQgd2lsbCBiZSBkaXN0cmlidXRlZCB0bw0KCS8vIGNvbXBhbnkuDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gaWNvQ2hlY2t1cCgpIHB1YmxpYw0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgbXNnLnNlbmRlciAhPSBkZXZlbG9wZXJzKQ0KCQkJdGhyb3c7DQoNCgkJdWludCBubXNnbWFzazsNCgkJLy9ubXNnbWFzayA9IDA7DQoJDQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc2FsZUNsb3NlZCkgew0KCQkJaWYgKChnZXROdW1Ub2tlbnNQdXJjaGFzZWQoKSA+PSBtaW5JY29Ub2tlbkdvYWwpDQoJCQkJJiYgKHJlbXVuZXJhdGlvblN0YWdlID09IDAgKSkgew0KCQkJCXJlbXVuZXJhdGlvblN0YWdlID0gMTsNCgkJCQlyZW11bmVyYXRpb25CYWxhbmNlID0gKHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkLzEwMCkqOTsgLy8gOSBwZXJjZW50DQoJCQkJYXV4UGFydG5lckJhbGFuY2UgPSAgKHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkLzEwMCk7IC8vIDEgcGVyY2VudA0KCQkJCW5tc2dtYXNrIHw9IDE7DQoJCQl9IA0KCQl9DQoJCWlmIChpY29TdGF0dXMgPT0gSWNvU3RhdHVzVmFsdWUuc3VjY2VlZGVkKSB7DQoJCQ0KCQkJaWYgKHJlbXVuZXJhdGlvblN0YWdlID09IDAgKSB7DQoJCQkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAxOw0KCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKSo5OyANCgkJCQlhdXhQYXJ0bmVyQmFsYW5jZSA9ICAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTAwKTsNCgkJCQlubXNnbWFzayB8PSA0Ow0KCQkJfQ0KCQkJaWYgKHJlbXVuZXJhdGlvblN0YWdlID09IDEpIHsgLy8gd2UgaGF2ZSBhbHJlYWR5IHN1Y2VlZGVkDQoJCQkJcmVtdW5lcmF0aW9uU3RhZ2UgPSAyOw0KCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgKz0gdG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQgLSAodG90YWxUb2tlbkZ1bmRzUmVjZWl2ZWQvMTApOyAvLyA5MCBwZXJjZW50DQoJCQkJbm1zZ21hc2sgfD0gODsNCgkJCX0NCg0KCQl9DQoNCgkJdWludCBudG1wOw0KDQoJCWlmIChyZW11bmVyYXRpb25CYWxhbmNlID4gMCkgeyANCgkJLy8gb25seSBwYXkgb25lIGVudGl0eSBwZXIgY2FsbCwgZG9udCB3YW50IHRvIHJ1biBvdXQgb2YgZ2FzDQoJCQkJbnRtcCA9IHJlbXVuZXJhdGlvbkJhbGFuY2U7DQoJCQkJcmVtdW5lcmF0aW9uQmFsYW5jZSA9IDA7DQoJCQkJaWYgKCFmb3VuZGVyT3JnLmNhbGwuZ2FzKHJtR2FzKS52YWx1ZShudG1wKSgpKSB7DQoJCQkJCXJlbXVuZXJhdGlvbkJhbGFuY2UgPSBudG1wOw0KCQkJCQlubXNnbWFzayB8PSAzMjsNCgkJCQl9IGVsc2Ugew0KCQkJCQlubXNnbWFzayB8PSA2NDsNCgkJCQl9CQ0KCQl9IGVsc2UgCWlmIChhdXhQYXJ0bmVyQmFsYW5jZSA+IDApIHsNCgkJLy8gbm90ZSB0aGUgImVsc2UiIG9ubHkgcGF5IG9uZSBlbnRpdHkgcGVyIGNhbGwsIGRvbnQgd2FudCB0byBydW4gb3V0IG9mIGdhcw0KCQkJbnRtcCA9IGF1eFBhcnRuZXJCYWxhbmNlOw0KCQkJYXV4UGFydG5lckJhbGFuY2UgPSAwOw0KCQkJaWYgKCFhdXhQYXJ0bmVyLmNhbGwuZ2FzKHJtR2FzKS52YWx1ZShudG1wKSgpKSB7DQoJCQkJYXV4UGFydG5lckJhbGFuY2UgPSBudG1wOw0KCQkJCW5tc2dtYXNrIHw9IDEyODsNCgkJCX0gIGVsc2Ugew0KCQkJCW5tc2dtYXNrIHw9IDI1NjsNCgkJCX0NCg0KCQl9IA0KCQkNCgkJU3RhdEV2ZW50SSgiaWNvLWNoZWNrdXAiLCBubXNnbWFzayk7DQoJfQ0KDQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc3dhcCBleGVjdXRvcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9hZGRyKSANCgl7DQoJCWlmIChtc2cuc2VuZGVyICE9IG93bmVyDQoJCQl8fCBzZXR0aW5nc1N0YXRlID09IFNldHRpbmdTdGF0ZVZhbHVlLmxvY2tlZFJlbGVhc2UpDQoJCQkgdGhyb3c7DQoNCgkJb3duZXIgPSBfYWRkcjsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gc3dhcCBkZXZlbG9wZXJzIGFjY291bnQNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJZnVuY3Rpb24gY2hhbmdlRGV2ZXZvcGVyQWNjb250KGFkZHJlc3MgX2FkZHIpIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXINCgkJCXx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkNCgkJCSB0aHJvdzsNCgkJZGV2ZWxvcGVycyA9IF9hZGRyOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjaGFuZ2UgZm91bmRlcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VGb3VuZGVyKGFkZHJlc3MgX2FkZHIpIA0KCXsNCgkJaWYgKG1zZy5zZW5kZXIgIT0gb3duZXINCgkJCXx8IHNldHRpbmdzU3RhdGUgPT0gU2V0dGluZ1N0YXRlVmFsdWUubG9ja2VkUmVsZWFzZSkNCgkJCSB0aHJvdzsNCgkJZm91bmRlck9yZyA9IF9hZGRyOw0KCX0NCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBjaGFuZ2UgYXV4UGFydG5lcg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBjaGFuZ2VBdXhQYXJ0bmVyKGFkZHJlc3MgX2F1eCkgDQoJew0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcg0KCQkJfHwgc2V0dGluZ3NTdGF0ZSA9PSBTZXR0aW5nU3RhdGVWYWx1ZS5sb2NrZWRSZWxlYXNlKQ0KCQkJIHRocm93Ow0KCQlhdXhQYXJ0bmVyID0gX2F1eDsNCgl9DQoNCg0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBERUJVRyBPTkxZIC0gZW5kIHRoaXMgY29udHJhY3QsIHN1aWNpZGUgdG8gZGV2ZWxvcGVycw0KCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglmdW5jdGlvbiBoYXJhS2lyaSgpDQoJew0KCQlpZiAoc2V0dGluZ3NTdGF0ZSAhPSBTZXR0aW5nU3RhdGVWYWx1ZS5kZWJ1ZykNCgkJCXRocm93Ow0KCQlpZiAobXNnLnNlbmRlciAhPSBvd25lcikNCgkJCSB0aHJvdzsNCgkJc3VpY2lkZShkZXZlbG9wZXJzKTsNCgl9DQoNCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJLy8gZ2V0IGFsbCBpY28gc3RhdHVzLCBmdW5kaW5nIGFuZCB1c2FnZSBpbmZvDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGdldEljb0luZm8oKSBjb25zdGFudCByZXR1cm5zKEljb1N0YXR1c1ZhbHVlIF9zdGF0dXMsIHVpbnQgX3NhbGVTdGFydCwgdWludCBfc2FsZUVuZCwgdWludCBfdXNhZ2VFbmQsIHVpbnQgX3NhbGVHb2FsLCB1aW50IF91c2FnZUdvYWwsIHVpbnQgX3NvbGQsIHVpbnQgX3VzZWQsIHVpbnQgX2Z1bmRzLCB1aW50IF9jcmVkaXRzLCB1aW50IF9yZW11U3RhZ2UsIHVpbnQgX3Zlc3QpDQoJew0KCQlfc3RhdHVzID0gaWNvU3RhdHVzOw0KCQlfc2FsZVN0YXJ0ID0gZnVuZGluZ1N0YXJ0Ow0KCQlfc2FsZUVuZCA9IGZ1bmRpbmdEZWFkbGluZTsNCgkJX3VzYWdlRW5kID0gdXNhZ2VEZWFkbGluZTsNCgkJX3Zlc3QgPSB2ZXN0VGltZTsNCgkJX3NhbGVHb2FsID0gbWluSWNvVG9rZW5Hb2FsOw0KCQlfdXNhZ2VHb2FsID0gbWluVXNhZ2VHb2FsOw0KCQlfc29sZCA9IGdldE51bVRva2Vuc1B1cmNoYXNlZCgpOw0KCQlfdXNlZCA9IGdldE51bUdhbWVzKCk7DQoJCV9mdW5kcyA9IHRvdGFsVG9rZW5GdW5kc1JlY2VpdmVkOw0KCQlfY3JlZGl0cyA9IHBhcnRuZXJDcmVkaXRzOw0KCQlfcmVtdVN0YWdlID0gcmVtdW5lcmF0aW9uU3RhZ2U7DQoJfQ0KDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIE5PVEUhIENBTEwgQVQgVEhFIFJJU0sgT0YgUlVOTklORyBPVVQgT0YgR0FTLg0KCS8vIEFOWU9ORSBDQU4gQ0FMTCBUSElTIEZVTkNUSU9OIEJVVCBZT1UgSEFWRSBUTyBTVVBQTFkgDQoJLy8gVEhFIENPUlJFQ1QgQU1PVU5UIE9GIEdBUyBXSElDSCBNQVkgREVQRU5EIE9OIA0KCS8vIFRIRSBfTlVNUEFZUyBQQVJBTUVURVIuICBXSElDSCBNVVNUIEJFIEJFVFdFRU4gMSBBTkQgMTAwMA0KCS8vIFRIRSBTVEFOREFSRCBWQUxVRSBJUyBTVE9SRUQgSU4gIm1heFBheXNQZXIiDQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWZ1bmN0aW9uIGZsdXNoRGl2aWRlbmRzKHVpbnQgX251bVBheXMpDQoJew0KCQlpZiAoKF9udW1QYXlzID09IDApIHx8IChfbnVtUGF5cyA+IDEwMDApKSB7DQoJCQlTdGF0RXZlbnQoIkludmFsaWQuIik7DQoJCX0gZWxzZSBpZiAoaG9sZG92ZXJCYWxhbmNlID4gMCB8fCBwYXlvdXRCYWxhbmNlID4gMCkgew0KCQkJZG9QYXlvdXQoX251bVBheXMpOw0KCQl9IGVsc2Ugew0KCQkJU3RhdEV2ZW50KCJOb3RoaW5nIHRvIGRvLiIpOw0KCQl9DQoJCQkJDQoJfQ0KDQoJZnVuY3Rpb24gZG9EZXZlbG9wZXJHcmFudCgpIGludGVybmFsDQoJew0KCQlpZiAoIWRldmVsb3BlcnNHcmFudGVkKSB7DQoJCQlkZXZlbG9wZXJzR3JhbnRlZCA9IHRydWU7DQoJCQludW1EZXZUb2tlbnMgPSB0b3RhbFRva2Vuc01pbnRlZC8xMDsNCgkJCXRvdGFsVG9rZW5zTWludGVkICs9IG51bURldlRva2VuczsNCgkJCWlmICghaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10uYWxsb2NlZCkgDQoJCQkJYWRkQWNjb3VudChkZXZlbG9wZXJzKTsNCgkJCXVpbnQgbmV3SGVsZCA9IGdldEhlbGQoaG9sZGVyQWNjb3VudHNbZGV2ZWxvcGVyc10udG9rZW5zKSArIG51bURldlRva2VuczsNCgkJCWhvbGRlckFjY291bnRzW2RldmVsb3BlcnNdLnRva2VucyA9IG5ld0hlbGQgfCAgKGN1clBheW91dElkICogKDIgKiogNDgpKTsNCg0KCQl9DQoJfQ0KDQoNCn0='