base 64 content
base64etherCheque
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLy8gY29weXJpZ2h0IGNvbnRhY3RAZXRoZXJjaGVxdWUuY29tDQoNCmNvbnRyYWN0IEV0aGVyQ2hlcXVlIHsNCiAgICBlbnVtIFN0YXR1cyB7IE5PTkUsIENSRUFURUQsIExPQ0tFRCwgRVhQSVJFRCwgVVNFRH0NCiAgICBlbnVtIFJlc3VsdENvZGUgeyANCiAgICAgICAgU1VDQ0VTUywNCiAgICAgICAgRVJST1JfTUFYLA0KICAgICAgICBFUlJPUl9NSU4sDQogICAgICAgIEVSUk9SX0VYSVNULA0KICAgICAgICBFUlJPUl9OT1RfRVhJU1QsDQogICAgICAgIEVSUk9SX0lOVkFMSURfU1RBVFVTLA0KICAgICAgICBFUlJPUl9MT0NLRUQsDQogICAgICAgIEVSUk9SX0VYUElSRUQsDQogICAgICAgIEVSUk9SX0lOVkFMSURfQU1PVU5ULA0KICAgICAgICBFUlJPUl9VU0VEDQogICAgfQ0KICAgIHN0cnVjdCBDaGVxdWUgew0KICAgICAgICBieXRlczMyIHBpbkhhc2g7IC8vIHdlIG9ubHkgc2F2ZSBzaGEzIG9mIGNoZXF1ZSBzaWduYXR1cmUNCiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOw0KICAgICAgICBTdGF0dXMgc3RhdHVzOw0KICAgICAgICB1aW50IHZhbHVlOw0KICAgICAgICB1aW50IGNyZWF0ZVRpbWU7DQogICAgICAgIHVpbnQgZXhwaXJpbmdQZXJpb2Q7IC8vIGluIHNlY29uZHMgLSBvcHRpb25hbCwgMCBtZWFuIG5vIGV4cGlyZQ0KICAgICAgICB1aW50OCBhdHRlbXB0OyAvLyBjdXJyZW50IGF0dGVtcHQgYWNjb3VudCB0byBjYXNoIHRoZSBjaGVxdWUNCiAgICB9DQogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQogICAgYWRkcmVzc1tdIHB1YmxpYyBtb2RlcmF0b3JzOw0KICAgIHVpbnQgcHVibGljIHRvdGFsQ2hlcXVlID0gMDsNCiAgICB1aW50IHB1YmxpYyB0b3RhbENoZXF1ZVZhbHVlID0gMDsNCiAgICB1aW50IHB1YmxpYyB0b3RhbFJlZGVlbWVkQ2hlcXVlID0gMDsNCiAgICB1aW50IHB1YmxpYyB0b3RhbFJlZGVlbWVkVmFsdWUgPSAwOw0KICAgIHVpbnQgcHVibGljIGNvbW1pc3Npb25SYXRlID0gMTA7IC8vIGRpdiAxMDAwDQogICAgdWludCBwdWJsaWMgbWluRmVlID0gMC4wMDUgZXRoZXI7DQogICAgdWludCBwdWJsaWMgbWluQ2hlcXVlVmFsdWUgPSAwLjAxIGV0aGVyOw0KICAgIHVpbnQgcHVibGljIG1heENoZXF1ZVZhbHVlID0gMDsgLy8gb3B0aW9uYWwsIDAgbWVhbiBubyBsaW1pdA0KICAgIHVpbnQ4IHB1YmxpYyBtYXhBdHRlbXB0ID0gMzsNCiAgICBib29sIHB1YmxpYyBpc01haW50YWluaW5nID0gZmFsc2U7DQogICAgDQogICAgLy8gaGFzaCBjaGVxdWUgbm8gLT4gQ2hlcXVlIGluZm8NCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gQ2hlcXVlKSBpdGVtczsNCg0KICAgIC8vIG1vZGlmaWVyDQogICAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOw0KICAgICAgICBfOw0KICAgIH0NCiAgICANCiAgICBtb2RpZmllciBpc0FjdGl2ZSB7DQogICAgICAgIGlmKGlzTWFpbnRhaW5pbmcgPT0gdHJ1ZSkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KICAgIA0KICAgIG1vZGlmaWVyIG9ubHlNb2RlcmF0b3JzKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgew0KICAgICAgICAgICAgYm9vbCBmb3VuZCA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yICh1aW50IGluZGV4ID0gMDsgaW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aDsgaW5kZXgrKykgew0KICAgICAgICAgICAgICAgIGlmIChtb2RlcmF0b3JzW2luZGV4XSA9PSBtc2cuc2VuZGVyKSB7DQogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFmb3VuZCkgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gRXRoZXJDaGVxdWUoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICAvLyBldmVudA0KICAgIGV2ZW50IExvZ0NyZWF0ZShieXRlczMyIGluZGV4ZWQgY2hlcXVlSWRIYXNoLCB1aW50IHJlc3VsdCwgdWludCBhbW91bnQpOw0KICAgIGV2ZW50IExvZ1JlZGVlbShieXRlczMyIGluZGV4ZWQgY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlIHJlc3VsdCwgdWludCBhbW91bnQsIGFkZHJlc3MgcmVjZWl2ZXIpOw0KICAgIGV2ZW50IExvZ1dpdGhkcmF3RXRoZXIoYWRkcmVzcyBpbmRleGVkIHNlbmRUbywgUmVzdWx0Q29kZSByZXN1bHQsIHVpbnQgYW1vdW50KTsNCiAgICBldmVudCBMb2dSZWZ1bmRDaGVxdWUoYnl0ZXMzMiBpbmRleGVkIGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZSByZXN1bHQpOw0KICAgIA0KICAgIC8vIG93bmVyIGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gQ2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgICAgIG93bmVyID0gX25ld093bmVyOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBLaWxsKCkgb25seU93bmVyIHsNCiAgICAgICAgc3VpY2lkZShvd25lcik7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIEFkZE1vZGVyYXRvcihhZGRyZXNzIF9uZXdNb2RlcmF0b3IpIG9ubHlPd25lciB7DQogICAgICAgIGZvciAodWludCBpbmRleCA9IDA7IGluZGV4IDwgbW9kZXJhdG9ycy5sZW5ndGg7IGluZGV4KyspIHsNCiAgICAgICAgICAgIGlmIChtb2RlcmF0b3JzW2luZGV4XSA9PSBfbmV3TW9kZXJhdG9yKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIG1vZGVyYXRvcnMucHVzaChfbmV3TW9kZXJhdG9yKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gUmVtb3ZlTW9kZXJhdG9yKGFkZHJlc3MgX29sZE1vZGVyYXRvcikgb25seU93bmVyIHsNCiAgICAgICAgdWludCBmb3VuZEluZGV4ID0gMDsNCiAgICAgICAgZm9yICg7IGZvdW5kSW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aDsgZm91bmRJbmRleCsrKSB7DQogICAgICAgICAgICBpZiAobW9kZXJhdG9yc1tmb3VuZEluZGV4XSA9PSBfb2xkTW9kZXJhdG9yKSB7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGZvdW5kSW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aCkNCiAgICAgICAgew0KICAgICAgICAgICAgbW9kZXJhdG9yc1tmb3VuZEluZGV4XSA9IG1vZGVyYXRvcnNbbW9kZXJhdG9ycy5sZW5ndGgtMV07DQogICAgICAgICAgICBkZWxldGUgbW9kZXJhdG9yc1ttb2RlcmF0b3JzLmxlbmd0aC0xXTsNCiAgICAgICAgICAgIG1vZGVyYXRvcnMubGVuZ3RoLS07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gbW9kZXJhdG9yIGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gU2V0Q29tbWlzc2lvblJhdGUodWludCBfY29tbWlzc2lvblJhdGUpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgY29tbWlzc2lvblJhdGUgPSBfY29tbWlzc2lvblJhdGU7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFNldE1pbkZlZSh1aW50IF9taW5GZWUpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgbWluRmVlID0gX21pbkZlZTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gU2V0TWluQ2hlcXVlVmFsdWUodWludCBfbWluQ2hlcXVlVmFsdWUpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgbWluQ2hlcXVlVmFsdWUgPSBfbWluQ2hlcXVlVmFsdWU7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFNldE1heENoZXF1ZVZhbHVlKHVpbnQgX21heENoZXF1ZVZhbHVlKSBvbmx5TW9kZXJhdG9ycyB7DQogICAgICAgIG1heENoZXF1ZVZhbHVlID0gX21heENoZXF1ZVZhbHVlOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBTZXRNYXhBdHRlbXB0KHVpbnQ4IF9tYXhBdHRlbXB0KSBvbmx5TW9kZXJhdG9ycyB7DQogICAgICAgIG1heEF0dGVtcHQgPSBfbWF4QXR0ZW1wdDsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gVXBkYXRlTWFpbnRlbmFuY2UoYm9vbCBfaXNNYWludGFpbmluZykgb25seU1vZGVyYXRvcnMgew0KICAgICAgICBpc01haW50YWluaW5nID0gX2lzTWFpbnRhaW5pbmc7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFdpdGhkcmF3RXRoZXIoYWRkcmVzcyBfc2VuZFRvLCB1aW50IF9hbW91bnQpIG9ubHlNb2RlcmF0b3JzIHJldHVybnMoUmVzdWx0Q29kZSkgew0KICAgICAgICAvLyBjYW4gb25seSBjYW4gd2l0aGRyYXcgcHJvZml0IC0gdW5hYmxlIHRvIHdpdGhkcmF3IGNoZXF1ZSB2YWx1ZQ0KICAgICAgICB1aW50IGN1cnJlbnRQcm9maXQgPSB0aGlzLmJhbGFuY2UgLSAodG90YWxDaGVxdWVWYWx1ZSAtIHRvdGFsUmVkZWVtZWRWYWx1ZSk7DQogICAgICAgIGlmIChfYW1vdW50ID4gY3VycmVudFByb2ZpdCkgew0KICAgICAgICAgICAgTG9nV2l0aGRyYXdFdGhlcihfc2VuZFRvLCBSZXN1bHRDb2RlLkVSUk9SX0lOVkFMSURfQU1PVU5ULCAwKTsNCiAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX0lOVkFMSURfQU1PVU5UOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBfc2VuZFRvLnRyYW5zZmVyKF9hbW91bnQpOw0KICAgICAgICBMb2dXaXRoZHJhd0V0aGVyKF9zZW5kVG8sIFJlc3VsdENvZGUuU1VDQ0VTUywgX2Ftb3VudCk7DQogICAgICAgIHJldHVybiBSZXN1bHRDb2RlLlNVQ0NFU1M7DQogICAgfQ0KICAgIA0KICAgIC8vIG9ubHkgd2hlbiBjcmVhdG9yIHdhbnRzIHRvIGdldCB0aGUgbW9uZXkgYmFjaw0KICAgIC8vIG9ubHkgY2FuIHJlZnVuZCBiYWNrIHRvIGNyZWF0b3INCiAgICBmdW5jdGlvbiBSZWZ1bmRDaGVxdWVCeUlkKHN0cmluZyBfY2hlcXVlSWQpIG9ubHlNb2RlcmF0b3JzIHJldHVybnMoUmVzdWx0Q29kZSkgew0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IHNoYTMoX2NoZXF1ZUlkKTsNCiAgICAgICAgQ2hlcXVlIGNoZXF1ZSA9IGl0ZW1zW2NoZXF1ZUlkSGFzaF07DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5OT05FKSB7DQogICAgICAgICAgICBMb2dSZWZ1bmRDaGVxdWUoY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVCk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9OT1RfRVhJU1Q7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLlVTRUQpIHsNCiAgICAgICAgICAgIExvZ1JlZnVuZENoZXF1ZShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuRVJST1JfVVNFRCk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9VU0VEOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICB0b3RhbFJlZGVlbWVkQ2hlcXVlICs9IDE7DQogICAgICAgIHRvdGFsUmVkZWVtZWRWYWx1ZSArPSBjaGVxdWUudmFsdWU7DQogICAgICAgIHVpbnQgc2VuZEFtb3VudCA9IGNoZXF1ZS52YWx1ZTsNCiAgICAgICAgDQogICAgICAgIGNoZXF1ZS5zdGF0dXMgPSBTdGF0dXMuVVNFRDsNCiAgICAgICAgY2hlcXVlLnZhbHVlID0gMDsNCiAgICAgICAgDQogICAgICAgIGNoZXF1ZS5jcmVhdG9yLnRyYW5zZmVyKHNlbmRBbW91bnQpOw0KICAgICAgICBMb2dSZWZ1bmRDaGVxdWUoY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLlNVQ0NFU1MpOw0KICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5TVUNDRVNTOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFJlZnVuZENoZXF1ZUJ5SGFzaCh1aW50MjU2IF9jaGVxdWVJZEhhc2gpIG9ubHlNb2RlcmF0b3JzIHJldHVybnMoUmVzdWx0Q29kZSkgew0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IGJ5dGVzMzIoX2NoZXF1ZUlkSGFzaCk7DQogICAgICAgIENoZXF1ZSBjaGVxdWUgPSBpdGVtc1tjaGVxdWVJZEhhc2hdOw0KICAgICAgICBpZiAoY2hlcXVlLnN0YXR1cyA9PSBTdGF0dXMuTk9ORSkgew0KICAgICAgICAgICAgTG9nUmVmdW5kQ2hlcXVlKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5FUlJPUl9OT1RfRVhJU1QpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfTk9UX0VYSVNUOw0KICAgICAgICB9DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5VU0VEKSB7DQogICAgICAgICAgICBMb2dSZWZ1bmRDaGVxdWUoY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLkVSUk9SX1VTRUQpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfVVNFRDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdG90YWxSZWRlZW1lZENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbFJlZGVlbWVkVmFsdWUgKz0gY2hlcXVlLnZhbHVlOw0KICAgICAgICB1aW50IHNlbmRBbW91bnQgPSBjaGVxdWUudmFsdWU7DQogICAgICAgIA0KICAgICAgICBjaGVxdWUuc3RhdHVzID0gU3RhdHVzLlVTRUQ7DQogICAgICAgIGNoZXF1ZS52YWx1ZSA9IDA7DQogICAgICAgIA0KICAgICAgICBjaGVxdWUuY3JlYXRvci50cmFuc2ZlcihzZW5kQW1vdW50KTsNCiAgICAgICAgTG9nUmVmdW5kQ2hlcXVlKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5TVUNDRVNTKTsNCiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBHZXRDaGVxdWVJbmZvQnlIYXNoKHVpbnQyNTYgX2NoZXF1ZUlkSGFzaCkgb25seU1vZGVyYXRvcnMgY29uc3RhbnQgcmV0dXJucyhTdGF0dXMsIHVpbnQsIHVpbnQsIHVpbnQpIHsNCiAgICAgICAgYnl0ZXMzMiBjaGVxdWVJZEhhc2ggPSBieXRlczMyKF9jaGVxdWVJZEhhc2gpOw0KICAgICAgICBDaGVxdWUgY2hlcXVlID0gaXRlbXNbY2hlcXVlSWRIYXNoXTsNCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLk5PTkUpIA0KICAgICAgICAgICAgcmV0dXJuIChTdGF0dXMuTk9ORSwgMCwgMCwgMCk7DQoNCiAgICAgICAgaWYgKGNoZXF1ZS5leHBpcmluZ1BlcmlvZCA+IDApIHsNCiAgICAgICAgICAgIHVpbnQgdGltZUdhcCA9IG5vdzsNCiAgICAgICAgICAgIGlmICh0aW1lR2FwID4gY2hlcXVlLmNyZWF0ZVRpbWUpDQogICAgICAgICAgICAgICAgdGltZUdhcCA9IHRpbWVHYXAgLSBjaGVxdWUuY3JlYXRlVGltZTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB0aW1lR2FwID0gMDsNCg0KICAgICAgICAgICAgaWYgKGNoZXF1ZS5leHBpcmluZ1BlcmlvZCA+IHRpbWVHYXApDQogICAgICAgICAgICAgICAgcmV0dXJuIChjaGVxdWUuc3RhdHVzLCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCBjaGVxdWUuZXhwaXJpbmdQZXJpb2QgLSB0aW1lR2FwKTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICByZXR1cm4gKFN0YXR1cy5FWFBJUkVELCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCAwKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKGNoZXF1ZS5zdGF0dXMsIGNoZXF1ZS52YWx1ZSwgY2hlcXVlLmF0dGVtcHQsIDApOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFZlcmlmeUNoZXF1ZShzdHJpbmcgX2NoZXF1ZUlkLCBzdHJpbmcgX3Bpbikgb25seU1vZGVyYXRvcnMgY29uc3RhbnQgcmV0dXJucyhSZXN1bHRDb2RlLCBTdGF0dXMsIHVpbnQsIHVpbnQsIHVpbnQpIHsNCiAgICAgICAgYnl0ZXMzMiBjaGVxdWVJZEhhc2ggPSBzaGEzKF9jaGVxdWVJZCk7DQogICAgICAgIENoZXF1ZSBjaGVxdWUgPSBpdGVtc1tjaGVxdWVJZEhhc2hdOw0KICAgICAgICBpZiAoY2hlcXVlLnN0YXR1cyA9PSBTdGF0dXMuTk9ORSkgew0KICAgICAgICAgICAgcmV0dXJuIChSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVCwgU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KICAgICAgICB9DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5VU0VEKSB7DQogICAgICAgICAgICByZXR1cm4gKFJlc3VsdENvZGUuRVJST1JfVVNFRCwgU3RhdHVzLlVTRUQsIDAsIDAsIDApOw0KICAgICAgICB9DQogICAgICAgIGlmIChjaGVxdWUucGluSGFzaCAhPSBzaGEzKF9jaGVxdWVJZCwgX3BpbikpIHsNCiAgICAgICAgICAgIHJldHVybiAoUmVzdWx0Q29kZS5FUlJPUl9JTlZBTElEX1NUQVRVUywgU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gKFJlc3VsdENvZGUuU1VDQ0VTUywgY2hlcXVlLnN0YXR1cywgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgMCk7DQogICAgfQ0KICAgIA0KICAgIC8vIGNvbnN0YW50IGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gR2V0Q2hlcXVlSW5mbyhzdHJpbmcgX2NoZXF1ZUlkKSBjb25zdGFudCByZXR1cm5zKFN0YXR1cywgdWludCwgdWludCwgdWludCkgew0KICAgICAgICBieXRlczMyIGhhc2hDaGVxdWVJZCA9IHNoYTMoX2NoZXF1ZUlkKTsNCiAgICAgICAgQ2hlcXVlIGNoZXF1ZSA9IGl0ZW1zW2hhc2hDaGVxdWVJZF07DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5OT05FKSANCiAgICAgICAgICAgIHJldHVybiAoU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KDQogICAgICAgIGlmIChjaGVxdWUuZXhwaXJpbmdQZXJpb2QgPiAwKSB7DQogICAgICAgICAgICB1aW50IHRpbWVHYXAgPSBub3c7DQogICAgICAgICAgICBpZiAodGltZUdhcCA+IGNoZXF1ZS5jcmVhdGVUaW1lKQ0KICAgICAgICAgICAgICAgIHRpbWVHYXAgPSB0aW1lR2FwIC0gY2hlcXVlLmNyZWF0ZVRpbWU7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgdGltZUdhcCA9IDA7DQoNCiAgICAgICAgICAgIGlmIChjaGVxdWUuZXhwaXJpbmdQZXJpb2QgPiB0aW1lR2FwKQ0KICAgICAgICAgICAgICAgIHJldHVybiAoY2hlcXVlLnN0YXR1cywgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgY2hlcXVlLmV4cGlyaW5nUGVyaW9kIC0gdGltZUdhcCk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgcmV0dXJuIChTdGF0dXMuRVhQSVJFRCwgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgMCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIChjaGVxdWUuc3RhdHVzLCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCAwKTsNCiAgICB9DQogICAgDQogICAgLy8gdHJhbnNhY3Rpb24NCiAgICBmdW5jdGlvbiBDcmVhdGUodWludDI1NiBfY2hlcXVlSWRIYXNoLCB1aW50MjU2IF9waW5IYXNoLCB1aW50MzIgX2V4cGlyaW5nUGVyaW9kKSBwYXlhYmxlIGlzQWN0aXZlIHJldHVybnMoUmVzdWx0Q29kZSkgew0KICAgICAgICAvLyBjb25kaXRpb246IA0KICAgICAgICAvLyAxLiBjaGVjayBtaW4gdmFsdWUNCiAgICAgICAgLy8gMi4gY2hlY2sgX2NoZXF1ZUlkIGV4aXN0IG9yIG5vdA0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IGJ5dGVzMzIoX2NoZXF1ZUlkSGFzaCk7DQogICAgICAgIGJ5dGVzMzIgcGluSGFzaCA9IGJ5dGVzMzIoX3Bpbkhhc2gpOw0KICAgICAgICB1aW50IGNoZXF1ZVZhbHVlID0gMDsNCiAgICAgICAgDQogICAgICAgIC8vIGRlZHVjdCBjb21taXNzaW9uDQogICAgICAgIHVpbnQgY29tbWlzc2lvbkZlZSA9IChtc2cudmFsdWUgLyAxMDAwKSAqIGNvbW1pc3Npb25SYXRlOw0KICAgICAgICBpZiAoY29tbWlzc2lvbkZlZSA8IG1pbkZlZSkgew0KICAgICAgICAgICAgY29tbWlzc2lvbkZlZSA9IG1pbkZlZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAobXNnLnZhbHVlIDwgY29tbWlzc2lvbkZlZSkgew0KICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUpOw0KICAgICAgICAgICAgTG9nQ3JlYXRlKGNoZXF1ZUlkSGFzaCwgdWludChSZXN1bHRDb2RlLkVSUk9SX0lOVkFMSURfQU1PVU5UKSwgY2hlcXVlVmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9BTU9VTlQ7DQogICAgICAgIH0NCiAgICAgICAgY2hlcXVlVmFsdWUgPSBtc2cudmFsdWUgLSBjb21taXNzaW9uRmVlOw0KICAgICAgICANCiAgICAgICAgaWYgKGNoZXF1ZVZhbHVlIDwgbWluQ2hlcXVlVmFsdWUpIHsNCiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsNCiAgICAgICAgICAgIExvZ0NyZWF0ZShjaGVxdWVJZEhhc2gsIHVpbnQoUmVzdWx0Q29kZS5FUlJPUl9NSU4pLCBjaGVxdWVWYWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9NSU47DQogICAgICAgIH0NCiAgICAgICAgaWYgKG1heENoZXF1ZVZhbHVlID4gMCAmJiBjaGVxdWVWYWx1ZSA+IG1heENoZXF1ZVZhbHVlKSB7DQogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7DQogICAgICAgICAgICBMb2dDcmVhdGUoY2hlcXVlSWRIYXNoLCB1aW50KFJlc3VsdENvZGUuRVJST1JfTUFYKSwgY2hlcXVlVmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfTUFYOw0KICAgICAgICB9DQogICAgICAgIGlmIChpdGVtc1tjaGVxdWVJZEhhc2hdLnN0YXR1cyAhPSBTdGF0dXMuTk9ORSAmJiBpdGVtc1tjaGVxdWVJZEhhc2hdLnN0YXR1cyAhPSBTdGF0dXMuVVNFRCkgew0KICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihtc2cudmFsdWUpOw0KICAgICAgICAgICAgTG9nQ3JlYXRlKGNoZXF1ZUlkSGFzaCwgdWludChSZXN1bHRDb2RlLkVSUk9SX0VYSVNUKSwgY2hlcXVlVmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfRVhJU1Q7DQogICAgICAgIH0NCg0KICAgICAgICB0b3RhbENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbENoZXF1ZVZhbHVlICs9IGNoZXF1ZVZhbHVlOw0KICAgICAgICBpdGVtc1tjaGVxdWVJZEhhc2hdID0gQ2hlcXVlKHsNCiAgICAgICAgICAgIHBpbkhhc2g6IHBpbkhhc2gsDQogICAgICAgICAgICBjcmVhdG9yOiBtc2cuc2VuZGVyLA0KICAgICAgICAgICAgc3RhdHVzOiBTdGF0dXMuQ1JFQVRFRCwNCiAgICAgICAgICAgIHZhbHVlOiBjaGVxdWVWYWx1ZSwNCiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IG5vdywNCiAgICAgICAgICAgIGV4cGlyaW5nUGVyaW9kOiBfZXhwaXJpbmdQZXJpb2QsDQogICAgICAgICAgICBhdHRlbXB0OiAwDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgTG9nQ3JlYXRlKGNoZXF1ZUlkSGFzaCwgdWludChSZXN1bHRDb2RlLlNVQ0NFU1MpLCBjaGVxdWVWYWx1ZSk7DQogICAgICAgIHJldHVybiBSZXN1bHRDb2RlLlNVQ0NFU1M7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFJlZGVlbShzdHJpbmcgX2NoZXF1ZUlkLCBzdHJpbmcgX3BpbiwgYWRkcmVzcyBfc2VuZFRvKSBwYXlhYmxlIHJldHVybnMgKFJlc3VsdENvZGUpew0KICAgICAgICAvLyBjb25kaXRpb24NCiAgICAgICAgLy8gMS4gY2hlcXVlIHN0YXR1cyBtdXN0IGV4aXN0DQogICAgICAgIC8vIDIuIGNoZXF1ZSBzdGF0dXMgbXVzdCBiZSBDUkVBVEVEIHN0YXR1cyBmb3Igbm9uLWNyZWF0b3INCiAgICAgICAgLy8gMy4gdmVyaWZ5IGF0dGVtcHQgYW5kIGV4cGlyeSB0aW1lIGZvciBub24tY3JlYXRvcg0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IHNoYTMoX2NoZXF1ZUlkKTsNCiAgICAgICAgQ2hlcXVlIGNoZXF1ZSA9IGl0ZW1zW2NoZXF1ZUlkSGFzaF07DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5OT05FKSB7DQogICAgICAgICAgICBMb2dSZWRlZW0oY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVCwgMCwgX3NlbmRUbyk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9OT1RfRVhJU1Q7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLlVTRUQpIHsNCiAgICAgICAgICAgIExvZ1JlZGVlbShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuRVJST1JfVVNFRCwgMCwgX3NlbmRUbyk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9VU0VEOw0KICAgICAgICB9DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGNoZXF1ZS5jcmVhdG9yKSB7DQogICAgICAgICAgICBpZiAoY2hlcXVlLnN0YXR1cyAhPSBTdGF0dXMuQ1JFQVRFRCkgew0KICAgICAgICAgICAgICAgIExvZ1JlZGVlbShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9TVEFUVVMsIDAsIF9zZW5kVG8pOw0KICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX0lOVkFMSURfU1RBVFVTOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGNoZXF1ZS5hdHRlbXB0ID4gbWF4QXR0ZW1wdCkgew0KICAgICAgICAgICAgICAgIExvZ1JlZGVlbShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuRVJST1JfTE9DS0VELCAwLCBfc2VuZFRvKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9MT0NLRUQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2hlcXVlLmV4cGlyaW5nUGVyaW9kID4gMCAmJiBub3cgPiAoY2hlcXVlLmNyZWF0ZVRpbWUgKyBjaGVxdWUuZXhwaXJpbmdQZXJpb2QpKSB7DQogICAgICAgICAgICAgICAgTG9nUmVkZWVtKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5FUlJPUl9FWFBJUkVELCAwLCBfc2VuZFRvKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9FWFBJUkVEOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBjaGVjayBwaW4NCiAgICAgICAgaWYgKGNoZXF1ZS5waW5IYXNoICE9IHNoYTMoX2NoZXF1ZUlkLCBfcGluKSkgew0KICAgICAgICAgICAgY2hlcXVlLmF0dGVtcHQgKz0gMTsNCiAgICAgICAgICAgIExvZ1JlZGVlbShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9TVEFUVVMsIDAsIF9zZW5kVG8pOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9TVEFUVVM7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHRvdGFsUmVkZWVtZWRDaGVxdWUgKz0gMTsNCiAgICAgICAgdG90YWxSZWRlZW1lZFZhbHVlICs9IGNoZXF1ZS52YWx1ZTsNCiAgICAgICAgdWludCBzZW5kTW91bnQgPSBjaGVxdWUudmFsdWU7DQogICAgICAgIA0KICAgICAgICBjaGVxdWUuc3RhdHVzID0gU3RhdHVzLlVTRUQ7DQogICAgICAgIGNoZXF1ZS52YWx1ZSA9IDA7DQogICAgICAgIA0KICAgICAgICBfc2VuZFRvLnRyYW5zZmVyKHNlbmRNb3VudCk7DQogICAgICAgIExvZ1JlZGVlbShjaGVxdWVJZEhhc2gsIFJlc3VsdENvZGUuU1VDQ0VTUywgc2VuZE1vdW50LCBfc2VuZFRvKTsNCiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsNCiAgICB9DQoNCn0='