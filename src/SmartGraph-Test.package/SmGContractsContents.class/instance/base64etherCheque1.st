base 64 content
base64etherCheque1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLy8gY29weXJpZ2h0IGNvbnRhY3RAZXRoZXJjaGVxdWUuY29tDQoNCmNvbnRyYWN0IEV0aGVyQ2hlcXVlIHsNCiAgICBlbnVtIFN0YXR1cyB7IE5PTkUsIENSRUFURUQsIExPQ0tFRCwgRVhQSVJFRCB9DQogICAgZW51bSBSZXN1bHRDb2RlIHsgDQogICAgICAgIFNVQ0NFU1MsDQogICAgICAgIEVSUk9SX01BWCwNCiAgICAgICAgRVJST1JfTUlOLA0KICAgICAgICBFUlJPUl9FWElTVCwNCiAgICAgICAgRVJST1JfTk9UX0VYSVNULA0KICAgICAgICBFUlJPUl9JTlZBTElEX1NUQVRVUywNCiAgICAgICAgRVJST1JfTE9DS0VELA0KICAgICAgICBFUlJPUl9FWFBJUkVELA0KICAgICAgICBFUlJPUl9JTlZBTElEX0FNT1VOVA0KICAgIH0NCiAgICBzdHJ1Y3QgQ2hlcXVlIHsNCiAgICAgICAgYnl0ZXMzMiBwaW5IYXNoOyAvLyB3ZSBvbmx5IHNhdmUgc2hhMyBvZiBjaGVxdWUgc2lnbmF0dXJlDQogICAgICAgIGFkZHJlc3MgY3JlYXRvcjsNCiAgICAgICAgU3RhdHVzIHN0YXR1czsNCiAgICAgICAgdWludCB2YWx1ZTsNCiAgICAgICAgdWludCBjcmVhdGVUaW1lOw0KICAgICAgICB1aW50IGV4cGlyaW5nUGVyaW9kOyAvLyBpbiBzZWNvbmRzIC0gb3B0aW9uYWwsIDAgbWVhbiBubyBleHBpcmUNCiAgICAgICAgdWludDggYXR0ZW1wdDsgLy8gY3VycmVudCBhdHRlbXB0IGFjY291bnQgdG8gY2FzaCB0aGUgY2hlcXVlDQogICAgfQ0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIGFkZHJlc3NbXSBwdWJsaWMgbW9kZXJhdG9yczsNCiAgICB1aW50IHB1YmxpYyB0b3RhbENoZXF1ZSA9IDA7DQogICAgdWludCBwdWJsaWMgdG90YWxDaGVxdWVWYWx1ZSA9IDA7DQogICAgdWludCBwdWJsaWMgdG90YWxSZWRlZW1lZENoZXF1ZSA9IDA7DQogICAgdWludCBwdWJsaWMgdG90YWxSZWRlZW1lZFZhbHVlID0gMDsNCiAgICB1aW50IHB1YmxpYyBjb21taXNzaW9uRmVlID0gMTA7IC8vIGRpdiAxMDAwDQogICAgdWludCBwdWJsaWMgbWluQ2hlcXVlVmFsdWUgPSAwLjAxIGV0aGVyOw0KICAgIHVpbnQgcHVibGljIG1heENoZXF1ZVZhbHVlID0gMDsgLy8gb3B0aW9uYWwsIDAgbWVhbiBubyBsaW1pdA0KICAgIHVpbnQ4IHB1YmxpYyBtYXhBdHRlbXB0ID0gMzsNCiAgICBib29sIHB1YmxpYyBpc01haW50YWluaW5nID0gZmFsc2U7DQogICAgDQogICAgLy8gaGFzaCBjaGVxdWUgbm8gLT4gQ2hlcXVlIGluZm8NCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gQ2hlcXVlKSBpdGVtczsNCg0KICAgIC8vIG1vZGlmaWVyDQogICAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gb3duZXIpOw0KICAgICAgICBfOw0KICAgIH0NCiAgICANCiAgICBtb2RpZmllciBpc0FjdGl2ZSB7DQogICAgICAgIGlmKGlzTWFpbnRhaW5pbmcgPT0gdHJ1ZSkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KICAgIA0KICAgIG1vZGlmaWVyIG9ubHlNb2RlcmF0b3JzKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgew0KICAgICAgICAgICAgYm9vbCBmb3VuZCA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yICh1aW50IGluZGV4ID0gMDsgaW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aDsgaW5kZXgrKykgew0KICAgICAgICAgICAgICAgIGlmIChtb2RlcmF0b3JzW2luZGV4XSA9PSBtc2cuc2VuZGVyKSB7DQogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFmb3VuZCkgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gRXRoZXJDaGVxdWUoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICAvLyBldmVudA0KICAgIGV2ZW50IExvZ0NyZWF0ZShieXRlczMyIGluZGV4ZWQgY2hlcXVlSWRIYXNoLCB1aW50IHJlc3VsdCwgdWludCBhbW91bnQpOw0KICAgIGV2ZW50IExvZ1JlZGVlbShieXRlczMyIGluZGV4ZWQgY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlIHJlc3VsdCwgdWludCBhbW91bnQsIGFkZHJlc3MgcmVjZWl2ZXIpOw0KICAgIGV2ZW50IExvZ1dpdGhkcmF3RXRoZXIoYWRkcmVzcyBpbmRleGVkIHNlbmRUbywgUmVzdWx0Q29kZSByZXN1bHQsIHVpbnQgYW1vdW50KTsNCiAgICBldmVudCBMb2dSZWZ1bmRDaGVxdWUoYnl0ZXMzMiBpbmRleGVkIGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZSByZXN1bHQpOw0KICAgIA0KICAgIC8vIG93bmVyIGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gQ2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgICAgIG93bmVyID0gX25ld093bmVyOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBLaWxsKCkgb25seU93bmVyIHsNCiAgICAgICAgc3VpY2lkZShvd25lcik7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIEFkZE1vZGVyYXRvcihhZGRyZXNzIF9uZXdNb2RlcmF0b3IpIG9ubHlPd25lciB7DQogICAgICAgIGZvciAodWludCBpbmRleCA9IDA7IGluZGV4IDwgbW9kZXJhdG9ycy5sZW5ndGg7IGluZGV4KyspIHsNCiAgICAgICAgICAgIGlmIChtb2RlcmF0b3JzW2luZGV4XSA9PSBfbmV3TW9kZXJhdG9yKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIG1vZGVyYXRvcnMucHVzaChfbmV3TW9kZXJhdG9yKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gUmVtb3ZlTW9kZXJhdG9yKGFkZHJlc3MgX29sZE1vZGVyYXRvcikgb25seU93bmVyIHsNCiAgICAgICAgdWludCBmb3VuZEluZGV4ID0gMDsNCiAgICAgICAgZm9yICg7IGZvdW5kSW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aDsgZm91bmRJbmRleCsrKSB7DQogICAgICAgICAgICBpZiAobW9kZXJhdG9yc1tmb3VuZEluZGV4XSA9PSBfb2xkTW9kZXJhdG9yKSB7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGZvdW5kSW5kZXggPCBtb2RlcmF0b3JzLmxlbmd0aCkNCiAgICAgICAgew0KICAgICAgICAgICAgbW9kZXJhdG9yc1tmb3VuZEluZGV4XSA9IG1vZGVyYXRvcnNbbW9kZXJhdG9ycy5sZW5ndGgtMV07DQogICAgICAgICAgICBkZWxldGUgbW9kZXJhdG9yc1ttb2RlcmF0b3JzLmxlbmd0aC0xXTsNCiAgICAgICAgICAgIG1vZGVyYXRvcnMubGVuZ3RoLS07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gbW9kZXJhdG9yIGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gU2V0Q29tbWlzc2lvblZhbHVlKHVpbnQgX2NvbW1pc3Npb25GZWUpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgY29tbWlzc2lvbkZlZSA9IF9jb21taXNzaW9uRmVlOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBTZXRNaW5DaGVxdWVWYWx1ZSh1aW50IF9taW5DaGVxdWVWYWx1ZSkgb25seU1vZGVyYXRvcnMgew0KICAgICAgICBtaW5DaGVxdWVWYWx1ZSA9IF9taW5DaGVxdWVWYWx1ZTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gU2V0TWF4Q2hlcXVlVmFsdWUodWludCBfbWF4Q2hlcXVlVmFsdWUpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgbWF4Q2hlcXVlVmFsdWUgPSBfbWF4Q2hlcXVlVmFsdWU7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFNldE1heEF0dGVtcHQodWludDggX21heEF0dGVtcHQpIG9ubHlNb2RlcmF0b3JzIHsNCiAgICAgICAgbWF4QXR0ZW1wdCA9IF9tYXhBdHRlbXB0Ow0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBVcGRhdGVNYWludGVuYW5jZShib29sIF9pc01haW50YWluaW5nKSBvbmx5TW9kZXJhdG9ycyB7DQogICAgICAgIGlzTWFpbnRhaW5pbmcgPSBfaXNNYWludGFpbmluZzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gV2l0aGRyYXdFdGhlcihhZGRyZXNzIF9zZW5kVG8sIHVpbnQgX2Ftb3VudCkgb25seU1vZGVyYXRvcnMgcmV0dXJucyhSZXN1bHRDb2RlKSB7DQogICAgICAgIC8vIGNhbiBvbmx5IGNhbiB3aXRoZHJhdyBwcm9maXQgLSB1bmFibGUgdG8gd2l0aGRyYXcgY2hlcXVlIHZhbHVlDQogICAgICAgIHVpbnQgY3VycmVudFByb2ZpdCA9IHRoaXMuYmFsYW5jZSAtICh0b3RhbENoZXF1ZVZhbHVlIC0gdG90YWxSZWRlZW1lZFZhbHVlKTsNCiAgICAgICAgaWYgKF9hbW91bnQgPiBjdXJyZW50UHJvZml0KSB7DQogICAgICAgICAgICBMb2dXaXRoZHJhd0V0aGVyKF9zZW5kVG8sIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9BTU9VTlQsIDApOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9BTU9VTlQ7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIF9zZW5kVG8udHJhbnNmZXIoX2Ftb3VudCk7DQogICAgICAgIExvZ1dpdGhkcmF3RXRoZXIoX3NlbmRUbywgUmVzdWx0Q29kZS5TVUNDRVNTLCBfYW1vdW50KTsNCiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsNCiAgICB9DQogICAgDQogICAgLy8gb25seSB3aGVuIGNyZWF0b3Igd2FudHMgdG8gZ2V0IHRoZSBtb25leSBiYWNrDQogICAgLy8gb25seSBjYW4gcmVmdW5kIGJhY2sgdG8gY3JlYXRvcg0KICAgIGZ1bmN0aW9uIFJlZnVuZENoZXF1ZUJ5SWQoc3RyaW5nIF9jaGVxdWVJZCkgb25seU1vZGVyYXRvcnMgcmV0dXJucyhSZXN1bHRDb2RlKSB7DQogICAgICAgIGJ5dGVzMzIgaGFzaENoZXF1ZUlkID0gc2hhMyhfY2hlcXVlSWQpOw0KICAgICAgICBDaGVxdWUgY2hlcXVlID0gaXRlbXNbaGFzaENoZXF1ZUlkXTsNCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLk5PTkUpIHsNCiAgICAgICAgICAgIExvZ1JlZnVuZENoZXF1ZShoYXNoQ2hlcXVlSWQsIFJlc3VsdENvZGUuRVJST1JfTk9UX0VYSVNUKTsNCiAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdG90YWxSZWRlZW1lZENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbFJlZGVlbWVkVmFsdWUgKz0gY2hlcXVlLnZhbHVlOw0KICAgICAgICB1aW50IHNlbmRBbW91bnQgPSBjaGVxdWUudmFsdWU7DQogICAgICAgIGRlbGV0ZSBpdGVtc1toYXNoQ2hlcXVlSWRdOw0KICAgICAgICBjaGVxdWUuY3JlYXRvci50cmFuc2ZlcihzZW5kQW1vdW50KTsNCiAgICAgICAgTG9nUmVmdW5kQ2hlcXVlKGhhc2hDaGVxdWVJZCwgUmVzdWx0Q29kZS5TVUNDRVNTKTsNCiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSZWZ1bmRDaGVxdWVCeUhhc2godWludDI1NiBfY2hlcXVlSWRIYXNoKSBvbmx5TW9kZXJhdG9ycyByZXR1cm5zKFJlc3VsdENvZGUpIHsNCiAgICAgICAgYnl0ZXMzMiBoYXNoQ2hlcXVlSWQgPSBieXRlczMyKF9jaGVxdWVJZEhhc2gpOw0KICAgICAgICBDaGVxdWUgY2hlcXVlID0gaXRlbXNbaGFzaENoZXF1ZUlkXTsNCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLk5PTkUpIHsNCiAgICAgICAgICAgIExvZ1JlZnVuZENoZXF1ZShoYXNoQ2hlcXVlSWQsIFJlc3VsdENvZGUuRVJST1JfTk9UX0VYSVNUKTsNCiAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdG90YWxSZWRlZW1lZENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbFJlZGVlbWVkVmFsdWUgKz0gY2hlcXVlLnZhbHVlOw0KICAgICAgICB1aW50IHNlbmRBbW91bnQgPSBjaGVxdWUudmFsdWU7DQogICAgICAgIGRlbGV0ZSBpdGVtc1toYXNoQ2hlcXVlSWRdOw0KICAgICAgICBjaGVxdWUuY3JlYXRvci50cmFuc2ZlcihzZW5kQW1vdW50KTsNCiAgICAgICAgTG9nUmVmdW5kQ2hlcXVlKGhhc2hDaGVxdWVJZCwgUmVzdWx0Q29kZS5TVUNDRVNTKTsNCiAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuU1VDQ0VTUzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBHZXRDaGVxdWVJbmZvQnlIYXNoKHVpbnQyNTYgX2NoZXF1ZUlkSGFzaCkgb25seU1vZGVyYXRvcnMgY29uc3RhbnQgcmV0dXJucyhTdGF0dXMsIHVpbnQsIHVpbnQsIHVpbnQpIHsNCiAgICAgICAgYnl0ZXMzMiBoYXNoQ2hlcXVlSWQgPSBieXRlczMyKF9jaGVxdWVJZEhhc2gpOw0KICAgICAgICBDaGVxdWUgY2hlcXVlID0gaXRlbXNbaGFzaENoZXF1ZUlkXTsNCiAgICAgICAgaWYgKGNoZXF1ZS5zdGF0dXMgPT0gU3RhdHVzLk5PTkUpIA0KICAgICAgICAgICAgcmV0dXJuIChTdGF0dXMuTk9ORSwgMCwgMCwgMCk7DQoNCiAgICAgICAgaWYgKGNoZXF1ZS5leHBpcmluZ1BlcmlvZCA+IDApIHsNCiAgICAgICAgICAgIHVpbnQgdGltZUdhcCA9IG5vdzsNCiAgICAgICAgICAgIGlmICh0aW1lR2FwID4gY2hlcXVlLmNyZWF0ZVRpbWUpDQogICAgICAgICAgICAgICAgdGltZUdhcCA9IHRpbWVHYXAgLSBjaGVxdWUuY3JlYXRlVGltZTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB0aW1lR2FwID0gMDsNCg0KICAgICAgICAgICAgaWYgKGNoZXF1ZS5leHBpcmluZ1BlcmlvZCA+IHRpbWVHYXApDQogICAgICAgICAgICAgICAgcmV0dXJuIChjaGVxdWUuc3RhdHVzLCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCBjaGVxdWUuZXhwaXJpbmdQZXJpb2QgLSB0aW1lR2FwKTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICByZXR1cm4gKFN0YXR1cy5FWFBJUkVELCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCAwKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKGNoZXF1ZS5zdGF0dXMsIGNoZXF1ZS52YWx1ZSwgY2hlcXVlLmF0dGVtcHQsIDApOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIFZlcmlmeUNoZXF1ZShzdHJpbmcgX2NoZXF1ZUlkLCBzdHJpbmcgX3Bpbikgb25seU1vZGVyYXRvcnMgY29uc3RhbnQgcmV0dXJucyhSZXN1bHRDb2RlLCBTdGF0dXMsIHVpbnQsIHVpbnQsIHVpbnQpIHsNCiAgICAgICAgYnl0ZXMzMiBjaGVxdWVJZEhhc2ggPSBzaGEzKF9jaGVxdWVJZCk7DQogICAgICAgIENoZXF1ZSBjaGVxdWUgPSBpdGVtc1tjaGVxdWVJZEhhc2hdOw0KICAgICAgICBpZiAoY2hlcXVlLnN0YXR1cyA9PSBTdGF0dXMuTk9ORSkgew0KICAgICAgICAgICAgcmV0dXJuIChSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVCwgU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KICAgICAgICB9DQogICAgICAgIGlmIChjaGVxdWUucGluSGFzaCAhPSBzaGEzKF9jaGVxdWVJZCwgX3BpbikpIHsNCiAgICAgICAgICAgIHJldHVybiAoUmVzdWx0Q29kZS5FUlJPUl9JTlZBTElEX1NUQVRVUywgU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gKFJlc3VsdENvZGUuU1VDQ0VTUywgY2hlcXVlLnN0YXR1cywgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgMCk7DQogICAgfQ0KICAgIA0KICAgIC8vIGNvbnN0YW50IGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gR2V0Q2hlcXVlSW5mbyhzdHJpbmcgX2NoZXF1ZUlkKSBjb25zdGFudCByZXR1cm5zKFN0YXR1cywgdWludCwgdWludCwgdWludCkgew0KICAgICAgICBieXRlczMyIGhhc2hDaGVxdWVJZCA9IHNoYTMoX2NoZXF1ZUlkKTsNCiAgICAgICAgQ2hlcXVlIGNoZXF1ZSA9IGl0ZW1zW2hhc2hDaGVxdWVJZF07DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5OT05FKSANCiAgICAgICAgICAgIHJldHVybiAoU3RhdHVzLk5PTkUsIDAsIDAsIDApOw0KDQogICAgICAgIGlmIChjaGVxdWUuZXhwaXJpbmdQZXJpb2QgPiAwKSB7DQogICAgICAgICAgICB1aW50IHRpbWVHYXAgPSBub3c7DQogICAgICAgICAgICBpZiAodGltZUdhcCA+IGNoZXF1ZS5jcmVhdGVUaW1lKQ0KICAgICAgICAgICAgICAgIHRpbWVHYXAgPSB0aW1lR2FwIC0gY2hlcXVlLmNyZWF0ZVRpbWU7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgdGltZUdhcCA9IDA7DQoNCiAgICAgICAgICAgIGlmIChjaGVxdWUuZXhwaXJpbmdQZXJpb2QgPiB0aW1lR2FwKQ0KICAgICAgICAgICAgICAgIHJldHVybiAoY2hlcXVlLnN0YXR1cywgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgY2hlcXVlLmV4cGlyaW5nUGVyaW9kIC0gdGltZUdhcCk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgcmV0dXJuIChTdGF0dXMuRVhQSVJFRCwgY2hlcXVlLnZhbHVlLCBjaGVxdWUuYXR0ZW1wdCwgMCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIChjaGVxdWUuc3RhdHVzLCBjaGVxdWUudmFsdWUsIGNoZXF1ZS5hdHRlbXB0LCAwKTsNCiAgICB9DQogICAgDQogICAgLy8gdHJhbnNhY3Rpb24NCiAgICBmdW5jdGlvbiBDcmVhdGUodWludDI1NiBfY2hlcXVlSWRIYXNoLCB1aW50MjU2IF9waW5IYXNoLCB1aW50MzIgX2V4cGlyaW5nUGVyaW9kKSBwYXlhYmxlIGlzQWN0aXZlIHJldHVybnMoUmVzdWx0Q29kZSkgew0KICAgICAgICAvLyBjb25kaXRpb246IA0KICAgICAgICAvLyAxLiBjaGVjayBtaW4gdmFsdWUNCiAgICAgICAgLy8gMi4gY2hlY2sgX2NoZXF1ZUlkIGV4aXN0IG9yIG5vdA0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IGJ5dGVzMzIoX2NoZXF1ZUlkSGFzaCk7DQogICAgICAgIGJ5dGVzMzIgcGluSGFzaCA9IGJ5dGVzMzIoX3Bpbkhhc2gpOw0KICAgICAgICB1aW50IGNoZXF1ZVZhbHVlID0gMDsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IG1pbkNoZXF1ZVZhbHVlKSB7DQogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7DQogICAgICAgICAgICBMb2dDcmVhdGUoY2hlcXVlSWRIYXNoLCB1aW50KFJlc3VsdENvZGUuRVJST1JfTUlOKSwgY2hlcXVlVmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfTUlOOw0KICAgICAgICB9DQogICAgICAgIGlmIChtYXhDaGVxdWVWYWx1ZSA+IDAgJiYgbXNnLnZhbHVlID4gbWF4Q2hlcXVlVmFsdWUpIHsNCiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIobXNnLnZhbHVlKTsNCiAgICAgICAgICAgIExvZ0NyZWF0ZShjaGVxdWVJZEhhc2gsIHVpbnQoUmVzdWx0Q29kZS5FUlJPUl9NQVgpLCBjaGVxdWVWYWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9NQVg7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGl0ZW1zW2NoZXF1ZUlkSGFzaF0uc3RhdHVzICE9IFN0YXR1cy5OT05FKSB7DQogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKG1zZy52YWx1ZSk7DQogICAgICAgICAgICBMb2dDcmVhdGUoY2hlcXVlSWRIYXNoLCB1aW50KFJlc3VsdENvZGUuRVJST1JfRVhJU1QpLCBjaGVxdWVWYWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9FWElTVDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgLy8gZGVkdWN0IGNvbW1pc3Npb24NCiAgICAgICAgY2hlcXVlVmFsdWUgPSAobXNnLnZhbHVlIC8gMTAwMCkgKiAoMTAwMCAtIGNvbW1pc3Npb25GZWUpOw0KICAgICAgICB0b3RhbENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbENoZXF1ZVZhbHVlICs9IGNoZXF1ZVZhbHVlOw0KICAgICAgICBpdGVtc1tjaGVxdWVJZEhhc2hdID0gQ2hlcXVlKHsNCiAgICAgICAgICAgIHBpbkhhc2g6IHBpbkhhc2gsDQogICAgICAgICAgICBjcmVhdG9yOiBtc2cuc2VuZGVyLA0KICAgICAgICAgICAgc3RhdHVzOiBTdGF0dXMuQ1JFQVRFRCwNCiAgICAgICAgICAgIHZhbHVlOiBjaGVxdWVWYWx1ZSwNCiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IG5vdywNCiAgICAgICAgICAgIGV4cGlyaW5nUGVyaW9kOiBfZXhwaXJpbmdQZXJpb2QsDQogICAgICAgICAgICBhdHRlbXB0OiAwDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgTG9nQ3JlYXRlKGNoZXF1ZUlkSGFzaCwgdWludChSZXN1bHRDb2RlLlNVQ0NFU1MpLCBjaGVxdWVWYWx1ZSk7DQogICAgICAgIHJldHVybiBSZXN1bHRDb2RlLlNVQ0NFU1M7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIFJlZGVlbShzdHJpbmcgX2NoZXF1ZUlkLCBzdHJpbmcgX3BpbiwgYWRkcmVzcyBfc2VuZFRvKSBwYXlhYmxlIHJldHVybnMgKFJlc3VsdENvZGUpew0KICAgICAgICAvLyBjb25kaXRpb24NCiAgICAgICAgLy8gMS4gY2hlcXVlIHN0YXR1cyBtdXN0IGV4aXN0DQogICAgICAgIC8vIDIuIGNoZXF1ZSBzdGF0dXMgbXVzdCBiZSBDUkVBVEVEIHN0YXR1cyBmb3Igbm9uLWNyZWF0b3INCiAgICAgICAgLy8gMy4gdmVyaWZ5IGF0dGVtcHQgYW5kIGV4cGlyeSB0aW1lIGZvciBub24tY3JlYXRvcg0KICAgICAgICBieXRlczMyIGNoZXF1ZUlkSGFzaCA9IHNoYTMoX2NoZXF1ZUlkKTsNCiAgICAgICAgQ2hlcXVlIGNoZXF1ZSA9IGl0ZW1zW2NoZXF1ZUlkSGFzaF07DQogICAgICAgIGlmIChjaGVxdWUuc3RhdHVzID09IFN0YXR1cy5OT05FKSB7DQogICAgICAgICAgICBMb2dSZWRlZW0oY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLkVSUk9SX05PVF9FWElTVCwgMCwgX3NlbmRUbyk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9OT1RfRVhJU1Q7DQogICAgICAgIH0NCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gY2hlcXVlLmNyZWF0b3IpIHsNCiAgICAgICAgICAgIGlmIChjaGVxdWUuc3RhdHVzICE9IFN0YXR1cy5DUkVBVEVEKSB7DQogICAgICAgICAgICAgICAgTG9nUmVkZWVtKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5FUlJPUl9JTlZBTElEX1NUQVRVUywgMCwgX3NlbmRUbyk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFJlc3VsdENvZGUuRVJST1JfSU5WQUxJRF9TVEFUVVM7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2hlcXVlLmF0dGVtcHQgPiBtYXhBdHRlbXB0KSB7DQogICAgICAgICAgICAgICAgTG9nUmVkZWVtKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5FUlJPUl9MT0NLRUQsIDAsIF9zZW5kVG8pOw0KICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX0xPQ0tFRDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjaGVxdWUuZXhwaXJpbmdQZXJpb2QgPiAwICYmIG5vdyA+IChjaGVxdWUuY3JlYXRlVGltZSArIGNoZXF1ZS5leHBpcmluZ1BlcmlvZCkpIHsNCiAgICAgICAgICAgICAgICBMb2dSZWRlZW0oY2hlcXVlSWRIYXNoLCBSZXN1bHRDb2RlLkVSUk9SX0VYUElSRUQsIDAsIF9zZW5kVG8pOw0KICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRDb2RlLkVSUk9SX0VYUElSRUQ7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIGNoZWNrIHBpbg0KICAgICAgICBpZiAoY2hlcXVlLnBpbkhhc2ggIT0gc2hhMyhfY2hlcXVlSWQsIF9waW4pKSB7DQogICAgICAgICAgICBjaGVxdWUuYXR0ZW1wdCArPSAxOw0KICAgICAgICAgICAgTG9nUmVkZWVtKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5FUlJPUl9JTlZBTElEX1NUQVRVUywgMCwgX3NlbmRUbyk7DQogICAgICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5FUlJPUl9JTlZBTElEX1NUQVRVUzsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgdG90YWxSZWRlZW1lZENoZXF1ZSArPSAxOw0KICAgICAgICB0b3RhbFJlZGVlbWVkVmFsdWUgKz0gY2hlcXVlLnZhbHVlOw0KICAgICAgICB1aW50IHNlbmRNb3VudCA9IGNoZXF1ZS52YWx1ZTsNCiAgICAgICAgZGVsZXRlIGl0ZW1zW2NoZXF1ZUlkSGFzaF07DQogICAgICAgIF9zZW5kVG8udHJhbnNmZXIoc2VuZE1vdW50KTsNCiAgICAgICAgTG9nUmVkZWVtKGNoZXF1ZUlkSGFzaCwgUmVzdWx0Q29kZS5TVUNDRVNTLCBzZW5kTW91bnQsIF9zZW5kVG8pOw0KICAgICAgICByZXR1cm4gUmVzdWx0Q29kZS5TVUNDRVNTOw0KICAgIH0NCg0KfQ=='