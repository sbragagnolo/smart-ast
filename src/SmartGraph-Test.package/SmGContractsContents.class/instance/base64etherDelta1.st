base 64 content
base64etherDelta1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4yOw0KDQpjb250cmFjdCBTYWZlTWF0aCB7DQogIGZ1bmN0aW9uIHNhZmVNdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB0aHJvdzsNCiAgfQ0KfQ0KDQpjb250cmFjdCBUb2tlbiB7DQogIC8vLyBAcmV0dXJuIHRvdGFsIGFtb3VudCBvZiB0b2tlbnMNCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHN1cHBseSkge30NCg0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7fQ0KDQogIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmANCiAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VuIHRvIGJlIHRyYW5zZmVycmVkDQogIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30NCg0KICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWANCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZA0KICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7fQ0KDQogIC8vLyBAbm90aWNlIGBtc2cuc2VuZGVyYCBhcHByb3ZlcyBgX2FkZHJgIHRvIHNwZW5kIGBfdmFsdWVgIHRva2Vucw0KICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHdlaSB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgYXBwcm92YWwgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykge30NCg0KICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBvd25pbmcgdG9rZW5zDQogIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogIC8vLyBAcmV0dXJuIEFtb3VudCBvZiByZW1haW5pbmcgdG9rZW5zIGFsbG93ZWQgdG8gc3BlbnQNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykge30NCg0KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQoNCiAgdWludCBwdWJsaWMgZGVjaW1hbHM7DQogIHN0cmluZyBwdWJsaWMgbmFtZTsNCn0NCg0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBUb2tlbiB7DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAvL0RlZmF1bHQgYXNzdW1lcyB0b3RhbFN1cHBseSBjYW4ndCBiZSBvdmVyIG1heCAoMl4yNTYgLSAxKS4NCiAgICAvL0lmIHlvdXIgdG9rZW4gbGVhdmVzIG91dCB0b3RhbFN1cHBseSBhbmQgY2FuIGlzc3VlIG1vcmUgdG9rZW5zIGFzIHRpbWUgZ29lcyBvbiwgeW91IG5lZWQgdG8gY2hlY2sgaWYgaXQgZG9lc24ndCB3cmFwLg0KICAgIC8vUmVwbGFjZSB0aGUgaWYgd2l0aCB0aGlzIG9uZSBpbnN0ZWFkLg0KICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCiAgICAvL2lmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0NCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgIC8vc2FtZSBhcyBhYm92ZS4gUmVwbGFjZSB0aGlzIGxpbmUgd2l0aCB0aGUgZm9sbG93aW5nIGlmIHlvdSB3YW50IHRvIHByb3RlY3QgYWdhaW5zdCB3cmFwcGluZyB1aW50cy4NCiAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCiAgICAvL2lmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQogICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogIH0NCg0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICB9DQoNCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogIH0NCg0KICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KfQ0KDQpjb250cmFjdCBSZXNlcnZlVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgU2FmZU1hdGggew0KICBhZGRyZXNzIHB1YmxpYyBtaW50ZXI7DQogIGZ1bmN0aW9uIFJlc2VydmVUb2tlbigpIHsNCiAgICBtaW50ZXIgPSBtc2cuc2VuZGVyOw0KICB9DQogIGZ1bmN0aW9uIGNyZWF0ZShhZGRyZXNzIGFjY291bnQsIHVpbnQgYW1vdW50KSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gbWludGVyKSB0aHJvdzsNCiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVBZGQoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7DQogICAgdG90YWxTdXBwbHkgPSBzYWZlQWRkKHRvdGFsU3VwcGx5LCBhbW91bnQpOw0KICB9DQogIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBhY2NvdW50LCB1aW50IGFtb3VudCkgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG1pbnRlcikgdGhyb3c7DQogICAgaWYgKGJhbGFuY2VzW2FjY291bnRdIDwgYW1vdW50KSB0aHJvdzsNCiAgICBiYWxhbmNlc1thY2NvdW50XSA9IHNhZmVTdWIoYmFsYW5jZXNbYWNjb3VudF0sIGFtb3VudCk7DQogICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBhbW91bnQpOw0KICB9DQp9DQoNCmNvbnRyYWN0IEFjY291bnRMZXZlbHMgew0KICAvL2dpdmVuIGEgdXNlciwgcmV0dXJucyBhbiBhY2NvdW50IGxldmVsDQogIC8vMCA9IHJlZ3VsYXIgdXNlciAocGF5cyB0YWtlIGZlZSBhbmQgbWFrZSBmZWUpDQogIC8vMSA9IG1hcmtldCBtYWtlciBzaWx2ZXIgKHBheXMgdGFrZSBmZWUsIG5vIG1ha2UgZmVlLCBnZXRzIHJlYmF0ZSkNCiAgLy8yID0gbWFya2V0IG1ha2VyIGdvbGQgKHBheXMgdGFrZSBmZWUsIG5vIG1ha2UgZmVlLCBnZXRzIGVudGlyZSBjb3VudGVycGFydHkncyB0YWtlIGZlZSBhcyByZWJhdGUpDQogIGZ1bmN0aW9uIGFjY291bnRMZXZlbChhZGRyZXNzIHVzZXIpIGNvbnN0YW50IHJldHVybnModWludCkge30NCn0NCg0KY29udHJhY3QgQWNjb3VudExldmVsc1Rlc3QgaXMgQWNjb3VudExldmVscyB7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGFjY291bnRMZXZlbHM7DQoNCiAgZnVuY3Rpb24gc2V0QWNjb3VudExldmVsKGFkZHJlc3MgdXNlciwgdWludCBsZXZlbCkgew0KICAgIGFjY291bnRMZXZlbHNbdXNlcl0gPSBsZXZlbDsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFjY291bnRMZXZlbChhZGRyZXNzIHVzZXIpIGNvbnN0YW50IHJldHVybnModWludCkgew0KICAgIHJldHVybiBhY2NvdW50TGV2ZWxzW3VzZXJdOw0KICB9DQp9DQoNCmNvbnRyYWN0IEV0aGVyRGVsdGEgaXMgU2FmZU1hdGggew0KICBhZGRyZXNzIHB1YmxpYyBhZG1pbjsgLy90aGUgYWRtaW4gYWRkcmVzcw0KICBhZGRyZXNzIHB1YmxpYyBmZWVBY2NvdW50OyAvL3RoZSBhY2NvdW50IHRoYXQgd2lsbCByZWNlaXZlIGZlZXMNCiAgYWRkcmVzcyBwdWJsaWMgYWNjb3VudExldmVsc0FkZHI7IC8vdGhlIGFkZHJlc3Mgb2YgdGhlIEFjY291bnRMZXZlbHMgY29udHJhY3QNCiAgdWludCBwdWJsaWMgZmVlTWFrZTsgLy9wZXJjZW50YWdlIHRpbWVzICgxIGV0aGVyKQ0KICB1aW50IHB1YmxpYyBmZWVUYWtlOyAvL3BlcmNlbnRhZ2UgdGltZXMgKDEgZXRoZXIpDQogIHVpbnQgcHVibGljIGZlZVJlYmF0ZTsgLy9wZXJjZW50YWdlIHRpbWVzICgxIGV0aGVyKQ0KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIHB1YmxpYyB0b2tlbnM7IC8vbWFwcGluZyBvZiB0b2tlbiBhZGRyZXNzZXMgdG8gbWFwcGluZyBvZiBhY2NvdW50IGJhbGFuY2VzICh0b2tlbj0wIG1lYW5zIEV0aGVyKQ0KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGJ5dGVzMzIgPT4gYm9vbCkpIHB1YmxpYyBvcmRlcnM7IC8vbWFwcGluZyBvZiB1c2VyIGFjY291bnRzIHRvIG1hcHBpbmcgb2Ygb3JkZXIgaGFzaGVzIHRvIGJvb2xlYW5zICh0cnVlID0gc3VibWl0dGVkIGJ5IHVzZXIsIGVxdWl2YWxlbnQgdG8gb2ZmY2hhaW4gc2lnbmF0dXJlKQ0KICBtYXBwaW5nIChhZGRyZXNzID0+IG1hcHBpbmcgKGJ5dGVzMzIgPT4gdWludCkpIHB1YmxpYyBvcmRlckZpbGxzOyAvL21hcHBpbmcgb2YgdXNlciBhY2NvdW50cyB0byBtYXBwaW5nIG9mIG9yZGVyIGhhc2hlcyB0byB1aW50cyAoYW1vdW50IG9mIG9yZGVyIHRoYXQgaGFzIGJlZW4gZmlsbGVkKQ0KDQogIGV2ZW50IE9yZGVyKGFkZHJlc3MgdG9rZW5HZXQsIHVpbnQgYW1vdW50R2V0LCBhZGRyZXNzIHRva2VuR2l2ZSwgdWludCBhbW91bnRHaXZlLCB1aW50IGV4cGlyZXMsIHVpbnQgbm9uY2UsIGFkZHJlc3MgdXNlcik7DQogIGV2ZW50IENhbmNlbChhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKTsNCiAgZXZlbnQgVHJhZGUoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIGFkZHJlc3MgZ2V0LCBhZGRyZXNzIGdpdmUpOw0KICBldmVudCBEZXBvc2l0KGFkZHJlc3MgdG9rZW4sIGFkZHJlc3MgdXNlciwgdWludCBhbW91bnQsIHVpbnQgYmFsYW5jZSk7DQogIGV2ZW50IFdpdGhkcmF3KGFkZHJlc3MgdG9rZW4sIGFkZHJlc3MgdXNlciwgdWludCBhbW91bnQsIHVpbnQgYmFsYW5jZSk7DQoNCiAgZnVuY3Rpb24gRXRoZXJEZWx0YShhZGRyZXNzIGFkbWluXywgYWRkcmVzcyBmZWVBY2NvdW50XywgYWRkcmVzcyBhY2NvdW50TGV2ZWxzQWRkcl8sIHVpbnQgZmVlTWFrZV8sIHVpbnQgZmVlVGFrZV8sIHVpbnQgZmVlUmViYXRlXykgew0KICAgIGFkbWluID0gYWRtaW5fOw0KICAgIGZlZUFjY291bnQgPSBmZWVBY2NvdW50XzsNCiAgICBhY2NvdW50TGV2ZWxzQWRkciA9IGFjY291bnRMZXZlbHNBZGRyXzsNCiAgICBmZWVNYWtlID0gZmVlTWFrZV87DQogICAgZmVlVGFrZSA9IGZlZVRha2VfOw0KICAgIGZlZVJlYmF0ZSA9IGZlZVJlYmF0ZV87DQogIH0NCg0KICBmdW5jdGlvbigpIHsNCiAgICB0aHJvdzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZUFkbWluKGFkZHJlc3MgYWRtaW5fKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93Ow0KICAgIGFkbWluID0gYWRtaW5fOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hhbmdlQWNjb3VudExldmVsc0FkZHIoYWRkcmVzcyBhY2NvdW50TGV2ZWxzQWRkcl8pIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7DQogICAgYWNjb3VudExldmVsc0FkZHIgPSBhY2NvdW50TGV2ZWxzQWRkcl87DQogIH0NCg0KICBmdW5jdGlvbiBjaGFuZ2VGZWVBY2NvdW50KGFkZHJlc3MgZmVlQWNjb3VudF8pIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBhZG1pbikgdGhyb3c7DQogICAgZmVlQWNjb3VudCA9IGZlZUFjY291bnRfOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hhbmdlRmVlTWFrZSh1aW50IGZlZU1ha2VfKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93Ow0KICAgIGlmIChmZWVNYWtlXyA+IGZlZU1ha2UpIHRocm93Ow0KICAgIGZlZU1ha2UgPSBmZWVNYWtlXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNoYW5nZUZlZVRha2UodWludCBmZWVUYWtlXykgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IGFkbWluKSB0aHJvdzsNCiAgICBpZiAoZmVlVGFrZV8gPiBmZWVUYWtlIHx8IGZlZVRha2VfIDwgZmVlUmViYXRlKSB0aHJvdzsNCiAgICBmZWVUYWtlID0gZmVlVGFrZV87DQogIH0NCg0KICBmdW5jdGlvbiBjaGFuZ2VGZWVSZWJhdGUodWludCBmZWVSZWJhdGVfKSB7DQogICAgaWYgKG1zZy5zZW5kZXIgIT0gYWRtaW4pIHRocm93Ow0KICAgIGlmIChmZWVSZWJhdGVfIDwgZmVlUmViYXRlIHx8IGZlZVJlYmF0ZV8gPiBmZWVUYWtlKSB0aHJvdzsNCiAgICBmZWVSZWJhdGUgPSBmZWVSZWJhdGVfOw0KICB9DQoNCiAgZnVuY3Rpb24gZGVwb3NpdCgpIHBheWFibGUgew0KICAgIHRva2Vuc1swXVttc2cuc2VuZGVyXSA9IHNhZmVBZGQodG9rZW5zWzBdW21zZy5zZW5kZXJdLCBtc2cudmFsdWUpOw0KICAgIERlcG9zaXQoMCwgbXNnLnNlbmRlciwgbXNnLnZhbHVlLCB0b2tlbnNbMF1bbXNnLnNlbmRlcl0pOw0KICB9DQoNCiAgZnVuY3Rpb24gd2l0aGRyYXcodWludCBhbW91bnQpIHsNCiAgICBpZiAobXNnLnZhbHVlPjApIHRocm93Ow0KICAgIGlmICh0b2tlbnNbMF1bbXNnLnNlbmRlcl0gPCBhbW91bnQpIHRocm93Ow0KICAgIHRva2Vuc1swXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIodG9rZW5zWzBdW21zZy5zZW5kZXJdLCBhbW91bnQpOw0KICAgIGlmICghbXNnLnNlbmRlci5jYWxsLnZhbHVlKGFtb3VudCkoKSkgdGhyb3c7DQogICAgV2l0aGRyYXcoMCwgbXNnLnNlbmRlciwgYW1vdW50LCB0b2tlbnNbMF1bbXNnLnNlbmRlcl0pOw0KICB9DQoNCiAgZnVuY3Rpb24gZGVwb3NpdFRva2VuKGFkZHJlc3MgdG9rZW4sIHVpbnQgYW1vdW50KSB7DQogICAgLy9yZW1lbWJlciB0byBjYWxsIFRva2VuKGFkZHJlc3MpLmFwcHJvdmUodGhpcywgYW1vdW50KSBvciB0aGlzIGNvbnRyYWN0IHdpbGwgbm90IGJlIGFibGUgdG8gZG8gdGhlIHRyYW5zZmVyIG9uIHlvdXIgYmVoYWxmLg0KICAgIGlmIChtc2cudmFsdWU+MCB8fCB0b2tlbj09MCkgdGhyb3c7DQogICAgaWYgKCFUb2tlbih0b2tlbikudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIHRoaXMsIGFtb3VudCkpIHRocm93Ow0KICAgIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0sIGFtb3VudCk7DQogICAgRGVwb3NpdCh0b2tlbiwgbXNnLnNlbmRlciwgYW1vdW50LCB0b2tlbnNbdG9rZW5dW21zZy5zZW5kZXJdKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW4oYWRkcmVzcyB0b2tlbiwgdWludCBhbW91bnQpIHsNCiAgICBpZiAobXNnLnZhbHVlPjAgfHwgdG9rZW49PTApIHRocm93Ow0KICAgIGlmICh0b2tlbnNbdG9rZW5dW21zZy5zZW5kZXJdIDwgYW1vdW50KSB0aHJvdzsNCiAgICB0b2tlbnNbdG9rZW5dW21zZy5zZW5kZXJdID0gc2FmZVN1Yih0b2tlbnNbdG9rZW5dW21zZy5zZW5kZXJdLCBhbW91bnQpOw0KICAgIGlmICghVG9rZW4odG9rZW4pLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGFtb3VudCkpIHRocm93Ow0KICAgIFdpdGhkcmF3KHRva2VuLCBtc2cuc2VuZGVyLCBhbW91bnQsIHRva2Vuc1t0b2tlbl1bbXNnLnNlbmRlcl0pOw0KICB9DQoNCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgdG9rZW4sIGFkZHJlc3MgdXNlcikgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgIHJldHVybiB0b2tlbnNbdG9rZW5dW3VzZXJdOw0KICB9DQoNCiAgZnVuY3Rpb24gb3JkZXIoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSkgew0KICAgIGlmIChtc2cudmFsdWU+MCkgdGhyb3c7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIG9yZGVyc1ttc2cuc2VuZGVyXVtoYXNoXSA9IHRydWU7DQogICAgT3JkZXIodG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSwgbXNnLnNlbmRlcik7DQogIH0NCg0KICBmdW5jdGlvbiB0cmFkZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzLCB1aW50IGFtb3VudCkgew0KICAgIC8vYW1vdW50IGlzIGluIGFtb3VudEdldCB0ZXJtcw0KICAgIGlmIChtc2cudmFsdWU+MCkgdGhyb3c7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIGlmICghKA0KICAgICAgKG9yZGVyc1t1c2VyXVtoYXNoXSB8fCBlY3JlY292ZXIoaGFzaCx2LHIscykgPT0gdXNlcikgJiYNCiAgICAgIGJsb2NrLm51bWJlciA8PSBleHBpcmVzICYmDQogICAgICBzYWZlQWRkKG9yZGVyRmlsbHNbdXNlcl1baGFzaF0sIGFtb3VudCkgPD0gYW1vdW50R2V0DQogICAgKSkgdGhyb3c7DQogICAgdHJhZGVCYWxhbmNlcyh0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIHVzZXIsIGFtb3VudCk7DQogICAgb3JkZXJGaWxsc1t1c2VyXVtoYXNoXSA9IHNhZmVBZGQob3JkZXJGaWxsc1t1c2VyXVtoYXNoXSwgYW1vdW50KTsNCiAgICBUcmFkZSh0b2tlbkdldCwgYW1vdW50LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUgKiBhbW91bnQgLyBhbW91bnRHZXQsIHVzZXIsIG1zZy5zZW5kZXIpOw0KICB9DQoNCiAgZnVuY3Rpb24gdHJhZGVCYWxhbmNlcyhhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgYWRkcmVzcyB1c2VyLCB1aW50IGFtb3VudCkgcHJpdmF0ZSB7DQogICAgdWludCBmZWVNYWtlWGZlciA9IHNhZmVNdWwoYW1vdW50LCBmZWVNYWtlKSAvICgxIGV0aGVyKTsNCiAgICB1aW50IGZlZVRha2VYZmVyID0gc2FmZU11bChhbW91bnQsIGZlZVRha2UpIC8gKDEgZXRoZXIpOw0KICAgIHVpbnQgZmVlUmViYXRlWGZlciA9IDA7DQogICAgaWYgKGFjY291bnRMZXZlbHNBZGRyICE9IDB4MCkgew0KICAgICAgdWludCBhY2NvdW50TGV2ZWwgPSBBY2NvdW50TGV2ZWxzKGFjY291bnRMZXZlbHNBZGRyKS5hY2NvdW50TGV2ZWwodXNlcik7DQogICAgICBpZiAoYWNjb3VudExldmVsPT0xKSBmZWVSZWJhdGVYZmVyID0gc2FmZU11bChhbW91bnQsIGZlZVJlYmF0ZSkgLyAoMSBldGhlcik7DQogICAgICBpZiAoYWNjb3VudExldmVsPT0yKSBmZWVSZWJhdGVYZmVyID0gZmVlVGFrZVhmZXI7DQogICAgfQ0KICAgIHRva2Vuc1t0b2tlbkdldF1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKHRva2Vuc1t0b2tlbkdldF1bbXNnLnNlbmRlcl0sIHNhZmVBZGQoYW1vdW50LCBmZWVUYWtlWGZlcikpOw0KICAgIHRva2Vuc1t0b2tlbkdldF1bdXNlcl0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbkdldF1bdXNlcl0sIHNhZmVTdWIoc2FmZUFkZChhbW91bnQsIGZlZVJlYmF0ZVhmZXIpLCBmZWVNYWtlWGZlcikpOw0KICAgIHRva2Vuc1t0b2tlbkdldF1bZmVlQWNjb3VudF0gPSBzYWZlQWRkKHRva2Vuc1t0b2tlbkdldF1bZmVlQWNjb3VudF0sIHNhZmVTdWIoc2FmZUFkZChmZWVNYWtlWGZlciwgZmVlVGFrZVhmZXIpLCBmZWVSZWJhdGVYZmVyKSk7DQogICAgdG9rZW5zW3Rva2VuR2l2ZV1bdXNlcl0gPSBzYWZlU3ViKHRva2Vuc1t0b2tlbkdpdmVdW3VzZXJdLCBzYWZlTXVsKGFtb3VudEdpdmUsIGFtb3VudCkgLyBhbW91bnRHZXQpOw0KICAgIHRva2Vuc1t0b2tlbkdpdmVdW21zZy5zZW5kZXJdID0gc2FmZUFkZCh0b2tlbnNbdG9rZW5HaXZlXVttc2cuc2VuZGVyXSwgc2FmZU11bChhbW91bnRHaXZlLCBhbW91bnQpIC8gYW1vdW50R2V0KTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRlc3RUcmFkZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzLCB1aW50IGFtb3VudCwgYWRkcmVzcyBzZW5kZXIpIGNvbnN0YW50IHJldHVybnMoYm9vbCkgew0KICAgIGlmICghKA0KICAgICAgdG9rZW5zW3Rva2VuR2V0XVtzZW5kZXJdID49IGFtb3VudCAmJg0KICAgICAgYXZhaWxhYmxlVm9sdW1lKHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UsIHVzZXIsIHYsIHIsIHMpID49IGFtb3VudA0KICAgICkpIHJldHVybiBmYWxzZTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGF2YWlsYWJsZVZvbHVtZShhZGRyZXNzIHRva2VuR2V0LCB1aW50IGFtb3VudEdldCwgYWRkcmVzcyB0b2tlbkdpdmUsIHVpbnQgYW1vdW50R2l2ZSwgdWludCBleHBpcmVzLCB1aW50IG5vbmNlLCBhZGRyZXNzIHVzZXIsIHVpbnQ4IHYsIGJ5dGVzMzIgciwgYnl0ZXMzMiBzKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICBieXRlczMyIGhhc2ggPSBzaGEyNTYodGhpcywgdG9rZW5HZXQsIGFtb3VudEdldCwgdG9rZW5HaXZlLCBhbW91bnRHaXZlLCBleHBpcmVzLCBub25jZSk7DQogICAgaWYgKCEoDQogICAgICAob3JkZXJzW3VzZXJdW2hhc2hdIHx8IGVjcmVjb3ZlcihoYXNoLHYscixzKSA9PSB1c2VyKSAmJg0KICAgICAgYmxvY2subnVtYmVyIDw9IGV4cGlyZXMNCiAgICApKSByZXR1cm4gMDsNCiAgICB1aW50IGF2YWlsYWJsZTEgPSBzYWZlU3ViKGFtb3VudEdldCwgb3JkZXJGaWxsc1t1c2VyXVtoYXNoXSk7DQogICAgdWludCBhdmFpbGFibGUyID0gc2FmZU11bCh0b2tlbnNbdG9rZW5HaXZlXVt1c2VyXSwgYW1vdW50R2V0KSAvIGFtb3VudEdpdmU7DQogICAgaWYgKGF2YWlsYWJsZTE8YXZhaWxhYmxlMikgcmV0dXJuIGF2YWlsYWJsZTE7DQogICAgcmV0dXJuIGF2YWlsYWJsZTI7DQogIH0NCg0KICBmdW5jdGlvbiBhbW91bnRGaWxsZWQoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgYWRkcmVzcyB1c2VyLCB1aW50OCB2LCBieXRlczMyIHIsIGJ5dGVzMzIgcykgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7DQogICAgYnl0ZXMzMiBoYXNoID0gc2hhMjU2KHRoaXMsIHRva2VuR2V0LCBhbW91bnRHZXQsIHRva2VuR2l2ZSwgYW1vdW50R2l2ZSwgZXhwaXJlcywgbm9uY2UpOw0KICAgIHJldHVybiBvcmRlckZpbGxzW3VzZXJdW2hhc2hdOw0KICB9DQoNCiAgZnVuY3Rpb24gY2FuY2VsT3JkZXIoYWRkcmVzcyB0b2tlbkdldCwgdWludCBhbW91bnRHZXQsIGFkZHJlc3MgdG9rZW5HaXZlLCB1aW50IGFtb3VudEdpdmUsIHVpbnQgZXhwaXJlcywgdWludCBub25jZSwgdWludDggdiwgYnl0ZXMzMiByLCBieXRlczMyIHMpIHsNCiAgICBpZiAobXNnLnZhbHVlPjApIHRocm93Ow0KICAgIGJ5dGVzMzIgaGFzaCA9IHNoYTI1Nih0aGlzLCB0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlKTsNCiAgICBpZiAoIShvcmRlcnNbbXNnLnNlbmRlcl1baGFzaF0gfHwgZWNyZWNvdmVyKGhhc2gsdixyLHMpID09IG1zZy5zZW5kZXIpKSB0aHJvdzsNCiAgICBvcmRlckZpbGxzW21zZy5zZW5kZXJdW2hhc2hdID0gYW1vdW50R2V0Ow0KICAgIENhbmNlbCh0b2tlbkdldCwgYW1vdW50R2V0LCB0b2tlbkdpdmUsIGFtb3VudEdpdmUsIGV4cGlyZXMsIG5vbmNlLCBtc2cuc2VuZGVyLCB2LCByLCBzKTsNCiAgfQ0KfQ=='