base 64 content
base64gameLib
	^'bGlicmFyeSBBcnJheUxpYiB7DQogIC8vIEluc2VydHMgdG8ga2VlcCBhcnJheSBzb3J0ZWQgKGFzc3VtZXMgaW5wdXQgYXJyYXkgaXMgc29ydGVkKQ0KCWZ1bmN0aW9uIGluc2VydEluUGxhY2UodWludDhbXSBzdG9yYWdlIHNlbGYsIHVpbnQ4IG4pIHsNCgkJdWludDggaW5zZXJ0aW5nSW5kZXggPSAwOw0KDQoJCXdoaWxlIChzZWxmLmxlbmd0aCA+IDAgJiYgaW5zZXJ0aW5nSW5kZXggPCBzZWxmLmxlbmd0aCAmJiBzZWxmW2luc2VydGluZ0luZGV4XSA8IG4pIHsNCgkJCWluc2VydGluZ0luZGV4ICs9IDE7DQoJCX0NCg0KCQlzZWxmLmxlbmd0aCArPSAxOw0KCQlmb3IgKHVpbnQ4IGkgPSB1aW50OChzZWxmLmxlbmd0aCkgLSAxOyBpID4gaW5zZXJ0aW5nSW5kZXg7IGktLSkgew0KCQkJc2VsZltpXSA9IHNlbGZbaSAtIDFdOw0KCQl9DQoNCgkJc2VsZltpbnNlcnRpbmdJbmRleF0gPSBuOw0KCX0NCn0NCg0KDQpsaWJyYXJ5IERlY2tMaWIgew0KCXVzaW5nIEFycmF5TGliIGZvciB1aW50OFtdOw0KDQoJZW51bSBTdWl0IHsgU3BhZGVzLCBIZWFydHMsIENsdWJzLCBEaWFtb25kcyB9DQoJdWludDggY29uc3RhbnQgY2FyZHNQZXJTdWl0ID0gMTM7DQoJdWludDggY29uc3RhbnQgc3VpdHMgPSA0Ow0KCXVpbnQ4IGNvbnN0YW50IHRvdGFsQ2FyZHMgPSBjYXJkc1BlclN1aXQgKiBzdWl0czsNCg0KCXN0cnVjdCBEZWNrIHsNCgkJdWludDhbXSB1c2VkQ2FyZHM7IC8vIGFsd2F5cyBoYXMgdG8gYmUgc29ydGVkDQoJCWFkZHJlc3MgcGxheWVyOw0KCQl1aW50MjU2IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBpbml0KERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGdhbWVJRCkgIHsNCgkJc2VsZi51c2VkQ2FyZHMgPSBuZXcgdWludDhbXSgwKTsNCgkJc2VsZi5wbGF5ZXIgPSBtc2cuc2VuZGVyOw0KCQlzZWxmLmdhbWVJRCA9IGdhbWVJRDsNCgl9DQoNCglmdW5jdGlvbiBnZXRDYXJkKERlY2sgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGJsb2NrTnVtYmVyKSAgcmV0dXJucyAodWludDgpICB7DQoJCXVpbnQgY2FyZEluZGV4ID0gc2VsZi51c2VkQ2FyZHMubGVuZ3RoOw0KCQlpZiAoY2FyZEluZGV4ID49IHRvdGFsQ2FyZHMpIHRocm93Ow0KCQl1aW50OCByID0gdWludDgoZ2V0UmFuZG9tTnVtYmVyKGJsb2NrTnVtYmVyLCBzZWxmLnBsYXllciwgc2VsZi5nYW1lSUQsIGNhcmRJbmRleCwgdG90YWxDYXJkcyAtIGNhcmRJbmRleCkpOw0KDQoJCWZvciAodWludDggaSA9IDA7IGkgPCBjYXJkSW5kZXg7IGkrKykgew0KCQkJaWYgKHNlbGYudXNlZENhcmRzW2ldIDw9IHIpIHIgKz0gMTsNCgkJfQ0KDQoJCXNlbGYudXNlZENhcmRzLmluc2VydEluUGxhY2Uocik7DQoNCgkJcmV0dXJuIHI7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZERlc2NyaXB0aW9uKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKFN1aXQsIHVpbnQ4KSB7DQoJCXJldHVybiAoU3VpdChzZWxmIC8gY2FyZHNQZXJTdWl0KSwgY2FyZEZhY2V2YWx1ZShzZWxmKSk7DQoJfQ0KDQoJZnVuY3Rpb24gY2FyZEVtb2ppZmllZCh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCwgc3RyaW5nKSB7DQoJCXN0cmluZyBtZW1vcnkgZW1vamlTdWl0Ow0KDQoJCXZhciAoc3VpdCwgbnVtYmVyKSA9IGNhcmREZXNjcmlwdGlvbihzZWxmKTsNCgkJaWYgKHN1aXQgPT0gU3VpdC5DbHVicykgZW1vamlTdWl0ID0gIuKZo++4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5EaWFtb25kcykgZW1vamlTdWl0ID0gIuKZpu+4jyI7DQoJCWVsc2UgaWYgKHN1aXQgPT0gU3VpdC5IZWFydHMpIGVtb2ppU3VpdCA9ICLimaXvuI8iOw0KCQllbHNlIGlmIChzdWl0ID09IFN1aXQuU3BhZGVzKSBlbW9qaVN1aXQgPSAi4pmg77iPIjsNCg0KCQlyZXR1cm4gKG51bWJlciwgZW1vamlTdWl0KTsNCgl9DQoNCglmdW5jdGlvbiBjYXJkRmFjZXZhbHVlKHVpbnQ4IHNlbGYpIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4KSB7DQoJCXJldHVybiAxICsgc2VsZiAlIGNhcmRzUGVyU3VpdDsNCgl9DQoNCglmdW5jdGlvbiBibGFja2phY2tWYWx1ZSh1aW50OCBzZWxmKSBjb25zdGFudCByZXR1cm5zICh1aW50OCkgew0KCQl1aW50OCBjYXJkVmFsdWUgPSBjYXJkRmFjZXZhbHVlKHNlbGYpOw0KCQlyZXR1cm4gY2FyZFZhbHVlIDwgMTAgPyBjYXJkVmFsdWUgOiAxMDsNCgl9DQoNCglmdW5jdGlvbiBnZXRSYW5kb21OdW1iZXIodWludCBiLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBnYW1lSUQsIHVpbnQgbiwgdWludCBtKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQoJCS8vIFVzZXMgYmxvY2toYXNoIGFzIHJhbmRvbW5lc3Mgc291cmNlLg0KCQkvLyBDcmVkaXRzOiBodHRwczovL2dpdGh1Yi5jb20vQnVuamluL1JvdWxldGgvYmxvYi9tYXN0ZXIvUHJvdmFibHlfRmFpcl9Ob19DaGVhdGluZy5tZA0KCQlieXRlczMyIGJsb2NrSGFzaCA9IGJsb2NrLmJsb2NraGFzaChiKTsNCgkJaWYgKGJsb2NrSGFzaCA9PSAweDApIHRocm93Ow0KCQlyZXR1cm4gdWludCh1aW50MjU2KGtlY2NhazI1NihibG9ja0hhc2gsIHBsYXllciwgZ2FtZUlELCBuKSkgJSBtKTsNCg0KCX0NCn0NCg0KbGlicmFyeSBHYW1lTGliIHsNCiAgdXNpbmcgRGVja0xpYiBmb3IgKjsNCg0KICB1aW50OCBjb25zdGFudCBob3VzZUxpbWl0ID0gMTc7DQogIHVpbnQ4IGNvbnN0YW50IHRhcmdldCA9IDIxOw0KDQogIGVudW0gQ29tcGFyYWlzb25SZXN1bHQgeyBGaXJzdCwgU2Vjb25kLCBUaWUgfQ0KICBlbnVtIEdhbWVTdGF0ZSB7IEluaXRpYWxDYXJkcywgV2FpdGluZywgSGl0LCBTdGFuZCwgRmluaXNoZWQgfQ0KICBlbnVtIEdhbWVSZXN1bHQgeyBPbmdvaW5nLCBIb3VzZSwgVGllLCBQbGF5ZXIsIFBsYXllck5hdHVyYWwgfQ0KDQogIHN0cnVjdCBHYW1lIHsNCiAgICBhZGRyZXNzIHBsYXllcjsNCiAgICB1aW50MjU2IGJldDsNCiAgICB1aW50MjU2IHBheW91dDsNCiAgICB1aW50MjU2IGdhbWVJRDsNCg0KICAgIERlY2tMaWIuRGVjayBkZWNrOw0KICAgIHVpbnQ4W10gaG91c2VDYXJkczsNCiAgICB1aW50OFtdIHBsYXllckNhcmRzOw0KDQogICAgdWludDI1NiBhY3Rpb25CbG9jazsgLy8gQmxvY2sgb24gd2hpY2ggY29tbWl0bWVudCB0byBwZXJmb3JtIGFuIGFjdGlvbiBoYXBwZW5zLg0KDQogICAgR2FtZVN0YXRlIHN0YXRlOw0KICAgIEdhbWVSZXN1bHQgcmVzdWx0Ow0KDQogICAgYm9vbCBjbG9zZWQ7DQogIH0NCg0KICBmdW5jdGlvbiBpbml0KEdhbWUgc3RvcmFnZSBzZWxmLCB1aW50MjU2IGdhbWVJRCkgew0KICAgIHNlbGYucGxheWVyID0gbXNnLnNlbmRlcjsNCiAgICBzZWxmLmJldCA9IG1zZy52YWx1ZTsNCiAgICBzZWxmLnBheW91dCA9IDA7DQogICAgc2VsZi5ob3VzZUNhcmRzID0gbmV3IHVpbnQ4W10oMCk7DQogICAgc2VsZi5wbGF5ZXJDYXJkcyA9IG5ldyB1aW50OFtdKDApOw0KICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7DQogICAgc2VsZi5zdGF0ZSA9IEdhbWVTdGF0ZS5Jbml0aWFsQ2FyZHM7DQogICAgc2VsZi5yZXN1bHQgPSBHYW1lUmVzdWx0Lk9uZ29pbmc7DQogICAgc2VsZi5jbG9zZWQgPSBmYWxzZTsNCiAgICBzZWxmLmdhbWVJRCA9IGdhbWVJRDsNCg0KICAgIHNlbGYuZGVjay5pbml0KGdhbWVJRCk7DQogIH0NCg0KICBmdW5jdGlvbiB0aWNrKEdhbWUgc3RvcmFnZSBzZWxmKSAgcmV0dXJucyAoYm9vbCkgew0KICAgIGlmIChibG9jay5udW1iZXIgPD0gc2VsZi5hY3Rpb25CbG9jaykgcmV0dXJuIGZhbHNlOyAvLyBDYW4ndCB0aWNrIHlldA0KICAgIGlmIChzZWxmLmFjdGlvbkJsb2NrICsgMjU1IDwgYmxvY2subnVtYmVyKSB7DQogICAgICBlbmRHYW1lKHNlbGYsIEdhbWVSZXN1bHQuSG91c2UpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIGlmICghbmVlZHNUaWNrKHNlbGYpKSByZXR1cm4gdHJ1ZTsgLy8gbm90IG5lZWRlZCwgZXZlcnl0aGluZyBpcyBmaW5lDQoNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuSW5pdGlhbENhcmRzKSBkZWFsSW5pdGlhbENhcmRzKHNlbGYpOw0KICAgIGlmIChzZWxmLnN0YXRlID09IEdhbWVTdGF0ZS5IaXQpIGRlYWxIaXRDYXJkKHNlbGYpOw0KDQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLlN0YW5kKSB7DQogICAgICBkZWFsSG91c2VDYXJkcyhzZWxmKTsNCiAgICAgIGNoZWNrR2FtZVJlc3VsdChzZWxmKTsNCiAgICB9IGVsc2Ugew0KICAgICAgY2hlY2tHYW1lQ29udGludWVzKHNlbGYpOw0KICAgIH0NCg0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gbmVlZHNUaWNrKEdhbWUgc3RvcmFnZSBzZWxmKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7DQogICAgaWYgKHNlbGYuc3RhdGUgPT0gR2FtZVN0YXRlLldhaXRpbmcpIHJldHVybiBmYWxzZTsNCiAgICBpZiAoc2VsZi5zdGF0ZSA9PSBHYW1lU3RhdGUuRmluaXNoZWQpIHJldHVybiBmYWxzZTsNCg0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gY2hlY2tHYW1lUmVzdWx0KEdhbWUgc3RvcmFnZSBzZWxmKSAgew0KICAgIHVpbnQ4IGhvdXNlSGFuZCA9IGNvdW50SGFuZChzZWxmLmhvdXNlQ2FyZHMpOw0KDQogICAgaWYgKGhvdXNlSGFuZCA9PSB0YXJnZXQgJiYgc2VsZi5ob3VzZUNhcmRzLmxlbmd0aCA9PSAyKSByZXR1cm4gZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LkhvdXNlKTsgLy8gSG91c2UgbmF0dXJhbA0KDQogICAgQ29tcGFyYWlzb25SZXN1bHQgcmVzdWx0ID0gY29tcGFyZUhhbmRzKGhvdXNlSGFuZCwgY291bnRIYW5kKHNlbGYucGxheWVyQ2FyZHMpKTsNCiAgICBpZiAocmVzdWx0ID09IENvbXBhcmFpc29uUmVzdWx0LkZpcnN0KSByZXR1cm4gZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LkhvdXNlKTsNCiAgICBpZiAocmVzdWx0ID09IENvbXBhcmFpc29uUmVzdWx0LlNlY29uZCkgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5QbGF5ZXIpOw0KDQogICAgZW5kR2FtZShzZWxmLCBHYW1lUmVzdWx0LlRpZSk7DQogIH0NCg0KICBmdW5jdGlvbiBjaGVja0dhbWVDb250aW51ZXMoR2FtZSBzdG9yYWdlIHNlbGYpICB7DQogICAgdWludDggcGxheWVySGFuZCA9IGNvdW50SGFuZChzZWxmLnBsYXllckNhcmRzKTsNCiAgICBpZiAocGxheWVySGFuZCA9PSB0YXJnZXQgJiYgc2VsZi5wbGF5ZXJDYXJkcy5sZW5ndGggPT0gMikgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5QbGF5ZXJOYXR1cmFsKTsgLy8gcGxheWVyIG5hdHVyYWwNCiAgICBpZiAocGxheWVySGFuZCA+IHRhcmdldCkgcmV0dXJuIGVuZEdhbWUoc2VsZiwgR2FtZVJlc3VsdC5Ib3VzZSk7IC8vIFBsYXllciBidXN0ZWQNCiAgICBpZiAocGxheWVySGFuZCA9PSB0YXJnZXQpIHsNCiAgICAgIC8vIFBsYXllciBpcyBmb3JjZWQgdG8gc3RhbmQgd2l0aCAyMQ0KICAgICAgdWludDI1NiBjdXJyZW50QWN0aW9uQmxvY2sgPSBzZWxmLmFjdGlvbkJsb2NrOw0KICAgICAgcGxheWVyRGVjaXNpb24oc2VsZiwgR2FtZVN0YXRlLlN0YW5kKTsNCiAgICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBjdXJyZW50QWN0aW9uQmxvY2s7DQogICAgICBpZiAoIXRpY2soc2VsZikpIHRocm93OyAvLyBGb3JjZXMgdGljaywgY29tbWl0bWVudCB0byBwbGF5IGFjdHVhbGx5IGhhcHBlbmVkIHBhc3QgYmxvY2sNCiAgICB9DQogIH0NCg0KICBmdW5jdGlvbiBwbGF5ZXJEZWNpc2lvbihHYW1lIHN0b3JhZ2Ugc2VsZiwgR2FtZVN0YXRlIGRlY2lzaW9uKSAgew0KICAgIGlmIChzZWxmLnN0YXRlICE9IEdhbWVTdGF0ZS5XYWl0aW5nKSB0aHJvdzsNCiAgICBpZiAoZGVjaXNpb24gIT0gR2FtZVN0YXRlLkhpdCAmJiBkZWNpc2lvbiAhPSBHYW1lU3RhdGUuU3RhbmQpIHRocm93Ow0KDQogICAgc2VsZi5zdGF0ZSA9IGRlY2lzaW9uOw0KICAgIHNlbGYuYWN0aW9uQmxvY2sgPSBibG9jay5udW1iZXI7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSW5pdGlhbENhcmRzKEdhbWUgc3RvcmFnZSBzZWxmKSBwcml2YXRlIHsNCiAgICBzZWxmLnBsYXllckNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KICAgIHNlbGYuaG91c2VDYXJkcy5wdXNoKHNlbGYuZGVjay5nZXRDYXJkKHNlbGYuYWN0aW9uQmxvY2spKTsNCiAgICBzZWxmLnBsYXllckNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KDQogICAgc2VsZi5zdGF0ZSA9IEdhbWVTdGF0ZS5XYWl0aW5nOw0KICB9DQoNCiAgZnVuY3Rpb24gZGVhbEhpdENhcmQoR2FtZSBzdG9yYWdlIHNlbGYpIHByaXZhdGUgew0KICAgIHNlbGYucGxheWVyQ2FyZHMucHVzaChzZWxmLmRlY2suZ2V0Q2FyZChzZWxmLmFjdGlvbkJsb2NrKSk7DQoNCiAgICBzZWxmLnN0YXRlID0gR2FtZVN0YXRlLldhaXRpbmc7DQogIH0NCg0KICBmdW5jdGlvbiBkZWFsSG91c2VDYXJkcyhHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgc2VsZi5ob3VzZUNhcmRzLnB1c2goc2VsZi5kZWNrLmdldENhcmQoc2VsZi5hY3Rpb25CbG9jaykpOw0KDQogICAgaWYgKGNvdW50SGFuZChzZWxmLmhvdXNlQ2FyZHMpIDwgaG91c2VMaW1pdCkgZGVhbEhvdXNlQ2FyZHMoc2VsZik7DQogIH0NCg0KICBmdW5jdGlvbiBlbmRHYW1lKEdhbWUgc3RvcmFnZSBzZWxmLCBHYW1lUmVzdWx0IHJlc3VsdCkgew0KICAgIHNlbGYucmVzdWx0ID0gcmVzdWx0Ow0KICAgIHNlbGYuc3RhdGUgPSBHYW1lU3RhdGUuRmluaXNoZWQ7DQogICAgc2VsZi5wYXlvdXQgPSBwYXlvdXRGb3JSZXN1bHQoc2VsZi5yZXN1bHQsIHNlbGYuYmV0KTsNCg0KICAgIGNsb3NlR2FtZShzZWxmKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNsb3NlR2FtZShHYW1lIHN0b3JhZ2Ugc2VsZikgcHJpdmF0ZSB7DQogICAgaWYgKHNlbGYuY2xvc2VkKSB0aHJvdzsgLy8gY2Fubm90IHJlLWNsb3NlDQogICAgaWYgKHNlbGYuc3RhdGUgIT0gR2FtZVN0YXRlLkZpbmlzaGVkKSB0aHJvdzsgLy8gbm90IGNsb3NhYmxlDQoNCiAgICBzZWxmLmNsb3NlZCA9IHRydWU7DQoNCiAgICBpZiAoc2VsZi5wYXlvdXQgPiAwKSB7DQogICAgICBpZiAoIXNlbGYucGxheWVyLnNlbmQoc2VsZi5wYXlvdXQpKSB0aHJvdzsNCiAgICB9DQogIH0NCg0KICBmdW5jdGlvbiBwYXlvdXRGb3JSZXN1bHQoR2FtZVJlc3VsdCByZXN1bHQsIHVpbnQyNTYgYmV0KSBwcml2YXRlIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICBpZiAocmVzdWx0ID09IEdhbWVSZXN1bHQuUGxheWVyTmF0dXJhbCkgcmV0dXJuIGJldCAqIDUgLyAyOyAvLyBiZXQgKyAxLjV4IGJldA0KICAgIGlmIChyZXN1bHQgPT0gR2FtZVJlc3VsdC5QbGF5ZXIpIHJldHVybiBiZXQgKiAyOyAvLyBkb3VibGVzIGJldA0KICAgIGlmIChyZXN1bHQgPT0gR2FtZVJlc3VsdC5UaWUpIHJldHVybiBiZXQ7IC8vIHJldHVybnMgYmV0DQoNCiAgICByZXR1cm4gMDsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNvdW50SGFuZCh1aW50OFtdIG1lbW9yeSBoYW5kKSAgcmV0dXJucyAodWludDgpIHsNCiAgICB1aW50OFtdIG1lbW9yeSBwb3NzaWJsZVN1bXMgPSBuZXcgdWludDhbXSgxKTsNCg0KICAgIGZvciAodWludCBpID0gMDsgaSA8IGhhbmQubGVuZ3RoOyBpKyspIHsNCiAgICAgIHVpbnQ4IHZhbHVlID0gaGFuZFtpXS5ibGFja2phY2tWYWx1ZSgpOw0KICAgICAgdWludCBsID0gcG9zc2libGVTdW1zLmxlbmd0aDsNCiAgICAgIGZvciAodWludCBqID0gMDsgaiA8IGw7IGorKykgew0KICAgICAgICBwb3NzaWJsZVN1bXNbal0gKz0gdmFsdWU7DQogICAgICAgIGlmICh2YWx1ZSA9PSAxKSB7IC8vIGlzIEFjZQ0KICAgICAgICAgIHBvc3NpYmxlU3VtcyA9IGFwcGVuZEFycmF5KHBvc3NpYmxlU3VtcywgcG9zc2libGVTdW1zW2pdICsgMTApOyAvLyBGb3JrIHBvc3NpYmxlIHN1bSB3aXRoIDExIGFzIGFjZSB2YWx1ZS4NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBiZXN0U3VtKHBvc3NpYmxlU3Vtcyk7DQogIH0NCg0KICBmdW5jdGlvbiBiZXN0U3VtKHVpbnQ4W10gcG9zc2libGVTdW1zKSAgcmV0dXJucyAodWludDggYmVzdFN1bSkgew0KICAgIGJlc3RTdW0gPSA1MDsgLy8gdmVyeSBiYWQgaGFuZA0KICAgIGZvciAodWludCBpID0gMDsgaSA8IHBvc3NpYmxlU3Vtcy5sZW5ndGg7IGkrKykgew0KICAgICAgaWYgKGNvbXBhcmVIYW5kcyhiZXN0U3VtLCBwb3NzaWJsZVN1bXNbaV0pID09IENvbXBhcmFpc29uUmVzdWx0LlNlY29uZCkgew0KICAgICAgICBiZXN0U3VtID0gcG9zc2libGVTdW1zW2ldOw0KICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm47DQogIH0NCg0KICBmdW5jdGlvbiBhcHBlbmRBcnJheSh1aW50OFtdIG1lbW9yeSBhcnJheSwgdWludDggbikgIHJldHVybnMgKHVpbnQ4W10gbWVtb3J5KSB7DQogICAgdWludDhbXSBtZW1vcnkgbmV3QXJyYXkgPSBuZXcgdWludDhbXShhcnJheS5sZW5ndGggKyAxKTsNCiAgICBmb3IgKHVpbnQ4IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsNCiAgICAgIG5ld0FycmF5W2ldID0gYXJyYXlbaV07DQogICAgfQ0KICAgIG5ld0FycmF5W2FycmF5Lmxlbmd0aF0gPSBuOw0KICAgIHJldHVybiBuZXdBcnJheTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNvbXBhcmVIYW5kcyh1aW50OCBhLCB1aW50OCBiKSAgcmV0dXJucyAoQ29tcGFyYWlzb25SZXN1bHQpIHsNCiAgICBpZiAoYSA8PSB0YXJnZXQgJiYgYiA8PSB0YXJnZXQpIHsNCiAgICAgIGlmIChhID4gYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LkZpcnN0Ow0KICAgICAgaWYgKGEgPCBiKSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIH0NCg0KICAgIGlmIChhID4gdGFyZ2V0ICYmIGIgPiB0YXJnZXQpIHsNCiAgICAgIGlmIChhIDwgYikgcmV0dXJuIENvbXBhcmFpc29uUmVzdWx0LkZpcnN0Ow0KICAgICAgaWYgKGEgPiBiKSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIH0NCg0KICAgIGlmIChhID4gdGFyZ2V0KSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuU2Vjb25kOw0KICAgIGlmIChiID4gdGFyZ2V0KSByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuRmlyc3Q7DQoNCiAgICByZXR1cm4gQ29tcGFyYWlzb25SZXN1bHQuVGllOw0KICB9DQp9'