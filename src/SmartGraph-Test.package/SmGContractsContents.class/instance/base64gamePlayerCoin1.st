base 64 content
base64gamePlayerCoin1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCmxpYnJhcnkgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiID4gMCk7DQogICAgdWludCBjID0gYSAvIGI7DQogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7DQogICAgcmV0dXJuIGM7DQogIH0NCiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgcmV0dXJuIGEgLSBiOw0KICB9DQogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgIGFzc2VydChjID49IGEpOw0KICAgIHJldHVybiBjOw0KICB9DQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogIH0NCn0NCmNvbnRyYWN0IE93bmFibGUgew0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQogICAgbW9kaWZpZXIgb25seU93bmVyIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgew0KICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsNCiAgICAgICAgfQ0KICAgIH0NCn0NCi8qDQogKiBQYXVzYWJsZQ0KICogQWJzdHJhY3QgY29udHJhY3QgdGhhdCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuDQogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQogKi8NCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgew0KICBib29sIHB1YmxpYyBzdG9wcGVkOw0KICBtb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgew0KICAgIGlmIChzdG9wcGVkKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KICANCiAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsNCiAgICBpZiAoIXN0b3BwZWQpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlDQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgew0KICAgIHN0b3BwZWQgPSB0cnVlOw0KICB9DQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUNCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIHN0b3BwZWQgPSBmYWxzZTsNCiAgfQ0KfQ0KY29udHJhY3QgRVJDMjBCYXNpYyB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQp9DQpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpOw0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KLyoNCiAqIFB1bGxQYXltZW50DQogKiBCYXNlIGNvbnRyYWN0IHN1cHBvcnRpbmcgYXN5bmMgc2VuZCBmb3IgcHVsbCBwYXltZW50cy4NCiAqIEluaGVyaXQgZnJvbSB0aGlzIGNvbnRyYWN0IGFuZCB1c2UgYXN5bmNTZW5kIGluc3RlYWQgb2Ygc2VuZC4NCiAqLw0KY29udHJhY3QgUHVsbFBheW1lbnQgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcGF5bWVudHM7DQogIGV2ZW50IExvZ1JlZnVuZEVUSChhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCiAgLyoqDQogICogIFN0b3JlIHNlbnQgYW1vdW50IGFzIGNyZWRpdCB0byBiZSBwdWxsZWQsIGNhbGxlZCBieSBwYXllciANCiAgKiovDQogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7DQogICAgcGF5bWVudHNbZGVzdF0gPSBwYXltZW50c1tkZXN0XS5hZGQoYW1vdW50KTsNCiAgfQ0KICAvLyB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUNCiAgZnVuY3Rpb24gd2l0aGRyYXdQYXltZW50cygpIHsNCiAgICBhZGRyZXNzIHBheWVlID0gbXNnLnNlbmRlcjsNCiAgICB1aW50IHBheW1lbnQgPSBwYXltZW50c1twYXllZV07DQogICAgDQogICAgaWYgKHBheW1lbnQgPT0gMCkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KICAgIGlmICh0aGlzLmJhbGFuY2UgPCBwYXltZW50KSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgcGF5bWVudHNbcGF5ZWVdID0gMDsNCiAgICBpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7DQogIH0NCn0NCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7DQogIA0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsNCiAgDQogIC8qDQogICAqIEZpeCBmb3IgdGhlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrICANCiAgKi8NCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgew0KICAgICBpZihtc2cuZGF0YS5sZW5ndGggPCBzaXplICsgNCkgew0KICAgICAgIHRocm93Ow0KICAgICB9DQogICAgIF87DQogIH0NCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7DQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsNCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogIH0NCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsNCiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCiAgfQ0KfQ0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgew0KICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0DQogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93Ow0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsNCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7DQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgfQ0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSB7DQogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2ANCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdA0KICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOg0KICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQ0KICAgIGlmICgoX3ZhbHVlICE9IDApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgdGhyb3c7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogIH0NCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgew0KICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICB9DQp9DQovKioNCiAqICBHYW1lUGxheWVyQ29pbiB0b2tlbiBjb250cmFjdC4gSW1wbGVtZW50cw0KICovDQpjb250cmFjdCBHYW1lUGxheWVyQ29pbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsNCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIkdhbWVQbGF5ZXJDb2luIjsNCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiR1BDIjsNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsNCiAgLy8gQ29uc3RydWN0b3INCiAgZnVuY3Rpb24gR2FtZVBsYXllckNvaW4oKSB7DQogICAgICB0b3RhbFN1cHBseSA9IDEwMCAqICgxMCoqNikgKiAoMTAgKiogZGVjaW1hbHMpOyAvLyAxMDAgbWlsbGlvbiANCiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gdG90YWxTdXBwbHk7IC8vIFNlbmQgYWxsIHRva2VucyB0byBvd25lcg0KICB9DQogIC8qKg0KICAgKiAgQnVybiBhd2F5IHRoZSBzcGVjaWZpZWQgYW1vdW50IG9mIEdhbWVQbGF5ZXJDb2luIHRva2Vucw0KICAgKi8NCiAgZnVuY3Rpb24gYnVybih1aW50IF92YWx1ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOw0KICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuc3ViKF92YWx1ZSk7DQogICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMHgwLCBfdmFsdWUpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQp9DQovKg0KICBDcm93ZHNhbGUgU21hcnQgQ29udHJhY3QgZm9yIHRoZSBnYW1lcGxheWVyY29pbi5jb20gcHJvamVjdA0KICBUaGlzIHNtYXJ0IGNvbnRyYWN0IGNvbGxlY3RzIEVUSCwgYW5kIGluIHJldHVybiBlbWl0cyBHYW1lUGxheWVyQ29pbiB0b2tlbnMgdG8gdGhlIGJhY2tlcnMNCiovDQpjb250cmFjdCBDcm93ZHNhbGUgaXMgUGF1c2FibGUsIFB1bGxQYXltZW50IHsNCiAgICANCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgICBzdHJ1Y3QgQmFja2VyIHsNCiAgICAgICAgdWludCB3ZWlSZWNlaXZlZDsgLy8gQW1vdW50IG9mIEV0aGVyIGdpdmVuDQogICAgICAgIHVpbnQgY29pblNlbnQ7DQogICAgfQ0KICAgIC8qDQogICAgKiBDb25zdGFudHMNCiAgICAqLw0KICAgIC8qIE1pbmltdW0gbnVtYmVyIG9mIEdhbWVQbGF5ZXJDb2lucyB0byBzZWxsICovDQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0NBUCA9IDUgKiAoMTAqKjYpICogKDEwICoqIDE4KTsgLy8gMTAgbWlsbGlvbiBHYW1lUGxheWVyQ29pbiAsIGFib3V0IDI1MDAgRVRIDQogICAgLyogTWF4aW11bSBudW1iZXIgb2YgR2FtZVBsYXllckNvaW5zIHRvIHNlbGwgKi8NCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gNzAgKiAoMTAqKjYpICogKDEwICoqIDE4KTsgLy8gNzAgbWlsbGlvbiBHYW1lUGxheWVyQ29pbiAsIGFib3V0IDM1MDAwIEVUSA0KICAgIC8qIE1pbmltdW0gYW1vdW50IHRvIGludmVzdCAqLw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfRVRIRVIgPSAxMDAgZmlubmV5Ow0KICAgIC8qIENyb3dkc2FsZSBwZXJpb2QgKi8NCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgQ1JPV0RTQUxFX1BFUklPRCA9IDkwIGRheXM7DQogICAgLyogTnVtYmVyIG9mIEdhbWVQbGF5ZXJDb2luIHBlciBFdGhlciAqLw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSID0gMjAwMCAqICgxMCAqKiAxOCk7IC8vIDIsMDAwIEdhbWVQbGF5ZXJDb2luIA0KICAgIC8qDQogICAgKiBWYXJpYWJsZXMNCiAgICAqLw0KICAgIC8qIEdhbWVQbGF5ZXJjb2luIGNvbnRyYWN0IHJlZmVyZW5jZSAqLw0KICAgIEdhbWVQbGF5ZXJDb2luIHB1YmxpYyBjb2luOw0KICAgIC8qIE11bHRpc2lnIGNvbnRyYWN0IHRoYXQgd2lsbCByZWNlaXZlIHRoZSBFdGhlciAqLw0KICAgIGFkZHJlc3MgcHVibGljIG11bHRpc2lnRXRoZXI7DQogICAgLyogTnVtYmVyIG9mIEV0aGVyIHJlY2VpdmVkICovDQogICAgdWludCBwdWJsaWMgZXRoZXJSZWNlaXZlZDsNCiAgICAvKiBOdW1iZXIgb2YgR2FtZVBsYXllcmNvaW5zIHNlbnQgdG8gRXRoZXIgY29udHJpYnV0b3JzICovDQogICAgdWludCBwdWJsaWMgY29pblNlbnRUb0V0aGVyOw0KICAgIC8qIENyb3dkc2FsZSBzdGFydCB0aW1lICovDQogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOw0KICAgIC8qIENyb3dkc2FsZSBlbmQgdGltZSAqLw0KICAgIHVpbnQgcHVibGljIGVuZFRpbWU7DQogICAgLyogSXMgY3Jvd2RzYWxlIHN0aWxsIG9uIGdvaW5nICovDQogICAgYm9vbCBwdWJsaWMgY3Jvd2RzYWxlQ2xvc2VkOw0KICAgIC8qIEJhY2tlcnMgRXRoZXIgaW5kZXhlZCBieSB0aGVpciBFdGhlcmV1bSBhZGRyZXNzICovDQogICAgbWFwcGluZyhhZGRyZXNzID0+IEJhY2tlcikgcHVibGljIGJhY2tlcnM7DQogICAgLyoNCiAgICAqIE1vZGlmaWVycw0KICAgICovDQogICAgbW9kaWZpZXIgbWluQ2FwTm90UmVhY2hlZCgpIHsNCiAgICAgICAgaWYgKChub3cgPCBlbmRUaW1lKSB8fCBjb2luU2VudFRvRXRoZXIgPj0gTUlOX0NBUCApIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCiAgICBtb2RpZmllciByZXNwZWN0VGltZUZyYW1lKCkgew0KICAgICAgICBpZiAoKG5vdyA8IHN0YXJ0VGltZSkgfHwgKG5vdyA+IGVuZFRpbWUgKSkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KICAgIC8qDQogICAgICogRXZlbnQNCiAgICAqLw0KICAgIGV2ZW50IExvZ1JlY2VpdmVkRVRIKGFkZHJlc3MgYWRkciwgdWludCB2YWx1ZSk7DQogICAgZXZlbnQgTG9nQ29pbnNFbWl0ZWQoYWRkcmVzcyBpbmRleGVkIGZyb20sIHVpbnQgYW1vdW50KTsNCiAgICAvKg0KICAgICAqIENvbnN0cnVjdG9yDQogICAgKi8NCiAgICBmdW5jdGlvbiBDcm93ZHNhbGUoYWRkcmVzcyBfZ2FtZVBsYXllckNvaW5BZGRyZXNzLCBhZGRyZXNzIF90bykgew0KICAgICAgICBjb2luID0gR2FtZVBsYXllckNvaW4oX2dhbWVQbGF5ZXJDb2luQWRkcmVzcyk7DQogICAgICAgIG11bHRpc2lnRXRoZXIgPSBfdG87DQogICAgfQ0KICAgIC8qIA0KICAgICAqIFRoZSBmYWxsYmFjayBmdW5jdGlvbiBjb3JyZXNwb25kcyB0byBhIGRvbmF0aW9uIGluIEVUSA0KICAgICAqLw0KICAgIGZ1bmN0aW9uKCkgc3RvcEluRW1lcmdlbmN5IHJlc3BlY3RUaW1lRnJhbWUgcGF5YWJsZSB7DQogICAgICAgIHJlY2VpdmVFVEgobXNnLnNlbmRlcik7DQogICAgfQ0KICAgIC8qIA0KICAgICAqIFRvIGNhbGwgdG8gc3RhcnQgdGhlIGNyb3dkc2FsZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHN0YXJ0KCkgb25seU93bmVyIHsNCiAgICAgICAgaWYgKHN0YXJ0VGltZSAhPSAwKSB0aHJvdzsgLy8gQ3Jvd2RzYWxlIHdhcyBhbHJlYWR5IHN0YXJ0ZWQNCiAgICAgICAgc3RhcnRUaW1lID0gbm93IDsNCiAgICAgICAgZW5kVGltZSA9ICBub3cgKyBDUk9XRFNBTEVfUEVSSU9EOw0KICAgIH0NCiAgICAvKg0KICAgICAqICBSZWNlaXZlcyBhIGRvbmF0aW9uIGluIEV0aGVyDQogICAgKi8NCiAgICBmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IE1JTl9JTlZFU1RfRVRIRVIpIHRocm93OyAvLyBEb24ndCBhY2NlcHQgZnVuZGluZyB1bmRlciBhIHByZWRlZmluZWQgdGhyZXNob2xkDQogICAgICAgIA0KICAgICAgICB1aW50IGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSKS5kaXYoMSBldGhlcikpOyAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgR2FtZVBsYXllckNvaW4gdG8gc2VuZA0KICAgICAgICBpZiAoY29pblRvU2VuZC5hZGQoY29pblNlbnRUb0V0aGVyKSA+IE1BWF9DQVApIHRocm93OyAgICANCiAgICAgICAgQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbYmVuZWZpY2lhcnldOw0KICAgICAgICBjb2luLnRyYW5zZmVyKGJlbmVmaWNpYXJ5LCBjb2luVG9TZW5kKTsgLy8gVHJhbnNmZXIgR2FtZXBsYXllcmNvaW5zIHJpZ2h0IG5vdyANCiAgICAgICAgYmFja2VyLmNvaW5TZW50ID0gYmFja2VyLmNvaW5TZW50LmFkZChjb2luVG9TZW5kKTsNCiAgICAgICAgYmFja2VyLndlaVJlY2VpdmVkID0gYmFja2VyLndlaVJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcgZm9yIHRoaXMgYmFja2VyICAgIA0KICAgICAgICBldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nDQogICAgICAgIGNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQoY29pblRvU2VuZCk7DQogICAgICAgIC8vIFNlbmQgZXZlbnRzDQogICAgICAgIExvZ0NvaW5zRW1pdGVkKG1zZy5zZW5kZXIgLGNvaW5Ub1NlbmQpOw0KICAgICAgICBMb2dSZWNlaXZlZEVUSChiZW5lZmljaWFyeSwgZXRoZXJSZWNlaXZlZCk7IA0KICAgIH0NCiAgICANCiAgICAvKg0KICAgICAqQ29tcHV0ZSB0aGUgR2FtZVBsYXllcmNvaW4gYm9udXMgYWNjb3JkaW5nIHRvIHRoZSBpbnZlc3RtZW50IHBlcmlvZA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGJvbnVzKHVpbnQgYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIGlmIChub3cgPCBzdGFydFRpbWUuYWRkKDcgZGF5cykpIHJldHVybiBhbW91bnQuYWRkKGFtb3VudC5kaXYoNSkpOyAgIC8vIGJvbnVzIDIwJQ0KICAgICAgICBpZiAobm93ID49IHN0YXJ0VGltZS5hZGQoNyBkYXlzKSAmJiBub3cgPCBzdGFydFRpbWUuYWRkKDE0IGRheXMpKSByZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDEwKSk7ICAgLy8gYm9udXMgMTAlDQogICAgICAgIGlmIChub3cgPj0gc3RhcnRUaW1lLmFkZCgxNCBkYXlzKSAmJiBub3cgPCBzdGFydFRpbWUuYWRkKDIxIGRheXMpKSByZXR1cm4gYW1vdW50LmFkZChhbW91bnQuZGl2KDIwKSk7ICAgLy8gYm9udXMgNSUNCiAgICAgICAgcmV0dXJuIGFtb3VudDsNCiAgICB9DQogICAgLyogIA0KICAgICAqIEZpbmFsaXplIHRoZSBjcm93ZHNhbGUsIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIHJlZnVuZCBwZXJpb2QNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGZpbmFsaXplKCkgb25seU93bmVyIHB1YmxpYyB7DQogICAgICAgIGlmIChub3cgPCBlbmRUaW1lKSB7IC8vIENhbm5vdCBmaW5hbGlzZSBiZWZvcmUgQ1JPV0RTQUxFX1BFUklPRCBvciBiZWZvcmUgc2VsbGluZyBhbGwgY29pbnMNCiAgICAgICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPT0gTUFYX0NBUCkgew0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoY29pblNlbnRUb0V0aGVyIDwgTUlOX0NBUCAmJiBub3cgPCBlbmRUaW1lICsgMTUgZGF5cykgdGhyb3c7IC8vIElmIE1JTl9DQVAgaXMgbm90IHJlYWNoZWQgZG9ub3JzIGhhdmUgMTVkYXlzIHRvIGdldCByZWZ1bmQgYmVmb3JlIHdlIGNhbiBmaW5hbGlzZQ0KICAgICAgICBpZiAoIW11bHRpc2lnRXRoZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsgLy8gTW92ZSB0aGUgcmVtYWluaW5nIEV0aGVyIHRvIHRoZSBtdWx0aXNpZyBhZGRyZXNzDQogICAgICAgIA0KICAgICAgICB1aW50IHJlbWFpbnMgPSBjb2luLmJhbGFuY2VPZih0aGlzKTsNCiAgICAgICAgaWYgKHJlbWFpbnMgPiAwKSB7IC8vIEJ1cm4gdGhlIHJlc3Qgb2YgR2FtZVBsYXllcmNvaW5zDQogICAgICAgICAgICBpZiAoIWNvaW4uYnVybihyZW1haW5zKSkgdGhyb3cgOw0KICAgICAgICB9DQogICAgICAgIGNyb3dkc2FsZUNsb3NlZCA9IHRydWU7DQogICAgfQ0KICAgIC8qICANCiAgICAqIEZhaWxzYWZlIGRyYWluDQogICAgKi8NCiAgICBmdW5jdGlvbiBkcmFpbigpIG9ubHlPd25lciB7DQogICAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB0aHJvdzsNCiAgICB9DQogICAgLyoqDQogICAgICogQWxsb3cgdG8gY2hhbmdlIHRoZSB0ZWFtIG11bHRpc2lnIGFkZHJlc3MgaW4gdGhlIGNhc2Ugb2YgZW1lcmdlbmN5Lg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHNldE11bHRpc2lnKGFkZHJlc3MgYWRkcikgb25seU93bmVyIHB1YmxpYyB7DQogICAgICAgIGlmIChhZGRyID09IGFkZHJlc3MoMCkpIHRocm93Ow0KICAgICAgICBtdWx0aXNpZ0V0aGVyID0gYWRkcjsNCiAgICB9DQogICAgLyoqDQogICAgICogTWFudWFsbHkgYmFjayBHYW1lUGxheWVyQ29pbnMgb3duZXIgYWRkcmVzcy4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBiYWNrR2FtZVBsYXllckNvaW5Pd25lcigpIG9ubHlPd25lciBwdWJsaWMgew0KICAgICAgICBjb2luLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsNCiAgICB9DQogICAgLyoqDQogICAgICogVHJhbnNmZXIgcmVtYWlucyB0byBvd25lciBpbiBjYXNlIGlmIGltcG9zc2libGUgdG8gZG8gbWluIGludmVzdA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldFJlbWFpbkNvaW5zKCkgb25seU93bmVyIHB1YmxpYyB7DQogICAgICAgIHZhciByZW1haW5zID0gTUFYX0NBUCAtIGNvaW5TZW50VG9FdGhlcjsNCiAgICAgICAgdWludCBtaW5Db2luc1RvU2VsbCA9IGJvbnVzKE1JTl9JTlZFU1RfRVRIRVIubXVsKENPSU5fUEVSX0VUSEVSKSAvICgxIGV0aGVyKSk7DQogICAgICAgIGlmKHJlbWFpbnMgPiBtaW5Db2luc1RvU2VsbCkgdGhyb3c7DQogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW293bmVyXTsNCiAgICAgICAgY29pbi50cmFuc2Zlcihvd25lciwgcmVtYWlucyk7IC8vIFRyYW5zZmVyIEdhbWVQbGF5ZXJDb2lucyByaWdodCBub3cgDQogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQocmVtYWlucyk7DQogICAgICAgIGNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQocmVtYWlucyk7DQogICAgICAgIC8vIFNlbmQgZXZlbnRzDQogICAgICAgIExvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOw0KICAgICAgICBMb2dSZWNlaXZlZEVUSChvd25lciwgZXRoZXJSZWNlaXZlZCk7IA0KICAgIH0NCiAgICAvKiANCiAgICAgKiBXaGVuIE1JTl9DQVAgaXMgbm90IHJlYWNoOg0KICAgICAqIDEpIGJhY2tlciBjYWxsIHRoZSAiYXBwcm92ZSIgZnVuY3Rpb24gb2YgdGhlIEdhbWVQbGF5ZXJDb2luIHRva2VuIGNvbnRyYWN0IHdpdGggdGhlIGFtb3VudCBvZiBhbGwgR2FtZVBsYXllckNvaW5zIHRoZXkgZ290IGluIG9yZGVyIHRvIGJlIHJlZnVuZA0KICAgICAqIDIpIGJhY2tlciBjYWxsIHRoZSAicmVmdW5kIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHdpdGggdGhlIHNhbWUgYW1vdW50IG9mIEdhbWVQbGF5ZXJzDQogICAgICogMykgYmFja2VyIGNhbGwgdGhlICJ3aXRoZHJhd1BheW1lbnRzIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHRvIGdldCBhIHJlZnVuZCBpbiBFVEgNCiAgICAgKi8NCiAgICBmdW5jdGlvbiByZWZ1bmQodWludCBfdmFsdWUpIG1pbkNhcE5vdFJlYWNoZWQgcHVibGljIHsNCiAgICAgICAgaWYgKF92YWx1ZSAhPSBiYWNrZXJzW21zZy5zZW5kZXJdLmNvaW5TZW50KSB0aHJvdzsgLy8gY29tcGFyZSB2YWx1ZSBmcm9tIGJhY2tlciBiYWxhbmNlDQogICAgICAgIGNvaW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF92YWx1ZSk7IC8vIGdldCB0aGUgdG9rZW4gYmFjayB0byB0aGUgY3Jvd2RzYWxlIGNvbnRyYWN0DQogICAgICAgIGlmICghY29pbi5idXJuKF92YWx1ZSkpIHRocm93IDsgLy8gdG9rZW4gc2VudCBmb3IgcmVmdW5kIGFyZSBidXJudA0KICAgICAgICB1aW50IEVUSFRvU2VuZCA9IGJhY2tlcnNbbXNnLnNlbmRlcl0ud2VpUmVjZWl2ZWQ7DQogICAgICAgIGJhY2tlcnNbbXNnLnNlbmRlcl0ud2VpUmVjZWl2ZWQ9MDsNCiAgICAgICAgaWYgKEVUSFRvU2VuZCA+IDApIHsNCiAgICAgICAgICAgIGFzeW5jU2VuZChtc2cuc2VuZGVyLCBFVEhUb1NlbmQpOyAvLyBwdWxsIHBheW1lbnQgdG8gZ2V0IHJlZnVuZCBpbiBFVEgNCiAgICAgICAgfQ0KICAgIH0NCn0='