base 64 content
base64ledger
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBPd25lZCB7DQogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQoNCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9hZGRyKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAoX2FkZHIgPT0gMHgwKSB0aHJvdzsNCiAgICAgICAgb3duZXIgPSBfYWRkcjsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KfQ0KDQpjb250cmFjdCBNdXRleCBpcyBPd25lZCB7DQogICAgYm9vbCBsb2NrZWQgPSBmYWxzZTsNCiAgICBtb2RpZmllciBtdXRleGVkIHsNCiAgICAgICAgaWYgKGxvY2tlZCkgdGhyb3c7DQogICAgICAgIGxvY2tlZCA9IHRydWU7DQogICAgICAgIF87DQogICAgICAgIGxvY2tlZCA9IGZhbHNlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHVuTXV0ZXgoKSBvbmx5T3duZXIgew0KICAgICAgICBsb2NrZWQgPSBmYWxzZTsNCiAgICB9DQp9DQoNCg0KY29udHJhY3QgUmVudGFsIGlzIE93bmVkIHsNCiAgICBmdW5jdGlvbiBSZW50YWwoYWRkcmVzcyBfb3duZXIpIHsNCiAgICAgICAgaWYgKF9vd25lciA9PSAweDApIHRocm93Ow0KICAgICAgICBvd25lciA9IF9vd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBvZmZlcihhZGRyZXNzIGZyb20sIHVpbnQgbnVtKSB7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbGFpbUJhbGFuY2UoYWRkcmVzcykgcmV0dXJucyh1aW50KSB7DQogICAgICAgIHJldHVybiAwOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGV4ZWMoYWRkcmVzcyBkZXN0KSBvbmx5T3duZXIgew0KICAgICAgICBpZiAoIWRlc3QuY2FsbChtc2cuZGF0YSkpIHRocm93Ow0KICAgIH0NCn0NCg0KY29udHJhY3QgVG9rZW4gaXMgT3duZWQsIE11dGV4IHsNCiAgICB1aW50IE9ORSA9IDEwKio4Ow0KICAgIHVpbnQgcHJpY2UgPSA1MDAwOw0KICAgIExlZGdlciBsZWRnZXI7DQogICAgUmVudGFsIHJlbnRhbENvbnRyYWN0Ow0KICAgIHVpbnQ4IHJvbGxPdmVyVGltZSA9IDQ7DQogICAgdWludDggc3RhcnRUaW1lID0gODsNCiAgICBib29sIGxpdmUgPSBmYWxzZTsNCiAgICBhZGRyZXNzIGNsdWI7DQogICAgdWludCBsb2NrZWRTdXBwbHkgPSAwOw0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7IA0KICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOyAgICAgDQogICAgc3RyaW5nIHB1YmxpYyB2ZXJzaW9uID0gJzAuMSc7ICANCiAgICBib29sIHRyYW5zZmVyc09uID0gZmFsc2U7DQoNCg0KDQogICAgZnVuY3Rpb24gVG9rZW4oYWRkcmVzcyBfb3duZXIsIHN0cmluZyBfdG9rZW5OYW1lLCB1aW50OCBfZGVjaW1hbHMsIHN0cmluZyBfc3ltYm9sLCBhZGRyZXNzIF9sZWRnZXIsIGFkZHJlc3MgX3JlbnRhbCkgew0KICAgICAgICBpZiAoX293bmVyID09IDB4MCkgdGhyb3c7DQogICAgICAgIG93bmVyID0gX293bmVyOw0KDQogICAgICAgIG5hbWUgPSBfdG9rZW5OYW1lOw0KICAgICAgICBkZWNpbWFscyA9IF9kZWNpbWFsczsNCiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsNCiAgICAgICAgT05FID0gMTAqKnVpbnQoZGVjaW1hbHMpOw0KICAgICAgICBsZWRnZXIgPSBMZWRnZXIoX2xlZGdlcik7DQogICAgICAgIHJlbnRhbENvbnRyYWN0ID0gUmVudGFsKF9yZW50YWwpOw0KICAgIH0NCg0KICAgIC8qDQogICAgKglCb29ra2VlcGluZyBhbmQgQWRtaW4gRnVuY3Rpb25zDQogICAgKi8NCg0KICAgIGV2ZW50IExlZGdlclVwZGF0ZWQoYWRkcmVzcyxhZGRyZXNzKTsNCg0KICAgIGZ1bmN0aW9uIGNoYW5nZUNsdWIoYWRkcmVzcyBfYWRkcikgb25seU93bmVyIHsNCiAgICAgICAgaWYgKF9hZGRyID09IDB4MCkgdGhyb3c7DQoNCiAgICAgICAgY2x1YiA9IF9hZGRyOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoYW5nZVByaWNlKHVpbnQgX251bSkgb25seU93bmVyIHsNCiAgICAgICAgcHJpY2UgPSBfbnVtOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludCBhLCB1aW50IGIpIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgaWYgKChhICsgYikgPCBhKSB0aHJvdzsNCiAgICAgICAgcmV0dXJuIChhICsgYik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2hhbmdlTGVkZ2VyKGFkZHJlc3MgX2FkZHIpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChfYWRkciA9PSAweDApIHRocm93Ow0KDQogICAgICAgIExlZGdlclVwZGF0ZWQobXNnLnNlbmRlciwgX2FkZHIpOw0KICAgICAgICBsZWRnZXIgPSBMZWRnZXIoX2FkZHIpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoYW5nZVJlbnRhbChhZGRyZXNzIF9hZGRyKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAoX2FkZHIgPT0gMHgwKSB0aHJvdzsNCiAgICAgICAgcmVudGFsQ29udHJhY3QgPSBSZW50YWwoX2FkZHIpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoYW5nZVRpbWVzKHVpbnQ4IF9yb2xsT3ZlciwgdWludDggX3N0YXJ0KSBvbmx5T3duZXIgew0KICAgICAgICByb2xsT3ZlclRpbWUgPSBfcm9sbE92ZXI7DQogICAgICAgIHN0YXJ0VGltZSA9IF9zdGFydDsNCiAgICB9DQoNCiAgICAvKg0KICAgICogTG9ja2luZyBpcyBhIGZlYXR1cmUgdGhhdCB0dXJucyBhIHVzZXIncyBiYWxhbmNlcyBpbnRvDQogICAgKiB1bi1pc3N1ZWQgdG9rZW5zLCB0YWtpbmcgdGhlbSBvdXQgb2YgYW4gYWNjb3VudCBhbmQgcmVkdWNpbmcgdGhlIHN1cHBseS4NCiAgICAqIERpbHV0aW5nIGlzIHNvIG5hbWVkIHRvIHJlbWluZCB0aGUgY2FsbGVyIHRoYXQgdGhleSBhcmUgY2hhbmdpbmcgdGhlIG1vbmV5IHN1cHBseS4NCiAgICAgICAgKi8NCg0KICAgIGZ1bmN0aW9uIGxvY2soYWRkcmVzcyBfc2VpemVBZGRyKSBvbmx5T3duZXIgbXV0ZXhlZCB7DQogICAgICAgIHVpbnQgbXlCYWxhbmNlID0gbGVkZ2VyLmJhbGFuY2VPZihfc2VpemVBZGRyKTsNCg0KICAgICAgICBsb2NrZWRTdXBwbHkgKz0gbXlCYWxhbmNlOw0KICAgICAgICBsZWRnZXIuc2V0QmFsYW5jZShfc2VpemVBZGRyLCAwKTsNCiAgICB9DQoNCiAgICBldmVudCBEaWx1dGlvbihhZGRyZXNzLCB1aW50KTsNCg0KICAgIGZ1bmN0aW9uIGRpbHV0ZShhZGRyZXNzIF9kZXN0QWRkciwgdWludCBhbW91bnQpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChhbW91bnQgPiBsb2NrZWRTdXBwbHkpIHRocm93Ow0KDQogICAgICAgIERpbHV0aW9uKF9kZXN0QWRkciwgYW1vdW50KTsNCg0KICAgICAgICBsb2NrZWRTdXBwbHkgLT0gYW1vdW50Ow0KDQogICAgICAgIHVpbnQgY3VyQmFsYW5jZSA9IGxlZGdlci5iYWxhbmNlT2YoX2Rlc3RBZGRyKTsNCiAgICAgICAgY3VyQmFsYW5jZSA9IHNhZmVBZGQoYW1vdW50LCBjdXJCYWxhbmNlKTsNCiAgICAgICAgbGVkZ2VyLnNldEJhbGFuY2UoX2Rlc3RBZGRyLCBjdXJCYWxhbmNlKTsNCiAgICB9DQoNCiAgICAvKiANCiAgICAgKiBDcm93ZHNhbGUgLS0gDQogICAgICoNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBjb21wbGV0ZUNyb3dkc2FsZSgpIG9ubHlPd25lciB7DQogICAgICAgIC8vIExvY2sgdW5zb2xkIHRva2Vucw0KICAgICAgICAvLyBhbGxvdyB0cmFuc2ZlcnMgZm9yIGFyYml0cmFyeSBvd25lcnMNCiAgICAgICAgdHJhbnNmZXJzT24gPSB0cnVlOw0KICAgICAgICBsb2NrKG93bmVyKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwYXVzZVRyYW5zZmVycygpIG9ubHlPd25lciB7DQogICAgICAgIHRyYW5zZmVyc09uID0gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVzdW1lVHJhbnNmZXJzKCkgb25seU93bmVyIHsNCiAgICAgICAgdHJhbnNmZXJzT24gPSB0cnVlOw0KICAgIH0NCg0KICAgIC8qDQogICAgKiBSZW50aW5nIC0tIExvZ2ljIFRCRCBsYXRlci4gRm9yIG5vdywgd2UgdHJ1c3QgdGhlIHJlbnRhbCBjb250cmFjdA0KICAgICogdG8gbWFuYWdlIGV2ZXJ5dGhpbmcgYWJvdXQgdGhlIHJlbnRhbHMsIGluY2x1ZGluZyBib29ra2VlcGluZyBvbiBlYXJuaW5ncw0KICAgICogYW5kIHJldHVybmluZyB0b2tlbnMuDQogICAgKi8NCg0KICAgIGZ1bmN0aW9uIHJlbnRPdXQodWludCBudW0pIHsNCiAgICAgICAgaWYgKGxlZGdlci5iYWxhbmNlT2YobXNnLnNlbmRlcikgPCBudW0pIHRocm93Ow0KICAgICAgICByZW50YWxDb250cmFjdC5vZmZlcihtc2cuc2VuZGVyLCBudW0pOw0KICAgICAgICBsZWRnZXIudG9rZW5UcmFuc2Zlcihtc2cuc2VuZGVyLCByZW50YWxDb250cmFjdCwgbnVtKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbGFpbVVucmVudGVkKCkgeyAgDQogICAgICAgIHVpbnQgYW1vdW50ID0gcmVudGFsQ29udHJhY3QuY2xhaW1CYWxhbmNlKG1zZy5zZW5kZXIpOyAvLyB0aGlzIHNob3VsZCByZWR1Y2Ugc2VuZGVyJ3MgY2xhaW1hYmxlQmFsYW5jZSB0byAwDQoNCiAgICAgICAgbGVkZ2VyLnRva2VuVHJhbnNmZXIocmVudGFsQ29udHJhY3QsIG1zZy5zZW5kZXIsIGFtb3VudCk7DQogICAgfQ0KDQogICAgLyoNCiAgICAqIEJ1cm5pbmcgLS0gV2UgYWxsb3cgYW55IHVzZXIgdG8gYnVybiB0b2tlbnMuDQogICAgKg0KICAgICAqLw0KDQogICAgZnVuY3Rpb24gYnVybih1aW50IF9hbW91bnQpIHsNCiAgICAgICAgdWludCBiYWxhbmNlID0gbGVkZ2VyLmJhbGFuY2VPZihtc2cuc2VuZGVyKTsNCiAgICAgICAgaWYgKF9hbW91bnQgPiBiYWxhbmNlKSB0aHJvdzsNCg0KICAgICAgICBsZWRnZXIuc2V0QmFsYW5jZShtc2cuc2VuZGVyLCBiYWxhbmNlIC0gX2Ftb3VudCk7DQogICAgfQ0KDQogICAgLyoNCiAgICBFbnRyeQ0KICAgICovDQogICAgZnVuY3Rpb24gY2hlY2tJbih1aW50IF9udW1DaGVja2lucykgcmV0dXJucyhib29sKSB7DQogICAgICAgIGludCBuZWVkZWQgPSBpbnQocHJpY2UgKiBPTkUqIF9udW1DaGVja2lucyk7DQogICAgICAgIGlmIChpbnQobGVkZ2VyLmJhbGFuY2VPZihtc2cuc2VuZGVyKSkgPiBuZWVkZWQpIHsNCiAgICAgICAgICAgIGxlZGdlci5jaGFuZ2VVc2VkKG1zZy5zZW5kZXIsIG5lZWRlZCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLy8gRVJDMjAgU3VwcG9ydC4gVGhpcyBjb3VsZCBhbHNvIHVzZSB0aGUgZmFsbGJhY2sgYnV0DQogICAgLy8gSSBwcmVmZXIgdGhlIGNvbnRyb2wgZm9yIG5vdy4NCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MsIGFkZHJlc3MsIHVpbnQpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MsIGFkZHJlc3MsIHVpbnQpOw0KDQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGxlZGdlci50b3RhbFN1cHBseSgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIHJldHVybnMoYm9vbCkgew0KICAgICAgICBpZiAoIXRyYW5zZmVyc09uICYmIG1zZy5zZW5kZXIgIT0gb3duZXIpIHJldHVybiBmYWxzZTsNCiAgICAgICAgaWYgKCEgbGVkZ2VyLnRva2VuVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfYW1vdW50KSkgeyByZXR1cm4gZmFsc2U7IH0NCg0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBpZiAoIXRyYW5zZmVyc09uICYmIG1zZy5zZW5kZXIgIT0gb3duZXIpIHJldHVybiBmYWxzZTsNCiAgICAgICAgaWYgKCEgbGVkZ2VyLnRva2VuVHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIF9mcm9tLCBfdG8sIF9hbW91bnQpICkgeyByZXR1cm4gZmFsc2U7fQ0KDQogICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bykgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7DQogICAgICAgIHJldHVybiBsZWRnZXIuYWxsb3dhbmNlKF9mcm9tLCBfdG8pOyANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIGlmICggbGVkZ2VyLnRva2VuQXBwcm92ZShtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKSApIHsNCiAgICAgICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGxlZGdlci5iYWxhbmNlT2YoX2FkZHIpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgTGVkZ2VyIGlzIE93bmVkIHsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgdXNlZFRvZGF5Ow0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBzZWVuSGVyZTsNCiAgICBhZGRyZXNzW10gcHVibGljIHNlZW5IZXJlQTsNCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCiAgICBhZGRyZXNzIHRva2VuOw0KICAgIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsNCg0KICAgIGZ1bmN0aW9uIExlZGdlcihhZGRyZXNzIF9vd25lciwgdWludCBfcHJlTWluZWQsIHVpbnQgT05FKSB7DQogICAgICAgIGlmIChfb3duZXIgPT0gMHgwKSB0aHJvdzsNCiAgICAgICAgb3duZXIgPSBfb3duZXI7DQoNCiAgICAgICAgc2VlbkhlcmVbX293bmVyXSA9IHRydWU7DQogICAgICAgIHNlZW5IZXJlQS5wdXNoKF9vd25lcik7DQoNCiAgICAgICAgdG90YWxTdXBwbHkgPSBfcHJlTWluZWQgKk9ORTsNCiAgICAgICAgYmFsYW5jZXNbX293bmVyXSA9IHRvdGFsU3VwcGx5Ow0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG9ubHlUb2tlbiB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IHRva2VuKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5VG9rZW5Pck93bmVyIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gdG9rZW4gJiYgbXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQoNCiAgICBmdW5jdGlvbiB0b2tlblRyYW5zZmVyKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IGFtb3VudCkgb25seVRva2VuIHJldHVybnMoYm9vbCkgew0KICAgICAgICBpZiAoYW1vdW50ID4gYmFsYW5jZXNbX2Zyb21dKSByZXR1cm4gZmFsc2U7DQogICAgICAgIGlmICgoYmFsYW5jZXNbX3RvXSArIGFtb3VudCkgPCBiYWxhbmNlc1tfdG9dKSByZXR1cm4gZmFsc2U7DQogICAgICAgIGlmIChhbW91bnQgPT0gMCkgeyByZXR1cm4gZmFsc2U7IH0NCg0KICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gYW1vdW50Ow0KICAgICAgICBiYWxhbmNlc1tfdG9dICs9IGFtb3VudDsNCg0KICAgICAgICBpZiAoc2VlbkhlcmVbX3RvXSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgc2VlbkhlcmVBLnB1c2goX3RvKTsNCiAgICAgICAgICAgIHNlZW5IZXJlW190b10gPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdG9rZW5UcmFuc2ZlckZyb20oYWRkcmVzcyBfc2VuZGVyLCBhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBhbW91bnQpIG9ubHlUb2tlbiByZXR1cm5zKGJvb2wpIHsNCiAgICAgICAgaWYgKGFsbG93ZWRbX2Zyb21dW19zZW5kZXJdIDw9IGFtb3VudCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICBpZiAoYW1vdW50ID4gYmFsYW5jZU9mKF9mcm9tKSkgcmV0dXJuIGZhbHNlOw0KICAgICAgICBpZiAoYW1vdW50ID09IDApIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBpZiAoKGJhbGFuY2VzW190b10gKyBhbW91bnQpIDwgYW1vdW50KSByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IGFtb3VudDsNCiAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBhbW91bnQ7DQogICAgICAgIGFsbG93ZWRbX2Zyb21dW19zZW5kZXJdIC09IGFtb3VudDsNCg0KICAgICAgICBpZiAoc2VlbkhlcmVbX3RvXSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgc2VlbkhlcmVBLnB1c2goX3RvKTsNCiAgICAgICAgICAgIHNlZW5IZXJlW190b10gPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQoNCiAgICBmdW5jdGlvbiBjaGFuZ2VVc2VkKGFkZHJlc3MgX2FkZHIsIGludCBhbW91bnQpIG9ubHlUb2tlbiB7DQogICAgICAgIGludCBteVRvZGF5ID0gaW50KHVzZWRUb2RheVtfYWRkcl0pICsgYW1vdW50Ow0KICAgICAgICB1c2VkVG9kYXlbX2FkZHJdID0gdWludChteVRvZGF5KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZXNldFVzZWRUb2RheSh1aW50OCBzdGFydEksIHVpbnQ4IG51bVRpbWVzKSBvbmx5VG9rZW5Pck93bmVyIHJldHVybnModWludDgpIHsNCiAgICAgICAgdWludDggbnVtRGVsZXRlZDsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbnVtVGltZXMgJiYgaSArIHN0YXJ0SSA8IHNlZW5IZXJlQS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKHVzZWRUb2RheVtzZWVuSGVyZUFbaStzdGFydEldXSAhPSAwKSB7IA0KICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VkVG9kYXlbc2VlbkhlcmVBW2krc3RhcnRJXV07DQogICAgICAgICAgICAgICAgbnVtRGVsZXRlZCsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudW1EZWxldGVkOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIC8vIGRvbid0IGZvcmdldCB0byBzdWJ0cmFjdCB1c2VkVG9kYXkNCiAgICAgICAgaWYgKHVzZWRUb2RheVtfYWRkcl0gPj0gYmFsYW5jZXNbX2FkZHJdKSB7IHJldHVybiAwO30NCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19hZGRyXSAtIHVzZWRUb2RheVtfYWRkcl07DQogICAgfQ0KDQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcywgYWRkcmVzcywgdWludCk7DQoNCiAgICBmdW5jdGlvbiB0b2tlbkFwcHJvdmUoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIG9ubHlUb2tlbiByZXR1cm5zIChib29sKSB7DQogICAgICAgIGFsbG93ZWRbX2Zyb21dW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwoX2Zyb20sIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoYW5nZVRva2VuKGFkZHJlc3MgX3Rva2VuKSBvbmx5T3duZXIgew0KICAgICAgICB0b2tlbiA9IFRva2VuKF90b2tlbik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVkdWNlVG90YWxTdXBwbHkodWludCBhbW91bnQpIG9ubHlUb2tlbiB7DQogICAgICAgIGlmIChhbW91bnQgPiB0b3RhbFN1cHBseSkgdGhyb3c7DQoNCiAgICAgICAgdG90YWxTdXBwbHkgLT0gYW1vdW50OyAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRCYWxhbmNlKGFkZHJlc3MgX2FkZHIsIHVpbnQgYW1vdW50KSBvbmx5VG9rZW5Pck93bmVyIHsNCiAgICAgICAgaWYgKGJhbGFuY2VzW19hZGRyXSA9PSBhbW91bnQpIHsgcmV0dXJuOyB9DQogICAgICAgIGlmIChiYWxhbmNlc1tfYWRkcl0gPCBhbW91bnQpIHsNCiAgICAgICAgICAgIC8vIGluY3JlYXNpbmcgdG90YWxTdXBwbHkNCiAgICAgICAgICAgIHVpbnQgaW5jcmVhc2UgPSBhbW91bnQgLSBiYWxhbmNlc1tfYWRkcl07DQogICAgICAgICAgICB0b3RhbFN1cHBseSArPSBpbmNyZWFzZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIGRlY3JlYXNpbmcgdG90YWxTdXBwbHkNCiAgICAgICAgICAgIHVpbnQgZGVjcmVhc2UgPSBiYWxhbmNlc1tfYWRkcl0gLSBhbW91bnQ7DQogICAgICAgICAgICAvL1RPRE86IHNhZmVTdWINCiAgICAgICAgICAgIHRvdGFsU3VwcGx5IC09IGRlY3JlYXNlOw0KICAgICAgICB9DQogICAgICAgIGJhbGFuY2VzW19hZGRyXSA9IGFtb3VudDsNCiAgICB9DQoNCn0='