base 64 content
base64lotteryRoundFactory
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQovKioNCiAqIFZlcnkgYmFzaWMgb3duZWQvbW9ydGFsIGJvaWxlcnBsYXRlLiAgVXNlZCBmb3IgYmFzaWNhbGx5IGV2ZXJ5dGhpbmcsIGZvcg0KICogc2VjdXJpdHkvYWNjZXNzIGNvbnRyb2wgcHVycG9zZXMuDQogKi8NCmNvbnRyYWN0IE93bmVkIHsNCiAgYWRkcmVzcyBvd25lcjsNCg0KICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KDQogIC8qKg0KICAgKiBCYXNpYyBjb25zdHJ1Y3Rvci4gIFRoZSBzZW5kZXIgaXMgdGhlIG93bmVyLg0KICAgKi8NCiAgZnVuY3Rpb24gT3duZWQoKSB7DQogICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICB9DQoNCiAgLyoqDQogICAqIFRyYW5zZmVycyBvd25lcnNoaXAgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3IG93bmVyLg0KICAgKiBAcGFyYW0gbmV3T3duZXIgIFdobyBnZXRzIHRvIGluaGVyaXQgdGhpcyB0aGluZy4NCiAgICovDQogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgb3duZXIgPSBuZXdPd25lcjsNCiAgfQ0KDQogIC8qKg0KICAgKiBTaHV0cyBkb3duIHRoZSBjb250cmFjdCBhbmQgcmVtb3ZlcyBpdCBmcm9tIHRoZSBibG9ja2NoYWluIHN0YXRlLg0KICAgKiBPbmx5IGF2YWlsYWJsZSB0byB0aGUgb3duZXIuDQogICAqLw0KICBmdW5jdGlvbiBzaHV0ZG93bigpIG9ubHlPd25lciB7DQogICAgc2VsZmRlc3RydWN0KG93bmVyKTsNCiAgfQ0KDQogIC8qKg0KICAgKiBXaXRoZHJhdyBhbGwgdGhlIGZ1bmRzIGZyb20gdGhpcyBjb250cmFjdC4NCiAgICogT25seSBhdmFpbGFibGUgdG8gdGhlIG93bmVyLg0KICAgKi8NCiAgZnVuY3Rpb24gd2l0aGRyYXcoKSBvbmx5T3duZXIgew0KICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogIH0NCn0NCg0KY29udHJhY3QgTG90dGVyeVJvdW5kSW50ZXJmYWNlIHsNCiAgYm9vbCBwdWJsaWMgd2lubmluZ051bWJlcnNQaWNrZWQ7DQogIHVpbnQyNTYgcHVibGljIGNsb3NpbmdCbG9jazsNCg0KICBmdW5jdGlvbiBwaWNrVGlja2V0KGJ5dGVzNCBwaWNrcykgcGF5YWJsZTsNCiAgZnVuY3Rpb24gcmFuZG9tVGlja2V0KCkgcGF5YWJsZTsNCg0KICBmdW5jdGlvbiBwcm9vZk9mU2FsdChieXRlczMyIHNhbHQsIHVpbnQ4IE4pIGNvbnN0YW50IHJldHVybnMoYm9vbCk7DQogIGZ1bmN0aW9uIGNsb3NlR2FtZShieXRlczMyIHNhbHQsIHVpbnQ4IE4pOw0KICBmdW5jdGlvbiBjbGFpbU93bmVyRmVlKGFkZHJlc3MgcGF5b3V0KTsNCiAgZnVuY3Rpb24gd2l0aGRyYXcoKTsNCiAgZnVuY3Rpb24gc2h1dGRvd24oKTsNCiAgZnVuY3Rpb24gZGlzdHJpYnV0ZVdpbm5pbmdzKCk7DQogIGZ1bmN0aW9uIGNsYWltUHJpemUoKTsNCg0KICBmdW5jdGlvbiBwYWlkT3V0KCkgY29uc3RhbnQgcmV0dXJucyhib29sKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcik7DQp9DQoNCi8qKg0KICogVGhlIG1lYXQgb2YgdGhlIGdhbWUuICBIb2xkcyBhbGwgdGhlIHJ1bGVzIGFyb3VuZCBwaWNraW5nIG51bWJlcnMsDQogKiBhdHRlbXB0aW5nIHRvIGVzdGFibGlzaCBnb29kIHNvdXJjZXMgb2YgZW50cm9weSwgaG9sZGluZyB0aGUgcHJlLXNlbGVjdGVkDQogKiBlbnRyb3B5IHNvdXJjZXMgKHNhbHQpIGluIGEgd2F5IHRoYXQgaXMgbm90IHB1YmxpY2x5LXJldmVhbGVkLCBldGMuDQogKiBUaGUgZ2lzdCBpcyB0aGF0IHRoaXMgaXMgYSBiaXQgb2YgYSBQUk5HLCB0aGF0IGFkdmFuY2VzIGl0cyBlbnRyb3B5IGVhY2gNCiAqIHRpbWUgYSB0aWNrZXQgaXMgcGlja2VkLg0KICoNCiAqIFByb3ZpZGVzIHRoZSBtZWFucyB0byBib3RoIHBpY2sgc3BlY2lmaWMgbnVtYmVycyBvciBoYXZlIHRoZSBQUk5HIHNlbGVjdA0KICogdGhlbSBmb3IgdGhlIHRpY2tldGhvbGRlci4NCiAqDQogKiBBbHNvIGNvbnRyb2xzIHBheW91dCBvZiB3aW5uZXJzIGZvciBhIHBhcnRpY3VsYXIgcm91bmQuDQogKi8NCmNvbnRyYWN0IExvdHRlcnlSb3VuZCBpcyBMb3R0ZXJ5Um91bmRJbnRlcmZhY2UsIE93bmVkIHsNCg0KICAvKg0KICAgIENvbnN0YW50cw0KICAgKi8NCiAgLy8gcHVibGljIHZlcnNpb24gc3RyaW5nDQogIHN0cmluZyBjb25zdGFudCBWRVJTSU9OID0gJzAuMS4yJzsNCg0KICAvLyByb3VuZCBsZW5ndGgNCiAgdWludDI1NiBjb25zdGFudCBST1VORF9MRU5HVEggPSA0MzIwMDsgIC8vIGFwcHJveGltYXRlbHkgYSB3ZWVrDQoNCiAgLy8gcGF5b3V0IGZyYWN0aW9uIChpbiB0aG91c2FuZHRocyk6DQogIHVpbnQyNTYgY29uc3RhbnQgUEFZT1VUX0ZSQUNUSU9OID0gOTUwOw0KDQogIC8vIENvc3QgcGVyIHRpY2tldA0KICB1aW50IGNvbnN0YW50IFRJQ0tFVF9QUklDRSA9IDEgZmlubmV5Ow0KDQogIC8vIHZhbGlkIHBpY2sgbWFzaw0KICBieXRlczEgY29uc3RhbnQgUElDS19NQVNLID0gMHgzZjsgLy8gMC02Mw0KDQogIC8qDQogICAgUHVibGljIHZhcmlhYmxlcw0KICAgKi8NCiAgLy8gUHJlLXNlbGVjdGVkIHNhbHQsIGhhc2hlZCBOIHRpbWVzDQogIC8vIHNlcnZlcyBhcyBwcm9vZi1vZi1zYWx0DQogIGJ5dGVzMzIgcHVibGljIHNhbHRIYXNoOw0KDQogIC8vIHNpbmdsZSBoYXNoIG9mIHNhbHQuTi5zYWx0DQogIC8vIHNlcnZlcyBhcyBwcm9vZi1vZi1ODQogIC8vIDAgPCBOIDwgMjU2DQogIGJ5dGVzMzIgcHVibGljIHNhbHROSGFzaDsNCg0KICAvLyBjbG9zaW5nIHRpbWUuDQogIHVpbnQyNTYgcHVibGljIGNsb3NpbmdCbG9jazsNCg0KICAvLyB3aW5uaW5nIG51bWJlcnMNCiAgYnl0ZXM0IHB1YmxpYyB3aW5uaW5nTnVtYmVyczsNCg0KICAvLyBUaGlzIGJlY29tZXMgdHJ1ZSB3aGVuIHRoZSBudW1iZXJzIGhhdmUgYmVlbiBwaWNrZWQNCiAgYm9vbCBwdWJsaWMgd2lubmluZ051bWJlcnNQaWNrZWQgPSBmYWxzZTsNCg0KICAvLyBUaGlzIGJlY29tZXMgcG9wdWxhdGVkIGlmIGFueW9uZSB3aW5zDQogIGFkZHJlc3NbXSBwdWJsaWMgd2lubmVyczsNCg0KICAvLyBTdG9yZXMgYSBmbGFnIHRvIHNpZ25hbCBpZiB0aGUgd2lubmVyIGhhcyB3aW5uaW5ncyB0byBiZSBjbGFpbWVkDQogIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2lubmluZ3NDbGFpbWFibGU7DQoNCiAgLyoqDQogICAqIEN1cnJlbnQgcGlja3MgYXJlIGZyb20gMCB0byA2Mywgb3IgMl42IC0gMS4NCiAgICogQ3VycmVudCBudW1iZXIgb2YgcGlja3MgaXMgNA0KICAgKiBSb3VnaCBvZGRzIG9mIHdpbm5pbmcgd2lsbCBiZSAxIGluICgyXjYpXjQsIGFzc3VtaW5nIGV2ZW4gZGlzdHJpYnV0aW9ucywgZXRjDQogICAqLw0KICBtYXBwaW5nKGJ5dGVzNCA9PiBhZGRyZXNzW10pIHB1YmxpYyB0aWNrZXRzOw0KICB1aW50MjU2IHB1YmxpYyBuVGlja2V0cyA9IDA7DQoNCiAgLy8gU2V0IHdoZW4gd2lubmVycyBhcmUgZHJhd24sIGFuZCByZXByZXNlbnRzIHRoZSBhbW91bnQgb2YgdGhlIGNvbnRyYWN0J3MgY3VycmVudCBiYWxhbmNlIHRoYXQgY2FuIGJlIHBhaWQgb3V0Lg0KICB1aW50MjU2IHB1YmxpYyBwcml6ZVBvb2w7DQoNCiAgLy8gU2V0IHdoZW4gd2lubmVycyBhcmUgZHJhd24sIGFuZCBzaWduaWZpZXMgdGhlIGFtb3VudCBlYWNoIHdpbm5lciB3aWxsIHJlY2VpdmUuICBJbiB0aGUgZXZlbnQgb2YgbXVsdGlwbGUNCiAgLy8gd2lubmVycywgdGhpcyB3aWxsIGJlIHByaXplUG9vbCAvIHdpbm5lcnMubGVuZ3RoDQogIHVpbnQyNTYgcHVibGljIHByaXplVmFsdWU7DQoNCiAgLy8gVGhlIGZlZSBhdCB0aGUgdGltZSB3aW5uZXJzIHdlcmUgcGlja2VkIChpZiB0aGVyZSB3ZXJlIHdpbm5lcnMpLiAgVGhpcyBpcyB0aGUgcG9ydGlvbiBvZiB0aGUgY29udHJhY3QncyBiYWxhbmNlDQogIC8vIHRoYXQgZ29lcyB0byB0aGUgY29udHJhY3Qgb3duZXIuDQogIHVpbnQyNTYgcHVibGljIG93bmVyRmVlOw0KDQogIC8vIFRoaXMgd2lsbCBiZSB0aGUgc2hhMyBoYXNoIG9mIHRoZSBwcmV2aW91cyBlbnRyb3B5ICsgc29tZSBhZGRpdGlvbmFsIGlucHV0cyAoZS5nLiByYW5kb21seS1nZW5lcmF0ZWQgaGFzaGVzLCBldGMpDQogIGJ5dGVzMzIgcHJpdmF0ZSBhY2N1bXVsYXRlZEVudHJvcHk7DQoNCiAgbW9kaWZpZXIgYmVmb3JlQ2xvc2Ugew0KICAgIGlmIChibG9jay5udW1iZXIgPiBjbG9zaW5nQmxvY2spIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCiAgbW9kaWZpZXIgYmVmb3JlRHJhdyB7DQogICAgaWYgKGJsb2NrLm51bWJlciA8PSBjbG9zaW5nQmxvY2sgfHwgd2lubmluZ051bWJlcnNQaWNrZWQpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCiAgbW9kaWZpZXIgYWZ0ZXJEcmF3IHsNCiAgICBpZiAod2lubmluZ051bWJlcnNQaWNrZWQgPT0gZmFsc2UpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCiAgLy8gRW1pdHRlZCB3aGVuIHRoZSByb3VuZCBzdGFydHMsIGJyb2FkY2FzdGluZyB0aGUgaGlkZGVuIGVudHJvcHkgcGFyYW1zLCBjbG9zaW5nIGJsb2NrDQogIC8vIGFuZCBnYW1lIHZlcnNpb24uDQogIGV2ZW50IExvdHRlcnlSb3VuZFN0YXJ0ZWQoDQogICAgYnl0ZXMzMiBzYWx0SGFzaCwNCiAgICBieXRlczMyIHNhbHROSGFzaCwNCiAgICB1aW50MjU2IGNsb3NpbmdCbG9jaywNCiAgICBzdHJpbmcgdmVyc2lvbg0KICApOw0KDQogIC8vIEJyb2FkY2FzdGVkIGFueSB0aW1lIGEgdXNlciBwdXJjaGFzZXMgYSB0aWNrZXQuDQogIGV2ZW50IExvdHRlcnlSb3VuZERyYXcoDQogICAgYWRkcmVzcyBpbmRleGVkIHRpY2tldEhvbGRlciwNCiAgICBieXRlczQgaW5kZXhlZCBwaWNrcw0KICApOw0KDQogIC8vIEJyb2FkY2FzdCB3aGVuIHRoZSByb3VuZCBpcyBjb21wbGV0ZWQsIHJldmVhbGluZyB0aGUgaGlkZGVuIGVudHJvcHkgc291cmNlcw0KICAvLyBhbmQgdGhlIHdpbm5pbmcgcGlja3MuDQogIGV2ZW50IExvdHRlcnlSb3VuZENvbXBsZXRlZCgNCiAgICBieXRlczMyIHNhbHQsDQogICAgdWludDggTiwNCiAgICBieXRlczQgaW5kZXhlZCB3aW5uaW5nUGlja3MsDQogICAgdWludDI1NiBjbG9zaW5nQmFsYW5jZQ0KICApOw0KDQogIC8vIEJyb2FkY2FzdCBmb3IgZWFjaCB3aW5uZXIuDQogIGV2ZW50IExvdHRlcnlSb3VuZFdpbm5lcigNCiAgICBhZGRyZXNzIGluZGV4ZWQgdGlja2V0SG9sZGVyLA0KICAgIGJ5dGVzNCBpbmRleGVkIHBpY2tzDQogICk7DQoNCiAgLyoqDQogICAqIENyZWF0ZXMgYSBuZXcgTG90dGVyeSByb3VuZCwgYW5kIHNldHMgdGhlIHJvdW5kJ3MgcGFyYW1ldGVycy4NCiAgICoNCiAgICogTm90ZSB0aGF0IHRoaXMgd2lsbCBpbXBsaWNpdGx5IHNldCB0aGUgZmFjdG9yeSB0byBiZSB0aGUgb3duZXIsDQogICAqIG1lYW5pbmcgdGhlIGZhY3Rvcnkgd2lsbCBuZWVkIHRvIGJlIGFibGUgdG8gdHJhbnNmZXIgb3duZXJzaGlwLA0KICAgKiB0byBpdHMgb3duZXIsIHRoZSBDJkMgY29udHJhY3QuDQogICAqDQogICAqIEBwYXJhbSBfc2FsdEhhc2ggICAgICAgSGFzaGVkIHNhbHQuICBXaWxsIGJlIGhhc2hlZCB3aXRoIHNoYTMgTiB0aW1lcw0KICAgKiBAcGFyYW0gX3NhbHROSGFzaCAgICAgIEhhc2hlZCBwcm9vZiBvZiBOLCBpbiB0aGUgZm9ybWF0IHNoYTMoc2FsdCtOK3NhbHQpDQogICAqLw0KICBmdW5jdGlvbiBMb3R0ZXJ5Um91bmQoDQogICAgYnl0ZXMzMiBfc2FsdEhhc2gsDQogICAgYnl0ZXMzMiBfc2FsdE5IYXNoDQogICkgcGF5YWJsZSB7DQogICAgc2FsdEhhc2ggPSBfc2FsdEhhc2g7DQogICAgc2FsdE5IYXNoID0gX3NhbHROSGFzaDsNCiAgICBjbG9zaW5nQmxvY2sgPSBibG9jay5udW1iZXIgKyBST1VORF9MRU5HVEg7DQogICAgTG90dGVyeVJvdW5kU3RhcnRlZCgNCiAgICAgIHNhbHRIYXNoLA0KICAgICAgc2FsdE5IYXNoLA0KICAgICAgY2xvc2luZ0Jsb2NrLA0KICAgICAgVkVSU0lPTg0KICAgICk7DQogICAgLy8gc3RhcnQgdGhpcyBvZmYgd2l0aCBzb21lIHJlYWxseSBwb29yIGVudHJvcHkuDQogICAgYWNjdW11bGF0ZWRFbnRyb3B5ID0gYmxvY2suYmxvY2toYXNoKGJsb2NrLm51bWJlciAtIDEpOw0KICB9DQoNCiAgLyoqDQogICAqIEF0dGVtcHQgdG8gZ2VuZXJhdGUgYSBuZXcgcHNldWRvLXJhbmRvbSBudW1iZXIsIHdoaWxlIGFkdmFuY2luZyB0aGUgaW50ZXJuYWwgZW50cm9weQ0KICAgKiBvZiB0aGUgY29udHJhY3QuICBVc2VzIGEgdHdvLXBoYXNlIGFwcHJvYWNoOiBmaXJzdCwgZ2VuZXJhdGVzIGEgc2ltcGxlIG9mZnNldCBbMC0yNTVdDQogICAqIGZyb20gc2ltcGxlIGVudHJvcHkgc291cmNlcyAoYWNjdW11bGF0ZWQsIHNlbmRlciwgYmxvY2sgbnVtYmVyKS4gIFVzZXMgdGhpcyBvZmZzZXQNCiAgICogdG8gaW5kZXggaW50byB0aGUgaGlzdG9yeSBvZiBibG9ja2hhc2hlcywgdG8gYXR0ZW1wdCB0byBnZW5lcmF0ZSBzb21lIHN0cm9uZ2VyIGVudHJvcHkNCiAgICogYnkgaW5jbHVkaW5nIHByZXZpb3VzIGJsb2NrIGhhc2hlcy4NCiAgICoNCiAgICogVGhlbiBhZHZhbmNlcyB0aGUgaW50ZXJhbCBlbnRyb3B5IGJ5IHJlaGFzaGluZyBpdCB3aXRoIHRoZSBjaG9zZW4gbnVtYmVyLg0KICAgKi8NCiAgZnVuY3Rpb24gZ2VuZXJhdGVQc2V1ZG9SYW5kKGJ5dGVzMzIgc2VlZCkgaW50ZXJuYWwgcmV0dXJucyhieXRlczMyKSB7DQogICAgdWludDggcHNldWRvUmFuZG9tT2Zmc2V0ID0gdWludDgodWludDI1NihzaGEyNTYoDQogICAgICBzZWVkLA0KICAgICAgYmxvY2suZGlmZmljdWx0eSwNCiAgICAgIGJsb2NrLmNvaW5iYXNlLA0KICAgICAgYmxvY2sudGltZXN0YW1wLA0KICAgICAgYWNjdW11bGF0ZWRFbnRyb3B5DQogICAgKSkgJiAweGZmKTsNCiAgICAvLyBXQVJOSU5HOiBUaGlzIGFzc3VtZXMgYmxvY2subnVtYmVyID4gMjU2Li4uIElmIGJsb2NrLm51bWJlciA8IDI1NiwgdGhlIGJlbG93IGJsb2NrLmJsb2NraGFzaCBjb3VsZCByZXR1cm4gMA0KICAgIC8vIFRoaXMgaXMgcHJvYmFibHkgb25seSBhbiBpc3N1ZSBpbiB0ZXN0aW5nLCBidXQgc2hvdWxkbid0IGJlIGEgcHJvYmxlbSB0aGVyZS4NCiAgICB1aW50MjU2IHBzZXVkb1JhbmRvbUJsb2NrID0gYmxvY2subnVtYmVyIC0gcHNldWRvUmFuZG9tT2Zmc2V0IC0gMTsNCiAgICBieXRlczMyIHBzZXVkb1JhbmQgPSBzaGEzKA0KICAgICAgYmxvY2subnVtYmVyLA0KICAgICAgYmxvY2suYmxvY2toYXNoKHBzZXVkb1JhbmRvbUJsb2NrKSwNCiAgICAgIGJsb2NrLmRpZmZpY3VsdHksDQogICAgICBibG9jay50aW1lc3RhbXAsDQogICAgICBhY2N1bXVsYXRlZEVudHJvcHkNCiAgICApOw0KICAgIGFjY3VtdWxhdGVkRW50cm9weSA9IHNoYTMoYWNjdW11bGF0ZWRFbnRyb3B5LCBwc2V1ZG9SYW5kKTsNCiAgICByZXR1cm4gcHNldWRvUmFuZDsNCiAgfQ0KDQogIC8qKg0KICAgKiBCdXkgYSB0aWNrZXQgd2l0aCBwcmUtc2VsZWN0ZWQgcGlja3MNCiAgICogQHBhcmFtIHBpY2tzIFVzZXIncyBwaWNrcy4NCiAgICovDQogIGZ1bmN0aW9uIHBpY2tUaWNrZXQoYnl0ZXM0IHBpY2tzKSBwYXlhYmxlIGJlZm9yZUNsb3NlIHsNCiAgICBpZiAobXNnLnZhbHVlICE9IFRJQ0tFVF9QUklDRSkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KICAgIC8vIGRvbid0IGFsbG93IGludmFsaWQgcGlja3MuDQogICAgZm9yICh1aW50OCBpID0gMDsgaSA8IDQ7IGkrKykgew0KICAgICAgaWYgKHBpY2tzW2ldICYgUElDS19NQVNLICE9IHBpY2tzW2ldKSB7DQogICAgICAgIHRocm93Ow0KICAgICAgfQ0KICAgIH0NCiAgICB0aWNrZXRzW3BpY2tzXS5wdXNoKG1zZy5zZW5kZXIpOw0KICAgIG5UaWNrZXRzKys7DQogICAgZ2VuZXJhdGVQc2V1ZG9SYW5kKGJ5dGVzMzIocGlja3MpKTsgLy8gYWR2YW5jZSB0aGUgYWNjdW11bGF0ZWQgZW50cm9weQ0KICAgIExvdHRlcnlSb3VuZERyYXcobXNnLnNlbmRlciwgcGlja3MpOw0KICB9DQoNCiAgLyoqDQogICAqIEludGVyYWwgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdmFsaWQgcGlja3MuICBVc2VkIGJ5IGJvdGggdGhlIHJhbmRvbQ0KICAgKiB0aWNrZXQgZnVuY3Rpb25hbGl0eSwgYXMgd2VsbCBhcyB3aGVuIGdlbmVyYXRpbmcgd2lubmluZyBwaWNrcy4NCiAgICogRXZlbiB0aG91Z2ggdGhlIHBpY2tzIGFyZSBhIGZpeGVkLXdpZHRoIGJ5dGUgYXJyYXksIGVhY2ggcGljayBpcw0KICAgKiBjaG9zZW4gc2VwYXJhdGVseSAoZS5nLiBhIGJ5dGVzNCB3aWxsIHJlc3VsdCBpbiA0IHNlcGFyYXRlIHNoYTMgaGFzaGVzDQogICAqIHVzZWQgYXMgc291cmNlcykuDQogICAqDQogICAqIE1hc2tzIHRoZSBmaXJzdCBieXRlIG9mIHRoZSBzZWVkIHRvIHVzZSBhcyBhbiBvZmZzZXQgaW50byB0aGUgbmV4dCBQUk5HLA0KICAgKiB0aGVuIHJlcGxhY2VzIHRoZSBzZWVkIHdpdGggdGhlIG5ldyBQUk5HLiAgUHVsbHMgYSBzaW5nbGUgYnl0ZSBmcm9tIHRoZQ0KICAgKiByZXN1bHRhbnQgb2Zmc2V0LCBtYXNrcyBpdCB0byBiZSB2YWxpZCwgdGhlbiBhZGRzIGl0IHRvIHRoZSBhY2N1bXVsYXRvci4NCiAgICoNCiAgICogQHBhcmFtIHNlZWQgIFRoZSBQUk5HIHNlZWQgdXNlZCB0byBwaWNrIHRoZSBudW1iZXJzLg0KICAgKi8NCiAgZnVuY3Rpb24gcGlja1ZhbHVlcyhieXRlczMyIHNlZWQpIGludGVybmFsIHJldHVybnMgKGJ5dGVzNCkgew0KICAgIGJ5dGVzNCBwaWNrczsNCiAgICB1aW50OCBvZmZzZXQ7DQogICAgZm9yICh1aW50OCBpID0gMDsgaSA8IDQ7IGkrKykgew0KICAgICAgb2Zmc2V0ID0gdWludDgoc2VlZFswXSkgJiAweDFmOw0KICAgICAgc2VlZCA9IHNoYTMoc2VlZCwgbXNnLnNlbmRlcik7DQogICAgICBwaWNrcyA9IChwaWNrcyA+PiA4KSB8IGJ5dGVzMShzZWVkW29mZnNldF0gJiBQSUNLX01BU0spOw0KICAgIH0NCiAgICByZXR1cm4gcGlja3M7DQogIH0NCg0KICAvKioNCiAgICogUGlja3MgYSByYW5kb20gdGlja2V0LCB1c2luZyB0aGUgaW50ZXJuYWwgUFJORyBhbmQgYWNjdW11bGF0ZWQgZW50cm9weQ0KICAgKi8NCiAgZnVuY3Rpb24gcmFuZG9tVGlja2V0KCkgcGF5YWJsZSBiZWZvcmVDbG9zZSB7DQogICAgaWYgKG1zZy52YWx1ZSAhPSBUSUNLRVRfUFJJQ0UpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBieXRlczMyIHBzZXVkb1JhbmQgPSBnZW5lcmF0ZVBzZXVkb1JhbmQoYnl0ZXMzMihtc2cuc2VuZGVyKSk7DQogICAgYnl0ZXM0IHBpY2tzID0gcGlja1ZhbHVlcyhwc2V1ZG9SYW5kKTsNCiAgICB0aWNrZXRzW3BpY2tzXS5wdXNoKG1zZy5zZW5kZXIpOw0KICAgIG5UaWNrZXRzKys7DQogICAgTG90dGVyeVJvdW5kRHJhdyhtc2cuc2VuZGVyLCBwaWNrcyk7DQogIH0NCg0KICAvKioNCiAgICogUHVibGljIG1lYW5zIHRvIHByb3ZlIHRoZSBzYWx0IGFmdGVyIG51bWJlcnMgYXJlIHBpY2tlZC4gIE5vdCB0ZWNobmljYWxseSBuZWNlc3NhcnkNCiAgICogZm9yIHRoaXMgdG8gYmUgZXh0ZXJuYWwsIGJlY2F1c2UgaXQgd2lsbCBiZSBjYWxsZWQgZHVyaW5nIHRoZSByb3VuZCBjbG9zZSBwcm9jZXNzLg0KICAgKiBJZiB0aGUgaGlkZGVuIGVudHJvcHkgcGFyYW1ldGVycyBkb24ndCBtYXRjaCwgdGhlIGNvbnRyYWN0IHdpbGwgcmVmdXNlIHRvIHBpY2sNCiAgICogbnVtYmVycyBvciBjbG9zZS4NCiAgICoNCiAgICogQHBhcmFtIHNhbHQgICAgICAgICAgSGlkZGVuIGVudHJvcHkgc291cmNlDQogICAqIEBwYXJhbSBOICAgICAgICAgICAgIFNlY3JldCB2YWx1ZSBwcm92aW5nIGhvdyB0byBvYnRhaW4gdGhlIGhhc2hlZCBlbnRyb3B5IGZyb20gdGhlIHNvdXJjZS4NCiAgICovDQogIGZ1bmN0aW9uIHByb29mT2ZTYWx0KGJ5dGVzMzIgc2FsdCwgdWludDggTikgY29uc3RhbnQgcmV0dXJucyhib29sKSB7DQogICAgLy8gUHJvb2Ytb2YtTjoNCiAgICBieXRlczMyIF9zYWx0Tkhhc2ggPSBzaGEzKHNhbHQsIE4sIHNhbHQpOw0KICAgIGlmIChfc2FsdE5IYXNoICE9IHNhbHROSGFzaCkgew0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIFByb29mLW9mLXNhbHQ6DQogICAgYnl0ZXMzMiBfc2FsdEhhc2ggPSBzaGEzKHNhbHQpOw0KICAgIGZvciAodmFyIGkgPSAxOyBpIDwgTjsgaSsrKSB7DQogICAgICBfc2FsdEhhc2ggPSBzaGEzKF9zYWx0SGFzaCk7DQogICAgfQ0KICAgIGlmIChfc2FsdEhhc2ggIT0gc2FsdEhhc2gpIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvKioNCiAgICogSW50ZXJuYWwgZnVuY3Rpb24gdG8gaGFuZGxlIHRhYnVsYXRpbmcgdGhlIHdpbm5lcnMsIGluY2x1ZGluZyBlZGdlIGNhc2VzIGFyb3VuZA0KICAgKiBkdXBsaWNhdGUgd2lubmVycy4gIFNwbGl0IG91dCBpbnRvIGl0cyBvd24gbWV0aG9kIHBhcnRpYWxseSB0byBlbmFibGUgcHJvcGVyDQogICAqIHRlc3RpbmcuDQogICAqDQogICAqIEBwYXJhbSBzYWx0ICAgICAgICAgIEhpZGRlbiBlbnRyb3B5IHNvdXJjZS4gIEVtaXR0ZWQgaGVyZQ0KICAgKiBAcGFyYW0gTiAgICAgICAgICAgICBLZXkgdG8gdGhlIGhpZGRlbiBlbnRyb3B5IHNvdXJjZS4NCiAgICogQHBhcmFtIHdpbm5pbmdQaWNrcyAgVGhlIHdpbm5pbmcgcGlja3MuDQogICAqLw0KICBmdW5jdGlvbiBmaW5hbGl6ZVJvdW5kKGJ5dGVzMzIgc2FsdCwgdWludDggTiwgYnl0ZXM0IHdpbm5pbmdQaWNrcykgaW50ZXJuYWwgew0KICAgIHdpbm5pbmdOdW1iZXJzID0gd2lubmluZ1BpY2tzOw0KICAgIHdpbm5pbmdOdW1iZXJzUGlja2VkID0gdHJ1ZTsNCiAgICBMb3R0ZXJ5Um91bmRDb21wbGV0ZWQoc2FsdCwgTiwgd2lubmluZ051bWJlcnMsIHRoaXMuYmFsYW5jZSk7DQoNCiAgICB2YXIgX3dpbm5lcnMgPSB0aWNrZXRzW3dpbm5pbmdOdW1iZXJzXTsNCiAgICAvLyBpZiB3ZSBoYXZlIHdpbm5lcnM6DQogICAgaWYgKF93aW5uZXJzLmxlbmd0aCA+IDApIHsNCiAgICAgIC8vIGxldCdzIGRlZHVwZSBhbmQgYnJvYWRjYXN0IHRoZSB3aW5uZXJzIGJlZm9yZSBmaWd1cmluZyBvdXQgdGhlIHByaXplIHBvb2wgc2l0dWF0aW9uLg0KICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX3dpbm5lcnMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdmFyIHdpbm5lciA9IF93aW5uZXJzW2ldOw0KICAgICAgICBpZiAoIXdpbm5pbmdzQ2xhaW1hYmxlW3dpbm5lcl0pIHsNCiAgICAgICAgICB3aW5uZXJzLnB1c2god2lubmVyKTsNCiAgICAgICAgICB3aW5uaW5nc0NsYWltYWJsZVt3aW5uZXJdID0gdHJ1ZTsNCiAgICAgICAgICBMb3R0ZXJ5Um91bmRXaW5uZXIod2lubmVyLCB3aW5uaW5nTnVtYmVycyk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIC8vIG5vdyBsZXQncyB3cmFwIHRoaXMgdXAgYnkgZmluYWxpemluZyB0aGUgcHJpemUgcG9vbCB2YWx1ZToNCiAgICAgIC8vIFRoZXJlIG1heSBiZSBzb21lIHJvdW5kaW5nIGVycm9ycyBpbiBoZXJlLCBidXQgaXQgc2hvdWxkIG9ubHkgYW1vdW50IHRvIGEgY291cGxlIHdlaS4NCiAgICAgIHByaXplUG9vbCA9IHRoaXMuYmFsYW5jZSAqIFBBWU9VVF9GUkFDVElPTiAvIDEwMDA7DQogICAgICBwcml6ZVZhbHVlID0gcHJpemVQb29sIC8gd2lubmVycy5sZW5ndGg7DQoNCiAgICAgIC8vIE5vdGUgdGhhdCB0aGUgb3duZXIgZG9lc24ndCBnZXQgdG8gY2xhaW0gYSBmZWUgdW50aWwgdGhlIGdhbWUgaXMgd29uLg0KICAgICAgb3duZXJGZWUgPSB0aGlzLmJhbGFuY2UgLSBwcml6ZVBvb2w7DQogICAgfQ0KICAgIC8vIHdlIGRvbmUuDQogIH0NCg0KICAvKioNCiAgICogUmV2ZWFsIHRoZSBzZWNyZXQgc291cmNlcyBvZiBlbnRyb3B5LCB0aGVuIHVzZSB0aGVtIHRvIHBpY2sgd2lubmluZyBudW1iZXJzLg0KICAgKg0KICAgKiBOb3RlIHRoYXQgYnkgdXNpbmcgbm8gZHluYW1pYyAoZS5nLiBibG9ja2hhc2gtYmFzZWQpIHNvdXJjZXMgb2YgZW50cm9weSwNCiAgICogY2Vuc29yaW5nIHRoaXMgdHJhbnNhY3Rpb24gd2lsbCBub3QgY2hhbmdlIHRoZSBmaW5hbCBvdXRjb21lIG9mIHRoZSBwaWNrcy4NCiAgICoNCiAgICogQHBhcmFtIHNhbHQgICAgICAgICAgSGlkZGVuIGVudHJvcHkuDQogICAqIEBwYXJhbSBOICAgICAgICAgICAgIE51bWJlciBvZiB0aW1lcyB0byBoYXNoIHRoZSBoaWRkZW4gZW50cm9weSB0byBwcm9kdWNlIHRoZSB2YWx1ZSBwcm92aWRlZCBhdCBjcmVhdGlvbi4NCiAgICovDQogIGZ1bmN0aW9uIGNsb3NlR2FtZShieXRlczMyIHNhbHQsIHVpbnQ4IE4pIG9ubHlPd25lciBiZWZvcmVEcmF3IHsNCiAgICAvLyBEb24ndCBhbGxvdyBwaWNraW5nIG51bWJlcnMgbXVsdGlwbGUgdGltZXMuDQogICAgaWYgKHdpbm5pbmdOdW1iZXJzUGlja2VkID09IHRydWUpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCg0KICAgIC8vIHByb3ZlIHRoZSBwcmUtc2VsZWN0ZWQgc2FsdCBpcyBhY3R1YWxseSBsZWdpdC4NCiAgICBpZiAocHJvb2ZPZlNhbHQoc2FsdCwgTikgIT0gdHJ1ZSkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KDQogICAgYnl0ZXMzMiBwc2V1ZG9SYW5kID0gc2hhMygNCiAgICAgIHNhbHQsDQogICAgICBuVGlja2V0cywNCiAgICAgIGFjY3VtdWxhdGVkRW50cm9weQ0KICAgICk7DQogICAgZmluYWxpemVSb3VuZChzYWx0LCBOLCBwaWNrVmFsdWVzKHBzZXVkb1JhbmQpKTsNCiAgfQ0KDQogIC8qKg0KICAgKiBTZW5kcyB0aGUgb3duZXIncyBmZWUgdG8gdGhlIHNwZWNpZmllZCBhZGRyZXNzLiAgTm90ZSB0aGF0IHRoZQ0KICAgKiBvd25lciBjYW4gb25seSBiZSBwYWlkIGlmIHRoZXJlIGFjdHVhbGx5IHdhcyBhIHdpbm5lci4gSW4gdGhlDQogICAqIGV2ZW50IG5vIG9uZSB3aW5zLCB0aGUgZW50aXJlIGJhbGFuY2UgaXMgY2FycmllZCBvdmVyIGludG8gdGhlDQogICAqIG5leHQgcm91bmQuICBObyBkb3VibGUtZGlwcGluZyBoZXJlLg0KICAgKiBAcGFyYW0gcGF5b3V0ICAgICAgICBBZGRyZXNzIHRvIHNlbmQgdGhlIG93bmVyIGZlZSB0by4NCiAgICovDQogIGZ1bmN0aW9uIGNsYWltT3duZXJGZWUoYWRkcmVzcyBwYXlvdXQpIG9ubHlPd25lciBhZnRlckRyYXcgew0KICAgIGlmIChvd25lckZlZSA+IDApIHsNCiAgICAgIHVpbnQyNTYgdmFsdWUgPSBvd25lckZlZTsNCiAgICAgIG93bmVyRmVlID0gMDsNCiAgICAgIGlmICghcGF5b3V0LnNlbmQodmFsdWUpKSB7DQogICAgICAgIHRocm93Ow0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8qKg0KICAgKiBVc2VkIHRvIHdpdGhkcmF3IHRoZSBiYWxhbmNlIHdoZW4gdGhlIHJvdW5kIGlzIGNvbXBsZXRlZC4gIFRoaXMNCiAgICogb25seSB3b3JrcyBpZiB0aGVyZSBhcmUgZWl0aGVyIG5vIHdpbm5lcnMsIG9yIGFsbCB3aW5uZXJzICsgdGhlDQogICAqIG93bmVyIGhhdmUgYmVlbiBwYWlkLg0KICAgKi8NCiAgZnVuY3Rpb24gd2l0aGRyYXcoKSBvbmx5T3duZXIgYWZ0ZXJEcmF3IHsNCiAgICBpZiAocGFpZE91dCgpICYmIG93bmVyRmVlID09IDApIHsNCiAgICAgIGlmICghb3duZXIuc2VuZCh0aGlzLmJhbGFuY2UpKSB7DQogICAgICAgIHRocm93Ow0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8qKg0KICAgKiBTYW1lIGFzIGFib3ZlLiAgVGhpcyBpcyBtb3N0bHkgaGVyZSBiZWNhdXNlIGl0J3Mgb3ZlcnJpZGluZyB0aGUgbWV0aG9kDQogICAqIGluaGVyaXRlZCBmcm9tIGBPd25lZGANCiAgICovDQogIGZ1bmN0aW9uIHNodXRkb3duKCkgb25seU93bmVyIGFmdGVyRHJhdyB7DQogICAgaWYgKHBhaWRPdXQoKSAmJiBvd25lckZlZSA9PSAwKSB7DQogICAgICBzZWxmZGVzdHJ1Y3Qob3duZXIpOw0KICAgIH0NCiAgfQ0KDQogIC8qKg0KICAgKiBBdHRlbXB0IHRvIHBheSB0aGUgd2lubmVycywgaWYgYW55LiAgSWYgYW55IGBzZW5kYHMgZmFpbCwgdGhlIHdpbm5lcg0KICAgKiB3aWxsIGhhdmUgdG8gY29sbGVjdCB0aGVpciB3aW5uaW5ncyBvbiB0aGVpciBvd24uDQogICAqLw0KICBmdW5jdGlvbiBkaXN0cmlidXRlV2lubmluZ3MoKSBvbmx5T3duZXIgYWZ0ZXJEcmF3IHsNCiAgICBpZiAod2lubmVycy5sZW5ndGggPiAwKSB7DQogICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB3aW5uZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGFkZHJlc3Mgd2lubmVyID0gd2lubmVyc1tpXTsNCiAgICAgICAgYm9vbCB1bmNsYWltZWQgPSB3aW5uaW5nc0NsYWltYWJsZVt3aW5uZXJdOw0KICAgICAgICBpZiAodW5jbGFpbWVkKSB7DQogICAgICAgICAgd2lubmluZ3NDbGFpbWFibGVbd2lubmVyXSA9IGZhbHNlOw0KICAgICAgICAgIGlmICghd2lubmVyLnNlbmQocHJpemVWYWx1ZSkpIHsNCiAgICAgICAgICAgIC8vIElmIEkgY2FuJ3Qgc2VuZCB5b3UgbW9uZXksIGR1bWJzaGl0LCB5b3UgZ2V0IHRvIGNsYWltIGl0IG9uIHlvdXIgb3duLg0KICAgICAgICAgICAgLy8gbWF5YmUgbmV4dCB0aW1lIGRvbid0IHVzZSBhIGNvbnRyYWN0IG9yIHRyeSB0byBleHBsb2l0IHRoZSBnYW1lLg0KICAgICAgICAgICAgLy8gUmVnYXJkbGVzcywgeW91J3JlIG9uIHlvdXIgb3duLiAgSGFwcHkgYmlydGhkYXkgdG8gdGhlIGdyb3VuZC4NCiAgICAgICAgICAgIHdpbm5pbmdzQ2xhaW1hYmxlW3dpbm5lcl0gPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8qKg0KICAgKiBSZXR1cm5zIHRydWUgaWYgaXQncyBhZnRlciB0aGUgZHJhdywgYW5kIGVpdGhlciB0aGVyZSBhcmUgbm8gd2lubmVycywgb3IgYWxsIHRoZSB3aW5uZXJzIGhhdmUgYmVlbiBwYWlkLg0KICAgKiBAcmV0dXJuIHtib29sfQ0KICAgKi8NCiAgZnVuY3Rpb24gcGFpZE91dCgpIGNvbnN0YW50IHJldHVybnMoYm9vbCkgew0KICAgIC8vIG5vIG5lZWQgdG8gdXNlIHRoZSBtb2RpZmllciBvbiB0aGlzIGZ1bmN0aW9uLCBqdXN0IGRvIHRoZSBzYW1lIGNoZWNrDQogICAgLy8gYW5kIHJldHVybiBmYWxzZSBpbnN0ZWFkLg0KICAgIGlmICh3aW5uaW5nTnVtYmVyc1BpY2tlZCA9PSBmYWxzZSkgew0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBpZiAod2lubmVycy5sZW5ndGggPiAwKSB7DQogICAgICBib29sIGNsYWltZWQgPSB0cnVlOw0KICAgICAgLy8gaWYgYW55b25lIGhhc24ndCBiZWVuIHNlbnQgb3IgY2xhaW1lZCB0aGVpciBlYXJuaW5ncywNCiAgICAgIC8vIHdlIHN0aWxsIGhhdmUgbW9uZXkgdG8gcGF5IG91dC4NCiAgICAgIGZvciAodWludCBpID0gMDsgY2xhaW1lZCAmJiBpIDwgd2lubmVycy5sZW5ndGg7IGkrKykgew0KICAgICAgICBjbGFpbWVkID0gY2xhaW1lZCAmJiAhd2lubmluZ3NDbGFpbWFibGVbd2lubmVyc1tpXV07DQogICAgICB9DQogICAgICByZXR1cm4gY2xhaW1lZDsNCiAgICB9IGVsc2Ugew0KICAgICAgLy8gbm8gd2lubmVycywgbm90aGluZyB0byBwYXkuDQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogIH0NCg0KICAvKioNCiAgICogV2lubmVycyBjYW4gY2xhaW0gdGhlaXIgb3duIHByaXplcyB1c2luZyB0aGlzLiAgSWYgdGhleSBkbw0KICAgKiBzb21ldGhpbmcgc3R1cGlkIGxpa2UgdXNlIGEgY29udHJhY3QsIHRoaXMgZ2l2ZXMgdGhlbSBhDQogICAqIGEgc2Vjb25kIGNoYW5jZSBhdCB3aXRoZHJhd2luZyB0aGVpciBmdW5kcy4gIE5vdGUgdGhhdA0KICAgKiB0aGlzIHNoYXJlcyBhbiBpbnRlcmxvY2sgd2l0aCBgZGlzdHJpYnV0ZVdpbm5pbmdzYC4NCiAgICovDQogIGZ1bmN0aW9uIGNsYWltUHJpemUoKSBhZnRlckRyYXcgew0KICAgIGlmICh3aW5uaW5nc0NsYWltYWJsZVttc2cuc2VuZGVyXSA9PSBmYWxzZSkgew0KICAgICAgLy8gZ2V0LiBvdXQhDQogICAgICB0aHJvdzsNCiAgICB9DQogICAgd2lubmluZ3NDbGFpbWFibGVbbXNnLnNlbmRlcl0gPSBmYWxzZTsNCiAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChwcml6ZVZhbHVlKSkgew0KICAgICAgLy8geW91IHJlYWxseSBhcmUgYSBkdW1ic2hpdCwgYXJlbid0IHlvdS4NCiAgICAgIHRocm93Ow0KICAgIH0NCiAgfQ0KDQogIC8vIE1hbiEgV2hhdCBkbyBJIGxvb2sgbGlrZT8gQSBjaGFyaXR5IGNhc2U/DQogIC8vIFBsZWFzZS4NCiAgLy8gWW91IGNhbid0IGJ1eSBtZSwgaG90IGRvZyBtYW4hDQogIGZ1bmN0aW9uICgpIHsNCiAgICB0aHJvdzsNCiAgfQ0KfQ0KDQpjb250cmFjdCBMb3R0ZXJ5Um91bmRGYWN0b3J5SW50ZXJmYWNlIHsNCiAgc3RyaW5nIHB1YmxpYyBWRVJTSU9OOw0KICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKTsNCn0NCg0KY29udHJhY3QgTG90dGVyeVJvdW5kRmFjdG9yeUludGVyZmFjZVYxIGlzIExvdHRlcnlSb3VuZEZhY3RvcnlJbnRlcmZhY2Ugew0KICBmdW5jdGlvbiBjcmVhdGVSb3VuZChieXRlczMyIF9zYWx0SGFzaCwgYnl0ZXMzMiBfc2FsdE5IYXNoKSBwYXlhYmxlIHJldHVybnMoYWRkcmVzcyk7DQp9DQoNCmNvbnRyYWN0IExvdHRlcnlSb3VuZEZhY3RvcnkgaXMgTG90dGVyeVJvdW5kRmFjdG9yeUludGVyZmFjZVYxLCBPd25lZCB7DQoNCiAgc3RyaW5nIHB1YmxpYyBWRVJTSU9OID0gJzAuMS4yJzsNCg0KICBldmVudCBMb3R0ZXJ5Um91bmRDcmVhdGVkKA0KICAgIGFkZHJlc3MgbmV3Um91bmQsDQogICAgc3RyaW5nIHZlcnNpb24NCiAgKTsNCg0KICAvKioNCiAgICogQ3JlYXRlcyBhIG5ldyByb3VuZCwgYW5kIHNldHMgdGhlIHNlY3JldCAoaGFzaGVkKSBzYWx0IGFuZCBwcm9vZiBvZiBOLg0KICAgKiBAcGFyYW0gX3NhbHRIYXNoICAgICBIYXNoZWQgc2FsdA0KICAgKiBAcGFyYW0gX3NhbHROSGFzaCAgICBIYXNoZWQgcHJvb2Ygb2YgTg0KICAgKi8NCiAgZnVuY3Rpb24gY3JlYXRlUm91bmQoDQogICAgYnl0ZXMzMiBfc2FsdEhhc2gsDQogICAgYnl0ZXMzMiBfc2FsdE5IYXNoDQogICkgcGF5YWJsZSBvbmx5T3duZXIgcmV0dXJucyhhZGRyZXNzKSB7DQogICAgTG90dGVyeVJvdW5kIG5ld1JvdW5kOw0KICAgIGlmIChtc2cudmFsdWUgPiAwKSB7DQogICAgICBuZXdSb3VuZCA9IChuZXcgTG90dGVyeVJvdW5kKS52YWx1ZShtc2cudmFsdWUpKA0KICAgICAgICBfc2FsdEhhc2gsDQogICAgICAgIF9zYWx0Tkhhc2gNCiAgICAgICk7DQogICAgfSBlbHNlIHsNCiAgICAgIG5ld1JvdW5kID0gbmV3IExvdHRlcnlSb3VuZCgNCiAgICAgICAgX3NhbHRIYXNoLA0KICAgICAgICBfc2FsdE5IYXNoDQogICAgICApOw0KICAgIH0NCg0KICAgIGlmIChuZXdSb3VuZCA9PSBMb3R0ZXJ5Um91bmQoMCkpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBuZXdSb3VuZC50cmFuc2Zlck93bmVyc2hpcChvd25lcik7DQogICAgTG90dGVyeVJvdW5kQ3JlYXRlZChhZGRyZXNzKG5ld1JvdW5kKSwgVkVSU0lPTik7DQogICAgcmV0dXJuIGFkZHJlc3MobmV3Um91bmQpOw0KICB9DQoNCiAgLy8gTWFuLCB0aGlzIGFpbid0IG15IGRhZCENCiAgLy8gVGhpcyBpcyBhIGNlbGwgcGhvbmUhDQogIGZ1bmN0aW9uICgpIHsNCiAgICB0aHJvdzsNCiAgfQ0KfQ=='