base 64 content
base64mainstreetCrowdfund1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC45Ow0KDQpjb250cmFjdCBFUkMyMCB7DQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHRvdGFsU3VwcGx5KTsNCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsNCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KfQ0KDQovKioNCiAqIEB0aXRsZSBNYWluc3RyZWV0VG9rZW4NCiAqLw0KY29udHJhY3QgTWFpbnN0cmVldFRva2VuIGlzIEVSQzIwIHsNCiAgICBzdHJpbmcgcHVibGljIG5hbWUgPSAnTWFpbnN0cmVldCBUb2tlbic7ICAgICAgICAgICAgIC8vVGhlIFRva2VuJ3MgbmFtZTogZS5nLiBEaWdpeERBTyBUb2tlbnMNCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAxODsgICAgICAgICAgICAgLy8gMVRva2VuICYjMTY4Oz0gMSQgKDFFVEggJiMxNjg7PSAxMCQpDQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAnTUlUJzsgICAgICAgICAgIC8vQW4gaWRlbnRpZmllcjogZS5nLiBSRVANCiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnTUlUXzAuMSc7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIG93bmVyTUlUOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCiAgICB1aW50IHB1YmxpYyB0b3RhbE1JVDsNCiAgICB1aW50IHB1YmxpYyBzdGFydDsNCg0KICAgIGFkZHJlc3MgcHVibGljIG1haW5zdHJlZXRDcm93ZGZ1bmQ7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBpbnRlbGxpc3lzOw0KDQogICAgYm9vbCBwdWJsaWMgdGVzdGluZzsNCg0KICAgIG1vZGlmaWVyIGZyb21Dcm93ZGZ1bmQoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IG1haW5zdHJlZXRDcm93ZGZ1bmQpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgaXNBY3RpdmUoKSB7DQogICAgICAgIGlmIChibG9jay50aW1lc3RhbXAgPCBzdGFydCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc05vdEFjdGl2ZSgpIHsNCiAgICAgICAgaWYgKCF0ZXN0aW5nICYmIGJsb2NrLnRpbWVzdGFtcCA+PSBzdGFydCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciByZWNpcGllbnRJc1ZhbGlkKGFkZHJlc3MgcmVjaXBpZW50KSB7DQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCB8fCByZWNpcGllbnQgPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBhbGxvd2FuY2VJc1plcm8oYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSB7DQogICAgICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXMmIzE4MDsNCiAgICAgICAgLy8gYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwwKWAgaWYgaXQgaXMgbm90DQogICAgICAgIC8vIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5DQogICAgICAgIGlmICgodmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bc3BlbmRlcl0gIT0gMCkpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBDb25zdHJ1Y3Rvci4NCiAgICAgKiBAcGFyYW0gX21haW5zdHJlZXRDcm93ZGZ1bmQgQWRkcmVzcyBvZiBjcm93ZGZ1bmQgY29udHJhY3QuDQogICAgICogQHBhcmFtIF9pbnRlbGxpc3lzIEFkZHJlc3MgdG8gcmVjZWl2ZSBpbnRlbGxpc3lzJyB0b2tlbnMuDQogICAgICogQHBhcmFtIF9zdGFydCBUaW1lc3RhbXAgd2hlbiB0aGUgdG9rZW4gYmVjb21lcyBhY3RpdmUuDQogICAgICovDQogICAgZnVuY3Rpb24gTWFpbnN0cmVldFRva2VuKGFkZHJlc3MgX21haW5zdHJlZXRDcm93ZGZ1bmQsIGFkZHJlc3MgX2ludGVsbGlzeXMsIHVpbnQgX3N0YXJ0LCBib29sIF90ZXN0aW5nKSB7DQogICAgICAgIG1haW5zdHJlZXRDcm93ZGZ1bmQgPSBfbWFpbnN0cmVldENyb3dkZnVuZDsNCiAgICAgICAgaW50ZWxsaXN5cyA9IF9pbnRlbGxpc3lzOw0KICAgICAgICBzdGFydCA9IF9zdGFydDsNCiAgICAgICAgdGVzdGluZyA9IF90ZXN0aW5nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXYgQWRkIHRvIHRva2VuIGJhbGFuY2Ugb24gYWRkcmVzcy4gTXVzdCBiZSBmcm9tIGNyb3dkZnVuZC4NCiAgICAgKiBAcGFyYW0gcmVjaXBpZW50IEFkZHJlc3MgdG8gYWRkIHRva2VucyB0by4NCiAgICAgKiBAcmV0dXJuIE1JVCBBbW91bnQgb2YgTUlUIHRvIGFkZC4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBhZGRUb2tlbnMoYWRkcmVzcyByZWNpcGllbnQsIHVpbnQgTUlUKSBleHRlcm5hbCBpc05vdEFjdGl2ZSBmcm9tQ3Jvd2RmdW5kIHsNCiAgICAgICAgb3duZXJNSVRbcmVjaXBpZW50XSArPSBNSVQ7DQogICAgICAgIHVpbnQgaW50ZWxsaXN5c01JVCA9IE1JVCAvIDEwOw0KICAgICAgICBvd25lck1JVFtpbnRlbGxpc3lzXSArPSBpbnRlbGxpc3lzTUlUOw0KICAgICAgICB0b3RhbE1JVCArPSBNSVQgKyBpbnRlbGxpc3lzTUlUOw0KICAgICAgICBUcmFuc2ZlcigweDAsIHJlY2lwaWVudCwgTUlUKTsNCiAgICAgICAgVHJhbnNmZXIoMHgwLCBpbnRlbGxpc3lzLCBpbnRlbGxpc3lzTUlUKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgdG90YWxTdXBwbHkoKQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFN1cHBseSkgew0KICAgICAgICB0b3RhbFN1cHBseSA9IHRvdGFsTUlUOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXYgSW1wbGVtZW50cyBFUkMyMCBiYWxhbmNlT2YoKQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIGJhbGFuY2UgPSBvd25lck1JVFtfb3duZXJdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXYgSW1wbGVtZW50cyBFUkMyMCB0cmFuc2ZlcigpDQogICAgICovDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc0FjdGl2ZSByZWNpcGllbnRJc1ZhbGlkKF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChvd25lck1JVFttc2cuc2VuZGVyXSA+PSBfdmFsdWUpIHsNCiAgICAgICAgICAgIG93bmVyTUlUW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgICAgIG93bmVyTUlUW190b10gKz0gX3ZhbHVlOw0KICAgICAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgdHJhbnNmZXJGcm9tKCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc0FjdGl2ZSByZWNpcGllbnRJc1ZhbGlkKF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgb3duZXJNSVRbX2Zyb21dID49IF92YWx1ZSkgew0KICAgICAgICAgICAgb3duZXJNSVRbX3RvXSArPSBfdmFsdWU7DQogICAgICAgICAgICBvd25lck1JVFtfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBJbXBsZW1lbnRzIEVSQzIwIGFwcHJvdmUoKQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIGlzQWN0aXZlIGFsbG93YW5jZUlzWmVybyhfc3BlbmRlciwgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgYWxsb3dhbmNlKCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJlbWFpbmluZyA9IGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgfQ0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIE1haW5zdHJlZXRDcm93ZGZ1bmQNCiAqLw0KY29udHJhY3QgTWFpbnN0cmVldENyb3dkZnVuZCB7DQoNCiAgICB1aW50IHB1YmxpYyBzdGFydDsNCiAgICB1aW50IHB1YmxpYyBlbmQ7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBzZW5kZXJFVEg7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgc2VuZGVyTUlUOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHJlY2lwaWVudEVUSDsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyByZWNpcGllbnRNSVQ7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcmVjaXBpZW50RXh0cmFNSVQ7DQoNCiAgICB1aW50IHB1YmxpYyB0b3RhbEVUSDsNCiAgICB1aW50IHB1YmxpYyBsaW1pdEVUSDsNCg0KICAgIHVpbnQgcHVibGljIGJvbnVzMVN0YXJ0RVRIOw0KICAgIHVpbnQgcHVibGljIGJvbnVzMlN0YXJ0RVRIOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRBZGRyZXNzZXM7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBleGl0QWRkcmVzczsNCiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOw0KDQogICAgTWFpbnN0cmVldFRva2VuIHB1YmxpYyBtYWluc3RyZWV0VG9rZW47DQoNCiAgICBldmVudCBNSVRQdXJjaGFzZShhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCBhZGRyZXNzIGluZGV4ZWQgcmVjaXBpZW50LCB1aW50IEVUSCwgdWludCBNSVQpOw0KDQogICAgbW9kaWZpZXIgc2FsZUFjdGl2ZSgpIHsNCiAgICAgICAgaWYgKGFkZHJlc3MobWFpbnN0cmVldFRva2VuKSA9PSAwKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYmxvY2sudGltZXN0YW1wIDwgc3RhcnQgfHwgYmxvY2sudGltZXN0YW1wID49IGVuZCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRvdGFsRVRIICsgbXNnLnZhbHVlID4gbGltaXRFVEgpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgaGFzVmFsdWUoKSB7DQogICAgICAgIGlmIChtc2cudmFsdWUgPT0gMCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBzZW5kZXJJc1doaXRlbGlzdGVkKCkgew0KICAgICAgICBpZiAod2hpdGVsaXN0ZWRBZGRyZXNzZXNbbXNnLnNlbmRlcl0gIT0gdHJ1ZSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciByZWNpcGllbnRJc1ZhbGlkKGFkZHJlc3MgcmVjaXBpZW50KSB7DQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCB8fCByZWNpcGllbnQgPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc0NyZWF0b3IoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGNyZWF0b3IpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgdG9rZW5Db250cmFjdE5vdFNldCgpIHsNCiAgICAgICAgaWYgKGFkZHJlc3MobWFpbnN0cmVldFRva2VuKSAhPSAwKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXYgQ29uc3RydWN0b3IuDQogICAgICogQHBhcmFtIF9zdGFydCBUaW1lc3RhbXAgb2Ygd2hlbiB0aGUgY3Jvd2RzYWxlIHdpbGwgc3RhcnQuDQogICAgICogQHBhcmFtIF9lbmQgVGltZXN0YW1wIG9mIHdoZW4gdGhlIGNyb3dkc2FsZSB3aWxsIGVuZC4NCiAgICAgKiBAcGFyYW0gX2xpbWl0RVRIIE1heGltdW0gYW1vdW50IG9mIEVUSCB0aGF0IGNhbiBiZSBzZW50IHRvIHRoZSBjb250cmFjdCBpbiB0b3RhbC4gRGVub21pbmF0ZWQgaW4gd2VpLg0KICAgICAqIEBwYXJhbSBfYm9udXMxU3RhcnRFVEggQW1vdW50IG9mIEV0aGVyIChkZW5vbWluYXRlZCBpbiB3ZWkpIHRoYXQgaXMgcmVxdWlyZWQgdG8gcXVhbGlmeSBmb3IgdGhlIGZpcnN0IGJvbnVzLg0KICAgICAqIEBwYXJhbSBfYm9udXMxU3RhcnRFVEggQW1vdW50IG9mIEV0aGVyIChkZW5vbWluYXRlZCBpbiB3ZWkpIHRoYXQgaXMgcmVxdWlyZWQgdG8gcXVhbGlmeSBmb3IgdGhlIHNlY29uZCBib251cy4NCiAgICAgKiBAcGFyYW0gX2V4aXRBZGRyZXNzIEFkZHJlc3MgdGhhdCBhbGwgRVRIIHNob3VsZCBiZSBmb3J3YXJkZWQgdG8uDQogICAgICogQHBhcmFtIHdoaXRlbGlzdDEgRmlyc3QgYWRkcmVzcyB0aGF0IGNhbiBzZW5kIEVUSC4NCiAgICAgKiBAcGFyYW0gd2hpdGVsaXN0MiBTZWNvbmQgYWRkcmVzcyB0aGF0IGNhbiBzZW5kIEVUSC4NCiAgICAgKiBAcGFyYW0gd2hpdGVsaXN0MyBUaGlyZCBhZGRyZXNzIHRoYXQgY2FuIHNlbmQgRVRILg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIE1haW5zdHJlZXRDcm93ZGZ1bmQodWludCBfc3RhcnQsIHVpbnQgX2VuZCwgdWludCBfbGltaXRFVEgsIHVpbnQgX2JvbnVzMVN0YXJ0RVRILCB1aW50IF9ib251czJTdGFydEVUSCwgYWRkcmVzcyBfZXhpdEFkZHJlc3MsIGFkZHJlc3Mgd2hpdGVsaXN0MSwgYWRkcmVzcyB3aGl0ZWxpc3QyLCBhZGRyZXNzIHdoaXRlbGlzdDMpIHsNCiAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7DQogICAgICAgIHN0YXJ0ID0gX3N0YXJ0Ow0KICAgICAgICBlbmQgPSBfZW5kOw0KICAgICAgICBsaW1pdEVUSCA9IF9saW1pdEVUSDsNCiAgICAgICAgYm9udXMxU3RhcnRFVEggPSBfYm9udXMxU3RhcnRFVEg7DQogICAgICAgIGJvbnVzMlN0YXJ0RVRIID0gX2JvbnVzMlN0YXJ0RVRIOw0KDQogICAgICAgIHdoaXRlbGlzdGVkQWRkcmVzc2VzW3doaXRlbGlzdDFdID0gdHJ1ZTsNCiAgICAgICAgd2hpdGVsaXN0ZWRBZGRyZXNzZXNbd2hpdGVsaXN0Ml0gPSB0cnVlOw0KICAgICAgICB3aGl0ZWxpc3RlZEFkZHJlc3Nlc1t3aGl0ZWxpc3QzXSA9IHRydWU7DQogICAgICAgIGV4aXRBZGRyZXNzID0gX2V4aXRBZGRyZXNzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBkZXYgU2V0IHRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdC4gTXVzdCBiZSBjYWxsZWQgYnkgY3JlYXRvciBvZiB0aGlzLiBDYW4gb25seSBiZSBzZXQgb25jZS4NCiAgICAgKiBAcGFyYW0gX21haW5zdHJlZXRUb2tlbiBBZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdC4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBzZXRUb2tlbkNvbnRyYWN0KE1haW5zdHJlZXRUb2tlbiBfbWFpbnN0cmVldFRva2VuKSBleHRlcm5hbCBpc0NyZWF0b3IgdG9rZW5Db250cmFjdE5vdFNldCB7DQogICAgICAgIG1haW5zdHJlZXRUb2tlbiA9IF9tYWluc3RyZWV0VG9rZW47DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBGb3J3YXJkIEV0aGVyIHRvIHRoZSBleGl0IGFkZHJlc3MuIFN0b3JlIGFsbCBFVEggYW5kIE1JVCBpbmZvcm1hdGlvbiBpbiBwdWJsaWMgc3RhdGUgYW5kIGxvZ3MuDQogICAgICogQHBhcmFtIHJlY2lwaWVudCBBZGRyZXNzIHRoYXQgdG9rZW5zIHNob3VsZCBiZSBhdHRyaWJ1dGVkIHRvLg0KICAgICAqIEByZXR1cm4gTUlUIEFtb3VudCBvZiBNSVQgcHVyY2hhc2VkLiBUaGlzIGRvZXMgbm90IGluY2x1ZGUgdGhlIHBlci1yZWNpcGllbnQgcXVhbnRpdHkgYm9udXMuDQogICAgICovDQogICAgZnVuY3Rpb24gcHVyY2hhc2VNSVQoYWRkcmVzcyByZWNpcGllbnQpIGV4dGVybmFsIHNlbmRlcklzV2hpdGVsaXN0ZWQgcGF5YWJsZSBzYWxlQWN0aXZlIGhhc1ZhbHVlIHJlY2lwaWVudElzVmFsaWQocmVjaXBpZW50KSByZXR1cm5zICh1aW50IGluY3JlYXNlTUlUKSB7DQoNCiAgICAgICAgLy8gQXR0ZW1wdCB0byBzZW5kIHRoZSBFVEggdG8gdGhlIGV4aXQgYWRkcmVzcy4NCiAgICAgICAgaWYgKCFleGl0QWRkcmVzcy5zZW5kKG1zZy52YWx1ZSkpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gVXBkYXRlIEVUSCBhbW91bnRzLg0KICAgICAgICBzZW5kZXJFVEhbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlOw0KICAgICAgICByZWNpcGllbnRFVEhbcmVjaXBpZW50XSArPSBtc2cudmFsdWU7DQogICAgICAgIHRvdGFsRVRIICs9IG1zZy52YWx1ZTsNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgTUlUIHB1cmNoYXNlZCBkaXJlY3RseSBpbiB0aGlzIHRyYW5zYWN0aW9uLg0KICAgICAgICB1aW50IE1JVCA9IG1zZy52YWx1ZSAqIDEwOyAgIC8vICQxIC8gTUlUIGJhc2VkIG9uICQxMCAvIEVUSCB2YWx1ZQ0KDQogICAgICAgIC8vIENhbGN1bGF0ZSB0aW1lLWJhc2VkIGJvbnVzLg0KICAgICAgICBpZiAoYmxvY2sudGltZXN0YW1wIC0gc3RhcnQgPCAyIHdlZWtzKSB7DQogICAgICAgICAgICBNSVQgKz0gTUlUIC8gMTA7ICAgIC8vIDEwJSBib251cw0KICAgICAgICB9DQogICAgICAgIGVsc2UgaWYgKGJsb2NrLnRpbWVzdGFtcCAtIHN0YXJ0IDwgNSB3ZWVrcykgew0KICAgICAgICAgICAgTUlUICs9IE1JVCAvIDIwOyAgICAvLyA1JSBib251cw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gUmVjb3JkIGRpcmVjdGx5LXB1cmNoYXNlZCBNSVQuDQogICAgICAgIHNlbmRlck1JVFttc2cuc2VuZGVyXSArPSBNSVQ7DQogICAgICAgIHJlY2lwaWVudE1JVFtyZWNpcGllbnRdICs9IE1JVDsNCg0KICAgICAgICAvLyBTdG9yZSBwcmV2aW91cyB2YWx1ZS1iYXNlZCBib251cyBmb3IgdGhpcyBhZGRyZXNzLg0KICAgICAgICB1aW50IG9sZEV4dHJhID0gcmVjaXBpZW50RXh0cmFNSVRbcmVjaXBpZW50XTsNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IHZhbHVlLWJhc2VkIGJvbnVzLg0KICAgICAgICBpZiAocmVjaXBpZW50RVRIW3JlY2lwaWVudF0gPj0gYm9udXMyU3RhcnRFVEgpIHsNCiAgICAgICAgICAgIHJlY2lwaWVudEV4dHJhTUlUW3JlY2lwaWVudF0gPSAocmVjaXBpZW50TUlUW3JlY2lwaWVudF0gKiA3NSkgLyAxMDAwOyAgICAgIC8vIDcuNSUgYm9udXMNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmIChyZWNpcGllbnRFVEhbcmVjaXBpZW50XSA+PSBib251czFTdGFydEVUSCkgew0KICAgICAgICAgICAgcmVjaXBpZW50RXh0cmFNSVRbcmVjaXBpZW50XSA9IChyZWNpcGllbnRNSVRbcmVjaXBpZW50XSAqIDM3NSkgLyAxMDAwMDsgICAgICAvLyAzLjc1JSBib251cw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIE1JVCBpbmNyZWFzZSBmb3IgdGhpcyBhZGRyZXNzIGZyb20gdGhpcyB0cmFuc2FjdGlvbi4NCiAgICAgICAgaW5jcmVhc2VNSVQgPSBNSVQgKyAocmVjaXBpZW50RXh0cmFNSVRbcmVjaXBpZW50XSAtIG9sZEV4dHJhKTsNCg0KICAgICAgICAvLyBUZWxsIHRoZSB0b2tlbiBjb250cmFjdCBhYm91dCB0aGUgaW5jcmVhc2UuDQogICAgICAgIG1haW5zdHJlZXRUb2tlbi5hZGRUb2tlbnMocmVjaXBpZW50LCBpbmNyZWFzZU1JVCk7DQoNCiAgICAgICAgLy8gTG9nIHRoaXMgcHVyY2hhc2UuDQogICAgICAgIE1JVFB1cmNoYXNlKG1zZy5zZW5kZXIsIHJlY2lwaWVudCwgbXNnLnZhbHVlLCBpbmNyZWFzZU1JVCk7DQogICAgfQ0KDQp9'