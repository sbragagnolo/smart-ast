base 64 content
base64mainstreetCrowdfund2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQoNCi8qKg0KICogQHRpdGxlIEVSQzIwDQogKi8NCmNvbnRyYWN0IEVSQzIwIHsNCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KICAgIA0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIE1haW5zdHJlZXRUb2tlbg0KICovDQpjb250cmFjdCBNYWluc3RyZWV0VG9rZW4gaXMgRVJDMjAgew0KICAgIA0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgb3duZXJNSVQ7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOw0KICAgIHVpbnQgcHVibGljIHRvdGFsTUlUOw0KICAgIHVpbnQgcHVibGljIHN0YXJ0Ow0KICAgIA0KICAgIGFkZHJlc3MgcHVibGljIG1haW5zdHJlZXRDcm93ZGZ1bmQ7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBpbnRlbGxpc3lzOw0KICAgIA0KICAgIGJvb2wgcHVibGljIHRlc3Rpbmc7DQoNCiAgICBtb2RpZmllciBmcm9tQ3Jvd2RmdW5kKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBtYWluc3RyZWV0Q3Jvd2RmdW5kKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCiAgICANCiAgICBtb2RpZmllciBpc0FjdGl2ZSgpIHsNCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA8IHN0YXJ0KSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGlzTm90QWN0aXZlKCkgew0KICAgICAgICBpZiAoIXRlc3RpbmcgJiYgYmxvY2sudGltZXN0YW1wID49IHN0YXJ0KSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHJlY2lwaWVudElzVmFsaWQoYWRkcmVzcyByZWNpcGllbnQpIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwIHx8IHJlY2lwaWVudCA9PSBhZGRyZXNzKHRoaXMpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHNlbmRlckhhc1N1ZmZpY2llbnQodWludCBNSVQpIHsNCiAgICAgICAgaWYgKG93bmVyTUlUW21zZy5zZW5kZXJdIDwgTUlUKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHRyYW5zZmVyQXBwcm92ZWQoYWRkcmVzcyBmcm9tLCB1aW50IE1JVCkgew0KICAgICAgICBpZiAoYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXSA8IE1JVCB8fCBvd25lck1JVFtmcm9tXSA8IE1JVCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBhbGxvd2FuY2VJc1plcm8oYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSB7DQogICAgICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXMmIzE4MDsNCiAgICAgICAgLy8gYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwwKWAgaWYgaXQgaXMgbm90DQogICAgICAgIC8vIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5DQogICAgICAgIGlmICgodmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bc3BlbmRlcl0gIT0gMCkpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBUb2tlbnMgaGF2ZSBiZWVuIGFkZGVkIHRvIGFuIGFkZHJlc3MgYnkgdGhlIGNyb3dkZnVuZGluZyBjb250cmFjdC4NCiAgICAgKiBAcGFyYW0gcmVjaXBpZW50IEFkZHJlc3MgcmVjZWl2aW5nIHRoZSBNSVQuDQogICAgICogQHBhcmFtIE1JVCBBbW91bnQgb2YgTUlUIGFkZGVkLg0KICAgICAqLw0KICAgIGV2ZW50IFRva2Vuc0FkZGVkKGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQgTUlUKTsNCg0KICAgIC8qKg0KICAgICAqIEBkZXYgQ29uc3RydWN0b3IuDQogICAgICogQHBhcmFtIF9tYWluc3RyZWV0Q3Jvd2RmdW5kIEFkZHJlc3Mgb2YgY3Jvd2RmdW5kIGNvbnRyYWN0Lg0KICAgICAqIEBwYXJhbSBfaW50ZWxsaXN5cyBBZGRyZXNzIHRvIHJlY2VpdmUgaW50ZWxsaXN5cycgdG9rZW5zLg0KICAgICAqIEBwYXJhbSBfc3RhcnQgVGltZXN0YW1wIHdoZW4gdGhlIHRva2VuIGJlY29tZXMgYWN0aXZlLg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIE1haW5zdHJlZXRUb2tlbihhZGRyZXNzIF9tYWluc3RyZWV0Q3Jvd2RmdW5kLCBhZGRyZXNzIF9pbnRlbGxpc3lzLCB1aW50IF9zdGFydCwgYm9vbCBfdGVzdGluZykgew0KICAgICAgICBtYWluc3RyZWV0Q3Jvd2RmdW5kID0gX21haW5zdHJlZXRDcm93ZGZ1bmQ7DQogICAgICAgIGludGVsbGlzeXMgPSBfaW50ZWxsaXN5czsNCiAgICAgICAgc3RhcnQgPSBfc3RhcnQ7DQogICAgICAgIHRlc3RpbmcgPSBfdGVzdGluZzsNCiAgICB9DQogICAgDQogICAgLyoqDQogICAgICogQGRldiBBZGQgdG8gdG9rZW4gYmFsYW5jZSBvbiBhZGRyZXNzLiBNdXN0IGJlIGZyb20gY3Jvd2RmdW5kLg0KICAgICAqIEBwYXJhbSByZWNpcGllbnQgQWRkcmVzcyB0byBhZGQgdG9rZW5zIHRvLg0KICAgICAqIEByZXR1cm4gTUlUIEFtb3VudCBvZiBNSVQgdG8gYWRkLg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGFkZFRva2VucyhhZGRyZXNzIHJlY2lwaWVudCwgdWludCBNSVQpIGV4dGVybmFsIGlzTm90QWN0aXZlIGZyb21Dcm93ZGZ1bmQgew0KICAgICAgICBvd25lck1JVFtyZWNpcGllbnRdICs9IE1JVDsNCiAgICAgICAgdWludCBpbnRlbGxpc3lzTUlUID0gTUlUIC8gMTA7DQogICAgICAgIG93bmVyTUlUW2ludGVsbGlzeXNdICs9IGludGVsbGlzeXNNSVQ7DQogICAgICAgIHRvdGFsTUlUICs9IE1JVCArIGludGVsbGlzeXNNSVQ7DQogICAgICAgIFRva2Vuc0FkZGVkKHJlY2lwaWVudCwgTUlUKTsNCiAgICAgICAgVG9rZW5zQWRkZWQoaW50ZWxsaXN5cywgaW50ZWxsaXN5c01JVCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBJbXBsZW1lbnRzIEVSQzIwIHRvdGFsU3VwcGx5KCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpIHsNCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b3RhbE1JVDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgYmFsYW5jZU9mKCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgICAgICBiYWxhbmNlID0gb3duZXJNSVRbX293bmVyXTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgdHJhbnNmZXIoKQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgaXNBY3RpdmUgcmVjaXBpZW50SXNWYWxpZChfdG8pIHNlbmRlckhhc1N1ZmZpY2llbnQoX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgb3duZXJNSVRbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgICBvd25lck1JVFtfdG9dICs9IF92YWx1ZTsNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgdHJhbnNmZXJGcm9tKCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc0FjdGl2ZSByZWNpcGllbnRJc1ZhbGlkKF90bykgdHJhbnNmZXJBcHByb3ZlZChfZnJvbSwgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgb3duZXJNSVRbX3RvXSArPSBfdmFsdWU7DQogICAgICAgIG93bmVyTUlUW19mcm9tXSAtPSBfdmFsdWU7DQogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBJbXBsZW1lbnRzIEVSQzIwIGFwcHJvdmUoKQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIGlzQWN0aXZlIGFsbG93YW5jZUlzWmVybyhfc3BlbmRlciwgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGV2IEltcGxlbWVudHMgRVJDMjAgYWxsb3dhbmNlKCkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJlbWFpbmluZyA9IGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgfQ0KDQp9DQoNCg0KLyoqDQogKiBAdGl0bGUgTWFpbnN0cmVldENyb3dkZnVuZA0KICovDQpjb250cmFjdCBNYWluc3RyZWV0Q3Jvd2RmdW5kIHsNCiAgICANCiAgICB1aW50IHB1YmxpYyBzdGFydDsNCiAgICB1aW50IHB1YmxpYyBlbmQ7DQoNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBzZW5kZXJFVEg7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgc2VuZGVyTUlUOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHJlY2lwaWVudEVUSDsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyByZWNpcGllbnRNSVQ7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcmVjaXBpZW50RXh0cmFNSVQ7DQoNCiAgICB1aW50IHB1YmxpYyB0b3RhbEVUSDsNCiAgICB1aW50IHB1YmxpYyBsaW1pdEVUSDsNCg0KICAgIHVpbnQgcHVibGljIGJvbnVzMVN0YXJ0RVRIOw0KICAgIHVpbnQgcHVibGljIGJvbnVzMlN0YXJ0RVRIOw0KDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgd2hpdGVsaXN0ZWRBZGRyZXNzZXM7DQogICAgDQogICAgYWRkcmVzcyBwdWJsaWMgZXhpdEFkZHJlc3M7DQogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsNCg0KICAgIE1haW5zdHJlZXRUb2tlbiBwdWJsaWMgbWFpbnN0cmVldFRva2VuOw0KDQogICAgZXZlbnQgTUlUUHVyY2hhc2UoYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgYWRkcmVzcyBpbmRleGVkIHJlY2lwaWVudCwgdWludCBFVEgsIHVpbnQgTUlUKTsNCg0KICAgIG1vZGlmaWVyIHNhbGVBY3RpdmUoKSB7DQogICAgICAgIGlmIChhZGRyZXNzKG1haW5zdHJlZXRUb2tlbikgPT0gMCkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCA8IHN0YXJ0IHx8IGJsb2NrLnRpbWVzdGFtcCA+PSBlbmQpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIGlmICh0b3RhbEVUSCArIG1zZy52YWx1ZSA+IGxpbWl0RVRIKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGhhc1ZhbHVlKCkgew0KICAgICAgICBpZiAobXNnLnZhbHVlID09IDApIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KICAgIA0KICAgIG1vZGlmaWVyIHNlbmRlcklzV2hpdGVsaXN0ZWQoKSB7DQogICAgICAgIGlmICh3aGl0ZWxpc3RlZEFkZHJlc3Nlc1ttc2cuc2VuZGVyXSAhPSB0cnVlKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHJlY2lwaWVudElzVmFsaWQoYWRkcmVzcyByZWNpcGllbnQpIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwIHx8IHJlY2lwaWVudCA9PSBhZGRyZXNzKHRoaXMpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGlzQ3JlYXRvcigpIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciB0b2tlbkNvbnRyYWN0Tm90U2V0KCkgew0KICAgICAgICBpZiAoYWRkcmVzcyhtYWluc3RyZWV0VG9rZW4pICE9IDApIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBDb25zdHJ1Y3Rvci4NCiAgICAgKiBAcGFyYW0gX3N0YXJ0IFRpbWVzdGFtcCBvZiB3aGVuIHRoZSBjcm93ZHNhbGUgd2lsbCBzdGFydC4NCiAgICAgKiBAcGFyYW0gX2VuZCBUaW1lc3RhbXAgb2Ygd2hlbiB0aGUgY3Jvd2RzYWxlIHdpbGwgZW5kLg0KICAgICAqIEBwYXJhbSBfbGltaXRFVEggTWF4aW11bSBhbW91bnQgb2YgRVRIIHRoYXQgY2FuIGJlIHNlbnQgdG8gdGhlIGNvbnRyYWN0IGluIHRvdGFsLiBEZW5vbWluYXRlZCBpbiB3ZWkuDQogICAgICogQHBhcmFtIF9ib251czFTdGFydEVUSCBBbW91bnQgb2YgRXRoZXIgKGRlbm9taW5hdGVkIGluIHdlaSkgdGhhdCBpcyByZXF1aXJlZCB0byBxdWFsaWZ5IGZvciB0aGUgZmlyc3QgYm9udXMuDQogICAgICogQHBhcmFtIF9ib251czFTdGFydEVUSCBBbW91bnQgb2YgRXRoZXIgKGRlbm9taW5hdGVkIGluIHdlaSkgdGhhdCBpcyByZXF1aXJlZCB0byBxdWFsaWZ5IGZvciB0aGUgc2Vjb25kIGJvbnVzLg0KICAgICAqIEBwYXJhbSBfZXhpdEFkZHJlc3MgQWRkcmVzcyB0aGF0IGFsbCBFVEggc2hvdWxkIGJlIGZvcndhcmRlZCB0by4NCiAgICAgKiBAcGFyYW0gd2hpdGVsaXN0MSBGaXJzdCBhZGRyZXNzIHRoYXQgY2FuIHNlbmQgRVRILg0KICAgICAqIEBwYXJhbSB3aGl0ZWxpc3QyIFNlY29uZCBhZGRyZXNzIHRoYXQgY2FuIHNlbmQgRVRILg0KICAgICAqIEBwYXJhbSB3aGl0ZWxpc3QzIFRoaXJkIGFkZHJlc3MgdGhhdCBjYW4gc2VuZCBFVEguDQogICAgICovDQogICAgZnVuY3Rpb24gTWFpbnN0cmVldENyb3dkZnVuZCh1aW50IF9zdGFydCwgdWludCBfZW5kLCB1aW50IF9saW1pdEVUSCwgdWludCBfYm9udXMxU3RhcnRFVEgsIHVpbnQgX2JvbnVzMlN0YXJ0RVRILCBhZGRyZXNzIF9leGl0QWRkcmVzcywgYWRkcmVzcyB3aGl0ZWxpc3QxLCBhZGRyZXNzIHdoaXRlbGlzdDIsIGFkZHJlc3Mgd2hpdGVsaXN0Mykgew0KICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsNCiAgICAgICAgc3RhcnQgPSBfc3RhcnQ7DQogICAgICAgIGVuZCA9IF9lbmQ7DQogICAgICAgIGxpbWl0RVRIID0gX2xpbWl0RVRIOw0KICAgICAgICBib251czFTdGFydEVUSCA9IF9ib251czFTdGFydEVUSDsNCiAgICAgICAgYm9udXMyU3RhcnRFVEggPSBfYm9udXMyU3RhcnRFVEg7DQoNCiAgICAgICAgd2hpdGVsaXN0ZWRBZGRyZXNzZXNbd2hpdGVsaXN0MV0gPSB0cnVlOw0KICAgICAgICB3aGl0ZWxpc3RlZEFkZHJlc3Nlc1t3aGl0ZWxpc3QyXSA9IHRydWU7DQogICAgICAgIHdoaXRlbGlzdGVkQWRkcmVzc2VzW3doaXRlbGlzdDNdID0gdHJ1ZTsNCiAgICAgICAgZXhpdEFkZHJlc3MgPSBfZXhpdEFkZHJlc3M7DQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAqIEBkZXYgU2V0IHRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdC4gTXVzdCBiZSBjYWxsZWQgYnkgY3JlYXRvciBvZiB0aGlzLiBDYW4gb25seSBiZSBzZXQgb25jZS4NCiAgICAgKiBAcGFyYW0gX21haW5zdHJlZXRUb2tlbiBBZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdC4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBzZXRUb2tlbkNvbnRyYWN0KE1haW5zdHJlZXRUb2tlbiBfbWFpbnN0cmVldFRva2VuKSBleHRlcm5hbCBpc0NyZWF0b3IgdG9rZW5Db250cmFjdE5vdFNldCB7DQogICAgICAgIG1haW5zdHJlZXRUb2tlbiA9IF9tYWluc3RyZWV0VG9rZW47DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQGRldiBGb3J3YXJkIEV0aGVyIHRvIHRoZSBleGl0IGFkZHJlc3MuIFN0b3JlIGFsbCBFVEggYW5kIE1JVCBpbmZvcm1hdGlvbiBpbiBwdWJsaWMgc3RhdGUgYW5kIGxvZ3MuDQogICAgICogQHBhcmFtIHJlY2lwaWVudCBBZGRyZXNzIHRoYXQgdG9rZW5zIHNob3VsZCBiZSBhdHRyaWJ1dGVkIHRvLg0KICAgICAqIEByZXR1cm4gTUlUIEFtb3VudCBvZiBNSVQgcHVyY2hhc2VkLiBUaGlzIGRvZXMgbm90IGluY2x1ZGUgdGhlIHBlci1yZWNpcGllbnQgcXVhbnRpdHkgYm9udXMuDQogICAgICovDQogICAgZnVuY3Rpb24gcHVyY2hhc2VNSVQoYWRkcmVzcyByZWNpcGllbnQpIGV4dGVybmFsIHNlbmRlcklzV2hpdGVsaXN0ZWQgcGF5YWJsZSBzYWxlQWN0aXZlIGhhc1ZhbHVlIHJlY2lwaWVudElzVmFsaWQocmVjaXBpZW50KSByZXR1cm5zICh1aW50IGluY3JlYXNlTUlUKSB7DQogICAgICAgIA0KICAgICAgICAvLyBBdHRlbXB0IHRvIHNlbmQgdGhlIEVUSCB0byB0aGUgZXhpdCBhZGRyZXNzLg0KICAgICAgICBpZiAoIWV4aXRBZGRyZXNzLnNlbmQobXNnLnZhbHVlKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIFVwZGF0ZSBFVEggYW1vdW50cy4NCiAgICAgICAgc2VuZGVyRVRIW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZTsNCiAgICAgICAgcmVjaXBpZW50RVRIW3JlY2lwaWVudF0gKz0gbXNnLnZhbHVlOw0KICAgICAgICB0b3RhbEVUSCArPSBtc2cudmFsdWU7DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIE1JVCBwdXJjaGFzZWQgZGlyZWN0bHkgaW4gdGhpcyB0cmFuc2FjdGlvbi4NCiAgICAgICAgdWludCBNSVQgPSBtc2cudmFsdWUgKiAxMDsgICAvLyAkMSAvIE1JVCBiYXNlZCBvbiAkMTAgLyBFVEggdmFsdWUNCg0KICAgICAgICAvLyBDYWxjdWxhdGUgdGltZS1iYXNlZCBib251cy4NCiAgICAgICAgaWYgKGJsb2NrLnRpbWVzdGFtcCAtIHN0YXJ0IDwgMSB3ZWVrcykgew0KICAgICAgICAgICAgTUlUICs9IE1JVCAvIDEwOyAgICAvLyAxMCUgYm9udXMNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmIChibG9jay50aW1lc3RhbXAgLSBzdGFydCA8IDUgd2Vla3MpIHsNCiAgICAgICAgICAgIE1JVCArPSBNSVQgLyAyMDsgICAgLy8gNSUgYm9udXMNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJlY29yZCBkaXJlY3RseS1wdXJjaGFzZWQgTUlULg0KICAgICAgICBzZW5kZXJNSVRbbXNnLnNlbmRlcl0gKz0gTUlUOw0KICAgICAgICByZWNpcGllbnRNSVRbcmVjaXBpZW50XSArPSBNSVQ7DQoNCiAgICAgICAgLy8gU3RvcmUgcHJldmlvdXMgdmFsdWUtYmFzZWQgYm9udXMgZm9yIHRoaXMgYWRkcmVzcy4NCiAgICAgICAgdWludCBvbGRFeHRyYSA9IHJlY2lwaWVudEV4dHJhTUlUW3JlY2lwaWVudF07DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyB2YWx1ZS1iYXNlZCBib251cy4NCiAgICAgICAgaWYgKHJlY2lwaWVudEVUSFtyZWNpcGllbnRdID49IGJvbnVzMlN0YXJ0RVRIKSB7DQogICAgICAgICAgICByZWNpcGllbnRFeHRyYU1JVFtyZWNpcGllbnRdID0gKHJlY2lwaWVudE1JVFtyZWNpcGllbnRdICogOCkgLyAxMDA7ICAgICAgLy8gOCUgYm9udXMNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmIChyZWNpcGllbnRFVEhbcmVjaXBpZW50XSA+PSBib251czFTdGFydEVUSCkgew0KICAgICAgICAgICAgcmVjaXBpZW50RXh0cmFNSVRbcmVjaXBpZW50XSA9IChyZWNpcGllbnRNSVRbcmVjaXBpZW50XSAqIDQpIC8gMTAwOyAgICAgIC8vIDQlIGJvbnVzDQogICAgICAgIH0NCg0KICAgICAgICAvLyBDYWxjdWxhdGUgTUlUIGluY3JlYXNlIGZvciB0aGlzIGFkZHJlc3MgZnJvbSB0aGlzIHRyYW5zYWN0aW9uLg0KICAgICAgICBpbmNyZWFzZU1JVCA9IE1JVCArIChyZWNpcGllbnRFeHRyYU1JVFtyZWNpcGllbnRdIC0gb2xkRXh0cmEpOw0KDQogICAgICAgIC8vIFRlbGwgdGhlIHRva2VuIGNvbnRyYWN0IGFib3V0IHRoZSBpbmNyZWFzZS4NCiAgICAgICAgbWFpbnN0cmVldFRva2VuLmFkZFRva2VucyhyZWNpcGllbnQsIGluY3JlYXNlTUlUKTsNCg0KICAgICAgICAvLyBMb2cgdGhpcyBwdXJjaGFzZS4NCiAgICAgICAgTUlUUHVyY2hhc2UobXNnLnNlbmRlciwgcmVjaXBpZW50LCBtc2cudmFsdWUsIGluY3JlYXNlTUlUKTsNCiAgICB9DQoNCn0='