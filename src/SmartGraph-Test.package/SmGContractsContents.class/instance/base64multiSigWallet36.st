base 64 content
base64multiSigWallet36
	^'LyoqDQogKiBPcmlnaW5hbGx5IGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0NvbnNlblN5cy9NdWx0aVNpZ1dhbGxldA0KICovDQoNCg0KDQovLy8gQHRpdGxlIE11bHRpc2lnbmF0dXJlIHdhbGxldCAtIEFsbG93cyBtdWx0aXBsZSBwYXJ0aWVzIHRvIGFncmVlIG9uIHRyYW5zYWN0aW9ucyBiZWZvcmUgZXhlY3V0aW9uLg0KLy8vIEBhdXRob3IgU3RlZmFuIEdlb3JnZSAtIDxzdGVmYW4uZ2VvcmdlQGNvbnNlbnN5cy5uZXQ+DQpjb250cmFjdCBNdWx0aVNpZ1dhbGxldCB7DQoNCiAgICB1aW50IGNvbnN0YW50IHB1YmxpYyBNQVhfT1dORVJfQ09VTlQgPSA1MDsNCg0KICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7DQogICAgZXZlbnQgUmV2b2NhdGlvbihhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7DQogICAgZXZlbnQgU3VibWlzc2lvbih1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7DQogICAgZXZlbnQgRXhlY3V0aW9uKHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsNCiAgICBldmVudCBFeGVjdXRpb25GYWlsdXJlKHVpbnQgaW5kZXhlZCB0cmFuc2FjdGlvbklkKTsNCiAgICBldmVudCBEZXBvc2l0KGFkZHJlc3MgaW5kZXhlZCBzZW5kZXIsIHVpbnQgdmFsdWUpOw0KICAgIGV2ZW50IE93bmVyQWRkaXRpb24oYWRkcmVzcyBpbmRleGVkIG93bmVyKTsNCiAgICBldmVudCBPd25lclJlbW92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyKTsNCiAgICBldmVudCBSZXF1aXJlbWVudENoYW5nZSh1aW50IHJlcXVpcmVkKTsNCg0KICAgIG1hcHBpbmcgKHVpbnQgPT4gVHJhbnNhY3Rpb24pIHB1YmxpYyB0cmFuc2FjdGlvbnM7DQogICAgbWFwcGluZyAodWludCA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpKSBwdWJsaWMgY29uZmlybWF0aW9uczsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBpc093bmVyOw0KICAgIGFkZHJlc3NbXSBwdWJsaWMgb3duZXJzOw0KICAgIHVpbnQgcHVibGljIHJlcXVpcmVkOw0KICAgIHVpbnQgcHVibGljIHRyYW5zYWN0aW9uQ291bnQ7DQoNCiAgICBzdHJ1Y3QgVHJhbnNhY3Rpb24gew0KICAgICAgICBhZGRyZXNzIGRlc3RpbmF0aW9uOw0KICAgICAgICB1aW50IHZhbHVlOw0KICAgICAgICBieXRlcyBkYXRhOw0KICAgICAgICBib29sIGV4ZWN1dGVkOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG9ubHlXYWxsZXQoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGFkZHJlc3ModGhpcykpDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvd25lckRvZXNOb3RFeGlzdChhZGRyZXNzIG93bmVyKSB7DQogICAgICAgIGlmIChpc093bmVyW293bmVyXSkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG93bmVyRXhpc3RzKGFkZHJlc3Mgb3duZXIpIHsNCiAgICAgICAgaWYgKCFpc093bmVyW293bmVyXSkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHRyYW5zYWN0aW9uRXhpc3RzKHVpbnQgdHJhbnNhY3Rpb25JZCkgew0KICAgICAgICBpZiAodHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdLmRlc3RpbmF0aW9uID09IDApDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBjb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7DQogICAgICAgIGlmICghY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcl0pDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBub3RDb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkLCBhZGRyZXNzIG93bmVyKSB7DQogICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyXSkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG5vdEV4ZWN1dGVkKHVpbnQgdHJhbnNhY3Rpb25JZCkgew0KICAgICAgICBpZiAodHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdLmV4ZWN1dGVkKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgbm90TnVsbChhZGRyZXNzIF9hZGRyZXNzKSB7DQogICAgICAgIGlmIChfYWRkcmVzcyA9PSAwKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgdmFsaWRSZXF1aXJlbWVudCh1aW50IG93bmVyQ291bnQsIHVpbnQgX3JlcXVpcmVkKSB7DQogICAgICAgIGlmICggICBvd25lckNvdW50ID4gTUFYX09XTkVSX0NPVU5UDQogICAgICAgICAgICB8fCBfcmVxdWlyZWQgPiBvd25lckNvdW50DQogICAgICAgICAgICB8fCBfcmVxdWlyZWQgPT0gMA0KICAgICAgICAgICAgfHwgb3duZXJDb3VudCA9PSAwKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLy8vIEBkZXYgRmFsbGJhY2sgZnVuY3Rpb24gYWxsb3dzIHRvIGRlcG9zaXQgZXRoZXIuDQogICAgZnVuY3Rpb24oKQ0KICAgICAgICBwYXlhYmxlDQogICAgew0KICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkNCiAgICAgICAgICAgIERlcG9zaXQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsNCiAgICB9DQoNCiAgICAvKg0KICAgICAqIFB1YmxpYyBmdW5jdGlvbnMNCiAgICAgKi8NCiAgICAvLy8gQGRldiBDb250cmFjdCBjb25zdHJ1Y3RvciBzZXRzIGluaXRpYWwgb3duZXJzIGFuZCByZXF1aXJlZCBudW1iZXIgb2YgY29uZmlybWF0aW9ucy4NCiAgICAvLy8gQHBhcmFtIF9vd25lcnMgTGlzdCBvZiBpbml0aWFsIG93bmVycy4NCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4NCiAgICBmdW5jdGlvbiBNdWx0aVNpZ1dhbGxldChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICB2YWxpZFJlcXVpcmVtZW50KF9vd25lcnMubGVuZ3RoLCBfcmVxdWlyZWQpDQogICAgew0KICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPF9vd25lcnMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChpc093bmVyW19vd25lcnNbaV1dIHx8IF9vd25lcnNbaV0gPT0gMCkNCiAgICAgICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgICAgIGlzT3duZXJbX293bmVyc1tpXV0gPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIG93bmVycyA9IF9vd25lcnM7DQogICAgICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEFsbG93cyB0byBhZGQgYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4NCiAgICAvLy8gQHBhcmFtIG93bmVyIEFkZHJlc3Mgb2YgbmV3IG93bmVyLg0KICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3Mgb3duZXIpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvbmx5V2FsbGV0DQogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KG93bmVyKQ0KICAgICAgICBub3ROdWxsKG93bmVyKQ0KICAgICAgICB2YWxpZFJlcXVpcmVtZW50KG93bmVycy5sZW5ndGggKyAxLCByZXF1aXJlZCkNCiAgICB7DQogICAgICAgIGlzT3duZXJbb3duZXJdID0gdHJ1ZTsNCiAgICAgICAgb3duZXJzLnB1c2gob3duZXIpOw0KICAgICAgICBPd25lckFkZGl0aW9uKG93bmVyKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgdG8gcmVtb3ZlIGFuIG93bmVyLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuDQogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG93bmVyLg0KICAgIGZ1bmN0aW9uIHJlbW92ZU93bmVyKGFkZHJlc3Mgb3duZXIpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvbmx5V2FsbGV0DQogICAgICAgIG93bmVyRXhpc3RzKG93bmVyKQ0KICAgIHsNCiAgICAgICAgaXNPd25lcltvd25lcl0gPSBmYWxzZTsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoIC0gMTsgaSsrKQ0KICAgICAgICAgICAgaWYgKG93bmVyc1tpXSA9PSBvd25lcikgew0KICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG93bmVyc1tvd25lcnMubGVuZ3RoIC0gMV07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIG93bmVycy5sZW5ndGggLT0gMTsNCiAgICAgICAgaWYgKHJlcXVpcmVkID4gb3duZXJzLmxlbmd0aCkNCiAgICAgICAgICAgIGNoYW5nZVJlcXVpcmVtZW50KG93bmVycy5sZW5ndGgpOw0KICAgICAgICBPd25lclJlbW92YWwob3duZXIpOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEFsbG93cyB0byByZXBsYWNlIGFuIG93bmVyIHdpdGggYSBuZXcgb3duZXIuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4NCiAgICAvLy8gQHBhcmFtIG93bmVyIEFkZHJlc3Mgb2Ygb3duZXIgdG8gYmUgcmVwbGFjZWQuDQogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG5ldyBvd25lci4NCiAgICBmdW5jdGlvbiByZXBsYWNlT3duZXIoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBuZXdPd25lcikNCiAgICAgICAgcHVibGljDQogICAgICAgIG9ubHlXYWxsZXQNCiAgICAgICAgb3duZXJFeGlzdHMob3duZXIpDQogICAgICAgIG93bmVyRG9lc05vdEV4aXN0KG5ld093bmVyKQ0KICAgIHsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspDQogICAgICAgICAgICBpZiAob3duZXJzW2ldID09IG93bmVyKSB7DQogICAgICAgICAgICAgICAgb3duZXJzW2ldID0gbmV3T3duZXI7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIGlzT3duZXJbb3duZXJdID0gZmFsc2U7DQogICAgICAgIGlzT3duZXJbbmV3T3duZXJdID0gdHJ1ZTsNCiAgICAgICAgT3duZXJSZW1vdmFsKG93bmVyKTsNCiAgICAgICAgT3duZXJBZGRpdGlvbihuZXdPd25lcik7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgQWxsb3dzIHRvIGNoYW5nZSB0aGUgbnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuIFRyYW5zYWN0aW9uIGhhcyB0byBiZSBzZW50IGJ5IHdhbGxldC4NCiAgICAvLy8gQHBhcmFtIF9yZXF1aXJlZCBOdW1iZXIgb2YgcmVxdWlyZWQgY29uZmlybWF0aW9ucy4NCiAgICBmdW5jdGlvbiBjaGFuZ2VSZXF1aXJlbWVudCh1aW50IF9yZXF1aXJlZCkNCiAgICAgICAgcHVibGljDQogICAgICAgIG9ubHlXYWxsZXQNCiAgICAgICAgdmFsaWRSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoLCBfcmVxdWlyZWQpDQogICAgew0KICAgICAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsNCiAgICAgICAgUmVxdWlyZW1lbnRDaGFuZ2UoX3JlcXVpcmVkKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gc3VibWl0IGFuZCBjb25maXJtIGEgdHJhbnNhY3Rpb24uDQogICAgLy8vIEBwYXJhbSBkZXN0aW5hdGlvbiBUcmFuc2FjdGlvbiB0YXJnZXQgYWRkcmVzcy4NCiAgICAvLy8gQHBhcmFtIHZhbHVlIFRyYW5zYWN0aW9uIGV0aGVyIHZhbHVlLg0KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuDQogICAgLy8vIEByZXR1cm4gUmV0dXJucyB0cmFuc2FjdGlvbiBJRC4NCiAgICBmdW5jdGlvbiBzdWJtaXRUcmFuc2FjdGlvbihhZGRyZXNzIGRlc3RpbmF0aW9uLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgcmV0dXJucyAodWludCB0cmFuc2FjdGlvbklkKQ0KICAgIHsNCiAgICAgICAgdHJhbnNhY3Rpb25JZCA9IGFkZFRyYW5zYWN0aW9uKGRlc3RpbmF0aW9uLCB2YWx1ZSwgZGF0YSk7DQogICAgICAgIGNvbmZpcm1UcmFuc2FjdGlvbih0cmFuc2FjdGlvbklkKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgYW4gb3duZXIgdG8gY29uZmlybSBhIHRyYW5zYWN0aW9uLg0KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4NCiAgICBmdW5jdGlvbiBjb25maXJtVHJhbnNhY3Rpb24odWludCB0cmFuc2FjdGlvbklkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgb3duZXJFeGlzdHMobXNnLnNlbmRlcikNCiAgICAgICAgdHJhbnNhY3Rpb25FeGlzdHModHJhbnNhY3Rpb25JZCkNCiAgICAgICAgbm90Q29uZmlybWVkKHRyYW5zYWN0aW9uSWQsIG1zZy5zZW5kZXIpDQogICAgew0KICAgICAgICBjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW21zZy5zZW5kZXJdID0gdHJ1ZTsNCiAgICAgICAgQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOw0KICAgICAgICBleGVjdXRlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHJldm9rZSBhIGNvbmZpcm1hdGlvbiBmb3IgYSB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgZnVuY3Rpb24gcmV2b2tlQ29uZmlybWF0aW9uKHVpbnQgdHJhbnNhY3Rpb25JZCkNCiAgICAgICAgcHVibGljDQogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpDQogICAgICAgIGNvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQ0KICAgICAgICBub3RFeGVjdXRlZCh0cmFuc2FjdGlvbklkKQ0KICAgIHsNCiAgICAgICAgY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVttc2cuc2VuZGVyXSA9IGZhbHNlOw0KICAgICAgICBSZXZvY2F0aW9uKG1zZy5zZW5kZXIsIHRyYW5zYWN0aW9uSWQpOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEFsbG93cyBhbnlvbmUgdG8gZXhlY3V0ZSBhIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgZnVuY3Rpb24gZXhlY3V0ZVRyYW5zYWN0aW9uKHVpbnQgdHJhbnNhY3Rpb25JZCkNCiAgICAgICAgcHVibGljDQogICAgICAgIG5vdEV4ZWN1dGVkKHRyYW5zYWN0aW9uSWQpDQogICAgew0KICAgICAgICBpZiAoaXNDb25maXJtZWQodHJhbnNhY3Rpb25JZCkpIHsNCiAgICAgICAgICAgIFRyYW5zYWN0aW9uIHR4ID0gdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdOw0KICAgICAgICAgICAgdHguZXhlY3V0ZWQgPSB0cnVlOw0KICAgICAgICAgICAgaWYgKHR4LmRlc3RpbmF0aW9uLmNhbGwudmFsdWUodHgudmFsdWUpKHR4LmRhdGEpKQ0KICAgICAgICAgICAgICAgIEV4ZWN1dGlvbih0cmFuc2FjdGlvbklkKTsNCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIEV4ZWN1dGlvbkZhaWx1cmUodHJhbnNhY3Rpb25JZCk7DQogICAgICAgICAgICAgICAgdHguZXhlY3V0ZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vLyBAZGV2IFJldHVybnMgdGhlIGNvbmZpcm1hdGlvbiBzdGF0dXMgb2YgYSB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgLy8vIEByZXR1cm4gQ29uZmlybWF0aW9uIHN0YXR1cy4NCiAgICBmdW5jdGlvbiBpc0NvbmZpcm1lZCh1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zIChib29sKQ0KICAgIHsNCiAgICAgICAgdWludCBjb3VudCA9IDA7DQogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKQ0KICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7DQogICAgICAgICAgICBpZiAoY291bnQgPT0gcmVxdWlyZWQpDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKg0KICAgICAqIEludGVybmFsIGZ1bmN0aW9ucw0KICAgICAqLw0KICAgIC8vLyBAZGV2IEFkZHMgYSBuZXcgdHJhbnNhY3Rpb24gdG8gdGhlIHRyYW5zYWN0aW9uIG1hcHBpbmcsIGlmIHRyYW5zYWN0aW9uIGRvZXMgbm90IGV4aXN0IHlldC4NCiAgICAvLy8gQHBhcmFtIGRlc3RpbmF0aW9uIFRyYW5zYWN0aW9uIHRhcmdldCBhZGRyZXNzLg0KICAgIC8vLyBAcGFyYW0gdmFsdWUgVHJhbnNhY3Rpb24gZXRoZXIgdmFsdWUuDQogICAgLy8vIEBwYXJhbSBkYXRhIFRyYW5zYWN0aW9uIGRhdGEgcGF5bG9hZC4NCiAgICAvLy8gQHJldHVybiBSZXR1cm5zIHRyYW5zYWN0aW9uIElELg0KICAgIGZ1bmN0aW9uIGFkZFRyYW5zYWN0aW9uKGFkZHJlc3MgZGVzdGluYXRpb24sIHVpbnQgdmFsdWUsIGJ5dGVzIGRhdGEpDQogICAgICAgIGludGVybmFsDQogICAgICAgIG5vdE51bGwoZGVzdGluYXRpb24pDQogICAgICAgIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkNCiAgICB7DQogICAgICAgIHRyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbkNvdW50Ow0KICAgICAgICB0cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZF0gPSBUcmFuc2FjdGlvbih7DQogICAgICAgICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb24sDQogICAgICAgICAgICB2YWx1ZTogdmFsdWUsDQogICAgICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgICAgICAgZXhlY3V0ZWQ6IGZhbHNlDQogICAgICAgIH0pOw0KICAgICAgICB0cmFuc2FjdGlvbkNvdW50ICs9IDE7DQogICAgICAgIFN1Ym1pc3Npb24odHJhbnNhY3Rpb25JZCk7DQogICAgfQ0KDQogICAgLyoNCiAgICAgKiBXZWIzIGNhbGwgZnVuY3Rpb25zDQogICAgICovDQogICAgLy8vIEBkZXYgUmV0dXJucyBudW1iZXIgb2YgY29uZmlybWF0aW9ucyBvZiBhIHRyYW5zYWN0aW9uLg0KICAgIC8vLyBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRC4NCiAgICAvLy8gQHJldHVybiBOdW1iZXIgb2YgY29uZmlybWF0aW9ucy4NCiAgICBmdW5jdGlvbiBnZXRDb25maXJtYXRpb25Db3VudCh1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50IGNvdW50KQ0KICAgIHsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxvd25lcnMubGVuZ3RoOyBpKyspDQogICAgICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcnNbaV1dKQ0KICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgUmV0dXJucyB0b3RhbCBudW1iZXIgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbGVycyBhcmUgYXBwbGllZC4NCiAgICAvLy8gQHBhcmFtIHBlbmRpbmcgSW5jbHVkZSBwZW5kaW5nIHRyYW5zYWN0aW9ucy4NCiAgICAvLy8gQHBhcmFtIGV4ZWN1dGVkIEluY2x1ZGUgZXhlY3V0ZWQgdHJhbnNhY3Rpb25zLg0KICAgIC8vLyBAcmV0dXJuIFRvdGFsIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgYWZ0ZXIgZmlsdGVycyBhcmUgYXBwbGllZC4NCiAgICBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbkNvdW50KGJvb2wgcGVuZGluZywgYm9vbCBleGVjdXRlZCkNCiAgICAgICAgcHVibGljDQogICAgICAgIGNvbnN0YW50DQogICAgICAgIHJldHVybnMgKHVpbnQgY291bnQpDQogICAgew0KICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPHRyYW5zYWN0aW9uQ291bnQ7IGkrKykNCiAgICAgICAgICAgIGlmICggICBwZW5kaW5nICYmICF0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQNCiAgICAgICAgICAgICAgICB8fCBleGVjdXRlZCAmJiB0cmFuc2FjdGlvbnNbaV0uZXhlY3V0ZWQpDQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2Ygb3duZXJzLg0KICAgIC8vLyBAcmV0dXJuIExpc3Qgb2Ygb3duZXIgYWRkcmVzc2VzLg0KICAgIGZ1bmN0aW9uIGdldE93bmVycygpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zIChhZGRyZXNzW10pDQogICAgew0KICAgICAgICByZXR1cm4gb3duZXJzOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IFJldHVybnMgYXJyYXkgd2l0aCBvd25lciBhZGRyZXNzZXMsIHdoaWNoIGNvbmZpcm1lZCB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiBvd25lciBhZGRyZXNzZXMuDQogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9ucyh1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zIChhZGRyZXNzW10gX2NvbmZpcm1hdGlvbnMpDQogICAgew0KICAgICAgICBhZGRyZXNzW10gbWVtb3J5IGNvbmZpcm1hdGlvbnNUZW1wID0gbmV3IGFkZHJlc3NbXShvd25lcnMubGVuZ3RoKTsNCiAgICAgICAgdWludCBjb3VudCA9IDA7DQogICAgICAgIHVpbnQgaTsNCiAgICAgICAgZm9yIChpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkgew0KICAgICAgICAgICAgICAgIGNvbmZpcm1hdGlvbnNUZW1wW2NvdW50XSA9IG93bmVyc1tpXTsNCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICBfY29uZmlybWF0aW9ucyA9IG5ldyBhZGRyZXNzW10oY291bnQpOw0KICAgICAgICBmb3IgKGk9MDsgaTxjb3VudDsgaSsrKQ0KICAgICAgICAgICAgX2NvbmZpcm1hdGlvbnNbaV0gPSBjb25maXJtYXRpb25zVGVtcFtpXTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBSZXR1cm5zIGxpc3Qgb2YgdHJhbnNhY3Rpb24gSURzIGluIGRlZmluZWQgcmFuZ2UuDQogICAgLy8vIEBwYXJhbSBmcm9tIEluZGV4IHN0YXJ0IHBvc2l0aW9uIG9mIHRyYW5zYWN0aW9uIGFycmF5Lg0KICAgIC8vLyBAcGFyYW0gdG8gSW5kZXggZW5kIHBvc2l0aW9uIG9mIHRyYW5zYWN0aW9uIGFycmF5Lg0KICAgIC8vLyBAcGFyYW0gcGVuZGluZyBJbmNsdWRlIHBlbmRpbmcgdHJhbnNhY3Rpb25zLg0KICAgIC8vLyBAcGFyYW0gZXhlY3V0ZWQgSW5jbHVkZSBleGVjdXRlZCB0cmFuc2FjdGlvbnMuDQogICAgLy8vIEByZXR1cm4gUmV0dXJucyBhcnJheSBvZiB0cmFuc2FjdGlvbiBJRHMuDQogICAgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25JZHModWludCBmcm9tLCB1aW50IHRvLCBib29sIHBlbmRpbmcsIGJvb2wgZXhlY3V0ZWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50W10gX3RyYW5zYWN0aW9uSWRzKQ0KICAgIHsNCiAgICAgICAgdWludFtdIG1lbW9yeSB0cmFuc2FjdGlvbklkc1RlbXAgPSBuZXcgdWludFtdKHRyYW5zYWN0aW9uQ291bnQpOw0KICAgICAgICB1aW50IGNvdW50ID0gMDsNCiAgICAgICAgdWludCBpOw0KICAgICAgICBmb3IgKGk9MDsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspDQogICAgICAgICAgICBpZiAoICAgcGVuZGluZyAmJiAhdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkDQogICAgICAgICAgICAgICAgfHwgZXhlY3V0ZWQgJiYgdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uSWRzVGVtcFtjb3VudF0gPSBpOw0KICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7DQogICAgICAgICAgICB9DQogICAgICAgIF90cmFuc2FjdGlvbklkcyA9IG5ldyB1aW50W10odG8gLSBmcm9tKTsNCiAgICAgICAgZm9yIChpPWZyb207IGk8dG87IGkrKykNCiAgICAgICAgICAgIF90cmFuc2FjdGlvbklkc1tpIC0gZnJvbV0gPSB0cmFuc2FjdGlvbklkc1RlbXBbaV07DQogICAgfQ0KfQ=='