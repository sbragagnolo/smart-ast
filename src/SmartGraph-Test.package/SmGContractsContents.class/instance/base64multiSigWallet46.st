base 64 content
base64multiSigWallet46
	^'Y29udHJhY3QgTXVsdGlTaWdXYWxsZXQgew0KDQogICAgdWludCBjb25zdGFudCBwdWJsaWMgTUFYX09XTkVSX0NPVU5UID0gNTA7DQoNCiAgICBldmVudCBDb25maXJtYXRpb24oYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgdWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOw0KICAgIGV2ZW50IFJldm9jYXRpb24oYWRkcmVzcyBpbmRleGVkIHNlbmRlciwgdWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOw0KICAgIGV2ZW50IFN1Ym1pc3Npb24odWludCBpbmRleGVkIHRyYW5zYWN0aW9uSWQpOw0KICAgIGV2ZW50IEV4ZWN1dGlvbih1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7DQogICAgZXZlbnQgRXhlY3V0aW9uRmFpbHVyZSh1aW50IGluZGV4ZWQgdHJhbnNhY3Rpb25JZCk7DQogICAgZXZlbnQgRGVwb3NpdChhZGRyZXNzIGluZGV4ZWQgc2VuZGVyLCB1aW50IHZhbHVlKTsNCiAgICBldmVudCBPd25lckFkZGl0aW9uKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7DQogICAgZXZlbnQgT3duZXJSZW1vdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lcik7DQogICAgZXZlbnQgUmVxdWlyZW1lbnRDaGFuZ2UodWludCByZXF1aXJlZCk7DQoNCiAgICBtYXBwaW5nICh1aW50ID0+IFRyYW5zYWN0aW9uKSBwdWJsaWMgdHJhbnNhY3Rpb25zOw0KICAgIG1hcHBpbmcgKHVpbnQgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgcHVibGljIGNvbmZpcm1hdGlvbnM7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgaXNPd25lcjsNCiAgICBhZGRyZXNzW10gcHVibGljIG93bmVyczsNCiAgICB1aW50IHB1YmxpYyByZXF1aXJlZDsNCiAgICB1aW50IHB1YmxpYyB0cmFuc2FjdGlvbkNvdW50Ow0KDQogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsNCiAgICAgICAgYWRkcmVzcyBkZXN0aW5hdGlvbjsNCiAgICAgICAgdWludCB2YWx1ZTsNCiAgICAgICAgYnl0ZXMgZGF0YTsNCiAgICAgICAgYm9vbCBleGVjdXRlZDsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5V2FsbGV0KCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBhZGRyZXNzKHRoaXMpKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb3duZXJEb2VzTm90RXhpc3QoYWRkcmVzcyBvd25lcikgew0KICAgICAgICBpZiAoaXNPd25lcltvd25lcl0pDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvd25lckV4aXN0cyhhZGRyZXNzIG93bmVyKSB7DQogICAgICAgIGlmICghaXNPd25lcltvd25lcl0pDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciB0cmFuc2FjdGlvbkV4aXN0cyh1aW50IHRyYW5zYWN0aW9uSWQpIHsNCiAgICAgICAgaWYgKHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXS5kZXN0aW5hdGlvbiA9PSAwKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgY29uZmlybWVkKHVpbnQgdHJhbnNhY3Rpb25JZCwgYWRkcmVzcyBvd25lcikgew0KICAgICAgICBpZiAoIWNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJdKQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgbm90Q29uZmlybWVkKHVpbnQgdHJhbnNhY3Rpb25JZCwgYWRkcmVzcyBvd25lcikgew0KICAgICAgICBpZiAoY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVtvd25lcl0pDQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBub3RFeGVjdXRlZCh1aW50IHRyYW5zYWN0aW9uSWQpIHsNCiAgICAgICAgaWYgKHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXS5leGVjdXRlZCkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG5vdE51bGwoYWRkcmVzcyBfYWRkcmVzcykgew0KICAgICAgICBpZiAoX2FkZHJlc3MgPT0gMCkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIHZhbGlkUmVxdWlyZW1lbnQodWludCBvd25lckNvdW50LCB1aW50IF9yZXF1aXJlZCkgew0KICAgICAgICBpZiAoICAgb3duZXJDb3VudCA+IE1BWF9PV05FUl9DT1VOVA0KICAgICAgICAgICAgfHwgX3JlcXVpcmVkID4gb3duZXJDb3VudA0KICAgICAgICAgICAgfHwgX3JlcXVpcmVkID09IDANCiAgICAgICAgICAgIHx8IG93bmVyQ291bnQgPT0gMCkNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uIGFsbG93cyB0byBkZXBvc2l0IGV0aGVyLg0KICAgIGZ1bmN0aW9uKCkNCiAgICAgICAgcGF5YWJsZQ0KICAgIHsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IDApDQogICAgICAgICAgICBEZXBvc2l0KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7DQogICAgfQ0KDQogICAgLyoNCiAgICAgKiBQdWJsaWMgZnVuY3Rpb25zDQogICAgICovDQogICAgLy8vIEBkZXYgQ29udHJhY3QgY29uc3RydWN0b3Igc2V0cyBpbml0aWFsIG93bmVycyBhbmQgcmVxdWlyZWQgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMuDQogICAgLy8vIEBwYXJhbSBfb3duZXJzIExpc3Qgb2YgaW5pdGlhbCBvd25lcnMuDQogICAgLy8vIEBwYXJhbSBfcmVxdWlyZWQgTnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuDQogICAgZnVuY3Rpb24gTXVsdGlTaWdXYWxsZXQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgdmFsaWRSZXF1aXJlbWVudChfb3duZXJzLmxlbmd0aCwgX3JlcXVpcmVkKQ0KICAgIHsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTxfb3duZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoaXNPd25lcltfb3duZXJzW2ldXSB8fCBfb3duZXJzW2ldID09IDApDQogICAgICAgICAgICAgICAgdGhyb3c7DQogICAgICAgICAgICBpc093bmVyW19vd25lcnNbaV1dID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICBvd25lcnMgPSBfb3duZXJzOw0KICAgICAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgdG8gYWRkIGEgbmV3IG93bmVyLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuDQogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG5ldyBvd25lci4NCiAgICBmdW5jdGlvbiBhZGRPd25lcihhZGRyZXNzIG93bmVyKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgb25seVdhbGxldA0KICAgICAgICBvd25lckRvZXNOb3RFeGlzdChvd25lcikNCiAgICAgICAgbm90TnVsbChvd25lcikNCiAgICAgICAgdmFsaWRSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoICsgMSwgcmVxdWlyZWQpDQogICAgew0KICAgICAgICBpc093bmVyW293bmVyXSA9IHRydWU7DQogICAgICAgIG93bmVycy5wdXNoKG93bmVyKTsNCiAgICAgICAgT3duZXJBZGRpdGlvbihvd25lcik7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgQWxsb3dzIHRvIHJlbW92ZSBhbiBvd25lci4gVHJhbnNhY3Rpb24gaGFzIHRvIGJlIHNlbnQgYnkgd2FsbGV0Lg0KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBvd25lci4NCiAgICBmdW5jdGlvbiByZW1vdmVPd25lcihhZGRyZXNzIG93bmVyKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgb25seVdhbGxldA0KICAgICAgICBvd25lckV4aXN0cyhvd25lcikNCiAgICB7DQogICAgICAgIGlzT3duZXJbb3duZXJdID0gZmFsc2U7DQogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aCAtIDE7IGkrKykNCiAgICAgICAgICAgIGlmIChvd25lcnNbaV0gPT0gb3duZXIpIHsNCiAgICAgICAgICAgICAgICBvd25lcnNbaV0gPSBvd25lcnNbb3duZXJzLmxlbmd0aCAtIDFdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICBvd25lcnMubGVuZ3RoIC09IDE7DQogICAgICAgIGlmIChyZXF1aXJlZCA+IG93bmVycy5sZW5ndGgpDQogICAgICAgICAgICBjaGFuZ2VSZXF1aXJlbWVudChvd25lcnMubGVuZ3RoKTsNCiAgICAgICAgT3duZXJSZW1vdmFsKG93bmVyKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgdG8gcmVwbGFjZSBhbiBvd25lciB3aXRoIGEgbmV3IG93bmVyLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuDQogICAgLy8vIEBwYXJhbSBvd25lciBBZGRyZXNzIG9mIG93bmVyIHRvIGJlIHJlcGxhY2VkLg0KICAgIC8vLyBAcGFyYW0gb3duZXIgQWRkcmVzcyBvZiBuZXcgb3duZXIuDQogICAgZnVuY3Rpb24gcmVwbGFjZU93bmVyKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3MgbmV3T3duZXIpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvbmx5V2FsbGV0DQogICAgICAgIG93bmVyRXhpc3RzKG93bmVyKQ0KICAgICAgICBvd25lckRvZXNOb3RFeGlzdChuZXdPd25lcikNCiAgICB7DQogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgaWYgKG93bmVyc1tpXSA9PSBvd25lcikgew0KICAgICAgICAgICAgICAgIG93bmVyc1tpXSA9IG5ld093bmVyOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICBpc093bmVyW293bmVyXSA9IGZhbHNlOw0KICAgICAgICBpc093bmVyW25ld093bmVyXSA9IHRydWU7DQogICAgICAgIE93bmVyUmVtb3ZhbChvd25lcik7DQogICAgICAgIE93bmVyQWRkaXRpb24obmV3T3duZXIpOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEFsbG93cyB0byBjaGFuZ2UgdGhlIG51bWJlciBvZiByZXF1aXJlZCBjb25maXJtYXRpb25zLiBUcmFuc2FjdGlvbiBoYXMgdG8gYmUgc2VudCBieSB3YWxsZXQuDQogICAgLy8vIEBwYXJhbSBfcmVxdWlyZWQgTnVtYmVyIG9mIHJlcXVpcmVkIGNvbmZpcm1hdGlvbnMuDQogICAgZnVuY3Rpb24gY2hhbmdlUmVxdWlyZW1lbnQodWludCBfcmVxdWlyZWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvbmx5V2FsbGV0DQogICAgICAgIHZhbGlkUmVxdWlyZW1lbnQob3duZXJzLmxlbmd0aCwgX3JlcXVpcmVkKQ0KICAgIHsNCiAgICAgICAgcmVxdWlyZWQgPSBfcmVxdWlyZWQ7DQogICAgICAgIFJlcXVpcmVtZW50Q2hhbmdlKF9yZXF1aXJlZCk7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIHN1Ym1pdCBhbmQgY29uZmlybSBhIHRyYW5zYWN0aW9uLg0KICAgIC8vLyBAcGFyYW0gZGVzdGluYXRpb24gVHJhbnNhY3Rpb24gdGFyZ2V0IGFkZHJlc3MuDQogICAgLy8vIEBwYXJhbSB2YWx1ZSBUcmFuc2FjdGlvbiBldGhlciB2YWx1ZS4NCiAgICAvLy8gQHBhcmFtIGRhdGEgVHJhbnNhY3Rpb24gZGF0YSBwYXlsb2FkLg0KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgdHJhbnNhY3Rpb24gSUQuDQogICAgZnVuY3Rpb24gc3VibWl0VHJhbnNhY3Rpb24oYWRkcmVzcyBkZXN0aW5hdGlvbiwgdWludCB2YWx1ZSwgYnl0ZXMgZGF0YSkNCiAgICAgICAgcHVibGljDQogICAgICAgIHJldHVybnMgKHVpbnQgdHJhbnNhY3Rpb25JZCkNCiAgICB7DQogICAgICAgIHRyYW5zYWN0aW9uSWQgPSBhZGRUcmFuc2FjdGlvbihkZXN0aW5hdGlvbiwgdmFsdWUsIGRhdGEpOw0KICAgICAgICBjb25maXJtVHJhbnNhY3Rpb24odHJhbnNhY3Rpb25JZCk7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgQWxsb3dzIGFuIG93bmVyIHRvIGNvbmZpcm0gYSB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgZnVuY3Rpb24gY29uZmlybVRyYW5zYWN0aW9uKHVpbnQgdHJhbnNhY3Rpb25JZCkNCiAgICAgICAgcHVibGljDQogICAgICAgIG93bmVyRXhpc3RzKG1zZy5zZW5kZXIpDQogICAgICAgIHRyYW5zYWN0aW9uRXhpc3RzKHRyYW5zYWN0aW9uSWQpDQogICAgICAgIG5vdENvbmZpcm1lZCh0cmFuc2FjdGlvbklkLCBtc2cuc2VuZGVyKQ0KICAgIHsNCiAgICAgICAgY29uZmlybWF0aW9uc1t0cmFuc2FjdGlvbklkXVttc2cuc2VuZGVyXSA9IHRydWU7DQogICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCB0cmFuc2FjdGlvbklkKTsNCiAgICAgICAgZXhlY3V0ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uSWQpOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IEFsbG93cyBhbiBvd25lciB0byByZXZva2UgYSBjb25maXJtYXRpb24gZm9yIGEgdHJhbnNhY3Rpb24uDQogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELg0KICAgIGZ1bmN0aW9uIHJldm9rZUNvbmZpcm1hdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvd25lckV4aXN0cyhtc2cuc2VuZGVyKQ0KICAgICAgICBjb25maXJtZWQodHJhbnNhY3Rpb25JZCwgbXNnLnNlbmRlcikNCiAgICAgICAgbm90RXhlY3V0ZWQodHJhbnNhY3Rpb25JZCkNCiAgICB7DQogICAgICAgIGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bbXNnLnNlbmRlcl0gPSBmYWxzZTsNCiAgICAgICAgUmV2b2NhdGlvbihtc2cuc2VuZGVyLCB0cmFuc2FjdGlvbklkKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBBbGxvd3MgYW55b25lIHRvIGV4ZWN1dGUgYSBjb25maXJtZWQgdHJhbnNhY3Rpb24uDQogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELg0KICAgIGZ1bmN0aW9uIGV4ZWN1dGVUcmFuc2FjdGlvbih1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBub3RFeGVjdXRlZCh0cmFuc2FjdGlvbklkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzQ29uZmlybWVkKHRyYW5zYWN0aW9uSWQpKSB7DQogICAgICAgICAgICBUcmFuc2FjdGlvbiB0eCA9IHRyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkXTsNCiAgICAgICAgICAgIHR4LmV4ZWN1dGVkID0gdHJ1ZTsNCiAgICAgICAgICAgIGlmICh0eC5kZXN0aW5hdGlvbi5jYWxsLnZhbHVlKHR4LnZhbHVlKSh0eC5kYXRhKSkNCiAgICAgICAgICAgICAgICBFeGVjdXRpb24odHJhbnNhY3Rpb25JZCk7DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICBFeGVjdXRpb25GYWlsdXJlKHRyYW5zYWN0aW9uSWQpOw0KICAgICAgICAgICAgICAgIHR4LmV4ZWN1dGVkID0gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLy8gQGRldiBSZXR1cm5zIHRoZSBjb25maXJtYXRpb24gc3RhdHVzIG9mIGEgdHJhbnNhY3Rpb24uDQogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELg0KICAgIC8vLyBAcmV0dXJuIENvbmZpcm1hdGlvbiBzdGF0dXMuDQogICAgZnVuY3Rpb24gaXNDb25maXJtZWQodWludCB0cmFuc2FjdGlvbklkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYm9vbCkNCiAgICB7DQogICAgICAgIHVpbnQgY291bnQgPSAwOw0KICAgICAgICBmb3IgKHVpbnQgaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkNCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOw0KICAgICAgICAgICAgaWYgKGNvdW50ID09IHJlcXVpcmVkKQ0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoNCiAgICAgKiBJbnRlcm5hbCBmdW5jdGlvbnMNCiAgICAgKi8NCiAgICAvLy8gQGRldiBBZGRzIGEgbmV3IHRyYW5zYWN0aW9uIHRvIHRoZSB0cmFuc2FjdGlvbiBtYXBwaW5nLCBpZiB0cmFuc2FjdGlvbiBkb2VzIG5vdCBleGlzdCB5ZXQuDQogICAgLy8vIEBwYXJhbSBkZXN0aW5hdGlvbiBUcmFuc2FjdGlvbiB0YXJnZXQgYWRkcmVzcy4NCiAgICAvLy8gQHBhcmFtIHZhbHVlIFRyYW5zYWN0aW9uIGV0aGVyIHZhbHVlLg0KICAgIC8vLyBAcGFyYW0gZGF0YSBUcmFuc2FjdGlvbiBkYXRhIHBheWxvYWQuDQogICAgLy8vIEByZXR1cm4gUmV0dXJucyB0cmFuc2FjdGlvbiBJRC4NCiAgICBmdW5jdGlvbiBhZGRUcmFuc2FjdGlvbihhZGRyZXNzIGRlc3RpbmF0aW9uLCB1aW50IHZhbHVlLCBieXRlcyBkYXRhKQ0KICAgICAgICBpbnRlcm5hbA0KICAgICAgICBub3ROdWxsKGRlc3RpbmF0aW9uKQ0KICAgICAgICByZXR1cm5zICh1aW50IHRyYW5zYWN0aW9uSWQpDQogICAgew0KICAgICAgICB0cmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25Db3VudDsNCiAgICAgICAgdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRdID0gVHJhbnNhY3Rpb24oew0KICAgICAgICAgICAgZGVzdGluYXRpb246IGRlc3RpbmF0aW9uLA0KICAgICAgICAgICAgdmFsdWU6IHZhbHVlLA0KICAgICAgICAgICAgZGF0YTogZGF0YSwNCiAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZQ0KICAgICAgICB9KTsNCiAgICAgICAgdHJhbnNhY3Rpb25Db3VudCArPSAxOw0KICAgICAgICBTdWJtaXNzaW9uKHRyYW5zYWN0aW9uSWQpOw0KICAgIH0NCg0KICAgIC8qDQogICAgICogV2ViMyBjYWxsIGZ1bmN0aW9ucw0KICAgICAqLw0KICAgIC8vLyBAZGV2IFJldHVybnMgbnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMgb2YgYSB0cmFuc2FjdGlvbi4NCiAgICAvLy8gQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSUQuDQogICAgLy8vIEByZXR1cm4gTnVtYmVyIG9mIGNvbmZpcm1hdGlvbnMuDQogICAgZnVuY3Rpb24gZ2V0Q29uZmlybWF0aW9uQ291bnQodWludCB0cmFuc2FjdGlvbklkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAodWludCBjb3VudCkNCiAgICB7DQogICAgICAgIGZvciAodWludCBpPTA7IGk8b3duZXJzLmxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnNbdHJhbnNhY3Rpb25JZF1bb3duZXJzW2ldXSkNCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IFJldHVybnMgdG90YWwgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyBhZnRlciBmaWxlcnMgYXJlIGFwcGxpZWQuDQogICAgLy8vIEBwYXJhbSBwZW5kaW5nIEluY2x1ZGUgcGVuZGluZyB0cmFuc2FjdGlvbnMuDQogICAgLy8vIEBwYXJhbSBleGVjdXRlZCBJbmNsdWRlIGV4ZWN1dGVkIHRyYW5zYWN0aW9ucy4NCiAgICAvLy8gQHJldHVybiBUb3RhbCBudW1iZXIgb2YgdHJhbnNhY3Rpb25zIGFmdGVyIGZpbHRlcnMgYXJlIGFwcGxpZWQuDQogICAgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25Db3VudChib29sIHBlbmRpbmcsIGJvb2wgZXhlY3V0ZWQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBjb25zdGFudA0KICAgICAgICByZXR1cm5zICh1aW50IGNvdW50KQ0KICAgIHsNCiAgICAgICAgZm9yICh1aW50IGk9MDsgaTx0cmFuc2FjdGlvbkNvdW50OyBpKyspDQogICAgICAgICAgICBpZiAoICAgcGVuZGluZyAmJiAhdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkDQogICAgICAgICAgICAgICAgfHwgZXhlY3V0ZWQgJiYgdHJhbnNhY3Rpb25zW2ldLmV4ZWN1dGVkKQ0KICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgUmV0dXJucyBsaXN0IG9mIG93bmVycy4NCiAgICAvLy8gQHJldHVybiBMaXN0IG9mIG93bmVyIGFkZHJlc3Nlcy4NCiAgICBmdW5jdGlvbiBnZXRPd25lcnMoKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzc1tdKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIG93bmVyczsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBSZXR1cm5zIGFycmF5IHdpdGggb3duZXIgYWRkcmVzc2VzLCB3aGljaCBjb25maXJtZWQgdHJhbnNhY3Rpb24uDQogICAgLy8vIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElELg0KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgYXJyYXkgb2Ygb3duZXIgYWRkcmVzc2VzLg0KICAgIGZ1bmN0aW9uIGdldENvbmZpcm1hdGlvbnModWludCB0cmFuc2FjdGlvbklkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAoYWRkcmVzc1tdIF9jb25maXJtYXRpb25zKQ0KICAgIHsNCiAgICAgICAgYWRkcmVzc1tdIG1lbW9yeSBjb25maXJtYXRpb25zVGVtcCA9IG5ldyBhZGRyZXNzW10ob3duZXJzLmxlbmd0aCk7DQogICAgICAgIHVpbnQgY291bnQgPSAwOw0KICAgICAgICB1aW50IGk7DQogICAgICAgIGZvciAoaT0wOyBpPG93bmVycy5sZW5ndGg7IGkrKykNCiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zW3RyYW5zYWN0aW9uSWRdW293bmVyc1tpXV0pIHsNCiAgICAgICAgICAgICAgICBjb25maXJtYXRpb25zVGVtcFtjb3VudF0gPSBvd25lcnNbaV07DQogICAgICAgICAgICAgICAgY291bnQgKz0gMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgX2NvbmZpcm1hdGlvbnMgPSBuZXcgYWRkcmVzc1tdKGNvdW50KTsNCiAgICAgICAgZm9yIChpPTA7IGk8Y291bnQ7IGkrKykNCiAgICAgICAgICAgIF9jb25maXJtYXRpb25zW2ldID0gY29uZmlybWF0aW9uc1RlbXBbaV07DQogICAgfQ0KDQogICAgLy8vIEBkZXYgUmV0dXJucyBsaXN0IG9mIHRyYW5zYWN0aW9uIElEcyBpbiBkZWZpbmVkIHJhbmdlLg0KICAgIC8vLyBAcGFyYW0gZnJvbSBJbmRleCBzdGFydCBwb3NpdGlvbiBvZiB0cmFuc2FjdGlvbiBhcnJheS4NCiAgICAvLy8gQHBhcmFtIHRvIEluZGV4IGVuZCBwb3NpdGlvbiBvZiB0cmFuc2FjdGlvbiBhcnJheS4NCiAgICAvLy8gQHBhcmFtIHBlbmRpbmcgSW5jbHVkZSBwZW5kaW5nIHRyYW5zYWN0aW9ucy4NCiAgICAvLy8gQHBhcmFtIGV4ZWN1dGVkIEluY2x1ZGUgZXhlY3V0ZWQgdHJhbnNhY3Rpb25zLg0KICAgIC8vLyBAcmV0dXJuIFJldHVybnMgYXJyYXkgb2YgdHJhbnNhY3Rpb24gSURzLg0KICAgIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uSWRzKHVpbnQgZnJvbSwgdWludCB0bywgYm9vbCBwZW5kaW5nLCBib29sIGV4ZWN1dGVkKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgY29uc3RhbnQNCiAgICAgICAgcmV0dXJucyAodWludFtdIF90cmFuc2FjdGlvbklkcykNCiAgICB7DQogICAgICAgIHVpbnRbXSBtZW1vcnkgdHJhbnNhY3Rpb25JZHNUZW1wID0gbmV3IHVpbnRbXSh0cmFuc2FjdGlvbkNvdW50KTsNCiAgICAgICAgdWludCBjb3VudCA9IDA7DQogICAgICAgIHVpbnQgaTsNCiAgICAgICAgZm9yIChpPTA7IGk8dHJhbnNhY3Rpb25Db3VudDsgaSsrKQ0KICAgICAgICAgICAgaWYgKCAgIHBlbmRpbmcgJiYgIXRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZA0KICAgICAgICAgICAgICAgIHx8IGV4ZWN1dGVkICYmIHRyYW5zYWN0aW9uc1tpXS5leGVjdXRlZCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbklkc1RlbXBbY291bnRdID0gaTsNCiAgICAgICAgICAgICAgICBjb3VudCArPSAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICBfdHJhbnNhY3Rpb25JZHMgPSBuZXcgdWludFtdKHRvIC0gZnJvbSk7DQogICAgICAgIGZvciAoaT1mcm9tOyBpPHRvOyBpKyspDQogICAgICAgICAgICBfdHJhbnNhY3Rpb25JZHNbaSAtIGZyb21dID0gdHJhbnNhY3Rpb25JZHNUZW1wW2ldOw0KICAgIH0NCn0='