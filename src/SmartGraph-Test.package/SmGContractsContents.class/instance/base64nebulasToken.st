base 64 content
base64nebulasToken
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMjsNCg0KY29udHJhY3QgSU1pZ3JhdGlvbkNvbnRyYWN0IHsNCiAgICBmdW5jdGlvbiBtaWdyYXRlKGFkZHJlc3MgYWRkciwgdWludDI1NiBuYXMpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQp9DQoNCi8qIHRha2luZyBpZGVhcyBmcm9tIEZpcnN0Qmxvb2QgdG9rZW4gKi8NCmNvbnRyYWN0IFNhZmVNYXRoIHsNCg0KICAgIC8qIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgeyAqLw0KICAgIC8qICAgaWYgKCFhc3NlcnRpb24pIHsgKi8NCiAgICAvKiAgICAgdGhyb3c7ICovDQogICAgLyogICB9ICovDQogICAgLyogfSAgICAgIC8vIGFzc2VydCBubyBsb25nZXIgbmVlZGVkIG9uY2Ugc29saWRpdHkgaXMgb24gMC40LjEwICovDQoNCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQyNTYgeCwgdWludDI1NiB5KSBpbnRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsNCiAgICAgIHVpbnQyNTYgeiA9IHggKyB5Ow0KICAgICAgYXNzZXJ0KCh6ID49IHgpICYmICh6ID49IHkpKTsNCiAgICAgIHJldHVybiB6Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNhZmVTdWJ0cmFjdCh1aW50MjU2IHgsIHVpbnQyNTYgeSkgaW50ZXJuYWwgcmV0dXJucyh1aW50MjU2KSB7DQogICAgICBhc3NlcnQoeCA+PSB5KTsNCiAgICAgIHVpbnQyNTYgeiA9IHggLSB5Ow0KICAgICAgcmV0dXJuIHo7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2FmZU11bHQodWludDI1NiB4LCB1aW50MjU2IHkpIGludGVybmFsIHJldHVybnModWludDI1Nikgew0KICAgICAgdWludDI1NiB6ID0geCAqIHk7DQogICAgICBhc3NlcnQoKHggPT0gMCl8fCh6L3ggPT0geSkpOw0KICAgICAgcmV0dXJuIHo7DQogICAgfQ0KDQp9DQoNCmNvbnRyYWN0IFRva2VuIHsNCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseTsNCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsNCn0NCg0KDQovKiAgRVJDIDIwIHRva2VuICovDQpjb250cmFjdCBTdGFuZGFyZFRva2VuIGlzIFRva2VuIHsNCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIF92YWx1ZSA+IDApIHsNCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOw0KICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KfQ0KDQpjb250cmFjdCBOZWJ1bGFzVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgU2FmZU1hdGggew0KDQogICAgLy8gbWV0YWRhdGENCiAgICBzdHJpbmcgIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIk5lYnVsYXMgVG9rZW4iOw0KICAgIHN0cmluZyAgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJOQVMiOw0KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7DQogICAgc3RyaW5nICBwdWJsaWMgdmVyc2lvbiA9ICIxLjAiOw0KDQogICAgLy8gY29udHJhY3RzDQogICAgYWRkcmVzcyBwdWJsaWMgZXRoRnVuZERlcG9zaXQ7ICAgICAgICAgIC8vIGRlcG9zaXQgYWRkcmVzcyBmb3IgRVRIIGZvciBOZWJ1bGFzIFRlYW0uDQogICAgYWRkcmVzcyBwdWJsaWMgbmV3Q29udHJhY3RBZGRyOyAgICAgICAgIC8vIHRoZSBuZXcgY29udHJhY3QgZm9yIG5lYnVsYXMgdG9rZW4gdXBkYXRlczsNCg0KICAgIC8vIGNyb3dkc2FsZSBwYXJhbWV0ZXJzDQogICAgYm9vbCAgICBwdWJsaWMgaXNGdW5kaW5nOyAgICAgICAgICAgICAgICAvLyBzd2l0Y2hlZCB0byB0cnVlIGluIG9wZXJhdGlvbmFsIHN0YXRlDQogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ1N0YXJ0QmxvY2s7DQogICAgdWludDI1NiBwdWJsaWMgZnVuZGluZ1N0b3BCbG9jazsNCg0KICAgIHVpbnQyNTYgcHVibGljIGN1cnJlbnRTdXBwbHk7ICAgICAgICAgICAvLyBjdXJyZW50IHN1cHBseSB0b2tlbnMgZm9yIHNlbGwNCiAgICB1aW50MjU2IHB1YmxpYyB0b2tlblJhaXNlZCA9IDA7ICAgICAgICAgLy8gdGhlIG51bWJlciBvZiB0b3RhbCBzb2xkIHRva2VuDQogICAgdWludDI1NiBwdWJsaWMgdG9rZW5NaWdyYXRlZCA9IDA7ICAgICAvLyB0aGUgbnVtYmVyIG9mIHRvdGFsIHRyYW5zZmVydGVkIHRva2VuDQogICAgdWludDI1NiBwdWJsaWMgdG9rZW5FeGNoYW5nZVJhdGUgPSA2MjU7ICAgICAgICAgICAgIC8vIDYyNSBOQVMgdG9rZW5zIHBlciAxIEVUSA0KDQogICAgLy8gZXZlbnRzDQogICAgZXZlbnQgQWxsb2NhdGVUb2tlbihhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7ICAgLy8gYWxsb2NhdGUgdG9rZW4gZm9yIHByaXZhdGUgc2FsZTsNCiAgICBldmVudCBJc3N1ZVRva2VuKGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsgICAgICAvLyBpc3N1ZSB0b2tlbiBmb3IgcHVibGljIHNhbGU7DQogICAgZXZlbnQgSW5jcmVhc2VTdXBwbHkodWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IERlY3JlYXNlU3VwcGx5KHVpbnQyNTYgX3ZhbHVlKTsNCiAgICBldmVudCBNaWdyYXRlKGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCg0KICAgIC8vIGZvcm1hdCBkZWNpbWFscy4NCiAgICBmdW5jdGlvbiBmb3JtYXREZWNpbWFscyh1aW50MjU2IF92YWx1ZSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1NiApIHsNCiAgICAgICAgcmV0dXJuIF92YWx1ZSAqIDEwICoqIGRlY2ltYWxzOw0KICAgIH0NCg0KICAgIC8vIGNvbnN0cnVjdG9yDQogICAgZnVuY3Rpb24gTmVidWxhc1Rva2VuKA0KICAgICAgICBhZGRyZXNzIF9ldGhGdW5kRGVwb3NpdCwNCiAgICAgICAgdWludDI1NiBfY3VycmVudFN1cHBseSkNCiAgICB7DQogICAgICAgIGV0aEZ1bmREZXBvc2l0ID0gX2V0aEZ1bmREZXBvc2l0Ow0KDQogICAgICAgIGlzRnVuZGluZyA9IGZhbHNlOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29udHJvbHMgcHJlIHRocm91Z2ggY3Jvd2RzYWxlIHN0YXRlDQogICAgICAgIGZ1bmRpbmdTdGFydEJsb2NrID0gMDsNCiAgICAgICAgZnVuZGluZ1N0b3BCbG9jayA9IDA7DQoNCiAgICAgICAgY3VycmVudFN1cHBseSA9IGZvcm1hdERlY2ltYWxzKF9jdXJyZW50U3VwcGx5KTsNCiAgICAgICAgdG90YWxTdXBwbHkgPSBmb3JtYXREZWNpbWFscygxMDAwMDAwMDApOw0KICAgICAgICBpZihjdXJyZW50U3VwcGx5ID4gdG90YWxTdXBwbHkpIHRocm93Ow0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGlzT3duZXIoKSAgeyByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZXRoRnVuZERlcG9zaXQpOyBfOyB9DQoNCiAgICAvLy8gQGRldiBzZXQgdGhlIHRva2VuJ3MgdG9rZW5FeGNoYW5nZVJhdGUsDQogICAgZnVuY3Rpb24gc2V0VG9rZW5FeGNoYW5nZVJhdGUodWludDI1NiBfdG9rZW5FeGNoYW5nZVJhdGUpIGlzT3duZXIgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoX3Rva2VuRXhjaGFuZ2VSYXRlID09IDApIHRocm93Ow0KICAgICAgICBpZiAoX3Rva2VuRXhjaGFuZ2VSYXRlID09IHRva2VuRXhjaGFuZ2VSYXRlKSB0aHJvdzsNCg0KICAgICAgICB0b2tlbkV4Y2hhbmdlUmF0ZSA9IF90b2tlbkV4Y2hhbmdlUmF0ZTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBpbmNyZWFzZSB0aGUgdG9rZW4ncyBzdXBwbHkNCiAgICBmdW5jdGlvbiBpbmNyZWFzZVN1cHBseSAodWludDI1NiBfdmFsdWUpIGlzT3duZXIgZXh0ZXJuYWwgew0KICAgICAgICB1aW50MjU2IHZhbHVlID0gZm9ybWF0RGVjaW1hbHMoX3ZhbHVlKTsNCiAgICAgICAgaWYgKHZhbHVlICsgY3VycmVudFN1cHBseSA+IHRvdGFsU3VwcGx5KSB0aHJvdzsNCiAgICAgICAgY3VycmVudFN1cHBseSA9IHNhZmVBZGQoY3VycmVudFN1cHBseSwgdmFsdWUpOw0KICAgICAgICBJbmNyZWFzZVN1cHBseSh2YWx1ZSk7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgZGVjcmVhc2UgdGhlIHRva2VuJ3Mgc3VwcGx5DQogICAgZnVuY3Rpb24gZGVjcmVhc2VTdXBwbHkgKHVpbnQyNTYgX3ZhbHVlKSBpc093bmVyIGV4dGVybmFsIHsNCiAgICAgICAgdWludDI1NiB2YWx1ZSA9IGZvcm1hdERlY2ltYWxzKF92YWx1ZSk7DQogICAgICAgIGlmICh2YWx1ZSArIHRva2VuUmFpc2VkID4gY3VycmVudFN1cHBseSkgdGhyb3c7DQoNCiAgICAgICAgY3VycmVudFN1cHBseSA9IHNhZmVTdWJ0cmFjdChjdXJyZW50U3VwcGx5LCB2YWx1ZSk7DQogICAgICAgIERlY3JlYXNlU3VwcGx5KHZhbHVlKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiB0dXJuIG9uIHRoZSBmdW5kaW5nIHN0YXRlDQogICAgZnVuY3Rpb24gc3RhcnRGdW5kaW5nICh1aW50MjU2IF9mdW5kaW5nU3RhcnRCbG9jaywgdWludDI1NiBfZnVuZGluZ1N0b3BCbG9jaykgaXNPd25lciBleHRlcm5hbCB7DQogICAgICAgIGlmIChpc0Z1bmRpbmcpIHRocm93Ow0KICAgICAgICBpZiAoX2Z1bmRpbmdTdGFydEJsb2NrID49IF9mdW5kaW5nU3RvcEJsb2NrKSB0aHJvdzsNCiAgICAgICAgaWYgKGJsb2NrLm51bWJlciA+PSBfZnVuZGluZ1N0YXJ0QmxvY2spIHRocm93Ow0KDQogICAgICAgIGZ1bmRpbmdTdGFydEJsb2NrID0gX2Z1bmRpbmdTdGFydEJsb2NrOw0KICAgICAgICBmdW5kaW5nU3RvcEJsb2NrID0gX2Z1bmRpbmdTdG9wQmxvY2s7DQogICAgICAgIGlzRnVuZGluZyA9IHRydWU7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgdHVybiBvZmYgdGhlIGZ1bmRpbmcgc3RhdGUNCiAgICBmdW5jdGlvbiBzdG9wRnVuZGluZygpIGlzT3duZXIgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoIWlzRnVuZGluZykgdGhyb3c7DQogICAgICAgIGlzRnVuZGluZyA9IGZhbHNlOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IHNldCBhIG5ldyBjb250cmFjdCBmb3IgcmVjaWV2ZSB0aGUgdG9rZW5zIChmb3IgdXBkYXRlIGNvbnRyYWN0KQ0KICAgIGZ1bmN0aW9uIHNldE1pZ3JhdGVDb250cmFjdChhZGRyZXNzIF9uZXdDb250cmFjdEFkZHIpIGlzT3duZXIgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoX25ld0NvbnRyYWN0QWRkciA9PSBuZXdDb250cmFjdEFkZHIpIHRocm93Ow0KICAgICAgICBuZXdDb250cmFjdEFkZHIgPSBfbmV3Q29udHJhY3RBZGRyOw0KICAgIH0NCg0KICAgIC8vLyBAZGV2IHNldCBhIG5ldyBvd25lci4NCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9uZXdGdW5kRGVwb3NpdCkgaXNPd25lcigpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKF9uZXdGdW5kRGVwb3NpdCA9PSBhZGRyZXNzKDB4MCkpIHRocm93Ow0KICAgICAgICBldGhGdW5kRGVwb3NpdCA9IF9uZXdGdW5kRGVwb3NpdDsNCiAgICB9DQoNCiAgICAvLy8gc2VuZHMgdGhlIHRva2VucyB0byBuZXcgY29udHJhY3QNCiAgICBmdW5jdGlvbiBtaWdyYXRlKCkgZXh0ZXJuYWwgew0KICAgICAgICBpZihpc0Z1bmRpbmcpIHRocm93Ow0KICAgICAgICBpZihuZXdDb250cmFjdEFkZHIgPT0gYWRkcmVzcygweDApKSB0aHJvdzsNCg0KICAgICAgICB1aW50MjU2IHRva2VucyA9IGJhbGFuY2VzW21zZy5zZW5kZXJdOw0KICAgICAgICBpZiAodG9rZW5zID09IDApIHRocm93Ow0KDQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gMDsNCiAgICAgICAgdG9rZW5NaWdyYXRlZCA9IHNhZmVBZGQodG9rZW5NaWdyYXRlZCwgdG9rZW5zKTsNCg0KICAgICAgICBJTWlncmF0aW9uQ29udHJhY3QgbmV3Q29udHJhY3QgPSBJTWlncmF0aW9uQ29udHJhY3QobmV3Q29udHJhY3RBZGRyKTsNCiAgICAgICAgaWYgKCFuZXdDb250cmFjdC5taWdyYXRlKG1zZy5zZW5kZXIsIHRva2VucykpIHRocm93Ow0KDQogICAgICAgIE1pZ3JhdGUobXNnLnNlbmRlciwgdG9rZW5zKTsgICAgICAgICAgICAgICAvLyBsb2cgaXQNCiAgICB9DQoNCiAgICAvLy8gQGRldiBzZW5kcyBFVEggdG8gTmVidWxhcyB0ZWFtDQogICAgZnVuY3Rpb24gdHJhbnNmZXJFVEgoKSBpc093bmVyIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA9PSAwKSB0aHJvdzsNCiAgICAgICAgaWYgKCFldGhGdW5kRGVwb3NpdC5zZW5kKHRoaXMuYmFsYW5jZSkpIHRocm93Ow0KICAgIH0NCg0KICAgIC8vLyBAZGV2IGFsbG9jYXRlcyBOQVMgdG9rZW5zIHRvIHByZS1zZWxsIGFkZHJlc3MuDQogICAgZnVuY3Rpb24gYWxsb2NhdGVUb2tlbiAoYWRkcmVzcyBfYWRkciwgdWludDI1NiBfZXRoKSBpc093bmVyIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKF9ldGggPT0gMCkgdGhyb3c7DQogICAgICAgIGlmIChfYWRkciA9PSBhZGRyZXNzKDB4MCkpIHRocm93Ow0KDQogICAgICAgIHVpbnQyNTYgdG9rZW5zID0gc2FmZU11bHQoZm9ybWF0RGVjaW1hbHMoX2V0aCksIHRva2VuRXhjaGFuZ2VSYXRlKTsNCiAgICAgICAgaWYgKHRva2VucyArIHRva2VuUmFpc2VkID4gY3VycmVudFN1cHBseSkgdGhyb3c7DQoNCiAgICAgICAgdG9rZW5SYWlzZWQgPSBzYWZlQWRkKHRva2VuUmFpc2VkLCB0b2tlbnMpOw0KICAgICAgICBiYWxhbmNlc1tfYWRkcl0gKz0gdG9rZW5zOw0KDQogICAgICAgIEFsbG9jYXRlVG9rZW4oX2FkZHIsIHRva2Vucyk7ICAvLyBsb2dzIHRva2VuIGlzc3VlZA0KICAgIH0NCg0KICAgIC8vLyBidXlzIHRoZSB0b2tlbnMNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCiAgICAgICAgaWYgKCFpc0Z1bmRpbmcpIHRocm93Ow0KICAgICAgICBpZiAobXNnLnZhbHVlID09IDApIHRocm93Ow0KDQogICAgICAgIGlmIChibG9jay5udW1iZXIgPCBmdW5kaW5nU3RhcnRCbG9jaykgdGhyb3c7DQogICAgICAgIGlmIChibG9jay5udW1iZXIgPiBmdW5kaW5nU3RvcEJsb2NrKSB0aHJvdzsNCg0KICAgICAgICB1aW50MjU2IHRva2VucyA9IHNhZmVNdWx0KG1zZy52YWx1ZSwgdG9rZW5FeGNoYW5nZVJhdGUpOw0KICAgICAgICBpZiAodG9rZW5zICsgdG9rZW5SYWlzZWQgPiBjdXJyZW50U3VwcGx5KSB0aHJvdzsNCg0KICAgICAgICB0b2tlblJhaXNlZCA9IHNhZmVBZGQodG9rZW5SYWlzZWQsIHRva2Vucyk7DQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IHRva2VuczsNCg0KICAgICAgICBJc3N1ZVRva2VuKG1zZy5zZW5kZXIsIHRva2Vucyk7ICAvLyBsb2dzIHRva2VuIGlzc3VlZA0KICAgIH0NCn0='