base 64 content
base64numeraireBackend
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3QgU2FmZSB7DQogICAgLy8gQ2hlY2sgaWYgaXQgaXMgc2FmZSB0byBhZGQgdHdvIG51bWJlcnMNCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgICAgICBhc3NlcnQoYyA+PSBhICYmIGMgPj0gYik7DQogICAgICAgIHJldHVybiBjOw0KICAgIH0NCg0KICAgIC8vIENoZWNrIGlmIGl0IGlzIHNhZmUgdG8gc3VidHJhY3QgdHdvIG51bWJlcnMNCiAgICBmdW5jdGlvbiBzYWZlU3VidHJhY3QodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgdWludCBjID0gYSAtIGI7DQogICAgICAgIGFzc2VydChiIDw9IGEgJiYgYyA8PSBhKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2FmZU11bHRpcGx5KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IChjIC8gYSkgPT0gYik7DQogICAgICAgIHJldHVybiBjOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNocmluazEyOCh1aW50IGEpIGludGVybmFsIHJldHVybnMgKHVpbnQxMjgpIHsNCiAgICAgICAgYXNzZXJ0KGEgPCAweDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCk7DQogICAgICAgIHJldHVybiB1aW50MTI4KGEpOw0KICAgIH0NCg0KICAgIC8vIG1pdGlnYXRlIHNob3J0IGFkZHJlc3MgYXR0YWNrDQogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgbnVtV29yZHMpIHsNCiAgICAgICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA9PSBudW1Xb3JkcyAqIDMyICsgNCk7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgLy8gYWxsb3cgZXRoZXIgdG8gYmUgcmVjZWl2ZWQNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsgfQ0KfQ0KDQovLyBDbGFzcyB2YXJpYWJsZXMgdXNlZCBib3RoIGluIE51bWVyYWlyZUJhY2tlbmQgYW5kIE51bWVyYWlyZURlbGVnYXRlDQoNCmNvbnRyYWN0IE51bWVyYWlyZVNoYXJlZCBpcyBTYWZlIHsNCg0KICAgIGFkZHJlc3MgcHVibGljIG51bWVyYWkgPSB0aGlzOw0KDQogICAgLy8gQ2FwIHRoZSB0b3RhbCBzdXBwbHkgYW5kIHRoZSB3ZWVrbHkgc3VwcGx5DQogICAgdWludDI1NiBwdWJsaWMgc3VwcGx5X2NhcCA9IDIxMDAwMDAwZTE4OyAvLyAyMSBtaWxsaW9uDQogICAgdWludDI1NiBwdWJsaWMgd2Vla2x5X2Rpc2J1cnNlbWVudCA9IDk2MTUzODQ2MTUzODQ2MTUzODQ2MTUzOw0KDQogICAgdWludDI1NiBwdWJsaWMgaW5pdGlhbF9kaXNidXJzZW1lbnQ7DQogICAgdWludDI1NiBwdWJsaWMgZGVwbG95X3RpbWU7DQoNCiAgICB1aW50MjU2IHB1YmxpYyB0b3RhbF9taW50ZWQ7DQoNCiAgICAvLyBFUkMyMCByZXF1aXJlcyB0b3RhbFN1cHBseSwgYmFsYW5jZU9mLCBhbmQgYWxsb3dhbmNlDQogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgYmFsYW5jZU9mOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIGFsbG93YW5jZTsNCg0KICAgIG1hcHBpbmcgKHVpbnQgPT4gVG91cm5hbWVudCkgcHVibGljIHRvdXJuYW1lbnRzOyAgLy8gdG91cm5hbWVudElEDQoNCiAgICBzdHJ1Y3QgVG91cm5hbWVudCB7DQogICAgICAgIHVpbnQyNTYgY3JlYXRpb25UaW1lOw0KICAgICAgICB1aW50MjU2W10gcm91bmRJRHM7DQogICAgICAgIG1hcHBpbmcgKHVpbnQyNTYgPT4gUm91bmQpIHJvdW5kczsgIC8vIHJvdW5kSUQNCiAgICB9IA0KDQogICAgc3RydWN0IFJvdW5kIHsNCiAgICAgICAgdWludDI1NiBjcmVhdGlvblRpbWU7DQogICAgICAgIHVpbnQyNTYgZW5kVGltZTsNCiAgICAgICAgdWludDI1NiByZXNvbHV0aW9uVGltZTsNCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChieXRlczMyID0+IFN0YWtlKSkgc3Rha2VzOyAgLy8gYWRkcmVzcyBvZiBzdGFrZXINCiAgICB9DQoNCiAgICAvLyBUaGUgb3JkZXIgaXMgaW1wb3J0YW50IGhlcmUgYmVjYXVzZSBvZiBpdHMgcGFja2luZyBjaGFyYWN0ZXJpc3RpY3MuDQogICAgLy8gUGFydGljdWxhcmx5LCBgYW1vdW50YCBhbmQgYGNvbmZpZGVuY2VgIGFyZSBpbiB0aGUgKnNhbWUqIHdvcmQsIHNvDQogICAgLy8gU29saWRpdHkgY2FuIHVwZGF0ZSBib3RoIGF0IHRoZSBzYW1lIHRpbWUgKGlmIHRoZSBvcHRpbWl6ZXIgY2FuIGZpZ3VyZQ0KICAgIC8vIG91dCB0aGF0IHlvdSdyZSB1cGRhdGluZyBib3RoKS4gIFRoaXMgbWFrZXMgYHN0YWtlKClgIGNoZWFwLg0KICAgIHN0cnVjdCBTdGFrZSB7DQogICAgICAgIHVpbnQxMjggYW1vdW50OyAvLyBPbmNlIHRoZSBzdGFrZSBpcyByZXNvbHZlZCwgdGhpcyBiZWNvbWVzIDANCiAgICAgICAgdWludDEyOCBjb25maWRlbmNlOw0KICAgICAgICBib29sIHN1Y2Nlc3NmdWw7DQogICAgICAgIGJvb2wgcmVzb2x2ZWQ7DQogICAgfQ0KDQogICAgLy8gR2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRvIG5vdGlmeSBjbGllbnRzDQogICAgZXZlbnQgTWludCh1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBTdGFrZWQoYWRkcmVzcyBpbmRleGVkIHN0YWtlciwgYnl0ZXMzMiB0YWcsIHVpbnQyNTYgdG90YWxBbW91bnRTdGFrZWQsIHVpbnQyNTYgY29uZmlkZW5jZSwgdWludDI1NiBpbmRleGVkIHRvdXJuYW1lbnRJRCwgdWludDI1NiBpbmRleGVkIHJvdW5kSUQpOw0KICAgIGV2ZW50IFJvdW5kQ3JlYXRlZCh1aW50MjU2IGluZGV4ZWQgdG91cm5hbWVudElELCB1aW50MjU2IGluZGV4ZWQgcm91bmRJRCwgdWludDI1NiBlbmRUaW1lLCB1aW50MjU2IHJlc29sdXRpb25UaW1lKTsNCiAgICBldmVudCBUb3VybmFtZW50Q3JlYXRlZCh1aW50MjU2IGluZGV4ZWQgdG91cm5hbWVudElEKTsNCiAgICBldmVudCBTdGFrZURlc3Ryb3llZCh1aW50MjU2IGluZGV4ZWQgdG91cm5hbWVudElELCB1aW50MjU2IGluZGV4ZWQgcm91bmRJRCwgYWRkcmVzcyBpbmRleGVkIHN0YWtlckFkZHJlc3MsIGJ5dGVzMzIgdGFnKTsNCiAgICBldmVudCBTdGFrZVJlbGVhc2VkKHVpbnQyNTYgaW5kZXhlZCB0b3VybmFtZW50SUQsIHVpbnQyNTYgaW5kZXhlZCByb3VuZElELCBhZGRyZXNzIGluZGV4ZWQgc3Rha2VyQWRkcmVzcywgYnl0ZXMzMiB0YWcsIHVpbnQyNTYgZXRoZXJSZXdhcmQpOw0KDQogICAgLy8gQ2FsY3VsYXRlIGFsbG93YWJsZSBkaXNidXJzZW1lbnQNCiAgICBmdW5jdGlvbiBnZXRNaW50YWJsZSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICAgICAgcmV0dXJuDQogICAgICAgICAgICBzYWZlU3VidHJhY3QoDQogICAgICAgICAgICAgICAgc2FmZUFkZChpbml0aWFsX2Rpc2J1cnNlbWVudCwNCiAgICAgICAgICAgICAgICAgICAgc2FmZU11bHRpcGx5KHdlZWtseV9kaXNidXJzZW1lbnQsDQogICAgICAgICAgICAgICAgICAgICAgICBzYWZlU3VidHJhY3QoYmxvY2sudGltZXN0YW1wLCBkZXBsb3lfdGltZSkpDQogICAgICAgICAgICAgICAgICAgIC8gMSB3ZWVrcyksDQogICAgICAgICAgICAgICAgdG90YWxfbWludGVkKTsNCiAgICB9DQp9DQoNCi8vIEZyb20gT3BlblplcHBsaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9PcGVuWmVwcGVsaW4vemVwcGVsaW4tc29saWRpdHkvYmxvYi9tYXN0ZXIvY29udHJhY3RzL293bmVyc2hpcC9TaGFyZWFibGUuc29sDQovKg0KICogU2hhcmVhYmxlDQogKiANCiAqIEVmZmVjdGl2ZWx5IG91ciBtdWx0aXNpZyBjb250cmFjdA0KICoNCiAqIEJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9kYXBwLWJpbi9ibG9iL21hc3Rlci93YWxsZXQvd2FsbGV0LnNvbA0KICoNCiAqIGluaGVyaXRhYmxlICJwcm9wZXJ0eSIgY29udHJhY3QgdGhhdCBlbmFibGVzIG1ldGhvZHMgdG8gYmUgcHJvdGVjdGVkIGJ5IHJlcXVpcmluZyB0aGUgYWNxdWllc2NlbmNlIG9mIGVpdGhlciBhIHNpbmdsZSwgb3IsIGNydWNpYWxseSwgZWFjaCBvZiBhIG51bWJlciBvZiwgZGVzaWduYXRlZCBvd25lcnMuDQogKg0KICogdXNhZ2U6DQogKiB1c2UgbW9kaWZpZXJzIG9ubHlvd25lciAoanVzdCBvd24gb3duZWQpIG9yIG9ubHltYW55b3duZXJzKGhhc2gpLCB3aGVyZWJ5IHRoZSBzYW1lIGhhc2ggbXVzdCBiZSBwcm92aWRlZCBieSBzb21lIG51bWJlciAoc3BlY2lmaWVkIGluIGNvbnN0cnVjdG9yKSBvZiB0aGUgc2V0IG9mIG93bmVycyAoc3BlY2lmaWVkIGluIHRoZSBjb25zdHJ1Y3RvcikgYmVmb3JlIHRoZSBpbnRlcmlvciBpcyBleGVjdXRlZC4NCiAqLw0KY29udHJhY3QgU2hhcmVhYmxlIHsNCiAgLy8gVFlQRVMNCg0KICAvLyBzdHJ1Y3QgZm9yIHRoZSBzdGF0dXMgb2YgYSBwZW5kaW5nIG9wZXJhdGlvbi4NCiAgc3RydWN0IFBlbmRpbmdTdGF0ZSB7DQogICAgdWludCB5ZXROZWVkZWQ7DQogICAgdWludCBvd25lcnNEb25lOw0KICAgIHVpbnQgaW5kZXg7DQogIH0NCg0KDQogIC8vIEZJRUxEUw0KDQogIC8vIHRoZSBudW1iZXIgb2Ygb3duZXJzIHRoYXQgbXVzdCBjb25maXJtIHRoZSBzYW1lIG9wZXJhdGlvbiBiZWZvcmUgaXQgaXMgcnVuLg0KICB1aW50IHB1YmxpYyByZXF1aXJlZDsNCg0KICAvLyBsaXN0IG9mIG93bmVycw0KICBhZGRyZXNzWzI1Nl0gb3duZXJzOw0KICB1aW50IGNvbnN0YW50IGNfbWF4T3duZXJzID0gMjUwOw0KICAvLyBpbmRleCBvbiB0aGUgbGlzdCBvZiBvd25lcnMgdG8gYWxsb3cgcmV2ZXJzZSBsb29rdXANCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIG93bmVySW5kZXg7DQogIC8vIHRoZSBvbmdvaW5nIG9wZXJhdGlvbnMuDQogIG1hcHBpbmcoYnl0ZXMzMiA9PiBQZW5kaW5nU3RhdGUpIHBlbmRpbmdzOw0KICBieXRlczMyW10gcGVuZGluZ3NJbmRleDsNCg0KDQogIC8vIEVWRU5UUw0KDQogIC8vIHRoaXMgY29udHJhY3Qgb25seSBoYXMgc2l4IHR5cGVzIG9mIGV2ZW50czogaXQgY2FuIGFjY2VwdCBhIGNvbmZpcm1hdGlvbiwgaW4gd2hpY2ggY2FzZQ0KICAvLyB3ZSByZWNvcmQgb3duZXIgYW5kIG9wZXJhdGlvbiAoaGFzaCkgYWxvbmdzaWRlIGl0Lg0KICBldmVudCBDb25maXJtYXRpb24oYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOw0KICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOw0KDQoNCiAgLy8gTU9ESUZJRVJTDQoNCiAgYWRkcmVzcyB0aGlzQ29udHJhY3QgPSB0aGlzOw0KDQogIC8vIHNpbXBsZSBzaW5nbGUtc2lnIGZ1bmN0aW9uIG1vZGlmaWVyLg0KICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgIGlmIChpc093bmVyKG1zZy5zZW5kZXIpKQ0KICAgICAgXzsNCiAgfQ0KDQogIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXINCiAgLy8gdGhhdCBsYXRlciBhdHRlbXB0cyBjYW4gYmUgcmVhbGlzZWQgYXMgdGhlIHNhbWUgdW5kZXJseWluZyBvcGVyYXRpb24gYW5kDQogIC8vIHRodXMgY291bnQgYXMgY29uZmlybWF0aW9ucy4NCiAgbW9kaWZpZXIgb25seU1hbnlPd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7DQogICAgaWYgKGNvbmZpcm1BbmRDaGVjayhfb3BlcmF0aW9uKSkNCiAgICAgIF87DQogIH0NCg0KDQogIC8vIENPTlNUUlVDVE9SDQoNCiAgLy8gY29uc3RydWN0b3IgaXMgZ2l2ZW4gbnVtYmVyIG9mIHNpZ3MgcmVxdWlyZWQgdG8gZG8gcHJvdGVjdGVkICJvbmx5bWFueW93bmVycyIgdHJhbnNhY3Rpb25zDQogIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0uDQogIGZ1bmN0aW9uIFNoYXJlYWJsZShhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIHsNCiAgICBvd25lcnNbMV0gPSBtc2cuc2VuZGVyOw0KICAgIG93bmVySW5kZXhbbXNnLnNlbmRlcl0gPSAxOw0KICAgIGZvciAodWludCBpID0gMDsgaSA8IF9vd25lcnMubGVuZ3RoOyArK2kpIHsNCiAgICAgIG93bmVyc1syICsgaV0gPSBfb3duZXJzW2ldOw0KICAgICAgb3duZXJJbmRleFtfb3duZXJzW2ldXSA9IDIgKyBpOw0KICAgIH0NCiAgICBpZiAocmVxdWlyZWQgPiBvd25lcnMubGVuZ3RoKSB0aHJvdzsNCiAgICByZXF1aXJlZCA9IF9yZXF1aXJlZDsNCiAgfQ0KDQoNCiAgLy8gbmV3IG11bHRpc2lnIGlzIGdpdmVuIG51bWJlciBvZiBzaWdzIHJlcXVpcmVkIHRvIGRvIHByb3RlY3RlZCAib25seW1hbnlvd25lcnMiIHRyYW5zYWN0aW9ucw0KICAvLyBhcyB3ZWxsIGFzIHRoZSBzZWxlY3Rpb24gb2YgYWRkcmVzc2VzIGNhcGFibGUgb2YgY29uZmlybWluZyB0aGVtLg0KICAvLyB0YWtlIGFsbCBuZXcgb3duZXJzIGFzIGFuIGFycmF5DQogIGZ1bmN0aW9uIGNoYW5nZVNoYXJlYWJsZShhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIG9ubHlNYW55T3duZXJzKHNoYTMobXNnLmRhdGEpKSB7DQogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX293bmVycy5sZW5ndGg7ICsraSkgew0KICAgICAgb3duZXJzWzEgKyBpXSA9IF9vd25lcnNbaV07DQogICAgICBvd25lckluZGV4W19vd25lcnNbaV1dID0gMSArIGk7DQogICAgfQ0KICAgIGlmIChyZXF1aXJlZCA+IG93bmVycy5sZW5ndGgpIHRocm93Ow0KICAgIHJlcXVpcmVkID0gX3JlcXVpcmVkOw0KICB9DQoNCiAgLy8gTUVUSE9EUw0KDQogIC8vIFJldm9rZXMgYSBwcmlvciBjb25maXJtYXRpb24gb2YgdGhlIGdpdmVuIG9wZXJhdGlvbg0KICBmdW5jdGlvbiByZXZva2UoYnl0ZXMzMiBfb3BlcmF0aW9uKSBleHRlcm5hbCB7DQogICAgdWludCBpbmRleCA9IG93bmVySW5kZXhbbXNnLnNlbmRlcl07DQogICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICBpZiAoaW5kZXggPT0gMCkgcmV0dXJuOw0KICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IDIqKmluZGV4Ow0KICAgIHZhciBwZW5kaW5nID0gcGVuZGluZ3NbX29wZXJhdGlvbl07DQogICAgaWYgKHBlbmRpbmcub3duZXJzRG9uZSAmIG93bmVySW5kZXhCaXQgPiAwKSB7DQogICAgICBwZW5kaW5nLnlldE5lZWRlZCsrOw0KICAgICAgcGVuZGluZy5vd25lcnNEb25lIC09IG93bmVySW5kZXhCaXQ7DQogICAgICBSZXZva2UobXNnLnNlbmRlciwgX29wZXJhdGlvbik7DQogICAgfQ0KICB9DQoNCiAgLy8gR2V0cyBhbiBvd25lciBieSAwLWluZGV4ZWQgcG9zaXRpb24gKHVzaW5nIG51bU93bmVycyBhcyB0aGUgY291bnQpDQogIGZ1bmN0aW9uIGdldE93bmVyKHVpbnQgb3duZXJJbmRleCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgIHJldHVybiBhZGRyZXNzKG93bmVyc1tvd25lckluZGV4ICsgMV0pOw0KICB9DQoNCiAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIF9hZGRyKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7DQogICAgcmV0dXJuIG93bmVySW5kZXhbX2FkZHJdID4gMDsNCiAgfQ0KDQogIGZ1bmN0aW9uIGhhc0NvbmZpcm1lZChieXRlczMyIF9vcGVyYXRpb24sIGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zIChib29sKSB7DQogICAgdmFyIHBlbmRpbmcgPSBwZW5kaW5nc1tfb3BlcmF0aW9uXTsNCiAgICB1aW50IGluZGV4ID0gb3duZXJJbmRleFtfb3duZXJdOw0KDQogICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICBpZiAoaW5kZXggPT0gMCkgcmV0dXJuIGZhbHNlOw0KDQogICAgLy8gZGV0ZXJtaW5lIHRoZSBiaXQgdG8gc2V0IGZvciB0aGlzIG93bmVyLg0KICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IDIqKmluZGV4Ow0KICAgIHJldHVybiAhKHBlbmRpbmcub3duZXJzRG9uZSAmIG93bmVySW5kZXhCaXQgPT0gMCk7DQogIH0NCg0KICAvLyBJTlRFUk5BTCBNRVRIT0RTDQoNCiAgZnVuY3Rpb24gY29uZmlybUFuZENoZWNrKGJ5dGVzMzIgX29wZXJhdGlvbikgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgew0KICAgIC8vIGRldGVybWluZSB3aGF0IGluZGV4IHRoZSBwcmVzZW50IHNlbmRlciBpczoNCiAgICB1aW50IGluZGV4ID0gb3duZXJJbmRleFttc2cuc2VuZGVyXTsNCiAgICAvLyBtYWtlIHN1cmUgdGhleSdyZSBhbiBvd25lcg0KICAgIGlmIChpbmRleCA9PSAwKSByZXR1cm47DQoNCiAgICB2YXIgcGVuZGluZyA9IHBlbmRpbmdzW19vcGVyYXRpb25dOw0KICAgIC8vIGlmIHdlJ3JlIG5vdCB5ZXQgd29ya2luZyBvbiB0aGlzIG9wZXJhdGlvbiwgc3dpdGNoIG92ZXIgYW5kIHJlc2V0IHRoZSBjb25maXJtYXRpb24gc3RhdHVzLg0KICAgIGlmIChwZW5kaW5nLnlldE5lZWRlZCA9PSAwKSB7DQogICAgICAvLyByZXNldCBjb3VudCBvZiBjb25maXJtYXRpb25zIG5lZWRlZC4NCiAgICAgIHBlbmRpbmcueWV0TmVlZGVkID0gcmVxdWlyZWQ7DQogICAgICAvLyByZXNldCB3aGljaCBvd25lcnMgaGF2ZSBjb25maXJtZWQgKG5vbmUpIC0gc2V0IG91ciBiaXRtYXAgdG8gMC4NCiAgICAgIHBlbmRpbmcub3duZXJzRG9uZSA9IDA7DQogICAgICBwZW5kaW5nLmluZGV4ID0gcGVuZGluZ3NJbmRleC5sZW5ndGgrKzsNCiAgICAgIHBlbmRpbmdzSW5kZXhbcGVuZGluZy5pbmRleF0gPSBfb3BlcmF0aW9uOw0KICAgIH0NCiAgICAvLyBkZXRlcm1pbmUgdGhlIGJpdCB0byBzZXQgZm9yIHRoaXMgb3duZXIuDQogICAgdWludCBvd25lckluZGV4Qml0ID0gMioqaW5kZXg7DQogICAgLy8gbWFrZSBzdXJlIHdlICh0aGUgbWVzc2FnZSBzZW5kZXIpIGhhdmVuJ3QgY29uZmlybWVkIHRoaXMgb3BlcmF0aW9uIHByZXZpb3VzbHkuDQogICAgaWYgKHBlbmRpbmcub3duZXJzRG9uZSAmIG93bmVySW5kZXhCaXQgPT0gMCkgew0KICAgICAgQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIF9vcGVyYXRpb24pOw0KICAgICAgLy8gb2sgLSBjaGVjayBpZiBjb3VudCBpcyBlbm91Z2ggdG8gZ28gYWhlYWQuDQogICAgICBpZiAocGVuZGluZy55ZXROZWVkZWQgPD0gMSkgew0KICAgICAgICAvLyBlbm91Z2ggY29uZmlybWF0aW9uczogcmVzZXQgYW5kIHJ1biBpbnRlcmlvci4NCiAgICAgICAgZGVsZXRlIHBlbmRpbmdzSW5kZXhbcGVuZGluZ3NbX29wZXJhdGlvbl0uaW5kZXhdOw0KICAgICAgICBkZWxldGUgcGVuZGluZ3NbX29wZXJhdGlvbl07DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfQ0KICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgLy8gbm90IGVub3VnaDogcmVjb3JkIHRoYXQgdGhpcyBvd25lciBpbiBwYXJ0aWN1bGFyIGNvbmZpcm1lZC4NCiAgICAgICAgICBwZW5kaW5nLnlldE5lZWRlZC0tOw0KICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSB8PSBvd25lckluZGV4Qml0Ow0KICAgICAgICB9DQogICAgfQ0KICB9DQoNCiAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgaW50ZXJuYWwgew0KICAgIHVpbnQgbGVuZ3RoID0gcGVuZGluZ3NJbmRleC5sZW5ndGg7DQogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpDQogICAgaWYgKHBlbmRpbmdzSW5kZXhbaV0gIT0gMCkNCiAgICAgIGRlbGV0ZSBwZW5kaW5nc1twZW5kaW5nc0luZGV4W2ldXTsNCiAgICBkZWxldGUgcGVuZGluZ3NJbmRleDsNCiAgfQ0KfQ0KDQovLyBGcm9tIE9wZW5aZXBwbGluOiBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9saWZlY3ljbGUvUGF1c2FibGUuc29sDQovKg0KICogU3RvcHBhYmxlDQogKiBBYnN0cmFjdCBjb250cmFjdCB0aGF0IGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4NCiAqIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4NCiAqLw0KY29udHJhY3QgU3RvcHBhYmxlU2hhcmVhYmxlIGlzIFNoYXJlYWJsZSB7DQogIGJvb2wgcHVibGljIHN0b3BwZWQ7DQogIGJvb2wgcHVibGljIHN0b3BwYWJsZSA9IHRydWU7DQoNCiAgbW9kaWZpZXIgc3RvcEluRW1lcmdlbmN5IHsgaWYgKCFzdG9wcGVkKSBfOyB9DQogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7IGlmIChzdG9wcGVkKSBfOyB9DQoNCiAgZnVuY3Rpb24gU3RvcHBhYmxlU2hhcmVhYmxlKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9yZXF1aXJlZCkgU2hhcmVhYmxlKF9vd25lcnMsIF9yZXF1aXJlZCkgew0KICB9DQoNCiAgLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUNCiAgZnVuY3Rpb24gZW1lcmdlbmN5U3RvcCgpIGV4dGVybmFsIG9ubHlPd25lciB7DQogICAgYXNzZXJ0KHN0b3BwYWJsZSk7DQogICAgc3RvcHBlZCA9IHRydWU7DQogIH0NCg0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVycyBvbiBlbmQgb2YgZW1lcmdlbmN5LCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQ0KICBmdW5jdGlvbiByZWxlYXNlKCkgZXh0ZXJuYWwgb25seU1hbnlPd25lcnMoc2hhMyhtc2cuZGF0YSkpIHsNCiAgICBhc3NlcnQoc3RvcHBhYmxlKTsNCiAgICBzdG9wcGVkID0gZmFsc2U7DQogIH0NCg0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVycyB0byBkaXNhYmxlIGFiaWxpdHkgdG8gYmVnaW4gb3IgZW5kIGFuIGVtZXJnZW5jeSBzdG9wDQogIGZ1bmN0aW9uIGRpc2FibGVTdG9wcGluZygpIGV4dGVybmFsIG9ubHlNYW55T3duZXJzKHNoYTMobXNnLmRhdGEpKSB7DQogICAgc3RvcHBhYmxlID0gZmFsc2U7DQogIH0NCn0NCg0KLy8gVGhpcyBpcyB0aGUgY29udHJhY3QgdGhhdCB3aWxsIGJlIHVuY2hhbmdlYWJsZSBvbmNlIGRlcGxveWVkLiAgSXQgd2lsbCBjYWxsIGRlbGVnYXRlIGZ1bmN0aW9ucyBpbiBhbm90aGVyIGNvbnRyYWN0IHRvIGNoYW5nZSBzdGF0ZS4gIFRoZSBkZWxlZ2F0ZSBjb250cmFjdCBpcyB1cGdyYWRhYmxlLg0KDQpjb250cmFjdCBOdW1lcmFpcmVCYWNrZW5kIGlzIFN0b3BwYWJsZVNoYXJlYWJsZSwgTnVtZXJhaXJlU2hhcmVkIHsNCg0KICAgIGFkZHJlc3MgcHVibGljIGRlbGVnYXRlQ29udHJhY3Q7DQogICAgYm9vbCBwdWJsaWMgY29udHJhY3RVcGdyYWRhYmxlID0gdHJ1ZTsNCiAgICBhZGRyZXNzW10gcHVibGljIHByZXZpb3VzRGVsZWdhdGVzOw0KDQogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICJFUkMyMCI7DQoNCiAgICAvLyBFUkMyMCByZXF1aXJlcyBuYW1lLCBzeW1ib2wsIGFuZCBkZWNpbWFscw0KICAgIHN0cmluZyBwdWJsaWMgbmFtZSA9ICJOdW1lcmFpcmUiOw0KICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIk5NUiI7DQogICAgdWludDI1NiBwdWJsaWMgZGVjaW1hbHMgPSAxODsNCg0KICAgIGV2ZW50IERlbGVnYXRlQ2hhbmdlZChhZGRyZXNzIG9sZEFkZHJlc3MsIGFkZHJlc3MgbmV3QWRkcmVzcyk7DQoNCiAgICBmdW5jdGlvbiBOdW1lcmFpcmVCYWNrZW5kKGFkZHJlc3NbXSBfb3duZXJzLCB1aW50MjU2IF9udW1fcmVxdWlyZWQsIHVpbnQyNTYgX2luaXRpYWxfZGlzYnVyc2VtZW50KSBTdG9wcGFibGVTaGFyZWFibGUoX293bmVycywgX251bV9yZXF1aXJlZCkgew0KICAgICAgICB0b3RhbFN1cHBseSA9IDA7DQogICAgICAgIHRvdGFsX21pbnRlZCA9IDA7DQoNCiAgICAgICAgaW5pdGlhbF9kaXNidXJzZW1lbnQgPSBfaW5pdGlhbF9kaXNidXJzZW1lbnQ7DQogICAgICAgIGRlcGxveV90aW1lID0gYmxvY2sudGltZXN0YW1wOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRpc2FibGVDb250cmFjdFVwZ3JhZGFiaWxpdHkoKSBvbmx5TWFueU93bmVycyhzaGEzKG1zZy5kYXRhKSkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBhc3NlcnQoY29udHJhY3RVcGdyYWRhYmxlKTsNCiAgICAgICAgY29udHJhY3RVcGdyYWRhYmxlID0gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2hhbmdlRGVsZWdhdGUoYWRkcmVzcyBfbmV3RGVsZWdhdGUpIG9ubHlNYW55T3duZXJzKHNoYTMobXNnLmRhdGEpKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIGFzc2VydChjb250cmFjdFVwZ3JhZGFibGUpOw0KDQogICAgICAgIGlmIChfbmV3RGVsZWdhdGUgIT0gZGVsZWdhdGVDb250cmFjdCkgew0KICAgICAgICAgICAgcHJldmlvdXNEZWxlZ2F0ZXMucHVzaChkZWxlZ2F0ZUNvbnRyYWN0KTsNCiAgICAgICAgICAgIHZhciBvbGREZWxlZ2F0ZSA9IGRlbGVnYXRlQ29udHJhY3Q7DQogICAgICAgICAgICBkZWxlZ2F0ZUNvbnRyYWN0ID0gX25ld0RlbGVnYXRlOw0KICAgICAgICAgICAgRGVsZWdhdGVDaGFuZ2VkKG9sZERlbGVnYXRlLCBfbmV3RGVsZWdhdGUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pIG9ubHlPd25lciB7DQogICAgICAgIGFzc2VydChfdG9rZW4gIT0gbnVtZXJhaSk7DQogICAgICAgIGlmIChfdG9rZW4gPT0gMHgwKSB7DQogICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBOdW1lcmFpcmVCYWNrZW5kIHRva2VuID0gTnVtZXJhaXJlQmFja2VuZChfdG9rZW4pOw0KICAgICAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7DQogICAgICAgIHRva2VuLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGJhbGFuY2UpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG1pbnQodWludDI1NiBfdmFsdWUpIHN0b3BJbkVtZXJnZW5jeSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIHJldHVybiBkZWxlZ2F0ZUNvbnRyYWN0LmRlbGVnYXRlY2FsbChieXRlczQoc2hhMygibWludCh1aW50MjU2KSIpKSwgX3ZhbHVlKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzdGFrZSh1aW50MjU2IF92YWx1ZSwgYnl0ZXMzMiBfdGFnLCB1aW50MjU2IF90b3VybmFtZW50SUQsIHVpbnQyNTYgX3JvdW5kSUQsIHVpbnQyNTYgX2NvbmZpZGVuY2UpIHN0b3BJbkVtZXJnZW5jeSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIHJldHVybiBkZWxlZ2F0ZUNvbnRyYWN0LmRlbGVnYXRlY2FsbChieXRlczQoc2hhMygic3Rha2UodWludDI1NixieXRlczMyLHVpbnQyNTYsdWludDI1Nix1aW50MjU2KSIpKSwgX3ZhbHVlLCBfdGFnLCBfdG91cm5hbWVudElELCBfcm91bmRJRCwgX2NvbmZpZGVuY2UpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN0YWtlT25CZWhhbGYoYWRkcmVzcyBfc3Rha2VyLCB1aW50MjU2IF92YWx1ZSwgYnl0ZXMzMiBfdGFnLCB1aW50MjU2IF90b3VybmFtZW50SUQsIHVpbnQyNTYgX3JvdW5kSUQsIHVpbnQyNTYgX2NvbmZpZGVuY2UpIHN0b3BJbkVtZXJnZW5jeSBvbmx5UGF5bG9hZFNpemUoNikgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICByZXR1cm4gZGVsZWdhdGVDb250cmFjdC5kZWxlZ2F0ZWNhbGwoYnl0ZXM0KHNoYTMoInN0YWtlT25CZWhhbGYoYWRkcmVzcyx1aW50MjU2LGJ5dGVzMzIsdWludDI1Nix1aW50MjU2LHVpbnQyNTYpIikpLCBfc3Rha2VyLCBfdmFsdWUsIF90YWcsIF90b3VybmFtZW50SUQsIF9yb3VuZElELCBfY29uZmlkZW5jZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVsZWFzZVN0YWtlKGFkZHJlc3MgX3N0YWtlciwgYnl0ZXMzMiBfdGFnLCB1aW50MjU2IF9ldGhlclZhbHVlLCB1aW50MjU2IF90b3VybmFtZW50SUQsIHVpbnQyNTYgX3JvdW5kSUQsIGJvb2wgX3N1Y2Nlc3NmdWwpIHN0b3BJbkVtZXJnZW5jeSBvbmx5UGF5bG9hZFNpemUoNikgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICByZXR1cm4gZGVsZWdhdGVDb250cmFjdC5kZWxlZ2F0ZWNhbGwoYnl0ZXM0KHNoYTMoInJlbGVhc2VTdGFrZShhZGRyZXNzLGJ5dGVzMzIsdWludDI1Nix1aW50MjU2LHVpbnQyNTYsYm9vbCkiKSksIF9zdGFrZXIsIF90YWcsIF9ldGhlclZhbHVlLCBfdG91cm5hbWVudElELCBfcm91bmRJRCwgX3N1Y2Nlc3NmdWwpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRlc3Ryb3lTdGFrZShhZGRyZXNzIF9zdGFrZXIsIGJ5dGVzMzIgX3RhZywgdWludDI1NiBfdG91cm5hbWVudElELCB1aW50MjU2IF9yb3VuZElEKSBzdG9wSW5FbWVyZ2VuY3kgb25seVBheWxvYWRTaXplKDQpIHJldHVybnMgKGJvb2wgb2spIHsNCiAgICAgICAgcmV0dXJuIGRlbGVnYXRlQ29udHJhY3QuZGVsZWdhdGVjYWxsKGJ5dGVzNChzaGEzKCJkZXN0cm95U3Rha2UoYWRkcmVzcyxieXRlczMyLHVpbnQyNTYsdWludDI1NikiKSksIF9zdGFrZXIsIF90YWcsIF90b3VybmFtZW50SUQsIF9yb3VuZElEKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBudW1lcmFpVHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMikgcmV0dXJucyhib29sIG9rKSB7DQogICAgICAgIHJldHVybiBkZWxlZ2F0ZUNvbnRyYWN0LmRlbGVnYXRlY2FsbChieXRlczQoc2hhMygibnVtZXJhaVRyYW5zZmVyKGFkZHJlc3MsdWludDI1NikiKSksIF90bywgX3ZhbHVlKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB3aXRoZHJhdyhhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgzKSByZXR1cm5zKGJvb2wgb2spIHsNCiAgICAgICAgcmV0dXJuIGRlbGVnYXRlQ29udHJhY3QuZGVsZWdhdGVjYWxsKGJ5dGVzNChzaGEzKCJ3aXRoZHJhdyhhZGRyZXNzLGFkZHJlc3MsdWludDI1NikiKSksIF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY3JlYXRlVG91cm5hbWVudCh1aW50MjU2IF90b3VybmFtZW50SUQpIHJldHVybnMgKGJvb2wgb2spIHsNCiAgICAgICAgcmV0dXJuIGRlbGVnYXRlQ29udHJhY3QuZGVsZWdhdGVjYWxsKGJ5dGVzNChzaGEzKCJjcmVhdGVUb3VybmFtZW50KHVpbnQyNTYpIikpLCBfdG91cm5hbWVudElEKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjcmVhdGVSb3VuZCh1aW50MjU2IF90b3VybmFtZW50SUQsIHVpbnQyNTYgX3JvdW5kSUQsIHVpbnQyNTYgX2VuZFRpbWUsIHVpbnQyNTYgX3Jlc29sdXRpb25UaW1lKSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIHJldHVybiBkZWxlZ2F0ZUNvbnRyYWN0LmRlbGVnYXRlY2FsbChieXRlczQoc2hhMygiY3JlYXRlUm91bmQodWludDI1Nix1aW50MjU2LHVpbnQyNTYsdWludDI1NikiKSksIF90b3VybmFtZW50SUQsIF9yb3VuZElELCBfZW5kVGltZSwgX3Jlc29sdXRpb25UaW1lKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRUb3VybmFtZW50KHVpbnQyNTYgX3RvdXJuYW1lbnRJRCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiwgdWludDI1NltdKSB7DQogICAgICAgIHZhciB0b3VybmFtZW50ID0gdG91cm5hbWVudHNbX3RvdXJuYW1lbnRJRF07DQogICAgICAgIHJldHVybiAodG91cm5hbWVudC5jcmVhdGlvblRpbWUsIHRvdXJuYW1lbnQucm91bmRJRHMpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldFJvdW5kKHVpbnQyNTYgX3RvdXJuYW1lbnRJRCwgdWludDI1NiBfcm91bmRJRCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiwgdWludDI1NiwgdWludDI1Nikgew0KICAgICAgICB2YXIgcm91bmQgPSB0b3VybmFtZW50c1tfdG91cm5hbWVudElEXS5yb3VuZHNbX3JvdW5kSURdOw0KICAgICAgICByZXR1cm4gKHJvdW5kLmNyZWF0aW9uVGltZSwgcm91bmQuZW5kVGltZSwgcm91bmQucmVzb2x1dGlvblRpbWUpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldFN0YWtlKHVpbnQyNTYgX3RvdXJuYW1lbnRJRCwgdWludDI1NiBfcm91bmRJRCwgYWRkcmVzcyBfc3Rha2VyLCBieXRlczMyIF90YWcpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYsIHVpbnQyNTYsIGJvb2wsIGJvb2wpIHsNCiAgICAgICAgdmFyIHN0YWtlID0gdG91cm5hbWVudHNbX3RvdXJuYW1lbnRJRF0ucm91bmRzW19yb3VuZElEXS5zdGFrZXNbX3N0YWtlcl1bX3RhZ107DQogICAgICAgIHJldHVybiAoc3Rha2UuY29uZmlkZW5jZSwgc3Rha2UuYW1vdW50LCBzdGFrZS5zdWNjZXNzZnVsLCBzdGFrZS5yZXNvbHZlZCk7DQogICAgfQ0KDQogICAgLy8gRVJDMjA6IFNlbmQgZnJvbSBhIGNvbnRyYWN0DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgc3RvcEluRW1lcmdlbmN5IG9ubHlQYXlsb2FkU2l6ZSgzKSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIHJlcXVpcmUoIWlzT3duZXIoX2Zyb20pICYmIF9mcm9tICE9IG51bWVyYWkpOyAvLyBUcmFuc2ZlcmluZyBmcm9tIE51bWVyYWkgY2FuIG9ubHkgYmUgZG9uZSB3aXRoIHRoZSBudW1lcmFpVHJhbnNmZXIgZnVuY3Rpb24NCg0KICAgICAgICAvLyBDaGVjayBmb3Igc3VmZmljaWVudCBmdW5kcy4NCiAgICAgICAgcmVxdWlyZShiYWxhbmNlT2ZbX2Zyb21dID49IF92YWx1ZSk7DQogICAgICAgIC8vIENoZWNrIGZvciBhdXRob3JpemF0aW9uIHRvIHNwZW5kLg0KICAgICAgICByZXF1aXJlKGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPj0gX3ZhbHVlKTsNCg0KICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YnRyYWN0KGJhbGFuY2VPZltfZnJvbV0sIF92YWx1ZSk7DQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3VidHJhY3QoYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBzYWZlQWRkKGJhbGFuY2VPZltfdG9dLCBfdmFsdWUpOw0KDQogICAgICAgIC8vIE5vdGlmeSBhbnlvbmUgbGlzdGVuaW5nLg0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8vIEVSQzIwOiBBbnlvbmUgd2l0aCBOTVIgY2FuIHRyYW5zZmVyIE5NUg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgc3RvcEluRW1lcmdlbmN5IG9ubHlQYXlsb2FkU2l6ZSgyKSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIC8vIENoZWNrIGZvciBzdWZmaWNpZW50IGZ1bmRzLg0KICAgICAgICByZXF1aXJlKGJhbGFuY2VPZlttc2cuc2VuZGVyXSA+PSBfdmFsdWUpOw0KDQogICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSA9IHNhZmVTdWJ0cmFjdChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsNCg0KICAgICAgICAvLyBOb3RpZnkgYW55b25lIGxpc3RlbmluZy4NCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8vIEVSQzIwOiBBbGxvdyBvdGhlciBjb250cmFjdHMgdG8gc3BlbmQgb24gc2VuZGVyJ3MgYmVoYWxmDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgc3RvcEluRW1lcmdlbmN5IG9ubHlQYXlsb2FkU2l6ZSgyKSByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIHJlcXVpcmUoKF92YWx1ZSA9PSAwKSB8fCAoYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9PSAwKSk7DQogICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjaGFuZ2VBcHByb3ZhbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9vbGRWYWx1ZSwgdWludDI1NiBfbmV3VmFsdWUpIHN0b3BJbkVtZXJnZW5jeSBvbmx5UGF5bG9hZFNpemUoMykgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICByZXF1aXJlKGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gX29sZFZhbHVlKTsNCiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9uZXdWYWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF9uZXdWYWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0='