base 64 content
base64passContractorCreator
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQovKg0KVGhpcyBmaWxlIGlzIHBhcnQgb2YgUGFzcyBEQU8uDQoNClBhc3MgREFPIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCml0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3INCihhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNClBhc3MgREFPIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQpidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQoNCllvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBsZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KYWxvbmcgd2l0aCBQYXNzIERBTy4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiovDQoNCi8qDQpTbWFydCBjb250cmFjdCBmb3IgYSBEZWNlbnRyYWxpemVkIEF1dG9ub21vdXMgT3JnYW5pemF0aW9uIChEQU8pDQp0byBhdXRvbWF0ZSBvcmdhbml6YXRpb25hbCBnb3Zlcm5hbmNlIGFuZCBkZWNpc2lvbi1tYWtpbmcuDQoqLw0KDQovLy8gQHRpdGxlIFBhc3MgRGFvIHNtYXJ0IGNvbnRyYWN0DQpjb250cmFjdCBQYXNzRGFvIHsNCiAgICANCiAgICBzdHJ1Y3QgcmV2aXNpb24gew0KICAgICAgICAvLyBBZGRyZXNzIG9mIHRoZSBDb21taXR0ZWUgUm9vbSBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbW1pdHRlZVJvb207DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHNoYXJlIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAgICAgYWRkcmVzcyBzaGFyZU1hbmFnZXI7DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHRva2VuIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAgICAgYWRkcmVzcyB0b2tlbk1hbmFnZXI7DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHByb2plY3QgY3JlYXRvciBzbWFydCBjb250cmFjdA0KICAgICAgICB1aW50IHN0YXJ0RGF0ZTsNCiAgICB9DQogICAgLy8gVGhlIHJldmlzaW9ucyBvZiB0aGUgYXBwbGljYXRpb24gdW50aWwgdG9kYXkNCiAgICByZXZpc2lvbltdIHB1YmxpYyByZXZpc2lvbnM7DQoNCiAgICBzdHJ1Y3QgcHJvamVjdCB7DQogICAgICAgIC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbnRyYWN0QWRkcmVzczsNCiAgICAgICAgLy8gVGhlIHVuaXggZWZmZWN0aXZlIHN0YXJ0IGRhdGUgb2YgdGhlIGNvbnRyYWN0DQogICAgICAgIHVpbnQgc3RhcnREYXRlOw0KICAgIH0NCiAgICAvLyBUaGUgcHJvamVjdHMgb2YgdGhlIERhbw0KICAgIHByb2plY3RbXSBwdWJsaWMgcHJvamVjdHM7DQoNCiAgICAvLyBNYXAgd2l0aCB0aGUgaW5kZXhlcyBvZiB0aGUgcHJvamVjdHMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHByb2plY3RJRDsNCiAgICANCiAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgbWV0YSBwcm9qZWN0DQogICAgYWRkcmVzcyBtZXRhUHJvamVjdDsNCg0KICAgIA0KLy8gRXZlbnRzDQoNCiAgICBldmVudCBVcGdyYWRlKHVpbnQgaW5kZXhlZCBSZXZpc2lvbklELCBhZGRyZXNzIENvbW1pdHRlZVJvb20sIGFkZHJlc3MgU2hhcmVNYW5hZ2VyLCBhZGRyZXNzIFRva2VuTWFuYWdlcik7DQogICAgZXZlbnQgTmV3UHJvamVjdChhZGRyZXNzIFByb2plY3QpOw0KDQovLyBDb25zdGFudCBmdW5jdGlvbnMgIA0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSBlZmZlY3RpdmUgY29tbWl0dGVlIHJvb20NCiAgICBmdW5jdGlvbiBBY3R1YWxDb21taXR0ZWVSb29tKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gcmV2aXNpb25zWzBdLmNvbW1pdHRlZVJvb207DQogICAgfQ0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSBtZXRhIHByb2plY3QNCiAgICBmdW5jdGlvbiBNZXRhUHJvamVjdCgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIG1ldGFQcm9qZWN0Ow0KICAgIH0NCg0KICAgIC8vLyBAcmV0dXJuIFRoZSBlZmZlY3RpdmUgc2hhcmUgbWFuYWdlcg0KICAgIGZ1bmN0aW9uIEFjdHVhbFNoYXJlTWFuYWdlcigpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIHJldmlzaW9uc1swXS5zaGFyZU1hbmFnZXI7DQogICAgfQ0KDQogICAgLy8vIEByZXR1cm4gVGhlIGVmZmVjdGl2ZSB0b2tlbiBtYW5hZ2VyDQogICAgZnVuY3Rpb24gQWN0dWFsVG9rZW5NYW5hZ2VyKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gcmV2aXNpb25zWzBdLnRva2VuTWFuYWdlcjsNCiAgICB9DQoNCi8vIG1vZGlmaWVycw0KDQogICAgbW9kaWZpZXIgb25seVBhc3NDb21taXR0ZWVSb29tIHtpZiAobXNnLnNlbmRlciAhPSByZXZpc2lvbnNbMF0uY29tbWl0dGVlUm9vbSAgDQogICAgICAgICYmIHJldmlzaW9uc1swXS5jb21taXR0ZWVSb29tICE9IDApIHRocm93OyBfO30NCiAgICANCi8vIENvbnN0cnVjdG9yIGZ1bmN0aW9uDQoNCiAgICBmdW5jdGlvbiBQYXNzRGFvKCkgew0KICAgICAgICBwcm9qZWN0cy5sZW5ndGggPSAxOw0KICAgICAgICByZXZpc2lvbnMubGVuZ3RoID0gMTsNCiAgICB9DQogICAgDQovLyBSZWdpc3RlciBmdW5jdGlvbnMNCg0KICAgIC8vLyBAZGV2IEZ1bmN0aW9uIHRvIGFsbG93IHRoZSBhY3R1YWwgQ29tbWl0dGVlIFJvb20gdXBncmFkaW5nIHRoZSBhcHBsaWNhdGlvbg0KICAgIC8vLyBAcGFyYW0gX25ld0NvbW1pdHRlZVJvb20gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBjb21taXR0ZWUgcm9vbQ0KICAgIC8vLyBAcGFyYW0gX25ld1NoYXJlTWFuYWdlciBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IHNoYXJlIG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9uZXdUb2tlbk1hbmFnZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyB0b2tlbiBtYW5hZ2VyDQogICAgLy8vIEByZXR1cm4gVGhlIGluZGV4IG9mIHRoZSByZXZpc2lvbg0KICAgIGZ1bmN0aW9uIHVwZ3JhZGUoDQogICAgICAgIGFkZHJlc3MgX25ld0NvbW1pdHRlZVJvb20sIA0KICAgICAgICBhZGRyZXNzIF9uZXdTaGFyZU1hbmFnZXIsIA0KICAgICAgICBhZGRyZXNzIF9uZXdUb2tlbk1hbmFnZXIpIG9ubHlQYXNzQ29tbWl0dGVlUm9vbSByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICB1aW50IF9yZXZpc2lvbklEID0gcmV2aXNpb25zLmxlbmd0aCsrOw0KICAgICAgICByZXZpc2lvbiByID0gcmV2aXNpb25zW19yZXZpc2lvbklEXTsNCg0KICAgICAgICBpZiAoX25ld0NvbW1pdHRlZVJvb20gIT0gMCkgci5jb21taXR0ZWVSb29tID0gX25ld0NvbW1pdHRlZVJvb207IGVsc2Ugci5jb21taXR0ZWVSb29tID0gcmV2aXNpb25zWzBdLmNvbW1pdHRlZVJvb207DQogICAgICAgIGlmIChfbmV3U2hhcmVNYW5hZ2VyICE9IDApIHIuc2hhcmVNYW5hZ2VyID0gX25ld1NoYXJlTWFuYWdlcjsgZWxzZSByLnNoYXJlTWFuYWdlciA9IHJldmlzaW9uc1swXS5zaGFyZU1hbmFnZXI7DQogICAgICAgIGlmIChfbmV3VG9rZW5NYW5hZ2VyICE9IDApIHIudG9rZW5NYW5hZ2VyID0gX25ld1Rva2VuTWFuYWdlcjsgZWxzZSByLnRva2VuTWFuYWdlciA9IHJldmlzaW9uc1swXS50b2tlbk1hbmFnZXI7DQoNCiAgICAgICAgci5zdGFydERhdGUgPSBub3c7DQogICAgICAgIA0KICAgICAgICByZXZpc2lvbnNbMF0gPSByOw0KICAgICAgICANCiAgICAgICAgVXBncmFkZShfcmV2aXNpb25JRCwgX25ld0NvbW1pdHRlZVJvb20sIF9uZXdTaGFyZU1hbmFnZXIsIF9uZXdUb2tlbk1hbmFnZXIpOw0KICAgICAgICAgICAgDQogICAgICAgIHJldHVybiBfcmV2aXNpb25JRDsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBGdW5jdGlvbiB0byBzZXQgdGhlIG1ldGEgcHJvamVjdA0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3RBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBtZXRhIHByb2plY3QNCiAgICBmdW5jdGlvbiBhZGRNZXRhUHJvamVjdChhZGRyZXNzIF9wcm9qZWN0QWRkcmVzcykgb25seVBhc3NDb21taXR0ZWVSb29tIHsNCg0KICAgICAgICBtZXRhUHJvamVjdCA9IF9wcm9qZWN0QWRkcmVzczsNCiAgICB9DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIGNvbW1pdHRlZSByb29tIHRvIGFkZCBhIHByb2plY3Qgd2hlbiBvcmRlcmluZw0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3RBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBwcm9qZWN0DQogICAgZnVuY3Rpb24gYWRkUHJvamVjdChhZGRyZXNzIF9wcm9qZWN0QWRkcmVzcykgb25seVBhc3NDb21taXR0ZWVSb29tIHsNCg0KICAgICAgICBpZiAocHJvamVjdElEW19wcm9qZWN0QWRkcmVzc10gPT0gMCkgew0KDQogICAgICAgICAgICB1aW50IF9wcm9qZWN0SUQgPSBwcm9qZWN0cy5sZW5ndGgrKzsNCiAgICAgICAgICAgIHByb2plY3QgcCA9IHByb2plY3RzW19wcm9qZWN0SURdOw0KICAgICAgICANCiAgICAgICAgICAgIHByb2plY3RJRFtfcHJvamVjdEFkZHJlc3NdID0gX3Byb2plY3RJRDsNCiAgICAgICAgICAgIHAuY29udHJhY3RBZGRyZXNzID0gX3Byb2plY3RBZGRyZXNzOyANCiAgICAgICAgICAgIHAuc3RhcnREYXRlID0gbm93Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBOZXdQcm9qZWN0KF9wcm9qZWN0QWRkcmVzcyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQp9DQoNCnByYWdtYSBzb2xpZGl0eSBeMC40Ljg7DQoNCi8qDQogKg0KICogVGhpcyBmaWxlIGlzIHBhcnQgb2YgUGFzcyBEQU8uDQogKg0KICogVGhlIFByb2plY3Qgc21hcnQgY29udHJhY3QgaXMgdXNlZCBmb3IgdGhlIG1hbmFnZW1lbnQgb2YgdGhlIFBhc3MgRGFvIHByb2plY3RzLg0KICoNCiovDQoNCi8vLyBAdGl0bGUgUHJvamVjdCBzbWFydCBjb250cmFjdCBvZiB0aGUgUGFzcyBEZWNlbnRyYWxpemVkIEF1dG9ub21vdXMgT3JnYW5pc2F0aW9uDQpjb250cmFjdCBQYXNzUHJvamVjdCB7DQoNCiAgICAvLyBUaGUgUGFzcyBEYW8gc21hcnQgY29udHJhY3QNCiAgICBQYXNzRGFvIHB1YmxpYyBwYXNzRGFvOw0KICAgIA0KICAgIC8vIFRoZSBwcm9qZWN0IG5hbWUNCiAgICBzdHJpbmcgcHVibGljIG5hbWU7DQogICAgLy8gVGhlIHByb2plY3QgZGVzY3JpcHRpb24NCiAgICBzdHJpbmcgcHVibGljIGRlc2NyaXB0aW9uOw0KICAgIC8vIFRoZSBIYXNoIE9mIHRoZSBwcm9qZWN0IERvY3VtZW50DQogICAgYnl0ZXMzMiBwdWJsaWMgaGFzaE9mVGhlRG9jdW1lbnQ7DQogICAgLy8gVGhlIHByb2plY3QgbWFuYWdlciBzbWFydCBjb250cmFjdA0KICAgIGFkZHJlc3MgcHJvamVjdE1hbmFnZXI7DQoNCiAgICBzdHJ1Y3Qgb3JkZXIgew0KICAgICAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3RvciBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbnRyYWN0b3JBZGRyZXNzOw0KICAgICAgICAvLyBUaGUgaW5kZXggb2YgdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICAgICAgdWludCBjb250cmFjdG9yUHJvcG9zYWxJRDsNCiAgICAgICAgLy8gVGhlIGFtb3VudCBvZiB0aGUgb3JkZXINCiAgICAgICAgdWludCBhbW91bnQ7DQogICAgICAgIC8vIFRoZSBkYXRlIG9mIHRoZSBvcmRlcg0KICAgICAgICB1aW50IG9yZGVyRGF0ZTsNCiAgICB9DQogICAgLy8gVGhlIG9yZGVycyBvZiB0aGUgRGFvIGZvciB0aGlzIHByb2plY3QNCiAgICBvcmRlcltdIHB1YmxpYyBvcmRlcnM7DQogICAgDQogICAgLy8gVGhlIHRvdGFsIGFtb3VudCBvZiBvcmRlcnMgaW4gd2VpIGZvciB0aGlzIHByb2plY3QNCiAgICB1aW50IHB1YmxpYyB0b3RhbEFtb3VudE9mT3JkZXJzOw0KDQogICAgc3RydWN0IHJlc29sdXRpb24gew0KICAgICAgICAvLyBUaGUgbmFtZSBvZiB0aGUgcmVzb2x1dGlvbg0KICAgICAgICBzdHJpbmcgbmFtZTsNCiAgICAgICAgLy8gQSBkZXNjcmlwdGlvbiBvZiB0aGUgcmVzb2x1dGlvbg0KICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb247DQogICAgICAgIC8vIFRoZSBkYXRlIG9mIHRoZSByZXNvbHV0aW9uDQogICAgICAgIHVpbnQgY3JlYXRpb25EYXRlOw0KICAgIH0NCiAgICAvLyBSZXNvbHV0aW9ucyBvZiB0aGUgRGFvIGZvciB0aGlzIHByb2plY3QNCiAgICByZXNvbHV0aW9uW10gcHVibGljIHJlc29sdXRpb25zOw0KICAgIA0KLy8gRXZlbnRzDQoNCiAgICBldmVudCBPcmRlckFkZGVkKGFkZHJlc3MgaW5kZXhlZCBDbGllbnQsIGFkZHJlc3MgaW5kZXhlZCBDb250cmFjdG9yQWRkcmVzcywgdWludCBpbmRleGVkIENvbnRyYWN0b3JQcm9wb3NhbElELCB1aW50IEFtb3VudCwgdWludCBPcmRlckRhdGUpOw0KICAgIGV2ZW50IFByb2plY3REZXNjcmlwdGlvblVwZGF0ZWQoYWRkcmVzcyBpbmRleGVkIEJ5LCBzdHJpbmcgTmV3RGVzY3JpcHRpb24sIGJ5dGVzMzIgTmV3SGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgIGV2ZW50IFJlc29sdXRpb25BZGRlZChhZGRyZXNzIGluZGV4ZWQgQ2xpZW50LCB1aW50IGluZGV4ZWQgUmVzb2x1dGlvbklELCBzdHJpbmcgTmFtZSwgc3RyaW5nIERlc2NyaXB0aW9uKTsNCg0KLy8gQ29uc3RhbnQgZnVuY3Rpb25zICANCg0KICAgIC8vLyBAcmV0dXJuIHRoZSBhY3R1YWwgY29tbWl0dGVlIHJvb20gb2YgdGhlIERhbyAgIA0KICAgIGZ1bmN0aW9uIENsaWVudCgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIHBhc3NEYW8uQWN0dWFsQ29tbWl0dGVlUm9vbSgpOw0KICAgIH0NCiAgICANCiAgICAvLy8gQHJldHVybiBUaGUgbnVtYmVyIG9mIG9yZGVycyANCiAgICBmdW5jdGlvbiBudW1iZXJPZk9yZGVycygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIG9yZGVycy5sZW5ndGggLSAxOw0KICAgIH0NCiAgICANCiAgICAvLy8gQHJldHVybiBUaGUgcHJvamVjdCBNYW5hZ2VyIGFkZHJlc3MNCiAgICBmdW5jdGlvbiBQcm9qZWN0TWFuYWdlcigpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIHByb2plY3RNYW5hZ2VyOw0KICAgIH0NCg0KICAgIC8vLyBAcmV0dXJuIFRoZSBudW1iZXIgb2YgcmVzb2x1dGlvbnMgDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZSZXNvbHV0aW9ucygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIHJlc29sdXRpb25zLmxlbmd0aCAtIDE7DQogICAgfQ0KICAgIA0KLy8gbW9kaWZpZXJzDQoNCiAgICAvLyBNb2RpZmllciBmb3IgcHJvamVjdCBtYW5hZ2VyIGZ1bmN0aW9ucyANCiAgICBtb2RpZmllciBvbmx5UHJvamVjdE1hbmFnZXIge2lmIChtc2cuc2VuZGVyICE9IHByb2plY3RNYW5hZ2VyKSB0aHJvdzsgXzt9DQoNCiAgICAvLyBNb2RpZmllciBmb3IgdGhlIERhbyBmdW5jdGlvbnMgDQogICAgbW9kaWZpZXIgb25seUNsaWVudCB7aWYgKG1zZy5zZW5kZXIgIT0gQ2xpZW50KCkpIHRocm93OyBfO30NCg0KLy8gQ29uc3RydWN0b3IgZnVuY3Rpb24NCg0KICAgIGZ1bmN0aW9uIFBhc3NQcm9qZWN0KA0KICAgICAgICBQYXNzRGFvIF9wYXNzRGFvLCANCiAgICAgICAgc3RyaW5nIF9uYW1lLA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLA0KICAgICAgICBieXRlczMyIF9oYXNoT2ZUaGVEb2N1bWVudCkgew0KDQogICAgICAgIHBhc3NEYW8gPSBfcGFzc0RhbzsNCiAgICAgICAgbmFtZSA9IF9uYW1lOw0KICAgICAgICBkZXNjcmlwdGlvbiA9IF9kZXNjcmlwdGlvbjsNCiAgICAgICAgaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7DQogICAgICAgIA0KICAgICAgICBvcmRlcnMubGVuZ3RoID0gMTsNCiAgICAgICAgcmVzb2x1dGlvbnMubGVuZ3RoID0gMTsNCiAgICB9DQogICAgDQovLyBJbnRlcm5hbCBmdW5jdGlvbnMNCg0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIHJlZ2lzdGVyIGEgbmV3IG9yZGVyDQogICAgLy8vIEBwYXJhbSBfY29udHJhY3RvckFkZHJlc3MgVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0b3Igc21hcnQgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9jb250cmFjdG9yUHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCBpbiB3ZWkgb2YgdGhlIG9yZGVyDQogICAgLy8vIEBwYXJhbSBfb3JkZXJEYXRlIFRoZSBkYXRlIG9mIHRoZSBvcmRlciANCiAgICBmdW5jdGlvbiBhZGRPcmRlcigNCg0KICAgICAgICBhZGRyZXNzIF9jb250cmFjdG9yQWRkcmVzcywgDQogICAgICAgIHVpbnQgX2NvbnRyYWN0b3JQcm9wb3NhbElELCANCiAgICAgICAgdWludCBfYW1vdW50LCANCiAgICAgICAgdWludCBfb3JkZXJEYXRlKSBpbnRlcm5hbCB7DQoNCiAgICAgICAgdWludCBfb3JkZXJJRCA9IG9yZGVycy5sZW5ndGgrKzsNCiAgICAgICAgb3JkZXIgZCA9IG9yZGVyc1tfb3JkZXJJRF07DQogICAgICAgIGQuY29udHJhY3RvckFkZHJlc3MgPSBfY29udHJhY3RvckFkZHJlc3M7DQogICAgICAgIGQuY29udHJhY3RvclByb3Bvc2FsSUQgPSBfY29udHJhY3RvclByb3Bvc2FsSUQ7DQogICAgICAgIGQuYW1vdW50ID0gX2Ftb3VudDsNCiAgICAgICAgZC5vcmRlckRhdGUgPSBfb3JkZXJEYXRlOw0KICAgICAgICANCiAgICAgICAgdG90YWxBbW91bnRPZk9yZGVycyArPSBfYW1vdW50Ow0KICAgICAgICANCiAgICAgICAgT3JkZXJBZGRlZChtc2cuc2VuZGVyLCBfY29udHJhY3RvckFkZHJlc3MsIF9jb250cmFjdG9yUHJvcG9zYWxJRCwgX2Ftb3VudCwgX29yZGVyRGF0ZSk7DQogICAgfQ0KICAgIA0KLy8gU2V0dGluZyBmdW5jdGlvbnMNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGFsbG93IGNsb25pbmcgb3JkZXJzIGluIGNhc2Ugb2YgdXBncmFkZQ0KICAgIC8vLyBAcGFyYW0gX2NvbnRyYWN0b3JBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmFjdG9yIHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEBwYXJhbSBfY29udHJhY3RvclByb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfb3JkZXJBbW91bnQgVGhlIGFtb3VudCBpbiB3ZWkgb2YgdGhlIG9yZGVyDQogICAgLy8vIEBwYXJhbSBfbGFzdE9yZGVyRGF0ZSBUaGUgdW5peCBkYXRlIG9mIHRoZSBsYXN0IG9yZGVyIA0KICAgIGZ1bmN0aW9uIGNsb25lT3JkZXIoDQogICAgICAgIGFkZHJlc3MgX2NvbnRyYWN0b3JBZGRyZXNzLCANCiAgICAgICAgdWludCBfY29udHJhY3RvclByb3Bvc2FsSUQsIA0KICAgICAgICB1aW50IF9vcmRlckFtb3VudCwgDQogICAgICAgIHVpbnQgX2xhc3RPcmRlckRhdGUpIHsNCiAgICAgICAgDQogICAgICAgIGlmIChwcm9qZWN0TWFuYWdlciAhPSAwKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGFkZE9yZGVyKF9jb250cmFjdG9yQWRkcmVzcywgX2NvbnRyYWN0b3JQcm9wb3NhbElELCBfb3JkZXJBbW91bnQsIF9sYXN0T3JkZXJEYXRlKTsNCiAgICB9DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gc2V0IHRoZSBwcm9qZWN0IG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9wcm9qZWN0TWFuYWdlciBUaGUgYWRkcmVzcyBvZiB0aGUgcHJvamVjdCBtYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiBzdWNjZXNzZnVsDQogICAgZnVuY3Rpb24gc2V0UHJvamVjdE1hbmFnZXIoYWRkcmVzcyBfcHJvamVjdE1hbmFnZXIpIHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICBpZiAoX3Byb2plY3RNYW5hZ2VyID09IDAgfHwgcHJvamVjdE1hbmFnZXIgIT0gMCkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgcHJvamVjdE1hbmFnZXIgPSBfcHJvamVjdE1hbmFnZXI7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCi8vIFByb2plY3QgbWFuYWdlciBmdW5jdGlvbnMNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGFsbG93IHRoZSBwcm9qZWN0IG1hbmFnZXIgdXBkYXRpbmcgdGhlIGRlc2NyaXB0aW9uIG9mIHRoZSBwcm9qZWN0DQogICAgLy8vIEBwYXJhbSBfcHJvamVjdERlc2NyaXB0aW9uIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb2plY3QNCiAgICAvLy8gQHBhcmFtIF9oYXNoT2ZUaGVEb2N1bWVudCBUaGUgaGFzaCBvZiB0aGUgbGFzdCBkb2N1bWVudA0KICAgIGZ1bmN0aW9uIHVwZGF0ZURlc2NyaXB0aW9uKHN0cmluZyBfcHJvamVjdERlc2NyaXB0aW9uLCBieXRlczMyIF9oYXNoT2ZUaGVEb2N1bWVudCkgb25seVByb2plY3RNYW5hZ2VyIHsNCiAgICAgICAgZGVzY3JpcHRpb24gPSBfcHJvamVjdERlc2NyaXB0aW9uOw0KICAgICAgICBoYXNoT2ZUaGVEb2N1bWVudCA9IF9oYXNoT2ZUaGVEb2N1bWVudDsNCiAgICAgICAgUHJvamVjdERlc2NyaXB0aW9uVXBkYXRlZChtc2cuc2VuZGVyLCBfcHJvamVjdERlc2NyaXB0aW9uLCBfaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgIH0NCg0KLy8gQ2xpZW50IGZ1bmN0aW9ucw0KDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIERhbyB0byByZWdpc3RlciBhIG5ldyBvcmRlcg0KICAgIC8vLyBAcGFyYW0gX2NvbnRyYWN0b3JBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmFjdG9yIHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEBwYXJhbSBfY29udHJhY3RvclByb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgaW4gd2VpIG9mIHRoZSBvcmRlcg0KICAgIGZ1bmN0aW9uIG5ld09yZGVyKA0KICAgICAgICBhZGRyZXNzIF9jb250cmFjdG9yQWRkcmVzcywgDQogICAgICAgIHVpbnQgX2NvbnRyYWN0b3JQcm9wb3NhbElELCANCiAgICAgICAgdWludCBfYW1vdW50KSBvbmx5Q2xpZW50IHsNCiAgICAgICAgICAgIA0KICAgICAgICBhZGRPcmRlcihfY29udHJhY3RvckFkZHJlc3MsIF9jb250cmFjdG9yUHJvcG9zYWxJRCwgX2Ftb3VudCwgbm93KTsNCiAgICB9DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIERhbyB0byByZWdpc3RlciBhIG5ldyByZXNvbHV0aW9uDQogICAgLy8vIEBwYXJhbSBfbmFtZSBUaGUgbmFtZSBvZiB0aGUgcmVzb2x1dGlvbg0KICAgIC8vLyBAcGFyYW0gX2Rlc2NyaXB0aW9uIFRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgcmVzb2x1dGlvbg0KICAgIGZ1bmN0aW9uIG5ld1Jlc29sdXRpb24oDQogICAgICAgIHN0cmluZyBfbmFtZSwgDQogICAgICAgIHN0cmluZyBfZGVzY3JpcHRpb24pIG9ubHlDbGllbnQgew0KDQogICAgICAgIHVpbnQgX3Jlc29sdXRpb25JRCA9IHJlc29sdXRpb25zLmxlbmd0aCsrOw0KICAgICAgICByZXNvbHV0aW9uIGQgPSByZXNvbHV0aW9uc1tfcmVzb2x1dGlvbklEXTsNCiAgICAgICAgDQogICAgICAgIGQubmFtZSA9IF9uYW1lOw0KICAgICAgICBkLmRlc2NyaXB0aW9uID0gX2Rlc2NyaXB0aW9uOw0KICAgICAgICBkLmNyZWF0aW9uRGF0ZSA9IG5vdzsNCg0KICAgICAgICBSZXNvbHV0aW9uQWRkZWQobXNnLnNlbmRlciwgX3Jlc29sdXRpb25JRCwgZC5uYW1lLCBkLmRlc2NyaXB0aW9uKTsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IFBhc3NQcm9qZWN0Q3JlYXRvciB7DQogICAgDQogICAgZXZlbnQgTmV3UGFzc1Byb2plY3QoUGFzc0RhbyBpbmRleGVkIERhbywgUGFzc1Byb2plY3QgaW5kZXhlZCBQcm9qZWN0LCBzdHJpbmcgTmFtZSwgc3RyaW5nIERlc2NyaXB0aW9uLCBieXRlczMyIEhhc2hPZlRoZURvY3VtZW50KTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNyZWF0ZSBhIG5ldyBQYXNzIHByb2plY3QNCiAgICAvLy8gQHBhcmFtIF9wYXNzRGFvIFRoZSBQYXNzIERhbyBzbWFydCBjb250cmFjdA0KICAgIC8vLyBAcGFyYW0gX25hbWUgVGhlIHByb2plY3QgbmFtZQ0KICAgIC8vLyBAcGFyYW0gX2Rlc2NyaXB0aW9uIFRoZSBwcm9qZWN0IGRlc2NyaXB0aW9uIChub3QgbWFuZGF0b3J5LCBjYW4gYmUgdXBkYXRlZCBhZnRlciBieSB0aGUgY3JlYXRvcikNCiAgICAvLy8gQHBhcmFtIF9oYXNoT2ZUaGVEb2N1bWVudCBUaGUgSGFzaCBPZiB0aGUgcHJvamVjdCBEb2N1bWVudCAobm90IG1hbmRhdG9yeSwgY2FuIGJlIHVwZGF0ZWQgYWZ0ZXIgYnkgdGhlIGNyZWF0b3IpDQogICAgZnVuY3Rpb24gY3JlYXRlUHJvamVjdCgNCiAgICAgICAgUGFzc0RhbyBfcGFzc0RhbywNCiAgICAgICAgc3RyaW5nIF9uYW1lLCANCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwgDQogICAgICAgIGJ5dGVzMzIgX2hhc2hPZlRoZURvY3VtZW50DQogICAgICAgICkgcmV0dXJucyAoUGFzc1Byb2plY3QpIHsNCg0KICAgICAgICBQYXNzUHJvamVjdCBfcGFzc1Byb2plY3QgPSBuZXcgUGFzc1Byb2plY3QoX3Bhc3NEYW8sIF9uYW1lLCBfZGVzY3JpcHRpb24sIF9oYXNoT2ZUaGVEb2N1bWVudCk7DQoNCiAgICAgICAgTmV3UGFzc1Byb2plY3QoX3Bhc3NEYW8sIF9wYXNzUHJvamVjdCwgX25hbWUsIF9kZXNjcmlwdGlvbiwgX2hhc2hPZlRoZURvY3VtZW50KTsNCg0KICAgICAgICByZXR1cm4gX3Bhc3NQcm9qZWN0Ow0KICAgIH0NCn0NCiAgICANCg0KcHJhZ21hIHNvbGlkaXR5IF4wLjQuODsNCg0KLyoNCiAqDQogKiBUaGlzIGZpbGUgaXMgcGFydCBvZiBQYXNzIERBTy4NCiAqDQogKiBUaGUgUHJvamVjdCBzbWFydCBjb250cmFjdCBpcyB1c2VkIGZvciB0aGUgbWFuYWdlbWVudCBvZiB0aGUgUGFzcyBEYW8gcHJvamVjdHMuDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBDb250cmFjdG9yIHNtYXJ0IGNvbnRyYWN0IG9mIHRoZSBQYXNzIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbmlzYXRpb24NCmNvbnRyYWN0IFBhc3NDb250cmFjdG9yIHsNCiAgICANCiAgICAvLyBUaGUgcHJvamVjdCBzbWFydCBjb250cmFjdA0KICAgIFBhc3NQcm9qZWN0IHBhc3NQcm9qZWN0Ow0KICAgIA0KICAgIC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBjcmVhdG9yIG9mIHRoaXMgc21hcnQgY29udHJhY3QNCiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOw0KICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudDsNCiAgICBhZGRyZXNzIHB1YmxpYyByZWNpcGllbnQ7DQoNCiAgICAvLyBFbmQgZGF0ZSBvZiB0aGUgc2V0dXAgcHJvY2VkdXJlDQogICAgdWludCBwdWJsaWMgc21hcnRDb250cmFjdFN0YXJ0RGF0ZTsNCg0KICAgIHN0cnVjdCBwcm9wb3NhbCB7DQogICAgICAgIC8vIEFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAgICAgdWludCBhbW91bnQ7DQogICAgICAgIC8vIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb3Bvc2FsDQogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbjsNCiAgICAgICAgLy8gVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsJ3MgZG9jdW1lbnQNCiAgICAgICAgYnl0ZXMzMiBoYXNoT2ZUaGVEb2N1bWVudDsNCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGRhdGUgd2hlbiB0aGUgcHJvcG9zYWwgd2FzIGNyZWF0ZWQNCiAgICAgICAgdWludCBkYXRlT2ZQcm9wb3NhbDsNCiAgICAgICAgLy8gVGhlIGFtb3VudCBzdWJtaXR0ZWQgdG8gYSB2b3RlDQogICAgICAgIHVpbnQgc3VibWl0dGVkQW1vdW50Ow0KICAgICAgICAvLyBUaGUgc3VtIGFtb3VudCAoaW4gd2VpKSBvcmRlcmVkIGZvciB0aGlzIHByb3Bvc2FsIA0KICAgICAgICB1aW50IG9yZGVyQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgICAgIHVpbnQgZGF0ZU9mTGFzdE9yZGVyOw0KICAgIH0NCiAgICAvLyBQcm9wb3NhbHMgdG8gd29yayBmb3IgUGFzcyBEYW8NCiAgICBwcm9wb3NhbFtdIHB1YmxpYyBwcm9wb3NhbHM7DQoNCi8vIEV2ZW50cw0KDQogICAgZXZlbnQgUmVjaXBpZW50VXBkYXRlZChhZGRyZXNzIGluZGV4ZWQgQnksIGFkZHJlc3MgTGFzdFJlY2lwaWVudCwgYWRkcmVzcyBOZXdSZWNpcGllbnQpOw0KICAgIGV2ZW50IFdpdGhkcmF3YWwoYWRkcmVzcyBpbmRleGVkIEJ5LCBhZGRyZXNzIGluZGV4ZWQgUmVjaXBpZW50LCB1aW50IEFtb3VudCk7DQogICAgZXZlbnQgUHJvcG9zYWxBZGRlZChhZGRyZXNzIENyZWF0b3IsIHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IEFtb3VudCwgc3RyaW5nIERlc2NyaXB0aW9uLCBieXRlczMyIEhhc2hPZlRoZURvY3VtZW50KTsNCiAgICBldmVudCBQcm9wb3NhbFN1Ym1pdHRlZChhZGRyZXNzIGluZGV4ZWQgQ2xpZW50LCB1aW50IEFtb3VudCk7DQogICAgZXZlbnQgT3JkZXIoYWRkcmVzcyBpbmRleGVkIENsaWVudCwgdWludCBpbmRleGVkIFByb3Bvc2FsSUQsIHVpbnQgQW1vdW50KTsNCg0KLy8gQ29uc3RhbnQgZnVuY3Rpb25zDQoNCiAgICAvLy8gQHJldHVybiB0aGUgYWN0dWFsIGNvbW1pdHRlZSByb29tIG9mIHRoZSBEYW8NCiAgICBmdW5jdGlvbiBDbGllbnQoKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7DQogICAgICAgIHJldHVybiBwYXNzUHJvamVjdC5DbGllbnQoKTsNCiAgICB9DQoNCiAgICAvLy8gQHJldHVybiB0aGUgcHJvamVjdCBzbWFydCBjb250cmFjdA0KICAgIGZ1bmN0aW9uIFByb2plY3QoKSBjb25zdGFudCByZXR1cm5zIChQYXNzUHJvamVjdCkgew0KICAgICAgICByZXR1cm4gcGFzc1Byb2plY3Q7DQogICAgfQ0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNsaWVudCB0byBjaGVjayB0aGUgcHJvcG9zYWwgYmVmb3JlIHN1Ym1pdHRpbmcNCiAgICAvLy8gQHBhcmFtIF9zZW5kZXIgVGhlIGNyZWF0b3Igb2YgdGhlIERhbyBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIHByb3Bvc2FsIGNhbiBiZSBzdWJtaXR0ZWQNCiAgICBmdW5jdGlvbiBwcm9wb3NhbENoZWNrZWQoDQogICAgICAgIGFkZHJlc3MgX3NlbmRlciwNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCkgY29uc3RhbnQgZXh0ZXJuYWwgb25seUNsaWVudCByZXR1cm5zIChib29sKSB7DQogICAgICAgIGlmIChfc2VuZGVyICE9IHJlY2lwaWVudCAmJiBfc2VuZGVyICE9IGNyZWF0b3IpIHJldHVybjsNCiAgICAgICAgaWYgKF9hbW91bnQgPD0gcHJvcG9zYWxzW19wcm9wb3NhbElEXS5hbW91bnQgLSBwcm9wb3NhbHNbX3Byb3Bvc2FsSURdLnN1Ym1pdHRlZEFtb3VudCkgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBwcm9wb3NhbHMgICAgIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mUHJvcG9zYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gcHJvcG9zYWxzLmxlbmd0aCAtIDE7DQogICAgfQ0KDQoNCi8vIE1vZGlmaWVycw0KDQogICAgLy8gTW9kaWZpZXIgZm9yIGNvbnRyYWN0b3IgZnVuY3Rpb25zDQogICAgbW9kaWZpZXIgb25seUNvbnRyYWN0b3Ige2lmIChtc2cuc2VuZGVyICE9IHJlY2lwaWVudCkgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIGZvciBjbGllbnQgZnVuY3Rpb25zDQogICAgbW9kaWZpZXIgb25seUNsaWVudCB7aWYgKG1zZy5zZW5kZXIgIT0gQ2xpZW50KCkpIHRocm93OyBfO30NCg0KLy8gQ29uc3RydWN0b3IgZnVuY3Rpb24NCg0KICAgIGZ1bmN0aW9uIFBhc3NDb250cmFjdG9yKA0KICAgICAgICBhZGRyZXNzIF9jcmVhdG9yLCANCiAgICAgICAgUGFzc1Byb2plY3QgX3Bhc3NQcm9qZWN0LCANCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LA0KICAgICAgICBib29sIF9yZXN0b3JlKSB7IA0KDQogICAgICAgIGlmIChhZGRyZXNzKF9wYXNzUHJvamVjdCkgPT0gMCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBjcmVhdG9yID0gX2NyZWF0b3I7DQogICAgICAgIGlmIChfcmVjaXBpZW50ID09IDApIF9yZWNpcGllbnQgPSBfY3JlYXRvcjsNCiAgICAgICAgcmVjaXBpZW50ID0gX3JlY2lwaWVudDsNCiAgICAgICAgDQogICAgICAgIHBhc3NQcm9qZWN0ID0gX3Bhc3NQcm9qZWN0Ow0KICAgICAgICANCiAgICAgICAgaWYgKCFfcmVzdG9yZSkgc21hcnRDb250cmFjdFN0YXJ0RGF0ZSA9IG5vdzsNCg0KICAgICAgICBwcm9wb3NhbHMubGVuZ3RoID0gMTsNCiAgICB9DQoNCi8vIFNldHRpbmcgZnVuY3Rpb25zDQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBjbG9uZSBhIHByb3Bvc2FsIGZyb20gdGhlIGxhc3QgY29udHJhY3Rvcg0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBBbW91bnQgKGluIHdlaSkgb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfZGVzY3JpcHRpb24gQSBkZXNjcmlwdGlvbiBvZiB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9oYXNoT2ZUaGVEb2N1bWVudCBUaGUgaGFzaCBvZiB0aGUgcHJvcG9zYWwncyBkb2N1bWVudA0KICAgIC8vLyBAcGFyYW0gX2RhdGVPZlByb3Bvc2FsIEEgdW5peCB0aW1lc3RhbXAsIGRlbm90aW5nIHRoZSBkYXRlIHdoZW4gdGhlIHByb3Bvc2FsIHdhcyBjcmVhdGVkDQogICAgLy8vIEBwYXJhbSBfb3JkZXJBbW91bnQgVGhlIHN1bSBhbW91bnQgKGluIHdlaSkgb3JkZXJlZCBmb3IgdGhpcyBwcm9wb3NhbCANCiAgICAvLy8gQHBhcmFtIF9kYXRlT2ZPcmRlciBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfY2xvbmVPcmRlciBUcnVlIGlmIHRoZSBvcmRlciBoYXMgdG8gYmUgY2xvbmVkIGluIHRoZSBwcm9qZWN0IHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGNsb25lUHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwNCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQsDQogICAgICAgIHVpbnQgX2RhdGVPZlByb3Bvc2FsLA0KICAgICAgICB1aW50IF9vcmRlckFtb3VudCwNCiAgICAgICAgdWludCBfZGF0ZU9mT3JkZXIsDQogICAgICAgIGJvb2wgX2Nsb25lT3JkZXINCiAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICAgICAgDQogICAgICAgIGlmIChzbWFydENvbnRyYWN0U3RhcnREYXRlICE9IDAgfHwgcmVjaXBpZW50ID09IDANCiAgICAgICAgfHwgbXNnLnNlbmRlciAhPSBjcmVhdG9yKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQgPSBwcm9wb3NhbHMubGVuZ3RoKys7DQogICAgICAgIHByb3Bvc2FsIGMgPSBwcm9wb3NhbHNbX3Byb3Bvc2FsSURdOw0KDQogICAgICAgIGMuYW1vdW50ID0gX2Ftb3VudDsNCiAgICAgICAgYy5kZXNjcmlwdGlvbiA9IF9kZXNjcmlwdGlvbjsNCiAgICAgICAgYy5oYXNoT2ZUaGVEb2N1bWVudCA9IF9oYXNoT2ZUaGVEb2N1bWVudDsgDQogICAgICAgIGMuZGF0ZU9mUHJvcG9zYWwgPSBfZGF0ZU9mUHJvcG9zYWw7DQogICAgICAgIGMub3JkZXJBbW91bnQgPSBfb3JkZXJBbW91bnQ7DQogICAgICAgIGMuZGF0ZU9mTGFzdE9yZGVyID0gX2RhdGVPZk9yZGVyOw0KDQogICAgICAgIFByb3Bvc2FsQWRkZWQobXNnLnNlbmRlciwgX3Byb3Bvc2FsSUQsIF9hbW91bnQsIF9kZXNjcmlwdGlvbiwgX2hhc2hPZlRoZURvY3VtZW50KTsNCiAgICAgICAgDQogICAgICAgIGlmIChfY2xvbmVPcmRlcikgcGFzc1Byb2plY3QuY2xvbmVPcmRlcihhZGRyZXNzKHRoaXMpLCBfcHJvcG9zYWxJRCwgX29yZGVyQW1vdW50LCBfZGF0ZU9mT3JkZXIpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gY2xvc2UgdGhlIHNldHRpbmcgcHJvY2VkdXJlIGFuZCBzdGFydCB0byB1c2UgdGhpcyBzbWFydCBjb250cmFjdA0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgc3VjY2Vzc2Z1bA0KICAgIGZ1bmN0aW9uIGNsb3NlU2V0dXAoKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIA0KICAgICAgICBpZiAoc21hcnRDb250cmFjdFN0YXJ0RGF0ZSAhPSAwIA0KICAgICAgICAgICAgfHwgKG1zZy5zZW5kZXIgIT0gY3JlYXRvciAmJiBtc2cuc2VuZGVyICE9IENsaWVudCgpKSkgcmV0dXJuOw0KDQogICAgICAgIHNtYXJ0Q29udHJhY3RTdGFydERhdGUgPSBub3c7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIA0KLy8gQWNjb3VudCBNYW5hZ2VtZW50DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byB1cGRhdGUgdGhlIHJlY2lwZW50IGFkZHJlc3MNCiAgICAvLy8gQHBhcmFtIF9uZXdSZWNpcGllbnQgVGhlIGFkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogICAgZnVuY3Rpb24gdXBkYXRlUmVjaXBpZW50KGFkZHJlc3MgX25ld1JlY2lwaWVudCkgb25seUNvbnRyYWN0b3Igew0KDQogICAgICAgIGlmIChfbmV3UmVjaXBpZW50ID09IDApIHRocm93Ow0KDQogICAgICAgIFJlY2lwaWVudFVwZGF0ZWQobXNnLnNlbmRlciwgcmVjaXBpZW50LCBfbmV3UmVjaXBpZW50KTsNCiAgICAgICAgcmVjaXBpZW50ID0gX25ld1JlY2lwaWVudDsNCiAgICB9IA0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gcmVjZWl2ZSBwYXltZW50cw0KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgeyB9DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYWxsb3cgY29udHJhY3RvcnMgdG8gd2l0aGRyYXcgZXRoZXJzDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgdG8gd2l0aGRyYXcNCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIG9ubHlDb250cmFjdG9yIHsNCiAgICAgICAgaWYgKCFyZWNpcGllbnQuc2VuZChfYW1vdW50KSkgdGhyb3c7DQogICAgICAgIFdpdGhkcmF3YWwobXNnLnNlbmRlciwgcmVjaXBpZW50LCBfYW1vdW50KTsNCiAgICB9DQogICAgDQovLyBQcm9qZWN0IE1hbmFnZXIgRnVuY3Rpb25zICAgIA0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIHByb2plY3QgbWFuYWdlciB1cGRhdGluZyB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIHByb2plY3QNCiAgICAvLy8gQHBhcmFtIF9wcm9qZWN0RGVzY3JpcHRpb24gQSBkZXNjcmlwdGlvbiBvZiB0aGUgcHJvamVjdA0KICAgIC8vLyBAcGFyYW0gX2hhc2hPZlRoZURvY3VtZW50IFRoZSBoYXNoIG9mIHRoZSBsYXN0IGRvY3VtZW50DQogICAgZnVuY3Rpb24gdXBkYXRlUHJvamVjdERlc2NyaXB0aW9uKHN0cmluZyBfcHJvamVjdERlc2NyaXB0aW9uLCBieXRlczMyIF9oYXNoT2ZUaGVEb2N1bWVudCkgb25seUNvbnRyYWN0b3Igew0KICAgICAgICBwYXNzUHJvamVjdC51cGRhdGVEZXNjcmlwdGlvbihfcHJvamVjdERlc2NyaXB0aW9uLCBfaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgIH0NCiAgICANCi8vIE1hbmFnZW1lbnQgb2YgcHJvcG9zYWxzDQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBtYWtlIGEgcHJvcG9zYWwgdG8gd29yayBmb3IgdGhlIGNsaWVudA0KICAgIC8vLyBAcGFyYW0gX2NyZWF0b3IgVGhlIGFkZHJlc3Mgb2YgdGhlIGNyZWF0b3Igb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfZGVzY3JpcHRpb24gU3RyaW5nIGRlc2NyaWJpbmcgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfaGFzaE9mVGhlRG9jdW1lbnQgVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsIGRvY3VtZW50DQogICAgLy8vIEByZXR1cm4gVGhlIGluZGV4IG9mIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gbmV3UHJvcG9zYWwoDQogICAgICAgIGFkZHJlc3MgX2NyZWF0b3IsDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwgDQogICAgICAgIGJ5dGVzMzIgX2hhc2hPZlRoZURvY3VtZW50DQogICAgKSBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICBpZiAobXNnLnNlbmRlciA9PSBDbGllbnQoKSAmJiBfY3JlYXRvciAhPSByZWNpcGllbnQgJiYgX2NyZWF0b3IgIT0gY3JlYXRvcikgdGhyb3c7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IENsaWVudCgpICYmIG1zZy5zZW5kZXIgIT0gcmVjaXBpZW50ICYmIG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgdGhyb3c7DQoNCiAgICAgICAgaWYgKF9hbW91bnQgPT0gMCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICB1aW50IF9wcm9wb3NhbElEID0gcHJvcG9zYWxzLmxlbmd0aCsrOw0KICAgICAgICBwcm9wb3NhbCBjID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBjLmFtb3VudCA9IF9hbW91bnQ7DQogICAgICAgIGMuZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIGMuaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7IA0KICAgICAgICBjLmRhdGVPZlByb3Bvc2FsID0gbm93Ow0KICAgICAgICANCiAgICAgICAgUHJvcG9zYWxBZGRlZChtc2cuc2VuZGVyLCBfcHJvcG9zYWxJRCwgYy5hbW91bnQsIGMuZGVzY3JpcHRpb24sIGMuaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgIH0NCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjbGllbnQgdG8gaW5mb3IgYWJvdXQgdGhlIHN1Ym1pdHRlZCBhbW91bnQNCiAgICAvLy8gQHBhcmFtIF9zZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlciB3aG8gc3VibWl0cyB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgY29udHJhY3RvciBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IChpbiB3ZWkpIHN1Ym1pdHRlZA0KICAgIGZ1bmN0aW9uIHN1Ym1pdFByb3Bvc2FsKA0KICAgICAgICBhZGRyZXNzIF9zZW5kZXIsIA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELCANCiAgICAgICAgdWludCBfYW1vdW50KSBvbmx5Q2xpZW50IHsNCg0KICAgICAgICBpZiAoX3NlbmRlciAhPSByZWNpcGllbnQgJiYgX3NlbmRlciAhPSBjcmVhdG9yKSB0aHJvdzsgICAgDQogICAgICAgIHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF0uc3VibWl0dGVkQW1vdW50ICs9IF9hbW91bnQ7DQogICAgICAgIFByb3Bvc2FsU3VibWl0dGVkKG1zZy5zZW5kZXIsIF9hbW91bnQpOw0KICAgIH0NCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNsaWVudCB0byBvcmRlciBhY2NvcmRpbmcgdG8gdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgY29udHJhY3RvciBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX29yZGVyQW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIG9yZGVyDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgb3JkZXIgd2FzIG1hZGUgb3Igbm90DQogICAgZnVuY3Rpb24gb3JkZXIoDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX29yZGVyQW1vdW50DQogICAgKSBleHRlcm5hbCBvbmx5Q2xpZW50IHJldHVybnMgKGJvb2wpIHsNCiAgICANCiAgICAgICAgcHJvcG9zYWwgYyA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQogICAgICAgIA0KICAgICAgICB1aW50IF9zdW0gPSBjLm9yZGVyQW1vdW50ICsgX29yZGVyQW1vdW50Ow0KICAgICAgICBpZiAoX3N1bSA+IGMuYW1vdW50DQogICAgICAgICAgICB8fCBfc3VtIDwgYy5vcmRlckFtb3VudA0KICAgICAgICAgICAgfHwgX3N1bSA8IF9vcmRlckFtb3VudCkgcmV0dXJuOyANCg0KICAgICAgICBjLm9yZGVyQW1vdW50ID0gX3N1bTsNCiAgICAgICAgYy5kYXRlT2ZMYXN0T3JkZXIgPSBub3c7DQogICAgICAgIA0KICAgICAgICBPcmRlcihtc2cuc2VuZGVyLCBfcHJvcG9zYWxJRCwgX29yZGVyQW1vdW50KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICANCn0NCg0KY29udHJhY3QgUGFzc0NvbnRyYWN0b3JDcmVhdG9yIHsNCiAgICANCiAgICAvLyBBZGRyZXNzIG9mIHRoZSBwYXNzIERhbyBzbWFydCBjb250cmFjdA0KICAgIFBhc3NEYW8gcHVibGljIHBhc3NEYW87DQogICAgLy8gQWRkcmVzcyBvZiB0aGUgUGFzcyBQcm9qZWN0IGNyZWF0b3INCiAgICBQYXNzUHJvamVjdENyZWF0b3IgcHVibGljIHByb2plY3RDcmVhdG9yOw0KICAgIA0KICAgIHN0cnVjdCBjb250cmFjdG9yIHsNCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIGNyZWF0b3Igb2YgdGhlIGNvbnRyYWN0b3INCiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOw0KICAgICAgICAvLyBUaGUgY29udHJhY3RvciBzbWFydCBjb250cmFjdA0KICAgICAgICBQYXNzQ29udHJhY3RvciBjb250cmFjdG9yOw0KICAgICAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IGZvciB3aXRoZHJhd2Fscw0KICAgICAgICBhZGRyZXNzIHJlY2lwaWVudDsNCiAgICAgICAgLy8gVHJ1ZSBpZiBtZXRhIHByb2plY3QNCiAgICAgICAgYm9vbCBtZXRhUHJvamVjdDsNCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIGV4aXN0aW5nIHByb2plY3Qgc21hcnQgY29udHJhY3QNCiAgICAgICAgUGFzc1Byb2plY3QgcGFzc1Byb2plY3Q7DQogICAgICAgIC8vIFRoZSBuYW1lIG9mIHRoZSBwcm9qZWN0IChpZiB0aGUgcHJvamVjdCBzbWFydCBjb250cmFjdCBkb2Vzbid0IGV4aXN0KQ0KICAgICAgICBzdHJpbmcgcHJvamVjdE5hbWU7DQogICAgICAgIC8vIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb2plY3QgKGNhbiBiZSB1cGRhdGVkIGFmdGVyKQ0KICAgICAgICBzdHJpbmcgcHJvamVjdERlc2NyaXB0aW9uOw0KICAgICAgICAvLyBUaGUgdW5peCBjcmVhdGlvbiBkYXRlIG9mIHRoZSBjb250cmFjdG9yDQogICAgICAgIHVpbnQgY3JlYXRpb25EYXRlOw0KICAgIH0NCiAgICAvLyBjb250cmFjdG9ycyBjcmVhdGVkIHRvIHdvcmsgZm9yIFBhc3MgRGFvDQogICAgY29udHJhY3RvcltdIHB1YmxpYyBjb250cmFjdG9yczsNCiAgICANCiAgICBldmVudCBOZXdQYXNzQ29udHJhY3RvcihhZGRyZXNzIGluZGV4ZWQgQ3JlYXRvciwgYWRkcmVzcyBpbmRleGVkIFJlY2lwaWVudCwgUGFzc1Byb2plY3QgaW5kZXhlZCBQcm9qZWN0LCBQYXNzQ29udHJhY3RvciBDb250cmFjdG9yKTsNCg0KICAgIGZ1bmN0aW9uIFBhc3NDb250cmFjdG9yQ3JlYXRvcihQYXNzRGFvIF9wYXNzRGFvLCBQYXNzUHJvamVjdENyZWF0b3IgX3Byb2plY3RDcmVhdG9yKSB7DQogICAgICAgIHBhc3NEYW8gPSBfcGFzc0RhbzsNCiAgICAgICAgcHJvamVjdENyZWF0b3IgPSBfcHJvamVjdENyZWF0b3I7DQogICAgICAgIGNvbnRyYWN0b3JzLmxlbmd0aCA9IDA7DQogICAgfQ0KDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBjcmVhdGVkIGNvbnRyYWN0b3JzIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mQ29udHJhY3RvcnMoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBjb250cmFjdG9ycy5sZW5ndGg7DQogICAgfQ0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGNvbnRyYWN0b3Igc21hcnQgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9jcmVhdG9yIFRoZSBhZGRyZXNzIG9mIHRoZSBjcmVhdG9yIG9mIHRoZSBjb250cmFjdG9yDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQgZm9yIHdpdGhkcmF3YWxzDQogICAgLy8vIEBwYXJhbSBfbWV0YVByb2plY3QgVHJ1ZSBpZiBtZXRhIHByb2plY3QNCiAgICAvLy8gQHBhcmFtIF9wYXNzUHJvamVjdCBUaGUgYWRkcmVzcyBvZiB0aGUgZXhpc3RpbmcgcHJvamVjdCBzbWFydCBjb250cmFjdA0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3ROYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9qZWN0IChpZiB0aGUgcHJvamVjdCBzbWFydCBjb250cmFjdCBkb2Vzbid0IGV4aXN0KQ0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3REZXNjcmlwdGlvbiBBIGRlc2NyaXB0aW9uIG9mIHRoZSBwcm9qZWN0IChjYW4gYmUgdXBkYXRlZCBhZnRlcikNCiAgICAvLy8gQHBhcmFtIF9yZXN0b3JlIFRydWUgaWYgb3JkZXJzIG9yIHByb3Bvc2FscyBhcmUgdG8gYmUgY2xvbmVkIGZyb20gb3RoZXIgY29udHJhY3RzDQogICAgLy8vIEByZXR1cm4gVGhlIGFkZHJlc3Mgb2YgdGhlIGNyZWF0ZWQgY29udHJhY3RvciBzbWFydCBjb250cmFjdA0KICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRyYWN0b3IoDQogICAgICAgIGFkZHJlc3MgX2NyZWF0b3IsDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIGJvb2wgX21ldGFQcm9qZWN0LA0KICAgICAgICBQYXNzUHJvamVjdCBfcGFzc1Byb2plY3QsDQogICAgICAgIHN0cmluZyBfcHJvamVjdE5hbWUsIA0KICAgICAgICBzdHJpbmcgX3Byb2plY3REZXNjcmlwdGlvbiwNCiAgICAgICAgYm9vbCBfcmVzdG9yZSkgcmV0dXJucyAoUGFzc0NvbnRyYWN0b3IpIHsNCiANCiAgICAgICAgUGFzc1Byb2plY3QgX3Byb2plY3Q7DQoNCiAgICAgICAgaWYgKF9jcmVhdG9yID09IDApIF9jcmVhdG9yID0gbXNnLnNlbmRlcjsNCiAgICAgICAgDQogICAgICAgIGlmIChfbWV0YVByb2plY3QpIF9wcm9qZWN0ID0gUGFzc1Byb2plY3QocGFzc0Rhby5NZXRhUHJvamVjdCgpKTsNCiAgICAgICAgZWxzZSBpZiAoYWRkcmVzcyhfcGFzc1Byb2plY3QpID09IDApIA0KICAgICAgICAgICAgX3Byb2plY3QgPSBwcm9qZWN0Q3JlYXRvci5jcmVhdGVQcm9qZWN0KHBhc3NEYW8sIF9wcm9qZWN0TmFtZSwgX3Byb2plY3REZXNjcmlwdGlvbiwgMCk7DQogICAgICAgIGVsc2UgX3Byb2plY3QgPSBfcGFzc1Byb2plY3Q7DQoNCiAgICAgICAgUGFzc0NvbnRyYWN0b3IgX2NvbnRyYWN0b3IgPSBuZXcgUGFzc0NvbnRyYWN0b3IoX2NyZWF0b3IsIF9wcm9qZWN0LCBfcmVjaXBpZW50LCBfcmVzdG9yZSk7DQogICAgICAgIGlmICghX21ldGFQcm9qZWN0ICYmIGFkZHJlc3MoX3Bhc3NQcm9qZWN0KSA9PSAwICYmICFfcmVzdG9yZSkgX3Byb2plY3Quc2V0UHJvamVjdE1hbmFnZXIoYWRkcmVzcyhfY29udHJhY3RvcikpOw0KICAgICAgICANCiAgICAgICAgdWludCBfY29udHJhY3RvcklEID0gY29udHJhY3RvcnMubGVuZ3RoKys7DQogICAgICAgIGNvbnRyYWN0b3IgYyA9IGNvbnRyYWN0b3JzW19jb250cmFjdG9ySURdOw0KICAgICAgICBjLmNyZWF0b3IgPSBfY3JlYXRvcjsNCiAgICAgICAgYy5jb250cmFjdG9yID0gX2NvbnRyYWN0b3I7DQogICAgICAgIGMucmVjaXBpZW50ID0gX3JlY2lwaWVudDsNCiAgICAgICAgYy5tZXRhUHJvamVjdCA9IF9tZXRhUHJvamVjdDsNCiAgICAgICAgYy5wYXNzUHJvamVjdCA9IF9wYXNzUHJvamVjdDsNCiAgICAgICAgYy5wcm9qZWN0TmFtZSA9IF9wcm9qZWN0TmFtZTsNCiAgICAgICAgYy5wcm9qZWN0RGVzY3JpcHRpb24gPSBfcHJvamVjdERlc2NyaXB0aW9uOw0KICAgICAgICBjLmNyZWF0aW9uRGF0ZSA9IG5vdzsNCg0KICAgICAgICBOZXdQYXNzQ29udHJhY3RvcihfY3JlYXRvciwgX3JlY2lwaWVudCwgX3Byb2plY3QsIF9jb250cmFjdG9yKTsNCiANCiAgICAgICAgcmV0dXJuIF9jb250cmFjdG9yOw0KICAgIH0NCiAgICANCn0='