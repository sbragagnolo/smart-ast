base 64 content
base64passDao1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC42Ow0KDQovKg0KICoNCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFBhc3MgREFPLg0KICoNCiAqIFRoZSBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IGlzIHVzZWQgZm9yIHRoZSBtYW5hZ2VtZW50IG9mIGFjY291bnRzIGFuZCB0b2tlbnMuDQogKg0KICogUmVjaXBpZW50IGlzIDAgZm9yIHRoZSBEYW8gYWNjb3VudCBtYW5hZ2VyIGFuZCB0aGUgYWRkcmVzcyBvZg0KICogY29udHJhY3RvcidzIHJlY2lwaWVudCBmb3IgdGhlIGNvbnRyYWN0b3JzJ3MgbWFoYWdlcnMuDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IG9mIHRoZSBQYXNzIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbmlzYXRpb24NCmNvbnRyYWN0IFBhc3NNYW5hZ2VySW50ZXJmYWNlIHsNCg0KICAgIHN0cnVjdCBwcm9wb3NhbCB7DQogICAgICAgIC8vIEFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAgICAgdWludCBhbW91bnQ7DQogICAgICAgIC8vIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb3Bvc2FsDQogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbjsNCiAgICAgICAgLy8gVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsJ3MgZG9jdW1lbnQNCiAgICAgICAgYnl0ZXMzMiBoYXNoT2ZUaGVEb2N1bWVudDsNCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGRhdGUgd2hlbiB0aGUgcHJvcG9zYWwgd2FzIGNyZWF0ZWQNCiAgICAgICAgdWludCBkYXRlT2ZQcm9wb3NhbDsNCiAgICAgICAgLy8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IGFwcHJvdmVkIGNsaWVudCBwcm9wb3NhbA0KICAgICAgICB1aW50IGxhc3RDbGllbnRQcm9wb3NhbElEOw0KICAgICAgICAvLyBUaGUgc3VtIGFtb3VudCAoaW4gd2VpKSBvcmRlcmVkIGZvciB0aGlzIHByb3Bvc2FsIA0KICAgICAgICB1aW50IG9yZGVyQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgICAgIHVpbnQgZGF0ZU9mT3JkZXI7DQogICAgfQ0KICAgICAgICANCiAgICAvLyBQcm9wb3NhbHMgdG8gd29yayBmb3IgdGhlIGNsaWVudA0KICAgIHByb3Bvc2FsW10gcHVibGljIHByb3Bvc2FsczsNCg0KICAgIHN0cnVjdCBmdW5kaW5nRGF0YSB7DQogICAgICAgIC8vIFRydWUgaWYgcHVibGljIGZ1bmRpbmcgd2l0aG91dCBhIG1haW4gcGFydG5lcg0KICAgICAgICBib29sIHB1YmxpY0NyZWF0aW9uOyANCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgd2hpY2ggc2V0cyBwYXJ0bmVycyBhbmQgbWFuYWdlcyB0aGUgZnVuZGluZyBpbiBjYXNlIG9mIHByaXZhdGUgZnVuZGluZw0KICAgICAgICBhZGRyZXNzIG1haW5QYXJ0bmVyOw0KICAgICAgICAvLyBUaGUgbWF4aW11bSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBtYXhBbW91bnRUb0Z1bmQ7DQogICAgICAgIC8vIFRoZSBhY3R1YWwgZnVuZGVkIGFtb3VudCAoaW4gd2VpKQ0KICAgICAgICB1aW50IGZ1bmRlZEFtb3VudDsNCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIHN0YXJ0IHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBzdGFydFRpbWU7IA0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgY2xvc2luZyB0aW1lIG9mIHRoZSBmdW5kaW5nDQogICAgICAgIHVpbnQgY2xvc2luZ1RpbWU7ICANCiAgICAgICAgLy8gVGhlIHByaWNlIG11bHRpcGxpZXIgZm9yIGEgc2hhcmUgb3IgYSB0b2tlbiB3aXRob3V0IGNvbnNpZGVyaW5nIHRoZSBpbmZsYXRpb24gcmF0ZQ0KICAgICAgICB1aW50IGluaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIC8vIFJhdGUgcGVyIHllYXIgaW4gcGVyY2VudGFnZSBhcHBsaWVkIHRvIHRoZSBzaGFyZSBvciB0b2tlbiBwcmljZSANCiAgICAgICAgdWludCBpbmZsYXRpb25SYXRlOyANCiAgICAgICAgLy8gSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbA0KICAgICAgICB1aW50IHByb3Bvc2FsSUQ7DQogICAgfSANCiAgICANCiAgICAvLyBSdWxlcyBmb3IgdGhlIGFjdHVhbCBmdW5kaW5nIGFuZCB0aGUgY29udHJhY3RvciB0b2tlbiBwcmljZQ0KICAgIGZ1bmRpbmdEYXRhWzJdIHB1YmxpYyBGdW5kaW5nUnVsZXM7DQoNCiAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgbGFzdCBNYW5hZ2VyIGJlZm9yZSBjbG9uaW5nDQogICAgYWRkcmVzcyBwdWJsaWMgY2xvbmVkRnJvbTsNCg0KICAgIC8vIEFkZHJlc3Mgb2YgdGhlIGNyZWF0b3Igb2YgdGhlIHNtYXJ0IGNvbnRyYWN0DQogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsNCiAgICAvLyBBZGRyZXNzIG9mIHRoZSBEYW8gKGZvciB0aGUgRGFvIG1hbmFnZXIpDQogICAgYWRkcmVzcyBjbGllbnQ7DQogICAgLy8gQWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50Ow0KICAgIGFkZHJlc3MgcHVibGljIHJlY2lwaWVudDsNCiAgICAvLyBBZGRyZXNzIG9mIHRoZSBEYW8gbWFuYWdlciAoZm9yIGNvbnRyYWN0b3IgbWFuYWdlcnMpDQogICAgUGFzc01hbmFnZXIgcHVibGljIGRhb01hbmFnZXI7DQogICAgDQogICAgLy8gVGhlIHRva2VuIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgICAvLyBUaGUgdG9rZW4gc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCiAgICAvLyBUaGUgcXVhbnRpdHkgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsNCg0KICAgIC8vIEVuZCBkYXRlIG9mIHRoZSBzZXR1cCBwcm9jZWR1cmUNCiAgICB1aW50IHB1YmxpYyBzbWFydENvbnRyYWN0U3RhcnREYXRlOw0KICAgIC8vIFVuaXggZGF0ZSB3aGVuIHNoYXJlcyBhbmQgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcnJlZCBhZnRlciBjbG9uaW5nIChmb3IgdGhlIERhbyBtYW5hZ2VyKQ0KICAgIHVpbnQgY2xvc2luZ1RpbWVGb3JDbG9uaW5nOw0KICAgIA0KICAgIC8vIFRvdGFsIGFtb3VudCBvZiB0b2tlbnMNCiAgICB1aW50MjU2IHRvdGFsVG9rZW5TdXBwbHk7DQoNCiAgICAvLyBBcnJheSB3aXRoIGFsbCBiYWxhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgLy8gQXJyYXkgd2l0aCBhbGwgYWxsb3dhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIC8vIE1hcCBvZiB0aGUgcmVzdWx0IChpbiB3ZWkpIG9mIGZ1bmRpbmdzDQogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBmdW5kZWRBbW91bnQ7DQoNCiAgICAvLyBBcnJheSBvZiB0b2tlbiBvciBzaGFyZSBob2xkZXJzDQogICAgYWRkcmVzc1tdIGhvbGRlcnM7DQogICAgLy8gTWFwIHdpdGggdGhlIGluZGV4ZXMgb2YgdGhlIGhvbGRlcnMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBob2xkZXJJRDsNCg0KICAgIC8vIElmIHRydWUsIHRoZSBzaGFyZXMgb3IgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcmVkDQogICAgYm9vbCBwdWJsaWMgdHJhbnNmZXJhYmxlOw0KICAgIC8vIE1hcCBvZiBibG9ja2VkIERhbyBzaGFyZSBhY2NvdW50cy4gUG9pbnRzIHRvIHRoZSBkYXRlIHdoZW4gdGhlIHNoYXJlIGhvbGRlciBjYW4gdHJhbnNmZXIgc2hhcmVzDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgYmxvY2tlZERlYWRMaW5lOyANCg0KICAgIC8vIEByZXR1cm4gVGhlIGNsaWVudCBvZiB0aGlzIG1hbmFnZXINCiAgICBmdW5jdGlvbiBDbGllbnQoKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKTsNCiAgICANCiAgICAvLyBAcmV0dXJuIFRoZSB1bml4IGRhdGUgd2hlbiBzaGFyZXMgYW5kIHRva2VucyBjYW4gYmUgdHJhbnNmZXJyZWQgYWZ0ZXIgY2xvbmluZw0KICAgIGZ1bmN0aW9uIENsb3NpbmdUaW1lRm9yQ2xvbmluZygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBzdXBwbHkgb2Ygc2hhcmVzIG9yIHRva2VucyANCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOw0KDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB0aGUgYmFsYW5jZSB3aWxsIGJlIHJldHJpZXZlZA0KICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlDQogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCg0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcmV0dXJuIFF1YW50aXR5IG9mIHJlbWFpbmluZyB0b2tlbnMgb2YgX293bmVyIHRoYXQgX3NwZW5kZXIgaXMgYWxsb3dlZCB0byBzcGVuZA0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIERhbyBwcm9wb3NhbA0KICAgIC8vLyBAcmV0dXJuIFRoZSByZXN1bHQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICBmdW5jdGlvbiBGdW5kZWRBbW91bnQodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQHBhcmFtIF9zYWxlRGF0ZSBpbiBjYXNlIG9mIHByZXNhbGUsIHRoZSBkYXRlIG9mIHRoZSBwcmVzYWxlDQogICAgLy8vIEByZXR1cm4gdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIGRpdmlzb3IgY29uZGlkZXJpbmcgdGhlIHNhbGUgZGF0ZSBhbmQgdGhlIGluZmxhdGlvbiByYXRlDQogICAgZnVuY3Rpb24gcHJpY2VEaXZpc29yKHVpbnQgX3NhbGVEYXRlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHJldHVybiB0aGUgYWN0dWFsIHByaWNlIGRpdmlzb3Igb2YgYSBzaGFyZSBvciB0b2tlbg0KICAgIGZ1bmN0aW9uIGFjdHVhbFByaWNlRGl2aXNvcigpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEByZXR1cm4gVGhlIG1heGltYWwgYW1vdW50IGEgbWFpbiBwYXJ0bmVyIGNhbiBmdW5kIGF0IHRoaXMgbW9tZW50DQogICAgLy8vIEBwYXJhbSBfbWFpblBhcnRuZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIG1haW4gcGFybmVyDQogICAgZnVuY3Rpb24gZnVuZGluZ01heEFtb3VudChhZGRyZXNzIF9tYWluUGFydG5lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQogICAgDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBzaGFyZSBvciB0b2tlbiBob2xkZXJzIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mSG9sZGVycygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBwYXJhbSBfaW5kZXggVGhlIGluZGV4IG9mIHRoZSBob2xkZXINCiAgICAvLy8gQHJldHVybiB0aGUgYWRkcmVzcyBvZiB0aGUgYW4gaG9sZGVyDQogICAgZnVuY3Rpb24gSG9sZGVyQWRkcmVzcyh1aW50IF9pbmRleCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyk7DQoNCiAgICAvLy8gQHJldHVybiBUaGUgbnVtYmVyIG9mIERhbyBydWxlcyBwcm9wb3NhbHMgICAgIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mUHJvcG9zYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogICAgDQogICAgLy8vIEBkZXYgVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uDQogICAgLy8vIEBwYXJhbSBfY2xpZW50IFRoZSBhZGRyZXNzIG9mIHRoZSBEYW8NCiAgICAvLy8gQHBhcmFtIF9kYW9NYW5hZ2VyIFRoZSBhZGRyZXNzIG9mIHRoZSBEYW8gbWFuYWdlciAoZm9yIGNvbnRyYWN0b3IgbWFuYWdlcnMpDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQuIDAgZm9yIHRoZSBEYW8NCiAgICAvLy8gQHBhcmFtIF9jbG9uZWRGcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBsYXN0IE1hbmFnZXIgYmVmb3JlIGNsb25pbmcNCiAgICAvLy8gQHBhcmFtIF90b2tlbk5hbWUgVGhlIHRva2VuIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIC8vLyBAcGFyYW0gX3Rva2VuU3ltYm9sIFRoZSB0b2tlbiBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIC8vLyBAcGFyYW0gX3Rva2VuRGVjaW1hbHMgVGhlIHF1YW50aXR5IG9mIGRlY2ltYWxzIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcmFibGUgVHJ1ZSBpZiBhbGxvd3MgdGhlIHRyYW5zZmVyIG9mIHRva2Vucw0KICAgIC8vZnVuY3Rpb24gUGFzc01hbmFnZXIoDQogICAgLy8gICAgYWRkcmVzcyBfY2xpZW50LA0KICAgIC8vICAgIGFkZHJlc3MgX2Rhb01hbmFnZXIsDQogICAgLy8gICAgYWRkcmVzcyBfcmVjaXBpZW50LA0KICAgIC8vICAgIGFkZHJlc3MgX2Nsb25lZEZyb20sDQogICAgLy8gICAgc3RyaW5nIF90b2tlbk5hbWUsDQogICAgLy8gICAgc3RyaW5nIF90b2tlblN5bWJvbCwNCiAgICAvLyAgICB1aW50OCBfdG9rZW5EZWNpbWFscywNCiAgICAvLyAgICBib29sIF90cmFuc2ZlcmFibGUpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNsb25lIGEgcHJvcG9zYWwgZnJvbSBhbm90aGVyIG1hbmFnZXIgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgQW1vdW50IChpbiB3ZWkpIG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2Rlc2NyaXB0aW9uIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfaGFzaE9mVGhlRG9jdW1lbnQgVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsJ3MgZG9jdW1lbnQNCiAgICAvLy8gQHBhcmFtIF9kYXRlT2ZQcm9wb3NhbCBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSB3aGVuIHRoZSBwcm9wb3NhbCB3YXMgY3JlYXRlZA0KICAgIC8vLyBAcGFyYW0gX2xhc3RDbGllbnRQcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBhcHByb3ZlZCBjbGllbnQgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9vcmRlckFtb3VudCBUaGUgc3VtIGFtb3VudCAoaW4gd2VpKSBvcmRlcmVkIGZvciB0aGlzIHByb3Bvc2FsIA0KICAgIC8vLyBAcGFyYW0gX2RhdGVPZk9yZGVyIEEgdW5peCB0aW1lc3RhbXAsIGRlbm90aW5nIHRoZSBkYXRlIG9mIHRoZSBsYXN0IG9yZGVyIGZvciB0aGUgYXBwcm92ZWQgcHJvcG9zYWwNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgDQogICAgZnVuY3Rpb24gY2xvbmVQcm9wb3NhbCgNCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLA0KICAgICAgICBieXRlczMyIF9oYXNoT2ZUaGVEb2N1bWVudCwNCiAgICAgICAgdWludCBfZGF0ZU9mUHJvcG9zYWwsDQogICAgICAgIHVpbnQgX2xhc3RDbGllbnRQcm9wb3NhbElELA0KICAgICAgICB1aW50IF9vcmRlckFtb3VudCwNCiAgICAgICAgdWludCBfZGF0ZU9mT3JkZXIpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gY3JlYXRlIGluaXRpYWwgdG9rZW5zICAgIA0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgYmVuZWZpY2lhcnkgb2YgdGhlIGNyZWF0ZWQgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfcXVhbnRpdHkgVGhlIHF1YW50aXR5IG9mIHRva2VucyB0byBjcmVhdGUgICAgDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90ICAgICANCiAgICBmdW5jdGlvbiBpbml0aWFsVG9rZW5TdXBwbHkoDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX3F1YW50aXR5KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgICAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBjbG9uZSB0b2tlbnMgZnJvbSBhIG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBpbmRleCBvZiB0aGUgZmlyc3QgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IGhvbGRlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdCANCiAgICBmdW5jdGlvbiBjbG9uZVRva2VucygNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8pIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gY2xvc2UgdGhlIHNldHVwIHByb2NlZHVyZSBvZiB0aGlzIGNvbnRyYWN0DQogICAgZnVuY3Rpb24gY2xvc2VTZXR1cCgpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSByZWNpcGVudCBhZGRyZXNzDQogICAgLy8vIEBwYXJhbSBfbmV3UmVjaXBpZW50IFRoZSBhZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIGZ1bmN0aW9uIHVwZGF0ZVJlY2lwaWVudChhZGRyZXNzIF9uZXdSZWNpcGllbnQpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gcmVjZWl2ZSBwYXltZW50cyBvciBkZXBvc2l0cw0KICAgIGZ1bmN0aW9uICgpIHBheWFibGU7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYWxsb3cgY29udHJhY3RvcnMgdG8gd2l0aGRyYXcgZXRoZXJzDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgdG8gd2l0aGRyYXcNCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBjbGllbnQgYWRkcmVzcw0KICAgIGZ1bmN0aW9uIHVwZGF0ZUNsaWVudChhZGRyZXNzIF9uZXdDbGllbnQpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIG1ha2UgYSBwcm9wb3NhbCB0byB3b3JrIGZvciB0aGUgY2xpZW50DQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfZGVzY3JpcHRpb24gU3RyaW5nIGRlc2NyaWJpbmcgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfaGFzaE9mVGhlRG9jdW1lbnQgVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsIGRvY3VtZW50DQogICAgLy8vIEByZXR1cm4gVGhlIGluZGV4IG9mIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gbmV3UHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwgDQogICAgICAgIGJ5dGVzMzIgX2hhc2hPZlRoZURvY3VtZW50DQogICAgKSByZXR1cm5zICh1aW50KTsNCiAgICAgICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY2xpZW50IHRvIG9yZGVyIGFjY29yZGluZyB0byB0aGUgY29udHJhY3RvciBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2NsaWVudFByb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBsYXN0IGFwcHJvdmVkIGNsaWVudCBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIG9yZGVyDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgb3JkZXIgd2FzIG1hZGUgb3Igbm90DQogICAgZnVuY3Rpb24gb3JkZXIoDQogICAgICAgIHVpbnQgX2NsaWVudFByb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX2Ftb3VudA0KICAgICkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCkgOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNsaWVudCB0byBzZW5kIGV0aGVycyBmcm9tIHRoZSBEYW8gbWFuYWdlcg0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgYWRkcmVzcyB0byBzZW5kIHRvDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgdG8gc2VuZA0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIHNlbmRUbygNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50DQogICAgKSBleHRlcm5hbCByZXR1cm5zIChib29sKTsNCiAgICANCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgYSBuZXcgdG9rZW4gb3Igc2hhcmUgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBvciBzaGFyZSBob2xkZXINCiAgICBmdW5jdGlvbiBhZGRIb2xkZXIoYWRkcmVzcyBfaG9sZGVyKSBpbnRlcm5hbDsNCiAgICANCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjcmVhdGUgaW5pdGlhbCB0b2tlbnMgICAgDQogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBiZW5lZmljaWFyeSBvZiB0aGUgY3JlYXRlZCB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9xdWFudGl0eSBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIHRvIGNyZWF0ZQ0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdCANCiAgICBmdW5jdGlvbiBjcmVhdGVJbml0aWFsVG9rZW5zKGFkZHJlc3MgX2hvbGRlciwgdWludCBfcXVhbnRpdHkpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRoYXQgYWxsb3cgdGhlIGNvbnRyYWN0b3IgdG8gcHJvcG9zZSBhIHRva2VuIHByaWNlDQogICAgLy8vIEBwYXJhbSBfaW5pdGlhbFByaWNlTXVsdGlwbGllciBUaGUgaW5pdGlhbCBwcmljZSBtdWx0aXBsaWVyIG9mIGNvbnRyYWN0b3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfaW5mbGF0aW9uUmF0ZSBJZiAwLCB0aGUgY29udHJhY3RvciB0b2tlbiBwcmljZSBkb2Vzbid0IGNoYW5nZSBkdXJpbmcgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9jbG9zaW5nVGltZSBUaGUgaW5pdGlhbCBwcmljZSBhbmQgaW5mbGF0aW9uIHJhdGUgY2FuIGJlIGNoYW5nZWQgYWZ0ZXIgdGhpcyBkYXRlDQogICAgZnVuY3Rpb24gc2V0VG9rZW5QcmljZVByb3Bvc2FsKCAgICAgICAgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9pbmZsYXRpb25SYXRlLA0KICAgICAgICB1aW50IF9jbG9zaW5nVGltZQ0KICAgICk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBzZXQgYSBmdW5kaW5nLiBDYW4gYmUgcHJpdmF0ZSBvciBwdWJsaWMNCiAgICAvLy8gQHBhcmFtIF9tYWluUGFydG5lciBUaGUgYWRkcmVzcyBvZiB0aGUgc21hcnQgY29udHJhY3QgdG8gbWFuYWdlIGEgcHJpdmF0ZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfcHVibGljQ3JlYXRpb24gVHJ1ZSBpZiBwdWJsaWMgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2luaXRpYWxQcmljZU11bHRpcGxpZXIgUHJpY2UgbXVsdGlwbGllciB3aXRob3V0IGNvbnNpZGVyaW5nIGFueSBpbmZsYXRpb24gcmF0ZQ0KICAgIC8vLyBAcGFyYW0gX21heEFtb3VudFRvRnVuZCBUaGUgbWF4aW11bSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9taW51dGVzRnVuZGluZ1BlcmlvZCBQZXJpb2QgaW4gbWludXRlcyBvZiB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2luZmxhdGlvblJhdGUgSWYgMCwgdGhlIHRva2VuIHByaWNlIGRvZXNuJ3QgY2hhbmdlIGR1cmluZyB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbCAobm90IG1hbmRhdG9yeSkNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nUnVsZXMoDQogICAgICAgIGFkZHJlc3MgX21haW5QYXJ0bmVyLA0KICAgICAgICBib29sIF9wdWJsaWNDcmVhdGlvbiwgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9tYXhBbW91bnRUb0Z1bmQsIA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQNCiAgICApIGV4dGVybmFsOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIGZvciB0aGUgY3JlYXRpb24gb2Ygc2hhcmVzIG9yIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgcmVjaXBpZW50IGFkZHJlc3Mgb2Ygc2hhcmVzIG9yIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgZnVuZGVkIGFtb3VudCAoaW4gd2VpKQ0KICAgIC8vLyBAcGFyYW0gX3NhbGVEYXRlIEluIGNhc2Ugb2YgcHJlc2FsZSwgdGhlIGRhdGUgb2YgdGhlIHByZXNhbGUNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBjcmVhdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbigNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICB1aW50IF9zYWxlRGF0ZQ0KICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIG1haW4gcGFydG5lciB0byBzZXQgdGhlIHN0YXJ0IHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9zdGFydFRpbWUgVGhlIHVuaXggc3RhcnQgZGF0ZSBvZiB0aGUgZnVuZGluZyANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nU3RhcnRUaW1lKHVpbnQgX3N0YXJ0VGltZSkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBtYWluIHBhcnRuZXIgdG8gcmV3YXJkIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCBvZiBzaGFyZXMgb3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIFdlaSkgdG8gY2FsY3VsYXRlIHRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGNyZWF0ZQ0KICAgIC8vLyBAcGFyYW0gX2RhdGUgVGhlIHVuaXggZGF0ZSB0byBjb25zaWRlciBmb3IgdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIGNhbGN1bGF0aW9uDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogICAgZnVuY3Rpb24gcmV3YXJkVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfZGF0ZQ0KICAgICAgICApIGV4dGVybmFsOw0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gY2xvc2UgdGhlIGFjdHVhbCBmdW5kaW5nDQogICAgZnVuY3Rpb24gY2xvc2VGdW5kaW5nKCkgaW50ZXJuYWw7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgbWFpbiBwYXJ0bmVyIHRvIHNldCB0aGUgZnVuZGluZyBmdWVsZWQNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKCkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBhYmxlIHRoZSB0cmFuc2ZlciBvZiBEYW8gc2hhcmVzIG9yIGNvbnRyYWN0b3IgdG9rZW5zDQogICAgZnVuY3Rpb24gYWJsZVRyYW5zZmVyKCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBkaXNhYmxlIHRoZSB0cmFuc2ZlciBvZiBEYW8gc2hhcmVzDQogICAgLy8vIEBwYXJhbSBfY2xvc2luZ1RpbWUgRGF0ZSB3aGVuIHNoYXJlcyBvciB0b2tlbnMgY2FuIGJlIHRyYW5zZmVycmVkDQogICAgZnVuY3Rpb24gZGlzYWJsZVRyYW5zZmVyKHVpbnQgX2Nsb3NpbmdUaW1lKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNsaWVudCB0byBibG9jayB0aGUgdHJhbnNmZXIgb2Ygc2hhcmVzIGZyb20gYW5kIHRvIGEgc2hhcmUgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfc2hhcmVIb2xkZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIHNoYXJlIGhvbGRlcg0KICAgIC8vLyBAcGFyYW0gX2RlYWRMaW5lIFdoZW4gdGhlIGFjY291bnQgd2lsbCBiZSB1bmJsb2NrZWQNCiAgICBmdW5jdGlvbiBibG9ja1RyYW5zZmVyKGFkZHJlc3MgX3NoYXJlSG9sZGVyLCB1aW50IF9kZWFkTGluZSkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBidXkgRGFvIHNoYXJlcyBhY2NvcmRpbmcgdG8gdGhlIGZ1bmRpbmcgcnVsZXMgDQogICAgLy8vIHdpdGggYG1zZy5zZW5kZXJgIGFzIHRoZSBiZW5lZmljaWFyeQ0KICAgIGZ1bmN0aW9uIGJ1eVNoYXJlcygpIHBheWFibGU7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYnV5IERhbyBzaGFyZXMgYWNjb3JkaW5nIHRvIHRoZSBmdW5kaW5nIHJ1bGVzIA0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgYmVuZWZpY2lhcnkgb2YgdGhlIGNyZWF0ZWQgc2hhcmVzDQogICAgZnVuY3Rpb24gYnV5U2hhcmVzRm9yKGFkZHJlc3MgX3JlY2lwaWVudCkgcGF5YWJsZTsNCiAgICANCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9Gcm9tYA0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcg0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgcXVhbnRpdHkgb2Ygc2hhcmVzIG9yIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZA0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdCANCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21UbygNCiAgICAgICAgYWRkcmVzcyBfZnJvbSwNCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYA0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcg0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgcXVhbnRpdHkgb2Ygc2hhcmVzIG9yIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgNCiAgICAgICAgYWRkcmVzcyBfZnJvbSwgDQogICAgICAgIGFkZHJlc3MgX3RvLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUNCiAgICAgICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF9hbW91bnRgIHRva2VucyBvbiBpdHMgYmVoYWxmDQogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgZXZlbnQgRmVlc1JlY2VpdmVkKGFkZHJlc3MgaW5kZXhlZCBGcm9tLCB1aW50IEFtb3VudCk7DQogICAgZXZlbnQgQW1vdW50UmVjZWl2ZWQoYWRkcmVzcyBpbmRleGVkIEZyb20sIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBwYXltZW50UmVjZWl2ZWQoYWRkcmVzcyBpbmRleGVkIGRhb01hbmFnZXIsIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBQcm9wb3NhbENsb25lZCh1aW50IGluZGV4ZWQgTGFzdENsaWVudFByb3Bvc2FsSUQsIHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IEFtb3VudCwgc3RyaW5nIERlc2NyaXB0aW9uLCBieXRlczMyIEhhc2hPZlRoZURvY3VtZW50KTsNCiAgICBldmVudCBDbGllbnRVcGRhdGVkKGFkZHJlc3MgTGFzdENsaWVudCwgYWRkcmVzcyBOZXdDbGllbnQpOw0KICAgIGV2ZW50IFJlY2lwaWVudFVwZGF0ZWQoYWRkcmVzcyBMYXN0UmVjaXBpZW50LCBhZGRyZXNzIE5ld1JlY2lwaWVudCk7DQogICAgZXZlbnQgUHJvcG9zYWxBZGRlZCh1aW50IGluZGV4ZWQgUHJvcG9zYWxJRCwgdWludCBBbW91bnQsIHN0cmluZyBEZXNjcmlwdGlvbiwgYnl0ZXMzMiBIYXNoT2ZUaGVEb2N1bWVudCk7DQogICAgZXZlbnQgT3JkZXIodWludCBpbmRleGVkIGNsaWVudFByb3Bvc2FsSUQsIHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IEFtb3VudCk7DQogICAgZXZlbnQgV2l0aGRhd2FsKGFkZHJlc3MgaW5kZXhlZCBSZWNpcGllbnQsIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBUb2tlblByaWNlUHJvcG9zYWxTZXQodWludCBJbml0aWFsUHJpY2VNdWx0aXBsaWVyLCB1aW50IEluZmxhdGlvblJhdGUsIHVpbnQgQ2xvc2luZ1RpbWUpOw0KICAgIGV2ZW50IGhvbGRlckFkZGVkKHVpbnQgSW5kZXgsIGFkZHJlc3MgSG9sZGVyKTsNCiAgICBldmVudCBUb2tlbnNDcmVhdGVkKGFkZHJlc3MgaW5kZXhlZCBTZW5kZXIsIGFkZHJlc3MgaW5kZXhlZCBUb2tlbkhvbGRlciwgdWludCBRdWFudGl0eSk7DQogICAgZXZlbnQgRnVuZGluZ1J1bGVzU2V0KGFkZHJlc3MgaW5kZXhlZCBNYWluUGFydG5lciwgdWludCBpbmRleGVkIEZ1bmRpbmdQcm9wb3NhbElkLCB1aW50IGluZGV4ZWQgU3RhcnRUaW1lLCB1aW50IENsb3NpbmdUaW1lKTsNCiAgICBldmVudCBGdW5kaW5nRnVlbGVkKHVpbnQgaW5kZXhlZCBGdW5kaW5nUHJvcG9zYWxJRCwgdWludCBGdW5kZWRBbW91bnQpOw0KICAgIGV2ZW50IFRyYW5zZmVyQWJsZSgpOw0KICAgIGV2ZW50IFRyYW5zZmVyRGlzYWJsZSh1aW50IGNsb3NpbmdUaW1lKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIGluZGV4ZWQgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKTsNCg0KDQp9ICAgIA0KDQpjb250cmFjdCBQYXNzTWFuYWdlciBpcyBQYXNzTWFuYWdlckludGVyZmFjZSB7DQoNCi8vIENvbnN0YW50IGZ1bmN0aW9ucw0KDQogICAgZnVuY3Rpb24gQ2xpZW50KCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIHJldHVybiBjbGllbnQ7DQogICAgICAgIGVsc2UgcmV0dXJuIGRhb01hbmFnZXIuQ2xpZW50KCk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIENsb3NpbmdUaW1lRm9yQ2xvbmluZygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwKSByZXR1cm4gY2xvc2luZ1RpbWVGb3JDbG9uaW5nOw0KICAgICAgICBlbHNlIHJldHVybiBkYW9NYW5hZ2VyLkNsb3NpbmdUaW1lRm9yQ2xvbmluZygpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICAgICAgcmV0dXJuIHRvdGFsVG9rZW5TdXBwbHk7DQogICAgfQ0KDQogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIEZ1bmRlZEFtb3VudCh1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBmdW5kZWRBbW91bnRbX3Byb3Bvc2FsSURdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHByaWNlRGl2aXNvcih1aW50IF9zYWxlRGF0ZSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICB1aW50IF9kYXRlID0gX3NhbGVEYXRlOw0KICAgICAgICANCiAgICAgICAgaWYgKF9zYWxlRGF0ZSA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSkgX2RhdGUgPSBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWU7DQogICAgICAgIGlmIChfc2FsZURhdGUgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lKSBfZGF0ZSA9IEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWU7DQoNCiAgICAgICAgcmV0dXJuIDEwMCArIDEwMCpGdW5kaW5nUnVsZXNbMF0uaW5mbGF0aW9uUmF0ZSooX2RhdGUgLSBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lKS8oMTAwKjM2NSBkYXlzKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gYWN0dWFsUHJpY2VEaXZpc29yKCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gcHJpY2VEaXZpc29yKG5vdyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZnVuZGluZ01heEFtb3VudChhZGRyZXNzIF9tYWluUGFydG5lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICANCiAgICAgICAgaWYgKG5vdyA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgbm93IDwgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZQ0KICAgICAgICAgICAgfHwgX21haW5QYXJ0bmVyICE9IEZ1bmRpbmdSdWxlc1swXS5tYWluUGFydG5lcikgew0KICAgICAgICAgICAgcmV0dXJuIDA7ICAgDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRnVuZGluZ1J1bGVzWzBdLm1heEFtb3VudFRvRnVuZDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBudW1iZXJPZkhvbGRlcnMoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBob2xkZXJzLmxlbmd0aCAtIDE7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIEhvbGRlckFkZHJlc3ModWludCBfaW5kZXgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIGhvbGRlcnNbX2luZGV4XTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBudW1iZXJPZlByb3Bvc2FscygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIHByb3Bvc2Fscy5sZW5ndGggLSAxOw0KICAgIH0NCg0KLy8gTW9kaWZpZXJzDQoNCiAgICAvLyBNb2RpZmllciB0aGF0IGFsbG93cyBvbmx5IHRoZSBjbGllbnQgdG8gbWFuYWdlIHRoaXMgYWNjb3VudCBtYW5hZ2VyDQogICAgbW9kaWZpZXIgb25seUNsaWVudCB7aWYgKG1zZy5zZW5kZXIgIT0gQ2xpZW50KCkpIHRocm93OyBfO30NCiAgICANCiAgICAvLyBNb2RpZmllciB0aGF0IGFsbG93cyBvbmx5IHRoZSBtYWluIHBhcnRuZXIgdG8gbWFuYWdlIHRoZSBhY3R1YWwgZnVuZGluZw0KICAgIG1vZGlmaWVyIG9ubHlNYWluUGFydG5lciB7aWYgKG1zZy5zZW5kZXIgIT0gIEZ1bmRpbmdSdWxlc1swXS5tYWluUGFydG5lcikgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgdGhlIGNvbnRyYWN0b3IgcHJvcG9zZSBzZXQgdGhlIHRva2VuIHByaWNlIG9yIHdpdGhkcmF3DQogICAgbW9kaWZpZXIgb25seUNvbnRyYWN0b3Ige2lmIChyZWNpcGllbnQgPT0gMCB8fCAobXNnLnNlbmRlciAhPSByZWNpcGllbnQgJiYgbXNnLnNlbmRlciAhPSBjcmVhdG9yKSkgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIGZvciBEYW8gZnVuY3Rpb25zDQogICAgbW9kaWZpZXIgb25seURhbyB7aWYgKHJlY2lwaWVudCAhPSAwKSB0aHJvdzsgXzt9DQogICAgDQovLyBDb25zdHJ1Y3RvciBmdW5jdGlvbg0KDQogICAgZnVuY3Rpb24gUGFzc01hbmFnZXIoDQogICAgICAgIGFkZHJlc3MgX2NsaWVudCwNCiAgICAgICAgYWRkcmVzcyBfZGFvTWFuYWdlciwNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LA0KICAgICAgICBhZGRyZXNzIF9jbG9uZWRGcm9tLA0KICAgICAgICBzdHJpbmcgX3Rva2VuTmFtZSwNCiAgICAgICAgc3RyaW5nIF90b2tlblN5bWJvbCwNCiAgICAgICAgdWludDggX3Rva2VuRGVjaW1hbHMsDQogICAgICAgIGJvb2wgX3RyYW5zZmVyYWJsZQ0KICAgICkgew0KDQogICAgICAgIGlmICgoX3JlY2lwaWVudCA9PSAwICYmIF9jbGllbnQgPT0gMCkNCiAgICAgICAgICAgIHx8IF9jbGllbnQgPT0gX3JlY2lwaWVudCkgdGhyb3c7DQoNCiAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7IA0KICAgICAgICBjbGllbnQgPSBfY2xpZW50Ow0KICAgICAgICByZWNpcGllbnQgPSBfcmVjaXBpZW50Ow0KICAgICAgICANCiAgICAgICAgaWYgKF9yZWNpcGllbnQgIT0wKSBkYW9NYW5hZ2VyID0gUGFzc01hbmFnZXIoX2Rhb01hbmFnZXIpOw0KDQogICAgICAgIGNsb25lZEZyb20gPSBfY2xvbmVkRnJvbTsgICAgICAgICAgICANCiAgICAgICAgDQogICAgICAgIG5hbWUgPSBfdG9rZW5OYW1lOw0KICAgICAgICBzeW1ib2wgPSBfdG9rZW5TeW1ib2w7DQogICAgICAgIGRlY2ltYWxzID0gX3Rva2VuRGVjaW1hbHM7DQogICAgICAgICAgDQogICAgICAgIGlmIChfdHJhbnNmZXJhYmxlKSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSB0cnVlOw0KICAgICAgICAgICAgVHJhbnNmZXJBYmxlKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgIFRyYW5zZmVyRGlzYWJsZSgwKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGhvbGRlcnMubGVuZ3RoID0gMTsNCiAgICAgICAgcHJvcG9zYWxzLmxlbmd0aCA9IDE7DQogICAgICAgIA0KICAgIH0NCg0KLy8gU2V0dGluZyBmdW5jdGlvbnMNCg0KICAgIGZ1bmN0aW9uIGNsb25lUHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwNCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQsDQogICAgICAgIHVpbnQgX2RhdGVPZlByb3Bvc2FsLA0KICAgICAgICB1aW50IF9sYXN0Q2xpZW50UHJvcG9zYWxJRCwNCiAgICAgICAgdWludCBfb3JkZXJBbW91bnQsDQogICAgICAgIHVpbnQgX2RhdGVPZk9yZGVyDQogICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIA0KICAgICAgICBpZiAoc21hcnRDb250cmFjdFN0YXJ0RGF0ZSAhPSAwIHx8IHJlY2lwaWVudCA9PSAwDQogICAgICAgIHx8IG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgdGhyb3c7DQogICAgICAgIA0KICAgICAgICB1aW50IF9wcm9wb3NhbElEID0gcHJvcG9zYWxzLmxlbmd0aCsrOw0KICAgICAgICBwcm9wb3NhbCBjID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBjLmFtb3VudCA9IF9hbW91bnQ7DQogICAgICAgIGMuZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIGMuaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7IA0KICAgICAgICBjLmRhdGVPZlByb3Bvc2FsID0gX2RhdGVPZlByb3Bvc2FsOw0KICAgICAgICBjLmxhc3RDbGllbnRQcm9wb3NhbElEID0gX2xhc3RDbGllbnRQcm9wb3NhbElEOw0KICAgICAgICBjLm9yZGVyQW1vdW50ID0gX29yZGVyQW1vdW50Ow0KICAgICAgICBjLmRhdGVPZk9yZGVyID0gX2RhdGVPZk9yZGVyOw0KICAgICAgICANCiAgICAgICAgUHJvcG9zYWxDbG9uZWQoX2xhc3RDbGllbnRQcm9wb3NhbElELCBfcHJvcG9zYWxJRCwgYy5hbW91bnQsIGMuZGVzY3JpcHRpb24sIGMuaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpbml0aWFsVG9rZW5TdXBwbHkoDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX3F1YW50aXR5KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCg0KICAgICAgICBpZiAoc21hcnRDb250cmFjdFN0YXJ0RGF0ZSAhPSAwIHx8IG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBpZiAoX3JlY2lwaWVudCAhPSAwICYmIF9xdWFudGl0eSAhPSAwKSB7DQogICAgICAgICAgICByZXR1cm4gKGNyZWF0ZUluaXRpYWxUb2tlbnMoX3JlY2lwaWVudCwgX3F1YW50aXR5KSk7DQogICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsb25lVG9rZW5zKA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIA0KICAgICAgICBpZiAoc21hcnRDb250cmFjdFN0YXJ0RGF0ZSAhPSAwKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIFBhc3NNYW5hZ2VyIF9jbG9uZWRGcm9tID0gUGFzc01hbmFnZXIoY2xvbmVkRnJvbSk7DQogICAgICAgIA0KICAgICAgICBpZiAoX2Zyb20gPCAxIHx8IF90byA+IF9jbG9uZWRGcm9tLm51bWJlck9mSG9sZGVycygpKSB0aHJvdzsNCg0KICAgICAgICBhZGRyZXNzIF9ob2xkZXI7DQoNCiAgICAgICAgZm9yICh1aW50IGkgPSBfZnJvbTsgaSA8PSBfdG87IGkrKykgew0KICAgICAgICAgICAgX2hvbGRlciA9IF9jbG9uZWRGcm9tLkhvbGRlckFkZHJlc3MoaSk7DQogICAgICAgICAgICBpZiAoYmFsYW5jZXNbX2hvbGRlcl0gPT0gMCkgew0KICAgICAgICAgICAgICAgIGNyZWF0ZUluaXRpYWxUb2tlbnMoX2hvbGRlciwgX2Nsb25lZEZyb20uYmFsYW5jZU9mKF9ob2xkZXIpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbG9zZVNldHVwKCkgew0KICAgICAgICANCiAgICAgICAgaWYgKHNtYXJ0Q29udHJhY3RTdGFydERhdGUgIT0gMCB8fCBtc2cuc2VuZGVyICE9IGNyZWF0b3IpIHRocm93Ow0KDQogICAgICAgIHNtYXJ0Q29udHJhY3RTdGFydERhdGUgPSBub3c7DQoNCiAgICB9DQoNCi8vIEZ1bmN0aW9uIHRvIHJlY2VpdmUgcGF5bWVudHMgb3IgZGVwb3NpdHMNCg0KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgICAgICBBbW91bnRSZWNlaXZlZChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOw0KICAgIH0NCiAgICANCi8vIENvbnRyYWN0b3JzIEFjY291bnQgTWFuYWdlbWVudA0KDQogICAgZnVuY3Rpb24gdXBkYXRlUmVjaXBpZW50KGFkZHJlc3MgX25ld1JlY2lwaWVudCkgb25seUNvbnRyYWN0b3Igew0KDQogICAgICAgIGlmIChfbmV3UmVjaXBpZW50ID09IDAgDQogICAgICAgICAgICB8fCBfbmV3UmVjaXBpZW50ID09IGNsaWVudCkgdGhyb3c7DQoNCiAgICAgICAgUmVjaXBpZW50VXBkYXRlZChyZWNpcGllbnQsIF9uZXdSZWNpcGllbnQpOw0KICAgICAgICByZWNpcGllbnQgPSBfbmV3UmVjaXBpZW50Ow0KDQogICAgfSANCg0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgX2Ftb3VudCkgb25seUNvbnRyYWN0b3Igew0KICAgICAgICBpZiAoIXJlY2lwaWVudC5zZW5kKF9hbW91bnQpKSB0aHJvdzsNCiAgICAgICAgV2l0aGRhd2FsKHJlY2lwaWVudCwgX2Ftb3VudCk7DQogICAgfQ0KICAgIA0KLy8gREFPIFByb3Bvc2FscyBNYW5hZ2VtZW50DQoNCiAgICBmdW5jdGlvbiB1cGRhdGVDbGllbnQoYWRkcmVzcyBfbmV3Q2xpZW50KSBvbmx5Q2xpZW50IHsNCiAgICAgICAgDQogICAgICAgIGlmIChfbmV3Q2xpZW50ID09IDAgDQogICAgICAgICAgICB8fCBfbmV3Q2xpZW50ID09IHJlY2lwaWVudCkgdGhyb3c7DQoNCiAgICAgICAgQ2xpZW50VXBkYXRlZChjbGllbnQsIF9uZXdDbGllbnQpOw0KICAgICAgICBjbGllbnQgPSBfbmV3Q2xpZW50OyAgICAgICAgDQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBuZXdQcm9wb3NhbCgNCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLCANCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQNCiAgICApIG9ubHlDb250cmFjdG9yIHJldHVybnMgKHVpbnQpIHsNCg0KICAgICAgICB1aW50IF9wcm9wb3NhbElEID0gcHJvcG9zYWxzLmxlbmd0aCsrOw0KICAgICAgICBwcm9wb3NhbCBjID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBjLmFtb3VudCA9IF9hbW91bnQ7DQogICAgICAgIGMuZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIGMuaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7IA0KICAgICAgICBjLmRhdGVPZlByb3Bvc2FsID0gbm93Ow0KICAgICAgICANCiAgICAgICAgUHJvcG9zYWxBZGRlZChfcHJvcG9zYWxJRCwgYy5hbW91bnQsIGMuZGVzY3JpcHRpb24sIGMuaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gb3JkZXIoDQogICAgICAgIHVpbnQgX2NsaWVudFByb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX29yZGVyQW1vdW50DQogICAgKSBleHRlcm5hbCBvbmx5Q2xpZW50IHJldHVybnMgKGJvb2wpIHsNCiAgICANCiAgICAgICAgcHJvcG9zYWwgYyA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQogICAgICAgIA0KICAgICAgICB1aW50IF9zdW0gPSBjLm9yZGVyQW1vdW50ICsgX29yZGVyQW1vdW50Ow0KICAgICAgICBpZiAoX3N1bSA+IGMuYW1vdW50DQogICAgICAgICAgICB8fCBfc3VtIDwgYy5vcmRlckFtb3VudA0KICAgICAgICAgICAgfHwgX3N1bSA8IF9vcmRlckFtb3VudCkgcmV0dXJuOyANCg0KICAgICAgICBjLmxhc3RDbGllbnRQcm9wb3NhbElEID0gIF9jbGllbnRQcm9wb3NhbElEOw0KICAgICAgICBjLm9yZGVyQW1vdW50ID0gX3N1bTsNCiAgICAgICAgYy5kYXRlT2ZPcmRlciA9IG5vdzsNCiAgICAgICAgDQogICAgICAgIE9yZGVyKF9jbGllbnRQcm9wb3NhbElELCBfcHJvcG9zYWxJRCwgX29yZGVyQW1vdW50KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2VuZFRvKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsDQogICAgICAgIHVpbnQgX2Ftb3VudA0KICAgICkgZXh0ZXJuYWwgb25seUNsaWVudCBvbmx5RGFvIHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICBpZiAoX3JlY2lwaWVudC5zZW5kKF9hbW91bnQpKSByZXR1cm4gdHJ1ZTsNCiAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7DQoNCiAgICB9DQogICAgDQovLyBUb2tlbiBNYW5hZ2VtZW50DQogICAgDQogICAgZnVuY3Rpb24gYWRkSG9sZGVyKGFkZHJlc3MgX2hvbGRlcikgaW50ZXJuYWwgew0KICAgICAgICANCiAgICAgICAgaWYgKGhvbGRlcklEW19ob2xkZXJdID09IDApIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdWludCBfaG9sZGVySUQgPSBob2xkZXJzLmxlbmd0aCsrOw0KICAgICAgICAgICAgaG9sZGVyc1tfaG9sZGVySURdID0gX2hvbGRlcjsNCiAgICAgICAgICAgIGhvbGRlcklEW19ob2xkZXJdID0gX2hvbGRlcklEOw0KICAgICAgICAgICAgaG9sZGVyQWRkZWQoX2hvbGRlcklELCBfaG9sZGVyKTsNCg0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBjcmVhdGVJbml0aWFsVG9rZW5zKA0KICAgICAgICBhZGRyZXNzIF9ob2xkZXIsIA0KICAgICAgICB1aW50IF9xdWFudGl0eQ0KICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQoNCiAgICAgICAgaWYgKF9xdWFudGl0eSA+IDAgJiYgYmFsYW5jZXNbX2hvbGRlcl0gPT0gMCkgew0KICAgICAgICAgICAgYWRkSG9sZGVyKF9ob2xkZXIpOw0KICAgICAgICAgICAgYmFsYW5jZXNbX2hvbGRlcl0gPSBfcXVhbnRpdHk7IA0KICAgICAgICAgICAgdG90YWxUb2tlblN1cHBseSArPSBfcXVhbnRpdHk7DQogICAgICAgICAgICBUb2tlbnNDcmVhdGVkKG1zZy5zZW5kZXIsIF9ob2xkZXIsIF9xdWFudGl0eSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gc2V0VG9rZW5QcmljZVByb3Bvc2FsKCAgICAgICAgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9pbmZsYXRpb25SYXRlLA0KICAgICAgICB1aW50IF9jbG9zaW5nVGltZQ0KICAgICkgb25seUNvbnRyYWN0b3Igew0KICAgICAgICANCiAgICAgICAgaWYgKF9jbG9zaW5nVGltZSA8IG5vdyANCiAgICAgICAgICAgIHx8IG5vdyA8IEZ1bmRpbmdSdWxlc1sxXS5jbG9zaW5nVGltZSkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBGdW5kaW5nUnVsZXNbMV0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICBGdW5kaW5nUnVsZXNbMV0uaW5mbGF0aW9uUmF0ZSA9IF9pbmZsYXRpb25SYXRlOw0KICAgICAgICBGdW5kaW5nUnVsZXNbMV0uc3RhcnRUaW1lID0gbm93Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMV0uY2xvc2luZ1RpbWUgPSBfY2xvc2luZ1RpbWU7DQogICAgICAgIA0KICAgICAgICBUb2tlblByaWNlUHJvcG9zYWxTZXQoX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIF9pbmZsYXRpb25SYXRlLCBfY2xvc2luZ1RpbWUpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nUnVsZXMoDQogICAgICAgIGFkZHJlc3MgX21haW5QYXJ0bmVyLA0KICAgICAgICBib29sIF9wdWJsaWNDcmVhdGlvbiwgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsDQogICAgICAgIHVpbnQgX21heEFtb3VudFRvRnVuZCwgDQogICAgICAgIHVpbnQgX21pbnV0ZXNGdW5kaW5nUGVyaW9kLCANCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRA0KICAgICkgZXh0ZXJuYWwgb25seUNsaWVudCB7DQoNCiAgICAgICAgaWYgKG5vdyA8IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgX21haW5QYXJ0bmVyID09IGFkZHJlc3ModGhpcykNCiAgICAgICAgICAgIHx8IF9tYWluUGFydG5lciA9PSBjbGllbnQNCiAgICAgICAgICAgIHx8ICghX3B1YmxpY0NyZWF0aW9uICYmIF9tYWluUGFydG5lciA9PSAwKQ0KICAgICAgICAgICAgfHwgKF9wdWJsaWNDcmVhdGlvbiAmJiBfbWFpblBhcnRuZXIgIT0gMCkNCiAgICAgICAgICAgIHx8IChyZWNpcGllbnQgPT0gMCAmJiBfaW5pdGlhbFByaWNlTXVsdGlwbGllciA9PSAwKQ0KICAgICAgICAgICAgfHwgKHJlY2lwaWVudCAhPSAwIA0KICAgICAgICAgICAgICAgICYmIChGdW5kaW5nUnVsZXNbMV0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9PSAwDQogICAgICAgICAgICAgICAgICAgIHx8IF9pbmZsYXRpb25SYXRlIDwgRnVuZGluZ1J1bGVzWzFdLmluZmxhdGlvblJhdGUNCiAgICAgICAgICAgICAgICAgICAgfHwgbm93IDwgRnVuZGluZ1J1bGVzWzFdLnN0YXJ0VGltZQ0KICAgICAgICAgICAgICAgICAgICB8fCBGdW5kaW5nUnVsZXNbMV0uY2xvc2luZ1RpbWUgPCBub3cgKyAoX21pbnV0ZXNGdW5kaW5nUGVyaW9kICogMSBtaW51dGVzKSkpDQogICAgICAgICAgICB8fCBfbWF4QW1vdW50VG9GdW5kID09IDANCiAgICAgICAgICAgIHx8IF9taW51dGVzRnVuZGluZ1BlcmlvZCA9PSAwDQogICAgICAgICAgICApIHRocm93Ow0KDQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUgPSBub3c7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSA9IG5vdyArIF9taW51dGVzRnVuZGluZ1BlcmlvZCAqIDEgbWludXRlczsNCiAgICAgICAgICAgIA0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0ubWFpblBhcnRuZXIgPSBfbWFpblBhcnRuZXI7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5wdWJsaWNDcmVhdGlvbiA9IF9wdWJsaWNDcmVhdGlvbjsNCiAgICAgICAgDQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCkgRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBfaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgZWxzZSBGdW5kaW5nUnVsZXNbMF0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9IEZ1bmRpbmdSdWxlc1sxXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICANCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwKSBGdW5kaW5nUnVsZXNbMF0uaW5mbGF0aW9uUmF0ZSA9IF9pbmZsYXRpb25SYXRlOw0KICAgICAgICBlbHNlIEZ1bmRpbmdSdWxlc1swXS5pbmZsYXRpb25SYXRlID0gRnVuZGluZ1J1bGVzWzFdLmluZmxhdGlvblJhdGU7DQogICAgICAgIA0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uZnVuZGVkQW1vdW50ID0gMDsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLm1heEFtb3VudFRvRnVuZCA9IF9tYXhBbW91bnRUb0Z1bmQ7DQoNCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLnByb3Bvc2FsSUQgPSBfcHJvcG9zYWxJRDsNCg0KICAgICAgICBGdW5kaW5nUnVsZXNTZXQoX21haW5QYXJ0bmVyLCBfcHJvcG9zYWxJRCwgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZSwgRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lKTsNCiAgICAgICAgICAgIA0KICAgIH0gDQogICAgDQogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfc2FsZURhdGUNCiAgICApIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQogICAgICAgIGlmIChub3cgPiBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUNCiAgICAgICAgICAgIHx8IG5vdyA8IEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUNCiAgICAgICAgICAgIHx8X3NhbGVEYXRlID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lDQogICAgICAgICAgICB8fCBfc2FsZURhdGUgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lDQogICAgICAgICAgICB8fCBGdW5kaW5nUnVsZXNbMF0uZnVuZGVkQW1vdW50ICsgX2Ftb3VudCA+IEZ1bmRpbmdSdWxlc1swXS5tYXhBbW91bnRUb0Z1bmQpIHJldHVybjsNCg0KICAgICAgICB1aW50IF9hID0gX2Ftb3VudCpGdW5kaW5nUnVsZXNbMF0uaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgdWludCBfbXVsdGlwbGllciA9IDEwMCpfYTsNCiAgICAgICAgdWludCBfcXVhbnRpdHkgPSBfbXVsdGlwbGllci9wcmljZURpdmlzb3IoX3NhbGVEYXRlKTsNCiAgICAgICAgaWYgKF9hL19hbW91bnQgIT0gRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXINCiAgICAgICAgICAgIHx8IF9tdWx0aXBsaWVyLzEwMCAhPSBfYQ0KICAgICAgICAgICAgfHwgdG90YWxUb2tlblN1cHBseSArIF9xdWFudGl0eSA8PSB0b3RhbFRva2VuU3VwcGx5IA0KICAgICAgICAgICAgfHwgdG90YWxUb2tlblN1cHBseSArIF9xdWFudGl0eSA8PSBfcXVhbnRpdHkpIHJldHVybjsNCg0KICAgICAgICBhZGRIb2xkZXIoX3JlY2lwaWVudCk7DQogICAgICAgIGJhbGFuY2VzW19yZWNpcGllbnRdICs9IF9xdWFudGl0eTsNCiAgICAgICAgdG90YWxUb2tlblN1cHBseSArPSBfcXVhbnRpdHk7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQgKz0gX2Ftb3VudDsNCg0KICAgICAgICBUb2tlbnNDcmVhdGVkKG1zZy5zZW5kZXIsIF9yZWNpcGllbnQsIF9xdWFudGl0eSk7DQogICAgICAgIA0KICAgICAgICBpZiAoRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCA9PSBGdW5kaW5nUnVsZXNbMF0ubWF4QW1vdW50VG9GdW5kKSBjbG9zZUZ1bmRpbmcoKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1N0YXJ0VGltZSh1aW50IF9zdGFydFRpbWUpIGV4dGVybmFsIG9ubHlNYWluUGFydG5lciB7DQogICAgICAgIGlmIChub3cgPiBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcmV3YXJkVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfZGF0ZQ0KICAgICAgICApIGV4dGVybmFsIG9ubHlNYWluUGFydG5lciB7DQoNCiAgICAgICAgdWludCBfc2FsZURhdGU7DQogICAgICAgIGlmIChfZGF0ZSA9PSAwKSBfc2FsZURhdGUgPSBub3c7IGVsc2UgX3NhbGVEYXRlID0gX2RhdGU7DQoNCiAgICAgICAgaWYgKCFjcmVhdGVUb2tlbihfcmVjaXBpZW50LCBfYW1vdW50LCBfc2FsZURhdGUpKSB0aHJvdzsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsb3NlRnVuZGluZygpIGludGVybmFsIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwKSBmdW5kZWRBbW91bnRbRnVuZGluZ1J1bGVzWzBdLnByb3Bvc2FsSURdID0gRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudDsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lID0gbm93Ow0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKCkgZXh0ZXJuYWwgb25seU1haW5QYXJ0bmVyIHsNCiAgICAgICAgaWYgKG5vdyA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSkgdGhyb3c7DQogICAgICAgIGNsb3NlRnVuZGluZygpOw0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIEZ1bmRpbmdGdWVsZWQoRnVuZGluZ1J1bGVzWzBdLnByb3Bvc2FsSUQsIEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhYmxlVHJhbnNmZXIoKSBvbmx5Q2xpZW50IHsNCiAgICAgICAgaWYgKCF0cmFuc2ZlcmFibGUpIHsNCiAgICAgICAgICAgIHRyYW5zZmVyYWJsZSA9IHRydWU7DQogICAgICAgICAgICBjbG9zaW5nVGltZUZvckNsb25pbmcgPSAwOw0KICAgICAgICAgICAgVHJhbnNmZXJBYmxlKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkaXNhYmxlVHJhbnNmZXIodWludCBfY2xvc2luZ1RpbWUpIG9ubHlDbGllbnQgew0KICAgICAgICBpZiAodHJhbnNmZXJhYmxlICYmIF9jbG9zaW5nVGltZSA9PSAwKSB0cmFuc2ZlcmFibGUgPSBmYWxzZTsNCiAgICAgICAgZWxzZSBjbG9zaW5nVGltZUZvckNsb25pbmcgPSBfY2xvc2luZ1RpbWU7DQogICAgICAgICAgICANCiAgICAgICAgVHJhbnNmZXJEaXNhYmxlKF9jbG9zaW5nVGltZSk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNmZXIoYWRkcmVzcyBfc2hhcmVIb2xkZXIsIHVpbnQgX2RlYWRMaW5lKSBleHRlcm5hbCBvbmx5Q2xpZW50IG9ubHlEYW8gew0KICAgICAgICBpZiAoX2RlYWRMaW5lID4gYmxvY2tlZERlYWRMaW5lW19zaGFyZUhvbGRlcl0pIHsNCiAgICAgICAgICAgIGJsb2NrZWREZWFkTGluZVtfc2hhcmVIb2xkZXJdID0gX2RlYWRMaW5lOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGJ1eVNoYXJlcygpIHBheWFibGUgew0KICAgICAgICBidXlTaGFyZXNGb3IobXNnLnNlbmRlcik7DQogICAgfSANCiAgICANCiAgICBmdW5jdGlvbiBidXlTaGFyZXNGb3IoYWRkcmVzcyBfcmVjaXBpZW50KSBwYXlhYmxlIG9ubHlEYW8gew0KICAgICAgICANCiAgICAgICAgaWYgKCFGdW5kaW5nUnVsZXNbMF0ucHVibGljQ3JlYXRpb24gDQogICAgICAgICAgICB8fCAhY3JlYXRlVG9rZW4oX3JlY2lwaWVudCwgbXNnLnZhbHVlLCBub3cpKSB0aHJvdzsNCg0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb21UbygNCiAgICAgICAgYWRkcmVzcyBfZnJvbSwNCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyAgDQoNCiAgICAgICAgaWYgKCh0cmFuc2ZlcmFibGUgJiYgbm93ID4gQ2xvc2luZ1RpbWVGb3JDbG9uaW5nKCkpDQogICAgICAgICAgICAmJiBub3cgPiBibG9ja2VkRGVhZExpbmVbX2Zyb21dDQogICAgICAgICAgICAmJiBub3cgPiBibG9ja2VkRGVhZExpbmVbX3RvXQ0KICAgICAgICAgICAgJiYgX3RvICE9IGFkZHJlc3ModGhpcykNCiAgICAgICAgICAgICYmIGJhbGFuY2VzW19mcm9tXSA+PSBfdmFsdWUNCiAgICAgICAgICAgICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID49IF92YWx1ZQ0KICAgICAgICApIHsNCiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICBhZGRIb2xkZXIoX3RvKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7ICANCiAgICAgICAgaWYgKCF0cmFuc2ZlckZyb21Ubyhtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSkpIHRocm93Ow0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oDQogICAgICAgIGFkZHJlc3MgX2Zyb20sIA0KICAgICAgICBhZGRyZXNzIF90bywgDQogICAgICAgIHVpbnQyNTYgX3ZhbHVlDQogICAgICAgICkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7IA0KICAgICAgICANCiAgICAgICAgaWYgKGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIDwgX3ZhbHVlDQogICAgICAgICAgICB8fCAhdHJhbnNmZXJGcm9tVG8oX2Zyb20sIF90bywgX3ZhbHVlKSkgdGhyb3c7DQogICAgICAgICAgICANCiAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX3ZhbHVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICANCn0gICAgDQoNCnByYWdtYSBzb2xpZGl0eSBeMC40LjY7DQoNCi8qDQpUaGlzIGZpbGUgaXMgcGFydCBvZiBQYXNzIERBTy4NCg0KUGFzcyBEQU8gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgbGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQp0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCg0KUGFzcyBEQU8gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCmJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQpNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQpHTlUgbGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCg0KWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQphbG9uZyB3aXRoIFBhc3MgREFPLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KKi8NCg0KLyoNClNtYXJ0IGNvbnRyYWN0IGZvciBhIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbml6YXRpb24gKERBTykNCnRvIGF1dG9tYXRlIG9yZ2FuaXphdGlvbmFsIGdvdmVybmFuY2UgYW5kIGRlY2lzaW9uLW1ha2luZy4NCiovDQoNCi8vLyBAdGl0bGUgUGFzcyBEZWNlbnRyYWxpemVkIEF1dG9ub21vdXMgT3JnYW5pc2F0aW9uDQpjb250cmFjdCBQYXNzRGFvSW50ZXJmYWNlIHsNCg0KICAgIHN0cnVjdCBCb2FyZE1lZXRpbmcgeyAgICAgICAgDQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIGNyZWF0b3Igb2YgdGhlIGJvYXJkIG1lZXRpbmcgZm9yIGEgcHJvcG9zYWwNCiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOyAgDQogICAgICAgIC8vIEluZGV4IHRvIGlkZW50aWZ5IHRoZSBwcm9wb3NhbCB0byBwYXkgYSBjb250cmFjdG9yIG9yIGZ1bmQgdGhlIERhbw0KICAgICAgICB1aW50IHByb3Bvc2FsSUQ7DQogICAgICAgIC8vIEluZGV4IHRvIGlkZW50aWZ5IHRoZSBwcm9wb3NhbCB0byB1cGRhdGUgdGhlIERhbyBydWxlcyANCiAgICAgICAgdWludCBkYW9SdWxlc1Byb3Bvc2FsSUQ7IA0KICAgICAgICAvLyB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGVuZCBvZiB0aGUgc2V0IHBlcmlvZCBvZiBhIHByb3Bvc2FsIGJlZm9yZSB0aGUgYm9hcmQgbWVldGluZyANCiAgICAgICAgdWludCBzZXREZWFkbGluZTsNCiAgICAgICAgLy8gRmVlcyAoaW4gd2VpKSBwYWlkIGJ5IHRoZSBjcmVhdG9yIG9mIHRoZSBib2FyZCBtZWV0aW5nDQogICAgICAgIHVpbnQgZmVlczsNCiAgICAgICAgLy8gVG90YWwgb2YgZmVlcyAoaW4gd2VpKSByZXdhcmRlZCB0byB0aGUgdm90ZXJzIG9yIHRvIHRoZSBEYW8gYWNjb3VudCBtYW5hZ2VyIGZvciB0aGUgYmFsYW5jZQ0KICAgICAgICB1aW50IHRvdGFsUmV3YXJkZWRBbW91bnQ7DQogICAgICAgIC8vIEEgdW5peCB0aW1lc3RhbXAsIGRlbm90aW5nIHRoZSBlbmQgb2YgdGhlIHZvdGluZyBwZXJpb2QNCiAgICAgICAgdWludCB2b3RpbmdEZWFkbGluZTsNCiAgICAgICAgLy8gVHJ1ZSBpZiB0aGUgcHJvcG9zYWwncyB2b3RlcyBoYXZlIHlldCB0byBiZSBjb3VudGVkLCBvdGhlcndpc2UgRmFsc2UNCiAgICAgICAgYm9vbCBvcGVuOyANCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGRhdGUgb2YgdGhlIGV4ZWN1dGlvbiBvZiB0aGUgYXBwcm92ZWQgcHJvcG9zYWwNCiAgICAgICAgdWludCBkYXRlT2ZFeGVjdXRpb247DQogICAgICAgIC8vIE51bWJlciBvZiBzaGFyZXMgaW4gZmF2b3Igb2YgdGhlIHByb3Bvc2FsDQogICAgICAgIHVpbnQgeWVhOyANCiAgICAgICAgLy8gTnVtYmVyIG9mIHNoYXJlcyBvcHBvc2VkIHRvIHRoZSBwcm9wb3NhbA0KICAgICAgICB1aW50IG5heTsgDQogICAgICAgIC8vIG1hcHBpbmcgdG8gaW5kaWNhdGUgaWYgYSBzaGFyZWhvbGRlciBoYXMgdm90ZWQNCiAgICAgICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBoYXNWb3RlZDsgIA0KICAgIH0NCg0KICAgIHN0cnVjdCBDb250cmFjdG9yIHsNCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0b3IgbWFuYWdlciBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbnRyYWN0b3JNYW5hZ2VyOw0KICAgICAgICAvLyBUaGUgZGF0ZSBvZiB0aGUgZmlyc3Qgb3JkZXIgZm9yIHRoZSBjb250cmFjdG9yDQogICAgICAgIHVpbnQgY3JlYXRpb25EYXRlOw0KICAgIH0NCiAgICAgICAgDQogICAgc3RydWN0IFByb3Bvc2FsIHsNCiAgICAgICAgLy8gSW5kZXggdG8gaWRlbnRpZnkgdGhlIGJvYXJkIG1lZXRpbmcgb2YgdGhlIHByb3Bvc2FsDQogICAgICAgIHVpbnQgYm9hcmRNZWV0aW5nSUQ7DQogICAgICAgIC8vIFRoZSBjb250cmFjdG9yIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAgICAgUGFzc01hbmFnZXIgY29udHJhY3Rvck1hbmFnZXI7DQogICAgICAgIC8vIFRoZSBpbmRleCBvZiB0aGUgY29udHJhY3RvciBwcm9wb3NhbA0KICAgICAgICB1aW50IGNvbnRyYWN0b3JQcm9wb3NhbElEOw0KICAgICAgICAvLyBUaGUgYW1vdW50IChpbiB3ZWkpIG9mIHRoZSBwcm9wb3NhbA0KICAgICAgICB1aW50IGFtb3VudDsgDQogICAgICAgIC8vIFRydWUgaWYgdGhlIHByb3Bvc2FsIGZvcmVzZWVzIGEgY29udHJhY3RvciB0b2tlbiBjcmVhdGlvbg0KICAgICAgICBib29sIHRva2VuQ3JlYXRpb247DQogICAgICAgIC8vIFRydWUgaWYgcHVibGljIGZ1bmRpbmcgd2l0aG91dCBhIG1haW4gcGFydG5lcg0KICAgICAgICBib29sIHB1YmxpY1NoYXJlQ3JlYXRpb247IA0KICAgICAgICAvLyBUaGUgYWRkcmVzcyB3aGljaCBzZXRzIHBhcnRuZXJzIGFuZCBtYW5hZ2VzIHRoZSBmdW5kaW5nIGluIGNhc2Ugb2YgcHJpdmF0ZSBmdW5kaW5nDQogICAgICAgIGFkZHJlc3MgbWFpblBhcnRuZXI7DQogICAgICAgIC8vIFRoZSBpbml0aWFsIHByaWNlIG11bHRpcGxpZXIgb2YgRGFvIHNoYXJlcyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBmdW5kaW5nDQogICAgICAgIHVpbnQgaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyOyANCiAgICAgICAgLy8gVGhlIGluZmxhdGlvbiByYXRlIHRvIGNhbGN1bGF0ZSB0aGUgYWN0dWFsIGNvbnRyYWN0b3Igc2hhcmUgcHJpY2UNCiAgICAgICAgdWludCBpbmZsYXRpb25SYXRlOw0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgc3RhcnQgdGltZSBvZiB0aGUgZnVuZGluZw0KICAgICAgICB1aW50IG1pbnV0ZXNGdW5kaW5nUGVyaW9kOw0KICAgICAgICAvLyBUcnVlIGlmIHRoZSBwcm9wb3NhbCBpcyBjbG9zZWQNCiAgICAgICAgYm9vbCBvcGVuOyANCiAgICB9DQoNCiAgICBzdHJ1Y3QgUnVsZXMgew0KICAgICAgICAvLyBJbmRleCB0byBpZGVudGlmeSB0aGUgYm9hcmQgbWVldGluZyB0aGF0IGRlY2lkZXMgdG8gYXBwbHkgb3Igbm90IHRoZSBEYW8gcnVsZXMNCiAgICAgICAgdWludCBib2FyZE1lZXRpbmdJRDsgIA0KICAgICAgICAvLyBUaGUgcXVvcnVtIG5lZWRlZCBmb3IgZWFjaCBwcm9wb3NhbCBpcyBjYWxjdWxhdGVkIGJ5IHRvdGFsU3VwcGx5IC8gbWluUXVvcnVtRGl2aXNvcg0KICAgICAgICB1aW50IG1pblF1b3J1bURpdmlzb3I7ICANCiAgICAgICAgLy8gTWluaW11bSBmZWVzIChpbiB3ZWkpIHRvIGNyZWF0ZSBhIHByb3Bvc2FsDQogICAgICAgIHVpbnQgbWluQm9hcmRNZWV0aW5nRmVlczsgDQogICAgICAgIC8vIFBlcmlvZCBpbiBtaW51dGVzIHRvIGNvbnNpZGVyIG9yIHNldCBhIHByb3Bvc2FsIGJlZm9yZSB0aGUgdm90aW5nIHByb2NlZHVyZQ0KICAgICAgICB1aW50IG1pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZDsgDQogICAgICAgIC8vIFRoZSBtaW5pbXVtIGRlYmF0ZSBwZXJpb2QgaW4gbWludXRlcyB0aGF0IGEgZ2VuZXJpYyBwcm9wb3NhbCBjYW4gaGF2ZQ0KICAgICAgICB1aW50IG1pbk1pbnV0ZXNEZWJhdGVQZXJpb2Q7DQogICAgICAgIC8vIFRoZSBpbmZsYXRpb24gcmF0ZSB0byBjYWxjdWxhdGUgdGhlIHJld2FyZCBvZiBmZWVzIHRvIHZvdGVycyBkdXJpbmcgYSBib2FyZCBtZWV0aW5nIA0KICAgICAgICB1aW50IGZlZXNSZXdhcmRJbmZsYXRpb25SYXRlOw0KICAgICAgICAvLyBUcnVlIGlmIHRoZSBkYW8gcnVsZXMgYWxsb3cgdGhlIHRyYW5zZmVyIG9mIHNoYXJlcw0KICAgICAgICBib29sIHRyYW5zZmVyYWJsZTsNCiAgICAgICAgLy8gQWRkcmVzcyBvZiB0aGUgbmV3IERhbyBzbWFydCBjb250cmFjdCBhZnRlciBhbiB1cGdyYWRlDQogICAgICAgIGFkZHJlc3MgbmV3ZGFvOw0KICAgICAgICAvLyBUaGUgcGVyaW9kIGluIG1pbnV0ZXMgZm9yIHRoZSBjbG9uaW5nIHByb2NlZHVyZSBvZiBzaGFyZXMgYW5kIHRva2Vucw0KICAgICAgICB1aW50IG1pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nOw0KICAgIH0gDQogICAgDQogICAgLy8gVGhlIGNyZWF0b3Igb2YgdGhlIERhbw0KICAgIGFkZHJlc3MgcHVibGljIGNyZWF0b3I7DQogICAgLy8gVGhlIG5hbWUgb2YgdGhlIHByb2plY3QNCiAgICBzdHJpbmcgcHVibGljIHByb2plY3ROYW1lOw0KICAgIC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBsYXN0IERhbyBiZWZvcmUgdXBncmFkZSAobm90IG1hbmRhdG9yeSkNCiAgICBhZGRyZXNzIHB1YmxpYyBsYXN0RGFvOw0KICAgIC8vIEVuZCBkYXRlIG9mIHRoZSBzZXR1cCBwcm9jZWR1cmUNCiAgICB1aW50IHB1YmxpYyBzbWFydENvbnRyYWN0U3RhcnREYXRlOw0KICAgIC8vIFRoZSBEYW8gbWFuYWdlciBzbWFydCBjb250cmFjdA0KICAgIFBhc3NNYW5hZ2VyIHB1YmxpYyBkYW9NYW5hZ2VyOw0KICAgIC8vIFRoZSBtaW5pbXVtIHBlcmlvZHMgaW4gbWludXRlcyANCiAgICB1aW50IHB1YmxpYyBtaW5NaW51dGVzUGVyaW9kczsNCiAgICAvLyBUaGUgbWF4aW11bSBwZXJpb2QgaW4gbWludXRlcyBmb3IgcHJvcG9zYWxzIChzZXQrZGViYXRlKQ0KICAgIHVpbnQgcHVibGljIG1heE1pbnV0ZXNQcm9wb3NhbFBlcmlvZDsNCiAgICAvLyBUaGUgbWF4aW11bSBmdW5kaW5nIHBlcmlvZCBpbiBtaW51dGVzIGZvciBmdW5kaW5nIHByb3Bvc2Fscw0KICAgIHVpbnQgcHVibGljIG1heE1pbnV0ZXNGdW5kaW5nUGVyaW9kOw0KICAgIC8vIFRoZSBtYXhpbXVtIGluZmxhdGlvbiByYXRlIGZvciBzaGFyZSBwcmljZSBvciByZXdhcmRzIHRvIHZvdGVycw0KICAgIHVpbnQgcHVibGljIG1heEluZmxhdGlvblJhdGU7DQogICAgDQogICAgLy8gTWFwIHRvIGFsbG93IHRoZSBzaGFyZSBob2xkZXJzIHRvIHdpdGhkcmF3IGJvYXJkIG1lZXRpbmcgZmVlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcGVuZGluZ0ZlZXM7DQoNCiAgICAvLyBCb2FyZCBtZWV0aW5ncyB0byB2b3RlIGZvciBvciBhZ2FpbnN0IGEgcHJvcG9zYWwNCiAgICBCb2FyZE1lZXRpbmdbXSBwdWJsaWMgQm9hcmRNZWV0aW5nczsgDQogICAgLy8gQ29udHJhY3RvcnMgb2YgdGhlIERhbw0KICAgIENvbnRyYWN0b3JbXSBwdWJsaWMgQ29udHJhY3RvcnM7DQogICAgLy8gTWFwIHdpdGggdGhlIGluZGV4ZXMgb2YgdGhlIGNvbnRyYWN0b3JzDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBjb250cmFjdG9ySUQ7DQogICAgLy8gUHJvcG9zYWxzIHRvIHBheSBhIGNvbnRyYWN0b3Igb3IgZnVuZCB0aGUgRGFvDQogICAgUHJvcG9zYWxbXSBwdWJsaWMgUHJvcG9zYWxzOw0KICAgIC8vIFByb3Bvc2FscyB0byB1cGRhdGUgdGhlIERhbyBydWxlcw0KICAgIFJ1bGVzW10gcHVibGljIERhb1J1bGVzUHJvcG9zYWxzOw0KICAgIC8vIFRoZSBjdXJyZW50IERhbyBydWxlcw0KICAgIFJ1bGVzIHB1YmxpYyBEYW9SdWxlczsgDQogICAgDQogICAgLy8gRGF0ZSB3aGVuIHNoYXJlcyBhbmQgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcnJlZCBhZnRlciBjbG9uaW5nDQogICAgdWludCBwdWJsaWMgY2xvc2luZ1RpbWVGb3JDbG9uaW5nOw0KICAgIA0KICAgIC8vLyBAZGV2IFRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbg0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3ROYW1lIFRoZSBuYW1lIG9mIHRoZSBEYW8NCiAgICAvLy8gQHBhcmFtIF9sYXN0RGFvIFRoZSBhZGRyZXNzIG9mIHRoZSBsYXN0IERhbyBiZWZvcmUgdXBncmFkZSAobm90IG1hbmRhdG9yeSkNCiAgICAvL2Z1bmN0aW9uIFBhc3NEYW8oDQogICAgLy8gICAgc3RyaW5nIF9wcm9qZWN0TmFtZSwNCiAgICAvLyAgICBhZGRyZXNzIF9sYXN0RGFvKTsNCiAgICANCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgYSBuZXcgY29udHJhY3Rvcg0KICAgIC8vLyBAcGFyYW0gX2NvbnRyYWN0b3JNYW5hZ2VyIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cmFjdG9yIG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9jcmVhdGlvbkRhdGUgVGhlIGRhdGUgb2YgdGhlIGZpcnN0IG9yZGVyDQogICAgZnVuY3Rpb24gYWRkQ29udHJhY3RvcihhZGRyZXNzIF9jb250cmFjdG9yTWFuYWdlciwgdWludCBfY3JlYXRpb25EYXRlKSBpbnRlcm5hbDsNCg0KICAgIC8vLyBAZGV2IEZ1bmN0aW9uIHRvIGNsb25lIGEgY29udHJhY3RvciBmcm9tIHRoZSBsYXN0IERhbyBpbiBjYXNlIG9mIHVwZ3JhZGUgDQogICAgLy8vIEBwYXJhbSBfY29udHJhY3Rvck1hbmFnZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0b3IgbWFuYWdlcg0KICAgIC8vLyBAcGFyYW0gX2NyZWF0aW9uRGF0ZSBUaGUgZGF0ZSBvZiB0aGUgZmlyc3Qgb3JkZXINCiAgICBmdW5jdGlvbiBjbG9uZUNvbnRyYWN0b3IoYWRkcmVzcyBfY29udHJhY3Rvck1hbmFnZXIsIHVpbnQgX2NyZWF0aW9uRGF0ZSk7DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gaW5pdGlhbGl6ZSB0aGUgRGFvDQogICAgLy8vIEBwYXJhbSBfZGFvTWFuYWdlciBBZGRyZXNzIG9mIHRoZSBEYW8gbWFuYWdlciBzbWFydCBjb250cmFjdA0KICAgIC8vLyBAcGFyYW0gX21heEluZmxhdGlvblJhdGUgVGhlIG1heGltdW0gaW5mbGF0aW9uIHJhdGUgZm9yIGNvbnRyYWN0b3IgYW5kIGZ1bmRpbmcgcHJvcG9zYWxzDQogICAgLy8vIEBwYXJhbSBfbWluTWludXRlc1BlcmlvZHMgVGhlIG1pbmltdW0gcGVyaW9kcyBpbiBtaW51dGVzDQogICAgLy8vIEBwYXJhbSBfbWF4TWludXRlc0Z1bmRpbmdQZXJpb2QgVGhlIG1heGltdW0gZnVuZGluZyBwZXJpb2QgaW4gbWludXRlcyBmb3IgZnVuZGluZyBwcm9wb3NhbHMNCiAgICAvLy8gQHBhcmFtIF9tYXhNaW51dGVzUHJvcG9zYWxQZXJpb2QgVGhlIG1heGltdW0gcGVyaW9kIGluIG1pbnV0ZXMgZm9yIHByb3Bvc2FscyAoc2V0K2RlYmF0ZSkNCiAgICAvLy8gQHBhcmFtIF9taW5RdW9ydW1EaXZpc29yIFRoZSBpbml0aWFsIG1pbmltdW0gcXVvcnVtIGRpdmlzb3IgZm9yIHRoZSBwcm9wb3NhbHMNCiAgICAvLy8gQHBhcmFtIF9taW5Cb2FyZE1lZXRpbmdGZWVzIFRoZSBhbW91bnQgKGluIHdlaSkgdG8gbWFrZSBhIHByb3Bvc2FsIGFuZCBhc2sgZm9yIGEgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcGFyYW0gX21pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCBUaGUgbWluaW11bSBwZXJpb2QgaW4gbWludXRlcyBiZWZvcmUgYSBib2FyZCBtZWV0aW5nDQogICAgLy8vIEBwYXJhbSBfbWluTWludXRlc0RlYmF0ZVBlcmlvZCBUaGUgbWluaW11bSBwZXJpb2QgaW4gbWludXRlcyBvZiB0aGUgYm9hcmQgbWVldGluZ3MNCiAgICAvLy8gQHBhcmFtIF9mZWVzUmV3YXJkSW5mbGF0aW9uUmF0ZSBUaGUgaW5mbGF0aW9uIHJhdGUgdG8gY2FsY3VsYXRlIHRoZSByZXdhcmQgb2YgZmVlcyB0byB2b3RlcnMgZHVyaW5nIGEgYm9hcmQgbWVldGluZw0KICAgIGZ1bmN0aW9uIGluaXREYW8oDQogICAgICAgIGFkZHJlc3MgX2Rhb01hbmFnZXIsDQogICAgICAgIHVpbnQgX21heEluZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX21pbk1pbnV0ZXNQZXJpb2RzLA0KICAgICAgICB1aW50IF9tYXhNaW51dGVzRnVuZGluZ1BlcmlvZCwNCiAgICAgICAgdWludCBfbWF4TWludXRlc1Byb3Bvc2FsUGVyaW9kLA0KICAgICAgICB1aW50IF9taW5RdW9ydW1EaXZpc29yLA0KICAgICAgICB1aW50IF9taW5Cb2FyZE1lZXRpbmdGZWVzLA0KICAgICAgICB1aW50IF9taW51dGVzU2V0UHJvcG9zYWxQZXJpb2QsDQogICAgICAgIHVpbnQgX21pbk1pbnV0ZXNEZWJhdGVQZXJpb2QsDQogICAgICAgIHVpbnQgX2ZlZXNSZXdhcmRJbmZsYXRpb25SYXRlDQogICAgICAgICk7DQogICAgICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGJvYXJkIG1lZXRpbmcNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgcHJvcG9zYWwgaWYgZm9yIGEgY29udHJhY3RvciBvciBmb3IgYSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfZGFvUnVsZXNQcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgcHJvcG9zYWwgaWYgRGFvIHJ1bGVzDQogICAgLy8vIEBwYXJhbSBfbWludXRlc0RlYmF0aW5nUGVyaW9kIFRoZSBkdXJhdGlvbiBpbiBtaW51dGVzIG9mIHRoZSBtZWV0aW5nDQogICAgLy8vIEByZXR1cm4gdGhlIGluZGV4IG9mIHRoZSBib2FyZCBtZWV0aW5nDQogICAgZnVuY3Rpb24gbmV3Qm9hcmRNZWV0aW5nKA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELCANCiAgICAgICAgdWludCBfZGFvUnVsZXNQcm9wb3NhbElELCANCiAgICAgICAgdWludCBfbWludXRlc0RlYmF0aW5nUGVyaW9kDQogICAgKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBtYWtlIGEgcHJvcG9zYWwgdG8gcGF5IGEgY29udHJhY3RvciBvciBmdW5kIHRoZSBEYW8NCiAgICAvLy8gQHBhcmFtIF9jb250cmFjdG9yTWFuYWdlciBBZGRyZXNzIG9mIHRoZSBjb250cmFjdG9yIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9jb250cmFjdG9yUHJvcG9zYWxJRCBJbmRleCBvZiB0aGUgY29udHJhY3RvciBwcm9wb3NhbCBvZiB0aGUgY29udHJhY3RvciBtYW5hZ2VyDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfdG9rZW5DcmVhdGlvbiBUcnVlIGlmIHRoZSBwcm9wb3NhbCBmb3Jlc2VlcyBhIGNvbnRyYWN0b3IgdG9rZW4gY3JlYXRpb24NCiAgICAvLy8gQHBhcmFtIF9wdWJsaWNTaGFyZUNyZWF0aW9uIFRydWUgaWYgcHVibGljIGZ1bmRpbmcgd2l0aG91dCBhIG1haW4gcGFydG5lcg0KICAgIC8vLyBAcGFyYW0gX21haW5QYXJ0bmVyIFRoZSBhZGRyZXNzIHdoaWNoIHNldHMgcGFydG5lcnMgYW5kIG1hbmFnZSB0aGUgZnVuZGluZyANCiAgICAvLy8gaW4gY2FzZSBvZiBwcml2YXRlIGZ1bmRpbmcgKG5vdCBtYW5kYXRvcnkpDQogICAgLy8vIEBwYXJhbSBfaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyIFRoZSBpbml0aWFsIHByaWNlIG11bHRpcGxpZXIgb2Ygc2hhcmVzDQogICAgLy8vIEBwYXJhbSBfaW5mbGF0aW9uUmF0ZSBJZiAwLCB0aGUgc2hhcmUgcHJpY2UgZG9lc24ndCBjaGFuZ2UgZHVyaW5nIHRoZSBmdW5kaW5nIChub3QgbWFuZGF0b3J5KQ0KICAgIC8vLyBAcGFyYW0gX21pbnV0ZXNGdW5kaW5nUGVyaW9kIFBlcmlvZCBpbiBtaW51dGVzIG9mIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfbWludXRlc0RlYmF0aW5nUGVyaW9kIFBlcmlvZCBpbiBtaW51dGVzIG9mIHRoZSBib2FyZCBtZWV0aW5nIHRvIHZvdGUgb24gdGhlIHByb3Bvc2FsDQogICAgLy8vIEByZXR1cm4gVGhlIGluZGV4IG9mIHRoZSBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIG5ld1Byb3Bvc2FsKA0KICAgICAgICBhZGRyZXNzIF9jb250cmFjdG9yTWFuYWdlciwNCiAgICAgICAgdWludCBfY29udHJhY3RvclByb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX2Ftb3VudCwgDQogICAgICAgIGJvb2wgX3B1YmxpY1NoYXJlQ3JlYXRpb24sDQogICAgICAgIGJvb2wgX3Rva2VuQ3JlYXRpb24sDQogICAgICAgIGFkZHJlc3MgX21haW5QYXJ0bmVyLA0KICAgICAgICB1aW50IF9pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9pbmZsYXRpb25SYXRlLA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwNCiAgICAgICAgdWludCBfbWludXRlc0RlYmF0aW5nUGVyaW9kDQogICAgKSBwYXlhYmxlIHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gbWFrZSBhIHByb3Bvc2FsIHRvIGNoYW5nZSB0aGUgRGFvIHJ1bGVzIA0KICAgIC8vLyBAcGFyYW0gX21pblF1b3J1bURpdmlzb3IgSWYgNSwgdGhlIG1pbmltdW0gcXVvcnVtIGlzIDIwJQ0KICAgIC8vLyBAcGFyYW0gX21pbkJvYXJkTWVldGluZ0ZlZXMgVGhlIGFtb3VudCAoaW4gd2VpKSB0byBtYWtlIGEgcHJvcG9zYWwgYW5kIGFzayBmb3IgYSBib2FyZCBtZWV0aW5nDQogICAgLy8vIEBwYXJhbSBfbWludXRlc1NldFByb3Bvc2FsUGVyaW9kIE1pbmltdW0gcGVyaW9kIGluIG1pbnV0ZXMgYmVmb3JlIGEgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcGFyYW0gX21pbk1pbnV0ZXNEZWJhdGVQZXJpb2QgVGhlIG1pbmltdW0gcGVyaW9kIGluIG1pbnV0ZXMgb2YgdGhlIGJvYXJkIG1lZXRpbmdzDQogICAgLy8vIEBwYXJhbSBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGUgVGhlIGluZmxhdGlvbiByYXRlIHRvIGNhbGN1bGF0ZSB0aGUgcmV3YXJkIG9mIGZlZXMgdG8gdm90ZXJzIGR1cmluZyBhIGJvYXJkIG1lZXRpbmcNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcmFibGUgVHJ1ZSBpZiB0aGUgcHJvcG9zYWwgZm9yZXNlZXMgdG8gYWxsb3cgdGhlIHRyYW5zZmVyIG9mIERhbyBzaGFyZXMNCiAgICAvLy8gQHBhcmFtIF9uZXdkYW8gQWRkcmVzcyBvZiBhIG5ldyBEYW8gc21hcnQgY29udHJhY3QgaW4gY2FzZSBvZiB1cGdyYWRlIChub3QgbWFuZGF0b3J5KSAgIA0KICAgIC8vLyBAcGFyYW0gX21pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nIFRoZSBwZXJpb2QgaW4gbWludXRlcyBmb3IgdGhlIGNsb25pbmcgcHJvY2VkdXJlIG9mIHNoYXJlcyBhbmQgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfbWludXRlc0RlYmF0aW5nUGVyaW9kIFBlcmlvZCBpbiBtaW51dGVzIG9mIHRoZSBib2FyZCBtZWV0aW5nIHRvIHZvdGUgb24gdGhlIHByb3Bvc2FsDQogICAgZnVuY3Rpb24gbmV3RGFvUnVsZXNQcm9wb3NhbCgNCiAgICAgICAgdWludCBfbWluUXVvcnVtRGl2aXNvciwgDQogICAgICAgIHVpbnQgX21pbkJvYXJkTWVldGluZ0ZlZXMsDQogICAgICAgIHVpbnQgX21pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCwNCiAgICAgICAgdWludCBfbWluTWludXRlc0RlYmF0ZVBlcmlvZCwNCiAgICAgICAgdWludCBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGUsDQogICAgICAgIGJvb2wgX3RyYW5zZmVyYWJsZSwNCiAgICAgICAgYWRkcmVzcyBfbmV3ZGFvLA0KICAgICAgICB1aW50IF9taW51dGVzRm9yVG9rZW5zQ2xvbmluZywNCiAgICAgICAgdWludCBfbWludXRlc0RlYmF0aW5nUGVyaW9kDQogICAgKSBwYXlhYmxlIHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHZvdGUgZHVyaW5nIGEgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcGFyYW0gX2JvYXJkTWVldGluZ0lEIFRoZSBpbmRleCBvZiB0aGUgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcGFyYW0gX3N1cHBvcnRzUHJvcG9zYWwgVHJ1ZSBpZiB0aGUgcHJvcG9zYWwgaXMgc3VwcG9ydGVkDQogICAgZnVuY3Rpb24gdm90ZSgNCiAgICAgICAgdWludCBfYm9hcmRNZWV0aW5nSUQsIA0KICAgICAgICBib29sIF9zdXBwb3J0c1Byb3Bvc2FsDQogICAgKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGV4ZWN1dGUgYSBib2FyZCBtZWV0aW5nIGRlY2lzaW9uIGFuZCBjbG9zZSB0aGUgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcGFyYW0gX2JvYXJkTWVldGluZ0lEIFRoZSBpbmRleCBvZiB0aGUgYm9hcmQgbWVldGluZw0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHByb3Bvc2FsIHdhcyBleGVjdXRlZCBvciBub3QNCiAgICBmdW5jdGlvbiBleGVjdXRlRGVjaXNpb24odWludCBfYm9hcmRNZWV0aW5nSUQpIHJldHVybnMgKGJvb2wpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIG9yZGVyIGEgY29udHJhY3RvciBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHByb3Bvc2FsIHdhcyBvcmRlcmVkIGFuZCB0aGUgcHJvcG9zYWwgYW1vdW50IHNlbnQgb3Igbm90DQogICAgZnVuY3Rpb24gb3JkZXJDb250cmFjdG9yUHJvcG9zYWwodWludCBfcHJvcG9zYWxJRCkgcmV0dXJucyAoYm9vbCk7ICAgDQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byB3aXRoZHJhdyB0aGUgcmV3YXJkZWQgYm9hcmQgbWVldGluZyBmZWVzDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgd2l0aGRyYXcgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90ICAgIA0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3Qm9hcmRNZWV0aW5nRmVlcygpIHJldHVybnMgKGJvb2wpOw0KDQogICAgLy8vIEBwYXJhbSBfc2hhcmVIb2xkZXIgQWRkcmVzcyBvZiB0aGUgc2hhcmVob2xkZXINCiAgICAvLy8gQHJldHVybiBUaGUgYW1vdW50IGluIHdlaSB0aGUgc2hhcmVob2xkZXIgY2FuIHdpdGhkcmF3ICAgIA0KICAgIGZ1bmN0aW9uIFBlbmRpbmdGZWVzKGFkZHJlc3MgX3NoYXJlSG9sZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHJldHVybiBUaGUgbWluaW11bSBxdW9ydW0gZm9yIHByb3Bvc2FscyB0byBwYXNzIA0KICAgIGZ1bmN0aW9uIG1pblF1b3J1bSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBjb250cmFjdG9ycyANCiAgIGZ1bmN0aW9uIG51bWJlck9mQ29udHJhY3RvcnMoKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCg0KICAgIC8vLyBAcmV0dXJuIFRoZSBudW1iZXIgb2YgYm9hcmQgbWVldGluZ3MgKG9yIHByb3Bvc2FscykgDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZCb2FyZE1lZXRpbmdzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoNCiAgICBldmVudCBDb250cmFjdG9yQWRkZWQodWludCBpbmRleGVkIENvbnRyYWN0b3JJRCwgYWRkcmVzcyBDb250cmFjdG9yTWFuYWdlciwgdWludCBDcmVhdGlvbkRhdGUpOw0KICAgIGV2ZW50IENvbnRyYWN0b3JQcm9wb3NhbEFkZGVkKHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IGJvYXJkTWVldGluZ0lELCBhZGRyZXNzIGluZGV4ZWQgQ29udHJhY3Rvck1hbmFnZXIsIA0KICAgICAgICB1aW50IGluZGV4ZWQgQ29udHJhY3RvclByb3Bvc2FsSUQsIHVpbnQgYW1vdW50KTsNCiAgICBldmVudCBGdW5kaW5nUHJvcG9zYWxBZGRlZCh1aW50IGluZGV4ZWQgUHJvcG9zYWxJRCwgdWludCBib2FyZE1lZXRpbmdJRCwgYm9vbCBpbmRleGVkIExpbmtlZFRvQ29udHJhY3RvclByb3Bvc2FsLCANCiAgICAgICAgdWludCBhbW91bnQsIGFkZHJlc3MgTWFpblBhcnRuZXIsIHVpbnQgSW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyLCB1aW50IEluZmxhdGlvblJhdGUsIHVpbnQgTWludXRlc0Z1bmRpbmdQZXJpb2QpOw0KICAgIGV2ZW50IERhb1J1bGVzUHJvcG9zYWxBZGRlZCh1aW50IGluZGV4ZWQgRGFvUnVsZXNQcm9wb3NhbElELCB1aW50IGJvYXJkTWVldGluZ0lELCB1aW50IE1pblF1b3J1bURpdmlzb3IsIA0KICAgICAgICB1aW50IE1pbkJvYXJkTWVldGluZ0ZlZXMsIHVpbnQgTWludXRlc1NldFByb3Bvc2FsUGVyaW9kLCB1aW50IE1pbk1pbnV0ZXNEZWJhdGVQZXJpb2QsIHVpbnQgRmVlc1Jld2FyZEluZmxhdGlvblJhdGUsIA0KICAgICAgICBib29sIFRyYW5zZmVyYWJsZSwgYWRkcmVzcyBOZXdEYW8sIHVpbnQgTWludXRlc0ZvclRva2Vuc0Nsb25pbmcpOw0KICAgIGV2ZW50IFZvdGVkKHVpbnQgaW5kZXhlZCBib2FyZE1lZXRpbmdJRCwgdWludCBQcm9wb3NhbElELCB1aW50IERhb1J1bGVzUHJvcG9zYWxJRCwgYm9vbCBwb3NpdGlvbiwgYWRkcmVzcyBpbmRleGVkIHZvdGVyKTsNCiAgICBldmVudCBQcm9wb3NhbENsb3NlZCh1aW50IGluZGV4ZWQgUHJvcG9zYWxJRCwgdWludCBpbmRleGVkIERhb1J1bGVzUHJvcG9zYWxJRCwgdWludCBib2FyZE1lZXRpbmdJRCwgDQogICAgICAgIHVpbnQgRmVlc0dpdmVuQmFjaywgYm9vbCBQcm9wb3NhbEV4ZWN1dGVkLCB1aW50IEJhbGFuY2VTZW50VG9EYW9NYW5hZ2VyKTsNCiAgICBldmVudCBTZW50VG9Db250cmFjdG9yKHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IGluZGV4ZWQgQ29udHJhY3RvclByb3Bvc2FsSUQsIGFkZHJlc3MgaW5kZXhlZCBDb250cmFjdG9yTWFuYWdlckFkZHJlc3MsIHVpbnQgQW1vdW50U2VudCk7DQogICAgZXZlbnQgV2l0aGRyYXdhbChhZGRyZXNzIGluZGV4ZWQgUmVjaXBpZW50LCB1aW50IEFtb3VudCk7DQogICAgZXZlbnQgRGFvVXBncmFkZWQoYWRkcmVzcyBOZXdEYW8pOw0KICAgIA0KfQ0KDQpjb250cmFjdCBQYXNzRGFvIGlzIFBhc3NEYW9JbnRlcmZhY2Ugew0KDQogICAgZnVuY3Rpb24gUGFzc0RhbygNCiAgICAgICAgc3RyaW5nIF9wcm9qZWN0TmFtZSwNCiAgICAgICAgYWRkcmVzcyBfbGFzdERhbykgew0KDQogICAgICAgIGxhc3REYW8gPSBfbGFzdERhbzsNCiAgICAgICAgY3JlYXRvciA9IG1zZy5zZW5kZXI7DQogICAgICAgIHByb2plY3ROYW1lID1fcHJvamVjdE5hbWU7DQoNCiAgICAgICAgQ29udHJhY3RvcnMubGVuZ3RoID0gMTsNCiAgICAgICAgQm9hcmRNZWV0aW5ncy5sZW5ndGggPSAxOw0KICAgICAgICBQcm9wb3NhbHMubGVuZ3RoID0gMTsNCiAgICAgICAgRGFvUnVsZXNQcm9wb3NhbHMubGVuZ3RoID0gMTsgDQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhZGRDb250cmFjdG9yKGFkZHJlc3MgX2NvbnRyYWN0b3JNYW5hZ2VyLCB1aW50IF9jcmVhdGlvbkRhdGUpIGludGVybmFsIHsNCiAgICAgICAgDQogICAgICAgIGlmIChjb250cmFjdG9ySURbX2NvbnRyYWN0b3JNYW5hZ2VyXSA9PSAwKSB7DQoNCiAgICAgICAgICAgIHVpbnQgX2NvbnRyYWN0b3JJRCA9IENvbnRyYWN0b3JzLmxlbmd0aCsrOw0KICAgICAgICAgICAgQ29udHJhY3RvciBjID0gQ29udHJhY3RvcnNbX2NvbnRyYWN0b3JJRF07DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnRyYWN0b3JJRFtfY29udHJhY3Rvck1hbmFnZXJdID0gX2NvbnRyYWN0b3JJRDsNCiAgICAgICAgICAgIGMuY29udHJhY3Rvck1hbmFnZXIgPSBfY29udHJhY3Rvck1hbmFnZXI7DQogICAgICAgICAgICBjLmNyZWF0aW9uRGF0ZSA9IF9jcmVhdGlvbkRhdGU7DQogICAgICAgICAgICANCiAgICAgICAgICAgIENvbnRyYWN0b3JBZGRlZChfY29udHJhY3RvcklELCBjLmNvbnRyYWN0b3JNYW5hZ2VyLCBjLmNyZWF0aW9uRGF0ZSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGNsb25lQ29udHJhY3RvcihhZGRyZXNzIF9jb250cmFjdG9yTWFuYWdlciwgdWludCBfY3JlYXRpb25EYXRlKSB7DQogICAgICAgIA0KICAgICAgICBpZiAoRGFvUnVsZXMubWluUXVvcnVtRGl2aXNvciAhPSAwIHx8IG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgdGhyb3c7DQoNCiAgICAgICAgYWRkQ29udHJhY3RvcihfY29udHJhY3Rvck1hbmFnZXIsIF9jcmVhdGlvbkRhdGUpOw0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gaW5pdERhbygNCiAgICAgICAgYWRkcmVzcyBfZGFvTWFuYWdlciwNCiAgICAgICAgdWludCBfbWF4SW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfbWluTWludXRlc1BlcmlvZHMsDQogICAgICAgIHVpbnQgX21heE1pbnV0ZXNGdW5kaW5nUGVyaW9kLA0KICAgICAgICB1aW50IF9tYXhNaW51dGVzUHJvcG9zYWxQZXJpb2QsDQogICAgICAgIHVpbnQgX21pblF1b3J1bURpdmlzb3IsDQogICAgICAgIHVpbnQgX21pbkJvYXJkTWVldGluZ0ZlZXMsDQogICAgICAgIHVpbnQgX21pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCwNCiAgICAgICAgdWludCBfbWluTWludXRlc0RlYmF0ZVBlcmlvZCwNCiAgICAgICAgdWludCBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGUNCiAgICAgICAgKSB7DQogICAgICAgICAgICANCiAgICAgICAgDQogICAgICAgIGlmIChzbWFydENvbnRyYWN0U3RhcnREYXRlICE9IDApIHRocm93Ow0KDQogICAgICAgIG1heEluZmxhdGlvblJhdGUgPSBfbWF4SW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgbWluTWludXRlc1BlcmlvZHMgPSBfbWluTWludXRlc1BlcmlvZHM7DQogICAgICAgIG1heE1pbnV0ZXNGdW5kaW5nUGVyaW9kID0gX21heE1pbnV0ZXNGdW5kaW5nUGVyaW9kOw0KICAgICAgICBtYXhNaW51dGVzUHJvcG9zYWxQZXJpb2QgPSBfbWF4TWludXRlc1Byb3Bvc2FsUGVyaW9kOw0KICAgICAgICANCiAgICAgICAgRGFvUnVsZXMubWluUXVvcnVtRGl2aXNvciA9IF9taW5RdW9ydW1EaXZpc29yOw0KICAgICAgICBEYW9SdWxlcy5taW5Cb2FyZE1lZXRpbmdGZWVzID0gX21pbkJvYXJkTWVldGluZ0ZlZXM7DQogICAgICAgIERhb1J1bGVzLm1pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCA9IF9taW51dGVzU2V0UHJvcG9zYWxQZXJpb2Q7DQogICAgICAgIERhb1J1bGVzLm1pbk1pbnV0ZXNEZWJhdGVQZXJpb2QgPSBfbWluTWludXRlc0RlYmF0ZVBlcmlvZDsNCiAgICAgICAgRGFvUnVsZXMuZmVlc1Jld2FyZEluZmxhdGlvblJhdGUgPSBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGU7DQogICAgICAgIGRhb01hbmFnZXIgPSBQYXNzTWFuYWdlcihfZGFvTWFuYWdlcik7DQogICAgICAgIA0KICAgICAgICBzbWFydENvbnRyYWN0U3RhcnREYXRlID0gbm93Ow0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gbmV3Qm9hcmRNZWV0aW5nKA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELCANCiAgICAgICAgdWludCBfZGFvUnVsZXNQcm9wb3NhbElELCANCiAgICAgICAgdWludCBfbWludXRlc0RlYmF0aW5nUGVyaW9kDQogICAgKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IERhb1J1bGVzLm1pbkJvYXJkTWVldGluZ0ZlZXMNCiAgICAgICAgICAgIHx8IERhb1J1bGVzLm1pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCArIF9taW51dGVzRGViYXRpbmdQZXJpb2QgPiBtYXhNaW51dGVzUHJvcG9zYWxQZXJpb2QNCiAgICAgICAgICAgIHx8IG5vdyArICgoRGFvUnVsZXMubWludXRlc1NldFByb3Bvc2FsUGVyaW9kICsgX21pbnV0ZXNEZWJhdGluZ1BlcmlvZCkgKiAxIG1pbnV0ZXMpIDwgbm93DQogICAgICAgICAgICB8fCBfbWludXRlc0RlYmF0aW5nUGVyaW9kIDwgRGFvUnVsZXMubWluTWludXRlc0RlYmF0ZVBlcmlvZA0KICAgICAgICAgICAgfHwgbXNnLnNlbmRlciA9PSBhZGRyZXNzKHRoaXMpKSB0aHJvdzsNCg0KICAgICAgICB1aW50IF9ib2FyZE1lZXRpbmdJRCA9IEJvYXJkTWVldGluZ3MubGVuZ3RoKys7DQogICAgICAgIEJvYXJkTWVldGluZyBiID0gQm9hcmRNZWV0aW5nc1tfYm9hcmRNZWV0aW5nSURdOw0KDQogICAgICAgIGIuY3JlYXRvciA9IG1zZy5zZW5kZXI7DQoNCiAgICAgICAgYi5wcm9wb3NhbElEID0gX3Byb3Bvc2FsSUQ7DQogICAgICAgIGIuZGFvUnVsZXNQcm9wb3NhbElEID0gX2Rhb1J1bGVzUHJvcG9zYWxJRDsNCg0KICAgICAgICBiLmZlZXMgPSBtc2cudmFsdWU7DQogICAgICAgIA0KICAgICAgICBiLnNldERlYWRsaW5lID0gbm93ICsgKERhb1J1bGVzLm1pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCAqIDEgbWludXRlcyk7ICAgICAgICANCiAgICAgICAgYi52b3RpbmdEZWFkbGluZSA9IGIuc2V0RGVhZGxpbmUgKyAoX21pbnV0ZXNEZWJhdGluZ1BlcmlvZCAqIDEgbWludXRlcyk7IA0KDQogICAgICAgIGIub3BlbiA9IHRydWU7IA0KDQogICAgICAgIHJldHVybiBfYm9hcmRNZWV0aW5nSUQ7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBuZXdQcm9wb3NhbCgNCiAgICAgICAgYWRkcmVzcyBfY29udHJhY3Rvck1hbmFnZXIsDQogICAgICAgIHVpbnQgX2NvbnRyYWN0b3JQcm9wb3NhbElELA0KICAgICAgICB1aW50IF9hbW91bnQsIA0KICAgICAgICBib29sIF90b2tlbkNyZWF0aW9uLA0KICAgICAgICBib29sIF9wdWJsaWNTaGFyZUNyZWF0aW9uLA0KICAgICAgICBhZGRyZXNzIF9tYWluUGFydG5lciwNCiAgICAgICAgdWludCBfaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyLCANCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfbWludXRlc0Z1bmRpbmdQZXJpb2QsDQogICAgICAgIHVpbnQgX21pbnV0ZXNEZWJhdGluZ1BlcmlvZA0KICAgICkgcGF5YWJsZSByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgaWYgKChfY29udHJhY3Rvck1hbmFnZXIgIT0gMCAmJiBfY29udHJhY3RvclByb3Bvc2FsSUQgPT0gMCkNCiAgICAgICAgICAgIHx8IChfY29udHJhY3Rvck1hbmFnZXIgPT0gMCANCiAgICAgICAgICAgICAgICAmJiAoX2luaXRpYWxTaGFyZVByaWNlTXVsdGlwbGllciA9PSAwDQogICAgICAgICAgICAgICAgICAgIHx8IF9jb250cmFjdG9yUHJvcG9zYWxJRCAhPSAwKQ0KICAgICAgICAgICAgfHwgKF90b2tlbkNyZWF0aW9uICYmIF9wdWJsaWNTaGFyZUNyZWF0aW9uKQ0KICAgICAgICAgICAgfHwgKF9pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIgIT0gMA0KICAgICAgICAgICAgICAgICYmIChfbWludXRlc0Z1bmRpbmdQZXJpb2QgPCBtaW5NaW51dGVzUGVyaW9kcw0KICAgICAgICAgICAgICAgICAgICB8fCBfaW5mbGF0aW9uUmF0ZSA+IG1heEluZmxhdGlvblJhdGUNCiAgICAgICAgICAgICAgICAgICAgfHwgX21pbnV0ZXNGdW5kaW5nUGVyaW9kID4gbWF4TWludXRlc0Z1bmRpbmdQZXJpb2QpKSkpIHRocm93Ow0KDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQgPSBQcm9wb3NhbHMubGVuZ3RoKys7DQogICAgICAgIFByb3Bvc2FsIHAgPSBQcm9wb3NhbHNbX3Byb3Bvc2FsSURdOw0KDQogICAgICAgIHAuY29udHJhY3Rvck1hbmFnZXIgPSBQYXNzTWFuYWdlcihfY29udHJhY3Rvck1hbmFnZXIpOw0KICAgICAgICBwLmNvbnRyYWN0b3JQcm9wb3NhbElEID0gX2NvbnRyYWN0b3JQcm9wb3NhbElEOw0KICAgICAgICANCiAgICAgICAgcC5hbW91bnQgPSBfYW1vdW50Ow0KICAgICAgICBwLnRva2VuQ3JlYXRpb24gPSBfdG9rZW5DcmVhdGlvbjsNCg0KICAgICAgICBwLnB1YmxpY1NoYXJlQ3JlYXRpb24gPSBfcHVibGljU2hhcmVDcmVhdGlvbjsNCiAgICAgICAgcC5tYWluUGFydG5lciA9IF9tYWluUGFydG5lcjsNCiAgICAgICAgcC5pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIgPSBfaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICBwLmluZmxhdGlvblJhdGUgPSBfaW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgcC5taW51dGVzRnVuZGluZ1BlcmlvZCA9IF9taW51dGVzRnVuZGluZ1BlcmlvZDsNCg0KICAgICAgICBwLmJvYXJkTWVldGluZ0lEID0gbmV3Qm9hcmRNZWV0aW5nKF9wcm9wb3NhbElELCAwLCBfbWludXRlc0RlYmF0aW5nUGVyaW9kKTsgICANCg0KICAgICAgICBwLm9wZW4gPSB0cnVlOw0KICAgICAgICANCiAgICAgICAgaWYgKF9jb250cmFjdG9yUHJvcG9zYWxJRCAhPSAwKSB7DQogICAgICAgICAgICBDb250cmFjdG9yUHJvcG9zYWxBZGRlZChfcHJvcG9zYWxJRCwgcC5ib2FyZE1lZXRpbmdJRCwgcC5jb250cmFjdG9yTWFuYWdlciwgcC5jb250cmFjdG9yUHJvcG9zYWxJRCwgcC5hbW91bnQpOw0KICAgICAgICAgICAgaWYgKF9pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIgIT0gMCkgew0KICAgICAgICAgICAgICAgIEZ1bmRpbmdQcm9wb3NhbEFkZGVkKF9wcm9wb3NhbElELCBwLmJvYXJkTWVldGluZ0lELCB0cnVlLCBwLmFtb3VudCwgcC5tYWluUGFydG5lciwgDQogICAgICAgICAgICAgICAgICAgIHAuaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyLCBfaW5mbGF0aW9uUmF0ZSwgX21pbnV0ZXNGdW5kaW5nUGVyaW9kKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmIChfaW5pdGlhbFNoYXJlUHJpY2VNdWx0aXBsaWVyICE9IDApIHsNCiAgICAgICAgICAgICAgICBGdW5kaW5nUHJvcG9zYWxBZGRlZChfcHJvcG9zYWxJRCwgcC5ib2FyZE1lZXRpbmdJRCwgZmFsc2UsIHAuYW1vdW50LCBwLm1haW5QYXJ0bmVyLCANCiAgICAgICAgICAgICAgICAgICAgcC5pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIsIF9pbmZsYXRpb25SYXRlLCBfbWludXRlc0Z1bmRpbmdQZXJpb2QpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBuZXdEYW9SdWxlc1Byb3Bvc2FsKA0KICAgICAgICB1aW50IF9taW5RdW9ydW1EaXZpc29yLCANCiAgICAgICAgdWludCBfbWluQm9hcmRNZWV0aW5nRmVlcywNCiAgICAgICAgdWludCBfbWludXRlc1NldFByb3Bvc2FsUGVyaW9kLA0KICAgICAgICB1aW50IF9taW5NaW51dGVzRGViYXRlUGVyaW9kLA0KICAgICAgICB1aW50IF9mZWVzUmV3YXJkSW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJhYmxlLA0KICAgICAgICBhZGRyZXNzIF9uZXdEYW8sDQogICAgICAgIHVpbnQgX21pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nLA0KICAgICAgICB1aW50IF9taW51dGVzRGViYXRpbmdQZXJpb2QNCiAgICApIHBheWFibGUgcmV0dXJucyAodWludCkgew0KICAgIA0KICAgICAgICBpZiAoX21pblF1b3J1bURpdmlzb3IgPD0gMQ0KICAgICAgICAgICAgfHwgX21pblF1b3J1bURpdmlzb3IgPiAxMA0KICAgICAgICAgICAgfHwgX21pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCA8IG1pbk1pbnV0ZXNQZXJpb2RzDQogICAgICAgICAgICB8fCBfbWluTWludXRlc0RlYmF0ZVBlcmlvZCA8IG1pbk1pbnV0ZXNQZXJpb2RzDQogICAgICAgICAgICB8fCBfbWludXRlc1NldFByb3Bvc2FsUGVyaW9kICsgX21pbk1pbnV0ZXNEZWJhdGVQZXJpb2QgPiBtYXhNaW51dGVzUHJvcG9zYWxQZXJpb2QNCiAgICAgICAgICAgIHx8IF9mZWVzUmV3YXJkSW5mbGF0aW9uUmF0ZSA+IG1heEluZmxhdGlvblJhdGUNCiAgICAgICAgICAgICkgdGhyb3c7IA0KICAgICAgICANCiAgICAgICAgdWludCBfRGFvUnVsZXNQcm9wb3NhbElEID0gRGFvUnVsZXNQcm9wb3NhbHMubGVuZ3RoKys7DQogICAgICAgIFJ1bGVzIHIgPSBEYW9SdWxlc1Byb3Bvc2Fsc1tfRGFvUnVsZXNQcm9wb3NhbElEXTsNCg0KICAgICAgICByLm1pblF1b3J1bURpdmlzb3IgPSBfbWluUXVvcnVtRGl2aXNvcjsNCiAgICAgICAgci5taW5Cb2FyZE1lZXRpbmdGZWVzID0gX21pbkJvYXJkTWVldGluZ0ZlZXM7DQogICAgICAgIHIubWludXRlc1NldFByb3Bvc2FsUGVyaW9kID0gX21pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZDsNCiAgICAgICAgci5taW5NaW51dGVzRGViYXRlUGVyaW9kID0gX21pbk1pbnV0ZXNEZWJhdGVQZXJpb2Q7DQogICAgICAgIHIuZmVlc1Jld2FyZEluZmxhdGlvblJhdGUgPSBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGU7DQogICAgICAgIHIudHJhbnNmZXJhYmxlID0gX3RyYW5zZmVyYWJsZTsNCiAgICAgICAgci5uZXdkYW8gPSBfbmV3RGFvOw0KICAgICAgICByLm1pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nID0gX21pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nOw0KDQogICAgICAgIHIuYm9hcmRNZWV0aW5nSUQgPSBuZXdCb2FyZE1lZXRpbmcoMCwgX0Rhb1J1bGVzUHJvcG9zYWxJRCwgX21pbnV0ZXNEZWJhdGluZ1BlcmlvZCk7ICAgICANCg0KICAgICAgICBEYW9SdWxlc1Byb3Bvc2FsQWRkZWQoX0Rhb1J1bGVzUHJvcG9zYWxJRCwgci5ib2FyZE1lZXRpbmdJRCwgX21pblF1b3J1bURpdmlzb3IsIF9taW5Cb2FyZE1lZXRpbmdGZWVzLCANCiAgICAgICAgICAgIF9taW51dGVzU2V0UHJvcG9zYWxQZXJpb2QsIF9taW5NaW51dGVzRGViYXRlUGVyaW9kLCBfZmVlc1Jld2FyZEluZmxhdGlvblJhdGUgLF90cmFuc2ZlcmFibGUsIF9uZXdEYW8gLF9taW51dGVzRm9yVG9rZW5zQ2xvbmluZyk7DQoNCiAgICAgICAgcmV0dXJuIF9EYW9SdWxlc1Byb3Bvc2FsSUQ7DQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiB2b3RlKA0KICAgICAgICB1aW50IF9ib2FyZE1lZXRpbmdJRCwgDQogICAgICAgIGJvb2wgX3N1cHBvcnRzUHJvcG9zYWwNCiAgICApIHsNCiAgICAgICAgDQogICAgICAgIEJvYXJkTWVldGluZyBiID0gQm9hcmRNZWV0aW5nc1tfYm9hcmRNZWV0aW5nSURdOw0KDQogICAgICAgIGlmIChiLmhhc1ZvdGVkW21zZy5zZW5kZXJdIA0KICAgICAgICAgICAgfHwgbm93IDwgYi5zZXREZWFkbGluZQ0KICAgICAgICAgICAgfHwgbm93ID4gYi52b3RpbmdEZWFkbGluZSkgdGhyb3c7DQoNCiAgICAgICAgdWludCBfYmFsYW5jZSA9IHVpbnQoZGFvTWFuYWdlci5iYWxhbmNlT2YobXNnLnNlbmRlcikpOw0KICAgICAgICBpZiAoX2JhbGFuY2UgPT0gMCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBiLmhhc1ZvdGVkW21zZy5zZW5kZXJdID0gdHJ1ZTsNCg0KICAgICAgICBpZiAoX3N1cHBvcnRzUHJvcG9zYWwpIGIueWVhICs9IF9iYWxhbmNlOw0KICAgICAgICBlbHNlIGIubmF5ICs9IF9iYWxhbmNlOyANCg0KICAgICAgICBpZiAoYi5mZWVzID4gMCAmJiBiLnByb3Bvc2FsSUQgIT0gMCAmJiBQcm9wb3NhbHNbYi5wcm9wb3NhbElEXS5jb250cmFjdG9yUHJvcG9zYWxJRCAhPSAwKSB7DQoNCiAgICAgICAgICAgIHVpbnQgX2EgPSAxMDAqYi5mZWVzOw0KICAgICAgICAgICAgaWYgKChfYS8xMDAgIT0gYi5mZWVzKSB8fCAoKF9hKl9iYWxhbmNlKS9fYSAhPSBfYmFsYW5jZSkpIHRocm93Ow0KICAgICAgICAgICAgdWludCBfbXVsdGlwbGllciA9IChfYSpfYmFsYW5jZSkvdWludChkYW9NYW5hZ2VyLnRvdGFsU3VwcGx5KCkpOw0KDQogICAgICAgICAgICB1aW50IF9kaXZpc29yID0gMTAwICsgMTAwKkRhb1J1bGVzLmZlZXNSZXdhcmRJbmZsYXRpb25SYXRlKihub3cgLSBiLnNldERlYWRsaW5lKS8oMTAwKjM2NSBkYXlzKTsNCg0KICAgICAgICAgICAgdWludCBfcmV3YXJkZWRhbW91bnQgPSBfbXVsdGlwbGllci9fZGl2aXNvcjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGIudG90YWxSZXdhcmRlZEFtb3VudCArIF9yZXdhcmRlZGFtb3VudCA+IGIuZmVlcykgX3Jld2FyZGVkYW1vdW50ID0gYi5mZWVzIC0gYi50b3RhbFJld2FyZGVkQW1vdW50Ow0KICAgICAgICAgICAgYi50b3RhbFJld2FyZGVkQW1vdW50ICs9IF9yZXdhcmRlZGFtb3VudDsNCiAgICAgICAgICAgIHBlbmRpbmdGZWVzW21zZy5zZW5kZXJdICs9IF9yZXdhcmRlZGFtb3VudDsNCiAgICAgICAgfQ0KDQogICAgICAgIFZvdGVkKF9ib2FyZE1lZXRpbmdJRCwgYi5wcm9wb3NhbElELCBiLmRhb1J1bGVzUHJvcG9zYWxJRCwgX3N1cHBvcnRzUHJvcG9zYWwsIG1zZy5zZW5kZXIpOw0KICAgICAgICANCiAgICAgICAgZGFvTWFuYWdlci5ibG9ja1RyYW5zZmVyKG1zZy5zZW5kZXIsIGIudm90aW5nRGVhZGxpbmUpOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZXhlY3V0ZURlY2lzaW9uKHVpbnQgX2JvYXJkTWVldGluZ0lEKSByZXR1cm5zIChib29sKSB7DQoNCiAgICAgICAgQm9hcmRNZWV0aW5nIGIgPSBCb2FyZE1lZXRpbmdzW19ib2FyZE1lZXRpbmdJRF07DQogICAgICAgIFByb3Bvc2FsIHAgPSBQcm9wb3NhbHNbYi5wcm9wb3NhbElEXTsNCiAgICAgICAgDQogICAgICAgIGlmIChub3cgPCBiLnZvdGluZ0RlYWRsaW5lIHx8ICFiLm9wZW4pIHRocm93Ow0KICAgICAgICANCiAgICAgICAgYi5vcGVuID0gZmFsc2U7DQogICAgICAgIGlmIChwLmNvbnRyYWN0b3JQcm9wb3NhbElEID09IDApIHAub3BlbiA9IGZhbHNlOw0KDQogICAgICAgIHVpbnQgX2ZlZXM7DQogICAgICAgIHVpbnQgX21pblF1b3J1bSA9IG1pblF1b3J1bSgpOw0KDQogICAgICAgIGlmIChiLmZlZXMgPiAwDQogICAgICAgICAgICAmJiAoYi5wcm9wb3NhbElEID09IDAgfHwgcC5jb250cmFjdG9yUHJvcG9zYWxJRCA9PSAwKQ0KICAgICAgICAgICAgJiYgYi55ZWEgKyBiLm5heSA+PSBfbWluUXVvcnVtKSB7DQogICAgICAgICAgICAgICAgICAgIF9mZWVzID0gYi5mZWVzOw0KICAgICAgICAgICAgICAgICAgICBiLmZlZXMgPSAwOw0KICAgICAgICAgICAgICAgICAgICBwZW5kaW5nRmVlc1tiLmNyZWF0b3JdICs9IF9mZWVzOw0KICAgICAgICB9ICAgICAgICANCg0KICAgICAgICB1aW50IF9iYWxhbmNlID0gYi5mZWVzIC0gYi50b3RhbFJld2FyZGVkQW1vdW50Ow0KICAgICAgICBpZiAoX2JhbGFuY2UgPiAwKSB7DQogICAgICAgICAgICBpZiAoIWRhb01hbmFnZXIuc2VuZChfYmFsYW5jZSkpIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoYi55ZWEgKyBiLm5heSA8IF9taW5RdW9ydW0gfHwgYi55ZWEgPD0gYi5uYXkpIHsNCiAgICAgICAgICAgIHAub3BlbiA9IGZhbHNlOw0KICAgICAgICAgICAgUHJvcG9zYWxDbG9zZWQoYi5wcm9wb3NhbElELCBiLmRhb1J1bGVzUHJvcG9zYWxJRCwgX2JvYXJkTWVldGluZ0lELCBfZmVlcywgZmFsc2UsIF9iYWxhbmNlKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGIuZGF0ZU9mRXhlY3V0aW9uID0gbm93Ow0KDQogICAgICAgIGlmIChiLnByb3Bvc2FsSUQgIT0gMCkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAocC5pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIgIT0gMCkgew0KDQogICAgICAgICAgICAgICAgZGFvTWFuYWdlci5zZXRGdW5kaW5nUnVsZXMocC5tYWluUGFydG5lciwgcC5wdWJsaWNTaGFyZUNyZWF0aW9uLCBwLmluaXRpYWxTaGFyZVByaWNlTXVsdGlwbGllciwgDQogICAgICAgICAgICAgICAgICAgIHAuYW1vdW50LCBwLm1pbnV0ZXNGdW5kaW5nUGVyaW9kLCBwLmluZmxhdGlvblJhdGUsIGIucHJvcG9zYWxJRCk7DQoNCiAgICAgICAgICAgICAgICBpZiAocC5jb250cmFjdG9yUHJvcG9zYWxJRCAhPSAwICYmIHAudG9rZW5DcmVhdGlvbikgew0KICAgICAgICAgICAgICAgICAgICBwLmNvbnRyYWN0b3JNYW5hZ2VyLnNldEZ1bmRpbmdSdWxlcyhwLm1haW5QYXJ0bmVyLCBwLnB1YmxpY1NoYXJlQ3JlYXRpb24sIDAsIA0KICAgICAgICAgICAgICAgICAgICAgICAgcC5hbW91bnQsIHAubWludXRlc0Z1bmRpbmdQZXJpb2QsIG1heEluZmxhdGlvblJhdGUsIGIucHJvcG9zYWxJRCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgUnVsZXMgciA9IERhb1J1bGVzUHJvcG9zYWxzW2IuZGFvUnVsZXNQcm9wb3NhbElEXTsNCiAgICAgICAgICAgIERhb1J1bGVzLmJvYXJkTWVldGluZ0lEID0gci5ib2FyZE1lZXRpbmdJRDsNCg0KICAgICAgICAgICAgRGFvUnVsZXMubWluUXVvcnVtRGl2aXNvciA9IHIubWluUXVvcnVtRGl2aXNvcjsNCiAgICAgICAgICAgIERhb1J1bGVzLm1pbk1pbnV0ZXNEZWJhdGVQZXJpb2QgPSByLm1pbk1pbnV0ZXNEZWJhdGVQZXJpb2Q7IA0KICAgICAgICAgICAgRGFvUnVsZXMubWluQm9hcmRNZWV0aW5nRmVlcyA9IHIubWluQm9hcmRNZWV0aW5nRmVlczsNCiAgICAgICAgICAgIERhb1J1bGVzLm1pbnV0ZXNTZXRQcm9wb3NhbFBlcmlvZCA9IHIubWludXRlc1NldFByb3Bvc2FsUGVyaW9kOw0KICAgICAgICAgICAgRGFvUnVsZXMuZmVlc1Jld2FyZEluZmxhdGlvblJhdGUgPSByLmZlZXNSZXdhcmRJbmZsYXRpb25SYXRlOw0KDQogICAgICAgICAgICBEYW9SdWxlcy50cmFuc2ZlcmFibGUgPSByLnRyYW5zZmVyYWJsZTsNCiAgICAgICAgICAgIGlmIChyLnRyYW5zZmVyYWJsZSkgZGFvTWFuYWdlci5hYmxlVHJhbnNmZXIoKTsNCiAgICAgICAgICAgIGVsc2UgZGFvTWFuYWdlci5kaXNhYmxlVHJhbnNmZXIoMCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChyLm1pbnV0ZXNGb3JUb2tlbnNDbG9uaW5nICE9IDApIHsNCiAgICAgICAgICAgICAgICBjbG9zaW5nVGltZUZvckNsb25pbmcgPSBub3cgKyAoci5taW51dGVzRm9yVG9rZW5zQ2xvbmluZyAqIDEgbWludXRlcyk7DQogICAgICAgICAgICAgICAgZGFvTWFuYWdlci5kaXNhYmxlVHJhbnNmZXIoY2xvc2luZ1RpbWVGb3JDbG9uaW5nKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKChyLm5ld2RhbyAhPSAwKSAmJiAoci5uZXdkYW8gIT0gYWRkcmVzcyh0aGlzKSkpIHsNCiAgICAgICAgICAgICAgICBEYW9SdWxlcy5uZXdkYW8gPSByLm5ld2RhbzsNCiAgICAgICAgICAgICAgICBkYW9NYW5hZ2VyLnVwZGF0ZUNsaWVudChyLm5ld2Rhbyk7DQogICAgICAgICAgICAgICAgRGFvVXBncmFkZWQoci5uZXdkYW8pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgIH0NCg0KICAgICAgICBQcm9wb3NhbENsb3NlZChiLnByb3Bvc2FsSUQsIGIuZGFvUnVsZXNQcm9wb3NhbElELCBfYm9hcmRNZWV0aW5nSUQgLF9mZWVzLCB0cnVlLCBfYmFsYW5jZSk7DQogICAgICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBvcmRlckNvbnRyYWN0b3JQcm9wb3NhbCh1aW50IF9wcm9wb3NhbElEKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIA0KICAgICAgICBQcm9wb3NhbCBwID0gUHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCiAgICAgICAgQm9hcmRNZWV0aW5nIGIgPSBCb2FyZE1lZXRpbmdzW3AuYm9hcmRNZWV0aW5nSURdOw0KDQogICAgICAgIGlmIChiLm9wZW4gfHwgIXAub3BlbikgdGhyb3c7DQogICAgICAgIA0KICAgICAgICB1aW50IF9hbW91bnQgPSBwLmFtb3VudDsNCg0KICAgICAgICBpZiAocC5pbml0aWFsU2hhcmVQcmljZU11bHRpcGxpZXIgIT0gMCkgew0KICAgICAgICAgICAgX2Ftb3VudCA9IGRhb01hbmFnZXIuRnVuZGVkQW1vdW50KF9wcm9wb3NhbElEKTsNCiAgICAgICAgICAgIGlmIChfYW1vdW50ID09IDAgJiYgbm93IDwgYi5kYXRlT2ZFeGVjdXRpb24gKyAocC5taW51dGVzRnVuZGluZ1BlcmlvZCAqIDEgbWludXRlcykpIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcC5vcGVuID0gZmFsc2U7ICAgDQoNCiAgICAgICAgaWYgKF9hbW91bnQgPT0gMCB8fCAhcC5jb250cmFjdG9yTWFuYWdlci5vcmRlcihfcHJvcG9zYWxJRCwgcC5jb250cmFjdG9yUHJvcG9zYWxJRCwgX2Ftb3VudCkpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIGlmICghZGFvTWFuYWdlci5zZW5kVG8ocC5jb250cmFjdG9yTWFuYWdlciwgX2Ftb3VudCkpIHRocm93Ow0KICAgICAgICBTZW50VG9Db250cmFjdG9yKF9wcm9wb3NhbElELCBwLmNvbnRyYWN0b3JQcm9wb3NhbElELCBhZGRyZXNzKHAuY29udHJhY3Rvck1hbmFnZXIpLCBfYW1vdW50KTsNCiAgICAgICAgDQogICAgICAgIGFkZENvbnRyYWN0b3IoYWRkcmVzcyhwLmNvbnRyYWN0b3JNYW5hZ2VyKSwgbm93KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3Qm9hcmRNZWV0aW5nRmVlcygpIHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICB1aW50IF9hbW91bnQgPSBwZW5kaW5nRmVlc1ttc2cuc2VuZGVyXTsNCg0KICAgICAgICBwZW5kaW5nRmVlc1ttc2cuc2VuZGVyXSA9IDA7DQoNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChfYW1vdW50KSkgew0KICAgICAgICAgICAgV2l0aGRyYXdhbChtc2cuc2VuZGVyLCBfYW1vdW50KTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcGVuZGluZ0ZlZXNbbXNnLnNlbmRlcl0gPSBfYW1vdW50Ow0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBQZW5kaW5nRmVlcyhhZGRyZXNzIF9zaGFyZUhvbGRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gKHBlbmRpbmdGZWVzW19zaGFyZUhvbGRlcl0pOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBtaW5RdW9ydW0oKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiAodWludChkYW9NYW5hZ2VyLnRvdGFsU3VwcGx5KCkpIC8gRGFvUnVsZXMubWluUXVvcnVtRGl2aXNvcik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZDb250cmFjdG9ycygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIENvbnRyYWN0b3JzLmxlbmd0aCAtIDE7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mQm9hcmRNZWV0aW5ncygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIEJvYXJkTWVldGluZ3MubGVuZ3RoIC0gMTsNCiAgICB9DQogICAgDQp9'