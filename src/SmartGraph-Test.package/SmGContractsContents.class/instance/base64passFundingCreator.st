base 64 content
base64passFundingCreator
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4yOw0KDQovKg0KICoNCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFBhc3MgREFPLg0KICoNCiAqIFRoZSBUb2tlbiBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IGlzIHVzZWQgZm9yIHRoZSBtYW5hZ2VtZW50IG9mIHRva2Vucw0KICogYnkgYSBjbGllbnQgc21hcnQgY29udHJhY3QgKHRoZSBEYW8pLiBEZWZpbmVzIHRoZSBmdW5jdGlvbnMgdG8gc2V0IG5ldyBmdW5kaW5nIHJ1bGVzLA0KICogY3JlYXRlIG9yIHJld2FyZCB0b2tlbnMsIGNoZWNrIHRva2VuIGJhbGFuY2VzLCBzZW5kIHRva2VucyBhbmQgc2VuZA0KICogdG9rZW5zIG9uIGJlaGFsZiBvZiBhIDNyZCBwYXJ0eSBhbmQgdGhlIGNvcnJlc3BvbmRpbmcgYXBwcm92YWwgcHJvY2Vzcy4NCiAqDQoqLw0KDQovLy8gQHRpdGxlIFRva2VuIE1hbmFnZXIgc21hcnQgY29udHJhY3Qgb2YgdGhlIFBhc3MgRGVjZW50cmFsaXplZCBBdXRvbm9tb3VzIE9yZ2FuaXNhdGlvbg0KY29udHJhY3QgUGFzc1Rva2VuTWFuYWdlckludGVyZmFjZSB7DQogICAgDQogICAgc3RydWN0IGZ1bmRpbmdEYXRhIHsNCiAgICAgICAgLy8gVHJ1ZSBpZiBwdWJsaWMgZnVuZGluZyB3aXRob3V0IGEgbWFpbiBwYXJ0bmVyDQogICAgICAgIGJvb2wgcHVibGljQ3JlYXRpb247IA0KICAgICAgICAvLyBUaGUgYWRkcmVzcyB3aGljaCBzZXRzIHBhcnRuZXJzIGFuZCBtYW5hZ2VzIHRoZSBmdW5kaW5nIGluIGNhc2Ugb2YgcHJpdmF0ZSBmdW5kaW5nDQogICAgICAgIGFkZHJlc3MgbWFpblBhcnRuZXI7DQogICAgICAgIC8vIFRoZSBtYXhpbXVtIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgZnVuZGluZw0KICAgICAgICB1aW50IG1heEFtb3VudFRvRnVuZDsNCiAgICAgICAgLy8gVGhlIGFjdHVhbCBmdW5kZWQgYW1vdW50IChpbiB3ZWkpDQogICAgICAgIHVpbnQgZnVuZGVkQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgc3RhcnQgdGltZSBvZiB0aGUgZnVuZGluZw0KICAgICAgICB1aW50IHN0YXJ0VGltZTsgDQogICAgICAgIC8vIEEgdW5peCB0aW1lc3RhbXAsIGRlbm90aW5nIHRoZSBjbG9zaW5nIHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBjbG9zaW5nVGltZTsgIA0KICAgICAgICAvLyBUaGUgcHJpY2UgbXVsdGlwbGllciBmb3IgYSBzaGFyZSBvciBhIHRva2VuIHdpdGhvdXQgY29uc2lkZXJpbmcgdGhlIGluZmxhdGlvbiByYXRlDQogICAgICAgIHVpbnQgaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgLy8gUmF0ZSBwZXIgeWVhciBpbiBwZXJjZW50YWdlIGFwcGxpZWQgdG8gdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIA0KICAgICAgICB1aW50IGluZmxhdGlvblJhdGU7IA0KICAgICAgICAvLyBJbmRleCBvZiB0aGUgY2xpZW50IHByb3Bvc2FsDQogICAgICAgIHVpbnQgcHJvcG9zYWxJRDsNCiAgICB9IA0KDQogICAgLy8gQWRkcmVzcyBvZiB0aGUgY3JlYXRvciBvZiB0aGUgc21hcnQgY29udHJhY3QNCiAgICBhZGRyZXNzIHB1YmxpYyBjcmVhdG9yOw0KICAgIC8vIEFkZHJlc3Mgb2YgdGhlIERhbyAgICANCiAgICBhZGRyZXNzIHB1YmxpYyBjbGllbnQ7DQogICAgLy8gQWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50Ow0KICAgIGFkZHJlc3MgcHVibGljIHJlY2lwaWVudDsNCiAgICANCiAgICAvLyBUaGUgdG9rZW4gbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlDQogICAgc3RyaW5nIHB1YmxpYyBuYW1lOw0KICAgIC8vIFRoZSB0b2tlbiBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sOw0KICAgIC8vIFRoZSBxdWFudGl0eSBvZiBkZWNpbWFscyBmb3IgZGlzcGxheSBwdXJwb3NlDQogICAgdWludDggcHVibGljIGRlY2ltYWxzOw0KDQogICAgLy8gVG90YWwgYW1vdW50IG9mIHRva2Vucw0KICAgIHVpbnQyNTYgdG90YWxTdXBwbHk7DQoNCiAgICAvLyBBcnJheSB3aXRoIGFsbCBiYWxhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgLy8gQXJyYXkgd2l0aCBhbGwgYWxsb3dhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIC8vIE1hcCBvZiB0aGUgcmVzdWx0IChpbiB3ZWkpIG9mIGZ1bmRpbmdzDQogICAgbWFwcGluZyAodWludCA9PiB1aW50KSBmdW5kZWRBbW91bnQ7DQogICAgDQogICAgLy8gSWYgdHJ1ZSwgdGhlIHNoYXJlcyBvciB0b2tlbnMgY2FuIGJlIHRyYW5zZmVyZWQNCiAgICBib29sIHB1YmxpYyB0cmFuc2ZlcmFibGU7DQogICAgLy8gTWFwIG9mIGJsb2NrZWQgRGFvIHNoYXJlIGFjY291bnRzLiBQb2ludHMgdG8gdGhlIGRhdGUgd2hlbiB0aGUgc2hhcmUgaG9sZGVyIGNhbiB0cmFuc2ZlciBzaGFyZXMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBibG9ja2VkRGVhZExpbmU7IA0KDQogICAgLy8gUnVsZXMgZm9yIHRoZSBhY3R1YWwgZnVuZGluZyBhbmQgdGhlIGNvbnRyYWN0b3IgdG9rZW4gcHJpY2UNCiAgICBmdW5kaW5nRGF0YVsyXSBwdWJsaWMgRnVuZGluZ1J1bGVzOw0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBzdXBwbHkgb2Ygc2hhcmVzIG9yIHRva2VucyANCiAgICBmdW5jdGlvbiBUb3RhbFN1cHBseSgpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYpOw0KDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB0aGUgYmFsYW5jZSB3aWxsIGJlIHJldHJpZXZlZA0KICAgIC8vLyBAcmV0dXJuIFRoZSBiYWxhbmNlDQogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKTsNCg0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcmV0dXJuIFF1YW50aXR5IG9mIHJlbWFpbmluZyB0b2tlbnMgb2YgX293bmVyIHRoYXQgX3NwZW5kZXIgaXMgYWxsb3dlZCB0byBzcGVuZA0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpOw0KDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIERhbyBwcm9wb3NhbA0KICAgIC8vLyBAcmV0dXJuIFRoZSByZXN1bHQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICBmdW5jdGlvbiBGdW5kZWRBbW91bnQodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQHBhcmFtIF9zYWxlRGF0ZSBpbiBjYXNlIG9mIHByZXNhbGUsIHRoZSBkYXRlIG9mIHRoZSBwcmVzYWxlDQogICAgLy8vIEByZXR1cm4gdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIGRpdmlzb3IgY29uZGlkZXJpbmcgdGhlIHNhbGUgZGF0ZSBhbmQgdGhlIGluZmxhdGlvbiByYXRlDQogICAgZnVuY3Rpb24gcHJpY2VEaXZpc29yKHVpbnQgX3NhbGVEYXRlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHJldHVybiB0aGUgYWN0dWFsIHByaWNlIGRpdmlzb3Igb2YgYSBzaGFyZSBvciB0b2tlbg0KICAgIGZ1bmN0aW9uIGFjdHVhbFByaWNlRGl2aXNvcigpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEByZXR1cm4gVGhlIG1heGltYWwgYW1vdW50IGEgbWFpbiBwYXJ0bmVyIGNhbiBmdW5kIGF0IHRoaXMgbW9tZW50DQogICAgLy8vIEBwYXJhbSBfbWFpblBhcnRuZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIG1haW4gcGFybmVyDQogICAgZnVuY3Rpb24gZnVuZGluZ01heEFtb3VudChhZGRyZXNzIF9tYWluUGFydG5lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLyBNb2RpZmllciB0aGF0IGFsbG93cyBvbmx5IHRoZSBjbGllbnQgdG8gbWFuYWdlIHRoaXMgYWNjb3VudCBtYW5hZ2VyDQogICAgbW9kaWZpZXIgb25seUNsaWVudCB7aWYgKG1zZy5zZW5kZXIgIT0gY2xpZW50KSB0aHJvdzsgXzt9DQoNCiAgICAvLyBNb2RpZmllciB0aGF0IGFsbG93cyBvbmx5IHRoZSBtYWluIHBhcnRuZXIgdG8gbWFuYWdlIHRoZSBhY3R1YWwgZnVuZGluZw0KICAgIG1vZGlmaWVyIG9ubHlNYWluUGFydG5lciB7aWYgKG1zZy5zZW5kZXIgIT0gIEZ1bmRpbmdSdWxlc1swXS5tYWluUGFydG5lcikgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgdGhlIGNvbnRyYWN0b3IgcHJvcG9zZSBzZXQgdGhlIHRva2VuIHByaWNlIG9yIHdpdGhkcmF3DQogICAgbW9kaWZpZXIgb25seUNvbnRyYWN0b3Ige2lmIChyZWNpcGllbnQgPT0gMCB8fCAobXNnLnNlbmRlciAhPSByZWNpcGllbnQgJiYgbXNnLnNlbmRlciAhPSBjcmVhdG9yKSkgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIGZvciBEYW8gZnVuY3Rpb25zDQogICAgbW9kaWZpZXIgb25seURhbyB7aWYgKHJlY2lwaWVudCAhPSAwKSB0aHJvdzsgXzt9DQogICAgDQogICAgLy8vIEBkZXYgVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uDQogICAgLy8vIEBwYXJhbSBfY3JlYXRvciBUaGUgYWRkcmVzcyBvZiB0aGUgY3JlYXRvciBvZiB0aGUgc21hcnQgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9jbGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIGNsaWVudCBvciBEYW8NCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIHJlY2lwaWVudCBvZiB0aGlzIG1hbmFnZXINCiAgICAvL2Z1bmN0aW9uIFRva2VuTWFuYWdlcigNCiAgICAgICAgLy9hZGRyZXNzIF9jcmVhdG9yLA0KICAgICAgICAvL2FkZHJlc3MgX2NsaWVudCwNCiAgICAgICAgLy9hZGRyZXNzIF9yZWNpcGllbnQNCiAgICAvLyk7DQoNCiAgICAvLy8gQHBhcmFtIF90b2tlbk5hbWUgVGhlIHRva2VuIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIC8vLyBAcGFyYW0gX3Rva2VuU3ltYm9sIFRoZSB0b2tlbiBzeW1ib2wgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIC8vLyBAcGFyYW0gX3Rva2VuRGVjaW1hbHMgVGhlIHF1YW50aXR5IG9mIGRlY2ltYWxzIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICAvLy8gQHBhcmFtIF9pbml0aWFsU3VwcGx5UmVjaXBpZW50IFRoZSByZWNpcGllbnQgb2YgdGhlIGluaXRpYWwgc3VwcGx5IChub3QgbWFuZGF0b3J5KQ0KICAgIC8vLyBAcGFyYW0gX2luaXRpYWxTdXBwbHkgVGhlIGluaXRpYWwgc3VwcGx5IG9mIHRva2VucyBmb3IgdGhlIHJlY2lwaWVudCAobm90IG1hbmRhdG9yeSkNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcmFibGUgVHJ1ZSBpZiBhbGxvd3MgdGhlIHRyYW5zZmVyIG9mIHRva2Vucw0KICAgIGZ1bmN0aW9uIGluaXRUb2tlbigNCiAgICAgICAgc3RyaW5nIF90b2tlbk5hbWUsDQogICAgICAgIHN0cmluZyBfdG9rZW5TeW1ib2wsDQogICAgICAgIHVpbnQ4IF90b2tlbkRlY2ltYWxzLA0KICAgICAgICBhZGRyZXNzIF9pbml0aWFsU3VwcGx5UmVjaXBpZW50LA0KICAgICAgICB1aW50MjU2IF9pbml0aWFsU3VwcGx5LA0KICAgICAgICBib29sIF90cmFuc2ZlcmFibGUNCiAgICAgICApOw0KDQogICAgLy8vIEBwYXJhbSBfaW5pdGlhbFByaWNlTXVsdGlwbGllciBUaGUgaW5pdGlhbCBwcmljZSBtdWx0aXBsaWVyIG9mIGNvbnRyYWN0b3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfaW5mbGF0aW9uUmF0ZSBJZiAwLCB0aGUgY29udHJhY3RvciB0b2tlbiBwcmljZSBkb2Vzbid0IGNoYW5nZSBkdXJpbmcgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9jbG9zaW5nVGltZSBUaGUgaW5pdGlhbCBwcmljZSBhbmQgaW5mbGF0aW9uIHJhdGUgY2FuIGJlIGNoYW5nZWQgYWZ0ZXIgdGhpcyBkYXRlDQogICAgZnVuY3Rpb24gc2V0VG9rZW5QcmljZVByb3Bvc2FsKCAgICAgICAgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9pbmZsYXRpb25SYXRlLA0KICAgICAgICB1aW50IF9jbG9zaW5nVGltZQ0KICAgICk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBzZXQgYSBmdW5kaW5nLiBDYW4gYmUgcHJpdmF0ZSBvciBwdWJsaWMNCiAgICAvLy8gQHBhcmFtIF9tYWluUGFydG5lciBUaGUgYWRkcmVzcyBvZiB0aGUgc21hcnQgY29udHJhY3QgdG8gbWFuYWdlIGEgcHJpdmF0ZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfcHVibGljQ3JlYXRpb24gVHJ1ZSBpZiBwdWJsaWMgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2luaXRpYWxQcmljZU11bHRpcGxpZXIgUHJpY2UgbXVsdGlwbGllciB3aXRob3V0IGNvbnNpZGVyaW5nIGFueSBpbmZsYXRpb24gcmF0ZQ0KICAgIC8vLyBAcGFyYW0gX21heEFtb3VudFRvRnVuZCBUaGUgbWF4aW11bSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9taW51dGVzRnVuZGluZ1BlcmlvZCBQZXJpb2QgaW4gbWludXRlcyBvZiB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2luZmxhdGlvblJhdGUgSWYgMCwgdGhlIHRva2VuIHByaWNlIGRvZXNuJ3QgY2hhbmdlIGR1cmluZyB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbCAobm90IG1hbmRhdG9yeSkNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nUnVsZXMoDQogICAgICAgIGFkZHJlc3MgX21haW5QYXJ0bmVyLA0KICAgICAgICBib29sIF9wdWJsaWNDcmVhdGlvbiwgDQogICAgICAgIHVpbnQgX2luaXRpYWxQcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9tYXhBbW91bnRUb0Z1bmQsIA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQNCiAgICApIGV4dGVybmFsOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIGZvciB0aGUgY3JlYXRpb24gb2Ygc2hhcmVzIG9yIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgcmVjaXBpZW50IGFkZHJlc3Mgb2Ygc2hhcmVzIG9yIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgZnVuZGVkIGFtb3VudCAoaW4gd2VpKQ0KICAgIC8vLyBAcGFyYW0gX3NhbGVEYXRlIEluIGNhc2Ugb2YgcHJlc2FsZSwgdGhlIGRhdGUgb2YgdGhlIHByZXNhbGUNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBjcmVhdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbigNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICB1aW50IF9zYWxlRGF0ZQ0KICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIG1haW4gcGFydG5lciB0byBzZXQgdGhlIHN0YXJ0IHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9zdGFydFRpbWUgVGhlIHVuaXggc3RhcnQgZGF0ZSBvZiB0aGUgZnVuZGluZyANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nU3RhcnRUaW1lKHVpbnQgX3N0YXJ0VGltZSkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBtYWluIHBhcnRuZXIgdG8gcmV3YXJkIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCBvZiBzaGFyZXMgb3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIFdlaSkgdG8gY2FsY3VsYXRlIHRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGNyZWF0ZQ0KICAgIC8vLyBAcGFyYW0gX2RhdGUgVGhlIHVuaXggZGF0ZSB0byBjb25zaWRlciBmb3IgdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIGNhbGN1bGF0aW9uDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogICAgZnVuY3Rpb24gcmV3YXJkVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfZGF0ZQ0KICAgICAgICApIGV4dGVybmFsOw0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gY2xvc2UgdGhlIGFjdHVhbCBmdW5kaW5nDQogICAgZnVuY3Rpb24gY2xvc2VGdW5kaW5nKCkgaW50ZXJuYWw7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgbWFpbiBwYXJ0bmVyIHRvIHNldCB0aGUgZnVuZGluZyBmdWVsZWQNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKCkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBhYmxlIHRoZSB0cmFuc2ZlciBvZiBEYW8gc2hhcmVzIG9yIGNvbnRyYWN0b3IgdG9rZW5zDQogICAgZnVuY3Rpb24gYWJsZVRyYW5zZmVyKCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBkaXNhYmxlIHRoZSB0cmFuc2ZlciBvZiBEYW8gc2hhcmVzDQogICAgZnVuY3Rpb24gZGlzYWJsZVRyYW5zZmVyKCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjbGllbnQgdG8gYmxvY2sgdGhlIHRyYW5zZmVyIG9mIHNoYXJlcyBmcm9tIGFuZCB0byBhIHNoYXJlIGhvbGRlcg0KICAgIC8vLyBAcGFyYW0gX3NoYXJlSG9sZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBzaGFyZSBob2xkZXINCiAgICAvLy8gQHBhcmFtIF9kZWFkTGluZSBXaGVuIHRoZSBhY2NvdW50IHdpbGwgYmUgdW5ibG9ja2VkDQogICAgZnVuY3Rpb24gYmxvY2tUcmFuc2ZlcihhZGRyZXNzIF9zaGFyZUhvbGRlciwgdWludCBfZGVhZExpbmUpIGV4dGVybmFsOw0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfRnJvbWANCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBhZGRyZXNzIG9mIHRoZSBzZW5kZXINCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIHF1YW50aXR5IG9mIHNoYXJlcyBvciB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tVG8oDQogICAgICAgIGFkZHJlc3MgX2Zyb20sDQogICAgICAgIGFkZHJlc3MgX3RvLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUNCiAgICAgICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sKTsNCg0KICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmANCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIHF1YW50aXR5IG9mIHNoYXJlcyBvciB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpOw0KDQogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfZnJvbWAgb24gdGhlIGNvbmRpdGlvbiBpdCBpcyBhcHByb3ZlZCBieSBgX2Zyb21gDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLCANCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzcGVuZCBgX2Ftb3VudGAgdG9rZW5zIG9uIGl0cyBiZWhhbGYNCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGFwcHJvdmVkIGZvciB0cmFuc2Zlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICBldmVudCBUb2tlbnNDcmVhdGVkKGFkZHJlc3MgaW5kZXhlZCBTZW5kZXIsIGFkZHJlc3MgaW5kZXhlZCBUb2tlbkhvbGRlciwgdWludCBRdWFudGl0eSk7DQogICAgZXZlbnQgRnVuZGluZ1J1bGVzU2V0KGFkZHJlc3MgaW5kZXhlZCBNYWluUGFydG5lciwgdWludCBpbmRleGVkIEZ1bmRpbmdQcm9wb3NhbElkLCB1aW50IGluZGV4ZWQgU3RhcnRUaW1lLCB1aW50IENsb3NpbmdUaW1lKTsNCiAgICBldmVudCBGdW5kaW5nRnVlbGVkKHVpbnQgaW5kZXhlZCBGdW5kaW5nUHJvcG9zYWxJRCwgdWludCBGdW5kZWRBbW91bnQpOw0KICAgIGV2ZW50IFRyYW5zZmVyQWJsZSgpOw0KICAgIGV2ZW50IFRyYW5zZmVyRGlzYWJsZSgpOw0KDQp9ICAgIA0KDQpjb250cmFjdCBQYXNzVG9rZW5NYW5hZ2VyIGlzIFBhc3NUb2tlbk1hbmFnZXJJbnRlcmZhY2Ugew0KICAgIA0KICAgIGZ1bmN0aW9uIFRvdGFsU3VwcGx5KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gdG90YWxTdXBwbHk7DQogICAgfQ0KDQogICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIEZ1bmRlZEFtb3VudCh1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBmdW5kZWRBbW91bnRbX3Byb3Bvc2FsSURdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHByaWNlRGl2aXNvcih1aW50IF9zYWxlRGF0ZSkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICB1aW50IF9kYXRlID0gX3NhbGVEYXRlOw0KICAgICAgICANCiAgICAgICAgaWYgKF9zYWxlRGF0ZSA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSkgX2RhdGUgPSBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWU7DQogICAgICAgIGlmIChfc2FsZURhdGUgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lKSBfZGF0ZSA9IEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWU7DQoNCiAgICAgICAgcmV0dXJuIDEwMCArIDEwMCpGdW5kaW5nUnVsZXNbMF0uaW5mbGF0aW9uUmF0ZSooX2RhdGUgLSBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lKS8oMTAwKjM2NSBkYXlzKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gYWN0dWFsUHJpY2VEaXZpc29yKCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gcHJpY2VEaXZpc29yKG5vdyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZnVuZGluZ01heEFtb3VudChhZGRyZXNzIF9tYWluUGFydG5lcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICANCiAgICAgICAgaWYgKG5vdyA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgbm93IDwgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZQ0KICAgICAgICAgICAgfHwgX21haW5QYXJ0bmVyICE9IEZ1bmRpbmdSdWxlc1swXS5tYWluUGFydG5lcikgew0KICAgICAgICAgICAgcmV0dXJuIDA7ICAgDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gRnVuZGluZ1J1bGVzWzBdLm1heEFtb3VudFRvRnVuZDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBQYXNzVG9rZW5NYW5hZ2VyKA0KICAgICAgICBhZGRyZXNzIF9jcmVhdG9yLA0KICAgICAgICBhZGRyZXNzIF9jbGllbnQsDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudA0KICAgICkgew0KICAgICAgICANCiAgICAgICAgaWYgKF9jcmVhdG9yID09IDAgDQogICAgICAgICAgICB8fCBfY2xpZW50ID09IDAgDQogICAgICAgICAgICB8fCBfY2xpZW50ID09IF9yZWNpcGllbnQgDQogICAgICAgICAgICB8fCBfY2xpZW50ID09IGFkZHJlc3ModGhpcykgDQogICAgICAgICAgICB8fCBfcmVjaXBpZW50ID09IGFkZHJlc3ModGhpcykpIHRocm93Ow0KDQogICAgICAgIGNyZWF0b3IgPSBfY3JlYXRvcjsgDQogICAgICAgIGNsaWVudCA9IF9jbGllbnQ7DQogICAgICAgIHJlY2lwaWVudCA9IF9yZWNpcGllbnQ7DQogICAgICAgIA0KICAgIH0NCiAgIA0KICAgIGZ1bmN0aW9uIGluaXRUb2tlbigNCiAgICAgICAgc3RyaW5nIF90b2tlbk5hbWUsDQogICAgICAgIHN0cmluZyBfdG9rZW5TeW1ib2wsDQogICAgICAgIHVpbnQ4IF90b2tlbkRlY2ltYWxzLA0KICAgICAgICBhZGRyZXNzIF9pbml0aWFsU3VwcGx5UmVjaXBpZW50LA0KICAgICAgICB1aW50MjU2IF9pbml0aWFsU3VwcGx5LA0KICAgICAgICBib29sIF90cmFuc2ZlcmFibGUpIHsNCiAgICAgICAgICAgDQogICAgICAgIGlmIChfaW5pdGlhbFN1cHBseVJlY2lwaWVudCA9PSBhZGRyZXNzKHRoaXMpDQogICAgICAgICAgICB8fCBkZWNpbWFscyAhPSAwDQogICAgICAgICAgICB8fCBtc2cuc2VuZGVyICE9IGNyZWF0b3INCiAgICAgICAgICAgIHx8IHRvdGFsU3VwcGx5ICE9IDApIHRocm93Ow0KICAgICAgICAgICAgDQogICAgICAgIG5hbWUgPSBfdG9rZW5OYW1lOw0KICAgICAgICBzeW1ib2wgPSBfdG9rZW5TeW1ib2w7DQogICAgICAgIGRlY2ltYWxzID0gX3Rva2VuRGVjaW1hbHM7DQogICAgICAgICAgDQogICAgICAgIGlmIChfdHJhbnNmZXJhYmxlKSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSB0cnVlOw0KICAgICAgICAgICAgVHJhbnNmZXJBYmxlKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgIFRyYW5zZmVyRGlzYWJsZSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBiYWxhbmNlc1tfaW5pdGlhbFN1cHBseVJlY2lwaWVudF0gPSBfaW5pdGlhbFN1cHBseTsgDQogICAgICAgIHRvdGFsU3VwcGx5ID0gX2luaXRpYWxTdXBwbHk7DQogICAgICAgIFRva2Vuc0NyZWF0ZWQobXNnLnNlbmRlciwgX2luaXRpYWxTdXBwbHlSZWNpcGllbnQsIF9pbml0aWFsU3VwcGx5KTsNCiAgICAgICAgICAgDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHNldFRva2VuUHJpY2VQcm9wb3NhbCggICAgICAgIA0KICAgICAgICB1aW50IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLCANCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfY2xvc2luZ1RpbWUNCiAgICApIG9ubHlDb250cmFjdG9yIHsNCiAgICAgICAgDQogICAgICAgIGlmIChfY2xvc2luZ1RpbWUgPCBub3cgDQogICAgICAgICAgICB8fCBub3cgPCBGdW5kaW5nUnVsZXNbMV0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBfaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmluZmxhdGlvblJhdGUgPSBfaW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLnN0YXJ0VGltZSA9IG5vdzsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmNsb3NpbmdUaW1lID0gX2Nsb3NpbmdUaW1lOw0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1J1bGVzKA0KICAgICAgICBhZGRyZXNzIF9tYWluUGFydG5lciwNCiAgICAgICAgYm9vbCBfcHVibGljQ3JlYXRpb24sIA0KICAgICAgICB1aW50IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLA0KICAgICAgICB1aW50IF9tYXhBbW91bnRUb0Z1bmQsIA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQNCiAgICApIGV4dGVybmFsIG9ubHlDbGllbnQgew0KDQogICAgICAgIGlmIChub3cgPCBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUNCiAgICAgICAgICAgIHx8IF9tYWluUGFydG5lciA9PSBhZGRyZXNzKHRoaXMpDQogICAgICAgICAgICB8fCBfbWFpblBhcnRuZXIgPT0gY2xpZW50DQogICAgICAgICAgICB8fCAoIV9wdWJsaWNDcmVhdGlvbiAmJiBfbWFpblBhcnRuZXIgPT0gMCkNCiAgICAgICAgICAgIHx8IChfcHVibGljQ3JlYXRpb24gJiYgX21haW5QYXJ0bmVyICE9IDApDQogICAgICAgICAgICB8fCAocmVjaXBpZW50ID09IDAgJiYgX2luaXRpYWxQcmljZU11bHRpcGxpZXIgPT0gMCkNCiAgICAgICAgICAgIHx8IChyZWNpcGllbnQgIT0gMCANCiAgICAgICAgICAgICAgICAmJiAoRnVuZGluZ1J1bGVzWzFdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPT0gMA0KICAgICAgICAgICAgICAgICAgICB8fCBfaW5mbGF0aW9uUmF0ZSA8IEZ1bmRpbmdSdWxlc1sxXS5pbmZsYXRpb25SYXRlDQogICAgICAgICAgICAgICAgICAgIHx8IG5vdyA8IEZ1bmRpbmdSdWxlc1sxXS5zdGFydFRpbWUNCiAgICAgICAgICAgICAgICAgICAgfHwgRnVuZGluZ1J1bGVzWzFdLmNsb3NpbmdUaW1lIDwgbm93ICsgKF9taW51dGVzRnVuZGluZ1BlcmlvZCAqIDEgbWludXRlcykpKQ0KICAgICAgICAgICAgfHwgX21heEFtb3VudFRvRnVuZCA9PSAwDQogICAgICAgICAgICB8fCBfbWludXRlc0Z1bmRpbmdQZXJpb2QgPT0gMA0KICAgICAgICAgICAgKSB0aHJvdzsNCg0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lID0gbm93Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUgPSBub3cgKyBfbWludXRlc0Z1bmRpbmdQZXJpb2QgKiAxIG1pbnV0ZXM7DQogICAgICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLm1haW5QYXJ0bmVyID0gX21haW5QYXJ0bmVyOw0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0ucHVibGljQ3JlYXRpb24gPSBfcHVibGljQ3JlYXRpb247DQogICAgICAgIA0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIEZ1bmRpbmdSdWxlc1swXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyID0gX2luaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIGVsc2UgRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBGdW5kaW5nUnVsZXNbMV0uaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgDQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCkgRnVuZGluZ1J1bGVzWzBdLmluZmxhdGlvblJhdGUgPSBfaW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgZWxzZSBGdW5kaW5nUnVsZXNbMF0uaW5mbGF0aW9uUmF0ZSA9IEZ1bmRpbmdSdWxlc1sxXS5pbmZsYXRpb25SYXRlOw0KICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCA9IDA7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5tYXhBbW91bnRUb0Z1bmQgPSBfbWF4QW1vdW50VG9GdW5kOw0KDQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5wcm9wb3NhbElEID0gX3Byb3Bvc2FsSUQ7DQoNCiAgICAgICAgRnVuZGluZ1J1bGVzU2V0KF9tYWluUGFydG5lciwgX3Byb3Bvc2FsSUQsIEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUsIEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSk7DQogICAgICAgICAgICANCiAgICB9IA0KICAgIA0KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQsDQogICAgICAgIHVpbnQgX3NhbGVEYXRlDQogICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCg0KICAgICAgICBpZiAobm93ID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lDQogICAgICAgICAgICB8fCBub3cgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lDQogICAgICAgICAgICB8fF9zYWxlRGF0ZSA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgX3NhbGVEYXRlIDwgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZQ0KICAgICAgICAgICAgfHwgRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCArIF9hbW91bnQgPiBGdW5kaW5nUnVsZXNbMF0ubWF4QW1vdW50VG9GdW5kKSByZXR1cm47DQoNCiAgICAgICAgdWludCBfYSA9IF9hbW91bnQqRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIHVpbnQgX211bHRpcGxpZXIgPSAxMDAqX2E7DQogICAgICAgIHVpbnQgX3F1YW50aXR5ID0gX211bHRpcGxpZXIvcHJpY2VEaXZpc29yKF9zYWxlRGF0ZSk7DQogICAgICAgIGlmIChfYS9fYW1vdW50ICE9IEZ1bmRpbmdSdWxlc1swXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyDQogICAgICAgICAgICB8fCBfbXVsdGlwbGllci8xMDAgIT0gX2ENCiAgICAgICAgICAgIHx8IHRvdGFsU3VwcGx5ICsgX3F1YW50aXR5IDw9IHRvdGFsU3VwcGx5IA0KICAgICAgICAgICAgfHwgdG90YWxTdXBwbHkgKyBfcXVhbnRpdHkgPD0gX3F1YW50aXR5KSByZXR1cm47DQoNCiAgICAgICAgYmFsYW5jZXNbX3JlY2lwaWVudF0gKz0gX3F1YW50aXR5Ow0KICAgICAgICB0b3RhbFN1cHBseSArPSBfcXVhbnRpdHk7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQgKz0gX2Ftb3VudDsNCg0KICAgICAgICBUb2tlbnNDcmVhdGVkKG1zZy5zZW5kZXIsIF9yZWNpcGllbnQsIF9xdWFudGl0eSk7DQogICAgICAgIA0KICAgICAgICBpZiAoRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCA9PSBGdW5kaW5nUnVsZXNbMF0ubWF4QW1vdW50VG9GdW5kKSBjbG9zZUZ1bmRpbmcoKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1N0YXJ0VGltZSh1aW50IF9zdGFydFRpbWUpIGV4dGVybmFsIG9ubHlNYWluUGFydG5lciB7DQogICAgICAgIGlmIChub3cgPiBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcmV3YXJkVG9rZW4oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfZGF0ZQ0KICAgICAgICApIGV4dGVybmFsIG9ubHlNYWluUGFydG5lciB7DQoNCiAgICAgICAgdWludCBfc2FsZURhdGU7DQogICAgICAgIGlmIChfZGF0ZSA9PSAwKSBfc2FsZURhdGUgPSBub3c7IGVsc2UgX3NhbGVEYXRlID0gX2RhdGU7DQoNCiAgICAgICAgaWYgKCFjcmVhdGVUb2tlbihfcmVjaXBpZW50LCBfYW1vdW50LCBfc2FsZURhdGUpKSB0aHJvdzsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsb3NlRnVuZGluZygpIGludGVybmFsIHsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwKSBmdW5kZWRBbW91bnRbRnVuZGluZ1J1bGVzWzBdLnByb3Bvc2FsSURdID0gRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudDsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lID0gbm93Ow0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKCkgZXh0ZXJuYWwgb25seU1haW5QYXJ0bmVyIHsNCiAgICAgICAgaWYgKG5vdyA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSkgdGhyb3c7DQogICAgICAgIGNsb3NlRnVuZGluZygpOw0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIEZ1bmRpbmdGdWVsZWQoRnVuZGluZ1J1bGVzWzBdLnByb3Bvc2FsSUQsIEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhYmxlVHJhbnNmZXIoKSBvbmx5Q2xpZW50IHsNCiAgICAgICAgaWYgKCF0cmFuc2ZlcmFibGUpIHsNCiAgICAgICAgICAgIHRyYW5zZmVyYWJsZSA9IHRydWU7DQogICAgICAgICAgICBUcmFuc2ZlckFibGUoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRpc2FibGVUcmFuc2ZlcigpIG9ubHlDbGllbnQgew0KICAgICAgICBpZiAodHJhbnNmZXJhYmxlKSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgIFRyYW5zZmVyRGlzYWJsZSgpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNmZXIoYWRkcmVzcyBfc2hhcmVIb2xkZXIsIHVpbnQgX2RlYWRMaW5lKSBleHRlcm5hbCBvbmx5Q2xpZW50IG9ubHlEYW8gew0KICAgICAgICBpZiAoX2RlYWRMaW5lID4gYmxvY2tlZERlYWRMaW5lW19zaGFyZUhvbGRlcl0pIHsNCiAgICAgICAgICAgIGJsb2NrZWREZWFkTGluZVtfc2hhcmVIb2xkZXJdID0gX2RlYWRMaW5lOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLA0KICAgICAgICBhZGRyZXNzIF90bywgDQogICAgICAgIHVpbnQyNTYgX3ZhbHVlDQogICAgICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgeyAgDQoNCiAgICAgICAgaWYgKHRyYW5zZmVyYWJsZQ0KICAgICAgICAgICAgJiYgbm93ID4gYmxvY2tlZERlYWRMaW5lW19mcm9tXQ0KICAgICAgICAgICAgJiYgbm93ID4gYmxvY2tlZERlYWRMaW5lW190b10NCiAgICAgICAgICAgICYmIF90byAhPSBhZGRyZXNzKHRoaXMpDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXQ0KICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+PSBfdmFsdWUNCiAgICAgICAgKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHsgIA0KICAgICAgICBpZiAoIXRyYW5zZmVyRnJvbVRvKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKSkgdGhyb3c7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLCANCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyANCiAgICAgICAgDQogICAgICAgIGlmIChhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA8IF92YWx1ZQ0KICAgICAgICAgICAgfHwgIXRyYW5zZmVyRnJvbVRvKF9mcm9tLCBfdG8sIF92YWx1ZSkpIHRocm93Ow0KICAgICAgICAgICAgDQogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQp9ICAgIA0KICANCg0KcHJhZ21hIHNvbGlkaXR5IF4wLjQuMjsNCg0KLyoNCiAqDQogKiBUaGlzIGZpbGUgaXMgcGFydCBvZiBQYXNzIERBTy4NCiAqDQogKiBUaGUgTWFuYWdlciBzbWFydCBjb250cmFjdCBpcyB1c2VkIGZvciB0aGUgbWFuYWdlbWVudCBvZiBhY2NvdW50cyBhbmQgdG9rZW5zLg0KICogQWxsb3dzIHRvIHJlY2VpdmUgb3Igd2l0aGRyYXcgZXRoZXJzIGFuZCB0byBidXkgRGFvIHNoYXJlcy4NCiAqIFRoZSBjb250cmFjdCBkZXJpdmVzIHRvIHRoZSBUb2tlbiBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgbWFuYWdlbWVudCBvZiB0b2tlbnMuDQogKg0KICogUmVjaXBpZW50IGlzIDAgZm9yIHRoZSBEYW8gYWNjb3VudCBtYW5hZ2VyIGFuZCB0aGUgYWRkcmVzcyBvZg0KICogY29udHJhY3RvcidzIHJlY2lwaWVudCBmb3IgdGhlIGNvbnRyYWN0b3JzJ3MgbWFoYWdlcnMuDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IG9mIHRoZSBQYXNzIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbmlzYXRpb24NCmNvbnRyYWN0IFBhc3NNYW5hZ2VySW50ZXJmYWNlIGlzIFBhc3NUb2tlbk1hbmFnZXJJbnRlcmZhY2Ugew0KDQogICAgc3RydWN0IHByb3Bvc2FsIHsNCiAgICAgICAgLy8gQW1vdW50IChpbiB3ZWkpIG9mIHRoZSBwcm9wb3NhbA0KICAgICAgICB1aW50IGFtb3VudDsNCiAgICAgICAgLy8gQSBkZXNjcmlwdGlvbiBvZiB0aGUgcHJvcG9zYWwNCiAgICAgICAgc3RyaW5nIGRlc2NyaXB0aW9uOw0KICAgICAgICAvLyBUaGUgaGFzaCBvZiB0aGUgcHJvcG9zYWwncyBkb2N1bWVudA0KICAgICAgICBieXRlczMyIGhhc2hPZlRoZURvY3VtZW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSB3aGVuIHRoZSBwcm9wb3NhbCB3YXMgY3JlYXRlZA0KICAgICAgICB1aW50IGRhdGVPZlByb3Bvc2FsOw0KICAgICAgICAvLyBUaGUgc3VtIGFtb3VudCAoaW4gd2VpKSBvcmRlcmVkIGZvciB0aGlzIHByb3Bvc2FsIA0KICAgICAgICB1aW50IG9yZGVyQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgICAgIHVpbnQgZGF0ZU9mT3JkZXI7DQogICAgfQ0KICAgICAgICANCiAgICAvLyBQcm9wb3NhbHMgdG8gd29yayBmb3IgdGhlIGNsaWVudA0KICAgIHByb3Bvc2FsW10gcHVibGljIHByb3Bvc2FsczsNCiAgICANCiAgICAvLy8gQGRldiBUaGUgY29uc3RydWN0b3IgZnVuY3Rpb24NCiAgICAvLy8gQHBhcmFtIF9jcmVhdG9yIFRoZSBhZGRyZXNzIG9mIHRoZSBjcmVhdG9yDQogICAgLy8vIEBwYXJhbSBfY2xpZW50IFRoZSBhZGRyZXNzIG9mIHRoZSBEYW8NCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudC4gMCBmb3IgdGhlIERhbw0KICAgIC8vZnVuY3Rpb24gUGFzc01hbmFnZXIoDQogICAgICAgIC8vYWRkcmVzcyBfY3JlYXRvciwNCiAgICAgICAgLy9hZGRyZXNzIF9jbGllbnQsDQogICAgICAgIC8vYWRkcmVzcyBfcmVjaXBpZW50DQogICAgLy8pIFBhc3NUb2tlbk1hbmFnZXIoDQogICAgICAgIC8vX2NyZWF0b3IsDQogICAgICAgIC8vX2NsaWVudCwNCiAgICAgICAgLy9fcmVjaXBpZW50KTsNCg0KICAgIC8vLyBAbm90aWNlIEZhbGxiYWNrIGZ1bmN0aW9uIHRvIGFsbG93IHNlbmRpbmcgZXRoZXJzIHRvIHRoaXMgc21hcnQgY29udHJhY3QNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgcmVjaXBlbnQgYWRkcmVzcw0KICAgIC8vLyBAcGFyYW0gX25ld1JlY2lwaWVudCBUaGUgYWRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICBmdW5jdGlvbiB1cGRhdGVSZWNpcGllbnQoYWRkcmVzcyBfbmV3UmVjaXBpZW50KTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGJ1eSBEYW8gc2hhcmVzIGFjY29yZGluZyB0byB0aGUgZnVuZGluZyBydWxlcyANCiAgICAvLy8gd2l0aCBgbXNnLnNlbmRlcmAgYXMgdGhlIGJlbmVmaWNpYXJ5DQogICAgZnVuY3Rpb24gYnV5U2hhcmVzKCkgcGF5YWJsZTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBidXkgRGFvIHNoYXJlcyBhY2NvcmRpbmcgdG8gdGhlIGZ1bmRpbmcgcnVsZXMgDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBiZW5lZmljaWFyeSBvZiB0aGUgY3JlYXRlZCBzaGFyZXMNCiAgICBmdW5jdGlvbiBidXlTaGFyZXNGb3IoYWRkcmVzcyBfcmVjaXBpZW50KSBwYXlhYmxlOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gbWFrZSBhIHByb3Bvc2FsIHRvIHdvcmsgZm9yIHRoZSBjbGllbnQNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9kZXNjcmlwdGlvbiBTdHJpbmcgZGVzY3JpYmluZyB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9oYXNoT2ZUaGVEb2N1bWVudCBUaGUgaGFzaCBvZiB0aGUgcHJvcG9zYWwgZG9jdW1lbnQNCiAgICAvLy8gQHJldHVybiBUaGUgaW5kZXggb2YgdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBuZXdQcm9wb3NhbCgNCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLCANCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQNCiAgICApIHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNsaWVudCB0byBvcmRlciBhY2NvcmRpbmcgdG8gdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgY29udHJhY3RvciBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IChpbiB3ZWkpIG9mIHRoZSBvcmRlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIG9yZGVyIHdhcyBtYWRlIG9yIG5vdA0KICAgIGZ1bmN0aW9uIG9yZGVyKA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELA0KICAgICAgICB1aW50IF9hbW91bnQNCiAgICApIGV4dGVybmFsIHJldHVybnMgKGJvb2wpIDsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjbGllbnQgdG8gc2VuZCBldGhlcnMgZnJvbSB0aGUgRGFvIG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3MgdG8gc2VuZCB0bw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IChpbiB3ZWkpIHRvIHNlbmQNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBzZW5kVG8oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudA0KICAgICkgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBhbGxvdyBjb250cmFjdG9ycyB0byB3aXRoZHJhdyBldGhlcnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSB0byB3aXRoZHJhdw0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgX2Ftb3VudCk7DQogICAgDQogICAgZXZlbnQgUHJvcG9zYWxBZGRlZCh1aW50IGluZGV4ZWQgUHJvcG9zYWxJRCwgdWludCBBbW91bnQsIHN0cmluZyBEZXNjcmlwdGlvbik7DQogICAgZXZlbnQgT3JkZXIodWludCBpbmRleGVkIFByb3Bvc2FsSUQsIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBXaXRoZGF3YWwoYWRkcmVzcyBpbmRleGVkIFJlY2lwaWVudCwgdWludCBBbW91bnQpOw0KDQp9ICAgIA0KDQpjb250cmFjdCBQYXNzTWFuYWdlciBpcyBQYXNzTWFuYWdlckludGVyZmFjZSwgUGFzc1Rva2VuTWFuYWdlciB7DQoNCiAgICBmdW5jdGlvbiBQYXNzTWFuYWdlcigNCiAgICAgICAgYWRkcmVzcyBfY3JlYXRvciwNCiAgICAgICAgYWRkcmVzcyBfY2xpZW50LA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQNCiAgICApIFBhc3NUb2tlbk1hbmFnZXIoDQogICAgICAgIF9jcmVhdG9yLA0KICAgICAgICBfY2xpZW50LA0KICAgICAgICBfcmVjaXBpZW50DQogICAgICAgICkgew0KICAgICAgICBwcm9wb3NhbHMubGVuZ3RoID0gMTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHt9DQoNCiAgICBmdW5jdGlvbiB1cGRhdGVSZWNpcGllbnQoYWRkcmVzcyBfbmV3UmVjaXBpZW50KSBvbmx5Q29udHJhY3RvciB7DQoNCiAgICAgICAgaWYgKF9uZXdSZWNpcGllbnQgPT0gMCANCiAgICAgICAgICAgIHx8IF9uZXdSZWNpcGllbnQgPT0gY2xpZW50KSB0aHJvdzsNCg0KICAgICAgICByZWNpcGllbnQgPSBfbmV3UmVjaXBpZW50Ow0KICAgIH0gDQoNCiAgICBmdW5jdGlvbiBidXlTaGFyZXMoKSBwYXlhYmxlIHsNCiAgICAgICAgYnV5U2hhcmVzRm9yKG1zZy5zZW5kZXIpOw0KICAgIH0gDQogICAgDQogICAgZnVuY3Rpb24gYnV5U2hhcmVzRm9yKGFkZHJlc3MgX3JlY2lwaWVudCkgcGF5YWJsZSBvbmx5RGFvIHsNCiAgICAgICAgDQogICAgICAgIGlmICghRnVuZGluZ1J1bGVzWzBdLnB1YmxpY0NyZWF0aW9uIA0KICAgICAgICAgICAgfHwgIWNyZWF0ZVRva2VuKF9yZWNpcGllbnQsIG1zZy52YWx1ZSwgbm93KSkgdGhyb3c7DQoNCiAgICB9DQogICANCiAgICBmdW5jdGlvbiBuZXdQcm9wb3NhbCgNCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLCANCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQNCiAgICApIG9ubHlDb250cmFjdG9yIHJldHVybnMgKHVpbnQpIHsNCg0KICAgICAgICB1aW50IF9wcm9wb3NhbElEID0gcHJvcG9zYWxzLmxlbmd0aCsrOw0KICAgICAgICBwcm9wb3NhbCBjID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBjLmFtb3VudCA9IF9hbW91bnQ7DQogICAgICAgIGMuZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIGMuaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7IA0KICAgICAgICBjLmRhdGVPZlByb3Bvc2FsID0gbm93Ow0KICAgICAgICANCiAgICAgICAgUHJvcG9zYWxBZGRlZChfcHJvcG9zYWxJRCwgYy5hbW91bnQsIGMuZGVzY3JpcHRpb24pOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIF9wcm9wb3NhbElEOw0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gb3JkZXIoDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsDQogICAgICAgIHVpbnQgX29yZGVyQW1vdW50DQogICAgKSBleHRlcm5hbCBvbmx5Q2xpZW50IHJldHVybnMgKGJvb2wpIHsNCiAgICANCiAgICAgICAgcHJvcG9zYWwgYyA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQogICAgICAgIA0KICAgICAgICB1aW50IF9zdW0gPSBjLm9yZGVyQW1vdW50ICsgX29yZGVyQW1vdW50Ow0KICAgICAgICBpZiAoX3N1bSA+IGMuYW1vdW50DQogICAgICAgICAgICB8fCBfc3VtIDwgYy5vcmRlckFtb3VudA0KICAgICAgICAgICAgfHwgX3N1bSA8IF9vcmRlckFtb3VudCkgcmV0dXJuOyANCg0KICAgICAgICBjLm9yZGVyQW1vdW50ID0gX3N1bTsNCiAgICAgICAgYy5kYXRlT2ZPcmRlciA9IG5vdzsNCiAgICAgICAgDQogICAgICAgIE9yZGVyKF9wcm9wb3NhbElELCBfb3JkZXJBbW91bnQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZW5kVG8oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwNCiAgICAgICAgdWludCBfYW1vdW50DQogICAgKSBleHRlcm5hbCBvbmx5Q2xpZW50IG9ubHlEYW8gcmV0dXJucyAoYm9vbCkgew0KICAgIA0KICAgICAgICBpZiAoX3JlY2lwaWVudC5zZW5kKF9hbW91bnQpKSByZXR1cm4gdHJ1ZTsNCiAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7DQoNCiAgICB9DQogICANCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIG9ubHlDb250cmFjdG9yIHsNCiAgICAgICAgaWYgKCFyZWNpcGllbnQuc2VuZChfYW1vdW50KSkgdGhyb3c7DQogICAgICAgIFdpdGhkYXdhbChyZWNpcGllbnQsIF9hbW91bnQpOw0KICAgIH0NCiAgICANCn0gICAgDQoNCmNvbnRyYWN0IFBhc3NNYW5hZ2VyQ3JlYXRvciB7DQogICAgZXZlbnQgTmV3UGFzc01hbmFnZXIoYWRkcmVzcyBDcmVhdG9yLCBhZGRyZXNzIENsaWVudCwgYWRkcmVzcyBSZWNpcGllbnQsIGFkZHJlc3MgUGFzc01hbmFnZXIpOw0KICAgIGZ1bmN0aW9uIGNyZWF0ZU1hbmFnZXIoDQogICAgICAgIGFkZHJlc3MgX2NsaWVudCwNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50DQogICAgICAgICkgcmV0dXJucyAoUGFzc01hbmFnZXIpIHsNCiAgICAgICAgUGFzc01hbmFnZXIgX3Bhc3NNYW5hZ2VyID0gbmV3IFBhc3NNYW5hZ2VyKA0KICAgICAgICAgICAgbXNnLnNlbmRlciwNCiAgICAgICAgICAgIF9jbGllbnQsDQogICAgICAgICAgICBfcmVjaXBpZW50DQogICAgICAgICk7DQogICAgICAgIE5ld1Bhc3NNYW5hZ2VyKG1zZy5zZW5kZXIsIF9jbGllbnQsIF9yZWNpcGllbnQsIF9wYXNzTWFuYWdlcik7DQogICAgICAgIHJldHVybiBfcGFzc01hbmFnZXI7DQogICAgfQ0KfQ0KDQpwcmFnbWEgc29saWRpdHkgXjAuNC4yOw0KDQovKg0KICoNCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIHRoZSBEQU8uDQogKg0KICogU21hcnQgY29udHJhY3QgdXNlZCBmb3IgdGhlIGZ1bmRpbmcgb2YgUGFzcyBEYW8uDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBGdW5kaW5nIHNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgUGFzcyBEZWNlbnRyYWxpemVkIEF1dG9ub21vdXMgT3JnYW5pc2F0aW9uDQpjb250cmFjdCBQYXNzRnVuZGluZ0ludGVyZmFjZSB7DQoNCiAgICBzdHJ1Y3QgUGFydG5lciB7DQogICAgICAgIC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBwYXJ0bmVyDQogICAgICAgIGFkZHJlc3MgcGFydG5lckFkZHJlc3M7IA0KICAgICAgICAvLyBUaGUgYW1vdW50IChpbiB3ZWkpIHRoYXQgdGhlIHBhcnRuZXIgd2lzaCB0byBmdW5kDQogICAgICAgIHVpbnQgcHJlc2FsZUFtb3VudDsNCiAgICAgICAgLy8gVGhlIHVuaXggdGltZXN0YW1wIGRlbm90aW5nIHRoZSBhdmVyYWdlIGRhdGUgb2YgdGhlIHByZXNhbGUgb2YgdGhlIHBhcnRuZXIgDQogICAgICAgIHVpbnQgcHJlc2FsZURhdGU7DQogICAgICAgIC8vIFRoZSBmdW5kaW5nIGFtb3VudCAoaW4gd2VpKSBhY2NvcmRpbmcgdG8gdGhlIHNldCBsaW1pdHMNCiAgICAgICAgdWludCBmdW5kaW5nQW1vdW50TGltaXQ7DQogICAgICAgIC8vIFRoZSBhbW91bnQgKGluIHdlaSkgdGhhdCB0aGUgcGFydG5lciBmdW5kZWQgdG8gdGhlIERhbw0KICAgICAgICB1aW50IGZ1bmRlZEFtb3VudDsNCiAgICAgICAgLy8gVHJ1ZSBpZiB0aGUgcGFydG5lciBjYW4gZnVuZCB0aGUgZGFvDQogICAgICAgIGJvb2wgdmFsaWQ7DQogICAgfQ0KDQogICAgLy8gQWRkcmVzcyBvZiB0aGUgY3JlYXRvciBvZiB0aGlzIGNvbnRyYWN0DQogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsNCiAgICAvLyBUaGUgbWFuYWdlciBzbWFydCBjb250cmFjdCB0byBmdW5kDQogICAgUGFzc01hbmFnZXIgcHVibGljIERhb01hbmFnZXI7DQogICAgLy8gVHJ1ZSBpZiBjb250cmFjdG9yIHRva2VuIGNyZWF0aW9uDQogICAgYm9vbCB0b2tlbkNyZWF0aW9uOyAgICAgICAgICAgIA0KICAgIC8vIFRoZSBtYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IGZvciB0aGUgcmV3YXJkIG9mIGNvbnRyYWN0b3IgdG9rZW5zDQogICAgUGFzc01hbmFnZXIgcHVibGljIGNvbnRyYWN0b3JNYW5hZ2VyOw0KICAgIC8vIE1pbmltdW0gYW1vdW50IChpbiB3ZWkpIHRvIGZ1bmQNCiAgICB1aW50IHB1YmxpYyBtaW5GdW5kaW5nQW1vdW50Ow0KICAgIC8vIE1pbmltdW0gYW1vdW50IChpbiB3ZWkpIHRoYXQgcGFydG5lcnMgY2FuIHNlbmQgdG8gdGhpcyBzbWFydCBjb250cmFjdA0KICAgIHVpbnQgcHVibGljIG1pblByZXNhbGVBbW91bnQ7DQogICAgLy8gTWF4aW11bSBhbW91bnQgKGluIHdlaSkgdGhhdCBwYXJ0bmVycyBjYW4gc2VuZCB0byB0aGlzIHNtYXJ0IGNvbnRyYWN0DQogICAgdWludCBwdWJsaWMgbWF4UHJlc2FsZUFtb3VudDsNCiAgICAvLyBUaGUgdW5peCBzdGFydCB0aW1lIG9mIHRoZSBwcmVzYWxlDQogICAgdWludCBwdWJsaWMgc3RhcnRUaW1lOw0KICAgIC8vIFRoZSB1bml4IGNsb3NpbmcgdGltZSBvZiB0aGUgZnVuZGluZw0KICAgIHVpbnQgcHVibGljIGNsb3NpbmdUaW1lOw0KICAgIC8vLyBUaGUgYW1vdW50IChpbiB3ZWkpIGJlbG93IHRoaXMgbGltaXQgY2FuIGZ1bmQgdGhlIGRhbw0KICAgIHVpbnQgbWluQW1vdW50TGltaXQ7DQogICAgLy8vIE1heGltdW0gYW1vdW50IChpbiB3ZWkpIGEgcGFydG5lciBjYW4gZnVuZA0KICAgIHVpbnQgbWF4QW1vdW50TGltaXQ7IA0KICAgIC8vLyBUaGUgcGFydG5lciBjYW4gZnVuZCBiZWxvdyB0aGUgbWluaW11bSBhbW91bnQgbGltaXQgb3IgYSBzZXQgcGVyY2VudGFnZSBvZiBoaXMgZXRoZXIgYmFsYW5jZSANCiAgICB1aW50IGRpdmlzb3JCYWxhbmNlTGltaXQ7DQogICAgLy8vIFRoZSBwYXJ0bmVyIGNhbiBmdW5kIGJlbG93IHRoZSBtaW5pbXVtIGFtb3VudCBsaW1pdCBvciBhIHNldCBwZXJjZW50YWdlIG9mIGhpcyBzaGFyZXMgYmFsYW5jZSBpbiB0aGUgRGFvDQogICAgdWludCBtdWx0aXBsaWVyU2hhcmVzTGltaXQ7DQogICAgLy8vIFRoZSBwYXJ0bmVyIGNhbiBmdW5kIGJlbG93IHRoZSBtaW5pbXVtIGFtb3VudCBsaW1pdCBvciBhIHNldCBwZXJjZW50YWdlIG9mIGhpcyBzaGFyZXMgYmFsYW5jZSBpbiB0aGUgRGFvIA0KICAgIHVpbnQgZGl2aXNvclNoYXJlc0xpbWl0Ow0KICAgIC8vIFRydWUgaWYgdGhlIGFtb3VudCBhbmQgZGl2aXNvciBiYWxhbmNlIGxpbWl0cyBmb3IgdGhlIGZ1bmRpbmcgYXJlIHNldA0KICAgIGJvb2wgcHVibGljIGxpbWl0U2V0Ow0KICAgIC8vIFRydWUgaWYgYWxsIHRoZSBwYXJ0bmVycyBhcmUgc2V0IGJ5IHRoZSBjcmVhdG9yIGFuZCB0aGUgZnVuZGluZyBjYW4gYmUgY29tcGxldGVkIA0KICAgIGJvb2wgcHVibGljIGFsbFNldDsNCiAgICAvLyBBcnJheSBvZiBwYXJ0bmVycyB3aG8gd2lzaCB0byBmdW5kIHRoZSBkYW8NCiAgICBQYXJ0bmVyW10gcHVibGljIHBhcnRuZXJzOw0KICAgIC8vIE1hcCB3aXRoIHRoZSBpbmRleGVzIG9mIHRoZSBwYXJ0bmVycw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIHBhcnRuZXJJRDsgDQogICAgLy8gVGhlIHRvdGFsIGZ1bmRlZCBhbW91bnQgKGluIHdlaSkNCiAgICB1aW50IHB1YmxpYyB0b3RhbEZ1bmRlZDsgDQogICAgLy8gVGhlIGNhbGN1bGF0ZWQgc3VtIG9mIGZ1bmRpbmcgYW1vdXQgbGltaXRzIChpbiB3ZWkpIGFjY29yZGluZyB0byB0aGUgc2V0IGxpbWl0cw0KICAgIHVpbnQgc3VtT2ZGdW5kaW5nQW1vdW50TGltaXRzOw0KICAgIA0KICAgIC8vIFRvIGFsbG93IHRoZSBjcmVhdG9yIHRvIHBhdXNlIGR1cmluZyB0aGUgcHJlc2FsZQ0KICAgIHVpbnQgcHVibGljIHBhdXNlQ2xvc2luZ1RpbWU7DQogICAgLy8gVG8gYWxsb3cgdGhlIGNyZWF0b3IgdG8gYWJvcnQgdGhlIGZ1bmRpbmcgYmVmb3JlIHRoZSBjbG9zaW5nIHRpbWUNCiAgICBib29sIElzZnVuZGluZ0Fib3J0ZWQ7DQogICAgDQogICAgLy8gVG8gYWxsb3cgdGhlIHNldCBvZiBwYXJ0bmVycyBpbiBzZXZlcmFsIHRpbWVzDQogICAgdWludCBzZXRGcm9tUGFydG5lcjsNCiAgICAvLyBUbyBhbGxvdyB0aGUgcmVmdW5kIGZvciBwYXJ0bmVycyBpbiBzZXZlcmFsIHRpbWVzDQogICAgdWludCByZWZ1bmRGcm9tUGFydG5lcjsNCg0KICAgIC8vIFRoZSBtYW5hZ2VyIG9mIHRoaXMgZnVuZGluZyBpcyB0aGUgY3JlYXRvciBvZiB0aGlzIGNvbnRyYWN0DQogICAgbW9kaWZpZXIgb25seUNyZWF0b3Ige2lmIChtc2cuc2VuZGVyICE9IGNyZWF0b3IpIHRocm93OyBfIDt9DQoNCiAgICAvLy8gQGRldiBDb25zdHJ1Y3RvciBmdW5jdGlvbg0KICAgIC8vLyBAcGFyYW0gX2NyZWF0b3IgVGhlIGNyZWF0b3Igb2YgdGhlIHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEBwYXJhbSBfRGFvTWFuYWdlciBUaGUgRGFvIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAvLy8gZm9yIHRoZSByZXdhcmQgb2YgdG9rZW5zIChub3QgbWFuZGF0b3J5KQ0KICAgIC8vLyBAcGFyYW0gX21pbkFtb3VudCBNaW5pbXVtIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgZnVuZGluZyB0byBiZSBmdWVsZWQgDQogICAgLy8vIEBwYXJhbSBfc3RhcnRUaW1lIFRoZSB1bml4IHN0YXJ0IHRpbWUgb2YgdGhlIHByZXNhbGUNCiAgICAvLy8gQHBhcmFtIF9jbG9zaW5nVGltZSBUaGUgdW5peCBjbG9zaW5nIHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAvL2Z1bmN0aW9uIFBhc3NGdW5kaW5nICgNCiAgICAgICAgLy9hZGRyZXNzIF9jcmVhdG9yLA0KICAgICAgICAvL2FkZHJlc3MgX0Rhb01hbmFnZXIsDQogICAgICAgIC8vdWludCBfbWluQW1vdW50LA0KICAgICAgICAvL3VpbnQgX3N0YXJ0VGltZSwNCiAgICAgICAgLy91aW50IF9jbG9zaW5nVGltZQ0KICAgIC8vKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNyZWF0b3IgdG8gc2V0IHRoZSBjb250cmFjdG9yIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAvLy8gQHBhcmFtIF9jb250cmFjdG9yTWFuYWdlciBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3RvciBtYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0DQogICAgZnVuY3Rpb24gU2V0Q29udHJhY3Rvck1hbmFnZXIoYWRkcmVzcyBfY29udHJhY3Rvck1hbmFnZXIpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIGNyZWF0b3IgdG8gc2V0IHRoZSBwcmVzYWxlIGxpbWl0cw0KICAgIC8vLyBAcGFyYW0gX21pblByZXNhbGVBbW91bnQgTWluaW11bSBhbW91bnQgKGluIHdlaSkgdGhhdCBwYXJ0bmVycyBjYW4gc2VuZA0KICAgIC8vLyBAcGFyYW0gX21heFByZXNhbGVBbW91bnQgTWF4aW11bSBhbW91bnQgKGluIHdlaSkgdGhhdCBwYXJ0bmVycyBjYW4gc2VuZA0KICAgIGZ1bmN0aW9uIFNldFByZXNhbGVBbW91bnRMaW1pdHMoDQogICAgICAgIHVpbnQgX21pblByZXNhbGVBbW91bnQsDQogICAgICAgIHVpbnQgX21heFByZXNhbGVBbW91bnQNCiAgICAgICAgKTsNCg0KICAgIC8vLyBAZGV2IEZhbGxiYWNrIGZ1bmN0aW9uDQogICAgZnVuY3Rpb24gKCkgcGF5YWJsZTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHBhcnRpY2lwYXRlIGluIHRoZSBwcmVzYWxlIG9mIHRoZSBmdW5kaW5nDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgcHJlc2FsZSB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBwcmVzYWxlKCkgcGF5YWJsZSByZXR1cm5zIChib29sKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjcmVhdG9yIHRvIHNldCBhZGRyZXNzZXMgdGhhdCBjYW4gZnVuZCB0aGUgZGFvDQogICAgLy8vIEBwYXJhbSBfdmFsaWQgVHJ1ZSBpZiB0aGUgYWRkcmVzcyBjYW4gZnVuZCB0aGUgRGFvDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgaW5kZXggb2YgdGhlIGZpcnN0IHBhcnRuZXIgdG8gc2V0DQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IHBhcnRuZXIgdG8gc2V0DQogICAgZnVuY3Rpb24gc2V0UGFydG5lcnMoDQogICAgICAgICAgICBib29sIF92YWxpZCwNCiAgICAgICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgICAgICB1aW50IF90bw0KICAgICAgICApOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY3JlYXRvciB0byBzZXQgdGhlIGFkZHJlc3NlcyBvZiBEYW8gc2hhcmUgaG9sZGVycw0KICAgIC8vLyBAcGFyYW0gX3ZhbGlkIFRydWUgaWYgdGhlIGFkZHJlc3MgY2FuIGZ1bmQgdGhlIERhbw0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGluZGV4IG9mIHRoZSBmaXJzdCBwYXJ0bmVyIHRvIHNldA0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBwYXJ0bmVyIHRvIHNldA0KICAgIGZ1bmN0aW9uIHNldFNoYXJlSG9sZGVycygNCiAgICAgICAgICAgIGJvb2wgX3ZhbGlkLA0KICAgICAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgICAgIHVpbnQgX3RvDQogICAgICAgICk7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIGNyZWF0b3IgdG8gYWJvcnQgdGhlIGZ1bmRpbmcgYmVmb3JlIHRoZSBjbG9zaW5nIHRpbWUNCiAgICBmdW5jdGlvbiBhYm9ydEZ1bmRpbmcoKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiBUbyBhbGxvdyB0aGUgY3JlYXRvciB0byBwYXVzZSBkdXJpbmcgdGhlIHByZXNhbGUNCiAgICBmdW5jdGlvbiBwYXVzZSh1aW50IF9wYXVzZUNsb3NpbmdUaW1lKSB7DQogICAgICAgIHBhdXNlQ2xvc2luZ1RpbWUgPSBfcGF1c2VDbG9zaW5nVGltZTsNCiAgICB9DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjcmVhdG9yIHRvIHNldCB0aGUgZnVuZGluZyBsaW1pdHMgZm9yIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfbWluQW1vdW50TGltaXQgVGhlIGFtb3VudCBiZWxvdyB0aGlzIGxpbWl0IChpbiB3ZWkpIGNhbiBmdW5kIHRoZSBkYW8NCiAgICAvLy8gQHBhcmFtIF9tYXhBbW91bnRMaW1pdCBNYXhpbXVtIGFtb3VudCAoaW4gd2VpKSBhIHBhcnRuZXIgY2FuIGZ1bmQNCiAgICAvLy8gQHBhcmFtIF9kaXZpc29yQmFsYW5jZUxpbWl0IFRoZSBjcmVhdG9yIGNhbiBzZXQgYSBsaW1pdCBpbiBwZXJjZW50YWdlIG9mIEV0aCBiYWxhbmNlIChub3QgbWFuZGF0b3J5KQ0KICAgIC8vLyBAcGFyYW0gX211bHRpcGxpZXJTaGFyZXNMaW1pdCBUaGUgY3JlYXRvciBjYW4gc2V0IGEgbGltaXQgaW4gcGVyY2VudGFnZSBvZiBzaGFyZXMgYmFsYW5jZSBpbiB0aGUgRGFvIChub3QgbWFuZGF0b3J5KQ0KICAgIC8vLyBAcGFyYW0gX2Rpdmlzb3JTaGFyZXNMaW1pdCBUaGUgY3JlYXRvciBjYW4gc2V0IGEgbGltaXQgaW4gcGVyY2VudGFnZSBvZiBzaGFyZXMgYmFsYW5jZSBpbiB0aGUgRGFvIChub3QgbWFuZGF0b3J5KSANCiAgICBmdW5jdGlvbiBzZXRMaW1pdHMoDQogICAgICAgICAgICB1aW50IF9taW5BbW91bnRMaW1pdCwNCiAgICAgICAgICAgIHVpbnQgX21heEFtb3VudExpbWl0LCANCiAgICAgICAgICAgIHVpbnQgX2Rpdmlzb3JCYWxhbmNlTGltaXQsDQogICAgICAgICAgICB1aW50IF9tdWx0aXBsaWVyU2hhcmVzTGltaXQsDQogICAgICAgICAgICB1aW50IF9kaXZpc29yU2hhcmVzTGltaXQNCiAgICApOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCB0byBzZXQgdGhlIGZ1bmRpbmcgbGltaXRzIGZvciBwYXJ0bmVycw0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBwYXJ0bmVyIHRvIHNldA0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIHNldCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nKHVpbnQgX3RvKSByZXR1cm5zIChib29sIF9zdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIGZvciB0aGUgZnVuZGluZyBvZiB0aGUgRGFvIGJ5IGEgZ3JvdXAgb2YgcGFydG5lcnMNCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBpbmRleCBvZiB0aGUgZmlyc3QgcGFydG5lcg0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBwYXJ0bmVyDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgRGFvIHdhcyBmdW5kZWQgb3Igbm90DQogICAgZnVuY3Rpb24gZnVuZERhb0ZvcigNCiAgICAgICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgICAgICB1aW50IF90bw0KICAgICAgICApIHJldHVybnMgKGJvb2wpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGZ1bmQgdGhlIERhbyB3aXRoICdtc2cuc2VuZGVyJyBhcyAnYmVuZWZpY2lhcnknDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgRGFvIHdhcyBmdW5kZWQgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGZ1bmREYW8oKSByZXR1cm5zIChib29sKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byByZWZ1bmQgZm9yIGEgcGFydG5lcg0KICAgIC8vLyBAcGFyYW0gX3BhcnRuZXJJRCBUaGUgaW5kZXggb2YgdGhlIHBhcnRuZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSByZWZ1bmQgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHJlZnVuZEZvcih1aW50IF9wYXJ0bmVySUQpIGludGVybmFsIHJldHVybnMgKGJvb2wpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gcmVmdW5kIGZvciB2YWxpZCBwYXJ0bmVycyBiZWZvcmUgdGhlIGNsb3NpbmcgdGltZQ0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBwYXJ0bmVyDQogICAgZnVuY3Rpb24gcmVmdW5kRm9yVmFsaWRQYXJ0bmVycyh1aW50IF90byk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byByZWZ1bmQgZm9yIGEgZ3JvdXAgb2YgcGFydG5lcnMgYWZ0ZXIgdGhlIGNsb3NpbmcgdGltZQ0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGluZGV4IG9mIHRoZSBmaXJzdCBwYXJ0bmVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IHBhcnRuZXINCiAgICBmdW5jdGlvbiByZWZ1bmRGb3JBbGwoDQogICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgIHVpbnQgX3RvKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHJlZnVuZCBhZnRlciB0aGUgY2xvc2luZyB0aW1lIHdpdGggJ21zZy5zZW5kZXInIGFzICdiZW5lZmljaWFyeScNCiAgICBmdW5jdGlvbiByZWZ1bmQoKTsNCg0KICAgIC8vLyBAcGFyYW0gX21pbkFtb3VudExpbWl0IFRoZSBhbW91bnQgKGluIHdlaSkgYmVsb3cgdGhpcyBsaW1pdCBjYW4gZnVuZCB0aGUgZGFvDQogICAgLy8vIEBwYXJhbSBfbWF4QW1vdW50TGltaXQgTWF4aW11bSBhbW91bnQgKGluIHdlaSkgYSBwYXJ0bmVyIGNhbiBmdW5kDQogICAgLy8vIEBwYXJhbSBfZGl2aXNvckJhbGFuY2VMaW1pdCBUaGUgcGFydG5lciBjYW4gZnVuZCANCiAgICAvLy8gb25seSB1bmRlciBhIGRlZmluZWQgcGVyY2VudGFnZSBvZiBoaXMgZXRoZXIgYmFsYW5jZQ0KICAgIC8vLyBAcGFyYW0gX211bHRpcGxpZXJTaGFyZXNMaW1pdCBUaGUgcGFydG5lciBjYW4gZnVuZCANCiAgICAvLy8gb25seSB1bmRlciBhIGRlZmluZWQgcGVyY2VudGFnZSBvZiBoaXMgc2hhcmVzIGJhbGFuY2UgaW4gdGhlIERhbyANCiAgICAvLy8gQHBhcmFtIF9kaXZpc29yU2hhcmVzTGltaXQgVGhlIHBhcnRuZXIgY2FuIGZ1bmQgDQogICAgLy8vIG9ubHkgdW5kZXIgYSBkZWZpbmVkIHBlcmNlbnRhZ2Ugb2YgaGlzIHNoYXJlcyBiYWxhbmNlIGluIHRoZSBEYW8gDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgaW5kZXggb2YgdGhlIGZpcnN0IHBhcnRuZXINCiAgICAvLy8gQHBhcmFtIF90byBUaGUgaW5kZXggb2YgdGhlIGxhc3QgcGFydG5lcg0KICAgIC8vLyBAcmV0dXJuIFRoZSByZXN1bHQgb2YgdGhlIGZ1bmRpbmcgcHJvY2VkdXJlIChpbiB3ZWkpIGF0IHByZXNlbnQgdGltZQ0KICAgIGZ1bmN0aW9uIGVzdGltYXRlZEZ1bmRpbmdBbW91bnQoDQogICAgICAgIHVpbnQgX21pbkFtb3VudExpbWl0LA0KICAgICAgICB1aW50IF9tYXhBbW91bnRMaW1pdCwgDQogICAgICAgIHVpbnQgX2Rpdmlzb3JCYWxhbmNlTGltaXQsDQogICAgICAgIHVpbnQgX211bHRpcGxpZXJTaGFyZXNMaW1pdCwNCiAgICAgICAgdWludCBfZGl2aXNvclNoYXJlc0xpbWl0LA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bw0KICAgICAgICApIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBwYXJhbSBfaW5kZXggVGhlIGluZGV4IG9mIHRoZSBwYXJ0bmVyDQogICAgLy8vIEBwYXJhbSBfbWluQW1vdW50TGltaXQgVGhlIGFtb3VudCAoaW4gd2VpKSBiZWxvdyB0aGlzIGxpbWl0IGNhbiBmdW5kIHRoZSBkYW8NCiAgICAvLy8gQHBhcmFtIF9tYXhBbW91bnRMaW1pdCBNYXhpbXVtIGFtb3VudCAoaW4gd2VpKSBhIHBhcnRuZXIgY2FuIGZ1bmQNCiAgICAvLy8gQHBhcmFtIF9kaXZpc29yQmFsYW5jZUxpbWl0IFRoZSBwYXJ0bmVyIGNhbiBmdW5kIA0KICAgIC8vLyBvbmx5IHVuZGVyIGEgZGVmaW5lZCBwZXJjZW50YWdlIG9mIGhpcyBldGhlciBiYWxhbmNlIA0KICAgIC8vLyBAcGFyYW0gX211bHRpcGxpZXJTaGFyZXNMaW1pdCBUaGUgcGFydG5lciBjYW4gZnVuZCANCiAgICAvLy8gb25seSB1bmRlciBhIGRlZmluZWQgcGVyY2VudGFnZSBvZiBoaXMgc2hhcmVzIGJhbGFuY2UgaW4gdGhlIERhbyANCiAgICAvLy8gQHBhcmFtIF9kaXZpc29yU2hhcmVzTGltaXQgVGhlIHBhcnRuZXIgY2FuIGZ1bmQgDQogICAgLy8vIG9ubHkgdW5kZXIgYSBkZWZpbmVkIHBlcmNlbnRhZ2Ugb2YgaGlzIHNoYXJlcyBiYWxhbmNlIGluIHRoZSBEYW8gDQogICAgLy8vIEByZXR1cm4gVGhlIG1heGltdW0gYW1vdW50IChpbiB3ZWkpIGEgcGFydG5lciBjYW4gZnVuZA0KICAgIGZ1bmN0aW9uIHBhcnRuZXJGdW5kaW5nTGltaXQoDQogICAgICAgIHVpbnQgX2luZGV4LCANCiAgICAgICAgdWludCBfbWluQW1vdW50TGltaXQsDQogICAgICAgIHVpbnQgX21heEFtb3VudExpbWl0LCANCiAgICAgICAgdWludCBfZGl2aXNvckJhbGFuY2VMaW1pdCwNCiAgICAgICAgdWludCBfbXVsdGlwbGllclNoYXJlc0xpbWl0LA0KICAgICAgICB1aW50IF9kaXZpc29yU2hhcmVzTGltaXQNCiAgICAgICAgKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICAgICAgDQogICAgLy8vIEByZXR1cm4gdGhlIG51bWJlciBvZiBwYXJ0bmVycw0KICAgIGZ1bmN0aW9uIG51bWJlck9mUGFydG5lcnMoKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBpbmRleCBvZiB0aGUgZmlyc3QgcGFydG5lcg0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBwYXJ0bmVyDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiB2YWxpZCBwYXJ0bmVycw0KICAgIGZ1bmN0aW9uIG51bWJlck9mVmFsaWRQYXJ0bmVycygNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8NCiAgICAgICAgKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KTsNCg0KICAgIGV2ZW50IENvbnRyYWN0b3JNYW5hZ2VyU2V0KGFkZHJlc3MgQ29udHJhY3Rvck1hbmFnZXJBZGRyZXNzKTsNCiAgICBldmVudCBJbnRlbnRpb25Ub0Z1bmQoYWRkcmVzcyBpbmRleGVkIHBhcnRuZXIsIHVpbnQgYW1vdW50KTsNCiAgICBldmVudCBGdW5kKGFkZHJlc3MgaW5kZXhlZCBwYXJ0bmVyLCB1aW50IGFtb3VudCk7DQogICAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgaW5kZXhlZCBwYXJ0bmVyLCB1aW50IGFtb3VudCk7DQogICAgZXZlbnQgTGltaXRTZXQodWludCBtaW5BbW91bnRMaW1pdCwgdWludCBtYXhBbW91bnRMaW1pdCwgdWludCBkaXZpc29yQmFsYW5jZUxpbWl0LCANCiAgICAgICAgdWludCBfbXVsdGlwbGllclNoYXJlc0xpbWl0LCB1aW50IGRpdmlzb3JTaGFyZXNMaW1pdCk7DQogICAgZXZlbnQgUGFydG5lcnNOb3RTZXQodWludCBzdW1PZkZ1bmRpbmdBbW91bnRMaW1pdHMpOw0KICAgIGV2ZW50IEFsbFBhcnRuZXJzU2V0KHVpbnQgZnVuZGluZ0Ftb3VudCk7DQogICAgZXZlbnQgRnVlbGVkKCk7DQogICAgZXZlbnQgRnVuZGluZ0Nsb3NlZCgpOw0KICAgIA0KfQ0KDQpjb250cmFjdCBQYXNzRnVuZGluZyBpcyBQYXNzRnVuZGluZ0ludGVyZmFjZSB7DQoNCiAgICBmdW5jdGlvbiBQYXNzRnVuZGluZyAoDQogICAgICAgIGFkZHJlc3MgX2NyZWF0b3IsDQogICAgICAgIGFkZHJlc3MgX0Rhb01hbmFnZXIsDQogICAgICAgIHVpbnQgX21pbkZ1bmRpbmdBbW91bnQsDQogICAgICAgIHVpbnQgX3N0YXJ0VGltZSwNCiAgICAgICAgdWludCBfY2xvc2luZ1RpbWUNCiAgICAgICAgKSB7DQoNCiAgICAgICAgaWYgKF9jcmVhdG9yID09IF9EYW9NYW5hZ2VyDQogICAgICAgICAgICB8fCBfY3JlYXRvciA9PSAwDQogICAgICAgICAgICB8fCBfRGFvTWFuYWdlciA9PSAwDQogICAgICAgICAgICB8fCAoX3N0YXJ0VGltZSA8IG5vdyAmJiBfc3RhcnRUaW1lICE9IDApKSB0aHJvdzsNCiAgICAgICAgICAgIA0KICAgICAgICBjcmVhdG9yID0gX2NyZWF0b3I7DQogICAgICAgIERhb01hbmFnZXIgPSBQYXNzTWFuYWdlcihfRGFvTWFuYWdlcik7DQoNCiAgICAgICAgbWluRnVuZGluZ0Ftb3VudCA9IF9taW5GdW5kaW5nQW1vdW50Ow0KDQogICAgICAgIGlmIChfc3RhcnRUaW1lID09IDApIHtzdGFydFRpbWUgPSBub3c7fSBlbHNlIHtzdGFydFRpbWUgPSBfc3RhcnRUaW1lO30NCg0KICAgICAgICBpZiAoX2Nsb3NpbmdUaW1lIDw9IHN0YXJ0VGltZSkgdGhyb3c7DQogICAgICAgIGNsb3NpbmdUaW1lID0gX2Nsb3NpbmdUaW1lOw0KICAgICAgICANCiAgICAgICAgc2V0RnJvbVBhcnRuZXIgPSAxOw0KICAgICAgICByZWZ1bmRGcm9tUGFydG5lciA9IDE7DQoNCiAgICAgICAgcGFydG5lcnMubGVuZ3RoID0gMTsgDQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBTZXRDb250cmFjdG9yTWFuYWdlcihhZGRyZXNzIF9jb250cmFjdG9yTWFuYWdlcikgb25seUNyZWF0b3Igew0KICAgICAgICANCiAgICAgICAgaWYgKF9jb250cmFjdG9yTWFuYWdlciA9PSAwDQogICAgICAgICAgICB8fCBsaW1pdFNldA0KICAgICAgICAgICAgfHwgYWRkcmVzcyhjb250cmFjdG9yTWFuYWdlcikgIT0gMA0KICAgICAgICAgICAgfHwgY3JlYXRvciA9PSBfY29udHJhY3Rvck1hbmFnZXINCiAgICAgICAgICAgIHx8IF9jb250cmFjdG9yTWFuYWdlciA9PSBhZGRyZXNzKERhb01hbmFnZXIpKSB0aHJvdzsNCiAgICAgICAgICAgIA0KICAgICAgICB0b2tlbkNyZWF0aW9uID0gdHJ1ZTsgICAgICAgICAgICANCiAgICAgICAgY29udHJhY3Rvck1hbmFnZXIgPSBQYXNzTWFuYWdlcihfY29udHJhY3Rvck1hbmFnZXIpOw0KICAgICAgICBDb250cmFjdG9yTWFuYWdlclNldChfY29udHJhY3Rvck1hbmFnZXIpOw0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBTZXRQcmVzYWxlQW1vdW50TGltaXRzKA0KICAgICAgICB1aW50IF9taW5QcmVzYWxlQW1vdW50LA0KICAgICAgICB1aW50IF9tYXhQcmVzYWxlQW1vdW50DQogICAgICAgICkgb25seUNyZWF0b3Igew0KDQogICAgICAgIGlmIChsaW1pdFNldCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBtaW5QcmVzYWxlQW1vdW50ID0gX21pblByZXNhbGVBbW91bnQ7DQogICAgICAgIG1heFByZXNhbGVBbW91bnQgPSBfbWF4UHJlc2FsZUFtb3VudDsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgICAgICBpZiAoIXByZXNhbGUoKSkgdGhyb3c7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcHJlc2FsZSgpIHBheWFibGUgcmV0dXJucyAoYm9vbCkgew0KDQogICAgICAgIGlmIChtc2cudmFsdWUgPD0gMA0KICAgICAgICAgICAgfHwgbm93IDwgc3RhcnRUaW1lDQogICAgICAgICAgICB8fCBub3cgPiBjbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgbm93IDwgcGF1c2VDbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgbGltaXRTZXQNCiAgICAgICAgICAgIHx8IG1zZy52YWx1ZSA8IG1pblByZXNhbGVBbW91bnQNCiAgICAgICAgICAgIHx8IG1zZy52YWx1ZSA+IG1heFByZXNhbGVBbW91bnQNCiAgICAgICAgICAgIHx8IG1zZy5zZW5kZXIgPT0gY3JlYXRvcg0KICAgICAgICApIHRocm93Ow0KICAgICAgICANCiAgICAgICAgaWYgKHBhcnRuZXJJRFttc2cuc2VuZGVyXSA9PSAwKSB7DQoNCiAgICAgICAgICAgIHVpbnQgX3BhcnRuZXJJRCA9IHBhcnRuZXJzLmxlbmd0aCsrOw0KICAgICAgICAgICAgUGFydG5lciB0ID0gcGFydG5lcnNbX3BhcnRuZXJJRF07DQogICAgICAgICAgICAgDQogICAgICAgICAgICBwYXJ0bmVySURbbXNnLnNlbmRlcl0gPSBfcGFydG5lcklEOw0KICAgICAgICAgICAgdC5wYXJ0bmVyQWRkcmVzcyA9IG1zZy5zZW5kZXI7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHQucHJlc2FsZUFtb3VudCArPSBtc2cudmFsdWU7DQogICAgICAgICAgICB0LnByZXNhbGVEYXRlID0gbm93Ow0KDQogICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgIFBhcnRuZXIgcCA9IHBhcnRuZXJzW3BhcnRuZXJJRFttc2cuc2VuZGVyXV07DQogICAgICAgICAgICBpZiAocC5wcmVzYWxlQW1vdW50ICsgbXNnLnZhbHVlID4gbWF4UHJlc2FsZUFtb3VudCkgdGhyb3c7DQoNCiAgICAgICAgICAgIHAucHJlc2FsZURhdGUgPSAocC5wcmVzYWxlRGF0ZSpwLnByZXNhbGVBbW91bnQgKyBub3cqbXNnLnZhbHVlKS8ocC5wcmVzYWxlQW1vdW50ICsgbXNnLnZhbHVlKTsNCiAgICAgICAgICAgIHAucHJlc2FsZUFtb3VudCArPSBtc2cudmFsdWU7DQoNCiAgICAgICAgfSAgICANCiAgICAgICAgDQogICAgICAgIEludGVudGlvblRvRnVuZChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBzZXRQYXJ0bmVycygNCiAgICAgICAgICAgIGJvb2wgX3ZhbGlkLA0KICAgICAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgICAgIHVpbnQgX3RvDQogICAgICAgICkgb25seUNyZWF0b3Igew0KDQogICAgICAgIGlmIChsaW1pdFNldA0KICAgICAgICAgICAgfHxfZnJvbSA8IDEgDQogICAgICAgICAgICB8fCBfdG8gPiBwYXJ0bmVycy5sZW5ndGggLSAxKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGZvciAodWludCBpID0gX2Zyb207IGkgPD0gX3RvOyBpKyspIHsNCiAgICAgICAgICAgIFBhcnRuZXIgdCA9IHBhcnRuZXJzW2ldOw0KICAgICAgICAgICAgdC52YWxpZCA9IF92YWxpZDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRTaGFyZUhvbGRlcnMoDQogICAgICAgICAgICBib29sIF92YWxpZCwNCiAgICAgICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgICAgICB1aW50IF90bw0KICAgICAgICApIG9ubHlDcmVhdG9yIHsNCg0KICAgICAgICBpZiAobGltaXRTZXQNCiAgICAgICAgICAgIHx8X2Zyb20gPCAxIA0KICAgICAgICAgICAgfHwgX3RvID4gcGFydG5lcnMubGVuZ3RoIC0gMSkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBmb3IgKHVpbnQgaSA9IF9mcm9tOyBpIDw9IF90bzsgaSsrKSB7DQogICAgICAgICAgICBQYXJ0bmVyIHQgPSBwYXJ0bmVyc1tpXTsNCiAgICAgICAgICAgIGlmIChEYW9NYW5hZ2VyLmJhbGFuY2VPZih0LnBhcnRuZXJBZGRyZXNzKSAhPSAwKSB0LnZhbGlkID0gX3ZhbGlkOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhYm9ydEZ1bmRpbmcoKSBvbmx5Q3JlYXRvciB7DQogICAgICAgIGxpbWl0U2V0ID0gdHJ1ZTsNCiAgICAgICAgbWF4UHJlc2FsZUFtb3VudCA9IDA7DQogICAgICAgIElzZnVuZGluZ0Fib3J0ZWQgPSB0cnVlOyANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcGF1c2UodWludCBfcGF1c2VDbG9zaW5nVGltZSkgb25seUNyZWF0b3Igew0KICAgICAgICBwYXVzZUNsb3NpbmdUaW1lID0gX3BhdXNlQ2xvc2luZ1RpbWU7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHNldExpbWl0cygNCiAgICAgICAgICAgIHVpbnQgX21pbkFtb3VudExpbWl0LA0KICAgICAgICAgICAgdWludCBfbWF4QW1vdW50TGltaXQsIA0KICAgICAgICAgICAgdWludCBfZGl2aXNvckJhbGFuY2VMaW1pdCwNCiAgICAgICAgICAgIHVpbnQgX211bHRpcGxpZXJTaGFyZXNMaW1pdCwNCiAgICAgICAgICAgIHVpbnQgX2Rpdmlzb3JTaGFyZXNMaW1pdA0KICAgICkgb25seUNyZWF0b3Igew0KICAgICAgICANCiAgICAgICAgaWYgKGxpbWl0U2V0KSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIG1pbkFtb3VudExpbWl0ID0gX21pbkFtb3VudExpbWl0Ow0KICAgICAgICBtYXhBbW91bnRMaW1pdCA9IF9tYXhBbW91bnRMaW1pdDsNCiAgICAgICAgZGl2aXNvckJhbGFuY2VMaW1pdCA9IF9kaXZpc29yQmFsYW5jZUxpbWl0Ow0KICAgICAgICBtdWx0aXBsaWVyU2hhcmVzTGltaXQgPSBfbXVsdGlwbGllclNoYXJlc0xpbWl0Ow0KICAgICAgICBkaXZpc29yU2hhcmVzTGltaXQgPSBfZGl2aXNvclNoYXJlc0xpbWl0Ow0KDQogICAgICAgIGxpbWl0U2V0ID0gdHJ1ZTsNCiAgICAgICAgDQogICAgICAgIExpbWl0U2V0KF9taW5BbW91bnRMaW1pdCwgX21heEFtb3VudExpbWl0LCBfZGl2aXNvckJhbGFuY2VMaW1pdCwgX211bHRpcGxpZXJTaGFyZXNMaW1pdCwgX2Rpdmlzb3JTaGFyZXNMaW1pdCk7DQogICAgDQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZyh1aW50IF90bykgb25seUNyZWF0b3IgcmV0dXJucyAoYm9vbCBfc3VjY2Vzcykgew0KDQogICAgICAgIHVpbnQgX2Z1bmRpbmdNYXhBbW91bnQgPSBEYW9NYW5hZ2VyLmZ1bmRpbmdNYXhBbW91bnQoYWRkcmVzcyh0aGlzKSk7DQoNCiAgICAgICAgaWYgKCFsaW1pdFNldCANCiAgICAgICAgICAgIHx8IF9mdW5kaW5nTWF4QW1vdW50IDwgbWluRnVuZGluZ0Ftb3VudA0KICAgICAgICAgICAgfHwgc2V0RnJvbVBhcnRuZXIgPiBfdG8gDQogICAgICAgICAgICB8fCBfdG8gPiBwYXJ0bmVycy5sZW5ndGggLSAxKSB0aHJvdzsNCg0KICAgICAgICBEYW9NYW5hZ2VyLnNldEZ1bmRpbmdTdGFydFRpbWUoc3RhcnRUaW1lKTsNCiAgICAgICAgaWYgKHRva2VuQ3JlYXRpb24pIGNvbnRyYWN0b3JNYW5hZ2VyLnNldEZ1bmRpbmdTdGFydFRpbWUoc3RhcnRUaW1lKTsNCg0KICAgICAgICBpZiAoc2V0RnJvbVBhcnRuZXIgPT0gMSkgc3VtT2ZGdW5kaW5nQW1vdW50TGltaXRzID0gMDsNCiAgICAgICAgDQogICAgICAgIGZvciAodWludCBpID0gc2V0RnJvbVBhcnRuZXI7IGkgPD0gX3RvOyBpKyspIHsNCg0KICAgICAgICAgICAgcGFydG5lcnNbaV0uZnVuZGluZ0Ftb3VudExpbWl0ID0gcGFydG5lckZ1bmRpbmdMaW1pdChpLCBtaW5BbW91bnRMaW1pdCwgbWF4QW1vdW50TGltaXQsIA0KICAgICAgICAgICAgICAgIGRpdmlzb3JCYWxhbmNlTGltaXQsIG11bHRpcGxpZXJTaGFyZXNMaW1pdCwgZGl2aXNvclNoYXJlc0xpbWl0KTsNCg0KICAgICAgICAgICAgc3VtT2ZGdW5kaW5nQW1vdW50TGltaXRzICs9IHBhcnRuZXJzW2ldLmZ1bmRpbmdBbW91bnRMaW1pdDsNCg0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBzZXRGcm9tUGFydG5lciA9IF90byArIDE7DQogICAgICAgIA0KICAgICAgICBpZiAoc2V0RnJvbVBhcnRuZXIgPj0gcGFydG5lcnMubGVuZ3RoKSB7DQoNCiAgICAgICAgICAgIHNldEZyb21QYXJ0bmVyID0gMTsNCg0KICAgICAgICAgICAgaWYgKHN1bU9mRnVuZGluZ0Ftb3VudExpbWl0cyA8IG1pbkZ1bmRpbmdBbW91bnQgDQogICAgICAgICAgICAgICAgfHwgc3VtT2ZGdW5kaW5nQW1vdW50TGltaXRzID4gX2Z1bmRpbmdNYXhBbW91bnQpIHsNCg0KICAgICAgICAgICAgICAgIG1heFByZXNhbGVBbW91bnQgPSAwOw0KICAgICAgICAgICAgICAgIElzZnVuZGluZ0Fib3J0ZWQgPSB0cnVlOyANCiAgICAgICAgICAgICAgICBQYXJ0bmVyc05vdFNldChzdW1PZkZ1bmRpbmdBbW91bnRMaW1pdHMpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgYWxsU2V0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBBbGxQYXJ0bmVyc1NldChzdW1PZkZ1bmRpbmdBbW91bnRMaW1pdHMpOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGZ1bmREYW9Gb3IoDQogICAgICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICAgICAgdWludCBfdG8NCiAgICAgICAgKSByZXR1cm5zIChib29sKSB7DQoNCiAgICAgICAgaWYgKCFhbGxTZXQpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgaWYgKF9mcm9tIDwgMSB8fCBfdG8gPiBwYXJ0bmVycy5sZW5ndGggLSAxKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGFkZHJlc3MgX3BhcnRuZXI7DQogICAgICAgIHVpbnQgX2Ftb3VudFRvRnVuZDsNCiAgICAgICAgdWludCBfc3VtQW1vdW50VG9GdW5kID0gMDsNCg0KICAgICAgICBmb3IgKHVpbnQgaSA9IF9mcm9tOyBpIDw9IF90bzsgaSsrKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIF9wYXJ0bmVyID0gcGFydG5lcnNbaV0ucGFydG5lckFkZHJlc3M7DQogICAgICAgICAgICBfYW1vdW50VG9GdW5kID0gcGFydG5lcnNbaV0uZnVuZGluZ0Ftb3VudExpbWl0IC0gcGFydG5lcnNbaV0uZnVuZGVkQW1vdW50Ow0KICAgICAgICANCiAgICAgICAgICAgIGlmIChfYW1vdW50VG9GdW5kID4gMCkgew0KDQogICAgICAgICAgICAgICAgcGFydG5lcnNbaV0uZnVuZGVkQW1vdW50ICs9IF9hbW91bnRUb0Z1bmQ7DQogICAgICAgICAgICAgICAgX3N1bUFtb3VudFRvRnVuZCArPSBfYW1vdW50VG9GdW5kOw0KDQogICAgICAgICAgICAgICAgRGFvTWFuYWdlci5yZXdhcmRUb2tlbihfcGFydG5lciwgX2Ftb3VudFRvRnVuZCwgcGFydG5lcnNbaV0ucHJlc2FsZURhdGUpOw0KDQogICAgICAgICAgICAgICAgaWYgKHRva2VuQ3JlYXRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgY29udHJhY3Rvck1hbmFnZXIucmV3YXJkVG9rZW4oX3BhcnRuZXIsIF9hbW91bnRUb0Z1bmQsIHBhcnRuZXJzW2ldLnByZXNhbGVEYXRlKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKF9zdW1BbW91bnRUb0Z1bmQgPT0gMCkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgaWYgKCFEYW9NYW5hZ2VyLnNlbmQoX3N1bUFtb3VudFRvRnVuZCkpIHRocm93Ow0KDQogICAgICAgIHRvdGFsRnVuZGVkICs9IF9zdW1BbW91bnRUb0Z1bmQ7DQoNCiAgICAgICAgaWYgKHRvdGFsRnVuZGVkID09IHN1bU9mRnVuZGluZ0Ftb3VudExpbWl0cykgew0KICAgICAgICAgICAgRGFvTWFuYWdlci5zZXRGdW5kaW5nRnVlbGVkKCk7IA0KICAgICAgICAgICAgaWYgKHRva2VuQ3JlYXRpb24pIGNvbnRyYWN0b3JNYW5hZ2VyLnNldEZ1bmRpbmdGdWVsZWQoKTsgDQogICAgICAgICAgICBGdWVsZWQoKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gZnVuZERhbygpIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgcmV0dXJuIGZ1bmREYW9Gb3IocGFydG5lcklEW21zZy5zZW5kZXJdLCBwYXJ0bmVySURbbXNnLnNlbmRlcl0pOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlZnVuZEZvcih1aW50IF9wYXJ0bmVySUQpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICBQYXJ0bmVyIHQgPSBwYXJ0bmVyc1tfcGFydG5lcklEXTsNCiAgICAgICAgdWludCBfYW1vdW50bm90VG9SZWZ1bmQgPSB0LnByZXNhbGVBbW91bnQ7DQogICAgICAgIHVpbnQgX2Ftb3VudFRvUmVmdW5kOw0KICAgICAgICANCiAgICAgICAgaWYgKHQucHJlc2FsZUFtb3VudCA+IG1heFByZXNhbGVBbW91bnQgJiYgdC52YWxpZCkgew0KICAgICAgICAgICAgX2Ftb3VudG5vdFRvUmVmdW5kID0gbWF4UHJlc2FsZUFtb3VudDsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKHQuZnVuZGVkQW1vdW50ID4gMCB8fCBub3cgPiBjbG9zaW5nVGltZSkgew0KICAgICAgICAgICAgX2Ftb3VudG5vdFRvUmVmdW5kID0gdC5mdW5kZWRBbW91bnQ7DQogICAgICAgIH0NCg0KICAgICAgICBfYW1vdW50VG9SZWZ1bmQgPSB0LnByZXNhbGVBbW91bnQgLSBfYW1vdW50bm90VG9SZWZ1bmQ7DQogICAgICAgIGlmIChfYW1vdW50VG9SZWZ1bmQgPD0gMCkgcmV0dXJuIHRydWU7DQoNCiAgICAgICAgdC5wcmVzYWxlQW1vdW50ID0gX2Ftb3VudG5vdFRvUmVmdW5kOw0KICAgICAgICBpZiAodC5wYXJ0bmVyQWRkcmVzcy5zZW5kKF9hbW91bnRUb1JlZnVuZCkpIHsNCiAgICAgICAgICAgIFJlZnVuZCh0LnBhcnRuZXJBZGRyZXNzLCBfYW1vdW50VG9SZWZ1bmQpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0LnByZXNhbGVBbW91bnQgPSBfYW1vdW50bm90VG9SZWZ1bmQgKyBfYW1vdW50VG9SZWZ1bmQ7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlZnVuZEZvclZhbGlkUGFydG5lcnModWludCBfdG8pIHsNCg0KICAgICAgICBpZiAocmVmdW5kRnJvbVBhcnRuZXIgPiBfdG8gfHwgX3RvID4gcGFydG5lcnMubGVuZ3RoIC0gMSkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBmb3IgKHVpbnQgaSA9IHJlZnVuZEZyb21QYXJ0bmVyOyBpIDw9IF90bzsgaSsrKSB7DQogICAgICAgICAgICBpZiAocGFydG5lcnNbaV0udmFsaWQpIHsNCiAgICAgICAgICAgICAgICBpZiAoIXJlZnVuZEZvcihpKSkgdGhyb3c7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZWZ1bmRGcm9tUGFydG5lciA9IF90byArIDE7DQogICAgICAgIA0KICAgICAgICBpZiAocmVmdW5kRnJvbVBhcnRuZXIgPj0gcGFydG5lcnMubGVuZ3RoKSB7DQogICAgICAgICAgICByZWZ1bmRGcm9tUGFydG5lciA9IDE7DQoNCiAgICAgICAgICAgIGlmICgodG90YWxGdW5kZWQgPj0gc3VtT2ZGdW5kaW5nQW1vdW50TGltaXRzICYmIGFsbFNldCAmJiBjbG9zaW5nVGltZSA+IG5vdykNCiAgICAgICAgICAgICAgICB8fCBJc2Z1bmRpbmdBYm9ydGVkKSB7DQoNCiAgICAgICAgICAgICAgICBjbG9zaW5nVGltZSA9IG5vdzsgDQogICAgICAgICAgICAgICAgRnVuZGluZ0Nsb3NlZCgpOyANCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlZnVuZEZvckFsbCgNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8pIHsNCg0KICAgICAgICBpZiAoX2Zyb20gPCAxIHx8IF90byA+IHBhcnRuZXJzLmxlbmd0aCAtIDEpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgZm9yICh1aW50IGkgPSBfZnJvbTsgaSA8PSBfdG87IGkrKykgew0KICAgICAgICAgICAgaWYgKCFyZWZ1bmRGb3IoaSkpIHRocm93Ow0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZWZ1bmQoKSB7DQogICAgICAgIHJlZnVuZEZvckFsbChwYXJ0bmVySURbbXNnLnNlbmRlcl0sIHBhcnRuZXJJRFttc2cuc2VuZGVyXSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZXN0aW1hdGVkRnVuZGluZ0Ftb3VudCgNCiAgICAgICAgdWludCBfbWluQW1vdW50TGltaXQsDQogICAgICAgIHVpbnQgX21heEFtb3VudExpbWl0LCANCiAgICAgICAgdWludCBfZGl2aXNvckJhbGFuY2VMaW1pdCwNCiAgICAgICAgdWludCBfbXVsdGlwbGllclNoYXJlc0xpbWl0LA0KICAgICAgICB1aW50IF9kaXZpc29yU2hhcmVzTGltaXQsDQogICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgIHVpbnQgX3RvDQogICAgICAgICkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KDQogICAgICAgIGlmIChfZnJvbSA8IDEgfHwgX3RvID4gcGFydG5lcnMubGVuZ3RoIC0gMSkgdGhyb3c7DQoNCiAgICAgICAgdWludCBfdG90YWwgPSAwOw0KICAgICAgICANCiAgICAgICAgZm9yICh1aW50IGkgPSBfZnJvbTsgaSA8PSBfdG87IGkrKykgew0KICAgICAgICAgICAgX3RvdGFsICs9IHBhcnRuZXJGdW5kaW5nTGltaXQoaSwgX21pbkFtb3VudExpbWl0LCBfbWF4QW1vdW50TGltaXQsIA0KICAgICAgICAgICAgICAgIF9kaXZpc29yQmFsYW5jZUxpbWl0LCBfbXVsdGlwbGllclNoYXJlc0xpbWl0LCBfZGl2aXNvclNoYXJlc0xpbWl0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBfdG90YWw7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwYXJ0bmVyRnVuZGluZ0xpbWl0KA0KICAgICAgICB1aW50IF9pbmRleCwgDQogICAgICAgIHVpbnQgX21pbkFtb3VudExpbWl0LA0KICAgICAgICB1aW50IF9tYXhBbW91bnRMaW1pdCwgDQogICAgICAgIHVpbnQgX2Rpdmlzb3JCYWxhbmNlTGltaXQsDQogICAgICAgIHVpbnQgX211bHRpcGxpZXJTaGFyZXNMaW1pdCwNCiAgICAgICAgdWludCBfZGl2aXNvclNoYXJlc0xpbWl0DQogICAgICAgICkgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KDQogICAgICAgIHVpbnQgX2Ftb3VudDsNCiAgICAgICAgdWludCBfYW1vdW50MTsNCg0KICAgICAgICBQYXJ0bmVyIHQgPSBwYXJ0bmVyc1tfaW5kZXhdOw0KICAgICAgICAgICAgDQogICAgICAgIGlmICh0LnZhbGlkKSB7DQoNCiAgICAgICAgICAgIF9hbW91bnQgPSB0LnByZXNhbGVBbW91bnQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChfZGl2aXNvckJhbGFuY2VMaW1pdCA+IDApIHsNCiAgICAgICAgICAgICAgICBfYW1vdW50MSA9IHVpbnQodC5wYXJ0bmVyQWRkcmVzcy5iYWxhbmNlKS91aW50KF9kaXZpc29yQmFsYW5jZUxpbWl0KTsNCiAgICAgICAgICAgICAgICBpZiAoX2Ftb3VudCA+IF9hbW91bnQxKSBfYW1vdW50ID0gX2Ftb3VudDE7IA0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKF9tdWx0aXBsaWVyU2hhcmVzTGltaXQgPiAwICYmIF9kaXZpc29yU2hhcmVzTGltaXQgPiAwKSB7DQoNCiAgICAgICAgICAgICAgICB1aW50IF9iYWxhbmNlID0gdWludChEYW9NYW5hZ2VyLmJhbGFuY2VPZih0LnBhcnRuZXJBZGRyZXNzKSk7DQoNCiAgICAgICAgICAgICAgICB1aW50IF9tdWx0aXBsaWVyID0gX2JhbGFuY2UqX211bHRpcGxpZXJTaGFyZXNMaW1pdDsNCiAgICAgICAgICAgICAgICBpZiAoX211bHRpcGxpZXIvX2JhbGFuY2UgIT0gX211bHRpcGxpZXJTaGFyZXNMaW1pdCkgdGhyb3c7DQoNCiAgICAgICAgICAgICAgICBfYW1vdW50MSA9IF9tdWx0aXBsaWVyL19kaXZpc29yU2hhcmVzTGltaXQ7DQogICAgICAgICAgICAgICAgaWYgKF9hbW91bnQgPiBfYW1vdW50MSkgX2Ftb3VudCA9IF9hbW91bnQxOyANCg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKF9hbW91bnQgPiBfbWF4QW1vdW50TGltaXQpIF9hbW91bnQgPSBfbWF4QW1vdW50TGltaXQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChfYW1vdW50IDwgX21pbkFtb3VudExpbWl0KSBfYW1vdW50ID0gX21pbkFtb3VudExpbWl0Ow0KDQogICAgICAgICAgICBpZiAoX2Ftb3VudCA+IHQucHJlc2FsZUFtb3VudCkgX2Ftb3VudCA9IHQucHJlc2FsZUFtb3VudDsNCiAgICAgICAgICAgIA0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gX2Ftb3VudDsNCiAgICAgICAgDQogICAgfQ0KDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZQYXJ0bmVycygpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIHBhcnRuZXJzLmxlbmd0aCAtIDE7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIG51bWJlck9mVmFsaWRQYXJ0bmVycygNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8NCiAgICAgICAgKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICBpZiAoX2Zyb20gPCAxIHx8IF90byA+IHBhcnRuZXJzLmxlbmd0aC0xKSB0aHJvdzsNCg0KICAgICAgICB1aW50IF90b3RhbCA9IDA7DQogICAgICAgIA0KICAgICAgICBmb3IgKHVpbnQgaSA9IF9mcm9tOyBpIDw9IF90bzsgaSsrKSB7DQogICAgICAgICAgICBpZiAocGFydG5lcnNbaV0udmFsaWQpIF90b3RhbCArPSAxOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIF90b3RhbDsNCiAgICAgICAgDQogICAgfQ0KDQp9DQoNCmNvbnRyYWN0IFBhc3NGdW5kaW5nQ3JlYXRvciB7DQogICAgZXZlbnQgTmV3RnVuZGluZyhhZGRyZXNzIGNyZWF0b3IsIGFkZHJlc3MgRGFvTWFuYWdlciwgDQogICAgICAgIHVpbnQgTWluRnVuZGluZ0Ftb3VudCwgdWludCBTdGFydFRpbWUsIHVpbnQgQ2xvc2luZ1RpbWUsIGFkZHJlc3MgRnVuZGluZ0NvbnRyYWN0QWRkcmVzcyk7DQogICAgZnVuY3Rpb24gY3JlYXRlRnVuZGluZygNCiAgICAgICAgYWRkcmVzcyBfRGFvTWFuYWdlciwNCiAgICAgICAgdWludCBfbWluRnVuZGluZ0Ftb3VudCwNCiAgICAgICAgdWludCBfc3RhcnRUaW1lLA0KICAgICAgICB1aW50IF9jbG9zaW5nVGltZQ0KICAgICAgICApIHJldHVybnMgKFBhc3NGdW5kaW5nKSB7DQogICAgICAgIFBhc3NGdW5kaW5nIF9uZXdGdW5kaW5nID0gbmV3IFBhc3NGdW5kaW5nKA0KICAgICAgICAgICAgbXNnLnNlbmRlciwNCiAgICAgICAgICAgIF9EYW9NYW5hZ2VyLCAgICAgICAgDQogICAgICAgICAgICBfbWluRnVuZGluZ0Ftb3VudCwNCiAgICAgICAgICAgIF9zdGFydFRpbWUsDQogICAgICAgICAgICBfY2xvc2luZ1RpbWUNCiAgICAgICAgKTsNCiAgICAgICAgTmV3RnVuZGluZyhtc2cuc2VuZGVyLCBfRGFvTWFuYWdlciwgIA0KICAgICAgICAgICAgX21pbkZ1bmRpbmdBbW91bnQsIF9zdGFydFRpbWUsIF9jbG9zaW5nVGltZSwgYWRkcmVzcyhfbmV3RnVuZGluZykpOw0KICAgICAgICByZXR1cm4gX25ld0Z1bmRpbmc7DQogICAgfQ0KfQ=='