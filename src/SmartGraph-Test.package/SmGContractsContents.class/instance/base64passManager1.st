base 64 content
base64passManager1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQovKg0KVGhpcyBmaWxlIGlzIHBhcnQgb2YgUGFzcyBEQU8uDQoNClBhc3MgREFPIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCml0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3INCihhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNClBhc3MgREFPIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQpidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KR05VIGxlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQoNCllvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBsZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KYWxvbmcgd2l0aCBQYXNzIERBTy4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiovDQoNCi8qDQpTbWFydCBjb250cmFjdCBmb3IgYSBEZWNlbnRyYWxpemVkIEF1dG9ub21vdXMgT3JnYW5pemF0aW9uIChEQU8pDQp0byBhdXRvbWF0ZSBvcmdhbml6YXRpb25hbCBnb3Zlcm5hbmNlIGFuZCBkZWNpc2lvbi1tYWtpbmcuDQoqLw0KDQovLy8gQHRpdGxlIFBhc3MgRGFvIHNtYXJ0IGNvbnRyYWN0DQpjb250cmFjdCBQYXNzRGFvIHsNCiAgICANCiAgICBzdHJ1Y3QgcmV2aXNpb24gew0KICAgICAgICAvLyBBZGRyZXNzIG9mIHRoZSBDb21taXR0ZWUgUm9vbSBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbW1pdHRlZVJvb207DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHNoYXJlIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAgICAgYWRkcmVzcyBzaGFyZU1hbmFnZXI7DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHRva2VuIG1hbmFnZXIgc21hcnQgY29udHJhY3QNCiAgICAgICAgYWRkcmVzcyB0b2tlbk1hbmFnZXI7DQogICAgICAgIC8vIEFkZHJlc3Mgb2YgdGhlIHByb2plY3QgY3JlYXRvciBzbWFydCBjb250cmFjdA0KICAgICAgICB1aW50IHN0YXJ0RGF0ZTsNCiAgICB9DQogICAgLy8gVGhlIHJldmlzaW9ucyBvZiB0aGUgYXBwbGljYXRpb24gdW50aWwgdG9kYXkNCiAgICByZXZpc2lvbltdIHB1YmxpYyByZXZpc2lvbnM7DQoNCiAgICBzdHJ1Y3QgcHJvamVjdCB7DQogICAgICAgIC8vIFRoZSBhZGRyZXNzIG9mIHRoZSBzbWFydCBjb250cmFjdA0KICAgICAgICBhZGRyZXNzIGNvbnRyYWN0QWRkcmVzczsNCiAgICAgICAgLy8gVGhlIHVuaXggZWZmZWN0aXZlIHN0YXJ0IGRhdGUgb2YgdGhlIGNvbnRyYWN0DQogICAgICAgIHVpbnQgc3RhcnREYXRlOw0KICAgIH0NCiAgICAvLyBUaGUgcHJvamVjdHMgb2YgdGhlIERhbw0KICAgIHByb2plY3RbXSBwdWJsaWMgcHJvamVjdHM7DQoNCiAgICAvLyBNYXAgd2l0aCB0aGUgaW5kZXhlcyBvZiB0aGUgcHJvamVjdHMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHByb2plY3RJRDsNCiAgICANCiAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgbWV0YSBwcm9qZWN0DQogICAgYWRkcmVzcyBtZXRhUHJvamVjdDsNCg0KICAgIA0KLy8gRXZlbnRzDQoNCiAgICBldmVudCBVcGdyYWRlKHVpbnQgaW5kZXhlZCBSZXZpc2lvbklELCBhZGRyZXNzIENvbW1pdHRlZVJvb20sIGFkZHJlc3MgU2hhcmVNYW5hZ2VyLCBhZGRyZXNzIFRva2VuTWFuYWdlcik7DQogICAgZXZlbnQgTmV3UHJvamVjdChhZGRyZXNzIFByb2plY3QpOw0KDQovLyBDb25zdGFudCBmdW5jdGlvbnMgIA0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSBlZmZlY3RpdmUgY29tbWl0dGVlIHJvb20NCiAgICBmdW5jdGlvbiBBY3R1YWxDb21taXR0ZWVSb29tKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gcmV2aXNpb25zWzBdLmNvbW1pdHRlZVJvb207DQogICAgfQ0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSBtZXRhIHByb2plY3QNCiAgICBmdW5jdGlvbiBNZXRhUHJvamVjdCgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIG1ldGFQcm9qZWN0Ow0KICAgIH0NCg0KICAgIC8vLyBAcmV0dXJuIFRoZSBlZmZlY3RpdmUgc2hhcmUgbWFuYWdlcg0KICAgIGZ1bmN0aW9uIEFjdHVhbFNoYXJlTWFuYWdlcigpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIHJldmlzaW9uc1swXS5zaGFyZU1hbmFnZXI7DQogICAgfQ0KDQogICAgLy8vIEByZXR1cm4gVGhlIGVmZmVjdGl2ZSB0b2tlbiBtYW5hZ2VyDQogICAgZnVuY3Rpb24gQWN0dWFsVG9rZW5NYW5hZ2VyKCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gcmV2aXNpb25zWzBdLnRva2VuTWFuYWdlcjsNCiAgICB9DQoNCi8vIG1vZGlmaWVycw0KDQogICAgbW9kaWZpZXIgb25seVBhc3NDb21taXR0ZWVSb29tIHtpZiAobXNnLnNlbmRlciAhPSByZXZpc2lvbnNbMF0uY29tbWl0dGVlUm9vbSAgDQogICAgICAgICYmIHJldmlzaW9uc1swXS5jb21taXR0ZWVSb29tICE9IDApIHRocm93OyBfO30NCiAgICANCi8vIENvbnN0cnVjdG9yIGZ1bmN0aW9uDQoNCiAgICBmdW5jdGlvbiBQYXNzRGFvKCkgew0KICAgICAgICBwcm9qZWN0cy5sZW5ndGggPSAxOw0KICAgICAgICByZXZpc2lvbnMubGVuZ3RoID0gMTsNCiAgICB9DQogICAgDQovLyBSZWdpc3RlciBmdW5jdGlvbnMNCg0KICAgIC8vLyBAZGV2IEZ1bmN0aW9uIHRvIGFsbG93IHRoZSBhY3R1YWwgQ29tbWl0dGVlIFJvb20gdXBncmFkaW5nIHRoZSBhcHBsaWNhdGlvbg0KICAgIC8vLyBAcGFyYW0gX25ld0NvbW1pdHRlZVJvb20gVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyBjb21taXR0ZWUgcm9vbQ0KICAgIC8vLyBAcGFyYW0gX25ld1NoYXJlTWFuYWdlciBUaGUgYWRkcmVzcyBvZiB0aGUgbmV3IHNoYXJlIG1hbmFnZXINCiAgICAvLy8gQHBhcmFtIF9uZXdUb2tlbk1hbmFnZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIG5ldyB0b2tlbiBtYW5hZ2VyDQogICAgLy8vIEByZXR1cm4gVGhlIGluZGV4IG9mIHRoZSByZXZpc2lvbg0KICAgIGZ1bmN0aW9uIHVwZ3JhZGUoDQogICAgICAgIGFkZHJlc3MgX25ld0NvbW1pdHRlZVJvb20sIA0KICAgICAgICBhZGRyZXNzIF9uZXdTaGFyZU1hbmFnZXIsIA0KICAgICAgICBhZGRyZXNzIF9uZXdUb2tlbk1hbmFnZXIpIG9ubHlQYXNzQ29tbWl0dGVlUm9vbSByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICB1aW50IF9yZXZpc2lvbklEID0gcmV2aXNpb25zLmxlbmd0aCsrOw0KICAgICAgICByZXZpc2lvbiByID0gcmV2aXNpb25zW19yZXZpc2lvbklEXTsNCg0KICAgICAgICBpZiAoX25ld0NvbW1pdHRlZVJvb20gIT0gMCkgci5jb21taXR0ZWVSb29tID0gX25ld0NvbW1pdHRlZVJvb207IGVsc2Ugci5jb21taXR0ZWVSb29tID0gcmV2aXNpb25zWzBdLmNvbW1pdHRlZVJvb207DQogICAgICAgIGlmIChfbmV3U2hhcmVNYW5hZ2VyICE9IDApIHIuc2hhcmVNYW5hZ2VyID0gX25ld1NoYXJlTWFuYWdlcjsgZWxzZSByLnNoYXJlTWFuYWdlciA9IHJldmlzaW9uc1swXS5zaGFyZU1hbmFnZXI7DQogICAgICAgIGlmIChfbmV3VG9rZW5NYW5hZ2VyICE9IDApIHIudG9rZW5NYW5hZ2VyID0gX25ld1Rva2VuTWFuYWdlcjsgZWxzZSByLnRva2VuTWFuYWdlciA9IHJldmlzaW9uc1swXS50b2tlbk1hbmFnZXI7DQoNCiAgICAgICAgci5zdGFydERhdGUgPSBub3c7DQogICAgICAgIA0KICAgICAgICByZXZpc2lvbnNbMF0gPSByOw0KICAgICAgICANCiAgICAgICAgVXBncmFkZShfcmV2aXNpb25JRCwgX25ld0NvbW1pdHRlZVJvb20sIF9uZXdTaGFyZU1hbmFnZXIsIF9uZXdUb2tlbk1hbmFnZXIpOw0KICAgICAgICAgICAgDQogICAgICAgIHJldHVybiBfcmV2aXNpb25JRDsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBGdW5jdGlvbiB0byBzZXQgdGhlIG1ldGEgcHJvamVjdA0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3RBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBtZXRhIHByb2plY3QNCiAgICBmdW5jdGlvbiBhZGRNZXRhUHJvamVjdChhZGRyZXNzIF9wcm9qZWN0QWRkcmVzcykgb25seVBhc3NDb21taXR0ZWVSb29tIHsNCg0KICAgICAgICBtZXRhUHJvamVjdCA9IF9wcm9qZWN0QWRkcmVzczsNCiAgICB9DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gYWxsb3cgdGhlIGNvbW1pdHRlZSByb29tIHRvIGFkZCBhIHByb2plY3Qgd2hlbiBvcmRlcmluZw0KICAgIC8vLyBAcGFyYW0gX3Byb2plY3RBZGRyZXNzIFRoZSBhZGRyZXNzIG9mIHRoZSBwcm9qZWN0DQogICAgZnVuY3Rpb24gYWRkUHJvamVjdChhZGRyZXNzIF9wcm9qZWN0QWRkcmVzcykgb25seVBhc3NDb21taXR0ZWVSb29tIHsNCg0KICAgICAgICBpZiAocHJvamVjdElEW19wcm9qZWN0QWRkcmVzc10gPT0gMCkgew0KDQogICAgICAgICAgICB1aW50IF9wcm9qZWN0SUQgPSBwcm9qZWN0cy5sZW5ndGgrKzsNCiAgICAgICAgICAgIHByb2plY3QgcCA9IHByb2plY3RzW19wcm9qZWN0SURdOw0KICAgICAgICANCiAgICAgICAgICAgIHByb2plY3RJRFtfcHJvamVjdEFkZHJlc3NdID0gX3Byb2plY3RJRDsNCiAgICAgICAgICAgIHAuY29udHJhY3RBZGRyZXNzID0gX3Byb2plY3RBZGRyZXNzOyANCiAgICAgICAgICAgIHAuc3RhcnREYXRlID0gbm93Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBOZXdQcm9qZWN0KF9wcm9qZWN0QWRkcmVzcyk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQp9DQoNCnByYWdtYSBzb2xpZGl0eSBeMC40Ljg7DQoNCi8qDQogKg0KICogVGhpcyBmaWxlIGlzIHBhcnQgb2YgUGFzcyBEQU8uDQogKg0KICogVGhlIE1hbmFnZXIgc21hcnQgY29udHJhY3QgaXMgdXNlZCBmb3IgdGhlIG1hbmFnZW1lbnQgb2Ygc2hhcmVzIGFuZCB0b2tlbnMuDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBUb2tlbiBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IG9mIHRoZSBQYXNzIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbmlzYXRpb24NCmNvbnRyYWN0IFBhc3NUb2tlbk1hbmFnZXJJbnRlcmZhY2Ugew0KDQogICAgLy8gVGhlIFBhc3MgRGFvIHNtYXJ0IGNvbnRyYWN0DQogICAgUGFzc0RhbyBwdWJsaWMgcGFzc0RhbzsNCiAgICAvLyBUaGUgYWRyZXNzIG9mIHRoZSBjcmVhdG9yIG9mIHRoaXMgc21hcnQgY29udHJhY3QNCiAgICBhZGRyZXNzIGNyZWF0b3I7DQogICAgDQogICAgLy8gVGhlIHRva2VuIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgICAvLyBUaGUgdG9rZW4gc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCiAgICAvLyBUaGUgcXVhbnRpdHkgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsNCiAgICAvLyBUb3RhbCBhbW91bnQgb2YgdG9rZW5zDQogICAgdWludDI1NiB0b3RhbFRva2VuU3VwcGx5Ow0KDQogICAgLy8gVHJ1ZSBpZiB0b2tlbnMsIGZhbHNlIGlmIERhbyBzaGFyZXMNCiAgICBib29sIHRva2VuOw0KICAgIC8vIElmIHRydWUsIHRoZSBzaGFyZXMgb3IgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcnJlZA0KICAgIGJvb2wgdHJhbnNmZXJhYmxlOw0KDQogICAgLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIGxhc3QgTWFuYWdlciBiZWZvcmUgY2xvbmluZw0KICAgIGFkZHJlc3MgcHVibGljIGNsb25lZEZyb207DQogICAgLy8gVHJ1ZSBpZiB0aGUgaW5pdGlhbCB0b2tlbiBzdXBwbHkgaXMgb3Zlcg0KICAgIGJvb2wgaW5pdGlhbFRva2VuU3VwcGx5RG9uZTsNCg0KICAgIC8vIEFycmF5IG9mIHRva2VuIG9yIHNoYXJlIGhvbGRlcnMgKHVzZWQgZm9yIGNsb25pbmcpDQogICAgYWRkcmVzc1tdIGhvbGRlcnM7DQogICAgLy8gTWFwIHdpdGggdGhlIGluZGV4ZXMgb2YgdGhlIGhvbGRlcnMgKHVzZWQgZm9yIGNsb25pbmcpDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSBob2xkZXJJRDsNCiAgICANCiAgICAvLyBBcnJheSB3aXRoIGFsbCBiYWxhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgLy8gQXJyYXkgd2l0aCBhbGwgYWxsb3dhbmNlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIHN0cnVjdCBmdW5kaW5nIHsNCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgd2hpY2ggc2V0cyBwYXJ0bmVycyBhbmQgbWFuYWdlcyB0aGUgZnVuZGluZyAobm90IG1hbmRhdG9yeSkNCiAgICAgICAgYWRkcmVzcyBtb2RlcmF0b3I7DQogICAgICAgIC8vIFRoZSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBhbW91bnRUb0Z1bmQ7DQogICAgICAgIC8vIFRoZSBmdW5kZWQgYW1vdW50IChpbiB3ZWkpDQogICAgICAgIHVpbnQgZnVuZGVkQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgc3RhcnQgdGltZSBvZiB0aGUgZnVuZGluZw0KICAgICAgICB1aW50IHN0YXJ0VGltZTsgDQogICAgICAgIC8vIEEgdW5peCB0aW1lc3RhbXAsIGRlbm90aW5nIHRoZSBjbG9zaW5nIHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBjbG9zaW5nVGltZTsgIA0KICAgICAgICAvLyBUaGUgcHJpY2UgbXVsdGlwbGllciBmb3IgYSBzaGFyZSBvciBhIHRva2VuIHdpdGhvdXQgY29uc2lkZXJpbmcgdGhlIGluZmxhdGlvbiByYXRlDQogICAgICAgIHVpbnQgaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgLy8gUmF0ZSBwZXIgeWVhciBpbiBwZXJjZW50YWdlIGFwcGxpZWQgdG8gdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIA0KICAgICAgICB1aW50IGluZmxhdGlvblJhdGU7IA0KICAgICAgICAvLyBUaGUgdG90YWwgYW1vdW50IG9mIHdlaSBnaXZlbg0KICAgICAgICB1aW50IHRvdGFsV2VpR2l2ZW47DQogICAgfSANCiAgICAvLyBNYXAgd2l0aCB0aGUgZnVuZGluZ3MgcnVsZXMgZm9yIGVhY2ggRGFvIHByb3Bvc2FsDQogICAgbWFwcGluZyAodWludCA9PiBmdW5kaW5nKSBwdWJsaWMgZnVuZGluZ3M7DQoNCiAgICAvLyBUaGUgaW5kZXggb2YgdGhlIGxhc3QgZnVuZGluZyBhbmQgcHJvcG9zYWwNCiAgICB1aW50IGxhc3RQcm9wb3NhbElEOw0KICAgIC8vIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBmdWVsZWQgZnVuZGluZyBhbmQgcHJvcG9zYWwNCiAgICB1aW50IHB1YmxpYyBsYXN0RnVlbGVkRnVuZGluZ0lEOw0KICAgIA0KICAgIHN0cnVjdCBhbW91bnRzR2l2ZW4gew0KICAgICAgICB1aW50IHdlaUFtb3VudDsNCiAgICAgICAgdWludCB0b2tlbkFtb3VudDsNCiAgICB9DQogICAgLy8gTWFwIHdpdGggdGhlIGFtb3VudHMgZ2l2ZW4gZm9yIGVhY2ggcHJvcG9zYWwgDQogICAgbWFwcGluZyAodWludCA9PiBtYXBwaW5nIChhZGRyZXNzID0+IGFtb3VudHNHaXZlbikpIHB1YmxpYyBHaXZlbjsNCiAgICANCiAgICAvLyBNYXAgb2YgYmxvY2tlZCBEYW8gc2hhcmUgYWNjb3VudHMuIFBvaW50cyB0byB0aGUgZGF0ZSB3aGVuIHRoZSBzaGFyZSBob2xkZXIgY2FuIHRyYW5zZmVyIHNoYXJlcw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGJsb2NrZWREZWFkTGluZTsgDQoNCiAgICAvLyBAcmV0dXJuIFRoZSBjbGllbnQgb2YgdGhpcyBtYW5hZ2VyDQogICAgZnVuY3Rpb24gQ2xpZW50KCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcyk7DQogICAgDQogICAgLy8vIEByZXR1cm4gVGhlIHRvdGFsIHN1cHBseSBvZiBzaGFyZXMgb3IgdG9rZW5zIA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7DQoNCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2UNCiAgICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOw0KDQogICAgLy8vIEByZXR1cm4gVHJ1ZSBpZiB0b2tlbnMgY2FuIGJlIHRyYW5zZmVycmVkDQogICAgZnVuY3Rpb24gVHJhbnNmZXJhYmxlKCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7DQogICAgDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogICAgLy8vIEByZXR1cm4gUXVhbnRpdHkgb2YgcmVtYWluaW5nIHRva2VucyBvZiBfb3duZXIgdGhhdCBfc3BlbmRlciBpcyBhbGxvd2VkIHRvIHNwZW5kDQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7DQogICAgDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBJbmRleCBvZiB0aGUgZnVuZGluZyBvciBwcm9wb3NhbA0KICAgIC8vLyBAcmV0dXJuIFRoZSByZXN1bHQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICBmdW5jdGlvbiBGdW5kZWRBbW91bnQodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBmdW5kaW5nIG9yIHByb3Bvc2FsDQogICAgLy8vIEByZXR1cm4gVGhlIGFtb3VudCB0byBmdW5kDQogICAgZnVuY3Rpb24gQW1vdW50VG9GdW5kKHVpbnQgX3Byb3Bvc2FsSUQpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgSW5kZXggb2YgdGhlIGZ1bmRpbmcgb3IgcHJvcG9zYWwNCiAgICAvLy8gQHJldHVybiB0aGUgdG9rZW4gcHJpY2UgbXVsdGlwbGllcg0KICAgIGZ1bmN0aW9uIHByaWNlTXVsdGlwbGllcih1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBmdW5kaW5nIG9yIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfc2FsZURhdGUgaW4gY2FzZSBvZiBwcmVzYWxlLCB0aGUgZGF0ZSBvZiB0aGUgcHJlc2FsZQ0KICAgIC8vLyBAcmV0dXJuIHRoZSBzaGFyZSBvciB0b2tlbiBwcmljZSBkaXZpc29yIGNvbmRpZGVyaW5nIHRoZSBzYWxlIGRhdGUgYW5kIHRoZSBpbmZsYXRpb24gcmF0ZQ0KICAgIGZ1bmN0aW9uIHByaWNlRGl2aXNvcigNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCwgDQogICAgICAgIHVpbnQgX3NhbGVEYXRlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBmdW5kaW5nIG9yIHByb3Bvc2FsDQogICAgLy8vIEByZXR1cm4gdGhlIGFjdHVhbCBwcmljZSBkaXZpc29yIG9mIGEgc2hhcmUgb3IgdG9rZW4NCiAgICBmdW5jdGlvbiBhY3R1YWxQcmljZURpdmlzb3IodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdGhlIGFtb3VudCBpbiB0b2tlbnMgYWNjb3JkaW5nIHRvIGEgcHJpY2UgICAgDQogICAgLy8vIEBwYXJhbSBfd2VpQW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkNCiAgICAvLy8gQHBhcmFtIF9wcmljZU11bHRpcGxpZXIgVGhlIHByaWNlIG11bHRpcGxpZXINCiAgICAvLy8gQHBhcmFtIF9wcmljZURpdmlzb3IgVGhlIHByaWNlIGRpdmlzb3INCiAgICAvLy8gQHJldHVybiB0aGUgYW1vdW50IGluIHRva2VucyANCiAgICBmdW5jdGlvbiBUb2tlbkFtb3VudCgNCiAgICAgICAgdWludCBfd2VpQW1vdW50LA0KICAgICAgICB1aW50IF9wcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9wcmljZURpdmlzb3IpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHRoZSBhbW91bnQgaW4gd2VpIGFjY29yZGluZyB0byBhIHByaWNlICAgIA0KICAgIC8vLyBAcGFyYW0gX3Rva2VuQW1vdW50IFRoZSBhbW91bnQgKGluIHdlaSkNCiAgICAvLy8gQHBhcmFtIF9wcmljZU11bHRpcGxpZXIgVGhlIHByaWNlIG11bHRpcGxpZXINCiAgICAvLy8gQHBhcmFtIF9wcmljZURpdmlzb3IgVGhlIHByaWNlIGRpdmlzb3INCiAgICAvLy8gQHJldHVybiB0aGUgYW1vdW50IGluIHdlaQ0KICAgIGZ1bmN0aW9uIHdlaUFtb3VudCgNCiAgICAgICAgdWludCBfdG9rZW5BbW91bnQsIA0KICAgICAgICB1aW50IF9wcmljZU11bHRpcGxpZXIsIA0KICAgICAgICB1aW50IF9wcmljZURpdmlzb3IpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpOw0KICAgICAgICANCiAgICAvLy8gQHBhcmFtIF90b2tlbkFtb3VudCBUaGUgYW1vdW50IGluIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbC4gMCBpZiBub3QgbGlua2VkIHRvIGEgcHJvcG9zYWwuDQogICAgLy8vIEByZXR1cm4gdGhlIGFjdHVhbCB0b2tlbiBwcmljZSBpbiB3ZWkNCiAgICBmdW5jdGlvbiBUb2tlblByaWNlSW5XZWkodWludCBfdG9rZW5BbW91bnQsIHVpbnQgX3Byb3Bvc2FsSUQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAcmV0dXJuIFRoZSBpbmRleCBvZiB0aGUgbGFzdCBmdW5kaW5nIGFuZCBjbGllbnQncyBwcm9wb3NhbCANCiAgICBmdW5jdGlvbiBMYXN0UHJvcG9zYWxJRCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEByZXR1cm4gVGhlIG51bWJlciBvZiBzaGFyZSBvciB0b2tlbiBob2xkZXJzICh1c2VkIGZvciBjbG9uaW5nKQ0KICAgIGZ1bmN0aW9uIG51bWJlck9mSG9sZGVycygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBwYXJhbSBfaW5kZXggVGhlIGluZGV4IG9mIHRoZSBob2xkZXINCiAgICAvLy8gQHJldHVybiB0aGUgYWRkcmVzcyBvZiB0aGUgaG9sZGVyDQogICAgZnVuY3Rpb24gSG9sZGVyQWRkcmVzcyh1aW50IF9pbmRleCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAoYWRkcmVzcyk7DQogICANCiAgICAvLy8gQGRldiBUaGUgY29uc3RydWN0b3IgZnVuY3Rpb24NCiAgICAvLy8gQHBhcmFtIF9wYXNzRGFvIEFkZHJlc3Mgb2YgdGhlIHBhc3MgRGFvIHNtYXJ0IGNvbnRyYWN0DQogICAgLy8vIEBwYXJhbSBfY2xvbmVkRnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgbGFzdCBNYW5hZ2VyIGJlZm9yZSBjbG9uaW5nDQogICAgLy8vIEBwYXJhbSBfdG9rZW5OYW1lIFRoZSB0b2tlbiBuYW1lIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICAvLy8gQHBhcmFtIF90b2tlblN5bWJvbCBUaGUgdG9rZW4gc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICAvLy8gQHBhcmFtIF90b2tlbkRlY2ltYWxzIFRoZSBxdWFudGl0eSBvZiBkZWNpbWFscyBmb3IgZGlzcGxheSBwdXJwb3NlDQogICAgLy8vIEBwYXJhbSAgX3Rva2VuIFRydWUgaWYgdG9rZW5zLCBmYWxzZSBpZiBzaGFyZXMNCiAgICAvLy8gQHBhcmFtICBfdHJhbnNmZXJhYmxlIFRydWUgaWYgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcnJlZA0KICAgIC8vLyBAcGFyYW0gX2luaXRpYWxQcmljZU11bHRpcGxpZXIgUHJpY2UgbXVsdGlwbGllciB3aXRob3V0IGNvbnNpZGVyaW5nIGFueSBpbmZsYXRpb24gcmF0ZQ0KICAgIC8vLyBAcGFyYW0gX2luZmxhdGlvblJhdGUgSWYgMCwgdGhlIHRva2VuIHByaWNlIGRvZXNuJ3QgY2hhbmdlIGR1cmluZyB0aGUgZnVuZGluZw0KICAgIC8vZnVuY3Rpb24gUGFzc1Rva2VuTWFuYWdlcigNCiAgICAvLyAgICBhZGRyZXNzIF9wYXNzRGFvLA0KICAgIC8vICAgIGFkZHJlc3MgX2Nsb25lZEZyb20sDQogICAgLy8gICAgc3RyaW5nIF90b2tlbk5hbWUsDQogICAgLy8gICAgc3RyaW5nIF90b2tlblN5bWJvbCwNCiAgICAvLyAgICB1aW50OCBfdG9rZW5EZWNpbWFscywNCiAgICAvLyAgICBib29sIF90b2tlbiwNCiAgICAvLyAgICBib29sIF90cmFuc2ZlcmFibGUsDQogICAgLy8gICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwNCiAgICAvLyAgICB1aW50IF9pbmZsYXRpb25SYXRlKTsNCiAgICANCiAgICAvLy8gQGRldiBGdW5jdGlvbiB0byBjcmVhdGUgaW5pdGlhbCB0b2tlbnMgICAgDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBiZW5lZmljaWFyeSBvZiB0aGUgY3JlYXRlZCB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9xdWFudGl0eSBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIHRvIGNyZWF0ZSAgICANCiAgICAvLy8gQHBhcmFtIF9sYXN0IFRydWUgaWYgdGhlIGluaXRpYWwgdG9rZW4gc3VwcHkgaXMgb3Zlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdCAgICAgDQogICAgZnVuY3Rpb24gaW5pdGlhbFRva2VuU3VwcGx5KA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9xdWFudGl0eSwNCiAgICAgICAgYm9vbCBfbGFzdCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICAgICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gY2xvbmUgdG9rZW5zIGJlZm9yZSB1cGdyYWRpbmcNCiAgICAvLy8gQHBhcmFtIF9mcm9tIFRoZSBpbmRleCBvZiB0aGUgZmlyc3QgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IGhvbGRlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdCANCiAgICBmdW5jdGlvbiBjbG9uZVRva2VucygNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8pIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgYSBuZXcgdG9rZW4gb3Igc2hhcmUgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBvciBzaGFyZSBob2xkZXINCiAgICBmdW5jdGlvbiBhZGRIb2xkZXIoYWRkcmVzcyBfaG9sZGVyKSBpbnRlcm5hbDsNCiAgICANCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjcmVhdGUgaW5pdGlhbCB0b2tlbnMgICAgDQogICAgLy8vIEBwYXJhbSBfaG9sZGVyIFRoZSBiZW5lZmljaWFyeSBvZiB0aGUgY3JlYXRlZCB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF90b2tlbkFtb3VudCBUaGUgYW1vdW50IGluIHRva2VucyB0byBjcmVhdGUNCiAgICBmdW5jdGlvbiBjcmVhdGVUb2tlbnMoDQogICAgICAgIGFkZHJlc3MgX2hvbGRlciwgDQogICAgICAgIHVpbnQgX3Rva2VuQW1vdW50KSBpbnRlcm5hbDsNCiAgICAgICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY2xpZW50IHRvIHBheSB3aXRoIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudCBvZiBzaGFyZXMgb3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgKGluIFdlaSkgdG8gY2FsY3VsYXRlIHRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGNyZWF0ZQ0KICAgIC8vLyBAcmV0dXJuIHRoZSByZXdhcmRlZCBhbW91bnQgaW4gdG9rZW5zIG9yIHNoYXJlcw0KICAgIGZ1bmN0aW9uIHJld2FyZFRva2Vuc0ZvckNsaWVudCgNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50KSBleHRlcm5hbCAgcmV0dXJucyAodWludCk7DQogICAgICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHNldCBhIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9tb2RlcmF0b3IgVGhlIGFkZHJlc3Mgb2YgdGhlIHNtYXJ0IGNvbnRyYWN0IHRvIG1hbmFnZSBhIHByaXZhdGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2luaXRpYWxQcmljZU11bHRpcGxpZXIgUHJpY2UgbXVsdGlwbGllciB3aXRob3V0IGNvbnNpZGVyaW5nIGFueSBpbmZsYXRpb24gcmF0ZQ0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudFRvRnVuZCBUaGUgYW1vdW50IChpbiB3ZWkpIG9mIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfbWludXRlc0Z1bmRpbmdQZXJpb2QgUGVyaW9kIGluIG1pbnV0ZXMgb2YgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9pbmZsYXRpb25SYXRlIElmIDAsIHRoZSB0b2tlbiBwcmljZSBkb2Vzbid0IGNoYW5nZSBkdXJpbmcgdGhlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBjbGllbnQgcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nUnVsZXMoDQogICAgICAgIGFkZHJlc3MgX21vZGVyYXRvciwNCiAgICAgICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwNCiAgICAgICAgdWludCBfYW1vdW50VG9GdW5kLA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQpIGV4dGVybmFsOw0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gZm9yIHRoZSBzYWxlIG9mIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBjbGllbnQgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIHJlY2lwaWVudCBhZGRyZXNzIG9mIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGZ1bmRlZCBhbW91bnQgKGluIHdlaSkNCiAgICAvLy8gQHBhcmFtIF9zYWxlRGF0ZSBJbiBjYXNlIG9mIHByZXNhbGUsIHRoZSBkYXRlIG9mIHRoZSBwcmVzYWxlDQogICAgLy8vIEBwYXJhbSBfcHJlc2FsZSBUcnVlIGlmIHByZXNhbGUNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBjcmVhdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBzYWxlKA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQsDQogICAgICAgIHVpbnQgX3NhbGVEYXRlLA0KICAgICAgICBib29sIF9wcmVzYWxlDQogICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNsb3NlIHRoZSBhY3R1YWwgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbA0KICAgIGZ1bmN0aW9uIGNsb3NlRnVuZGluZyh1aW50IF9wcm9wb3NhbElEKSBpbnRlcm5hbDsNCiAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHNlbmQgdG9rZW5zIG9yIHJlZnVuZCBhZnRlciB0aGUgY2xvc2luZyB0aW1lIG9mIHRoZSBmdW5kaW5nIHByb3Bvc2Fscw0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGZpcnN0IHByb3Bvc2FsLiAwIGlmIG5vdCBsaW5rZWQgdG8gYSBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBsYXN0IHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfYnV5ZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGJ1eWVyDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHNlbmRQZW5kaW5nQW1vdW50cyggICAgICAgIA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bywNCiAgICAgICAgYWRkcmVzcyBfYnV5ZXIpIHJldHVybnMgKGJvb2wpOw0KICAgICAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBnZXQgZmVlcywgc2hhcmVzIG9yIHJlZnVuZCBhZnRlciB0aGUgY2xvc2luZyB0aW1lIG9mIHRoZSBmdW5kaW5nIHByb3Bvc2Fscw0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3UGVuZGluZ0Ftb3VudHMoKSByZXR1cm5zIChib29sKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBtYWluIHBhcnRuZXIgdG8gc2V0IHRoZSBzdGFydCB0aW1lIG9mIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBJbmRleCBvZiB0aGUgY2xpZW50IHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfc3RhcnRUaW1lIFRoZSB1bml4IHN0YXJ0IGRhdGUgb2YgdGhlIGZ1bmRpbmcgDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1N0YXJ0VGltZSgNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCwgDQogICAgICAgIHVpbnQgX3N0YXJ0VGltZSkgZXh0ZXJuYWw7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgbWFpbiBwYXJ0bmVyIHRvIHNldCB0aGUgZnVuZGluZyBmdWVsZWQNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBjbGllbnQgcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKHVpbnQgX3Byb3Bvc2FsSUQpIGV4dGVybmFsOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gYWJsZSB0aGUgdHJhbnNmZXIgb2YgRGFvIHNoYXJlcyBvciBjb250cmFjdG9yIHRva2Vucw0KICAgIGZ1bmN0aW9uIGFibGVUcmFuc2ZlcigpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gZGlzYWJsZSB0aGUgdHJhbnNmZXIgb2YgRGFvIHNoYXJlcw0KICAgIGZ1bmN0aW9uIGRpc2FibGVUcmFuc2ZlcigpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY2xpZW50IHRvIGJsb2NrIHRoZSB0cmFuc2ZlciBvZiBzaGFyZXMgZnJvbSBhbmQgdG8gYSBzaGFyZSBob2xkZXINCiAgICAvLy8gQHBhcmFtIF9zaGFyZUhvbGRlciBUaGUgYWRkcmVzcyBvZiB0aGUgc2hhcmUgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfZGVhZExpbmUgV2hlbiB0aGUgYWNjb3VudCB3aWxsIGJlIHVuYmxvY2tlZA0KICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNmZXIoDQogICAgICAgIGFkZHJlc3MgX3NoYXJlSG9sZGVyLCANCiAgICAgICAgdWludCBfZGVhZExpbmUpIGV4dGVybmFsOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX0Zyb21gDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLA0KICAgICAgICBhZGRyZXNzIF90bywgDQogICAgICAgIHVpbnQyNTYgX3ZhbHVlDQogICAgICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYG1zZy5zZW5kZXJgDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX2Zyb21gIG9uIHRoZSBjb25kaXRpb24gaXQgaXMgYXBwcm92ZWQgYnkgYF9mcm9tYA0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIHNlbmRlcg0KICAgIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgcXVhbnRpdHkgb2Ygc2hhcmVzIG9yIHRva2VucyB0byBiZSB0cmFuc2ZlcnJlZA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgNCiAgICAgICAgYWRkcmVzcyBfZnJvbSwgDQogICAgICAgIGFkZHJlc3MgX3RvLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUNCiAgICAgICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc3BlbmQgYF9hbW91bnRgIHRva2VucyBvbiBpdHMgYmVoYWxmDQogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBhcHByb3ZlZCBmb3IgdHJhbnNmZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBhcHByb3ZlKA0KICAgICAgICBhZGRyZXNzIF9zcGVuZGVyLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgDQogICAgZXZlbnQgVG9rZW5zQ3JlYXRlZChhZGRyZXNzIGluZGV4ZWQgU2VuZGVyLCBhZGRyZXNzIGluZGV4ZWQgVG9rZW5Ib2xkZXIsIHVpbnQgVG9rZW5BbW91bnQpOw0KICAgIGV2ZW50IEZ1bmRpbmdSdWxlc1NldChhZGRyZXNzIGluZGV4ZWQgTW9kZXJhdG9yLCB1aW50IGluZGV4ZWQgUHJvcG9zYWxJZCwgdWludCBBbW91bnRUb0Z1bmQsIHVpbnQgaW5kZXhlZCBTdGFydFRpbWUsIHVpbnQgQ2xvc2luZ1RpbWUpOw0KICAgIGV2ZW50IEZ1bmRpbmdGdWVsZWQodWludCBpbmRleGVkIFByb3Bvc2FsSUQsIHVpbnQgRnVuZGVkQW1vdW50KTsNCiAgICBldmVudCBUcmFuc2ZlckFibGUoKTsNCiAgICBldmVudCBUcmFuc2ZlckRpc2FibGUoKTsNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgICBldmVudCBSZWZ1bmQoYWRkcmVzcyBpbmRleGVkIEJ1eWVyLCB1aW50IEFtb3VudCk7DQogICAgDQp9ICAgIA0KDQpjb250cmFjdCBQYXNzVG9rZW5NYW5hZ2VyIGlzIFBhc3NUb2tlbk1hbmFnZXJJbnRlcmZhY2Ugew0KDQovLyBDb25zdGFudCBmdW5jdGlvbnMNCg0KICAgIGZ1bmN0aW9uIENsaWVudCgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIHBhc3NEYW8uQWN0dWFsQ29tbWl0dGVlUm9vbSgpOw0KICAgIH0NCiAgIA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gdG90YWxUb2tlblN1cHBseTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgfQ0KICAgICANCiAgICBmdW5jdGlvbiBUcmFuc2ZlcmFibGUoKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zIChib29sKSB7DQogICAgICAgIHJldHVybiB0cmFuc2ZlcmFibGU7DQogICAgfQ0KIA0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZSgNCiAgICAgICAgYWRkcmVzcyBfb3duZXIsIA0KICAgICAgICBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgew0KICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBGdW5kZWRBbW91bnQodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmZ1bmRlZEFtb3VudDsNCiAgICB9DQogIA0KICAgIGZ1bmN0aW9uIEFtb3VudFRvRnVuZCh1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgaWYgKG5vdyA+IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgbm93IDwgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLnN0YXJ0VGltZSkgew0KICAgICAgICAgICAgcmV0dXJuIDA7ICAgDQogICAgICAgICAgICB9IGVsc2UgcmV0dXJuIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5hbW91bnRUb0Z1bmQ7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHByaWNlTXVsdGlwbGllcih1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcHJpY2VEaXZpc29yKHVpbnQgX3Byb3Bvc2FsSUQsIHVpbnQgX3NhbGVEYXRlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgX2RhdGUgPSBfc2FsZURhdGU7DQogICAgICAgIA0KICAgICAgICBpZiAoX3NhbGVEYXRlID4gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmNsb3NpbmdUaW1lKSBfZGF0ZSA9IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5jbG9zaW5nVGltZTsNCiAgICAgICAgaWYgKF9zYWxlRGF0ZSA8IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5zdGFydFRpbWUpIF9kYXRlID0gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLnN0YXJ0VGltZTsNCg0KICAgICAgICByZXR1cm4gMTAwICsgMTAwKmZ1bmRpbmdzW19wcm9wb3NhbElEXS5pbmZsYXRpb25SYXRlKihfZGF0ZSAtIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5zdGFydFRpbWUpLygxMDAqMzY1IGRheXMpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhY3R1YWxQcmljZURpdmlzb3IodWludCBfcHJvcG9zYWxJRCkgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gcHJpY2VEaXZpc29yKF9wcm9wb3NhbElELCBub3cpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBUb2tlbkFtb3VudCgNCiAgICAgICAgdWludCBfd2VpQW1vdW50LCANCiAgICAgICAgdWludCBfcHJpY2VNdWx0aXBsaWVyLCANCiAgICAgICAgdWludCBfcHJpY2VEaXZpc29yKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICB1aW50IF9hID0gX3dlaUFtb3VudCpfcHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICB1aW50IF9tdWx0aXBsaWVyID0gMTAwKl9hOw0KICAgICAgICB1aW50IF9hbW91bnQgPSBfbXVsdGlwbGllci9fcHJpY2VEaXZpc29yOw0KICAgICAgICBpZiAoX2EvX3dlaUFtb3VudCAhPSBfcHJpY2VNdWx0aXBsaWVyDQogICAgICAgICAgICB8fCBfbXVsdGlwbGllci8xMDAgIT0gX2EpIHJldHVybiAwOyANCiAgICAgICAgDQogICAgICAgIHJldHVybiBfYW1vdW50Ow0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiB3ZWlBbW91bnQoDQogICAgICAgIHVpbnQgX3Rva2VuQW1vdW50LCANCiAgICAgICAgdWludCBfcHJpY2VNdWx0aXBsaWVyLCANCiAgICAgICAgdWludCBfcHJpY2VEaXZpc29yKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICB1aW50IF9tdWx0aXBsaWVyID0gX3Rva2VuQW1vdW50Kl9wcmljZURpdmlzb3I7DQogICAgICAgIHVpbnQgX2Rpdmlzb3IgPSAxMDAqX3ByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgdWludCBfYW1vdW50ID0gX211bHRpcGxpZXIvX2Rpdmlzb3I7DQogICAgICAgIGlmIChfbXVsdGlwbGllci9fdG9rZW5BbW91bnQgIT0gX3ByaWNlRGl2aXNvcg0KICAgICAgICAgICAgfHwgX2Rpdmlzb3IvMTAwICE9IF9wcmljZU11bHRpcGxpZXIpIHJldHVybiAwOyANCg0KICAgICAgICByZXR1cm4gX2Ftb3VudDsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gVG9rZW5QcmljZUluV2VpKHVpbnQgX3Rva2VuQW1vdW50LCB1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiB3ZWlBbW91bnQoX3Rva2VuQW1vdW50LCBwcmljZU11bHRpcGxpZXIoX3Byb3Bvc2FsSUQpLCBhY3R1YWxQcmljZURpdmlzb3IoX3Byb3Bvc2FsSUQpKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gTGFzdFByb3Bvc2FsSUQoKSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBsYXN0UHJvcG9zYWxJRDsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZIb2xkZXJzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gaG9sZGVycy5sZW5ndGggLSAxOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBIb2xkZXJBZGRyZXNzKHVpbnQgX2luZGV4KSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zIChhZGRyZXNzKSB7DQogICAgICAgIHJldHVybiBob2xkZXJzW19pbmRleF07DQogICAgfQ0KDQovLyBNb2RpZmllcnMNCg0KICAgIC8vIE1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgdGhlIGNsaWVudCAuLg0KICAgIG1vZGlmaWVyIG9ubHlDbGllbnQge2lmIChtc2cuc2VuZGVyICE9IENsaWVudCgpKSB0aHJvdzsgXzt9DQogICAgICANCiAgICAvLyBNb2RpZmllciBmb3Igc2hhcmUgTWFuYWdlciBmdW5jdGlvbnMNCiAgICBtb2RpZmllciBvbmx5U2hhcmVNYW5hZ2VyIHtpZiAodG9rZW4pIHRocm93OyBfO30NCg0KICAgIC8vIE1vZGlmaWVyIGZvciB0b2tlbiBNYW5hZ2VyIGZ1bmN0aW9ucw0KICAgIG1vZGlmaWVyIG9ubHlUb2tlbk1hbmFnZXIge2lmICghdG9rZW4pIHRocm93OyBfO30NCiAgDQovLyBDb25zdHJ1Y3RvciBmdW5jdGlvbg0KDQogICAgZnVuY3Rpb24gUGFzc1Rva2VuTWFuYWdlcigNCiAgICAgICAgUGFzc0RhbyBfcGFzc0RhbywNCiAgICAgICAgYWRkcmVzcyBfY2xvbmVkRnJvbSwNCiAgICAgICAgc3RyaW5nIF90b2tlbk5hbWUsDQogICAgICAgIHN0cmluZyBfdG9rZW5TeW1ib2wsDQogICAgICAgIHVpbnQ4IF90b2tlbkRlY2ltYWxzLA0KICAgICAgICBib29sIF90b2tlbiwNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJhYmxlLA0KICAgICAgICB1aW50IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLA0KICAgICAgICB1aW50IF9pbmZsYXRpb25SYXRlKSB7DQoNCiAgICAgICAgcGFzc0RhbyA9IF9wYXNzRGFvOw0KICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsNCiAgICAgICAgDQogICAgICAgIGNsb25lZEZyb20gPSBfY2xvbmVkRnJvbTsgICAgICAgICAgICANCg0KICAgICAgICBuYW1lID0gX3Rva2VuTmFtZTsNCiAgICAgICAgc3ltYm9sID0gX3Rva2VuU3ltYm9sOw0KICAgICAgICBkZWNpbWFscyA9IF90b2tlbkRlY2ltYWxzOw0KDQogICAgICAgIHRva2VuID0gX3Rva2VuOw0KICAgICAgICB0cmFuc2ZlcmFibGUgPSBfdHJhbnNmZXJhYmxlOw0KDQogICAgICAgIGZ1bmRpbmdzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBfaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgZnVuZGluZ3NbMF0uaW5mbGF0aW9uUmF0ZSA9IF9pbmZsYXRpb25SYXRlOw0KDQogICAgICAgIGhvbGRlcnMubGVuZ3RoID0gMTsNCiAgICB9DQoNCi8vIFNldHRpbmcgZnVuY3Rpb25zDQoNCiAgICBmdW5jdGlvbiBpbml0aWFsVG9rZW5TdXBwbHkoDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX3F1YW50aXR5LA0KICAgICAgICBib29sIF9sYXN0KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCg0KICAgICAgICBpZiAoaW5pdGlhbFRva2VuU3VwcGx5RG9uZSkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBhZGRIb2xkZXIoX3JlY2lwaWVudCk7DQogICAgICAgIGlmIChfcmVjaXBpZW50ICE9IDAgJiYgX3F1YW50aXR5ICE9IDApIGNyZWF0ZVRva2VucyhfcmVjaXBpZW50LCBfcXVhbnRpdHkpOw0KICAgICAgICANCiAgICAgICAgaWYgKF9sYXN0KSBpbml0aWFsVG9rZW5TdXBwbHlEb25lID0gdHJ1ZTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsb25lVG9rZW5zKA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIA0KICAgICAgICBpbml0aWFsVG9rZW5TdXBwbHlEb25lID0gdHJ1ZTsNCiAgICAgICAgaWYgKF9mcm9tID09IDApIF9mcm9tID0gMTsNCiAgICAgICAgDQogICAgICAgIFBhc3NUb2tlbk1hbmFnZXIgX2Nsb25lZEZyb20gPSBQYXNzVG9rZW5NYW5hZ2VyKGNsb25lZEZyb20pOw0KICAgICAgICB1aW50IF9udW1iZXJPZkhvbGRlcnMgPSBfY2xvbmVkRnJvbS5udW1iZXJPZkhvbGRlcnMoKTsNCiAgICAgICAgaWYgKF90byA9PSAwIHx8IF90byA+IF9udW1iZXJPZkhvbGRlcnMpIF90byA9IF9udW1iZXJPZkhvbGRlcnM7DQogICAgICAgIA0KICAgICAgICBhZGRyZXNzIF9ob2xkZXI7DQogICAgICAgIHVpbnQgX2JhbGFuY2U7DQoNCiAgICAgICAgZm9yICh1aW50IGkgPSBfZnJvbTsgaSA8PSBfdG87IGkrKykgew0KICAgICAgICAgICAgX2hvbGRlciA9IF9jbG9uZWRGcm9tLkhvbGRlckFkZHJlc3MoaSk7DQogICAgICAgICAgICBfYmFsYW5jZSA9IF9jbG9uZWRGcm9tLmJhbGFuY2VPZihfaG9sZGVyKTsNCiAgICAgICAgICAgIGlmIChiYWxhbmNlc1tfaG9sZGVyXSA9PSAwICYmIF9iYWxhbmNlICE9IDApIHsNCiAgICAgICAgICAgICAgICBhZGRIb2xkZXIoX2hvbGRlcik7DQogICAgICAgICAgICAgICAgY3JlYXRlVG9rZW5zKF9ob2xkZXIsIF9iYWxhbmNlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICAgICAgDQovLyBUb2tlbiBjcmVhdGlvbg0KDQogICAgZnVuY3Rpb24gYWRkSG9sZGVyKGFkZHJlc3MgX2hvbGRlcikgaW50ZXJuYWwgew0KICAgICAgICANCiAgICAgICAgaWYgKGhvbGRlcklEW19ob2xkZXJdID09IDApIHsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdWludCBfaG9sZGVySUQgPSBob2xkZXJzLmxlbmd0aCsrOw0KICAgICAgICAgICAgaG9sZGVyc1tfaG9sZGVySURdID0gX2hvbGRlcjsNCiAgICAgICAgICAgIGhvbGRlcklEW19ob2xkZXJdID0gX2hvbGRlcklEOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKA0KICAgICAgICBhZGRyZXNzIF9ob2xkZXIsIA0KICAgICAgICB1aW50IF90b2tlbkFtb3VudCkgaW50ZXJuYWwgew0KDQogICAgICAgIGJhbGFuY2VzW19ob2xkZXJdICs9IF90b2tlbkFtb3VudDsgDQogICAgICAgIHRvdGFsVG9rZW5TdXBwbHkgKz0gX3Rva2VuQW1vdW50Ow0KICAgICAgICBUb2tlbnNDcmVhdGVkKG1zZy5zZW5kZXIsIF9ob2xkZXIsIF90b2tlbkFtb3VudCk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHJld2FyZFRva2Vuc0ZvckNsaWVudCgNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50DQogICAgICAgICkgZXh0ZXJuYWwgb25seUNsaWVudCByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgdWludCBfdG9rZW5BbW91bnQgPSBUb2tlbkFtb3VudChfYW1vdW50LCBwcmljZU11bHRpcGxpZXIoMCksIGFjdHVhbFByaWNlRGl2aXNvcigwKSk7DQogICAgICAgIGlmIChfdG9rZW5BbW91bnQgPT0gMCkgdGhyb3c7DQoNCiAgICAgICAgYWRkSG9sZGVyKF9yZWNpcGllbnQpOw0KICAgICAgICBjcmVhdGVUb2tlbnMoX3JlY2lwaWVudCwgX3Rva2VuQW1vdW50KTsNCg0KICAgICAgICByZXR1cm4gX3Rva2VuQW1vdW50Ow0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nUnVsZXMoDQogICAgICAgIGFkZHJlc3MgX21vZGVyYXRvciwNCiAgICAgICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwNCiAgICAgICAgdWludCBfYW1vdW50VG9GdW5kLA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQNCiAgICApIGV4dGVybmFsIG9ubHlDbGllbnQgew0KDQogICAgICAgIGlmIChfbW9kZXJhdG9yID09IGFkZHJlc3ModGhpcykNCiAgICAgICAgICAgIHx8IF9tb2RlcmF0b3IgPT0gQ2xpZW50KCkNCiAgICAgICAgICAgIHx8IF9hbW91bnRUb0Z1bmQgPT0gMA0KICAgICAgICAgICAgfHwgX21pbnV0ZXNGdW5kaW5nUGVyaW9kID09IDANCiAgICAgICAgICAgIHx8IGZ1bmRpbmdzW19wcm9wb3NhbElEXS50b3RhbFdlaUdpdmVuICE9IDANCiAgICAgICAgICAgICkgdGhyb3c7DQogICAgICAgICAgICANCiAgICAgICAgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLm1vZGVyYXRvciA9IF9tb2RlcmF0b3I7DQoNCiAgICAgICAgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmFtb3VudFRvRnVuZCA9IF9hbW91bnRUb0Z1bmQ7DQogICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5mdW5kZWRBbW91bnQgPSAwOw0KDQogICAgICAgIGlmIChfaW5pdGlhbFByaWNlTXVsdGlwbGllciA9PSAwKSB7DQogICAgICAgICAgICBpZiAobm93IDwgZnVuZGluZ3NbMF0uY2xvc2luZ1RpbWUpIHsNCiAgICAgICAgICAgICAgICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9IDEwMCpwcmljZU11bHRpcGxpZXIobGFzdFByb3Bvc2FsSUQpL2FjdHVhbFByaWNlRGl2aXNvcihsYXN0UHJvcG9zYWxJRCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyID0gMTAwKnByaWNlTXVsdGlwbGllcihsYXN0RnVlbGVkRnVuZGluZ0lEKS9hY3R1YWxQcmljZURpdmlzb3IobGFzdEZ1ZWxlZEZ1bmRpbmdJRCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmdW5kaW5nc1swXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyID0gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmluaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICAgICAgZnVuZGluZ3NbMF0uaW5pdGlhbFByaWNlTXVsdGlwbGllciA9IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoX2luZmxhdGlvblJhdGUgPT0gMCkgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmluZmxhdGlvblJhdGUgPSBmdW5kaW5nc1swXS5pbmZsYXRpb25SYXRlOw0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5pbmZsYXRpb25SYXRlID0gX2luZmxhdGlvblJhdGU7DQogICAgICAgICAgICBmdW5kaW5nc1swXS5pbmZsYXRpb25SYXRlID0gX2luZmxhdGlvblJhdGU7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5zdGFydFRpbWUgPSBub3c7DQogICAgICAgIGZ1bmRpbmdzWzBdLnN0YXJ0VGltZSA9IG5vdzsNCiAgICAgICAgDQogICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5jbG9zaW5nVGltZSA9IG5vdyArIF9taW51dGVzRnVuZGluZ1BlcmlvZCAqIDEgbWludXRlczsNCiAgICAgICAgZnVuZGluZ3NbMF0uY2xvc2luZ1RpbWUgPSBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uY2xvc2luZ1RpbWU7DQogICAgICAgIA0KICAgICAgICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0udG90YWxXZWlHaXZlbiA9IDA7DQogICAgICAgIA0KICAgICAgICBsYXN0UHJvcG9zYWxJRCA9IF9wcm9wb3NhbElEOw0KICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzU2V0KF9tb2RlcmF0b3IsIF9wcm9wb3NhbElELCAgX2Ftb3VudFRvRnVuZCwgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLnN0YXJ0VGltZSwgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmNsb3NpbmdUaW1lKTsNCiAgICB9IA0KICAgIA0KICAgIGZ1bmN0aW9uIHNhbGUoDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwgDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgdWludCBfc2FsZURhdGUsDQogICAgICAgIGJvb2wgX3ByZXNhbGUpIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQogICAgICAgIGlmIChfc2FsZURhdGUgPT0gMCkgX3NhbGVEYXRlID0gbm93Ow0KDQogICAgICAgIGlmIChfc2FsZURhdGUgPiBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uY2xvc2luZ1RpbWUNCiAgICAgICAgICAgIHx8IF9zYWxlRGF0ZSA8IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5zdGFydFRpbWUNCiAgICAgICAgICAgIHx8IGZ1bmRpbmdzW19wcm9wb3NhbElEXS50b3RhbFdlaUdpdmVuICsgX2Ftb3VudCA+IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5hbW91bnRUb0Z1bmQpIHJldHVybjsNCg0KICAgICAgICB1aW50IF90b2tlbkFtb3VudCA9IFRva2VuQW1vdW50KF9hbW91bnQsIHByaWNlTXVsdGlwbGllcihfcHJvcG9zYWxJRCksIHByaWNlRGl2aXNvcihfcHJvcG9zYWxJRCwgX3NhbGVEYXRlKSk7DQogICAgICAgIGlmIChfdG9rZW5BbW91bnQgPT0gMCkgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgYWRkSG9sZGVyKF9yZWNpcGllbnQpOw0KICAgICAgICBpZiAoX3ByZXNhbGUpIHsNCiAgICAgICAgICAgIEdpdmVuW19wcm9wb3NhbElEXVtfcmVjaXBpZW50XS50b2tlbkFtb3VudCArPSBfdG9rZW5BbW91bnQ7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBjcmVhdGVUb2tlbnMoX3JlY2lwaWVudCwgX3Rva2VuQW1vdW50KTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbG9zZUZ1bmRpbmcodWludCBfcHJvcG9zYWxJRCkgaW50ZXJuYWwgew0KICAgICAgICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uZnVuZGVkQW1vdW50ID0gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLnRvdGFsV2VpR2l2ZW47DQogICAgICAgIGxhc3RGdWVsZWRGdW5kaW5nSUQgPSBfcHJvcG9zYWxJRDsNCiAgICAgICAgZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmNsb3NpbmdUaW1lID0gbm93Ow0KICAgICAgICBGdW5kaW5nRnVlbGVkKF9wcm9wb3NhbElELCBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uZnVuZGVkQW1vdW50KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZW5kUGVuZGluZ0Ftb3VudHMoICAgICAgICANCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8sDQogICAgICAgIGFkZHJlc3MgX2J1eWVyKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIA0KICAgICAgICBpZiAoX2Zyb20gPT0gMCkgX2Zyb20gPSAxOw0KICAgICAgICBpZiAoX3RvID09IDApIF90byA9IGxhc3RQcm9wb3NhbElEOw0KICAgICAgICBpZiAoX2J1eWVyID09IDApIF9idXllciA9IG1zZy5zZW5kZXI7DQoNCiAgICAgICAgdWludCBfYW1vdW50Ow0KICAgICAgICB1aW50IF90b2tlbkFtb3VudDsNCiAgICAgICAgDQogICAgICAgIGZvciAodWludCBpID0gX2Zyb207IGkgPD0gX3RvOyBpKyspIHsNCg0KICAgICAgICAgICAgaWYgKG5vdyA+IGZ1bmRpbmdzW2ldLmNsb3NpbmdUaW1lICYmIEdpdmVuW2ldW19idXllcl0ud2VpQW1vdW50ICE9IDApIHsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoZnVuZGluZ3NbaV0uZnVuZGVkQW1vdW50ID09IDApIF9hbW91bnQgKz0gR2l2ZW5baV1bX2J1eWVyXS53ZWlBbW91bnQ7DQogICAgICAgICAgICAgICAgZWxzZSBfdG9rZW5BbW91bnQgKz0gR2l2ZW5baV1bX2J1eWVyXS50b2tlbkFtb3VudDsNCg0KICAgICAgICAgICAgICAgIGZ1bmRpbmdzW2ldLnRvdGFsV2VpR2l2ZW4gLT0gR2l2ZW5baV1bX2J1eWVyXS53ZWlBbW91bnQ7DQogICAgICAgICAgICAgICAgR2l2ZW5baV1bX2J1eWVyXS50b2tlbkFtb3VudCA9IDA7DQogICAgICAgICAgICAgICAgR2l2ZW5baV1bX2J1eWVyXS53ZWlBbW91bnQgPSAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKF90b2tlbkFtb3VudCA+IDApIHsNCiAgICAgICAgICAgIGNyZWF0ZVRva2VucyhfYnV5ZXIsIF90b2tlbkFtb3VudCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKF9hbW91bnQgPiAwKSB7DQogICAgICAgICAgICBpZiAoIV9idXllci5zZW5kKF9hbW91bnQpKSB0aHJvdzsNCiAgICAgICAgICAgIFJlZnVuZChfYnV5ZXIsIF9hbW91bnQpOw0KICAgICAgICB9IGVsc2UgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIA0KDQogICAgZnVuY3Rpb24gd2l0aGRyYXdQZW5kaW5nQW1vdW50cygpIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBzZW5kUGVuZGluZ0Ftb3VudHMoMCwgMCwgbXNnLnNlbmRlcik7DQogICAgfSAgICAgICAgDQoNCi8vIEZ1bmRpbmcgTW9kZXJhdG9yIGZ1bmN0aW9ucw0KDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1N0YXJ0VGltZSh1aW50IF9wcm9wb3NhbElELCB1aW50IF9zdGFydFRpbWUpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKChtc2cuc2VuZGVyICE9ICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0ubW9kZXJhdG9yKSB8fCBub3cgPiBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICBmdW5kaW5nc1tfcHJvcG9zYWxJRF0uc3RhcnRUaW1lID0gX3N0YXJ0VGltZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRGdW5kaW5nRnVlbGVkKHVpbnQgX3Byb3Bvc2FsSUQpIGV4dGVybmFsIHsNCg0KICAgICAgICBpZiAoKG1zZy5zZW5kZXIgIT0gIGZ1bmRpbmdzW19wcm9wb3NhbElEXS5tb2RlcmF0b3IpIHx8IG5vdyA+IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5jbG9zaW5nVGltZSkgdGhyb3c7DQoNCiAgICAgICAgY2xvc2VGdW5kaW5nKF9wcm9wb3NhbElEKTsNCiAgICB9DQogICAgDQovLyBUb2tlbnMgdHJhbnNmZXIgbWFuYWdlbWVudCAgICANCiAgICANCiAgICBmdW5jdGlvbiBhYmxlVHJhbnNmZXIoKSBvbmx5Q2xpZW50IHsNCiAgICAgICAgaWYgKCF0cmFuc2ZlcmFibGUpIHsNCiAgICAgICAgICAgIHRyYW5zZmVyYWJsZSA9IHRydWU7DQogICAgICAgICAgICBUcmFuc2ZlckFibGUoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRpc2FibGVUcmFuc2ZlcigpIG9ubHlDbGllbnQgew0KICAgICAgICBpZiAodHJhbnNmZXJhYmxlKSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgIFRyYW5zZmVyRGlzYWJsZSgpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNmZXIoYWRkcmVzcyBfc2hhcmVIb2xkZXIsIHVpbnQgX2RlYWRMaW5lKSBleHRlcm5hbCBvbmx5Q2xpZW50IG9ubHlTaGFyZU1hbmFnZXIgew0KICAgICAgICBpZiAoX2RlYWRMaW5lID4gYmxvY2tlZERlYWRMaW5lW19zaGFyZUhvbGRlcl0pIHsNCiAgICAgICAgICAgIGJsb2NrZWREZWFkTGluZVtfc2hhcmVIb2xkZXJdID0gX2RlYWRMaW5lOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLA0KICAgICAgICBhZGRyZXNzIF90bywgDQogICAgICAgIHVpbnQyNTYgX3ZhbHVlDQogICAgICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7ICANCg0KICAgICAgICBpZiAoKHRyYW5zZmVyYWJsZSkNCiAgICAgICAgICAgICYmIG5vdyA+IGJsb2NrZWREZWFkTGluZVtfZnJvbV0NCiAgICAgICAgICAgICYmIG5vdyA+IGJsb2NrZWREZWFkTGluZVtfdG9dDQogICAgICAgICAgICAmJiBfdG8gIT0gYWRkcmVzcyh0aGlzKQ0KICAgICAgICAgICAgJiYgYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZQ0KICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCg0KICAgICAgICAgICAgYWRkSG9sZGVyKF90byk7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAgICAgICAgfSBlbHNlIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsgIA0KICAgICAgICBpZiAoIXRyYW5zZmVyRnJvbVRvKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKSkgdGhyb3c7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbSgNCiAgICAgICAgYWRkcmVzcyBfZnJvbSwgDQogICAgICAgIGFkZHJlc3MgX3RvLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUNCiAgICAgICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsgDQogICAgICAgIA0KICAgICAgICBpZiAoYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gPCBfdmFsdWUNCiAgICAgICAgICAgIHx8ICF0cmFuc2ZlckZyb21UbyhfZnJvbSwgX3RvLCBfdmFsdWUpKSB0aHJvdzsNCiAgICAgICAgICAgIA0KICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIA0KfQ0KICAgIA0KDQoNCnByYWdtYSBzb2xpZGl0eSBeMC40Ljg7DQoNCi8qDQogKg0KICogVGhpcyBmaWxlIGlzIHBhcnQgb2YgUGFzcyBEQU8uDQogKg0KICogVGhlIE1hbmFnZXIgc21hcnQgY29udHJhY3QgaXMgdXNlZCBmb3IgdGhlIG1hbmFnZW1lbnQgb2YgdGhlIERhbyBhY2NvdW50LCBzaGFyZXMgYW5kIHRva2Vucy4NCiAqDQoqLw0KDQovLy8gQHRpdGxlIE1hbmFnZXIgc21hcnQgY29udHJhY3Qgb2YgdGhlIFBhc3MgRGVjZW50cmFsaXplZCBBdXRvbm9tb3VzIE9yZ2FuaXNhdGlvbg0KY29udHJhY3QgUGFzc01hbmFnZXIgaXMgUGFzc1Rva2VuTWFuYWdlciB7DQogICAgDQogICAgc3RydWN0IG9yZGVyIHsNCiAgICAgICAgYWRkcmVzcyBidXllcjsNCiAgICAgICAgdWludCB3ZWlHaXZlbjsNCiAgICB9DQogICAgLy8gT3JkZXJzIHRvIGJ1eSB0b2tlbnMNCiAgICBvcmRlcltdIHB1YmxpYyBvcmRlcnM7DQogICAgLy8gTnVtYmVyIG9yIG9yZGVycyB0byBidXkgdG9rZW5zDQogICAgdWludCBudW1iZXJPZk9yZGVyczsNCg0KICAgIC8vIE1hcCB0byBrbm93IGlmIGFuIG9yZGVyIHdhcyBjbG9uZWQgZnJvbSB0aGUgcHJlY2VkZW50IG1hbmFnZXIgYWZ0ZXIgYW4gdXBncmFkZQ0KICAgIG1hcHBpbmcgKHVpbnQgPT4gYm9vbCkgb3JkZXJDbG9uZWQ7DQogICAgDQogICAgZnVuY3Rpb24gUGFzc01hbmFnZXIoDQogICAgICAgIFBhc3NEYW8gX3Bhc3NEYW8sDQogICAgICAgIGFkZHJlc3MgX2Nsb25lZEZyb20sDQogICAgICAgIHN0cmluZyBfdG9rZW5OYW1lLA0KICAgICAgICBzdHJpbmcgX3Rva2VuU3ltYm9sLA0KICAgICAgICB1aW50OCBfdG9rZW5EZWNpbWFscywNCiAgICAgICAgYm9vbCBfdG9rZW4sDQogICAgICAgIGJvb2wgX3RyYW5zZmVyYWJsZSwNCiAgICAgICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwNCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSkgDQogICAgICAgIFBhc3NUb2tlbk1hbmFnZXIoIF9wYXNzRGFvLCBfY2xvbmVkRnJvbSwgX3Rva2VuTmFtZSwgX3Rva2VuU3ltYm9sLCBfdG9rZW5EZWNpbWFscywgDQogICAgICAgICAgICBfdG9rZW4sIF90cmFuc2ZlcmFibGUsIF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLCBfaW5mbGF0aW9uUmF0ZSkgeyB9DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gcmVjZWl2ZSBwYXltZW50cw0KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgb25seVNoYXJlTWFuYWdlciB7IH0NCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjbGllbnQgdG8gc2VuZCBldGhlcnMNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3MgdG8gc2VuZCB0bw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IChpbiB3ZWkpIHRvIHNlbmQNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiBzZW5kVG8oDQogICAgICAgIGFkZHJlc3MgX3JlY2lwaWVudCwNCiAgICAgICAgdWludCBfYW1vdW50DQogICAgKSBleHRlcm5hbCBvbmx5Q2xpZW50IHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICBpZiAoX3JlY2lwaWVudC5zZW5kKF9hbW91bnQpKSByZXR1cm4gdHJ1ZTsNCiAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gdG8gYnV5IHRva2VucyBhbmQgcHJvbW90ZSBhIHByb3Bvc2FsIA0KICAgIC8vLyBAcGFyYW0gX3Byb3Bvc2FsSUQgVGhlIGluZGV4IG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2J1eWVyIFRoZSBhZGRyZXNzIG9mIHRoZSBidXllcg0KICAgIC8vLyBAcGFyYW0gX2RhdGUgVGhlIHVuaXggZGF0ZSB0byBjb25zaWRlciBmb3IgdGhlIHNoYXJlIG9yIHRva2VuIHByaWNlIGNhbGN1bGF0aW9uDQogICAgLy8vIEBwYXJhbSBfcHJlc2FsZSBUcnVlIGlmIHByZXNhbGUNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgDQogICAgZnVuY3Rpb24gYnV5VG9rZW5zRm9yKA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELA0KICAgICAgICBhZGRyZXNzIF9idXllciwgDQogICAgICAgIHVpbnQgX2RhdGUsDQogICAgICAgIGJvb2wgX3ByZXNhbGUpIGludGVybmFsIHJldHVybnMgKGJvb2wpIHsNCg0KICAgICAgICBpZiAoX3Byb3Bvc2FsSUQgPT0gMCB8fCAhc2FsZShfcHJvcG9zYWxJRCwgX2J1eWVyLCBtc2cudmFsdWUsIF9kYXRlLCBfcHJlc2FsZSkpIHRocm93Ow0KDQogICAgICAgIGZ1bmRpbmdzW19wcm9wb3NhbElEXS50b3RhbFdlaUdpdmVuICs9IG1zZy52YWx1ZTsgICAgICAgIA0KICAgICAgICBpZiAoZnVuZGluZ3NbX3Byb3Bvc2FsSURdLnRvdGFsV2VpR2l2ZW4gPT0gZnVuZGluZ3NbX3Byb3Bvc2FsSURdLmFtb3VudFRvRnVuZCkgY2xvc2VGdW5kaW5nKF9wcm9wb3NhbElEKTsNCg0KICAgICAgICBHaXZlbltfcHJvcG9zYWxJRF1bX2J1eWVyXS53ZWlBbW91bnQgKz0gbXNnLnZhbHVlOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGJ1eSB0b2tlbnMgYW5kIHByb21vdGUgYSBwcm9wb3NhbCANCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9idXllciBUaGUgYWRkcmVzcyBvZiB0aGUgYnV5ZXIgKG5vdCBtYW5kYXRvcnksIG1zZy5zZW5kZXIgaWYgMCkNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgDQogICAgZnVuY3Rpb24gYnV5VG9rZW5zRm9yUHJvcG9zYWwoDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQsIA0KICAgICAgICBhZGRyZXNzIF9idXllcikgcGF5YWJsZSByZXR1cm5zIChib29sKSB7DQoNCiAgICAgICAgaWYgKF9idXllciA9PSAwKSBfYnV5ZXIgPSBtc2cuc2VuZGVyOw0KDQogICAgICAgIGlmIChmdW5kaW5nc1tfcHJvcG9zYWxJRF0ubW9kZXJhdG9yICE9IDApIHRocm93Ow0KDQogICAgICAgIHJldHVybiBidXlUb2tlbnNGb3IoX3Byb3Bvc2FsSUQsIF9idXllciwgbm93LCB0cnVlKTsNCiAgICB9DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBtb2RlcmF0b3IgdG8gYnV5IHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIEluZGV4IG9mIHRoZSBjbGllbnQgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9idXllciBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9kYXRlIFRoZSB1bml4IGRhdGUgdG8gY29uc2lkZXIgZm9yIHRoZSBzaGFyZSBvciB0b2tlbiBwcmljZSBjYWxjdWxhdGlvbg0KICAgIC8vLyBAcGFyYW0gX3ByZXNhbGUgVHJ1ZSBpZiBwcmVzYWxlDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGJ1eVRva2VuRnJvbU1vZGVyYXRvcigNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCwNCiAgICAgICAgYWRkcmVzcyBfYnV5ZXIsIA0KICAgICAgICB1aW50IF9kYXRlLA0KICAgICAgICBib29sIF9wcmVzYWxlKSBwYXlhYmxlIGV4dGVybmFsIHJldHVybnMgKGJvb2wpew0KDQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGZ1bmRpbmdzW19wcm9wb3NhbElEXS5tb2RlcmF0b3IpIHRocm93Ow0KDQogICAgICAgIHJldHVybiBidXlUb2tlbnNGb3IoX3Byb3Bvc2FsSUQsIF9idXllciwgX2RhdGUsIF9wcmVzYWxlKTsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjcmVhdGUgYSBidXkgb3JkZXINCiAgICAvLy8gQHBhcmFtIF9idXllciBUaGUgYWRkcmVzcyBvZiB0aGUgYnV5ZXINCiAgICAvLy8gQHBhcmFtIF93ZWlHaXZlbiBUaGUgYW1vdW50IGluIHdlaSBnaXZlbiBieSB0aGUgYnV5ZXINCiAgICBmdW5jdGlvbiBhZGRPcmRlcigNCiAgICAgICAgYWRkcmVzcyBfYnV5ZXIsIA0KICAgICAgICB1aW50IF93ZWlHaXZlbikgaW50ZXJuYWwgew0KDQogICAgICAgIHVpbnQgaTsNCiAgICAgICAgbnVtYmVyT2ZPcmRlcnMgKz0gMTsNCg0KICAgICAgICBpZiAobnVtYmVyT2ZPcmRlcnMgPiBvcmRlcnMubGVuZ3RoKSBpID0gb3JkZXJzLmxlbmd0aCsrOw0KICAgICAgICBlbHNlIGkgPSBudW1iZXJPZk9yZGVycyAtIDE7DQogICAgICAgIA0KICAgICAgICBvcmRlcnNbaV0uYnV5ZXIgPSBfYnV5ZXI7DQogICAgICAgIG9yZGVyc1tpXS53ZWlHaXZlbiA9IF93ZWlHaXZlbjsNCiAgICB9DQoNCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byByZW1vdmUgYSBidXkgb3JkZXINCiAgICAvLy8gQHBhcmFtIF9vcmRlciBUaGUgaW5kZXggb2YgdGhlIG9yZGVyIHRvIHJlbW92ZQ0KICAgIGZ1bmN0aW9uIHJlbW92ZU9yZGVyKHVpbnQgX29yZGVyKSBpbnRlcm5hbCB7DQogICAgICAgIA0KICAgICAgICBpZiAobnVtYmVyT2ZPcmRlcnMgLSAxIDwgX29yZGVyKSByZXR1cm47DQoNCiAgICAgICAgbnVtYmVyT2ZPcmRlcnMgLT0gMTsNCiAgICAgICAgaWYgKG51bWJlck9mT3JkZXJzID4gMCkgew0KICAgICAgICAgICAgZm9yICh1aW50IGkgPSBfb3JkZXI7IGkgPD0gbnVtYmVyT2ZPcmRlcnMgLSAxOyBpKyspIHsNCiAgICAgICAgICAgICAgICBvcmRlcnNbaV0uYnV5ZXIgPSBvcmRlcnNbaSsxXS5idXllcjsNCiAgICAgICAgICAgICAgICBvcmRlcnNbaV0ud2VpR2l2ZW4gPSBvcmRlcnNbaSsxXS53ZWlHaXZlbjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBvcmRlcnNbbnVtYmVyT2ZPcmRlcnNdLmJ1eWVyID0gMDsNCiAgICAgICAgb3JkZXJzW251bWJlck9mT3JkZXJzXS53ZWlHaXZlbiA9IDA7DQogICAgfQ0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNyZWF0ZSBvcmRlcnMgdG8gYnV5IHRva2Vucw0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGZ1bmN0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIGJ1eVRva2VucygpIHBheWFibGUgcmV0dXJucyAoYm9vbCkgew0KDQogICAgICAgIGlmICghdHJhbnNmZXJhYmxlIHx8IG1zZy52YWx1ZSA8IDEwMCBmaW5uZXkpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgYWRkT3JkZXIobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBzZWxsIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3Rva2VuQW1vdW50IGluIHRva2VucyB0byBzZWxsDQogICAgLy8vIEBwYXJhbSBfZnJvbSBJbmRleCBvZiB0aGUgZmlyc3Qgb3JkZXINCiAgICAvLy8gQHBhcmFtIF90byBJbmRleCBvZiB0aGUgbGFzdCBvcmRlcg0KICAgIC8vLyBAcmV0dXJuIHRoZSByZXZlbnVlIGluIHdlaQ0KICAgIGZ1bmN0aW9uIHNlbGxUb2tlbnMoDQogICAgICAgIHVpbnQgX3Rva2VuQW1vdW50LA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bykgcmV0dXJucyAodWludCkgew0KDQogICAgICAgIGlmICghdHJhbnNmZXJhYmxlIA0KICAgICAgICAgICAgfHwgdWludChiYWxhbmNlc1ttc2cuc2VuZGVyXSkgPCBfYW1vdW50IA0KICAgICAgICAgICAgfHwgbnVtYmVyT2ZPcmRlcnMgPT0gMCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBpZiAoX3RvID09IDAgfHwgX3RvID4gbnVtYmVyT2ZPcmRlcnMgLSAxKSBfdG8gPSBudW1iZXJPZk9yZGVycyAtIDE7DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgdWludCBfdG9rZW5BbW91bnRvOw0KICAgICAgICB1aW50IF9hbW91bnQ7DQogICAgICAgIHVpbnQgX3RvdGFsQW1vdW50Ow0KICAgICAgICB1aW50IG8gPSBfZnJvbTsNCg0KICAgICAgICBmb3IgKHVpbnQgaSA9IF9mcm9tOyBpIDw9IF90bzsgaSsrKSB7DQoNCiAgICAgICAgICAgIGlmIChfdG9rZW5BbW91bnQgPiAwICYmIG9yZGVyc1tvXS5idXllciAhPSBtc2cuc2VuZGVyKSB7DQoNCiAgICAgICAgICAgICAgICBfdG9rZW5BbW91bnRvID0gVG9rZW5BbW91bnQob3JkZXJzW29dLndlaUdpdmVuLCBwcmljZU11bHRpcGxpZXIoMCksIGFjdHVhbFByaWNlRGl2aXNvcigwKSk7DQoNCiAgICAgICAgICAgICAgICBpZiAoX3Rva2VuQW1vdW50ID49IF90b2tlbkFtb3VudG8gDQogICAgICAgICAgICAgICAgICAgICYmIHRyYW5zZmVyRnJvbVRvKG1zZy5zZW5kZXIsIG9yZGVyc1tvXS5idXllciwgX3Rva2VuQW1vdW50bykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgX3Rva2VuQW1vdW50IC09IF90b2tlbkFtb3VudG87DQogICAgICAgICAgICAgICAgICAgIF90b3RhbEFtb3VudCArPSBvcmRlcnNbb10ud2VpR2l2ZW47DQogICAgICAgICAgICAgICAgICAgIHJlbW92ZU9yZGVyKG8pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIGlmIChfdG9rZW5BbW91bnQgPCBfdG9rZW5BbW91bnRvDQogICAgICAgICAgICAgICAgICAgICYmIHRyYW5zZmVyRnJvbVRvKG1zZy5zZW5kZXIsIG9yZGVyc1tvXS5idXllciwgX3Rva2VuQW1vdW50KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIF9hbW91bnQgPSB3ZWlBbW91bnQoX3Rva2VuQW1vdW50LCBwcmljZU11bHRpcGxpZXIoMCksIGFjdHVhbFByaWNlRGl2aXNvcigwKSk7DQogICAgICAgICAgICAgICAgICAgIG9yZGVyc1tvXS53ZWlHaXZlbiAtPSBfYW1vdW50Ow0KICAgICAgICAgICAgICAgICAgICBfdG90YWxBbW91bnQgKz0gX2Ftb3VudDsNCiAgICAgICAgICAgICAgICAgICAgaSA9IF90byArIDE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UgbyArPSAxOw0KICAgICAgICAgICAgfSANCiAgICAgICAgICAgIGVsc2UgbyArPSAxOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChfdG90YWxBbW91bnQpKSB0aHJvdzsNCiAgICAgICAgZWxzZSByZXR1cm4gX3RvdGFsQW1vdW50Ow0KICAgIH0gICAgDQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byByZW1vdmUgeW91ciBvcmRlcnMgYW5kIHJlZnVuZA0KICAgIC8vLyBAcGFyYW0gX2Zyb20gSW5kZXggb2YgdGhlIGZpcnN0IG9yZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gSW5kZXggb2YgdGhlIGxhc3Qgb3JkZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiByZW1vdmVPcmRlcnMoDQogICAgICAgIHVpbnQgX2Zyb20sDQogICAgICAgIHVpbnQgX3RvKSByZXR1cm5zIChib29sKSB7DQoNCiAgICAgICAgaWYgKF90byA9PSAwIHx8IF90byA+IG51bWJlck9mT3JkZXJzKSBfdG8gPSBudW1iZXJPZk9yZGVycyAtMTsNCiAgICAgICAgDQogICAgICAgIHVpbnQgX3RvdGFsQW1vdW50Ow0KICAgICAgICB1aW50IG8gPSBfZnJvbTsNCg0KICAgICAgICBmb3IgKHVpbnQgaSA9IF9mcm9tOyBpIDw9IF90bzsgaSsrKSB7DQoNCiAgICAgICAgICAgIGlmIChvcmRlcnNbb10uYnV5ZXIgPT0gbXNnLnNlbmRlcikgew0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIF90b3RhbEFtb3VudCArPSBvcmRlcnNbb10ud2VpR2l2ZW47DQogICAgICAgICAgICAgICAgcmVtb3ZlT3JkZXIobyk7DQoNCiAgICAgICAgICAgIH0gZWxzZSBvICs9IDE7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChfdG90YWxBbW91bnQpKSB0aHJvdzsNCiAgICAgICAgZWxzZSByZXR1cm4gdHJ1ZTsNCiAgICB9DQogICAgDQp9'