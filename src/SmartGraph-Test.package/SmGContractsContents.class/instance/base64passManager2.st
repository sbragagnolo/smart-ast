base 64 content
base64passManager2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC42Ow0KDQovKg0KICoNCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFBhc3MgREFPLg0KICoNCiAqIFRoZSBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IGlzIHVzZWQgZm9yIHRoZSBtYW5hZ2VtZW50IG9mIGFjY291bnRzIGFuZCB0b2tlbnMuDQogKg0KICogUmVjaXBpZW50IGlzIDAgZm9yIHRoZSBEYW8gYWNjb3VudCBtYW5hZ2VyIGFuZCB0aGUgYWRkcmVzcyBvZg0KICogY29udHJhY3RvcidzIHJlY2lwaWVudCBmb3IgdGhlIGNvbnRyYWN0b3JzJ3MgbWFoYWdlcnMuDQogKg0KKi8NCg0KLy8vIEB0aXRsZSBNYW5hZ2VyIHNtYXJ0IGNvbnRyYWN0IG9mIHRoZSBQYXNzIERlY2VudHJhbGl6ZWQgQXV0b25vbW91cyBPcmdhbmlzYXRpb24NCmNvbnRyYWN0IFBhc3NNYW5hZ2VySW50ZXJmYWNlIHsNCg0KICAgIHN0cnVjdCBwcm9wb3NhbCB7DQogICAgICAgIC8vIEFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAgICAgdWludCBhbW91bnQ7DQogICAgICAgIC8vIEEgZGVzY3JpcHRpb24gb2YgdGhlIHByb3Bvc2FsDQogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbjsNCiAgICAgICAgLy8gVGhlIGhhc2ggb2YgdGhlIHByb3Bvc2FsJ3MgZG9jdW1lbnQNCiAgICAgICAgYnl0ZXMzMiBoYXNoT2ZUaGVEb2N1bWVudDsNCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGRhdGUgd2hlbiB0aGUgcHJvcG9zYWwgd2FzIGNyZWF0ZWQNCiAgICAgICAgdWludCBkYXRlT2ZQcm9wb3NhbDsNCiAgICAgICAgLy8gVGhlIGluZGV4IG9mIHRoZSBsYXN0IGFwcHJvdmVkIGNsaWVudCBwcm9wb3NhbA0KICAgICAgICB1aW50IGxhc3RDbGllbnRQcm9wb3NhbElEOw0KICAgICAgICAvLyBUaGUgc3VtIGFtb3VudCAoaW4gd2VpKSBvcmRlcmVkIGZvciB0aGlzIHByb3Bvc2FsIA0KICAgICAgICB1aW50IG9yZGVyQW1vdW50Ow0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgICAgIHVpbnQgZGF0ZU9mT3JkZXI7DQogICAgfQ0KICAgICAgICANCiAgICAvLyBQcm9wb3NhbHMgdG8gd29yayBmb3IgdGhlIGNsaWVudA0KICAgIHByb3Bvc2FsW10gcHVibGljIHByb3Bvc2FsczsNCg0KICAgIHN0cnVjdCBmdW5kaW5nRGF0YSB7DQogICAgICAgIC8vIFRydWUgaWYgcHVibGljIGZ1bmRpbmcgd2l0aG91dCBhIG1haW4gcGFydG5lcg0KICAgICAgICBib29sIHB1YmxpY0NyZWF0aW9uOyANCiAgICAgICAgLy8gVGhlIGFkZHJlc3Mgd2hpY2ggc2V0cyBwYXJ0bmVycyBhbmQgbWFuYWdlcyB0aGUgZnVuZGluZyBpbiBjYXNlIG9mIHByaXZhdGUgZnVuZGluZw0KICAgICAgICBhZGRyZXNzIG1haW5QYXJ0bmVyOw0KICAgICAgICAvLyBUaGUgbWF4aW11bSBhbW91bnQgKGluIHdlaSkgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBtYXhBbW91bnRUb0Z1bmQ7DQogICAgICAgIC8vIFRoZSBhY3R1YWwgZnVuZGVkIGFtb3VudCAoaW4gd2VpKQ0KICAgICAgICB1aW50IGZ1bmRlZEFtb3VudDsNCiAgICAgICAgLy8gQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIHN0YXJ0IHRpbWUgb2YgdGhlIGZ1bmRpbmcNCiAgICAgICAgdWludCBzdGFydFRpbWU7IA0KICAgICAgICAvLyBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgY2xvc2luZyB0aW1lIG9mIHRoZSBmdW5kaW5nDQogICAgICAgIHVpbnQgY2xvc2luZ1RpbWU7ICANCiAgICAgICAgLy8gVGhlIHByaWNlIG11bHRpcGxpZXIgZm9yIGEgc2hhcmUgb3IgYSB0b2tlbiB3aXRob3V0IGNvbnNpZGVyaW5nIHRoZSBpbmZsYXRpb24gcmF0ZQ0KICAgICAgICB1aW50IGluaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIC8vIFJhdGUgcGVyIHllYXIgaW4gcGVyY2VudGFnZSBhcHBsaWVkIHRvIHRoZSBzaGFyZSBvciB0b2tlbiBwcmljZSANCiAgICAgICAgdWludCBpbmZsYXRpb25SYXRlOyANCiAgICAgICAgLy8gSW5kZXggb2YgdGhlIGNsaWVudCBwcm9wb3NhbA0KICAgICAgICB1aW50IHByb3Bvc2FsSUQ7DQogICAgfSANCiAgICANCiAgICAvLyBSdWxlcyBmb3IgdGhlIGFjdHVhbCBmdW5kaW5nIGFuZCB0aGUgY29udHJhY3RvciB0b2tlbiBwcmljZQ0KICAgIGZ1bmRpbmdEYXRhWzJdIHB1YmxpYyBGdW5kaW5nUnVsZXM7DQoNCiAgICAvLyBUaGUgYWRkcmVzcyBvZiB0aGUgbGFzdCBNYW5hZ2VyIGJlZm9yZSBjbG9uaW5nDQogICAgYWRkcmVzcyBwdWJsaWMgY2xvbmVkRnJvbTsNCiAgICAvLyBVbml4IGRhdGUgd2hlbiBzaGFyZXMgYW5kIHRva2VucyBjYW4gYmUgdHJhbnNmZXJyZWQgYWZ0ZXIgY2xvbmluZyAoZm9yIHRoZSBEYW8gbWFuYWdlcikNCiAgICB1aW50IGNsb3NpbmdUaW1lRm9yQ2xvbmluZzsNCiAgICAvLyBFbmQgZGF0ZSBvZiB0aGUgc2V0dXAgcHJvY2VkdXJlDQogICAgdWludCBwdWJsaWMgc21hcnRDb250cmFjdFN0YXJ0RGF0ZTsNCg0KICAgIC8vIEFkZHJlc3Mgb2YgdGhlIGNyZWF0b3Igb2YgdGhlIHNtYXJ0IGNvbnRyYWN0DQogICAgYWRkcmVzcyBwdWJsaWMgY3JlYXRvcjsNCiAgICAvLyBBZGRyZXNzIG9mIHRoZSBEYW8gKGZvciB0aGUgRGFvIG1hbmFnZXIpDQogICAgYWRkcmVzcyBjbGllbnQ7DQogICAgLy8gQWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50Ow0KICAgIGFkZHJlc3MgcHVibGljIHJlY2lwaWVudDsNCiAgICAvLyBBZGRyZXNzIG9mIHRoZSBEYW8gbWFuYWdlciAoZm9yIGNvbnRyYWN0b3IgbWFuYWdlcnMpDQogICAgUGFzc01hbmFnZXIgcHVibGljIGRhb01hbmFnZXI7DQogICAgDQogICAgLy8gVGhlIHRva2VuIG5hbWUgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgICAvLyBUaGUgdG9rZW4gc3ltYm9sIGZvciBkaXNwbGF5IHB1cnBvc2UNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCiAgICAvLyBUaGUgcXVhbnRpdHkgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsNCg0KICAgIC8vIFRydWUgaWYgdGhlIGluaXRpYWwgdG9rZW4gc3VwcGx5IGlzIG92ZXINCiAgICBib29sIGluaXRpYWxUb2tlblN1cHBseURvbmU7DQogICAgDQogICAgLy8gVG90YWwgYW1vdW50IG9mIHRva2Vucw0KICAgIHVpbnQyNTYgdG90YWxUb2tlblN1cHBseTsNCg0KICAgIC8vIEFycmF5IHdpdGggYWxsIGJhbGFuY2VzDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCiAgICAvLyBBcnJheSB3aXRoIGFsbCBhbGxvd2FuY2VzDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQogICAgLy8gTWFwIG9mIHRoZSByZXN1bHQgKGluIHdlaSkgb2YgZnVuZGluZ3MNCiAgICBtYXBwaW5nICh1aW50ID0+IHVpbnQpIGZ1bmRlZEFtb3VudDsNCg0KICAgIC8vIEFycmF5IG9mIHRva2VuIG9yIHNoYXJlIGhvbGRlcnMNCiAgICBhZGRyZXNzW10gaG9sZGVyczsNCiAgICAvLyBNYXAgd2l0aCB0aGUgaW5kZXhlcyBvZiB0aGUgaG9sZGVycw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcHVibGljIGhvbGRlcklEOw0KDQogICAgLy8gSWYgdHJ1ZSwgdGhlIHNoYXJlcyBvciB0b2tlbnMgY2FuIGJlIHRyYW5zZmVyZWQNCiAgICBib29sIHB1YmxpYyB0cmFuc2ZlcmFibGU7DQogICAgLy8gTWFwIG9mIGJsb2NrZWQgRGFvIHNoYXJlIGFjY291bnRzLiBQb2ludHMgdG8gdGhlIGRhdGUgd2hlbiB0aGUgc2hhcmUgaG9sZGVyIGNhbiB0cmFuc2ZlciBzaGFyZXMNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBibG9ja2VkRGVhZExpbmU7IA0KDQogICAgLy8gQHJldHVybiBUaGUgY2xpZW50IG9mIHRoaXMgbWFuYWdlcg0KICAgIGZ1bmN0aW9uIENsaWVudCgpIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpOw0KICAgIA0KICAgIC8vIEByZXR1cm4gVGhlIHVuaXggZGF0ZSB3aGVuIHNoYXJlcyBhbmQgdG9rZW5zIGNhbiBiZSB0cmFuc2ZlcnJlZCBhZnRlciBjbG9uaW5nDQogICAgZnVuY3Rpb24gQ2xvc2luZ1RpbWVGb3JDbG9uaW5nKCkgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogICAgDQogICAgLy8vIEByZXR1cm4gVGhlIHRvdGFsIHN1cHBseSBvZiBzaGFyZXMgb3IgdG9rZW5zIA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7DQoNCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogICAgLy8vIEByZXR1cm4gVGhlIGJhbGFuY2UNCiAgICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpOw0KDQogICAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgb3duaW5nIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIGFjY291bnQgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogICAgLy8vIEByZXR1cm4gUXVhbnRpdHkgb2YgcmVtYWluaW5nIHRva2VucyBvZiBfb3duZXIgdGhhdCBfc3BlbmRlciBpcyBhbGxvd2VkIHRvIHNwZW5kDQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZyk7DQoNCiAgICAvLy8gQHBhcmFtIF9wcm9wb3NhbElEIFRoZSBpbmRleCBvZiB0aGUgRGFvIHByb3Bvc2FsDQogICAgLy8vIEByZXR1cm4gVGhlIHJlc3VsdCAoaW4gd2VpKSBvZiB0aGUgZnVuZGluZw0KICAgIGZ1bmN0aW9uIEZ1bmRlZEFtb3VudCh1aW50IF9wcm9wb3NhbElEKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KTsNCg0KICAgIC8vLyBAcGFyYW0gX3NhbGVEYXRlIGluIGNhc2Ugb2YgcHJlc2FsZSwgdGhlIGRhdGUgb2YgdGhlIHByZXNhbGUNCiAgICAvLy8gQHJldHVybiB0aGUgc2hhcmUgb3IgdG9rZW4gcHJpY2UgZGl2aXNvciBjb25kaWRlcmluZyB0aGUgc2FsZSBkYXRlIGFuZCB0aGUgaW5mbGF0aW9uIHJhdGUNCiAgICBmdW5jdGlvbiBwcmljZURpdmlzb3IodWludCBfc2FsZURhdGUpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKHVpbnQpOw0KICAgIA0KICAgIC8vLyBAcmV0dXJuIHRoZSBhY3R1YWwgcHJpY2UgZGl2aXNvciBvZiBhIHNoYXJlIG9yIHRva2VuDQogICAgZnVuY3Rpb24gYWN0dWFsUHJpY2VEaXZpc29yKCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQHJldHVybiBUaGUgbWF4aW1hbCBhbW91bnQgYSBtYWluIHBhcnRuZXIgY2FuIGZ1bmQgYXQgdGhpcyBtb21lbnQNCiAgICAvLy8gQHBhcmFtIF9tYWluUGFydG5lciBUaGUgYWRkcmVzcyBvZiB0aGUgbWFpbiBwYXJuZXINCiAgICBmdW5jdGlvbiBmdW5kaW5nTWF4QW1vdW50KGFkZHJlc3MgX21haW5QYXJ0bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQHJldHVybiBUaGUgbnVtYmVyIG9mIHNoYXJlIG9yIHRva2VuIGhvbGRlcnMgDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZIb2xkZXJzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoNCiAgICAvLy8gQHBhcmFtIF9pbmRleCBUaGUgaW5kZXggb2YgdGhlIGhvbGRlcg0KICAgIC8vLyBAcmV0dXJuIHRoZSBhZGRyZXNzIG9mIHRoZSBhbiBob2xkZXINCiAgICBmdW5jdGlvbiBIb2xkZXJBZGRyZXNzKHVpbnQgX2luZGV4KSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKTsNCg0KICAgIC8vLyBAcmV0dXJuIFRoZSBudW1iZXIgb2YgRGFvIHJ1bGVzIHByb3Bvc2FscyAgICAgDQogICAgZnVuY3Rpb24gbnVtYmVyT2ZQcm9wb3NhbHMoKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCiAgICANCiAgICAvLy8gQGRldiBUaGUgY29uc3RydWN0b3IgZnVuY3Rpb24NCiAgICAvLy8gQHBhcmFtIF9jbGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIERhbw0KICAgIC8vLyBAcGFyYW0gX2Rhb01hbmFnZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIERhbyBtYW5hZ2VyIChmb3IgY29udHJhY3RvciBtYW5hZ2VycykNCiAgICAvLy8gQHBhcmFtIF9yZWNpcGllbnQgVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudC4gMCBmb3IgdGhlIERhbw0KICAgIC8vLyBAcGFyYW0gX2Nsb25lZEZyb20gVGhlIGFkZHJlc3Mgb2YgdGhlIGxhc3QgTWFuYWdlciBiZWZvcmUgY2xvbmluZw0KICAgIC8vLyBAcGFyYW0gX3Rva2VuTmFtZSBUaGUgdG9rZW4gbmFtZSBmb3IgZGlzcGxheSBwdXJwb3NlDQogICAgLy8vIEBwYXJhbSBfdG9rZW5TeW1ib2wgVGhlIHRva2VuIHN5bWJvbCBmb3IgZGlzcGxheSBwdXJwb3NlDQogICAgLy8vIEBwYXJhbSBfdG9rZW5EZWNpbWFscyBUaGUgcXVhbnRpdHkgb2YgZGVjaW1hbHMgZm9yIGRpc3BsYXkgcHVycG9zZQ0KICAgIC8vLyBAcGFyYW0gX3RyYW5zZmVyYWJsZSBUcnVlIGlmIGFsbG93cyB0aGUgdHJhbnNmZXIgb2YgdG9rZW5zDQogICAgLy9mdW5jdGlvbiBQYXNzTWFuYWdlcigNCiAgICAvLyAgICBhZGRyZXNzIF9jbGllbnQsDQogICAgLy8gICAgYWRkcmVzcyBfZGFvTWFuYWdlciwNCiAgICAvLyAgICBhZGRyZXNzIF9yZWNpcGllbnQsDQogICAgLy8gICAgYWRkcmVzcyBfY2xvbmVkRnJvbSwNCiAgICAvLyAgICBzdHJpbmcgX3Rva2VuTmFtZSwNCiAgICAvLyAgICBzdHJpbmcgX3Rva2VuU3ltYm9sLA0KICAgIC8vICAgIHVpbnQ4IF90b2tlbkRlY2ltYWxzLA0KICAgIC8vICAgIGJvb2wgX3RyYW5zZmVyYWJsZSk7DQogICAgDQogICAgLy8vIEBkZXYgRnVuY3Rpb24gdG8gY3JlYXRlIGluaXRpYWwgdG9rZW5zICAgIA0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgYmVuZWZpY2lhcnkgb2YgdGhlIGNyZWF0ZWQgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfcXVhbnRpdHkgVGhlIHF1YW50aXR5IG9mIHRva2VucyB0byBjcmVhdGUgICAgDQogICAgLy8vIEBwYXJhbSBfbGFzdCBUcnVlIGlmIHRoZSBpbml0aWFsIHRva2VuIHN1cHB5IGlzIG92ZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgICAgIA0KICAgIGZ1bmN0aW9uIGluaXRpYWxUb2tlblN1cHBseSgNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfcXVhbnRpdHksDQogICAgICAgIGJvb2wgX2xhc3QpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNsb25lIGEgcHJvcG9zYWwgZnJvbSB0aGUgbGFzdCBtYW5hZ2VyDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IEFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9kZXNjcmlwdGlvbiBBIGRlc2NyaXB0aW9uIG9mIHRoZSBwcm9wb3NhbA0KICAgIC8vLyBAcGFyYW0gX2hhc2hPZlRoZURvY3VtZW50IFRoZSBoYXNoIG9mIHRoZSBwcm9wb3NhbCdzIGRvY3VtZW50DQogICAgLy8vIEBwYXJhbSBfZGF0ZU9mUHJvcG9zYWwgQSB1bml4IHRpbWVzdGFtcCwgZGVub3RpbmcgdGhlIGRhdGUgd2hlbiB0aGUgcHJvcG9zYWwgd2FzIGNyZWF0ZWQNCiAgICAvLy8gQHBhcmFtIF9sYXN0Q2xpZW50UHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIGxhc3QgYXBwcm92ZWQgY2xpZW50IHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfb3JkZXJBbW91bnQgVGhlIHN1bSBhbW91bnQgKGluIHdlaSkgb3JkZXJlZCBmb3IgdGhpcyBwcm9wb3NhbCANCiAgICAvLy8gQHBhcmFtIF9kYXRlT2ZPcmRlciBBIHVuaXggdGltZXN0YW1wLCBkZW5vdGluZyB0aGUgZGF0ZSBvZiB0aGUgbGFzdCBvcmRlciBmb3IgdGhlIGFwcHJvdmVkIHByb3Bvc2FsDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGNsb25lUHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwNCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQsDQogICAgICAgIHVpbnQgX2RhdGVPZlByb3Bvc2FsLA0KICAgICAgICB1aW50IF9sYXN0Q2xpZW50UHJvcG9zYWxJRCwNCiAgICAgICAgdWludCBfb3JkZXJBbW91bnQsDQogICAgICAgIHVpbnQgX2RhdGVPZk9yZGVyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIA0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGNsb25lIHRva2VucyBmcm9tIGEgbWFuYWdlcg0KICAgIC8vLyBAcGFyYW0gX2Zyb20gVGhlIGluZGV4IG9mIHRoZSBmaXJzdCBob2xkZXINCiAgICAvLy8gQHBhcmFtIF90byBUaGUgaW5kZXggb2YgdGhlIGxhc3QgaG9sZGVyDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGNsb25lVG9rZW5zKA0KICAgICAgICB1aW50IF9mcm9tLA0KICAgICAgICB1aW50IF90bykgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBjbG9zZSB0aGUgc2V0dXAgcHJvY2VkdXJlIG9mIHRoaXMgY29udHJhY3QNCiAgICBmdW5jdGlvbiBjbG9zZVNldHVwKCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byB1cGRhdGUgdGhlIHJlY2lwZW50IGFkZHJlc3MNCiAgICAvLy8gQHBhcmFtIF9uZXdSZWNpcGllbnQgVGhlIGFkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogICAgZnVuY3Rpb24gdXBkYXRlUmVjaXBpZW50KGFkZHJlc3MgX25ld1JlY2lwaWVudCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byByZWNlaXZlIHBheW1lbnRzIG9yIGRlcG9zaXRzDQogICAgZnVuY3Rpb24gKCkgcGF5YWJsZTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBhbGxvdyBjb250cmFjdG9ycyB0byB3aXRoZHJhdyBldGhlcnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSB0byB3aXRoZHJhdw0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KHVpbnQgX2Ftb3VudCk7DQoNCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byB1cGRhdGUgdGhlIGNsaWVudCBhZGRyZXNzDQogICAgZnVuY3Rpb24gdXBkYXRlQ2xpZW50KGFkZHJlc3MgX25ld0NsaWVudCk7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdG8gbWFrZSBhIHByb3Bvc2FsIHRvIHdvcmsgZm9yIHRoZSBjbGllbnQNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9kZXNjcmlwdGlvbiBTdHJpbmcgZGVzY3JpYmluZyB0aGUgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9oYXNoT2ZUaGVEb2N1bWVudCBUaGUgaGFzaCBvZiB0aGUgcHJvcG9zYWwgZG9jdW1lbnQNCiAgICAvLy8gQHJldHVybiBUaGUgaW5kZXggb2YgdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICBmdW5jdGlvbiBuZXdQcm9wb3NhbCgNCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICBzdHJpbmcgX2Rlc2NyaXB0aW9uLCANCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQNCiAgICApIHJldHVybnMgKHVpbnQpOw0KICAgICAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBjbGllbnQgdG8gb3JkZXIgYWNjb3JkaW5nIHRvIHRoZSBjb250cmFjdG9yIHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfY2xpZW50UHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIGxhc3QgYXBwcm92ZWQgY2xpZW50IHByb3Bvc2FsDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBUaGUgaW5kZXggb2YgdGhlIGNvbnRyYWN0b3IgcHJvcG9zYWwNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgb3JkZXINCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBvcmRlciB3YXMgbWFkZSBvciBub3QNCiAgICBmdW5jdGlvbiBvcmRlcigNCiAgICAgICAgdWludCBfY2xpZW50UHJvcG9zYWxJRCwNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCwNCiAgICAgICAgdWludCBfYW1vdW50DQogICAgKSBleHRlcm5hbCByZXR1cm5zIChib29sKSA7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY2xpZW50IHRvIHNlbmQgZXRoZXJzIGZyb20gdGhlIERhbyBtYW5hZ2VyDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBhZGRyZXNzIHRvIHNlbmQgdG8NCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gd2VpKSB0byBzZW5kDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogICAgZnVuY3Rpb24gc2VuZFRvKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQNCiAgICApIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGFkZCBhIG5ldyB0b2tlbiBvciBzaGFyZSBob2xkZXINCiAgICAvLy8gQHBhcmFtIF9ob2xkZXIgVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIG9yIHNoYXJlIGhvbGRlcg0KICAgIGZ1bmN0aW9uIGFkZEhvbGRlcihhZGRyZXNzIF9ob2xkZXIpIGludGVybmFsOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGNyZWF0ZSBpbml0aWFsIHRva2VucyAgICANCiAgICAvLy8gQHBhcmFtIF9ob2xkZXIgVGhlIGJlbmVmaWNpYXJ5IG9mIHRoZSBjcmVhdGVkIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3F1YW50aXR5IFRoZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gY3JlYXRlDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIGNyZWF0ZUluaXRpYWxUb2tlbnMoYWRkcmVzcyBfaG9sZGVyLCB1aW50IF9xdWFudGl0eSkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSA7DQogICAgDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdGhhdCBhbGxvdyB0aGUgY29udHJhY3RvciB0byBwcm9wb3NlIGEgdG9rZW4gcHJpY2UNCiAgICAvLy8gQHBhcmFtIF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyIFRoZSBpbml0aWFsIHByaWNlIG11bHRpcGxpZXIgb2YgY29udHJhY3RvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9pbmZsYXRpb25SYXRlIElmIDAsIHRoZSBjb250cmFjdG9yIHRva2VuIHByaWNlIGRvZXNuJ3QgY2hhbmdlIGR1cmluZyB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX2Nsb3NpbmdUaW1lIFRoZSBpbml0aWFsIHByaWNlIGFuZCBpbmZsYXRpb24gcmF0ZSBjYW4gYmUgY2hhbmdlZCBhZnRlciB0aGlzIGRhdGUNCiAgICBmdW5jdGlvbiBzZXRUb2tlblByaWNlUHJvcG9zYWwoICAgICAgICANCiAgICAgICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX2Nsb3NpbmdUaW1lDQogICAgKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIHNldCBhIGZ1bmRpbmcuIENhbiBiZSBwcml2YXRlIG9yIHB1YmxpYw0KICAgIC8vLyBAcGFyYW0gX21haW5QYXJ0bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBzbWFydCBjb250cmFjdCB0byBtYW5hZ2UgYSBwcml2YXRlIGZ1bmRpbmcNCiAgICAvLy8gQHBhcmFtIF9wdWJsaWNDcmVhdGlvbiBUcnVlIGlmIHB1YmxpYyBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfaW5pdGlhbFByaWNlTXVsdGlwbGllciBQcmljZSBtdWx0aXBsaWVyIHdpdGhvdXQgY29uc2lkZXJpbmcgYW55IGluZmxhdGlvbiByYXRlDQogICAgLy8vIEBwYXJhbSBfbWF4QW1vdW50VG9GdW5kIFRoZSBtYXhpbXVtIGFtb3VudCAoaW4gd2VpKSBvZiB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX21pbnV0ZXNGdW5kaW5nUGVyaW9kIFBlcmlvZCBpbiBtaW51dGVzIG9mIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfaW5mbGF0aW9uUmF0ZSBJZiAwLCB0aGUgdG9rZW4gcHJpY2UgZG9lc24ndCBjaGFuZ2UgZHVyaW5nIHRoZSBmdW5kaW5nDQogICAgLy8vIEBwYXJhbSBfcHJvcG9zYWxJRCBJbmRleCBvZiB0aGUgY2xpZW50IHByb3Bvc2FsIChub3QgbWFuZGF0b3J5KQ0KICAgIGZ1bmN0aW9uIHNldEZ1bmRpbmdSdWxlcygNCiAgICAgICAgYWRkcmVzcyBfbWFpblBhcnRuZXIsDQogICAgICAgIGJvb2wgX3B1YmxpY0NyZWF0aW9uLCANCiAgICAgICAgdWludCBfaW5pdGlhbFByaWNlTXVsdGlwbGllciwgDQogICAgICAgIHVpbnQgX21heEFtb3VudFRvRnVuZCwgDQogICAgICAgIHVpbnQgX21pbnV0ZXNGdW5kaW5nUGVyaW9kLCANCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRA0KICAgICkgZXh0ZXJuYWw7DQogICAgDQogICAgLy8vIEBkZXYgSW50ZXJuYWwgZnVuY3Rpb24gZm9yIHRoZSBjcmVhdGlvbiBvZiBzaGFyZXMgb3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSByZWNpcGllbnQgYWRkcmVzcyBvZiBzaGFyZXMgb3IgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBmdW5kZWQgYW1vdW50IChpbiB3ZWkpDQogICAgLy8vIEBwYXJhbSBfc2FsZURhdGUgSW4gY2FzZSBvZiBwcmVzYWxlLCB0aGUgZGF0ZSBvZiB0aGUgcHJlc2FsZQ0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGNyZWF0aW9uIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQsDQogICAgICAgIHVpbnQgX3NhbGVEYXRlDQogICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgbWFpbiBwYXJ0bmVyIHRvIHNldCB0aGUgc3RhcnQgdGltZSBvZiB0aGUgZnVuZGluZw0KICAgIC8vLyBAcGFyYW0gX3N0YXJ0VGltZSBUaGUgdW5peCBzdGFydCBkYXRlIG9mIHRoZSBmdW5kaW5nIA0KICAgIGZ1bmN0aW9uIHNldEZ1bmRpbmdTdGFydFRpbWUodWludCBfc3RhcnRUaW1lKSBleHRlcm5hbDsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHVzZWQgYnkgdGhlIG1haW4gcGFydG5lciB0byByZXdhcmQgc2hhcmVzIG9yIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3JlY2lwaWVudCBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50IG9mIHNoYXJlcyBvciB0b2tlbnMNCiAgICAvLy8gQHBhcmFtIF9hbW91bnQgVGhlIGFtb3VudCAoaW4gV2VpKSB0byBjYWxjdWxhdGUgdGhlIHF1YW50aXR5IG9mIHNoYXJlcyBvciB0b2tlbnMgdG8gY3JlYXRlDQogICAgLy8vIEBwYXJhbSBfZGF0ZSBUaGUgdW5peCBkYXRlIHRvIGNvbnNpZGVyIGZvciB0aGUgc2hhcmUgb3IgdG9rZW4gcHJpY2UgY2FsY3VsYXRpb24NCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgICBmdW5jdGlvbiByZXdhcmRUb2tlbigNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LCANCiAgICAgICAgdWludCBfYW1vdW50LA0KICAgICAgICB1aW50IF9kYXRlDQogICAgICAgICkgZXh0ZXJuYWw7DQoNCiAgICAvLy8gQGRldiBJbnRlcm5hbCBmdW5jdGlvbiB0byBjbG9zZSB0aGUgYWN0dWFsIGZ1bmRpbmcNCiAgICBmdW5jdGlvbiBjbG9zZUZ1bmRpbmcoKSBpbnRlcm5hbDsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB1c2VkIGJ5IHRoZSBtYWluIHBhcnRuZXIgdG8gc2V0IHRoZSBmdW5kaW5nIGZ1ZWxlZA0KICAgIGZ1bmN0aW9uIHNldEZ1bmRpbmdGdWVsZWQoKSBleHRlcm5hbDsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGFibGUgdGhlIHRyYW5zZmVyIG9mIERhbyBzaGFyZXMgb3IgY29udHJhY3RvciB0b2tlbnMNCiAgICBmdW5jdGlvbiBhYmxlVHJhbnNmZXIoKTsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGRpc2FibGUgdGhlIHRyYW5zZmVyIG9mIERhbyBzaGFyZXMNCiAgICAvLy8gQHBhcmFtIF9jbG9zaW5nVGltZSBEYXRlIHdoZW4gc2hhcmVzIG9yIHRva2VucyBjYW4gYmUgdHJhbnNmZXJyZWQNCiAgICBmdW5jdGlvbiBkaXNhYmxlVHJhbnNmZXIodWludCBfY2xvc2luZ1RpbWUpOw0KDQogICAgLy8vIEBub3RpY2UgRnVuY3Rpb24gdXNlZCBieSB0aGUgY2xpZW50IHRvIGJsb2NrIHRoZSB0cmFuc2ZlciBvZiBzaGFyZXMgZnJvbSBhbmQgdG8gYSBzaGFyZSBob2xkZXINCiAgICAvLy8gQHBhcmFtIF9zaGFyZUhvbGRlciBUaGUgYWRkcmVzcyBvZiB0aGUgc2hhcmUgaG9sZGVyDQogICAgLy8vIEBwYXJhbSBfZGVhZExpbmUgV2hlbiB0aGUgYWNjb3VudCB3aWxsIGJlIHVuYmxvY2tlZA0KICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNmZXIoYWRkcmVzcyBfc2hhcmVIb2xkZXIsIHVpbnQgX2RlYWRMaW5lKSBleHRlcm5hbDsNCg0KICAgIC8vLyBAbm90aWNlIEZ1bmN0aW9uIHRvIGJ1eSBEYW8gc2hhcmVzIGFjY29yZGluZyB0byB0aGUgZnVuZGluZyBydWxlcyANCiAgICAvLy8gd2l0aCBgbXNnLnNlbmRlcmAgYXMgdGhlIGJlbmVmaWNpYXJ5DQogICAgZnVuY3Rpb24gYnV5U2hhcmVzKCkgcGF5YWJsZTsNCiAgICANCiAgICAvLy8gQG5vdGljZSBGdW5jdGlvbiB0byBidXkgRGFvIHNoYXJlcyBhY2NvcmRpbmcgdG8gdGhlIGZ1bmRpbmcgcnVsZXMgDQogICAgLy8vIEBwYXJhbSBfcmVjaXBpZW50IFRoZSBiZW5lZmljaWFyeSBvZiB0aGUgY3JlYXRlZCBzaGFyZXMNCiAgICBmdW5jdGlvbiBidXlTaGFyZXNGb3IoYWRkcmVzcyBfcmVjaXBpZW50KSBwYXlhYmxlOw0KICAgIA0KICAgIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgX0Zyb21gDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgZnVuY3Rpb24gd2FzIHN1Y2Nlc3NmdWwgb3Igbm90IA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbVRvKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLA0KICAgICAgICBhZGRyZXNzIF90bywgDQogICAgICAgIHVpbnQyNTYgX3ZhbHVlDQogICAgICAgICkgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAgIC8vLyBAbm90aWNlIHNlbmQgYF92YWx1ZWAgdG9rZW4gdG8gYF90b2AgZnJvbSBgbXNnLnNlbmRlcmANCiAgICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogICAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIHF1YW50aXR5IG9mIHNoYXJlcyBvciB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSBmdW5jdGlvbiB3YXMgc3VjY2Vzc2Z1bCBvciBub3QgDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogICAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBfZnJvbWAgb24gdGhlIGNvbmRpdGlvbiBpdCBpcyBhcHByb3ZlZCBieSBgX2Zyb21gDQogICAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogICAgLy8vIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3Mgb2YgdGhlIHJlY2lwaWVudA0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBxdWFudGl0eSBvZiBzaGFyZXMgb3IgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLCANCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzcGVuZCBgX2Ftb3VudGAgdG9rZW5zIG9uIGl0cyBiZWhhbGYNCiAgICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IGFibGUgdG8gdHJhbnNmZXIgdGhlIHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGFwcHJvdmVkIGZvciB0cmFuc2Zlcg0KICAgIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQoNCiAgICBldmVudCBGZWVzUmVjZWl2ZWQoYWRkcmVzcyBpbmRleGVkIEZyb20sIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBBbW91bnRSZWNlaXZlZChhZGRyZXNzIGluZGV4ZWQgRnJvbSwgdWludCBBbW91bnQpOw0KICAgIGV2ZW50IHBheW1lbnRSZWNlaXZlZChhZGRyZXNzIGluZGV4ZWQgZGFvTWFuYWdlciwgdWludCBBbW91bnQpOw0KICAgIGV2ZW50IFByb3Bvc2FsQ2xvbmVkKHVpbnQgaW5kZXhlZCBMYXN0Q2xpZW50UHJvcG9zYWxJRCwgdWludCBpbmRleGVkIFByb3Bvc2FsSUQsIHVpbnQgQW1vdW50LCBzdHJpbmcgRGVzY3JpcHRpb24sIGJ5dGVzMzIgSGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgIGV2ZW50IENsaWVudFVwZGF0ZWQoYWRkcmVzcyBMYXN0Q2xpZW50LCBhZGRyZXNzIE5ld0NsaWVudCk7DQogICAgZXZlbnQgUmVjaXBpZW50VXBkYXRlZChhZGRyZXNzIExhc3RSZWNpcGllbnQsIGFkZHJlc3MgTmV3UmVjaXBpZW50KTsNCiAgICBldmVudCBQcm9wb3NhbEFkZGVkKHVpbnQgaW5kZXhlZCBQcm9wb3NhbElELCB1aW50IEFtb3VudCwgc3RyaW5nIERlc2NyaXB0aW9uLCBieXRlczMyIEhhc2hPZlRoZURvY3VtZW50KTsNCiAgICBldmVudCBPcmRlcih1aW50IGluZGV4ZWQgY2xpZW50UHJvcG9zYWxJRCwgdWludCBpbmRleGVkIFByb3Bvc2FsSUQsIHVpbnQgQW1vdW50KTsNCiAgICBldmVudCBXaXRoZGF3YWwoYWRkcmVzcyBpbmRleGVkIFJlY2lwaWVudCwgdWludCBBbW91bnQpOw0KICAgIGV2ZW50IFRva2VuUHJpY2VQcm9wb3NhbFNldCh1aW50IEluaXRpYWxQcmljZU11bHRpcGxpZXIsIHVpbnQgSW5mbGF0aW9uUmF0ZSwgdWludCBDbG9zaW5nVGltZSk7DQogICAgZXZlbnQgaG9sZGVyQWRkZWQodWludCBJbmRleCwgYWRkcmVzcyBIb2xkZXIpOw0KICAgIGV2ZW50IFRva2Vuc0NyZWF0ZWQoYWRkcmVzcyBpbmRleGVkIFNlbmRlciwgYWRkcmVzcyBpbmRleGVkIFRva2VuSG9sZGVyLCB1aW50IFF1YW50aXR5KTsNCiAgICBldmVudCBGdW5kaW5nUnVsZXNTZXQoYWRkcmVzcyBpbmRleGVkIE1haW5QYXJ0bmVyLCB1aW50IGluZGV4ZWQgRnVuZGluZ1Byb3Bvc2FsSWQsIHVpbnQgaW5kZXhlZCBTdGFydFRpbWUsIHVpbnQgQ2xvc2luZ1RpbWUpOw0KICAgIGV2ZW50IEZ1bmRpbmdGdWVsZWQodWludCBpbmRleGVkIEZ1bmRpbmdQcm9wb3NhbElELCB1aW50IEZ1bmRlZEFtb3VudCk7DQogICAgZXZlbnQgVHJhbnNmZXJBYmxlKCk7DQogICAgZXZlbnQgVHJhbnNmZXJEaXNhYmxlKHVpbnQgY2xvc2luZ1RpbWUpOw0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KDQoNCn0gICAgDQoNCmNvbnRyYWN0IFBhc3NNYW5hZ2VyIGlzIFBhc3NNYW5hZ2VySW50ZXJmYWNlIHsNCg0KLy8gQ29uc3RhbnQgZnVuY3Rpb25zDQoNCiAgICBmdW5jdGlvbiBDbGllbnQoKSBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7DQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCkgcmV0dXJuIGNsaWVudDsNCiAgICAgICAgZWxzZSByZXR1cm4gZGFvTWFuYWdlci5DbGllbnQoKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gQ2xvc2luZ1RpbWVGb3JDbG9uaW5nKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIHJldHVybiBjbG9zaW5nVGltZUZvckNsb25pbmc7DQogICAgICAgIGVsc2UgcmV0dXJuIGRhb01hbmFnZXIuQ2xvc2luZ1RpbWVGb3JDbG9uaW5nKCk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gdG90YWxUb2tlblN1cHBseTsNCiAgICB9DQoNCiAgICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gRnVuZGVkQW1vdW50KHVpbnQgX3Byb3Bvc2FsSUQpIGNvbnN0YW50IGV4dGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGZ1bmRlZEFtb3VudFtfcHJvcG9zYWxJRF07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcHJpY2VEaXZpc29yKHVpbnQgX3NhbGVEYXRlKSBjb25zdGFudCBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgX2RhdGUgPSBfc2FsZURhdGU7DQogICAgICAgIA0KICAgICAgICBpZiAoX3NhbGVEYXRlID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lKSBfZGF0ZSA9IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZTsNCiAgICAgICAgaWYgKF9zYWxlRGF0ZSA8IEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUpIF9kYXRlID0gRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZTsNCg0KICAgICAgICByZXR1cm4gMTAwICsgMTAwKkZ1bmRpbmdSdWxlc1swXS5pbmZsYXRpb25SYXRlKihfZGF0ZSAtIEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUpLygxMDAqMzY1IGRheXMpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhY3R1YWxQcmljZURpdmlzb3IoKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHJldHVybiBwcmljZURpdmlzb3Iobm93KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBmdW5kaW5nTWF4QW1vdW50KGFkZHJlc3MgX21haW5QYXJ0bmVyKSBjb25zdGFudCBleHRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIA0KICAgICAgICBpZiAobm93ID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lDQogICAgICAgICAgICB8fCBub3cgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lDQogICAgICAgICAgICB8fCBfbWFpblBhcnRuZXIgIT0gRnVuZGluZ1J1bGVzWzBdLm1haW5QYXJ0bmVyKSB7DQogICAgICAgICAgICByZXR1cm4gMDsgICANCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBGdW5kaW5nUnVsZXNbMF0ubWF4QW1vdW50VG9GdW5kOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG51bWJlck9mSG9sZGVycygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGhvbGRlcnMubGVuZ3RoIC0gMTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gSG9sZGVyQWRkcmVzcyh1aW50IF9pbmRleCkgY29uc3RhbnQgcmV0dXJucyAoYWRkcmVzcykgew0KICAgICAgICByZXR1cm4gaG9sZGVyc1tfaW5kZXhdOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG51bWJlck9mUHJvcG9zYWxzKCkgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgICAgICByZXR1cm4gcHJvcG9zYWxzLmxlbmd0aCAtIDE7DQogICAgfQ0KDQovLyBNb2RpZmllcnMNCg0KICAgIC8vIE1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgdGhlIGNsaWVudCB0byBtYW5hZ2UgdGhpcyBhY2NvdW50IG1hbmFnZXINCiAgICBtb2RpZmllciBvbmx5Q2xpZW50IHtpZiAobXNnLnNlbmRlciAhPSBDbGllbnQoKSkgdGhyb3c7IF87fQ0KICAgIA0KICAgIC8vIE1vZGlmaWVyIHRoYXQgYWxsb3dzIG9ubHkgdGhlIG1haW4gcGFydG5lciB0byBtYW5hZ2UgdGhlIGFjdHVhbCBmdW5kaW5nDQogICAgbW9kaWZpZXIgb25seU1haW5QYXJ0bmVyIHtpZiAobXNnLnNlbmRlciAhPSAgRnVuZGluZ1J1bGVzWzBdLm1haW5QYXJ0bmVyKSB0aHJvdzsgXzt9DQogICAgDQogICAgLy8gTW9kaWZpZXIgdGhhdCBhbGxvd3Mgb25seSB0aGUgY29udHJhY3RvciBwcm9wb3NlIHNldCB0aGUgdG9rZW4gcHJpY2Ugb3Igd2l0aGRyYXcNCiAgICBtb2RpZmllciBvbmx5Q29udHJhY3RvciB7aWYgKHJlY2lwaWVudCA9PSAwIHx8IChtc2cuc2VuZGVyICE9IHJlY2lwaWVudCAmJiBtc2cuc2VuZGVyICE9IGNyZWF0b3IpKSB0aHJvdzsgXzt9DQogICAgDQogICAgLy8gTW9kaWZpZXIgZm9yIERhbyBmdW5jdGlvbnMNCiAgICBtb2RpZmllciBvbmx5RGFvIHtpZiAocmVjaXBpZW50ICE9IDApIHRocm93OyBfO30NCiAgICANCi8vIENvbnN0cnVjdG9yIGZ1bmN0aW9uDQoNCiAgICBmdW5jdGlvbiBQYXNzTWFuYWdlcigNCiAgICAgICAgYWRkcmVzcyBfY2xpZW50LA0KICAgICAgICBhZGRyZXNzIF9kYW9NYW5hZ2VyLA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsDQogICAgICAgIGFkZHJlc3MgX2Nsb25lZEZyb20sDQogICAgICAgIHN0cmluZyBfdG9rZW5OYW1lLA0KICAgICAgICBzdHJpbmcgX3Rva2VuU3ltYm9sLA0KICAgICAgICB1aW50OCBfdG9rZW5EZWNpbWFscywNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJhYmxlDQogICAgKSB7DQoNCiAgICAgICAgaWYgKChfcmVjaXBpZW50ID09IDAgJiYgX2NsaWVudCA9PSAwKQ0KICAgICAgICAgICAgfHwgX2NsaWVudCA9PSBfcmVjaXBpZW50KSB0aHJvdzsNCg0KICAgICAgICBjcmVhdG9yID0gbXNnLnNlbmRlcjsgDQogICAgICAgIGNsaWVudCA9IF9jbGllbnQ7DQogICAgICAgIHJlY2lwaWVudCA9IF9yZWNpcGllbnQ7DQogICAgICAgIA0KICAgICAgICBpZiAoX3JlY2lwaWVudCAhPTApIGRhb01hbmFnZXIgPSBQYXNzTWFuYWdlcihfZGFvTWFuYWdlcik7DQoNCiAgICAgICAgY2xvbmVkRnJvbSA9IF9jbG9uZWRGcm9tOyAgICAgICAgICAgIA0KICAgICAgICANCiAgICAgICAgbmFtZSA9IF90b2tlbk5hbWU7DQogICAgICAgIHN5bWJvbCA9IF90b2tlblN5bWJvbDsNCiAgICAgICAgZGVjaW1hbHMgPSBfdG9rZW5EZWNpbWFsczsNCiAgICAgICAgICANCiAgICAgICAgaWYgKF90cmFuc2ZlcmFibGUpIHsNCiAgICAgICAgICAgIHRyYW5zZmVyYWJsZSA9IHRydWU7DQogICAgICAgICAgICBUcmFuc2ZlckFibGUoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRyYW5zZmVyYWJsZSA9IGZhbHNlOw0KICAgICAgICAgICAgVHJhbnNmZXJEaXNhYmxlKDApOw0KICAgICAgICB9DQoNCiAgICAgICAgaG9sZGVycy5sZW5ndGggPSAxOw0KICAgICAgICBwcm9wb3NhbHMubGVuZ3RoID0gMTsNCiAgICAgICAgDQogICAgfQ0KDQovLyBTZXR0aW5nIGZ1bmN0aW9ucw0KDQogICAgZnVuY3Rpb24gaW5pdGlhbFRva2VuU3VwcGx5KA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9xdWFudGl0eSwNCiAgICAgICAgYm9vbCBfbGFzdCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQoNCiAgICAgICAgaWYgKHNtYXJ0Q29udHJhY3RTdGFydERhdGUgIT0gMCB8fCBpbml0aWFsVG9rZW5TdXBwbHlEb25lKSB0aHJvdzsNCiAgICAgICAgDQogICAgICAgIGlmIChfcmVjaXBpZW50ICE9IDAgJiYgX3F1YW50aXR5ICE9IDApIHsNCiAgICAgICAgICAgIHJldHVybiAoY3JlYXRlSW5pdGlhbFRva2VucyhfcmVjaXBpZW50LCBfcXVhbnRpdHkpKTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgaWYgKF9sYXN0KSBpbml0aWFsVG9rZW5TdXBwbHlEb25lID0gdHJ1ZTsNCiAgICAgICAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsb25lUHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwNCiAgICAgICAgYnl0ZXMzMiBfaGFzaE9mVGhlRG9jdW1lbnQsDQogICAgICAgIHVpbnQgX2RhdGVPZlByb3Bvc2FsLA0KICAgICAgICB1aW50IF9sYXN0Q2xpZW50UHJvcG9zYWxJRCwNCiAgICAgICAgdWludCBfb3JkZXJBbW91bnQsDQogICAgICAgIHVpbnQgX2RhdGVPZk9yZGVyDQogICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIA0KICAgICAgICBpZiAoc21hcnRDb250cmFjdFN0YXJ0RGF0ZSAhPSAwIHx8IHJlY2lwaWVudCA9PSAwDQogICAgICAgIHx8IG1zZy5zZW5kZXIgIT0gY3JlYXRvcikgdGhyb3c7DQogICAgICAgIA0KICAgICAgICB1aW50IF9wcm9wb3NhbElEID0gcHJvcG9zYWxzLmxlbmd0aCsrOw0KICAgICAgICBwcm9wb3NhbCBjID0gcHJvcG9zYWxzW19wcm9wb3NhbElEXTsNCg0KICAgICAgICBjLmFtb3VudCA9IF9hbW91bnQ7DQogICAgICAgIGMuZGVzY3JpcHRpb24gPSBfZGVzY3JpcHRpb247DQogICAgICAgIGMuaGFzaE9mVGhlRG9jdW1lbnQgPSBfaGFzaE9mVGhlRG9jdW1lbnQ7IA0KICAgICAgICBjLmRhdGVPZlByb3Bvc2FsID0gX2RhdGVPZlByb3Bvc2FsOw0KICAgICAgICBjLmxhc3RDbGllbnRQcm9wb3NhbElEID0gX2xhc3RDbGllbnRQcm9wb3NhbElEOw0KICAgICAgICBjLm9yZGVyQW1vdW50ID0gX29yZGVyQW1vdW50Ow0KICAgICAgICBjLmRhdGVPZk9yZGVyID0gX2RhdGVPZk9yZGVyOw0KICAgICAgICANCiAgICAgICAgUHJvcG9zYWxDbG9uZWQoX2xhc3RDbGllbnRQcm9wb3NhbElELCBfcHJvcG9zYWxJRCwgYy5hbW91bnQsIGMuZGVzY3JpcHRpb24sIGMuaGFzaE9mVGhlRG9jdW1lbnQpOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbG9uZVRva2VucygNCiAgICAgICAgdWludCBfZnJvbSwNCiAgICAgICAgdWludCBfdG8pIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICANCiAgICAgICAgaWYgKHNtYXJ0Q29udHJhY3RTdGFydERhdGUgIT0gMCkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBQYXNzTWFuYWdlciBfY2xvbmVkRnJvbSA9IFBhc3NNYW5hZ2VyKGNsb25lZEZyb20pOw0KICAgICAgICANCiAgICAgICAgaWYgKF9mcm9tIDwgMSB8fCBfdG8gPiBfY2xvbmVkRnJvbS5udW1iZXJPZkhvbGRlcnMoKSkgdGhyb3c7DQoNCiAgICAgICAgYWRkcmVzcyBfaG9sZGVyOw0KDQogICAgICAgIGZvciAodWludCBpID0gX2Zyb207IGkgPD0gX3RvOyBpKyspIHsNCiAgICAgICAgICAgIF9ob2xkZXIgPSBfY2xvbmVkRnJvbS5Ib2xkZXJBZGRyZXNzKGkpOw0KICAgICAgICAgICAgaWYgKGJhbGFuY2VzW19ob2xkZXJdID09IDApIHsNCiAgICAgICAgICAgICAgICBjcmVhdGVJbml0aWFsVG9rZW5zKF9ob2xkZXIsIF9jbG9uZWRGcm9tLmJhbGFuY2VPZihfaG9sZGVyKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgDQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2xvc2VTZXR1cCgpIHsNCiAgICAgICAgDQogICAgICAgIGlmIChzbWFydENvbnRyYWN0U3RhcnREYXRlICE9IDAgfHwgbXNnLnNlbmRlciAhPSBjcmVhdG9yKSB0aHJvdzsNCg0KICAgICAgICBzbWFydENvbnRyYWN0U3RhcnREYXRlID0gbm93Ow0KDQogICAgfQ0KDQovLyBGdW5jdGlvbiB0byByZWNlaXZlIHBheW1lbnRzIG9yIGRlcG9zaXRzDQoNCiAgICBmdW5jdGlvbiAoKSBwYXlhYmxlIHsNCiAgICAgICAgQW1vdW50UmVjZWl2ZWQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsNCiAgICB9DQogICAgDQovLyBDb250cmFjdG9ycyBBY2NvdW50IE1hbmFnZW1lbnQNCg0KICAgIGZ1bmN0aW9uIHVwZGF0ZVJlY2lwaWVudChhZGRyZXNzIF9uZXdSZWNpcGllbnQpIG9ubHlDb250cmFjdG9yIHsNCg0KICAgICAgICBpZiAoX25ld1JlY2lwaWVudCA9PSAwIA0KICAgICAgICAgICAgfHwgX25ld1JlY2lwaWVudCA9PSBjbGllbnQpIHRocm93Ow0KDQogICAgICAgIFJlY2lwaWVudFVwZGF0ZWQocmVjaXBpZW50LCBfbmV3UmVjaXBpZW50KTsNCiAgICAgICAgcmVjaXBpZW50ID0gX25ld1JlY2lwaWVudDsNCg0KICAgIH0gDQoNCiAgICBmdW5jdGlvbiB3aXRoZHJhdyh1aW50IF9hbW91bnQpIG9ubHlDb250cmFjdG9yIHsNCiAgICAgICAgaWYgKCFyZWNpcGllbnQuc2VuZChfYW1vdW50KSkgdGhyb3c7DQogICAgICAgIFdpdGhkYXdhbChyZWNpcGllbnQsIF9hbW91bnQpOw0KICAgIH0NCiAgICANCi8vIERBTyBQcm9wb3NhbHMgTWFuYWdlbWVudA0KDQogICAgZnVuY3Rpb24gdXBkYXRlQ2xpZW50KGFkZHJlc3MgX25ld0NsaWVudCkgb25seUNsaWVudCB7DQogICAgICAgIA0KICAgICAgICBpZiAoX25ld0NsaWVudCA9PSAwIA0KICAgICAgICAgICAgfHwgX25ld0NsaWVudCA9PSByZWNpcGllbnQpIHRocm93Ow0KDQogICAgICAgIENsaWVudFVwZGF0ZWQoY2xpZW50LCBfbmV3Q2xpZW50KTsNCiAgICAgICAgY2xpZW50ID0gX25ld0NsaWVudDsgICAgICAgIA0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gbmV3UHJvcG9zYWwoDQogICAgICAgIHVpbnQgX2Ftb3VudCwNCiAgICAgICAgc3RyaW5nIF9kZXNjcmlwdGlvbiwgDQogICAgICAgIGJ5dGVzMzIgX2hhc2hPZlRoZURvY3VtZW50DQogICAgKSBvbmx5Q29udHJhY3RvciByZXR1cm5zICh1aW50KSB7DQoNCiAgICAgICAgdWludCBfcHJvcG9zYWxJRCA9IHByb3Bvc2Fscy5sZW5ndGgrKzsNCiAgICAgICAgcHJvcG9zYWwgYyA9IHByb3Bvc2Fsc1tfcHJvcG9zYWxJRF07DQoNCiAgICAgICAgYy5hbW91bnQgPSBfYW1vdW50Ow0KICAgICAgICBjLmRlc2NyaXB0aW9uID0gX2Rlc2NyaXB0aW9uOw0KICAgICAgICBjLmhhc2hPZlRoZURvY3VtZW50ID0gX2hhc2hPZlRoZURvY3VtZW50OyANCiAgICAgICAgYy5kYXRlT2ZQcm9wb3NhbCA9IG5vdzsNCiAgICAgICAgDQogICAgICAgIFByb3Bvc2FsQWRkZWQoX3Byb3Bvc2FsSUQsIGMuYW1vdW50LCBjLmRlc2NyaXB0aW9uLCBjLmhhc2hPZlRoZURvY3VtZW50KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBfcHJvcG9zYWxJRDsNCiAgICAgICAgDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIG9yZGVyKA0KICAgICAgICB1aW50IF9jbGllbnRQcm9wb3NhbElELA0KICAgICAgICB1aW50IF9wcm9wb3NhbElELA0KICAgICAgICB1aW50IF9vcmRlckFtb3VudA0KICAgICkgZXh0ZXJuYWwgb25seUNsaWVudCByZXR1cm5zIChib29sKSB7DQogICAgDQogICAgICAgIHByb3Bvc2FsIGMgPSBwcm9wb3NhbHNbX3Byb3Bvc2FsSURdOw0KICAgICAgICANCiAgICAgICAgdWludCBfc3VtID0gYy5vcmRlckFtb3VudCArIF9vcmRlckFtb3VudDsNCiAgICAgICAgaWYgKF9zdW0gPiBjLmFtb3VudA0KICAgICAgICAgICAgfHwgX3N1bSA8IGMub3JkZXJBbW91bnQNCiAgICAgICAgICAgIHx8IF9zdW0gPCBfb3JkZXJBbW91bnQpIHJldHVybjsgDQoNCiAgICAgICAgYy5sYXN0Q2xpZW50UHJvcG9zYWxJRCA9ICBfY2xpZW50UHJvcG9zYWxJRDsNCiAgICAgICAgYy5vcmRlckFtb3VudCA9IF9zdW07DQogICAgICAgIGMuZGF0ZU9mT3JkZXIgPSBub3c7DQogICAgICAgIA0KICAgICAgICBPcmRlcihfY2xpZW50UHJvcG9zYWxJRCwgX3Byb3Bvc2FsSUQsIF9vcmRlckFtb3VudCk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gdHJ1ZTsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNlbmRUbygNCiAgICAgICAgYWRkcmVzcyBfcmVjaXBpZW50LA0KICAgICAgICB1aW50IF9hbW91bnQNCiAgICApIGV4dGVybmFsIG9ubHlDbGllbnQgb25seURhbyByZXR1cm5zIChib29sKSB7DQoNCiAgICAgICAgaWYgKF9yZWNpcGllbnQuc2VuZChfYW1vdW50KSkgcmV0dXJuIHRydWU7DQogICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOw0KDQogICAgfQ0KICAgIA0KLy8gVG9rZW4gTWFuYWdlbWVudA0KICAgIA0KICAgIGZ1bmN0aW9uIGFkZEhvbGRlcihhZGRyZXNzIF9ob2xkZXIpIGludGVybmFsIHsNCiAgICAgICAgDQogICAgICAgIGlmIChob2xkZXJJRFtfaG9sZGVyXSA9PSAwKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHVpbnQgX2hvbGRlcklEID0gaG9sZGVycy5sZW5ndGgrKzsNCiAgICAgICAgICAgIGhvbGRlcnNbX2hvbGRlcklEXSA9IF9ob2xkZXI7DQogICAgICAgICAgICBob2xkZXJJRFtfaG9sZGVyXSA9IF9ob2xkZXJJRDsNCiAgICAgICAgICAgIGhvbGRlckFkZGVkKF9ob2xkZXJJRCwgX2hvbGRlcik7DQoNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gY3JlYXRlSW5pdGlhbFRva2VucygNCiAgICAgICAgYWRkcmVzcyBfaG9sZGVyLCANCiAgICAgICAgdWludCBfcXVhbnRpdHkNCiAgICApIGludGVybmFsIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KDQogICAgICAgIGlmIChfcXVhbnRpdHkgPiAwICYmIGJhbGFuY2VzW19ob2xkZXJdID09IDApIHsNCiAgICAgICAgICAgIGFkZEhvbGRlcihfaG9sZGVyKTsNCiAgICAgICAgICAgIGJhbGFuY2VzW19ob2xkZXJdID0gX3F1YW50aXR5OyANCiAgICAgICAgICAgIHRvdGFsVG9rZW5TdXBwbHkgKz0gX3F1YW50aXR5Ow0KICAgICAgICAgICAgVG9rZW5zQ3JlYXRlZChtc2cuc2VuZGVyLCBfaG9sZGVyLCBfcXVhbnRpdHkpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHNldFRva2VuUHJpY2VQcm9wb3NhbCggICAgICAgIA0KICAgICAgICB1aW50IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLCANCiAgICAgICAgdWludCBfaW5mbGF0aW9uUmF0ZSwNCiAgICAgICAgdWludCBfY2xvc2luZ1RpbWUNCiAgICApIG9ubHlDb250cmFjdG9yIHsNCiAgICAgICAgDQogICAgICAgIGlmIChfY2xvc2luZ1RpbWUgPCBub3cgDQogICAgICAgICAgICB8fCBub3cgPCBGdW5kaW5nUnVsZXNbMV0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBfaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmluZmxhdGlvblJhdGUgPSBfaW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLnN0YXJ0VGltZSA9IG5vdzsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzFdLmNsb3NpbmdUaW1lID0gX2Nsb3NpbmdUaW1lOw0KICAgICAgICANCiAgICAgICAgVG9rZW5QcmljZVByb3Bvc2FsU2V0KF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLCBfaW5mbGF0aW9uUmF0ZSwgX2Nsb3NpbmdUaW1lKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ1J1bGVzKA0KICAgICAgICBhZGRyZXNzIF9tYWluUGFydG5lciwNCiAgICAgICAgYm9vbCBfcHVibGljQ3JlYXRpb24sIA0KICAgICAgICB1aW50IF9pbml0aWFsUHJpY2VNdWx0aXBsaWVyLA0KICAgICAgICB1aW50IF9tYXhBbW91bnRUb0Z1bmQsIA0KICAgICAgICB1aW50IF9taW51dGVzRnVuZGluZ1BlcmlvZCwgDQogICAgICAgIHVpbnQgX2luZmxhdGlvblJhdGUsDQogICAgICAgIHVpbnQgX3Byb3Bvc2FsSUQNCiAgICApIGV4dGVybmFsIG9ubHlDbGllbnQgew0KDQogICAgICAgIGlmIChub3cgPCBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUNCiAgICAgICAgICAgIHx8IF9tYWluUGFydG5lciA9PSBhZGRyZXNzKHRoaXMpDQogICAgICAgICAgICB8fCBfbWFpblBhcnRuZXIgPT0gY2xpZW50DQogICAgICAgICAgICB8fCAoIV9wdWJsaWNDcmVhdGlvbiAmJiBfbWFpblBhcnRuZXIgPT0gMCkNCiAgICAgICAgICAgIHx8IChfcHVibGljQ3JlYXRpb24gJiYgX21haW5QYXJ0bmVyICE9IDApDQogICAgICAgICAgICB8fCAocmVjaXBpZW50ID09IDAgJiYgX2luaXRpYWxQcmljZU11bHRpcGxpZXIgPT0gMCkNCiAgICAgICAgICAgIHx8IChyZWNpcGllbnQgIT0gMCANCiAgICAgICAgICAgICAgICAmJiAoRnVuZGluZ1J1bGVzWzFdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPT0gMA0KICAgICAgICAgICAgICAgICAgICB8fCBfaW5mbGF0aW9uUmF0ZSA8IEZ1bmRpbmdSdWxlc1sxXS5pbmZsYXRpb25SYXRlDQogICAgICAgICAgICAgICAgICAgIHx8IG5vdyA8IEZ1bmRpbmdSdWxlc1sxXS5zdGFydFRpbWUNCiAgICAgICAgICAgICAgICAgICAgfHwgRnVuZGluZ1J1bGVzWzFdLmNsb3NpbmdUaW1lIDwgbm93ICsgKF9taW51dGVzRnVuZGluZ1BlcmlvZCAqIDEgbWludXRlcykpKQ0KICAgICAgICAgICAgfHwgX21heEFtb3VudFRvRnVuZCA9PSAwDQogICAgICAgICAgICB8fCBfbWludXRlc0Z1bmRpbmdQZXJpb2QgPT0gMA0KICAgICAgICAgICAgKSB0aHJvdzsNCg0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lID0gbm93Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUgPSBub3cgKyBfbWludXRlc0Z1bmRpbmdQZXJpb2QgKiAxIG1pbnV0ZXM7DQogICAgICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLm1haW5QYXJ0bmVyID0gX21haW5QYXJ0bmVyOw0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0ucHVibGljQ3JlYXRpb24gPSBfcHVibGljQ3JlYXRpb247DQogICAgICAgIA0KICAgICAgICBpZiAocmVjaXBpZW50ID09IDApIEZ1bmRpbmdSdWxlc1swXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyID0gX2luaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIGVsc2UgRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXIgPSBGdW5kaW5nUnVsZXNbMV0uaW5pdGlhbFByaWNlTXVsdGlwbGllcjsNCiAgICAgICAgDQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCkgRnVuZGluZ1J1bGVzWzBdLmluZmxhdGlvblJhdGUgPSBfaW5mbGF0aW9uUmF0ZTsNCiAgICAgICAgZWxzZSBGdW5kaW5nUnVsZXNbMF0uaW5mbGF0aW9uUmF0ZSA9IEZ1bmRpbmdSdWxlc1sxXS5pbmZsYXRpb25SYXRlOw0KICAgICAgICANCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCA9IDA7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5tYXhBbW91bnRUb0Z1bmQgPSBfbWF4QW1vdW50VG9GdW5kOw0KDQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5wcm9wb3NhbElEID0gX3Byb3Bvc2FsSUQ7DQoNCiAgICAgICAgRnVuZGluZ1J1bGVzU2V0KF9tYWluUGFydG5lciwgX3Byb3Bvc2FsSUQsIEZ1bmRpbmdSdWxlc1swXS5zdGFydFRpbWUsIEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSk7DQogICAgICAgICAgICANCiAgICB9IA0KICAgIA0KICAgIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQsDQogICAgICAgIHVpbnQgX3NhbGVEYXRlDQogICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCg0KICAgICAgICBpZiAobm93ID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lDQogICAgICAgICAgICB8fCBub3cgPCBGdW5kaW5nUnVsZXNbMF0uc3RhcnRUaW1lDQogICAgICAgICAgICB8fF9zYWxlRGF0ZSA+IEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZQ0KICAgICAgICAgICAgfHwgX3NhbGVEYXRlIDwgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZQ0KICAgICAgICAgICAgfHwgRnVuZGluZ1J1bGVzWzBdLmZ1bmRlZEFtb3VudCArIF9hbW91bnQgPiBGdW5kaW5nUnVsZXNbMF0ubWF4QW1vdW50VG9GdW5kKSByZXR1cm47DQoNCiAgICAgICAgdWludCBfYSA9IF9hbW91bnQqRnVuZGluZ1J1bGVzWzBdLmluaXRpYWxQcmljZU11bHRpcGxpZXI7DQogICAgICAgIHVpbnQgX211bHRpcGxpZXIgPSAxMDAqX2E7DQogICAgICAgIHVpbnQgX3F1YW50aXR5ID0gX211bHRpcGxpZXIvcHJpY2VEaXZpc29yKF9zYWxlRGF0ZSk7DQogICAgICAgIGlmIChfYS9fYW1vdW50ICE9IEZ1bmRpbmdSdWxlc1swXS5pbml0aWFsUHJpY2VNdWx0aXBsaWVyDQogICAgICAgICAgICB8fCBfbXVsdGlwbGllci8xMDAgIT0gX2ENCiAgICAgICAgICAgIHx8IHRvdGFsVG9rZW5TdXBwbHkgKyBfcXVhbnRpdHkgPD0gdG90YWxUb2tlblN1cHBseSANCiAgICAgICAgICAgIHx8IHRvdGFsVG9rZW5TdXBwbHkgKyBfcXVhbnRpdHkgPD0gX3F1YW50aXR5KSByZXR1cm47DQoNCiAgICAgICAgYWRkSG9sZGVyKF9yZWNpcGllbnQpOw0KICAgICAgICBiYWxhbmNlc1tfcmVjaXBpZW50XSArPSBfcXVhbnRpdHk7DQogICAgICAgIHRvdGFsVG9rZW5TdXBwbHkgKz0gX3F1YW50aXR5Ow0KICAgICAgICBGdW5kaW5nUnVsZXNbMF0uZnVuZGVkQW1vdW50ICs9IF9hbW91bnQ7DQoNCiAgICAgICAgVG9rZW5zQ3JlYXRlZChtc2cuc2VuZGVyLCBfcmVjaXBpZW50LCBfcXVhbnRpdHkpOw0KICAgICAgICANCiAgICAgICAgaWYgKEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQgPT0gRnVuZGluZ1J1bGVzWzBdLm1heEFtb3VudFRvRnVuZCkgY2xvc2VGdW5kaW5nKCk7DQogICAgICAgIA0KICAgICAgICByZXR1cm4gdHJ1ZTsNCg0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNldEZ1bmRpbmdTdGFydFRpbWUodWludCBfc3RhcnRUaW1lKSBleHRlcm5hbCBvbmx5TWFpblBhcnRuZXIgew0KICAgICAgICBpZiAobm93ID4gRnVuZGluZ1J1bGVzWzBdLmNsb3NpbmdUaW1lKSB0aHJvdzsNCiAgICAgICAgRnVuZGluZ1J1bGVzWzBdLnN0YXJ0VGltZSA9IF9zdGFydFRpbWU7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHJld2FyZFRva2VuKA0KICAgICAgICBhZGRyZXNzIF9yZWNpcGllbnQsIA0KICAgICAgICB1aW50IF9hbW91bnQsDQogICAgICAgIHVpbnQgX2RhdGUNCiAgICAgICAgKSBleHRlcm5hbCBvbmx5TWFpblBhcnRuZXIgew0KDQogICAgICAgIHVpbnQgX3NhbGVEYXRlOw0KICAgICAgICBpZiAoX2RhdGUgPT0gMCkgX3NhbGVEYXRlID0gbm93OyBlbHNlIF9zYWxlRGF0ZSA9IF9kYXRlOw0KDQogICAgICAgIGlmICghY3JlYXRlVG9rZW4oX3JlY2lwaWVudCwgX2Ftb3VudCwgX3NhbGVEYXRlKSkgdGhyb3c7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjbG9zZUZ1bmRpbmcoKSBpbnRlcm5hbCB7DQogICAgICAgIGlmIChyZWNpcGllbnQgPT0gMCkgZnVuZGVkQW1vdW50W0Z1bmRpbmdSdWxlc1swXS5wcm9wb3NhbElEXSA9IEZ1bmRpbmdSdWxlc1swXS5mdW5kZWRBbW91bnQ7DQogICAgICAgIEZ1bmRpbmdSdWxlc1swXS5jbG9zaW5nVGltZSA9IG5vdzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gc2V0RnVuZGluZ0Z1ZWxlZCgpIGV4dGVybmFsIG9ubHlNYWluUGFydG5lciB7DQogICAgICAgIGlmIChub3cgPiBGdW5kaW5nUnVsZXNbMF0uY2xvc2luZ1RpbWUpIHRocm93Ow0KICAgICAgICBjbG9zZUZ1bmRpbmcoKTsNCiAgICAgICAgaWYgKHJlY2lwaWVudCA9PSAwKSBGdW5kaW5nRnVlbGVkKEZ1bmRpbmdSdWxlc1swXS5wcm9wb3NhbElELCBGdW5kaW5nUnVsZXNbMF0uZnVuZGVkQW1vdW50KTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gYWJsZVRyYW5zZmVyKCkgb25seUNsaWVudCB7DQogICAgICAgIGlmICghdHJhbnNmZXJhYmxlKSB7DQogICAgICAgICAgICB0cmFuc2ZlcmFibGUgPSB0cnVlOw0KICAgICAgICAgICAgY2xvc2luZ1RpbWVGb3JDbG9uaW5nID0gMDsNCiAgICAgICAgICAgIFRyYW5zZmVyQWJsZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGlzYWJsZVRyYW5zZmVyKHVpbnQgX2Nsb3NpbmdUaW1lKSBvbmx5Q2xpZW50IHsNCiAgICAgICAgaWYgKHRyYW5zZmVyYWJsZSAmJiBfY2xvc2luZ1RpbWUgPT0gMCkgdHJhbnNmZXJhYmxlID0gZmFsc2U7DQogICAgICAgIGVsc2UgY2xvc2luZ1RpbWVGb3JDbG9uaW5nID0gX2Nsb3NpbmdUaW1lOw0KICAgICAgICAgICAgDQogICAgICAgIFRyYW5zZmVyRGlzYWJsZShfY2xvc2luZ1RpbWUpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBibG9ja1RyYW5zZmVyKGFkZHJlc3MgX3NoYXJlSG9sZGVyLCB1aW50IF9kZWFkTGluZSkgZXh0ZXJuYWwgb25seUNsaWVudCBvbmx5RGFvIHsNCiAgICAgICAgaWYgKF9kZWFkTGluZSA+IGJsb2NrZWREZWFkTGluZVtfc2hhcmVIb2xkZXJdKSB7DQogICAgICAgICAgICBibG9ja2VkRGVhZExpbmVbX3NoYXJlSG9sZGVyXSA9IF9kZWFkTGluZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBidXlTaGFyZXMoKSBwYXlhYmxlIHsNCiAgICAgICAgYnV5U2hhcmVzRm9yKG1zZy5zZW5kZXIpOw0KICAgIH0gDQogICAgDQogICAgZnVuY3Rpb24gYnV5U2hhcmVzRm9yKGFkZHJlc3MgX3JlY2lwaWVudCkgcGF5YWJsZSBvbmx5RGFvIHsNCiAgICAgICAgDQogICAgICAgIGlmICghRnVuZGluZ1J1bGVzWzBdLnB1YmxpY0NyZWF0aW9uIA0KICAgICAgICAgICAgfHwgIWNyZWF0ZVRva2VuKF9yZWNpcGllbnQsIG1zZy52YWx1ZSwgbm93KSkgdGhyb3c7DQoNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tVG8oDQogICAgICAgIGFkZHJlc3MgX2Zyb20sDQogICAgICAgIGFkZHJlc3MgX3RvLCANCiAgICAgICAgdWludDI1NiBfdmFsdWUNCiAgICAgICAgKSBpbnRlcm5hbCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsgIA0KDQogICAgICAgIGlmICgodHJhbnNmZXJhYmxlICYmIG5vdyA+IENsb3NpbmdUaW1lRm9yQ2xvbmluZygpKQ0KICAgICAgICAgICAgJiYgbm93ID4gYmxvY2tlZERlYWRMaW5lW19mcm9tXQ0KICAgICAgICAgICAgJiYgbm93ID4gYmxvY2tlZERlYWRMaW5lW190b10NCiAgICAgICAgICAgICYmIF90byAhPSBhZGRyZXNzKHRoaXMpDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX3ZhbHVlID4gYmFsYW5jZXNbX3RvXQ0KICAgICAgICAgICAgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+PSBfdmFsdWUNCiAgICAgICAgKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWU7DQogICAgICAgICAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICAgICAgICAgICAgYWRkSG9sZGVyKF90byk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyAgDQogICAgICAgIGlmICghdHJhbnNmZXJGcm9tVG8obXNnLnNlbmRlciwgX3RvLCBfdmFsdWUpKSB0aHJvdzsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKA0KICAgICAgICBhZGRyZXNzIF9mcm9tLCANCiAgICAgICAgYWRkcmVzcyBfdG8sIA0KICAgICAgICB1aW50MjU2IF92YWx1ZQ0KICAgICAgICApIHJldHVybnMgKGJvb2wgc3VjY2VzcykgeyANCiAgICAgICAgDQogICAgICAgIGlmIChhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA8IF92YWx1ZQ0KICAgICAgICAgICAgfHwgIXRyYW5zZmVyRnJvbVRvKF9mcm9tLCBfdG8sIF92YWx1ZSkpIHRocm93Ow0KICAgICAgICAgICAgDQogICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogICAgDQp9'