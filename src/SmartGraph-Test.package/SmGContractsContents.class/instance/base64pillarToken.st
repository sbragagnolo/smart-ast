base 64 content
base64pillarToken
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KDQovKioNCiAqIE1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MNCiAqLw0KbGlicmFyeSBTYWZlTWF0aCB7DQogIGZ1bmN0aW9uIG11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBkaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDANCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZA0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgcmV0dXJuIGEgLSBiOw0KICB9DQoNCiAgZnVuY3Rpb24gYWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSArIGI7DQogICAgYXNzZXJ0KGMgPj0gYSk7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogIH0NCn0NCg0KLyoqDQogKiBAdGl0bGUgT3duYWJsZQ0KICogQGRldiBUaGUgT3duYWJsZSBjb250cmFjdCBoYXMgYW4gb3duZXIgYWRkcmVzcywgYW5kIHByb3ZpZGVzIGJhc2ljIGF1dGhvcml6YXRpb24gY29udHJvbCANCiAqIGZ1bmN0aW9ucywgdGhpcyBzaW1wbGlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiAidXNlciBwZXJtaXNzaW9ucyIuIA0KICovDQpjb250cmFjdCBPd25hYmxlIHsNCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQoNCg0KICAvKiogDQogICAqIEBkZXYgVGhlIE93bmFibGUgY29uc3RydWN0b3Igc2V0cyB0aGUgb3JpZ2luYWwgYG93bmVyYCBvZiB0aGUgY29udHJhY3QgdG8gdGhlIHNlbmRlcg0KICAgKiBhY2NvdW50Lg0KICAgKi8NCiAgZnVuY3Rpb24gT3duYWJsZSgpIHsNCiAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogIH0NCg0KDQogIC8qKg0KICAgKiBAZGV2IFRocm93cyBpZiBjYWxsZWQgYnkgYW55IGFjY291bnQgb3RoZXIgdGhhbiB0aGUgb3duZXIuIA0KICAgKi8NCiAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KDQoNCiAgLyoqDQogICAqIEBkZXYgQWxsb3dzIHRoZSBjdXJyZW50IG93bmVyIHRvIHRyYW5zZmVyIGNvbnRyb2wgb2YgdGhlIGNvbnRyYWN0IHRvIGEgbmV3T3duZXIuDQogICAqIEBwYXJhbSBuZXdPd25lciBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciBvd25lcnNoaXAgdG8uIA0KICAgKi8NCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsNCiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgew0KICAgICAgb3duZXIgPSBuZXdPd25lcjsNCiAgICB9DQogIH0NCg0KfQ0KDQpjb250cmFjdCBUZWFtQWxsb2NhdGlvbiBpcyBPd25hYmxlIHsNCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7DQogIC8vdWludCBwdWJsaWMgY29uc3RhbnQgbG9ja2VkVGVhbUFsbG9jYXRpb25Ub2tlbnMgPSAxNjAwMDAwMDsNCiAgdWludCBwdWJsaWMgdW5sb2NrZWRBdDsNCiAgUGlsbGFyVG9rZW4gcGxyOw0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGFsbG9jYXRpb25zOw0KICB1aW50IHRva2Vuc0NyZWF0ZWQgPSAwOw0KICB1aW50IGNvbnN0YW50IHB1YmxpYyBsb2NrZWRUZWFtQWxsb2NhdGlvblRva2VucyA9IDE2MDAwMDAwZTE4Ow0KICAvL2FkZHJlc3Mgb2YgdGhlIHRlYW0gc3RvcmFnZSB2YXVsdA0KICBhZGRyZXNzIHB1YmxpYyB0ZWFtU3RvcmFnZVZhdWx0ID0gMHgzZjVEOTBENUNjMDY1MkFBYTQwNTE5MTE0RDAwN0JmMTE5QWZlMUNmOw0KDQogIGZ1bmN0aW9uIFRlYW1BbGxvY2F0aW9uKCkgew0KICAgIHBsciA9IFBpbGxhclRva2VuKG1zZy5zZW5kZXIpOw0KICAgIC8vIExvY2tlZCB0aW1lIG9mIGFwcHJveGltYXRlbHkgOSBtb250aHMgYmVmb3JlIHRlYW0gbWVtYmVycyBhcmUgYWJsZSB0byByZWRlZWVtIHRva2Vucy4NCiAgICB1aW50IG5pbmVNb250aHMgPSA5ICogMzAgZGF5czsNCiAgICB1bmxvY2tlZEF0ID0gbm93LmFkZChuaW5lTW9udGhzKTsNCiAgICAvLzIlIHRva2VucyBmcm9tIHRoZSBNYXJrZXRpbmcgYnVja2V0IHdoaWNoIGFyZSBsb2NrZWQgZm9yIDkgbW9udGhzDQogICAgYWxsb2NhdGlvbnNbdGVhbVN0b3JhZ2VWYXVsdF0gPSBsb2NrZWRUZWFtQWxsb2NhdGlvblRva2VuczsNCiAgfQ0KDQogIGZ1bmN0aW9uIGdldFRvdGFsQWxsb2NhdGlvbigpIHJldHVybnMgKHVpbnQpew0KICAgICAgcmV0dXJuIGxvY2tlZFRlYW1BbGxvY2F0aW9uVG9rZW5zOw0KICB9DQoNCiAgZnVuY3Rpb24gdW5sb2NrKCkgZXh0ZXJuYWwgcGF5YWJsZSB7DQogICAgaWYgKG5vdyA8IHVubG9ja2VkQXQpIHRocm93Ow0KDQogICAgaWYgKHRva2Vuc0NyZWF0ZWQgPT0gMCkgew0KICAgICAgdG9rZW5zQ3JlYXRlZCA9IHBsci5iYWxhbmNlT2YodGhpcyk7DQogICAgfQ0KICAgIC8vdHJhbnNmZXIgdGhlIGxvY2tlZCB0b2tlbnMgdG8gdGhlIHRlYW1TdG9yYWdlQWRkcmVzcw0KICAgIHBsci50cmFuc2Zlcih0ZWFtU3RvcmFnZVZhdWx0LCB0b2tlbnNDcmVhdGVkKTsNCiAgfQ0KfQ0KDQpjb250cmFjdCBVbnNvbGRBbGxvY2F0aW9uIGlzIE93bmFibGUgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgdWludCB1bmxvY2tlZEF0Ow0KICB1aW50IGFsbG9jYXRlZFRva2VuczsNCiAgUGlsbGFyVG9rZW4gcGxyOw0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpIGFsbG9jYXRpb25zOw0KDQogIHVpbnQgdG9rZW5zQ3JlYXRlZCA9IDA7DQoNCiAgLyoNCiAgICBTcGxpdCBhbW9uZyB0ZWFtIG1lbWJlcnMNCiAgICBUb2tlbnMgcmVzZXJ2ZWQgZm9yIFRlYW06IDEsMDAwLDAwMA0KICAgIFRva2VucyByZXNlcnZlZCBmb3IgMjB8MzAgcHJvamVjdHM6IDEsMDAwLDAwMA0KICAgIFRva2VucyByZXNlcnZlZCBmb3IgZnV0dXJlIHNhbGU6IDEsMDAwLDAwMA0KICAqLw0KDQogIGZ1bmN0aW9uIFVuc29sZEFsbG9jYXRpb24odWludCBfbG9ja1RpbWUsIGFkZHJlc3MgX293bmVyLCB1aW50IF90b2tlbnMpIHsNCiAgICBpZihfbG9ja1RpbWUgPT0gMCkgdGhyb3c7DQoNCiAgICBpZihfb3duZXIgPT0gYWRkcmVzcygwKSkgdGhyb3c7DQoNCiAgICBwbHIgPSBQaWxsYXJUb2tlbihtc2cuc2VuZGVyKTsNCiAgICB1aW50IGxvY2tUaW1lID0gX2xvY2tUaW1lICogMSB5ZWFyczsNCiAgICB1bmxvY2tlZEF0ID0gbm93LmFkZChsb2NrVGltZSk7DQogICAgYWxsb2NhdGVkVG9rZW5zID0gX3Rva2VuczsNCiAgICBhbGxvY2F0aW9uc1tfb3duZXJdID0gX3Rva2VuczsNCiAgfQ0KDQogIGZ1bmN0aW9uIGdldFRvdGFsQWxsb2NhdGlvbigpcmV0dXJucyh1aW50KXsNCiAgICAgIHJldHVybiBhbGxvY2F0ZWRUb2tlbnM7DQogIH0NCg0KICBmdW5jdGlvbiB1bmxvY2soKSBleHRlcm5hbCBwYXlhYmxlIHsNCiAgICBpZiAobm93IDwgdW5sb2NrZWRBdCkgdGhyb3c7DQoNCiAgICBpZiAodG9rZW5zQ3JlYXRlZCA9PSAwKSB7DQogICAgICB0b2tlbnNDcmVhdGVkID0gcGxyLmJhbGFuY2VPZih0aGlzKTsNCiAgICB9DQoNCiAgICB2YXIgYWxsb2NhdGlvbiA9IGFsbG9jYXRpb25zW21zZy5zZW5kZXJdOw0KICAgIGFsbG9jYXRpb25zW21zZy5zZW5kZXJdID0gMDsNCiAgICB2YXIgdG9UcmFuc2ZlciA9ICh0b2tlbnNDcmVhdGVkLm11bChhbGxvY2F0aW9uKSkuZGl2KGFsbG9jYXRlZFRva2Vucyk7DQogICAgcGxyLnRyYW5zZmVyKG1zZy5zZW5kZXIsIHRvVHJhbnNmZXIpOw0KICB9DQp9DQoNCi8qKg0KICogQHRpdGxlIFBhdXNhYmxlDQogKiBAZGV2IEJhc2UgY29udHJhY3Qgd2hpY2ggYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQogKi8NCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgew0KICBldmVudCBQYXVzZSgpOw0KICBldmVudCBVbnBhdXNlKCk7DQoNCiAgYm9vbCBwdWJsaWMgcGF1c2VkID0gZmFsc2U7DQoNCg0KICAvKioNCiAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgcGF1c2VkDQogICAqLw0KICBtb2RpZmllciB3aGVuTm90UGF1c2VkKCkgew0KICAgIGlmIChwYXVzZWQpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvKioNCiAgICogQGRldiBtb2RpZmllciB0byBhbGxvdyBhY3Rpb25zIG9ubHkgd2hlbiB0aGUgY29udHJhY3QgSVMgTk9UIHBhdXNlZA0KICAgKi8NCiAgbW9kaWZpZXIgd2hlblBhdXNlZCB7DQogICAgaWYgKCFwYXVzZWQpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvKioNCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHBhdXNlLCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlDQogICAqLw0KICBmdW5jdGlvbiBwYXVzZSgpIG9ubHlPd25lciB3aGVuTm90UGF1c2VkIHJldHVybnMgKGJvb2wpIHsNCiAgICBwYXVzZWQgPSB0cnVlOw0KICAgIFBhdXNlKCk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICAvKioNCiAgICogQGRldiBjYWxsZWQgYnkgdGhlIG93bmVyIHRvIHVucGF1c2UsIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlDQogICAqLw0KICBmdW5jdGlvbiB1bnBhdXNlKCkgb25seU93bmVyIHdoZW5QYXVzZWQgcmV0dXJucyAoYm9vbCkgew0KICAgIHBhdXNlZCA9IGZhbHNlOw0KICAgIFVucGF1c2UoKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KfQ0KDQoNCi8qKg0KICogQHRpdGxlIEVSQzIwQmFzaWMNCiAqIEBkZXYgU2ltcGxlciB2ZXJzaW9uIG9mIEVSQzIwIGludGVyZmFjZQ0KICogQGRldiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwDQogKi8NCmNvbnRyYWN0IEVSQzIwQmFzaWMgew0KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsNCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyB0bywgdWludCB2YWx1ZSk7DQogIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQgdmFsdWUpOw0KfQ0KDQovKioNCiAqIEB0aXRsZSBCYXNpYyB0b2tlbg0KICogQGRldiBCYXNpYyB2ZXJzaW9uIG9mIFN0YW5kYXJkVG9rZW4sIHdpdGggbm8gYWxsb3dhbmNlcy4gDQogKi8NCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7DQogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50Ow0KDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsNCg0KICAvKioNCiAgICogQGRldiBGaXggZm9yIHRoZSBFUkMyMCBzaG9ydCBhZGRyZXNzIGF0dGFjay4NCiAgICovDQogIG1vZGlmaWVyIG9ubHlQYXlsb2FkU2l6ZSh1aW50IHNpemUpIHsNCiAgICAgaWYobXNnLmRhdGEubGVuZ3RoIDwgc2l6ZSArIDQpIHsNCiAgICAgICB0aHJvdzsNCiAgICAgfQ0KICAgICBfOw0KICB9DQoNCiAgLyoqDQogICogQGRldiB0cmFuc2ZlciB0b2tlbiBmb3IgYSBzcGVjaWZpZWQgYWRkcmVzcw0KICAqIEBwYXJhbSBfdG8gVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgdG8uDQogICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IHRvIGJlIHRyYW5zZmVycmVkLg0KICAqLw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgfQ0KDQogIC8qKg0KICAqIEBkZXYgR2V0cyB0aGUgYmFsYW5jZSBvZiB0aGUgc3BlY2lmaWVkIGFkZHJlc3MuDQogICogQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0byBxdWVyeSB0aGUgdGhlIGJhbGFuY2Ugb2YuIA0KICAqIEByZXR1cm4gQW4gdWludCByZXByZXNlbnRpbmcgdGhlIGFtb3VudCBvd25lZCBieSB0aGUgcGFzc2VkIGFkZHJlc3MuDQogICovDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7DQogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogIH0NCg0KfQ0KDQovKioNCiAqIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2UNCiAqIEBkZXYgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KICovDQpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpOw0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQovKioNCiAqIEB0aXRsZSBTdGFuZGFyZCBFUkMyMCB0b2tlbg0KICoNCiAqIEBkZXYgSW1wbGVtYW50YXRpb24gb2YgdGhlIGJhc2ljIHN0YW5kYXJ0IHRva2VuLg0KICogQGRldiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCiAqIEBkZXYgQmFzZWQgb24gY29kZSBieSBGaXJzdEJsb29kOiBodHRwczovL2dpdGh1Yi5jb20vRmlyc3RibG9vZGlvL3Rva2VuL2Jsb2IvbWFzdGVyL3NtYXJ0X2NvbnRyYWN0L0ZpcnN0Qmxvb2RUb2tlbi5zb2wNCiAqLw0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQpKSBhbGxvd2VkOw0KDQoNCiAgLyoqDQogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcg0KICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tDQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bw0KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkDQogICAqLw0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSB7DQogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsNCg0KICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldA0KICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsNCg0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsNCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7DQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgfQ0KDQogIC8qKg0KICAgKiBAZGV2IEFwcm92ZSB0aGUgcGFzc2VkIGFkZHJlc3MgdG8gc3BlbmQgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdG9rZW5zIG9uIGJlYWhsZiBvZiBtc2cuc2VuZGVyLg0KICAgKiBAcGFyYW0gX3NwZW5kZXIgVGhlIGFkZHJlc3Mgd2hpY2ggd2lsbCBzcGVuZCB0aGUgZnVuZHMuDQogICAqIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgc3BlbnQuDQogICAqLw0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSB7DQoNCiAgICAvLyBUbyBjaGFuZ2UgdGhlIGFwcHJvdmUgYW1vdW50IHlvdSBmaXJzdCBoYXZlIHRvIHJlZHVjZSB0aGUgYWRkcmVzc2VzYA0KICAgIC8vICBhbGxvd2FuY2UgdG8gemVybyBieSBjYWxsaW5nIGBhcHByb3ZlKF9zcGVuZGVyLCAwKWAgaWYgaXQgaXMgbm90DQogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5DQogICAgaWYgKChfdmFsdWUgIT0gMCkgJiYgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdICE9IDApKSB0aHJvdzsNCg0KICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICB9DQoNCiAgLyoqDQogICAqIEBkZXYgRnVuY3Rpb24gdG8gY2hlY2sgdGhlIGFtb3VudCBvZiB0b2tlbnMgdGhhbiBhbiBvd25lciBhbGxvd2VkIHRvIGEgc3BlbmRlci4NCiAgICogQHBhcmFtIF9vd25lciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIG93bnMgdGhlIGZ1bmRzLg0KICAgKiBAcGFyYW0gX3NwZW5kZXIgYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4NCiAgICogQHJldHVybiBBIHVpbnQgc3BlY2lmaW5nIHRoZSBhbW91bnQgb2YgdG9rZW5zIHN0aWxsIGF2YWlibGUgZm9yIHRoZSBzcGVuZGVyLg0KICAgKi8NCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgew0KICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICB9DQoNCn0NCg0KLy8vIEB0aXRsZSBQaWxsYXJUb2tlbiAtIENyb3dkZnVuZGluZyBjb2RlIGZvciB0aGUgUGlsbGFyIFByb2plY3QNCi8vLyBAYXV0aG9yIFBhcnRoYXNhcmF0aHkgUmFtYW51amFtLCBHdXN0YXZvIEd1aW1hcmFlcywgUm9uYWsgVGhhY2tlcg0KY29udHJhY3QgUGlsbGFyVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duYWJsZSB7DQoNCiAgICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUElMTEFSIjsNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJQTFIiOw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gMTg7DQoNCiAgICBUZWFtQWxsb2NhdGlvbiBwdWJsaWMgdGVhbUFsbG9jYXRpb247DQogICAgVW5zb2xkQWxsb2NhdGlvbiBwdWJsaWMgdW5zb2xkVG9rZW5zOw0KICAgIFVuc29sZEFsbG9jYXRpb24gcHVibGljIHR3ZW50eVRoaXJ0eUFsbG9jYXRpb247DQogICAgVW5zb2xkQWxsb2NhdGlvbiBwdWJsaWMgZnV0dXJlU2FsZUFsbG9jYXRpb247DQoNCiAgICB1aW50IGNvbnN0YW50IHB1YmxpYyBtaW5Ub2tlbnNGb3JTYWxlICA9IDMyMDAwMDAwZTE4Ow0KDQogICAgdWludCBjb25zdGFudCBwdWJsaWMgbWF4UHJlc2FsZVRva2VucyAgICAgICAgICAgICA9ICA0ODAwMDAwMGUxODsNCiAgICB1aW50IGNvbnN0YW50IHB1YmxpYyB0b3RhbEF2YWlsYWJsZUZvclNhbGUgICAgICAgID0gNTI4MDAwMDAwZTE4Ow0KICAgIHVpbnQgY29uc3RhbnQgcHVibGljIGZ1dHVyZVRva2VucyAgICAgICAgICAgICAgICAgPSAxMjAwMDAwMDBlMTg7DQogICAgdWludCBjb25zdGFudCBwdWJsaWMgdHdlbnR5VGhpcnR5VG9rZW5zICAgICAgICAgICA9ICA4MDAwMDAwMGUxODsNCiAgICB1aW50IGNvbnN0YW50IHB1YmxpYyBsb2NrZWRUZWFtQWxsb2NhdGlvblRva2VucyAgID0gIDE2MDAwMDAwZTE4Ow0KICAgIHVpbnQgY29uc3RhbnQgcHVibGljIHVubG9ja2VkVGVhbUFsbG9jYXRpb25Ub2tlbnMgPSAgIDgwMDAwMDBlMTg7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyB1bmxvY2tlZFRlYW1TdG9yYWdlVmF1bHQgPSAweDQxNjJBZDZFRWMzNDFlNDM4ZUFiZTg1ZjUyYTk0MUIwNzgyMTA4MTk7DQogICAgYWRkcmVzcyBwdWJsaWMgdHdlbnR5VGhpcnR5VmF1bHQgPSAweGU3MmJBNWM2RjYzRGRkMzk1REY5NTgyODAwRTI4MjFjRTVhMDVENzU7DQogICAgYWRkcmVzcyBwdWJsaWMgZnV0dXJlU2FsZVZhdWx0ID0gMHhmMDIzMTE2MEJkMWEyYTJEMjVhZWQyRjExQjgzNjBFYkY1NkY2MTUzOw0KICAgIGFkZHJlc3MgdW5zb2xkVmF1bHQ7DQoNCiAgICAvL1N0b3JhZ2UgeWVhcnMNCiAgICB1aW50IGNvbnN0YW50IGNvbGRTdG9yYWdlWWVhcnMgPSAxMDsNCiAgICB1aW50IGNvbnN0YW50IGZ1dHVyZVN0b3JhZ2VZZWFycyA9IDM7DQoNCiAgICB1aW50IHRvdGFsUHJlc2FsZSA9IDA7DQoNCiAgICAvLyBGdW5kaW5nIGFtb3VudCBpbiBldGhlcg0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IHRva2VuUHJpY2UgID0gMC4wMDA1IGV0aGVyOw0KDQogICAgLy8gTXVsdGlzaWd3YWxsZXQgd2hlcmUgdGhlIHByb2NlZWRzIHdpbGwgYmUgc3RvcmVkLg0KICAgIGFkZHJlc3MgcHVibGljIHBpbGxhclRva2VuRmFjdG9yeTsNCg0KICAgIHVpbnQgZnVuZGluZ1N0YXJ0QmxvY2s7DQogICAgdWludCBmdW5kaW5nU3RvcEJsb2NrOw0KDQogICAgLy8gZmxhZ3Mgd2hldGhlciBJQ08gaXMgYWZvb3QuDQogICAgYm9vbCBmdW5kaW5nTW9kZTsNCg0KICAgIC8vdG90YWwgdXNlZCB0b2tlbnMNCiAgICB1aW50IHRvdGFsVXNlZFRva2VuczsNCg0KICAgIGV2ZW50IFJlZnVuZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IE1pZ3JhdGUoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7DQogICAgZXZlbnQgTW9uZXlBZGRlZEZvclJlZnVuZChhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF92YWx1ZSx1aW50MjU2IF90b3RhbCk7DQoNCiAgICBtb2RpZmllciBpc05vdEZ1bmRhYmxlKCkgew0KICAgICAgICBpZiAoZnVuZGluZ01vZGUpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGlzRnVuZGFibGUoKSB7DQogICAgICAgIGlmICghZnVuZGluZ01vZGUpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSAgQ29uc3RydWN0b3Igb2YgUGlsbGFyVG9rZW4NCiAgICAvL0BwYXJhbSBgX3BpbGxhclRva2VuRmFjdG9yeWAgLSBtdWx0aXNpZ3dhbGxldCBhZGRyZXNzIHRvIHN0b3JlIHByb2NlZWRzLg0KICAgIC8vQHBhcmFtIGBfaWNlZFdhbGxldGAgLSBNdWx0aXNpZ3dhbGxldCBhZGRyZXNzIHRvIHdoaWNoIHVuc29sZCB0b2tlbnMgYXJlIGFzc2lnbmVkDQogICAgZnVuY3Rpb24gUGlsbGFyVG9rZW4oYWRkcmVzcyBfcGlsbGFyVG9rZW5GYWN0b3J5LCBhZGRyZXNzIF9pY2VkV2FsbGV0KSB7DQogICAgICBpZihfcGlsbGFyVG9rZW5GYWN0b3J5ID09IGFkZHJlc3MoMCkpIHRocm93Ow0KICAgICAgaWYoX2ljZWRXYWxsZXQgPT0gYWRkcmVzcygwKSkgdGhyb3c7DQoNCiAgICAgIHBpbGxhclRva2VuRmFjdG9yeSA9IF9waWxsYXJUb2tlbkZhY3Rvcnk7DQogICAgICB0b3RhbFVzZWRUb2tlbnMgPSAwOw0KICAgICAgdG90YWxTdXBwbHkgPSA4MDAwMDAwMDBlMTg7DQogICAgICB1bnNvbGRWYXVsdCA9IF9pY2VkV2FsbGV0Ow0KDQogICAgICAvL2FsbG90IDggbWlsbGlvbiBvZiB0aGUgMjQgbWlsbGlvbiBtYXJrZXRpbmcgdG9rZW5zIHRvIGFuIGFkZHJlc3MNCiAgICAgIGJhbGFuY2VzW3VubG9ja2VkVGVhbVN0b3JhZ2VWYXVsdF0gPSB1bmxvY2tlZFRlYW1BbGxvY2F0aW9uVG9rZW5zOw0KDQogICAgICAvL2FsbG9jYXRlIHRva2VucyBmb3IgMjAzMCB3YWxsZXQgbG9ja2VkIGluIGZvciAzIHllYXJzDQogICAgICBmdXR1cmVTYWxlQWxsb2NhdGlvbiA9IG5ldyBVbnNvbGRBbGxvY2F0aW9uKGZ1dHVyZVN0b3JhZ2VZZWFycyxmdXR1cmVTYWxlVmF1bHQsZnV0dXJlVG9rZW5zKTsNCiAgICAgIGJhbGFuY2VzW2FkZHJlc3MoZnV0dXJlU2FsZUFsbG9jYXRpb24pXSA9IGZ1dHVyZVRva2VuczsNCg0KICAgICAgLy9hbGxvY2F0ZSB0b2tlbnMgZm9yIGZ1dHVyZSB3YWxsZXQgbG9ja2VkIGluIGZvciAzIHllYXJzDQogICAgICB0d2VudHlUaGlydHlBbGxvY2F0aW9uID0gbmV3IFVuc29sZEFsbG9jYXRpb24oZnV0dXJlU3RvcmFnZVllYXJzLHR3ZW50eVRoaXJ0eVZhdWx0LHR3ZW50eVRoaXJ0eVRva2Vucyk7DQogICAgICBiYWxhbmNlc1thZGRyZXNzKHR3ZW50eVRoaXJ0eUFsbG9jYXRpb24pXSA9IHR3ZW50eVRoaXJ0eVRva2VuczsNCg0KICAgICAgZnVuZGluZ01vZGUgPSBmYWxzZTsNCiAgICB9DQoNCiAgICAvL0Bub3RpY2UgRmFsbGJhY2sgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIHRoZSBldGhlciBhbmQgYWxsb2NhdGVzIHRva2VucyB0bw0KICAgIC8vdGhlIG1zZy5zZW5kZXIgY29ycmVzcG9uZGluZyB0byBtc2cudmFsdWUNCiAgICBmdW5jdGlvbigpIHBheWFibGUgaXNGdW5kYWJsZSBleHRlcm5hbCB7DQogICAgICBwdXJjaGFzZSgpOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgdGhlIGV0aGVyIGFuZCBhbGxvY2F0ZXMgdG9rZW5zIHRvDQogICAgLy90aGUgbXNnLnNlbmRlciBjb3JyZXNwb25kaW5nIHRvIG1zZy52YWx1ZQ0KICAgIGZ1bmN0aW9uIHB1cmNoYXNlKCkgcGF5YWJsZSBpc0Z1bmRhYmxlIHsNCiAgICAgIGlmKGJsb2NrLm51bWJlciA8IGZ1bmRpbmdTdGFydEJsb2NrKSB0aHJvdzsNCiAgICAgIGlmKGJsb2NrLm51bWJlciA+IGZ1bmRpbmdTdG9wQmxvY2spIHRocm93Ow0KICAgICAgaWYodG90YWxVc2VkVG9rZW5zID49IHRvdGFsQXZhaWxhYmxlRm9yU2FsZSkgdGhyb3c7DQoNCiAgICAgIGlmIChtc2cudmFsdWUgPCB0b2tlblByaWNlKSB0aHJvdzsNCg0KICAgICAgdWludCBudW1Ub2tlbnMgPSBtc2cudmFsdWUuZGl2KHRva2VuUHJpY2UpOw0KICAgICAgaWYobnVtVG9rZW5zIDwgMSkgdGhyb3c7DQogICAgICAvL3RyYW5zZmVyIG1vbmV5IHRvIFBpbGxhclRva2VuRmFjdG9yeSBNdWx0aXNpZ1dhbGxldA0KICAgICAgcGlsbGFyVG9rZW5GYWN0b3J5LnRyYW5zZmVyKG1zZy52YWx1ZSk7DQoNCiAgICAgIHVpbnQgdG9rZW5zID0gbnVtVG9rZW5zLm11bCgxZTE4KTsNCiAgICAgIHRvdGFsVXNlZFRva2VucyA9IHRvdGFsVXNlZFRva2Vucy5hZGQodG9rZW5zKTsNCiAgICAgIGlmICh0b3RhbFVzZWRUb2tlbnMgPiB0b3RhbEF2YWlsYWJsZUZvclNhbGUpIHRocm93Ow0KDQogICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLmFkZCh0b2tlbnMpOw0KDQogICAgICAvL2ZpcmUgdGhlIGV2ZW50IG5vdGlmeWluZyB0aGUgdHJhbnNmZXIgb2YgdG9rZW5zDQogICAgICBUcmFuc2ZlcigwLCBtc2cuc2VuZGVyLCB0b2tlbnMpOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSBGdW5jdGlvbiByZXBvcnRzIHRoZSBudW1iZXIgb2YgdG9rZW5zIGF2YWlsYWJsZSBmb3Igc2FsZQ0KICAgIGZ1bmN0aW9uIG51bWJlck9mVG9rZW5zTGVmdCgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICAgIHVpbnQgdG9rZW5zQXZhaWxhYmxlRm9yU2FsZSA9IHRvdGFsQXZhaWxhYmxlRm9yU2FsZS5zdWIodG90YWxVc2VkVG9rZW5zKTsNCiAgICAgIHJldHVybiB0b2tlbnNBdmFpbGFibGVGb3JTYWxlOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSBGaW5hbGl6ZSB0aGUgSUNPLCBzZW5kIHRlYW0gYWxsb2NhdGlvbiB0b2tlbnMNCiAgICAvL0Bub3RpY2Ugc2VuZCBhbnkgcmVtYWluaW5nIGJhbGFuY2UgdG8gdGhlIE11bHRpc2lnV2FsbGV0DQogICAgLy9Abm90aWNlIHVuc29sZCB0b2tlbnMgd2lsbCBiZSBzZW50IHRvIGljZWR3YWxsZXQNCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIGlzRnVuZGFibGUgb25seU93bmVyIGV4dGVybmFsIHsNCiAgICAgIGlmIChibG9jay5udW1iZXIgPD0gZnVuZGluZ1N0b3BCbG9jaykgdGhyb3c7DQoNCiAgICAgIGlmICh0b3RhbFVzZWRUb2tlbnMgPCBtaW5Ub2tlbnNGb3JTYWxlKSB0aHJvdzsNCg0KICAgICAgaWYodW5zb2xkVmF1bHQgPT0gYWRkcmVzcygwKSkgdGhyb3c7DQoNCiAgICAgIC8vIHN3aXRjaCBmdW5kaW5nIG1vZGUgb2ZmDQogICAgICBmdW5kaW5nTW9kZSA9IGZhbHNlOw0KDQogICAgICAvL0FsbG90IHRlYW0gdG9rZW5zIHRvIGEgc21hcnQgY29udHJhY3Qgd2hpY2ggd2lsbCBmcm96ZW4gZm9yIDkgbW9udGhzDQogICAgICB0ZWFtQWxsb2NhdGlvbiA9IG5ldyBUZWFtQWxsb2NhdGlvbigpOw0KICAgICAgYmFsYW5jZXNbYWRkcmVzcyh0ZWFtQWxsb2NhdGlvbildID0gbG9ja2VkVGVhbUFsbG9jYXRpb25Ub2tlbnM7DQoNCiAgICAgIC8vYWxsb2NhdGUgdW5zb2xkIHRva2VucyB0byBpY2VkIHN0b3JhZ2UNCiAgICAgIHVpbnQgdG90YWxVblNvbGQgPSBudW1iZXJPZlRva2Vuc0xlZnQoKTsNCiAgICAgIGlmKHRvdGFsVW5Tb2xkID4gMCkgew0KICAgICAgICB1bnNvbGRUb2tlbnMgPSBuZXcgVW5zb2xkQWxsb2NhdGlvbihjb2xkU3RvcmFnZVllYXJzLHVuc29sZFZhdWx0LHRvdGFsVW5Tb2xkKTsNCiAgICAgICAgYmFsYW5jZXNbYWRkcmVzcyh1bnNvbGRUb2tlbnMpXSA9IHRvdGFsVW5Tb2xkOw0KICAgICAgfQ0KDQogICAgICAvL3RyYW5zZmVyIGFueSBiYWxhbmNlIGF2YWlsYWJsZSB0byBQaWxsYXIgTXVsdGlzaWcgV2FsbGV0DQogICAgICBwaWxsYXJUb2tlbkZhY3RvcnkudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsNCiAgICB9DQoNCiAgICAvL0Bub3RpY2UgRnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIGJ5IHB1cmNoYXNlcnMgdG8gcmVmdW5kDQogICAgLy9Abm90aWNlIFVzZWQgb25seSBpbiBjYXNlIHRoZSBJQ08gaXNuJ3Qgc3VjY2Vzc2Z1bC4NCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBpc0Z1bmRhYmxlIGV4dGVybmFsIHsNCiAgICAgIGlmKGJsb2NrLm51bWJlciA8PSBmdW5kaW5nU3RvcEJsb2NrKSB0aHJvdzsNCiAgICAgIGlmKHRvdGFsVXNlZFRva2VucyA+PSBtaW5Ub2tlbnNGb3JTYWxlKSB0aHJvdzsNCg0KICAgICAgdWludCBwbHJWYWx1ZSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdOw0KICAgICAgaWYocGxyVmFsdWUgPT0gMCkgdGhyb3c7DQoNCiAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gMDsNCg0KICAgICAgdWludCBldGhWYWx1ZSA9IHBsclZhbHVlLm11bCh0b2tlblByaWNlKS5kaXYoMWUxOCk7DQogICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aFZhbHVlKTsNCiAgICAgIFJlZnVuZChtc2cuc2VuZGVyLCBldGhWYWx1ZSk7DQogICAgfQ0KDQogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHVzZWQgZm9yIGZ1bmRpbmcgaW4gY2FzZSBvZiByZWZ1bmQuDQogICAgLy9Abm90aWNlIENhbiBiZSBjYWxsZWQgb25seSBieSB0aGUgT3duZXINCiAgICBmdW5jdGlvbiBhbGxvY2F0ZUZvclJlZnVuZCgpIGV4dGVybmFsIHBheWFibGUgb25seU93bmVyIHJldHVybnMgKHVpbnQpew0KICAgICAgLy9kb2VzIG5vdGhpbmcganVzdCBhY2NlcHRzIGFuZCBzdG9yZXMgdGhlIGV0aGVyDQogICAgICBNb25leUFkZGVkRm9yUmVmdW5kKG1zZy5zZW5kZXIsbXNnLnZhbHVlLHRoaXMuYmFsYW5jZSk7DQogICAgICByZXR1cm4gdGhpcy5iYWxhbmNlOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSBGdW5jdGlvbiB0byBhbGxvY2F0ZSB0b2tlbnMgdG8gYW4gdXNlci4NCiAgICAvL0BwYXJhbSBgX3RvYCB0aGUgYWRkcmVzcyBvZiBhbiB1c2VyDQogICAgLy9AcGFyYW0gYF90b2tlbnNgIG51bWJlciBvZiB0b2tlbnMgdG8gYmUgYWxsb2NhdGVkLg0KICAgIC8vQG5vdGljZSBDYW4gYmUgY2FsbGVkIG9ubHkgd2hlbiBmdW5kaW5nIGlzIG5vdCBhY3RpdmUgYW5kIG9ubHkgYnkgdGhlIG93bmVyDQogICAgZnVuY3Rpb24gYWxsb2NhdGVUb2tlbnMoYWRkcmVzcyBfdG8sdWludCBfdG9rZW5zKSBpc05vdEZ1bmRhYmxlIG9ubHlPd25lciBleHRlcm5hbCB7DQogICAgICB1aW50IG51bU9mVG9rZW5zID0gX3Rva2Vucy5tdWwoMWUxOCk7DQogICAgICB0b3RhbFByZXNhbGUgPSB0b3RhbFByZXNhbGUuYWRkKG51bU9mVG9rZW5zKTsNCg0KICAgICAgaWYodG90YWxQcmVzYWxlID4gbWF4UHJlc2FsZVRva2VucykgdGhyb3c7DQoNCiAgICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChudW1PZlRva2Vucyk7DQogICAgfQ0KDQogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHRvIHVuUGF1c2UgdGhlIGNvbnRyYWN0Lg0KICAgIC8vQG5vdGljZSBDYW4gYmUgY2FsbGVkIG9ubHkgd2hlbiBmdW5kaW5nIGlzIGFjdGl2ZSBhbmQgb25seSBieSB0aGUgb3duZXINCiAgICBmdW5jdGlvbiB1blBhdXNlVG9rZW5TYWxlKCkgb25seU93bmVyIGlzTm90RnVuZGFibGUgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCl7DQogICAgICBmdW5kaW5nTW9kZSA9IHRydWU7DQogICAgICByZXR1cm4gZnVuZGluZ01vZGU7DQogICAgfQ0KDQogICAgLy9Abm90aWNlIEZ1bmN0aW9uIHRvIHBhdXNlIHRoZSBjb250cmFjdC4NCiAgICAvL0Bub3RpY2UgQ2FuIGJlIGNhbGxlZCBvbmx5IHdoZW4gZnVuZGluZyBpcyBhY3RpdmUgYW5kIG9ubHkgYnkgdGhlIG93bmVyDQogICAgZnVuY3Rpb24gcGF1c2VUb2tlblNhbGUoKSBvbmx5T3duZXIgaXNGdW5kYWJsZSBleHRlcm5hbCByZXR1cm5zIChib29sKXsNCiAgICAgIGZ1bmRpbmdNb2RlID0gZmFsc2U7DQogICAgICByZXR1cm4gIWZ1bmRpbmdNb2RlOw0KICAgIH0NCg0KICAgIC8vQG5vdGljZSBGdW5jdGlvbiB0byBzdGFydCB0aGUgY29udHJhY3QuDQogICAgLy9AcGFyYW0gYF9mdW5kaW5nU3RhcnRCbG9ja2AgLSBibG9jayBmcm9tIHdoZW4gSUNPIGNvbW1lbmNlcw0KICAgIC8vQHBhcmFtIGBfZnVuZGluZ1N0b3BCbG9ja2AgLSBibG9jayBmcm9tIHdoZW4gSUNPIGVuZHMuDQogICAgLy9Abm90aWNlIENhbiBiZSBjYWxsZWQgb25seSB3aGVuIGZ1bmRpbmcgaXMgbm90IGFjdGl2ZSBhbmQgb25seSBieSB0aGUgb3duZXINCiAgICBmdW5jdGlvbiBzdGFydFRva2VuU2FsZSh1aW50IF9mdW5kaW5nU3RhcnRCbG9jaywgdWludCBfZnVuZGluZ1N0b3BCbG9jaykgb25seU93bmVyIGlzTm90RnVuZGFibGUgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCl7DQogICAgICBpZihfZnVuZGluZ1N0b3BCbG9jayA8PSBfZnVuZGluZ1N0YXJ0QmxvY2spIHRocm93Ow0KDQogICAgICBmdW5kaW5nU3RhcnRCbG9jayA9IF9mdW5kaW5nU3RhcnRCbG9jazsNCiAgICAgIGZ1bmRpbmdTdG9wQmxvY2sgPSBfZnVuZGluZ1N0b3BCbG9jazsNCiAgICAgIGZ1bmRpbmdNb2RlID0gdHJ1ZTsNCiAgICAgIHJldHVybiBmdW5kaW5nTW9kZTsNCiAgICB9DQoNCiAgICAvL0Bub3RpY2UgRnVuY3Rpb24gdG8gZ2V0IHRoZSBjdXJyZW50IGZ1bmRpbmcgc3RhdHVzLg0KICAgIGZ1bmN0aW9uIGZ1bmRpbmdTdGF0dXMoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChib29sKXsNCiAgICAgIHJldHVybiBmdW5kaW5nTW9kZTsNCiAgICB9DQp9'