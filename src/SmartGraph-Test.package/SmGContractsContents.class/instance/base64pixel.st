base 64 content
base64pixel
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3QgUGl4ZWwgew0KICAgIC8qIFRoaXMgY3JlYXRlcyBhbiBhcnJheSB3aXRoIGFsbCBiYWxhbmNlcyAqLw0KICAgIHN0cnVjdCBTZWN0aW9uIHsNCiAgICAgICAgYWRkcmVzcyBvd25lcjsNCiAgICAgICAgdWludDI1NiBwcmljZTsNCiAgICAgICAgYm9vbCBmb3Jfc2FsZTsNCiAgICAgICAgYm9vbCBpbml0aWFsX3B1cmNoYXNlX2RvbmU7DQogICAgICAgIHVpbnQgaW1hZ2VfaWQ7DQogICAgICAgIHN0cmluZyBtZDU7DQogICAgICAgIHVpbnQgbGFzdF91cGRhdGU7DQogICAgICAgIGFkZHJlc3Mgc2VsbF9vbmx5X3RvOw0KICAgICAgICB1aW50MTYgaW5kZXg7DQogICAgICAgIC8vYnl0ZXMzMlsxMF0gaW1hZ2VfZGF0YTsNCiAgICB9DQogICAgc3RyaW5nIHB1YmxpYyBzdGFuZGFyZCA9ICJJUE8gMC45IjsNCiAgICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiSW5pdGlhbCBQaXhlbCBPZmZlcmluZyI7DQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiSVBPIjsNCiAgICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAwOw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VPZjsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBldGhCYWxhbmNlOw0KICAgIGFkZHJlc3Mgb3duZXI7DQogICAgdWludDI1NiBwdWJsaWMgaXBvX3ByaWNlOw0KICAgIFNlY3Rpb25bMTAwMDBdIHB1YmxpYyBzZWN0aW9uczsNCiAgICB1aW50MjU2IHB1YmxpYyBwb29sOw0KICAgIHVpbnQgcHVibGljIG1hcFdpZHRoOw0KICAgIHVpbnQgcHVibGljIG1hcEhlaWdodDsNCiAgICB1aW50MjU2IHRva2VuVG90YWxTdXBwbHkgPSAxMDAwMDsNCg0KICAgIGV2ZW50IEJ1eSh1aW50IHNlY3Rpb25faWQpOw0KICAgIGV2ZW50IE5ld0xpc3RpbmcodWludCBzZWN0aW9uX2lkLCB1aW50IHByaWNlKTsNCiAgICBldmVudCBEZWxpc3RlZCh1aW50IHNlY3Rpb25faWQpOw0KICAgIGV2ZW50IE5ld0ltYWdlKHVpbnQgc2VjdGlvbl9pZCk7DQogICAgZXZlbnQgQXJlYVByaWNlKHVpbnQgc3RhcnRfc2VjdGlvbl9pbmRleCwgdWludCBlbmRfc2VjdGlvbl9pbmRleCwgdWludCBhcmVhX3ByaWNlKTsNCiAgICBldmVudCBTZW50VmFsdWUodWludCB2YWx1ZSk7DQogICAgZXZlbnQgUHJpY2VVcGRhdGUodWludDI1NiBwcmljZSk7DQogICAgZXZlbnQgV2l0aGRyYXdFdmVudChzdHJpbmcgbXNnKTsNCg0KICAgIGZ1bmN0aW9uIFBpeGVsKCkgew0KICAgICAgICBwb29sID0gdG9rZW5Ub3RhbFN1cHBseTsgLy9OdW1iZXIgb2YgdG9rZW4gLyBzcGFjZXMNCiAgICAgICAgaXBvX3ByaWNlID0gMTAwMDAwMDAwMDAwMDAwMDAwOyAvLyAwLjENCiAgICAgICAgbWFwV2lkdGggPSAxMDAwOw0KICAgICAgICBtYXBIZWlnaHQgPSAxMDAwOw0KICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHRvdGFsU3VwcGx5KQ0KICAgIHsNCiAgICAgICAgdG90YWxTdXBwbHkgPSB0b2tlblRvdGFsU3VwcGx5Ow0KICAgIH0NCg0KICAgIC8vLyBVcGRhdGVzIGEgcGl4ZWwgc2VjdGlvbidzIGluZGV4IG51bWJlcg0KICAgIC8vLyBOb3QgdG8gYmUgY2FsbGVkIGJ5IGFueW9uZSBidXQgdGhlIGNvbnRyYWN0IG93bmVyDQogICAgZnVuY3Rpb24gdXBkYXRlUGl4ZWxJbmRleCgNCiAgICAgICAgdWludDE2IF9zdGFydCwNCiAgICAgICAgdWludDE2IF9lbmQNCiAgICApIHsNCiAgICAgICAgaWYobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7IA0KICAgICAgICBpZihfZW5kIDwgX3N0YXJ0KSB0aHJvdzsNCiAgICAgICAgd2hpbGUoX3N0YXJ0IDwgX2VuZCkNCiAgICAgICAgew0KICAgICAgICAgICAgc2VjdGlvbnNbX3N0YXJ0XS5pbmRleCA9IF9zdGFydDsNCiAgICAgICAgICAgIF9zdGFydCsrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8vIFVwZGF0ZSB0aGUgY3VycmVudCBJUE8gcHJpY2UNCiAgICBmdW5jdGlvbiB1cGRhdGVJUE9QcmljZSgNCiAgICAgICAgdWludDI1NiBfbmV3X3ByaWNlDQogICAgKSB7DQogICAgICAgIGlmKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93Ow0KICAgICAgICBpcG9fcHJpY2UgPSBfbmV3X3ByaWNlOw0KICAgICAgICBQcmljZVVwZGF0ZShpcG9fcHJpY2UpOw0KICAgIH0NCg0KICAgIC8qIEdldCB0aGUgaW5kZXggdG8gYWNjZXNzIGEgc2VjdGlvbiBvYmplY3QgZnJvbSB0aGUgcHJvdmlkZWQgcmF3IHgseSAqLw0KICAgIC8vLyBDb252ZXJ0IGZyb20gYSBwaXhlbCdzIHgsIHkgY29vcmRpbmF0ZXMgdG8gaXRzIHNlY3Rpb24gaW5kZXgNCiAgICAvLy8gVGhpcyBpcyBhIGhlbHBlciBmdW5jdGlvbg0KICAgIGZ1bmN0aW9uIGdldFNlY3Rpb25JbmRleEZyb21SYXcoDQogICAgICAgIHVpbnQgX3gsDQogICAgICAgIHVpbnQgX3kNCiAgICApIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgaWYgKF94ID49IG1hcFdpZHRoKSB0aHJvdzsNCiAgICAgICAgaWYgKF95ID49IG1hcEhlaWdodCkgdGhyb3c7DQogICAgICAgIC8vIENvbnZlcnQgcmF3IHgsIHkgdG8gc2VjdGlvbiBpZGVudGlmZXIgeCB5DQogICAgICAgIF94ID0gX3ggLyAxMDsNCiAgICAgICAgX3kgPSBfeSAvIDEwOw0KICAgICAgICAvL0dldCBzZWN0aW9uX2lkZW50aWZpZXIgZnJvbSBjb29yZHMNCiAgICAgICAgcmV0dXJuIF94ICsgKF95ICogMTAwKTsNCiAgICB9DQoNCiAgICAvKiBHZXQgdGhlIGluZGV4IHRvIGFjY2VzcyBhIHNlY3Rpb24gb2JqZWN0IGZyb20gaXRzIHNlY3Rpb24gaWRlbnRpZmllciAqLw0KICAgIC8vLyBHZXQgU2VjdGlvbiBpbmRleCBiYXNlZCBvbiBpdHMgdXBwZXIgbGVmdCB4LHkgY29vcmRpbmF0ZXMgb3IgImlkZW50aWZpZXIiDQogICAgLy8vIGNvb3JkaW5hdGVzDQogICAgLy8vIFRoaXMgaXMgYSBoZWxwZXIgZnVuY3Rpb24NCiAgICBmdW5jdGlvbiBnZXRTZWN0aW9uSW5kZXhGcm9tSWRlbnRpZmllciAoDQogICAgICAgIHVpbnQgX3hfc2VjdGlvbl9pZGVudGlmaWVyLA0KICAgICAgICB1aW50IF95X3NlY3Rpb25faWRlbnRpZmllcg0KICAgICkgcmV0dXJucyAodWludCkgew0KICAgICAgICBpZiAoX3hfc2VjdGlvbl9pZGVudGlmaWVyID49IChtYXBXaWR0aCAvIDEwKSkgdGhyb3c7DQogICAgICAgIGlmIChfeV9zZWN0aW9uX2lkZW50aWZpZXIgPj0gKG1hcEhlaWdodCAvIDEwKSkgdGhyb3c7DQogICAgICAgIHVpbnQgaW5kZXggPSBfeF9zZWN0aW9uX2lkZW50aWZpZXIgKyAoX3lfc2VjdGlvbl9pZGVudGlmaWVyICogMTAwKTsNCiAgICAgICAgcmV0dXJuIGluZGV4Ow0KICAgIH0NCg0KICAgIC8qIEdldCB4LHkgc2VjdGlvbl9pZGVudGlmaWVyIGZyb20gYSBzZWN0aW9uIGluZGV4ICovDQogICAgLy8vIEdldCBTZWN0aW9uIHVwcGVyIGxlZnQgeCx5IGNvb3JkaW5hdGVzIG9yICJpZGVudGlmaWVyIiBjb29yZGluYXRlcw0KICAgIC8vLyBiYXNlZCBvbiBpdHMgaW5kZXggbnVtYmVyDQogICAgLy8vIFRoaXMgaXMgYSBoZWxwZXIgZnVuY3Rpb24NCiAgICBmdW5jdGlvbiBnZXRJZGVudGlmaWVyRnJvbVNlY3Rpb25JbmRleCgNCiAgICAgICAgdWludCBfaW5kZXgNCiAgICApIHJldHVybnMgKHVpbnQgeCwgdWludCB5KSB7DQogICAgICAgIGlmIChfaW5kZXggPiAobWFwV2lkdGggKiBtYXBIZWlnaHQpKSB0aHJvdzsNCiAgICAgICAgeCA9IF9pbmRleCAlIDEwMDsNCiAgICAgICAgeSA9IChfaW5kZXggLSAoX2luZGV4ICUgMTAwKSkgLyAxMDA7DQogICAgfQ0KDQogICAgLyogQ2hlY2sgdG8gc2VlIGlmIFNlY3Rpb24gaXMgYXZhaWxhYmxlIGZvciBmaXJzdCBwdXJjaGFzZSAqLw0KICAgIC8vLyBSZXR1cm5zIHdoZXRoZXIgYSBzZWN0aW9uIGlzIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UgYXQgSVBPIHByaWNlDQogICAgZnVuY3Rpb24gc2VjdGlvbkF2YWlsYWJsZSgNCiAgICAgICAgdWludCBfc2VjdGlvbl9pbmRleA0KICAgICkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBpZiAoX3NlY3Rpb25faW5kZXggPj0gc2VjdGlvbnMubGVuZ3RoKSB0aHJvdzsNCiAgICAgICAgU2VjdGlvbiBzID0gc2VjdGlvbnNbX3NlY3Rpb25faW5kZXhdOw0KICAgICAgICAvLyBUaGUgc2VjdGlvbiBoYXMgbm90IGJlZW4gcHVjaGFzZWQgcHJldmlvdXNseQ0KICAgICAgICByZXR1cm4gIXMuaW5pdGlhbF9wdXJjaGFzZV9kb25lOw0KICAgIH0NCg0KICAgIC8qIENoZWNrIHRvIHNlZSBpZiBTZWN0aW9uIGlzIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UgKi8NCiAgICAvLy8gUmV0dXJucyB3aGV0aGVyIGEgc2VjdGlvbiBpcyBhdmFpbGFibGUgZm9yIHB1cmNoYXNlIGFzIGEgbWFya2V0IHNhbGUNCiAgICBmdW5jdGlvbiBzZWN0aW9uRm9yU2FsZSgNCiAgICAgICAgdWludCBfc2VjdGlvbl9pbmRleA0KICAgICkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBpZiAoX3NlY3Rpb25faW5kZXggPj0gc2VjdGlvbnMubGVuZ3RoKSB0aHJvdzsNCiAgICAgICAgU2VjdGlvbiBzID0gc2VjdGlvbnNbX3NlY3Rpb25faW5kZXhdOw0KICAgICAgICAvLyBIYXMgdGhlIHVzZXIgc2V0IHRoZSBzZWN0aW9uIGFzIGZvcl9zYWxlDQogICAgICAgIGlmKHMuZm9yX3NhbGUpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIEhhcyB0aGUgb3duZXIgc2V0IGEgInNlbGwgb25seSB0byIgYWRkcmVzcz8NCiAgICAgICAgICAgIGlmKHMuc2VsbF9vbmx5X3RvID09IDB4MCkgcmV0dXJuIHRydWU7DQogICAgICAgICAgICBpZihzLnNlbGxfb25seV90byA9PSBtc2cuc2VuZGVyKSByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIE5vdCBmb3Igc2FsZQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyogR2V0IHRoZSBwcmljZSBvZiB0aGUgU2VjdGlvbiAqLw0KICAgIC8vLyBSZXR1cm5zIHRoZSBwcmljZSBvZiBhIHNlY3Rpb24gYXQgbWFya2V0IHByaWNlLg0KICAgIC8vLyBUaGlzIGlzIGEgaGVscGVyIGZ1bmN0aW9uLCBpdCBpcyBtb3JlIGVmZmljaWVudCB0byBqdXN0IGFjY2VzcyB0aGUNCiAgICAvLy8gY29udHJhY3QncyBzZWN0aW9ucyBhdHRyaWJ1dGUgZGlyZWN0bHkNCiAgICBmdW5jdGlvbiBzZWN0aW9uUHJpY2UoDQogICAgICAgIHVpbnQgX3NlY3Rpb25faW5kZXgNCiAgICApIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgaWYgKF9zZWN0aW9uX2luZGV4ID49IHNlY3Rpb25zLmxlbmd0aCkgdGhyb3c7DQogICAgICAgIFNlY3Rpb24gcyA9IHNlY3Rpb25zW19zZWN0aW9uX2luZGV4XTsNCiAgICAgICAgcmV0dXJuIHMucHJpY2U7DQogICAgfQ0KDQogICAgLyoNCiAgICBDaGVjayB0byBzZWUgaWYgYSByZWdpb24gaXMgYXZhaWxhYmxlIHByb3ZpZGVkIHRoZQ0KICAgIHRvcC1sZWZ0IChzdGFydCkgc2VjdGlvbiBhbmQgdGhlIGJvdHRvbS1yaWdodCAoZW5kKQ0KICAgIHNlY3Rpb24uDQogICAgKi8NCiAgICAvLy8gUmV0dXJucyBpZiBhIHNlY3Rpb24gaXMgYXZhaWxhYmxlIGZvciBwdXJjaGFzZSwgaXQgcmV0dXJucyB0aGUgZm9sbG93aW5nOg0KICAgIC8vLyBib29sOiBpZiB0aGUgcmVnaW9uIGlzIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UNCiAgICAvLy8gdWludDI1NjogdGhlIGV4dGVuZGVkIHByaWNlLCBzdW0gb2YgYWxsIG9mIHRoZSBtYXJrZXQgcHJpY2VzIG9mIHRoZSBzZWN0aW9ucw0KICAgIC8vLyAgIGluIHRoZSByZWdpb24NCiAgICAvLy8gdWludDI1NjogdGhlIG51bWJlciBvZiBzZWN0aW9ucyBhdmFpbGFibGUgaW4gdGhlIHJlZ2lvbiBhdCB0aGUgSVBPIHByaWNlDQogICAgZnVuY3Rpb24gcmVnaW9uQXZhaWxhYmxlKA0KICAgICAgICB1aW50IF9zdGFydF9zZWN0aW9uX2luZGV4LA0KICAgICAgICB1aW50IF9lbmRfc2VjdGlvbl9pbmRleA0KICAgICkgcmV0dXJucyAoYm9vbCBhdmFpbGFibGUsIHVpbnQgZXh0ZW5kZWRfcHJpY2UsIHVpbnQgaXBvX2NvdW50KSB7DQogICAgICAgIGlmIChfZW5kX3NlY3Rpb25faW5kZXggPCBfc3RhcnRfc2VjdGlvbl9pbmRleCkgdGhyb3c7DQogICAgICAgIHZhciAoc3RhcnRfeCwgc3RhcnRfeSkgPSBnZXRJZGVudGlmaWVyRnJvbVNlY3Rpb25JbmRleChfc3RhcnRfc2VjdGlvbl9pbmRleCk7DQogICAgICAgIHZhciAoZW5kX3gsIGVuZF95KSA9IGdldElkZW50aWZpZXJGcm9tU2VjdGlvbkluZGV4KF9lbmRfc2VjdGlvbl9pbmRleCk7DQogICAgICAgIGlmIChzdGFydF94ID49IG1hcFdpZHRoKSB0aHJvdzsNCiAgICAgICAgaWYgKHN0YXJ0X3kgPj0gbWFwSGVpZ2h0KSB0aHJvdzsNCiAgICAgICAgaWYgKGVuZF94ID49IG1hcFdpZHRoKSB0aHJvdzsNCiAgICAgICAgaWYgKGVuZF95ID49IG1hcEhlaWdodCkgdGhyb3c7DQogICAgICAgIHVpbnQgeV9wb3MgPSBzdGFydF95Ow0KICAgICAgICBhdmFpbGFibGUgPSBmYWxzZTsNCiAgICAgICAgZXh0ZW5kZWRfcHJpY2UgPSAwOw0KICAgICAgICBpcG9fY291bnQgPSAwOw0KICAgICAgICB3aGlsZSAoeV9wb3MgPD0gZW5kX3kpDQogICAgICAgIHsNCiAgICAgICAgICAgIHVpbnQgeF9wb3MgPSBzdGFydF94Ow0KICAgICAgICAgICAgd2hpbGUgKHhfcG9zIDw9IGVuZF94KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVpbnQgaWRlbnRpZmllciA9ICh4X3BvcyArICh5X3BvcyAqIDEwMCkpOw0KICAgICAgICAgICAgICAgIC8vIElzIHRoaXMgc2VjdGlvbiBhdmFpbGFibGUgZm9yIGZpcnN0IChJUE8pIHB1cmNoYXNlPw0KICAgICAgICAgICAgICAgIGlmKHNlY3Rpb25BdmFpbGFibGUoaWRlbnRpZmllcikpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2VjdGlvbiBpcyBhdmFpbGFibGUgYXMgYW4gSVBPDQogICAgICAgICAgICAgICAgICAgIGlwb19jb3VudCA9IGlwb19jb3VudCArIDE7DQogICAgICAgICAgICAgICAgfSBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2VjdGlvbiBoYXMgYmVlbiBwdXJjaGFzZWQsIGl0IGNhbiBvbmx5IGJlIGF2YWlsYWJsZQ0KICAgICAgICAgICAgICAgICAgICAvLyBhcyBhIG1hcmtldCBzYWxlLg0KICAgICAgICAgICAgICAgICAgICBpZihzZWN0aW9uRm9yU2FsZShpZGVudGlmaWVyKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5kZWRfcHJpY2UgPSBleHRlbmRlZF9wcmljZSArIHNlY3Rpb25QcmljZShpZGVudGlmaWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy9Eb24ndCByZXR1cm4gYSBwcmljZSBpZiB0aGVyZSBpcyBhbiB1bmF2YWlsYWJsZSBzZWN0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAvL3RvIHJlZHVjZSBjb25mdXNpb24NCiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuZGVkX3ByaWNlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlwb19jb3VudCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgeF9wb3MgPSB4X3BvcyArIDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB5X3BvcyA9IHlfcG9zICsgMTsNCiAgICAgICAgfQ0KICAgICAgICBhdmFpbGFibGUgPSB0cnVlOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8vIEJ1eSBhIHNlY3Rpb24gYmFzZWQgb24gaXRzIGluZGV4IGFuZCBzZXQgaXRzIGNsb3VkIGltYWdlX2lkIGFuZCBtZDUNCiAgICAvLy8gVGhpcyBmdW5jdGlvbiBpcyBwYXlhYmxlLCBhbnkgb3ZlciBwYXltZW50IHdpbGwgYmUgd2l0aGRyYXctYWJsZQ0KICAgIGZ1bmN0aW9uIGJ1eVNlY3Rpb24gKA0KICAgICAgICB1aW50IF9zZWN0aW9uX2luZGV4LA0KICAgICAgICB1aW50IF9pbWFnZV9pZCwNCiAgICAgICAgc3RyaW5nIF9tZDUNCiAgICApIHBheWFibGUgew0KICAgICAgICBpZiAoX3NlY3Rpb25faW5kZXggPj0gc2VjdGlvbnMubGVuZ3RoKSB0aHJvdzsNCiAgICAgICAgU2VjdGlvbiBzZWN0aW9uID0gc2VjdGlvbnNbX3NlY3Rpb25faW5kZXhdOw0KICAgICAgICBpZighc2VjdGlvbi5mb3Jfc2FsZSAmJiBzZWN0aW9uLmluaXRpYWxfcHVyY2hhc2VfZG9uZSkNCiAgICAgICAgew0KICAgICAgICAgICAgLy9TZWN0aW9uIG5vdCBmb3Igc2FsZQ0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgLy8gUHJvY2VzcyBwYXltZW50DQogICAgICAgIC8vIElzIHRoaXMgU2VjdGlvbiBvbiB0aGUgb3BlbiBtYXJrZXQ/DQogICAgICAgIGlmKHNlY3Rpb24uaW5pdGlhbF9wdXJjaGFzZV9kb25lKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBTZWN0aW9uIHNvbGQsIHNlbGwgZm9yIG1hcmtldCBwcmljZQ0KICAgICAgICAgICAgaWYobXNnLnZhbHVlIDwgc2VjdGlvbi5wcmljZSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBOb3QgZW5vdWdoIGZ1bmRzIHdlcmUgc2VudA0KICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgfSBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIEZlZQ0KICAgICAgICAgICAgICAgIC8vIFdlIG9ubHkgbmVlZCB0byBjaGFuZ2UgdGhlIGJhbGFuY2UgaWYgdGhlIHNlY3Rpb24gcHJpY2UgaXMgbm9uLXplcm8NCiAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbi5wcmljZSAhPSAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdWludCBmZWUgPSBzZWN0aW9uLnByaWNlIC8gMTAwOw0KICAgICAgICAgICAgICAgICAgICAvLyBQYXkgY29udHJhY3Qgb3duZXIgdGhlIGZlZQ0KICAgICAgICAgICAgICAgICAgICBldGhCYWxhbmNlW293bmVyXSArPSBmZWU7DQogICAgICAgICAgICAgICAgICAgIC8vIFBheSB0aGUgc2VjdGlvbiBvd25lciB0aGUgcHJpY2UgbWludXMgdGhlIGZlZQ0KICAgICAgICAgICAgICAgICAgICBldGhCYWxhbmNlW3NlY3Rpb24ub3duZXJdICs9IChtc2cudmFsdWUgLSBmZWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyBSZWZ1bmQgYW55IG92ZXJwYXltZW50DQogICAgICAgICAgICAgICAgLy9yZXF1aXJlKG1zZy52YWx1ZSA+IChtc2cudmFsdWUgLSBzZWN0aW9uLnByaWNlKSk7DQogICAgICAgICAgICAgICAgZXRoQmFsYW5jZVttc2cuc2VuZGVyXSArPSAobXNnLnZhbHVlIC0gc2VjdGlvbi5wcmljZSk7DQogICAgICAgICAgICAgICAgLy8gT3duZXIgbG9zZXMgYSB0b2tlbg0KICAgICAgICAgICAgICAgIGJhbGFuY2VPZltzZWN0aW9uLm93bmVyXS0tOw0KICAgICAgICAgICAgICAgIC8vIEJ1eWVyIGdldHMgYSB0b2tlbg0KICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gSW5pdGlhbCBzYWxlLCBzZWxsIGZvciBJUE8gcHJpY2UNCiAgICAgICAgICAgIGlmKG1zZy52YWx1ZSA8IGlwb19wcmljZSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBOb3QgZW5vdWdoIGZ1bmRzIHdlcmUgc2VudA0KICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgfSBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gUGF5IHRoZSBjb250cmFjdCBvd25lcg0KICAgICAgICAgICAgICAgIGV0aEJhbGFuY2Vbb3duZXJdICs9IG1zZy52YWx1ZTsNCiAgICAgICAgICAgICAgICAvLyBSZWZ1bmQgYW55IG92ZXJwYXltZW50DQogICAgICAgICAgICAgICAgLy9yZXF1aXJlKG1zZy52YWx1ZSA+IChtc2cudmFsdWUgLSBpcG9fcHJpY2UpKTsNCiAgICAgICAgICAgICAgICBldGhCYWxhbmNlW21zZy5zZW5kZXJdICs9IChtc2cudmFsdWUgLSBpcG9fcHJpY2UpOw0KICAgICAgICAgICAgICAgIC8vIFJlZHVjZSB0b2tlbiBwb29sDQogICAgICAgICAgICAgICAgcG9vbC0tOw0KICAgICAgICAgICAgICAgIC8vIEJ1eWVyIGdldHMgYSB0b2tlbg0KICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vUGF5bWVudCBhbmQgdG9rZW4gdHJhbnNmZXIgY29tcGxldGUNCiAgICAgICAgLy9UcmFuc2ZlciBvd25lcnNoaXAgYW5kIHNldCBub3QgZm9yIHNhbGUgYnkgZGVmYXVsdA0KICAgICAgICBzZWN0aW9uLm93bmVyID0gbXNnLnNlbmRlcjsNCiAgICAgICAgc2VjdGlvbi5tZDUgPSBfbWQ1Ow0KICAgICAgICBzZWN0aW9uLmltYWdlX2lkID0gX2ltYWdlX2lkOw0KICAgICAgICBzZWN0aW9uLmxhc3RfdXBkYXRlID0gYmxvY2sudGltZXN0YW1wOw0KICAgICAgICBzZWN0aW9uLmZvcl9zYWxlID0gZmFsc2U7DQogICAgICAgIHNlY3Rpb24uaW5pdGlhbF9wdXJjaGFzZV9kb25lID0gdHJ1ZTsgLy8gZXZlbiBpZiBub3QgdGhlIGZpcnN0LCB3ZSBjYW4gcHJldGVuZCBpdCBpcw0KICAgIH0NCg0KICAgIC8qIEJ1eSBhbiBlbnRpcmUgcmVnaW9uICovDQogICAgLy8vIEJ1eSBhIHJlZ2lvbiBvZiBzZWN0aW9ucyBzdGFydGluZyBhbmQgaW5jbHVkaW5nIHRoZSB0b3AgbGVmdCBzZWN0aW9uIGluZGV4DQogICAgLy8vIGVuZGluZyBhdCBhbmQgaW5jbHVkaW5nIHRoZSBib3R0b20gbGVmdCBzZWN0aW9uIGluZGV4LiBBbmQgc2V0IGl0cyBjbG91ZA0KICAgIC8vLyBpbWFnZV9pZCBhbmQgbWQ1LiBUaGlzIGZ1bmN0aW9uIGlzIHBheWFibGUsIGlmIHRoZSB2YWx1ZSBzZW50IGlzIGxlc3MNCiAgICAvLy8gdGhhbiB0aGUgcHJpY2Ugb2YgdGhlIHJlZ2lvbiwgdGhlIGZ1bmN0aW9uIHdpbGwgdGhyb3cuDQogICAgZnVuY3Rpb24gYnV5UmVnaW9uKA0KICAgICAgICB1aW50IF9zdGFydF9zZWN0aW9uX2luZGV4LA0KICAgICAgICB1aW50IF9lbmRfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfaW1hZ2VfaWQsDQogICAgICAgIHN0cmluZyBfbWQ1DQogICAgKSBwYXlhYmxlIHJldHVybnMgKHVpbnQgc3RhcnRfc2VjdGlvbl95LCB1aW50IHN0YXJ0X3NlY3Rpb25feCwNCiAgICB1aW50IGVuZF9zZWN0aW9uX3ksIHVpbnQgZW5kX3NlY3Rpb25feCl7DQogICAgICAgIGlmIChfZW5kX3NlY3Rpb25faW5kZXggPCBfc3RhcnRfc2VjdGlvbl9pbmRleCkgdGhyb3c7DQogICAgICAgIGlmIChfc3RhcnRfc2VjdGlvbl9pbmRleCA+PSBzZWN0aW9ucy5sZW5ndGgpIHRocm93Ow0KICAgICAgICBpZiAoX2VuZF9zZWN0aW9uX2luZGV4ID49IHNlY3Rpb25zLmxlbmd0aCkgdGhyb3c7DQogICAgICAgIC8vIGljb19hbW1vdW50IHJlZmZlcnMgdG8gdGhlIG51bWJlciBvZiBzZWN0aW9ucyB0aGF0IGFyZSBhdmFpbGFibGUNCiAgICAgICAgLy8gYXQgSUNPIHByaWNlDQogICAgICAgIHZhciAoYXZhaWxhYmxlLCBleHRfcHJpY2UsIGljb19hbW91bnQpID0gcmVnaW9uQXZhaWxhYmxlKF9zdGFydF9zZWN0aW9uX2luZGV4LCBfZW5kX3NlY3Rpb25faW5kZXgpOw0KICAgICAgICBpZiAoIWF2YWlsYWJsZSkgdGhyb3c7DQoNCiAgICAgICAgLy8gQ2FsY3VsYXRlIHByaWNlDQogICAgICAgIHVpbnQgYXJlYV9wcmljZSA9ICBpY29fYW1vdW50ICogaXBvX3ByaWNlOw0KICAgICAgICBhcmVhX3ByaWNlID0gYXJlYV9wcmljZSArIGV4dF9wcmljZTsNCiAgICAgICAgQXJlYVByaWNlKF9zdGFydF9zZWN0aW9uX2luZGV4LCBfZW5kX3NlY3Rpb25faW5kZXgsIGFyZWFfcHJpY2UpOw0KICAgICAgICBTZW50VmFsdWUobXNnLnZhbHVlKTsNCiAgICAgICAgaWYgKGFyZWFfcHJpY2UgPiBtc2cudmFsdWUpIHRocm93Ow0KDQogICAgICAgIC8vIGljb19hbW1vdW50IHJlZmZlcnMgdG8gdGhlIGFtb3VudCBpbiB3ZWkgdGhhdCB0aGUgY29udHJhY3Qgb3duZXINCiAgICAgICAgLy8gaXMgb3dlZA0KICAgICAgICBpY29fYW1vdW50ID0gMDsNCiAgICAgICAgLy8gZXh0X3ByaWNlIHJlZmZlcnMgdG8gdGhlIGFtb3VudCBpbiB3ZWkgdGhhdCB0aGUgY29udHJhY3Qgb3duZXIgaXMNCiAgICAgICAgLy8gb3dlZCBpbiBmZWVzIGZyb20gbWFya2V0IHNhbGVzDQogICAgICAgIGV4dF9wcmljZSA9IDA7DQoNCiAgICAgICAgLy8gVXNlciBzZW50IGVub3VnaCBmdW5kcywgbGV0J3MgZ28NCiAgICAgICAgc3RhcnRfc2VjdGlvbl94ID0gX3N0YXJ0X3NlY3Rpb25faW5kZXggJSAxMDA7DQogICAgICAgIGVuZF9zZWN0aW9uX3ggPSBfZW5kX3NlY3Rpb25faW5kZXggJSAxMDA7DQogICAgICAgIHN0YXJ0X3NlY3Rpb25feSA9IF9zdGFydF9zZWN0aW9uX2luZGV4IC0gKF9zdGFydF9zZWN0aW9uX2luZGV4ICUgMTAwKTsNCiAgICAgICAgc3RhcnRfc2VjdGlvbl95ID0gc3RhcnRfc2VjdGlvbl95IC8gMTAwOw0KICAgICAgICBlbmRfc2VjdGlvbl95ID0gX2VuZF9zZWN0aW9uX2luZGV4IC0gKF9lbmRfc2VjdGlvbl9pbmRleCAlIDEwMCk7DQogICAgICAgIGVuZF9zZWN0aW9uX3kgPSBlbmRfc2VjdGlvbl95IC8gMTAwOw0KICAgICAgICB1aW50IHhfcG9zID0gc3RhcnRfc2VjdGlvbl94Ow0KICAgICAgICB3aGlsZSAoeF9wb3MgPD0gZW5kX3NlY3Rpb25feCkNCiAgICAgICAgew0KICAgICAgICAgICAgdWludCB5X3BvcyA9IHN0YXJ0X3NlY3Rpb25feTsNCiAgICAgICAgICAgIHdoaWxlICh5X3BvcyA8PSBlbmRfc2VjdGlvbl95KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIElzIHRoaXMgYW4gSVBPIHNlY3Rpb24/DQogICAgICAgICAgICAgICAgU2VjdGlvbiBzID0gc2VjdGlvbnNbeF9wb3MgKyAoeV9wb3MgKiAxMDApXTsNCiAgICAgICAgICAgICAgICBpZiAocy5pbml0aWFsX3B1cmNoYXNlX2RvbmUpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBTYWxlLCB3ZSBuZWVkIHRvIHRyYW5zZmVyIGJhbGFuY2UNCiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugb25seSBuZWVkIHRvIG1vZGlmeSBiYWxhbmNlcyBpZiB0aGUgc2VjdGlvbidzIHByaWNlDQogICAgICAgICAgICAgICAgICAgIC8vIGlzIG5vbi16ZXJvDQogICAgICAgICAgICAgICAgICAgIGlmKHMucHJpY2UgIT0gMCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGF5IHRoZSBjb250cmFjdCBvd25lciB0aGUgcHJpY2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGV0aEJhbGFuY2Vbb3duZXJdICs9IChzLnByaWNlIC8gMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBheSB0aGUgb3duZXIgdGhlIHByaWNlIG1pbnVzIHRoZSBmZWUNCiAgICAgICAgICAgICAgICAgICAgICAgIGV0aEJhbGFuY2Vbcy5vd25lcl0gKz0gKHMucHJpY2UgLSAocy5wcmljZSAvIDEwMCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vIFJlZnVuZCBhbnkgb3ZlcnBheW1lbnQNCiAgICAgICAgICAgICAgICAgICAgLy9pZihtc2cudmFsdWUgPiAobXNnLnZhbHVlIC0gcy5wcmljZSkpIHRocm93Ow0KICAgICAgICAgICAgICAgICAgICBleHRfcHJpY2UgKz0gcy5wcmljZTsNCiAgICAgICAgICAgICAgICAgICAgLy8gT3duZXIgbG9zZXMgYSB0b2tlbg0KICAgICAgICAgICAgICAgICAgICBiYWxhbmNlT2Zbcy5vd25lcl0tLTsNCiAgICAgICAgICAgICAgICAgICAgLy8gQnV5ZXIgZ2V0cyBhIHRva2VuDQogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSsrOw0KICAgICAgICAgICAgICAgIH0gZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gSVBPIHdlIGdldCB0byBrZWVwIHRoZSB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAvLyBQYXkgdGhlIGNvbnRyYWN0IG93bmVyDQogICAgICAgICAgICAgICAgICAgIGV0aEJhbGFuY2Vbb3duZXJdICs9IGlwb19wcmljZTsNCiAgICAgICAgICAgICAgICAgICAgLy8gUmVmdW5kIGFueSBvdmVycGF5bWVudA0KICAgICAgICAgICAgICAgICAgICAvL2lmKG1zZy52YWx1ZSA+IChtc2cudmFsdWUgLSBpcG9fcHJpY2UpKSB0aHJvdzsNCiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyBEZWNyZWFzZSB0aGUgdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgaWNvX2Ftb3VudCArPSBpcG9fcHJpY2U7DQogICAgICAgICAgICAgICAgICAgIC8vIFJlZHVjZSB0b2tlbiBwb29sDQogICAgICAgICAgICAgICAgICAgIHBvb2wtLTsNCiAgICAgICAgICAgICAgICAgICAgLy8gQnV5ZXIgZ2V0cyBhIHRva2VuDQogICAgICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSsrOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIFBheW1lbnQgYW5kIHRva2VuIHRyYW5zZmVyIGNvbXBsZXRlDQogICAgICAgICAgICAgICAgLy8gVHJhbnNmZXIgb3duZXJzaGlwIGFuZCBzZXQgbm90IGZvciBzYWxlIGJ5IGRlZmF1bHQNCiAgICAgICAgICAgICAgICBzLm93bmVyID0gbXNnLnNlbmRlcjsNCiAgICAgICAgICAgICAgICBzLm1kNSA9IF9tZDU7DQogICAgICAgICAgICAgICAgcy5pbWFnZV9pZCA9IF9pbWFnZV9pZDsNCiAgICAgICAgICAgICAgICAvL3MubGFzdF91cGRhdGUgPSBibG9jay50aW1lc3RhbXA7DQogICAgICAgICAgICAgICAgcy5mb3Jfc2FsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHMuaW5pdGlhbF9wdXJjaGFzZV9kb25lID0gdHJ1ZTsgLy8gZXZlbiBpZiBub3QgdGhlIGZpcnN0LCB3ZSBjYW4gcHJldGVuZCBpdCBpcw0KDQogICAgICAgICAgICAgICAgQnV5KHhfcG9zICsgKHlfcG9zICogMTAwKSk7DQogICAgICAgICAgICAgICAgLy8gRG9uZQ0KICAgICAgICAgICAgICAgIHlfcG9zID0geV9wb3MgKyAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgeF9wb3MgPSB4X3BvcyArIDE7DQogICAgICAgIH0NCiAgICAgICAgZXRoQmFsYW5jZVttc2cuc2VuZGVyXSArPSBtc2cudmFsdWUgLSAoZXh0X3ByaWNlICsgaWNvX2Ftb3VudCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvKiBTZXQgdGhlIGZvciBzYWxlIGZsYWcgYW5kIGEgcHJpY2UgZm9yIGEgc2VjdGlvbiAqLw0KICAgIC8vLyBTZXQgYW4gaW5pZGl2aWR1YWwgc2VjdGlvbiBhcyBmb3Igc2FsZSBhdCB0aGUgcHJvdmlkZWQgcHJpY2UgaW4gd2VpLg0KICAgIC8vLyBUaGUgc2VjdGlvbiB3aWxsIGJlIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UgYnkgYW55IGFkZHJlc3MuDQogICAgZnVuY3Rpb24gc2V0U2VjdGlvbkZvclNhbGUoDQogICAgICAgIHVpbnQgX3NlY3Rpb25faW5kZXgsDQogICAgICAgIHVpbnQyNTYgX3ByaWNlDQogICAgKSB7DQogICAgICAgIGlmIChfc2VjdGlvbl9pbmRleCA+PSBzZWN0aW9ucy5sZW5ndGgpIHRocm93Ow0KICAgICAgICBTZWN0aW9uIHNlY3Rpb24gPSBzZWN0aW9uc1tfc2VjdGlvbl9pbmRleF07DQogICAgICAgIGlmKHNlY3Rpb24ub3duZXIgIT0gbXNnLnNlbmRlcikgdGhyb3c7DQogICAgICAgIHNlY3Rpb24ucHJpY2UgPSBfcHJpY2U7DQogICAgICAgIHNlY3Rpb24uZm9yX3NhbGUgPSB0cnVlOw0KICAgICAgICBzZWN0aW9uLnNlbGxfb25seV90byA9IDB4MDsNCiAgICAgICAgTmV3TGlzdGluZyhfc2VjdGlvbl9pbmRleCwgX3ByaWNlKTsNCiAgICB9DQoNCiAgICAvKiBTZXQgdGhlIGZvciBzYWxlIGZsYWcgYW5kIHByaWNlIGZvciBhIHJlZ2lvbiAqLw0KICAgIC8vLyBTZXQgYSBzZWN0aW9uIHJlZ2lvbiBmb3Igc2FsZSBhdCB0aGUgcHJvdmlkZWQgcHJpY2UgaW4gd2VpLg0KICAgIC8vLyBUaGUgc2VjdGlvbnMgaW4gdGhlIHJlZ2lvbiB3aWxsIGJlIGF2YWlsYWJsZSBmb3IgcHVyY2hhc2UgYnkgYW55IGFkZHJlc3MuDQogICAgZnVuY3Rpb24gc2V0UmVnaW9uRm9yU2FsZSgNCiAgICAgICAgdWludCBfc3RhcnRfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfZW5kX3NlY3Rpb25faW5kZXgsDQogICAgICAgIHVpbnQgX3ByaWNlDQogICAgKSB7DQogICAgICAgIGlmKF9zdGFydF9zZWN0aW9uX2luZGV4ID4gX2VuZF9zZWN0aW9uX2luZGV4KSB0aHJvdzsNCiAgICAgICAgaWYoX2VuZF9zZWN0aW9uX2luZGV4ID4gOTk5OSkgdGhyb3c7DQogICAgICAgIHVpbnQgeF9wb3MgPSBfc3RhcnRfc2VjdGlvbl9pbmRleCAlIDEwMDsNCiAgICAgICAgdWludCBiYXNlX3lfcG9zID0gKF9zdGFydF9zZWN0aW9uX2luZGV4IC0gKF9zdGFydF9zZWN0aW9uX2luZGV4ICUgMTAwKSkgLyAxMDA7DQogICAgICAgIHVpbnQgeF9tYXggPSBfZW5kX3NlY3Rpb25faW5kZXggJSAxMDA7DQogICAgICAgIHVpbnQgeV9tYXggPSAoX2VuZF9zZWN0aW9uX2luZGV4IC0gKF9lbmRfc2VjdGlvbl9pbmRleCAlIDEwMCkpIC8gMTAwOw0KICAgICAgICB3aGlsZSh4X3BvcyA8PSB4X21heCkNCiAgICAgICAgew0KICAgICAgICAgICAgdWludCB5X3BvcyA9IGJhc2VfeV9wb3M7DQogICAgICAgICAgICB3aGlsZSh5X3BvcyA8PSB5X21heCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBTZWN0aW9uIHNlY3Rpb24gPSBzZWN0aW9uc1t4X3BvcyArICh5X3BvcyAqIDEwMCldOw0KICAgICAgICAgICAgICAgIGlmKHNlY3Rpb24ub3duZXIgPT0gbXNnLnNlbmRlcikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHNlY3Rpb24ucHJpY2UgPSBfcHJpY2U7DQogICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uZm9yX3NhbGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnNlbGxfb25seV90byA9IDB4MDsNCiAgICAgICAgICAgICAgICAgICAgTmV3TGlzdGluZyh4X3BvcyArICh5X3BvcyAqIDEwMCksIF9wcmljZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHlfcG9zKys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB4X3BvcysrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyogU2V0IHRoZSBmb3Igc2FsZSBmbGFnIGFuZCBwcmljZSBmb3IgYSByZWdpb24gKi8NCiAgICAvLy8gU2V0IGEgc2VjdGlvbiByZWdpb24gc3RhcnRpbmcgaW4gdGhlIHRvcCBsZWZ0IGF0IHRoZSBzdXBwbGllZCBzdGFydCBzZWN0aW9uDQogICAgLy8vIGluZGV4IHRvIGFuZCBpbmNsdWRpbmcgdGhlIHN1cHBsaWVkIGJvdHRvbSByaWdodCBlbmQgc2VjdGlvbiBpbmRleA0KICAgIC8vLyBmb3Igc2FsZSBhdCB0aGUgcHJvdmlkZWQgcHJpY2UgaW4gd2VpLCB0byB0aGUgcHJvdmlkZWQgYWRkcmVzcy4NCiAgICAvLy8gVGhlIHNlY3Rpb25zIGluIHRoZSByZWdpb24gd2lsbCBiZSBhdmFpbGFibGUgZm9yIHB1cmNoYXNlIG9ubHkgYnkgdGhlDQogICAgLy8vIHByb3ZpZGVkIGFkZHJlc3MuDQogICAgZnVuY3Rpb24gc2V0UmVnaW9uRm9yU2FsZVRvQWRkcmVzcygNCiAgICAgICAgdWludCBfc3RhcnRfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfZW5kX3NlY3Rpb25faW5kZXgsDQogICAgICAgIHVpbnQgX3ByaWNlLA0KICAgICAgICBhZGRyZXNzIF9vbmx5X3NlbGxfdG8NCiAgICApIHsNCiAgICAgICAgaWYoX3N0YXJ0X3NlY3Rpb25faW5kZXggPiBfZW5kX3NlY3Rpb25faW5kZXgpIHRocm93Ow0KICAgICAgICBpZihfZW5kX3NlY3Rpb25faW5kZXggPiA5OTk5KSB0aHJvdzsNCiAgICAgICAgdWludCB4X3BvcyA9IF9zdGFydF9zZWN0aW9uX2luZGV4ICUgMTAwOw0KICAgICAgICB1aW50IGJhc2VfeV9wb3MgPSAoX3N0YXJ0X3NlY3Rpb25faW5kZXggLSAoX3N0YXJ0X3NlY3Rpb25faW5kZXggJSAxMDApKSAvIDEwMDsNCiAgICAgICAgdWludCB4X21heCA9IF9lbmRfc2VjdGlvbl9pbmRleCAlIDEwMDsNCiAgICAgICAgdWludCB5X21heCA9IChfZW5kX3NlY3Rpb25faW5kZXggLSAoX2VuZF9zZWN0aW9uX2luZGV4ICUgMTAwKSkgLyAxMDA7DQogICAgICAgIHdoaWxlKHhfcG9zIDw9IHhfbWF4KQ0KICAgICAgICB7DQogICAgICAgICAgICB1aW50IHlfcG9zID0gYmFzZV95X3BvczsNCiAgICAgICAgICAgIHdoaWxlKHlfcG9zIDw9IHlfbWF4KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFNlY3Rpb24gc2VjdGlvbiA9IHNlY3Rpb25zW3hfcG9zICsgKHlfcG9zICogMTAwKV07DQogICAgICAgICAgICAgICAgaWYoc2VjdGlvbi5vd25lciA9PSBtc2cuc2VuZGVyKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5wcmljZSA9IF9wcmljZTsNCiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5mb3Jfc2FsZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uc2VsbF9vbmx5X3RvID0gX29ubHlfc2VsbF90bzsNCiAgICAgICAgICAgICAgICAgICAgTmV3TGlzdGluZyh4X3BvcyArICh5X3BvcyAqIDEwMCksIF9wcmljZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHlfcG9zKys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB4X3BvcysrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoNCiAgICBTZXQgYW4gZW50aXJlIHJlZ2lvbidzIGNsb3VkIGltYWdlIGRhdGENCiAgICAqLw0KICAgIC8vLyBVcGRhdGUgYSByZWdpb24gb2Ygc2VjdGlvbnMnIGNsb3VkIGltYWdlX2lkIGFuZCBtZDUgdG8gYmUgcmVkcmF3biBvbiB0aGUNCiAgICAvLy8gbWFwIHN0YXJ0aW5nIGF0IHRoZSB0b3AgbGVmdCBzdGFydCBzZWN0aW9uIGluZGV4IHRvIGFuZCBpbmNsdWRpbmcgdGhlDQogICAgLy8vIGJvdHRvbSByaWdodCBzZWN0aW9uIGluZGV4LiBGaXJlcyBhIE5ld0ltYWdlIGV2ZW50IHdpdGggdGhlIHRvcCBsZWZ0DQogICAgLy8vIHNlY3Rpb24gaW5kZXguIElmIGFueSBzZWN0aW9ucyBub3Qgb3duZWQgYnkgdGhlIHNlbmRlciBhcmUgaW4gdGhlIHJlZ2lvbg0KICAgIC8vLyB0aGV5IGFyZSBpZ25vcmVkLg0KICAgIGZ1bmN0aW9uIHNldFJlZ2lvbkltYWdlRGF0YUNsb3VkKA0KICAgICAgICB1aW50IF9zdGFydF9zZWN0aW9uX2luZGV4LA0KICAgICAgICB1aW50IF9lbmRfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfaW1hZ2VfaWQsDQogICAgICAgIHN0cmluZyBfbWQ1DQogICAgKSB7DQogICAgICAgIGlmIChfZW5kX3NlY3Rpb25faW5kZXggPCBfc3RhcnRfc2VjdGlvbl9pbmRleCkgdGhyb3c7DQogICAgICAgIHZhciAoc3RhcnRfeCwgc3RhcnRfeSkgPSBnZXRJZGVudGlmaWVyRnJvbVNlY3Rpb25JbmRleChfc3RhcnRfc2VjdGlvbl9pbmRleCk7DQogICAgICAgIHZhciAoZW5kX3gsIGVuZF95KSA9IGdldElkZW50aWZpZXJGcm9tU2VjdGlvbkluZGV4KF9lbmRfc2VjdGlvbl9pbmRleCk7DQogICAgICAgIGlmIChzdGFydF94ID49IG1hcFdpZHRoKSB0aHJvdzsNCiAgICAgICAgaWYgKHN0YXJ0X3kgPj0gbWFwSGVpZ2h0KSB0aHJvdzsNCiAgICAgICAgaWYgKGVuZF94ID49IG1hcFdpZHRoKSB0aHJvdzsNCiAgICAgICAgaWYgKGVuZF95ID49IG1hcEhlaWdodCkgdGhyb3c7DQogICAgICAgIHVpbnQgeV9wb3MgPSBzdGFydF95Ow0KICAgICAgICB3aGlsZSAoeV9wb3MgPD0gZW5kX3kpDQogICAgICAgIHsNCiAgICAgICAgICAgIHVpbnQgeF9wb3MgPSBzdGFydF94Ow0KICAgICAgICAgICAgd2hpbGUgKHhfcG9zIDw9IGVuZF94KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVpbnQgaWRlbnRpZmllciA9ICh4X3BvcyArICh5X3BvcyAqIDEwMCkpOw0KICAgICAgICAgICAgICAgIFNlY3Rpb24gcyA9IHNlY3Rpb25zW2lkZW50aWZpZXJdOw0KICAgICAgICAgICAgICAgIGlmKHMub3duZXIgPT0gbXNnLnNlbmRlcikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHMuaW1hZ2VfaWQgPSBfaW1hZ2VfaWQ7DQogICAgICAgICAgICAgICAgICAgIHMubWQ1ID0gX21kNTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgeF9wb3MgPSB4X3BvcyArIDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB5X3BvcyA9IHlfcG9zICsgMTsNCiAgICAgICAgfQ0KICAgICAgICBOZXdJbWFnZShfc3RhcnRfc2VjdGlvbl9pbmRleCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvKiBTZXQgdGhlIGZvciBzYWxlIGZsYWcgYW5kIGEgcHJpY2UgZm9yIGEgc2VjdGlvbiB0byBhIHNwZWNpZmljIGFkZHJlc3MgKi8NCiAgICAvLy8gU2V0IGEgc2luZ2xlIHNlY3Rpb24gYXMgZm9yIHNhbGUgYXQgdGhlIHByb3ZpZGVkIHByaWNlIGluIHdlaSBvbmx5DQogICAgLy8vIHRvIHRoZSBzdXBwbGllZCBhZGRyZXNzLg0KICAgIGZ1bmN0aW9uIHNldFNlY3Rpb25Gb3JTYWxlVG9BZGRyZXNzKA0KICAgICAgICB1aW50IF9zZWN0aW9uX2luZGV4LA0KICAgICAgICB1aW50MjU2IF9wcmljZSwNCiAgICAgICAgYWRkcmVzcyBfdG8NCiAgICApIHsNCiAgICAgICAgaWYgKF9zZWN0aW9uX2luZGV4ID49IHNlY3Rpb25zLmxlbmd0aCkgdGhyb3c7DQogICAgICAgIFNlY3Rpb24gc2VjdGlvbiA9IHNlY3Rpb25zW19zZWN0aW9uX2luZGV4XTsNCiAgICAgICAgaWYoc2VjdGlvbi5vd25lciAhPSBtc2cuc2VuZGVyKSB0aHJvdzsNCiAgICAgICAgc2VjdGlvbi5wcmljZSA9IF9wcmljZTsNCiAgICAgICAgc2VjdGlvbi5mb3Jfc2FsZSA9IHRydWU7DQogICAgICAgIHNlY3Rpb24uc2VsbF9vbmx5X3RvID0gX3RvOw0KICAgICAgICBOZXdMaXN0aW5nKF9zZWN0aW9uX2luZGV4LCBfcHJpY2UpOw0KICAgIH0NCg0KICAgIC8qIFJlbW92ZSB0aGUgZm9yIHNhbGUgZmxhZyBmcm9tIGEgc2VjdGlvbiAqLw0KICAgIC8vLyBEZWxpc3QgYSBzZWN0aW9uIGZvciBzYWxlLiBNYWtpbmcgaXQgbm8gbG9uZ2VyIGF2YWlsYWJsZSBvbiB0aGUgbWFya2V0Lg0KICAgIGZ1bmN0aW9uIHVuc2V0U2VjdGlvbkZvclNhbGUoDQogICAgICAgIHVpbnQgX3NlY3Rpb25faW5kZXgNCiAgICApIHsNCiAgICAgICAgaWYgKF9zZWN0aW9uX2luZGV4ID49IHNlY3Rpb25zLmxlbmd0aCkgdGhyb3c7DQogICAgICAgIFNlY3Rpb24gc2VjdGlvbiA9IHNlY3Rpb25zW19zZWN0aW9uX2luZGV4XTsNCiAgICAgICAgaWYoc2VjdGlvbi5vd25lciAhPSBtc2cuc2VuZGVyKSB0aHJvdzsNCiAgICAgICAgc2VjdGlvbi5mb3Jfc2FsZSA9IGZhbHNlOw0KICAgICAgICBzZWN0aW9uLnByaWNlID0gMDsNCiAgICAgICAgc2VjdGlvbi5zZWxsX29ubHlfdG8gPSAweDA7DQogICAgICAgIERlbGlzdGVkKF9zZWN0aW9uX2luZGV4KTsNCiAgICB9DQoNCiAgICAvKiBTZXQgdGhlIGZvciBzYWxlIGZsYWcgYW5kIHByaWNlIGZvciBhIHJlZ2lvbiAqLw0KICAgIC8vLyBEZWxpc3QgYSByZWdpb24gb2Ygc2VjdGlvbnMgZm9yIHNhbGUuIE1ha2luZyB0aGUgc2VjdGlvbnMgbm8gbG9uZ2VyDQogICAgLy8vIG5vIGxvbmdlciBhdmFpbGFibGUgb24gdGhlIG1hcmtldC4NCiAgICBmdW5jdGlvbiB1bnNldFJlZ2lvbkZvclNhbGUoDQogICAgICAgIHVpbnQgX3N0YXJ0X3NlY3Rpb25faW5kZXgsDQogICAgICAgIHVpbnQgX2VuZF9zZWN0aW9uX2luZGV4DQogICAgKSB7DQogICAgICAgIGlmKF9zdGFydF9zZWN0aW9uX2luZGV4ID4gX2VuZF9zZWN0aW9uX2luZGV4KSB0aHJvdzsNCiAgICAgICAgaWYoX2VuZF9zZWN0aW9uX2luZGV4ID4gOTk5OSkgdGhyb3c7DQogICAgICAgIHVpbnQgeF9wb3MgPSBfc3RhcnRfc2VjdGlvbl9pbmRleCAlIDEwMDsNCiAgICAgICAgdWludCBiYXNlX3lfcG9zID0gKF9zdGFydF9zZWN0aW9uX2luZGV4IC0gKF9zdGFydF9zZWN0aW9uX2luZGV4ICUgMTAwKSkgLyAxMDA7DQogICAgICAgIHVpbnQgeF9tYXggPSBfZW5kX3NlY3Rpb25faW5kZXggJSAxMDA7DQogICAgICAgIHVpbnQgeV9tYXggPSAoX2VuZF9zZWN0aW9uX2luZGV4IC0gKF9lbmRfc2VjdGlvbl9pbmRleCAlIDEwMCkpIC8gMTAwOw0KICAgICAgICB3aGlsZSh4X3BvcyA8PSB4X21heCkNCiAgICAgICAgew0KICAgICAgICAgICAgdWludCB5X3BvcyA9IGJhc2VfeV9wb3M7DQogICAgICAgICAgICB3aGlsZSh5X3BvcyA8PSB5X21heCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBTZWN0aW9uIHNlY3Rpb24gPSBzZWN0aW9uc1t4X3BvcyArICh5X3BvcyAqIDEwMCldOw0KICAgICAgICAgICAgICAgIGlmKHNlY3Rpb24ub3duZXIgPT0gbXNnLnNlbmRlcikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uZm9yX3NhbGUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5wcmljZSA9IDA7DQogICAgICAgICAgICAgICAgICAgIERlbGlzdGVkKHhfcG9zICsgKHlfcG9zICogMTAwKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHlfcG9zKys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB4X3BvcysrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8vIERlcHJlY2lhdGVkLiBTdG9yZSB0aGUgcmF3IGltYWdlIGRhdGEgaW4gdGhlIGNvbnRyYWN0Lg0KICAgIGZ1bmN0aW9uIHNldEltYWdlRGF0YSgNCiAgICAgICAgdWludCBfc2VjdGlvbl9pbmRleA0KICAgICAgICAvLyBieXRlczMyIF9yb3dfemVybywNCiAgICAgICAgLy8gYnl0ZXMzMiBfcm93X29uZSwNCiAgICAgICAgLy8gYnl0ZXMzMiBfcm93X3R3bywNCiAgICAgICAgLy8gYnl0ZXMzMiBfcm93X3RocmVlLA0KICAgICAgICAvLyBieXRlczMyIF9yb3dfZm91ciwNCiAgICAgICAgLy8gYnl0ZXMzMiBfcm93X2ZpdmUsDQogICAgICAgIC8vIGJ5dGVzMzIgX3Jvd19zaXgsDQogICAgICAgIC8vIGJ5dGVzMzIgX3Jvd19zZXZlbiwNCiAgICAgICAgLy8gYnl0ZXMzMiBfcm93X2VpZ2h0LA0KICAgICAgICAvLyBieXRlczMyIF9yb3dfbmluZQ0KICAgICkgew0KICAgICAgICBpZiAoX3NlY3Rpb25faW5kZXggPj0gc2VjdGlvbnMubGVuZ3RoKSB0aHJvdzsNCiAgICAgICAgU2VjdGlvbiBzZWN0aW9uID0gc2VjdGlvbnNbX3NlY3Rpb25faW5kZXhdOw0KICAgICAgICBpZihzZWN0aW9uLm93bmVyICE9IG1zZy5zZW5kZXIpIHRocm93Ow0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbMF0gPSBfcm93X3plcm87DQogICAgICAgIC8vIHNlY3Rpb24uaW1hZ2VfZGF0YVsxXSA9IF9yb3dfb25lOw0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbMl0gPSBfcm93X3R3bzsNCiAgICAgICAgLy8gc2VjdGlvbi5pbWFnZV9kYXRhWzNdID0gX3Jvd190aHJlZTsNCiAgICAgICAgLy8gc2VjdGlvbi5pbWFnZV9kYXRhWzRdID0gX3Jvd19mb3VyOw0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbNV0gPSBfcm93X2ZpdmU7DQogICAgICAgIC8vIHNlY3Rpb24uaW1hZ2VfZGF0YVs2XSA9IF9yb3dfc2l4Ow0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbN10gPSBfcm93X3NldmVuOw0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbOF0gPSBfcm93X2VpZ2h0Ow0KICAgICAgICAvLyBzZWN0aW9uLmltYWdlX2RhdGFbOV0gPSBfcm93X25pbmU7DQogICAgICAgIHNlY3Rpb24uaW1hZ2VfaWQgPSAwOw0KICAgICAgICBzZWN0aW9uLm1kNSA9ICIiOw0KICAgICAgICBzZWN0aW9uLmxhc3RfdXBkYXRlID0gYmxvY2sudGltZXN0YW1wOw0KICAgICAgICBOZXdJbWFnZShfc2VjdGlvbl9pbmRleCk7DQogICAgfQ0KDQogICAgLy8vIFNldCBhIHNlY3Rpb24ncyBpbWFnZSBkYXRhIHRvIGJlIHJlZHJhd24gb24gdGhlIG1hcC4gRmlyZXMgYSBOZXdJbWFnZQ0KICAgIC8vLyBldmVudC4NCiAgICBmdW5jdGlvbiBzZXRJbWFnZURhdGFDbG91ZCgNCiAgICAgICAgdWludCBfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfaW1hZ2VfaWQsDQogICAgICAgIHN0cmluZyBfbWQ1DQogICAgKSB7DQogICAgICAgIGlmIChfc2VjdGlvbl9pbmRleCA+PSBzZWN0aW9ucy5sZW5ndGgpIHRocm93Ow0KICAgICAgICBTZWN0aW9uIHNlY3Rpb24gPSBzZWN0aW9uc1tfc2VjdGlvbl9pbmRleF07DQogICAgICAgIGlmKHNlY3Rpb24ub3duZXIgIT0gbXNnLnNlbmRlcikgdGhyb3c7DQogICAgICAgIHNlY3Rpb24uaW1hZ2VfaWQgPSBfaW1hZ2VfaWQ7DQogICAgICAgIHNlY3Rpb24ubWQ1ID0gX21kNTsNCiAgICAgICAgc2VjdGlvbi5sYXN0X3VwZGF0ZSA9IGJsb2NrLnRpbWVzdGFtcDsNCiAgICAgICAgTmV3SW1hZ2UoX3NlY3Rpb25faW5kZXgpOw0KICAgIH0NCg0KICAgIC8vLyBXaXRoZHJhdyBldGhlcmV1bSBmcm9tIHRoZSBzZW5kZXIncyBldGhCYWxhbmNlLg0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3KCkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICB2YXIgYW1vdW50ID0gZXRoQmFsYW5jZVttc2cuc2VuZGVyXTsNCiAgICAgICAgaWYgKGFtb3VudCA+IDApIHsNCiAgICAgICAgICAgIC8vIEl0IGlzIGltcG9ydGFudCB0byBzZXQgdGhpcyB0byB6ZXJvIGJlY2F1c2UgdGhlIHJlY2lwaWVudA0KICAgICAgICAgICAgLy8gY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiBhZ2FpbiBhcyBwYXJ0IG9mIHRoZSByZWNlaXZpbmcgY2FsbA0KICAgICAgICAgICAgLy8gYmVmb3JlIGBzZW5kYCByZXR1cm5zLg0KICAgICAgICAgICAgZXRoQmFsYW5jZVttc2cuc2VuZGVyXSA9IDA7DQogICAgICAgICAgICBXaXRoZHJhd0V2ZW50KCJSZXNldCBTZW5kZXIiKTsNCiAgICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYW1vdW50KTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLy8gRGVwb3NpdCBldGhlcmV1bSBpbnRvIHRoZSBzZW5kZXIncyBldGhCYWxhbmNlLiBOb3QgcmVjb21tZW5kZWQuDQogICAgZnVuY3Rpb24gZGVwb3NpdCgpIHBheWFibGUNCiAgICB7DQogICAgICAgIGV0aEJhbGFuY2VbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlOw0KICAgIH0NCg0KICAgIC8vLyBUcmFuc2ZlciBhIHNlY3Rpb24gYW5kIGFuIElQTyB0b2tlbiB0byB0aGUgc3VwcGxpZWQgYWRkcmVzcy4NCiAgICBmdW5jdGlvbiB0cmFuc2ZlcigNCiAgICAgIGFkZHJlc3MgX3RvLA0KICAgICAgdWludCBfc2VjdGlvbl9pbmRleA0KICAgICkgew0KICAgICAgICBpZiAoX3NlY3Rpb25faW5kZXggPiA5OTk5KSB0aHJvdzsNCiAgICAgICAgaWYgKHNlY3Rpb25zW19zZWN0aW9uX2luZGV4XS5vd25lciAhPSBtc2cuc2VuZGVyKSB0aHJvdzsNCiAgICAgICAgaWYgKGJhbGFuY2VPZltfdG9dICsgMSA8IGJhbGFuY2VPZltfdG9dKSB0aHJvdzsNCiAgICAgICAgc2VjdGlvbnNbX3NlY3Rpb25faW5kZXhdLm93bmVyID0gX3RvOw0KICAgICAgICBzZWN0aW9uc1tfc2VjdGlvbl9pbmRleF0uZm9yX3NhbGUgPSBmYWxzZTsNCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdIC09IDE7DQogICAgICAgIGJhbGFuY2VPZltfdG9dICs9IDE7DQogICAgfQ0KDQoNCg0KICAgIC8vLyBUcmFuc2ZlciBhIHJlZ2lvbiBvZiBzZWN0aW9ucyBhbmQgSVBPIHRva2VucyB0byB0aGUgc3VwcGxpZWQgYWRkcmVzcy4NCiAgICBmdW5jdGlvbiB0cmFuc2ZlclJlZ2lvbigNCiAgICAgICAgdWludCBfc3RhcnRfc2VjdGlvbl9pbmRleCwNCiAgICAgICAgdWludCBfZW5kX3NlY3Rpb25faW5kZXgsDQogICAgICAgIGFkZHJlc3MgX3RvDQogICAgKSB7DQogICAgICAgIGlmKF9zdGFydF9zZWN0aW9uX2luZGV4ID4gX2VuZF9zZWN0aW9uX2luZGV4KSB0aHJvdzsNCiAgICAgICAgaWYoX2VuZF9zZWN0aW9uX2luZGV4ID4gOTk5OSkgdGhyb3c7DQogICAgICAgIHVpbnQgeF9wb3MgPSBfc3RhcnRfc2VjdGlvbl9pbmRleCAlIDEwMDsNCiAgICAgICAgdWludCBiYXNlX3lfcG9zID0gKF9zdGFydF9zZWN0aW9uX2luZGV4IC0gKF9zdGFydF9zZWN0aW9uX2luZGV4ICUgMTAwKSkgLyAxMDA7DQogICAgICAgIHVpbnQgeF9tYXggPSBfZW5kX3NlY3Rpb25faW5kZXggJSAxMDA7DQogICAgICAgIHVpbnQgeV9tYXggPSAoX2VuZF9zZWN0aW9uX2luZGV4IC0gKF9lbmRfc2VjdGlvbl9pbmRleCAlIDEwMCkpIC8gMTAwOw0KICAgICAgICB3aGlsZSh4X3BvcyA8PSB4X21heCkNCiAgICAgICAgew0KICAgICAgICAgICAgdWludCB5X3BvcyA9IGJhc2VfeV9wb3M7DQogICAgICAgICAgICB3aGlsZSh5X3BvcyA8PSB5X21heCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBTZWN0aW9uIHNlY3Rpb24gPSBzZWN0aW9uc1t4X3BvcyArICh5X3BvcyAqIDEwMCldOw0KICAgICAgICAgICAgICAgIGlmKHNlY3Rpb24ub3duZXIgPT0gbXNnLnNlbmRlcikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICBpZiAoYmFsYW5jZU9mW190b10gKyAxIDwgYmFsYW5jZU9mW190b10pIHRocm93Ow0KICAgICAgICAgICAgICAgICAgc2VjdGlvbi5vd25lciA9IF90bzsNCiAgICAgICAgICAgICAgICAgIHNlY3Rpb24uZm9yX3NhbGUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSAxOw0KICAgICAgICAgICAgICAgICAgYmFsYW5jZU9mW190b10gKz0gMTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgeV9wb3MrKzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHhfcG9zKys7DQogICAgICAgIH0NCiAgICB9DQp9'