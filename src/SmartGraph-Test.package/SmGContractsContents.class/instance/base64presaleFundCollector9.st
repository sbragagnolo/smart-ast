base 64 content
base64presaleFundCollector9
	^'LyoNCiAqIEVSQzIwIGludGVyZmFjZQ0KICogc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KICovDQpjb250cmFjdCBFUkMyMCB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCg0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQoNCi8qKg0KICogU2FmZSB1bnNpZ25lZCBzYWZlIG1hdGguDQogKg0KICogaHR0cHM6Ly9ibG9nLmFyYWdvbi5vbmUvbGlicmFyeS1kcml2ZW4tZGV2ZWxvcG1lbnQtaW4tc29saWRpdHktMmJlYmNhZjg4NzM2Iy43NTBnd3R3bGkNCiAqDQogKiBPcmlnaW5hbGx5IGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0FyYWdvbk9uZS96ZXBwZWxpbi1zb2xpZGl0eS9tYXN0ZXIvY29udHJhY3RzL1NhZmVNYXRoTGliLnNvbA0KICoNCiAqIE1haW50YWluZWQgaGVyZSB1bnRpbCBtZXJnZWQgdG8gbWFpbmxpbmUgemVwcGVsaW4tc29saWRpdHkuDQogKg0KICovDQpsaWJyYXJ5IFNhZmVNYXRoTGliIHsNCg0KICBmdW5jdGlvbiB0aW1lcyh1aW50IGEsIHVpbnQgYikgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtaW51cyh1aW50IGEsIHVpbnQgYikgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIHBsdXModWludCBhLCB1aW50IGIpIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgcHJpdmF0ZSB7DQogICAgaWYgKCFhc3NlcnRpb24pIHRocm93Ow0KICB9DQp9DQoNCg0KDQoNCi8qDQogKiBPd25hYmxlDQogKg0KICogQmFzZSBjb250cmFjdCB3aXRoIGFuIG93bmVyLg0KICogUHJvdmlkZXMgb25seU93bmVyIG1vZGlmaWVyLCB3aGljaCBwcmV2ZW50cyBmdW5jdGlvbiBmcm9tIHJ1bm5pbmcgaWYgaXQgaXMgY2FsbGVkIGJ5IGFueW9uZSBvdGhlciB0aGFuIHRoZSBvd25lci4NCiAqLw0KY29udHJhY3QgT3duYWJsZSB7DQogIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsNCiAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KICB9DQoNCn0NCg0KDQovKg0KICogSGFsdGFibGUNCiAqDQogKiBBYnN0cmFjdCBjb250cmFjdCB0aGF0IGFsbG93cyBjaGlsZHJlbiB0byBpbXBsZW1lbnQgYW4NCiAqIGVtZXJnZW5jeSBzdG9wIG1lY2hhbmlzbS4gRGlmZmVycyBmcm9tIFBhdXNhYmxlIGJ5IGNhdXNpbmcgYSB0aHJvdyB3aGVuIGluIGhhbHQgbW9kZS4NCiAqDQogKg0KICogT3JpZ2luYWxseSBlbnZpc2lvbmVkIGluIEZpcnN0Qmxvb2QgSUNPIGNvbnRyYWN0Lg0KICovDQpjb250cmFjdCBIYWx0YWJsZSBpcyBPd25hYmxlIHsNCiAgYm9vbCBwdWJsaWMgaGFsdGVkOw0KDQogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7DQogICAgaWYgKGhhbHRlZCkgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7DQogICAgaWYgKCFoYWx0ZWQpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVtZXJnZW5jeSwgdHJpZ2dlcnMgc3RvcHBlZCBzdGF0ZQ0KICBmdW5jdGlvbiBoYWx0KCkgZXh0ZXJuYWwgb25seU93bmVyIHsNCiAgICBoYWx0ZWQgPSB0cnVlOw0KICB9DQoNCiAgLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbmQgb2YgZW1lcmdlbmN5LCByZXR1cm5zIHRvIG5vcm1hbCBzdGF0ZQ0KICBmdW5jdGlvbiB1bmhhbHQoKSBleHRlcm5hbCBvbmx5T3duZXIgb25seUluRW1lcmdlbmN5IHsNCiAgICBoYWx0ZWQgPSBmYWxzZTsNCiAgfQ0KDQp9DQoNCg0KLyoqDQogKiBJbnRlcmZhY2UgZm9yIGRlZmluaW5nIGNyb3dkc2FsZSBwcmljaW5nLg0KICovDQpjb250cmFjdCBQcmljaW5nU3RyYXRlZ3kgew0KDQogIC8qKg0KICAgKiBXaGVuIHNvbWVib2R5IHRyaWVzIHRvIGJ1eSB0b2tlbnMgZm9yIFggZXRoLCBjYWxjdWxhdGUgaG93IG1hbnkgdG9rZW5zIHRoZXkgZ2V0Lg0KICAgKi8NCiAgZnVuY3Rpb24gY2FsY3VsYXRlUHJpY2UodWludCB2YWx1ZSwgdWludCB0b2tlbnNTb2xkLCB1aW50IHdlaVJhaXNlZCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdG9rZW5BbW91bnQpOw0KfQ0KDQoNCi8qKg0KICogRmluYWxpemUgYWdlbnQgZGVmaW5lcyB3aGF0IGhhcHBlbnMgYXQgdGhlIGVuZCBvZiBzdWNjZXNlZnVsIGNyb3dkc2FsZS4NCiAqDQogKiAtIEFsbG9jYXRlIHRva2VucyBmb3IgZm91bmRlcnMsIGJvdW50aWVzIGFuZCBjb21tdW5pdHkNCiAqIC0gTWFrZSB0b2tlbnMgdHJhbnNmZXJhYmxlDQogKiAtIGV0Yy4NCiAqLw0KY29udHJhY3QgRmluYWxpemVBZ2VudCB7DQoNCiAgZnVuY3Rpb24gaXNGaW5hbGl6ZUFnZW50KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMoYm9vbCkgew0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgLyoqIENhbGxlZCBvbmNlIGJ5IGNyb3dkc2FsZSBmaW5hbGl6ZSgpIGlmIHRoZSBzYWxlIHdhcyBzdWNjZXNzLiAqLw0KICBmdW5jdGlvbiBmaW5hbGl6ZUNyb3dkc2FsZSgpOw0KDQp9DQoNCg0KDQovKioNCiAqIEFic3RyYWN0IGJhc2UgY29udHJhY3QgZm9yIHRva2VuIHNhbGVzLg0KICoNCiAqIEhhbmRsZQ0KICogLSBzdGFydCBhbmQgZW5kIGRhdGVzDQogKiAtIGFjY2VwdGluZyBpbnZlc3RtZW50cw0KICogLSBtaW5pbXVtIGZ1bmRpbmcgZ29hbCBhbmQgcmVmdW5kDQogKiAtIHZhcmlvdXMgc3RhdGlzdGljcyBkdXJpbmcgdGhlIGNyb3dkZnVuZA0KICogLSBkaWZmZXJlbnQgcHJpY2luZyBzdHJhdGVnaWVzDQogKg0KICovDQpjb250cmFjdCBDcm93ZHNhbGUgaXMgSGFsdGFibGUgew0KDQogIHVzaW5nIFNhZmVNYXRoTGliIGZvciB1aW50Ow0KDQogIC8qIFRoZSB0b2tlbiB3ZSBhcmUgc2VsbGluZyAqLw0KICBFUkMyMCBwdWJsaWMgdG9rZW47DQoNCiAgLyogSG93IHdlIGFyZSBnb2luZyB0byBwcmljZSBvdXIgb2ZmZXJpbmcgKi8NCiAgUHJpY2luZ1N0cmF0ZWd5IHB1YmxpYyBwcmljaW5nU3RyYXRlZ3k7DQoNCiAgLyogUG9zdC1zdWNjZXNzIGNhbGxiYWNrICovDQogIEZpbmFsaXplQWdlbnQgcHVibGljIGZpbmFsaXplQWdlbnQ7DQoNCiAgLyogdG9rZW5zIHdpbGwgYmUgdHJhbnNmZXJlZCBmcm9tIHRoaXMgYWRkcmVzcyAqLw0KICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ1dhbGxldDsNCg0KICAvKiBUaGUgcGFydHkgd2hvIGhvbGRzIHRoZSBmdWxsIHRva2VuIHBvb2wgYW5kIGhhcyBhcHByb3ZlKCknZWQgdG9rZW5zIGZvciB0aGlzIGNyb3dkc2FsZSAqLw0KICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsNCg0KICAvKiBpZiB0aGUgZnVuZGluZyBnb2FsIGlzIG5vdCByZWFjaGVkLCBpbnZlc3RvcnMgbWF5IHdpdGhkcmF3IHRoZWlyIGZ1bmRzICovDQogIHVpbnQgcHVibGljIG1pbmltdW1GdW5kaW5nR29hbDsNCg0KICAvKiB0aGUgVU5JWCB0aW1lc3RhbXAgc3RhcnQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlICovDQogIHVpbnQgcHVibGljIHN0YXJ0c0F0Ow0KDQogIC8qIHRoZSBVTklYIHRpbWVzdGFtcCBlbmQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlICovDQogIHVpbnQgcHVibGljIGVuZHNBdDsNCg0KICAvKiB0aGUgbnVtYmVyIG9mIHRva2VucyBhbHJlYWR5IHNvbGQgdGhyb3VnaCB0aGlzIGNvbnRyYWN0Ki8NCiAgdWludCBwdWJsaWMgdG9rZW5zU29sZCA9IDA7DQoNCiAgLyogSG93IG1hbnkgd2VpIG9mIGZ1bmRpbmcgd2UgaGF2ZSByYWlzZWQgKi8NCiAgdWludCBwdWJsaWMgd2VpUmFpc2VkID0gMDsNCg0KICAvKiBIb3cgbWFueSBkaXN0aW5jdCBhZGRyZXNzZXMgaGF2ZSBpbnZlc3RlZCAqLw0KICB1aW50IHB1YmxpYyBpbnZlc3RvckNvdW50ID0gMDsNCg0KICAvKiBIb3cgbXVjaCB3ZWkgd2UgaGF2ZSByZXR1cm5lZCBiYWNrIHRvIHRoZSBjb250cmFjdCBhZnRlciBhIGZhaWxlZCBjcm93ZGZ1bmQuICovDQogIHVpbnQgcHVibGljIGxvYWRlZFJlZnVuZCA9IDA7DQoNCiAgLyogSG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBpbnZlc3RvcnMuKi8NCiAgdWludCBwdWJsaWMgd2VpUmVmdW5kZWQgPSAwOw0KDQogIC8qIEhhcyB0aGlzIGNyb3dkc2FsZSBiZWVuIGZpbmFsaXplZCAqLw0KICBib29sIHB1YmxpYyBmaW5hbGl6ZWQ7DQoNCiAgLyoqIEhvdyBtdWNoIEVUSCBlYWNoIGFkZHJlc3MgaGFzIGludmVzdGVkIHRvIHRoaXMgY3Jvd2RzYWxlICovDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGludmVzdGVkQW1vdW50T2Y7DQoNCiAgLyoqIEhvdyBtdWNoIHRva2VucyB0aGlzIGNyb3dkc2FsZSBoYXMgY3JlZGl0ZWQgZm9yIGVhY2ggaW52ZXN0b3IgYWRkcmVzcyAqLw0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyB0b2tlbkFtb3VudE9mOw0KDQogIC8qKiBTdGF0ZSBtYWNoaW5lDQogICAqDQogICAqIC0gUHJlZnVuZGluZzogV2UgaGF2ZSBub3Qgc3RhcnRlZCB5ZXQNCiAgICogLSBGdW5kaW5nOiBBY3RpdmUgY3Jvd2RzYWxlDQogICAqIC0gU3VjY2VzczogTWluaW11bSBmdW5kaW5nIGdvYWwgcmVhY2hlZA0KICAgKiAtIEZhaWx1cmU6IE1pbmltdW0gZnVuZGluZyBnb2FsIG5vdCByZWFjaGVkIGJlZm9yZSBlbmRpbmcgdGltZQ0KICAgKiAtIEZpbmFsaXplZDogVGhlIGZpbmFsaXplZCBoYXMgYmVlbiBjYWxsZWQgYW5kIHN1Y2Nlc2Z1bGx5IGV4ZWN1dGVkDQogICAqIC0gUmVmdW5kaW5nOiBSZWZ1bmRzIGFyZSBsb2FkZWQgb24gdGhlIGNvbnRyYWN0IGZvciByZWNsYWltLg0KICAgKi8NCiAgZW51bSBTdGF0ZXtVbmtub3duLCBQcmVGdW5kaW5nLCBGdW5kaW5nLCBTdWNjZXNzLCBGYWlsdXJlLCBGaW5hbGl6ZWQsIFJlZnVuZGluZ30NCg0KICBldmVudCBJbnZlc3RlZChhZGRyZXNzIGludmVzdG9yLCB1aW50IHdlaUFtb3VudCwgdWludCB0b2tlbkFtb3VudCk7DQogIGV2ZW50IFJlZnVuZChhZGRyZXNzIGludmVzdG9yLCB1aW50IHdlaUFtb3VudCk7DQoNCiAgZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9wcmljaW5nU3RyYXRlZ3ksIGFkZHJlc3MgX211bHRpc2lnV2FsbGV0LCBhZGRyZXNzIF9iZW5lZmljaWFyeSwgdWludCBfc3RhcnQsIHVpbnQgX2VuZCwgdWludCBfbWluaW11bUZ1bmRpbmdHb2FsKSB7DQoNCiAgICBvd25lciA9IG1zZy5zZW5kZXI7DQoNCiAgICB0b2tlbiA9IEVSQzIwKF90b2tlbik7DQoNCiAgICBwcmljaW5nU3RyYXRlZ3kgPSBQcmljaW5nU3RyYXRlZ3koX3ByaWNpbmdTdHJhdGVneSk7DQoNCiAgICBtdWx0aXNpZ1dhbGxldCA9IF9tdWx0aXNpZ1dhbGxldDsNCiAgICBpZihtdWx0aXNpZ1dhbGxldCA9PSAwKSB7DQogICAgICAgIHRocm93Ow0KICAgIH0NCg0KICAgIC8vIFRPRE86IHJlbW92ZSBiZW5lZmljaWFyeSBmcm9tIHRoZSBiYXNlIGNsYXNzDQogICAgYmVuZWZpY2lhcnkgPSBfYmVuZWZpY2lhcnk7DQogICAgaWYoYmVuZWZpY2lhcnkgPT0gMCkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBpZihfc3RhcnQgPT0gMCkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBzdGFydHNBdCA9IF9zdGFydDsNCg0KICAgIGlmKF9lbmQgPT0gMCkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBlbmRzQXQgPSBfZW5kOw0KDQogICAgLy8gRG9uJ3QgbWVzcyB0aGUgZGF0ZXMNCiAgICBpZihzdGFydHNBdCA+PSBlbmRzQXQpIHsNCiAgICAgICAgdGhyb3c7DQogICAgfQ0KDQogICAgLy8gTWluaW11bSBmdW5kaW5nIGdvYWwgY2FuIGJlIHplcm8NCiAgICBtaW5pbXVtRnVuZGluZ0dvYWwgPSBfbWluaW11bUZ1bmRpbmdHb2FsOw0KICB9DQoNCiAgLyoqDQogICAqIERvbid0IGV4cGVjdCB0byBqdXN0IHNlbmQgaW4gbW9uZXkgYW5kIGdldCB0b2tlbnMuDQogICAqLw0KICBmdW5jdGlvbigpIHBheWFibGUgew0KICAgIHRocm93Ow0KICB9DQoNCiAgLyoqDQogICAqIE1ha2UgYW4gaW52ZXN0bWVudC4NCiAgICoNCiAgICogQ3Jvd2RzYWxlIG11c3QgYmUgcnVubmluZyBmb3Igb25lIHRvIGludmVzdC4NCiAgICogV2UgbXVzdCBoYXZlIG5vdCBwcmVzc2VkIHRoZSBlbWVyZ2VuY3kgYnJha2UuDQogICAqDQogICAqDQogICAqLw0KICBmdW5jdGlvbiBpbnZlc3QoYWRkcmVzcyByZWNlaXZlcikgaW5TdGF0ZShTdGF0ZS5GdW5kaW5nKSBzdG9wSW5FbWVyZ2VuY3kgcGF5YWJsZSBwdWJsaWMgew0KDQogICAgdWludCB3ZWlBbW91bnQgPSBtc2cudmFsdWU7DQogICAgdWludCB0b2tlbkFtb3VudCA9IHByaWNpbmdTdHJhdGVneS5jYWxjdWxhdGVQcmljZSh3ZWlBbW91bnQsIHdlaVJhaXNlZCwgdG9rZW5zU29sZCk7DQoNCiAgICBpZih0b2tlbkFtb3VudCA9PSAwKSB7DQogICAgICAvLyBEdXN0IHRyYW5zYWN0aW9uDQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBpZihpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXSAhPSAwKSB7DQogICAgICAgLy8gQSBuZXcgaW52ZXN0b3INCiAgICAgICBpbnZlc3RvckNvdW50Kys7DQogICAgfQ0KDQogICAgLy8gVXBkYXRlIGludmVzdG9yDQogICAgaW52ZXN0ZWRBbW91bnRPZltyZWNlaXZlcl0gPSBpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXS5wbHVzKHdlaUFtb3VudCk7DQogICAgdG9rZW5BbW91bnRPZltyZWNlaXZlcl0gPSB0b2tlbkFtb3VudE9mW3JlY2VpdmVyXS5wbHVzKHRva2VuQW1vdW50KTsNCg0KICAgIC8vIFVwZGF0ZSB0b3RhbHMNCiAgICB3ZWlSYWlzZWQgPSB3ZWlSYWlzZWQucGx1cyh3ZWlBbW91bnQpOw0KICAgIHRva2Vuc1NvbGQgPSB0b2tlbnNTb2xkLnBsdXModG9rZW5BbW91bnQpOw0KDQogICAgLy8gQ2hlY2sgdGhhdCB3ZSBkaWQgbm90IGJ1c3QgdGhlIGNhcA0KICAgIGlmKGlzQnJlYWtpbmdDYXAodG9rZW5BbW91bnQsIHdlaUFtb3VudCwgd2VpUmFpc2VkLCB0b2tlbnNTb2xkKSkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KDQogICAgYXNzaWduVG9rZW5zKHJlY2VpdmVyLCB0b2tlbkFtb3VudCk7DQoNCiAgICAvLyBQb2NrZXQgdGhlIG1vbmV5DQogICAgaWYoIW11bHRpc2lnV2FsbGV0LnNlbmQod2VpQW1vdW50KSkgdGhyb3c7DQoNCiAgICAvLyBUZWxsIHVzIGludmVzdCB3YXMgc3VjY2Vzcw0KICAgIEludmVzdGVkKHJlY2VpdmVyLCB3ZWlBbW91bnQsIHRva2VuQW1vdW50KTsNCiAgfQ0KDQogIC8qKg0KICAgKiBUaGUgYmFzaWMgZW50cnkgcG9pbnQgdG8gcGFydGljaXBhdGUgdGhlIGNyb3dkc2FsZSBwcm9jZXNzLg0KICAgKg0KICAgKiBQYXkgZm9yIGZ1bmRpbmcsIGdldCBpbnZlc3RlZCB0b2tlbnMgYmFjayBpbiB0aGUgc2VuZGVyIGFkZHJlc3MuDQogICAqLw0KICBmdW5jdGlvbiBidXkoKSBwdWJsaWMgcGF5YWJsZSB7DQogICAgaW52ZXN0KG1zZy5zZW5kZXIpOw0KICB9DQoNCiAgLyoqDQogICAqIEZpbmFsaXplIGEgc3VjY2Nlc2Z1bCBjcm93ZHNhbGUuDQogICAqDQogICAqIEFueWJvZHkgY2FuIGNhbGwgdG8gdHJpZ2dlciB0aGUgZW5kIG9mIHRoZSBjcm93ZHNhbGUuDQogICAqDQogICAqIENhbGwgdGhlIGNvbnRyYWN0IHRoYXQgcHJvdmlkZXMgcG9zdC1jcm93ZHNhbGUgYWN0aW9ucywgbGlrZSByZWxlYXNpbmcgdGhlIHRva2Vucy4NCiAgICovDQogIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIGluU3RhdGUoU3RhdGUuU3VjY2Vzcykgc3RvcEluRW1lcmdlbmN5IHsNCg0KICAgIC8vIEFscmVhZHkgZmluYWxpemVkDQogICAgaWYoZmluYWxpemVkKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICAvLyBGaW5hbGl6aW5nIGlzIG9wdGlvbmFsLiBXZSBvbmx5IGNhbGwgaXQgaWYgd2UgYXJlIGdpdmVuIGEgZmluYWxpemluZyBhZ2VudC4NCiAgICBpZihhZGRyZXNzKGZpbmFsaXplQWdlbnQpICE9IDApIHsNCiAgICAgIGZpbmFsaXplQWdlbnQuZmluYWxpemVDcm93ZHNhbGUoKTsNCiAgICB9DQoNCiAgICBmaW5hbGl6ZWQgPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gc2V0RmluYWxpemVBZ2VudChGaW5hbGl6ZUFnZW50IGFkZHIpIG9ubHlPd25lciBpblN0YXRlKFN0YXRlLlByZUZ1bmRpbmcpIHsNCiAgICBmaW5hbGl6ZUFnZW50ID0gYWRkcjsNCg0KICAgIC8vIERvbid0IGFsbG93IHNldHRpbmcgYmFkIGFnZW50DQogICAgaWYoIWZpbmFsaXplQWdlbnQuaXNGaW5hbGl6ZUFnZW50KCkpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgfQ0KDQogIC8qKg0KICAgKiBBbGxvdyBsb2FkIHJlZnVuZHMgYmFjayBvbiB0aGUgY29udHJhY3QgZm9yIHRoZSByZWZ1bmRpbmcuDQogICAqDQogICAqIFRoZSB0ZWFtIGNhbiB0cmFuc2ZlciB0aGUgZnVuZHMgYmFjayBvbiB0aGUgc21hcnQgY29udHJhY3QgaW4gdGhlIGNhc2UgdGhlIG1pbmltdW0gZ29hbCB3YXMgbm90IHJlYWNoZWQuLg0KICAgKi8NCiAgZnVuY3Rpb24gbG9hZFJlZnVuZCgpIHB1YmxpYyBwYXlhYmxlIGluU3RhdGUoU3RhdGUuRmFpbHVyZSkgew0KICAgIGlmKG1zZy52YWx1ZSA9PSAwKSB0aHJvdzsNCiAgICBsb2FkZWRSZWZ1bmQgPSBsb2FkZWRSZWZ1bmQucGx1cyhtc2cudmFsdWUpOw0KICB9DQoNCiAgLyoqDQogICAqIEludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kLg0KICAgKi8NCiAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIGluU3RhdGUoU3RhdGUuUmVmdW5kaW5nKSB7DQogICAgdWludDI1NiB3ZWlWYWx1ZSA9IGludmVzdGVkQW1vdW50T2ZbbXNnLnNlbmRlcl07DQogICAgaWYgKHdlaVZhbHVlID09IDApIHRocm93Ow0KICAgIGludmVzdGVkQW1vdW50T2ZbbXNnLnNlbmRlcl0gPSAwOw0KICAgIHdlaVJlZnVuZGVkID0gd2VpUmVmdW5kZWQucGx1cyh3ZWlWYWx1ZSk7DQogICAgUmVmdW5kKG1zZy5zZW5kZXIsIHdlaVZhbHVlKTsNCiAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZCh3ZWlWYWx1ZSkpIHRocm93Ow0KICB9DQoNCiAgLyoqDQogICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY3Jvd2RzYWxlIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2VzDQogICAqLw0KICBmdW5jdGlvbiBpc01pbmltdW1Hb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIHJlYWNoZWQpIHsNCiAgICByZXR1cm4gd2VpUmFpc2VkID49IG1pbmltdW1GdW5kaW5nR29hbDsNCiAgfQ0KDQogIC8qKg0KICAgKiBDcm93ZGZ1bmQgc3RhdGUgbWFjaGluZSBtYW5hZ2VtZW50Lg0KICAgKg0KICAgKiBXZSBtYWtlIGl0IGEgZnVuY3Rpb24gYW5kIGRvIG5vdCBhc3NpZ24gdGhlIHJlc3VsdCB0byBhIHZhcmlhYmxlLCBzbyB0aGVyZSBpcyBubyBjaGFuY2Ugb2YgdGhlIHZhcmlhYmxlIGJlaW5nIHN0YWxlLg0KICAgKi8NCiAgZnVuY3Rpb24gZ2V0U3RhdGUoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoU3RhdGUpIHsNCiAgICBpZihmaW5hbGl6ZWQpIHJldHVybiBTdGF0ZS5GaW5hbGl6ZWQ7DQogICAgZWxzZSBpZiAoYmxvY2sudGltZXN0YW1wIDwgc3RhcnRzQXQpIHJldHVybiBTdGF0ZS5QcmVGdW5kaW5nOw0KICAgIGVsc2UgaWYgKGJsb2NrLnRpbWVzdGFtcCA8PSBlbmRzQXQgJiYgIWlzQ3Jvd2RzYWxlRnVsbCgpKSByZXR1cm4gU3RhdGUuRnVuZGluZzsNCiAgICBlbHNlIGlmIChpc01pbmltdW1Hb2FsUmVhY2hlZCgpKSByZXR1cm4gU3RhdGUuU3VjY2VzczsNCiAgICBlbHNlIGlmICghaXNNaW5pbXVtR29hbFJlYWNoZWQoKSAmJiB3ZWlSYWlzZWQgPiAwICYmIGxvYWRlZFJlZnVuZCA+PSB3ZWlSYWlzZWQpIHJldHVybiBTdGF0ZS5SZWZ1bmRpbmc7DQogICAgZWxzZSByZXR1cm4gU3RhdGUuRmFpbHVyZTsNCiAgfQ0KDQogIC8vDQogIC8vIE1vZGlmaWVycw0KICAvLw0KDQogIC8qKiBNb2RpZmllZCBhbGxvd2luZyBleGVjdXRpb24gb25seSBpZiB0aGUgY3Jvd2RzYWxlIGlzIGN1cnJlbnRseSBydW5uaW5nLiAgKi8NCiAgbW9kaWZpZXIgaW5TdGF0ZShTdGF0ZSBzdGF0ZSkgew0KICAgIGlmKGdldFN0YXRlKCkgIT0gc3RhdGUpIHRocm93Ow0KICAgIF87DQogIH0NCg0KICAvLw0KICAvLyBBYnN0cmFjdCBmdW5jdGlvbnMNCiAgLy8NCg0KICAvKioNCiAgICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgaW52ZXN0ZWQgYnJlYWtzIG91ciBjYXAgcnVsZXMuDQogICAqDQogICAqDQogICAqIFRoZSBjaGlsZCBjb250cmFjdCBtdXN0IGRlZmluZSB0aGVpciBvd24gY2FwIHNldHRpbmcgcnVsZXMuDQogICAqIFdlIGFsbG93IGEgbG90IG9mIGZsZXhpYmlsaXR5IHRocm91Z2ggZGlmZmVyZW50IGNhcHBpbmcgc3RyYXRlZ2llcyAoRVRILCB0b2tlbiBjb3VudCkNCiAgICogQ2FsbGVkIGZyb20gaW52ZXN0KCkuDQogICAqDQogICAqIEBwYXJhbSB3ZWlBbW91bnQgVGhlIGFtb3VudCBvZiB3ZWkgdGhlIGludmVzdG9yIHRyaWVzIHRvIGludmVzdCBpbiB0aGUgY3VycmVudCB0cmFuc2FjdGlvbg0KICAgKiBAcGFyYW0gdG9rZW5BbW91bnQgVGhlIGFtb3VudCBvZiB0b2tlbnMgd2UgdHJ5IHRvIGdpdmUgdG8gdGhlIGludmVzdG9yIGluIHRoZSBjdXJyZW50IHRyYW5zYWN0aW9uDQogICAqIEBwYXJhbSB3ZWlSYWlzZWRUb3RhbCBXaGF0IHdvdWxkIGJlIG91ciB0b3RhbCByYWlzZWQgYmFsYW5jZSBhZnRlciB0aGlzIHRyYW5zYWN0aW9uDQogICAqIEBwYXJhbSB0b2tlbnNTb2xkVG90YWwgV2hhdCB3b3VsZCBiZSBvdXIgdG90YWwgc29sZCB0b2tlbnMgY291bnRhZnRlciB0aGlzIHRyYW5zYWN0aW9uDQogICAqDQogICAqIEByZXR1cm4gdHJ1ZSBpZiB0YWtpbmcgdGhpcyBpbnZlc3RtZW50IHdvdWxkIGJyZWFrIG91ciBjYXAgcnVsZXMNCiAgICovDQogIGZ1bmN0aW9uIGlzQnJlYWtpbmdDYXAodWludCB3ZWlBbW91bnQsIHVpbnQgdG9rZW5BbW91bnQsIHVpbnQgd2VpUmFpc2VkVG90YWwsIHVpbnQgdG9rZW5zU29sZFRvdGFsKSBjb25zdGFudCByZXR1cm5zIChib29sIGxpbWl0QnJva2VuKTsNCg0KICAvKioNCiAgICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY3Jvd2RzYWxlIGlzIGZ1bGwgYW5kIHdlIGNhbiBubyBsb25nZXIgc2VsbCBhbnkgdG9rZW5zLg0KICAgKi8NCiAgZnVuY3Rpb24gaXNDcm93ZHNhbGVGdWxsKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpOw0KDQogIC8qKg0KICAgKiBDcmVhdGUgbmV3IHRva2VucyBvciB0cmFuc2ZlciBpc3N1ZWQgdG9rZW5zIHRvIHRoZSBpbnZlc3RvciBkZXBlbmRpbmcgb24gdGhlIGNhcCBtb2RlbC4NCiAgICovDQogIGZ1bmN0aW9uIGFzc2lnblRva2VucyhhZGRyZXNzIHJlY2VpdmVyLCB1aW50IHRva2VuQW1vdW50KSBwcml2YXRlOw0KfQ0KDQoNCg0KLyoqDQogKiBDb2xsZWN0IGZ1bmRzIGZyb20gcHJlc2FsZSBpbnZlc3RvcnMgdG8gYmUgc2VuZCB0byB0aGUgY3Jvd2RzYWxlIHNtYXJ0IGNvbnRyYWN0IGxhdGVyLg0KICoNCiAqIC0gQ29sbGVjdCBmdW5kcyBmcm9tIHByZS1zYWxlIGludmVzdG9ycw0KICogLSBTZW5kIGZ1bmRzIHRvIHRoZSBjcm93ZHNhbGUgd2hlbiBpdCBvcGVucw0KICogLSBBbGxvdyBvd25lciB0byBzZXQgdGhlIGNyb3dkc2FsZQ0KICogLSBIYXZlIHJlZnVuZCBhZnRlciBYIGRheXMgYXMgYSBzYWZldHkgaGF0Y2ggaWYgdGhlIGNyb3dkc2FsZSBkb2Vzbid0IG1hdGVyaWxpemUNCiAqDQogKi8NCmNvbnRyYWN0IFByZXNhbGVGdW5kQ29sbGVjdG9yIGlzIE93bmFibGUgew0KDQogIHVzaW5nIFNhZmVNYXRoTGliIGZvciB1aW50Ow0KDQogIC8qKiBIb3cgbWFueSBpbnZlc3RvcnMgd2hlbiBjYW4gY2FycnkgcGVyIGEgc2luZ2xlIGNvbnRyYWN0ICovDQogIHVpbnQgcHVibGljIE1BWF9JTlZFU1RPUlMgPSAzMjsNCg0KICAvKiogSG93IG1hbnkgaW52ZXN0b3JzIHdlIGhhdmUgbm93ICovDQogIHVpbnQgcHVibGljIGludmVzdG9yQ291bnQ7DQoNCiAgLyoqIFdobyBhcmUgb3VyIGludmVzdG9ycyAoaXRlcmFibGUpICovDQogIGFkZHJlc3NbXSBwdWJsaWMgaW52ZXN0b3JzOw0KDQogIC8qKiBIb3cgbXVjaCB0aGV5IGhhdmUgaW52ZXN0ZWQgKi8NCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBiYWxhbmNlczsNCg0KICAvKiogV2hlbiBvdXIgcmVmdW5kIGZyZWV6ZSBpcyBvdmVyIChVTklUIHRpbWVzdGFtcCkgKi8NCiAgdWludCBwdWJsaWMgZnJlZXplRW5kc0F0Ow0KDQogIC8qKiBXaGF0IGlzIHRoZSBtaW5pbXVtIGJ1eSBpbiAqLw0KICB1aW50IHB1YmxpYyB3ZWlNaW5pbXVtTGltaXQ7DQoNCiAgLyoqIEhhdmUgd2UgYmVndW4gdG8gbW92ZSBmdW5kcyAqLw0KICBib29sIHB1YmxpYyBtb3Zpbmc7DQoNCiAgLyoqIE91ciBJQ08gY29udHJhY3Qgd2hlcmUgd2Ugd2lsbCBtb3ZlIHRoZSBmdW5kcyAqLw0KICBDcm93ZHNhbGUgcHVibGljIGNyb3dkc2FsZTsNCg0KICBldmVudCBJbnZlc3RlZChhZGRyZXNzIGludmVzdG9yLCB1aW50IHZhbHVlKTsNCiAgZXZlbnQgUmVmdW5kZWQoYWRkcmVzcyBpbnZlc3RvciwgdWludCB2YWx1ZSk7DQoNCiAgLyoqDQogICAqIENyZWF0ZSBwcmVzYWxlIGNvbnRyYWN0IHdoZXJlIGxvY2sgdXAgcGVyaW9kIGlzIGdpdmVuIGRheXMNCiAgICovDQogIGZ1bmN0aW9uIFByZXNhbGVGdW5kQ29sbGVjdG9yKGFkZHJlc3MgX293bmVyLCB1aW50IF9mcmVlemVFbmRzQXQsIHVpbnQgX3dlaU1pbmltdW1MaW1pdCkgew0KDQogICAgb3duZXIgPSBfb3duZXI7DQoNCiAgICAvLyBHaXZlIGFyZ3VtZW50DQogICAgaWYoX2ZyZWV6ZUVuZHNBdCA9PSAwKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICAvLyBHaXZlIGFyZ3VtZW50DQogICAgaWYoX3dlaU1pbmltdW1MaW1pdCA9PSAwKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICB3ZWlNaW5pbXVtTGltaXQgPSBfd2VpTWluaW11bUxpbWl0Ow0KICAgIGZyZWV6ZUVuZHNBdCA9IF9mcmVlemVFbmRzQXQ7DQogIH0NCg0KICAvKioNCiAgICogUGFydGljaXBhdGUgdG8gYSBwcmVzYWxlLg0KICAgKi8NCiAgZnVuY3Rpb24gaW52ZXN0KCkgcHVibGljIHBheWFibGUgew0KDQogICAgLy8gQ2Fubm90IGludmVzdCBhbnltb3JlIHRocm91Z2ggY3Jvd2RzYWxlIHdoZW4gbW92aW5nIGhhcyBiZWd1bg0KICAgIGlmKG1vdmluZykgdGhyb3c7DQoNCiAgICBhZGRyZXNzIGludmVzdG9yID0gbXNnLnNlbmRlcjsNCg0KICAgIGJvb2wgZXhpc3RpbmcgPSBiYWxhbmNlc1tpbnZlc3Rvcl0gPiAwOw0KDQogICAgYmFsYW5jZXNbaW52ZXN0b3JdID0gYmFsYW5jZXNbaW52ZXN0b3JdLnBsdXMobXNnLnZhbHVlKTsNCg0KICAgIC8vIE5lZWQgdG8gZnVsZmlsbCBtaW5pbXVtIGxpbWl0DQogICAgaWYoYmFsYW5jZXNbaW52ZXN0b3JdIDwgd2VpTWluaW11bUxpbWl0KSB7DQogICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICAvLyBUaGlzIGlzIGEgbmV3IGludmVzdG9yDQogICAgaWYoIWV4aXN0aW5nKSB7DQoNCiAgICAgIC8vIExpbWl0IG51bWJlciBvZiBpbnZlc3RvcnMgdG8gcHJldmVudCB0b28gbG9uZyBsb29wcw0KICAgICAgaWYoaW52ZXN0b3JDb3VudCA+PSBNQVhfSU5WRVNUT1JTKSB0aHJvdzsNCg0KICAgICAgaW52ZXN0b3JzLnB1c2goaW52ZXN0b3IpOw0KICAgICAgaW52ZXN0b3JDb3VudCsrOw0KICAgIH0NCg0KICAgIEludmVzdGVkKGludmVzdG9yLCBtc2cudmFsdWUpOw0KICB9DQoNCiAgLyoqDQogICAqIExvYWQgZnVuZHMgdG8gdGhlIGNyb3dkc2FsZSBmb3IgYSBzaW5nbGUgaW52ZXN0b3IuDQogICAqLw0KICBmdW5jdGlvbiBwYXJjaXBhdGVDcm93ZHNhbGVJbnZlc3RvcihhZGRyZXNzIGludmVzdG9yKSBwdWJsaWMgew0KDQogICAgLy8gQ3Jvd2RzYWxlIG5vdCB5ZXQgc2V0DQogICAgaWYoYWRkcmVzcyhjcm93ZHNhbGUpID09IDApIHRocm93Ow0KDQogICAgbW92aW5nID0gdHJ1ZTsNCg0KICAgIGlmKGJhbGFuY2VzW2ludmVzdG9yXSA+IDApIHsNCiAgICAgIHVpbnQgYW1vdW50ID0gYmFsYW5jZXNbaW52ZXN0b3JdOw0KICAgICAgZGVsZXRlIGJhbGFuY2VzW2ludmVzdG9yXTsNCiAgICAgIGNyb3dkc2FsZS5pbnZlc3QudmFsdWUoYW1vdW50KShpbnZlc3Rvcik7DQogICAgfQ0KICB9DQoNCiAgLyoqDQogICAqIExvYWQgZnVuZHMgdG8gdGhlIGNyb3dkc2FsZSBmb3IgYWxsIGludmVzdG9yLg0KICAgKg0KICAgKi8NCiAgZnVuY3Rpb24gcGFyY2lwYXRlQ3Jvd2RzYWxlQWxsKCkgcHVibGljIHsNCg0KICAgIC8vIFdlIG1pZ2h0IGhpdCBhIG1heCBnYXMgbGltaXQgaW4gdGhpcyBsb29wLA0KICAgIC8vIGFuZCBpbiB0aGlzIGNhc2UgeW91IGNhbiBzaW1wbHkgY2FsbCBwYXJjaXBhdGVDcm93ZHNhbGVJbnZlc3RvcigpIGZvciBhbGwgaW52ZXN0b3JzDQogICAgZm9yKHVpbnQgaT0wOyBpPGludmVzdG9ycy5sZW5ndGg7IGkrKykgew0KICAgICAgIHBhcmNpcGF0ZUNyb3dkc2FsZUludmVzdG9yKGludmVzdG9yc1tpXSk7DQogICAgfQ0KICB9DQoNCiAgLyoqDQogICAqIElDTyBuZXZlciBoYXBwZW5lZC4gQWxsb3cgcmVmdW5kLg0KICAgKi8NCiAgZnVuY3Rpb24gcmVmdW5kKCkgew0KDQogICAgLy8gVHJ5aW5nIHRvIGFzayByZWZ1bmQgdG9vIHNvb24NCiAgICBpZihub3cgPCBmcmVlemVFbmRzQXQpIHRocm93Ow0KDQogICAgLy8gV2UgaGF2ZSBzdGFydGVkIHRvIG1vdmUgZnVuZHMNCiAgICBtb3ZpbmcgPSB0cnVlOw0KDQogICAgYWRkcmVzcyBpbnZlc3RvciA9IG1zZy5zZW5kZXI7DQogICAgaWYoYmFsYW5jZXNbaW52ZXN0b3JdID09IDApIHRocm93Ow0KICAgIHVpbnQgYW1vdW50ID0gYmFsYW5jZXNbaW52ZXN0b3JdOw0KICAgIGRlbGV0ZSBiYWxhbmNlc1tpbnZlc3Rvcl07DQogICAgaWYoIWludmVzdG9yLnNlbmQoYW1vdW50KSkgdGhyb3c7DQogICAgUmVmdW5kZWQoaW52ZXN0b3IsIGFtb3VudCk7DQogIH0NCg0KICAvKioNCiAgICogU2V0IHRoZSB0YXJnZXQgY3Jvd2RzYWxlIHdoZXJlIHdlIHdpbGwgbW92ZSBwcmVzYWxlIGZ1bmRzIHdoZW4gdGhlIGNyb3dkc2FsZSBvcGVucy4NCiAgICovDQogIGZ1bmN0aW9uIHNldENyb3dkc2FsZShDcm93ZHNhbGUgX2Nyb3dkc2FsZSkgcHVibGljIG9ubHlPd25lciB7DQogICAgIGNyb3dkc2FsZSA9IF9jcm93ZHNhbGU7DQogIH0NCg0KICAvKiogRXhwbGljaXRseSBjYWxsIGZ1bmN0aW9uIGZyb20geW91ciB3YWxsZXQuICovDQogIGZ1bmN0aW9uKCkgcGF5YWJsZSB7DQogICAgdGhyb3c7DQogIH0NCn0='