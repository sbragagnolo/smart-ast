base 64 content
base64projectX
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCmxpYnJhcnkgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiID4gMCk7DQogICAgdWludCBjID0gYSAvIGI7DQogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7DQogICAgcmV0dXJuIGM7DQogIH0NCiAgZnVuY3Rpb24gc3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgcmV0dXJuIGEgLSBiOw0KICB9DQogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgIGFzc2VydChjID49IGEpOw0KICAgIHJldHVybiBjOw0KICB9DQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIGlmICghYXNzZXJ0aW9uKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogIH0NCn0NCmNvbnRyYWN0IE93bmFibGUgew0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQogICAgbW9kaWZpZXIgb25seU93bmVyIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgew0KICAgICAgICAgICAgb3duZXIgPSBuZXdPd25lcjsNCiAgICAgICAgfQ0KICAgIH0NCn0NCi8qDQogKiBQYXVzYWJsZQ0KICogQWJzdHJhY3QgY29udHJhY3QgdGhhdCBhbGxvd3MgY2hpbGRyZW4gdG8gaW1wbGVtZW50IGFuDQogKiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQogKi8NCmNvbnRyYWN0IFBhdXNhYmxlIGlzIE93bmFibGUgew0KICBib29sIHB1YmxpYyBzdG9wcGVkOw0KICBtb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgew0KICAgIGlmIChzdG9wcGVkKSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KICANCiAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsNCiAgICBpZiAoIXN0b3BwZWQpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW1lcmdlbmN5LCB0cmlnZ2VycyBzdG9wcGVkIHN0YXRlDQogIGZ1bmN0aW9uIGVtZXJnZW5jeVN0b3AoKSBleHRlcm5hbCBvbmx5T3duZXIgew0KICAgIHN0b3BwZWQgPSB0cnVlOw0KICB9DQogIC8vIGNhbGxlZCBieSB0aGUgb3duZXIgb24gZW5kIG9mIGVtZXJnZW5jeSwgcmV0dXJucyB0byBub3JtYWwgc3RhdGUNCiAgZnVuY3Rpb24gcmVsZWFzZSgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIHN0b3BwZWQgPSBmYWxzZTsNCiAgfQ0KfQ0KY29udHJhY3QgRVJDMjBCYXNpYyB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQp9DQpjb250cmFjdCBFUkMyMCBpcyBFUkMyMEJhc2ljIHsNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIGZyb20sIGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpOw0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KLyoNCiAqIFB1bGxQYXltZW50DQogKiBCYXNlIGNvbnRyYWN0IHN1cHBvcnRpbmcgYXN5bmMgc2VuZCBmb3IgcHVsbCBwYXltZW50cy4NCiAqIEluaGVyaXQgZnJvbSB0aGlzIGNvbnRyYWN0IGFuZCB1c2UgYXN5bmNTZW5kIGluc3RlYWQgb2Ygc2VuZC4NCiAqLw0KY29udHJhY3QgUHVsbFBheW1lbnQgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBwdWJsaWMgcGF5bWVudHM7DQogIGV2ZW50IExvZ1JlZnVuZEVUSChhZGRyZXNzIHRvLCB1aW50IHZhbHVlKTsNCiAgLyoqDQogICogIFN0b3JlIHNlbnQgYW1vdW50IGFzIGNyZWRpdCB0byBiZSBwdWxsZWQsIGNhbGxlZCBieSBwYXllciANCiAgKiovDQogIGZ1bmN0aW9uIGFzeW5jU2VuZChhZGRyZXNzIGRlc3QsIHVpbnQgYW1vdW50KSBpbnRlcm5hbCB7DQogICAgcGF5bWVudHNbZGVzdF0gPSBwYXltZW50c1tkZXN0XS5hZGQoYW1vdW50KTsNCiAgfQ0KICAvLyB3aXRoZHJhdyBhY2N1bXVsYXRlZCBiYWxhbmNlLCBjYWxsZWQgYnkgcGF5ZWUNCiAgZnVuY3Rpb24gd2l0aGRyYXdQYXltZW50cygpIHsNCiAgICBhZGRyZXNzIHBheWVlID0gbXNnLnNlbmRlcjsNCiAgICB1aW50IHBheW1lbnQgPSBwYXltZW50c1twYXllZV07DQogICAgDQogICAgaWYgKHBheW1lbnQgPT0gMCkgew0KICAgICAgdGhyb3c7DQogICAgfQ0KICAgIGlmICh0aGlzLmJhbGFuY2UgPCBwYXltZW50KSB7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgcGF5bWVudHNbcGF5ZWVdID0gMDsNCiAgICBpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBMb2dSZWZ1bmRFVEgocGF5ZWUscGF5bWVudCk7DQogIH0NCn0NCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRVJDMjBCYXNpYyB7DQogIA0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDsNCiAgDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50KSBiYWxhbmNlczsNCiAgDQogIC8qDQogICAqIEZpeCBmb3IgdGhlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrICANCiAgKi8NCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgew0KICAgICBpZihtc2cuZGF0YS5sZW5ndGggPCBzaXplICsgNCkgew0KICAgICAgIHRocm93Ow0KICAgICB9DQogICAgIF87DQogIH0NCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSB7DQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsNCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogIH0NCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpIHsNCiAgICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCiAgfQ0KfQ0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2VuLCBFUkMyMCB7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDMgKiAzMikgew0KICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0DQogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93Ow0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsNCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7DQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgfQ0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSB7DQogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2ANCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdA0KICAgIC8vICBhbHJlYWR5IDAgdG8gbWl0aWdhdGUgdGhlIHJhY2UgY29uZGl0aW9uIGRlc2NyaWJlZCBoZXJlOg0KICAgIC8vICBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjAjaXNzdWVjb21tZW50LTI2MzUyNDcyOQ0KICAgIGlmICgoX3ZhbHVlICE9IDApICYmIChhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgdGhyb3c7DQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogIH0NCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgew0KICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICB9DQp9DQovKioNCiAqICBQcm9qZWN0WCB0b2tlbiBjb250cmFjdC4gSW1wbGVtZW50cw0KICovDQpjb250cmFjdCBQcm9qZWN0WCBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsNCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlByb2plY3RYIjsNCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiUHJvWCI7DQogIHVpbnQgcHVibGljIGNvbnN0YW50IGRlY2ltYWxzID0gNjsNCiAgLy8gQ29uc3RydWN0b3INCiAgZnVuY3Rpb24gUHJvamVjdFgoKSB7DQogICAgICB0b3RhbFN1cHBseSA9IDEwMDAwMDAwMDAwMDA7Ly8xTQ0KICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSB0b3RhbFN1cHBseTsgLy8gU2VuZCBhbGwgdG9rZW5zIHRvIG93bmVyDQogIH0NCiAgLyoqDQogICAqICBCdXJuIGF3YXkgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgUHJvamVjdFggdG9rZW5zDQogICAqLw0KICBmdW5jdGlvbiBidXJuKHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCkgew0KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0uc3ViKF92YWx1ZSk7DQogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5zdWIoX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCAweDAsIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCn0NCi8qDQogIENyb3dkc2FsZSBTbWFydCBDb250cmFjdCBmb3IgdGhlIFByb2plY3RYLm9yZyBwcm9qZWN0DQogIFRoaXMgc21hcnQgY29udHJhY3QgY29sbGVjdHMgRVRILCBhbmQgaW4gcmV0dXJuIGVtaXRzIFByb2plY3RYIHRva2VucyB0byB0aGUgYmFja2Vycw0KKi8NCmNvbnRyYWN0IENyb3dkc2FsZSBpcyBQYXVzYWJsZSwgUHVsbFBheW1lbnQgew0KICAgIA0KICAgIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50Ow0KICAgIHN0cnVjdCBCYWNrZXIgew0KICAgICAgICB1aW50IHdlaVJlY2VpdmVkOyAvLyBBbW91bnQgb2YgRXRoZXIgZ2l2ZW4NCiAgICAgICAgdWludCBjb2luU2VudDsNCiAgICB9DQogICAgLyoNCiAgICAqIENvbnN0YW50cw0KICAgICovDQogICAgLyogTWluaW11bSBudW1iZXIgb2YgUHJvamVjdFggdG8gc2VsbCAqLw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9DQVAgPSAzMDAwMDAwMDAwMDsgLy8gMzAsMDAwIFByb2plY3RYcw0KICAgIC8qIE1heGltdW0gbnVtYmVyIG9mIFByb2plY3RYIHRvIHNlbGwgKi8NCiAgICB1aW50IHB1YmxpYyBjb25zdGFudCBNQVhfQ0FQID0gNjAwMDAwMDAwMDAwOyAvLyA2MDAsMDAwIFByb2plY3RYcw0KICAgIC8qIE1pbmltdW0gYW1vdW50IHRvIGludmVzdCAqLw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IE1JTl9JTlZFU1RfRVRIRVIgPSAxMDAgZmlubmV5Ow0KICAgIC8qIENyb3dkc2FsZSBwZXJpb2QgKi8NCiAgICB1aW50IHByaXZhdGUgY29uc3RhbnQgQ1JPV0RTQUxFX1BFUklPRCA9IDUgZGF5czsNCiAgICAvKiBOdW1iZXIgb2YgUHJvamVjdFhzIHBlciBFdGhlciAqLw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IENPSU5fUEVSX0VUSEVSID0gMTIwMDAwMDAwMDA7IC8vIDEyLDAwMCBQcm9qZWN0WHMNCiAgICAvKg0KICAgICogVmFyaWFibGVzDQogICAgKi8NCiAgICAvKiBQcm9qZWN0WCBjb250cmFjdCByZWZlcmVuY2UgKi8NCiAgICBQcm9qZWN0WCBwdWJsaWMgY29pbjsNCiAgICAvKiBNdWx0aXNpZyBjb250cmFjdCB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgRXRoZXIgKi8NCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ0V0aGVyOw0KICAgIC8qIE51bWJlciBvZiBFdGhlciByZWNlaXZlZCAqLw0KICAgIHVpbnQgcHVibGljIGV0aGVyUmVjZWl2ZWQ7DQogICAgLyogTnVtYmVyIG9mIFByb2plY3RYcyBzZW50IHRvIEV0aGVyIGNvbnRyaWJ1dG9ycyAqLw0KICAgIHVpbnQgcHVibGljIGNvaW5TZW50VG9FdGhlcjsNCiAgICAvKiBDcm93ZHNhbGUgc3RhcnQgdGltZSAqLw0KICAgIHVpbnQgcHVibGljIHN0YXJ0VGltZTsNCiAgICAvKiBDcm93ZHNhbGUgZW5kIHRpbWUgKi8NCiAgICB1aW50IHB1YmxpYyBlbmRUaW1lOw0KICAgIC8qIElzIGNyb3dkc2FsZSBzdGlsbCBvbiBnb2luZyAqLw0KICAgIGJvb2wgcHVibGljIGNyb3dkc2FsZUNsb3NlZDsNCiAgICAvKiBCYWNrZXJzIEV0aGVyIGluZGV4ZWQgYnkgdGhlaXIgRXRoZXJldW0gYWRkcmVzcyAqLw0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBCYWNrZXIpIHB1YmxpYyBiYWNrZXJzOw0KICAgIC8qDQogICAgKiBNb2RpZmllcnMNCiAgICAqLw0KICAgIG1vZGlmaWVyIG1pbkNhcE5vdFJlYWNoZWQoKSB7DQogICAgICAgIGlmICgobm93IDwgZW5kVGltZSkgfHwgY29pblNlbnRUb0V0aGVyID49IE1JTl9DQVAgKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQogICAgbW9kaWZpZXIgcmVzcGVjdFRpbWVGcmFtZSgpIHsNCiAgICAgICAgaWYgKChub3cgPCBzdGFydFRpbWUpIHx8IChub3cgPiBlbmRUaW1lICkpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCiAgICAvKg0KICAgICAqIEV2ZW50DQogICAgKi8NCiAgICBldmVudCBMb2dSZWNlaXZlZEVUSChhZGRyZXNzIGFkZHIsIHVpbnQgdmFsdWUpOw0KICAgIGV2ZW50IExvZ0NvaW5zRW1pdGVkKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCB1aW50IGFtb3VudCk7DQogICAgLyoNCiAgICAgKiBDb25zdHJ1Y3Rvcg0KICAgICovDQogICAgZnVuY3Rpb24gQ3Jvd2RzYWxlKGFkZHJlc3MgX1Byb2plY3RYLCBhZGRyZXNzIF90bykgew0KICAgICAgICBjb2luID0gUHJvamVjdFgoX1Byb2plY3RYKTsNCiAgICAgICAgbXVsdGlzaWdFdGhlciA9IF90bzsNCiAgICB9DQogICAgLyogDQogICAgICogVGhlIGZhbGxiYWNrIGZ1bmN0aW9uIGNvcnJlc3BvbmRzIHRvIGEgZG9uYXRpb24gaW4gRVRIDQogICAgICovDQogICAgZnVuY3Rpb24oKSBzdG9wSW5FbWVyZ2VuY3kgcmVzcGVjdFRpbWVGcmFtZSBwYXlhYmxlIHsNCiAgICAgICAgcmVjZWl2ZUVUSChtc2cuc2VuZGVyKTsNCiAgICB9DQogICAgLyogDQogICAgICogVG8gY2FsbCB0byBzdGFydCB0aGUgY3Jvd2RzYWxlDQogICAgICovDQogICAgZnVuY3Rpb24gc3RhcnQoKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAoc3RhcnRUaW1lICE9IDApIHRocm93OyAvLyBDcm93ZHNhbGUgd2FzIGFscmVhZHkgc3RhcnRlZA0KICAgICAgICBzdGFydFRpbWUgPSBub3cgOyAgICAgICAgICAgIA0KICAgICAgICBlbmRUaW1lID0gIG5vdyArIENST1dEU0FMRV9QRVJJT0Q7ICAgIA0KICAgIH0NCiAgICAvKg0KICAgICAqICBSZWNlaXZlcyBhIGRvbmF0aW9uIGluIEV0aGVyDQogICAgKi8NCiAgICBmdW5jdGlvbiByZWNlaXZlRVRIKGFkZHJlc3MgYmVuZWZpY2lhcnkpIGludGVybmFsIHsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA8IE1JTl9JTlZFU1RfRVRIRVIpIHRocm93OyAvLyBEb24ndCBhY2NlcHQgZnVuZGluZyB1bmRlciBhIHByZWRlZmluZWQgdGhyZXNob2xkDQogICAgICAgIA0KICAgICAgICB1aW50IGNvaW5Ub1NlbmQgPSBib251cyhtc2cudmFsdWUubXVsKENPSU5fUEVSX0VUSEVSKS5kaXYoMSBldGhlcikpOyAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2YgUHJvamVjdFggdG8gc2VuZA0KICAgICAgICBpZiAoY29pblRvU2VuZC5hZGQoY29pblNlbnRUb0V0aGVyKSA+IE1BWF9DQVApIHRocm93OyAgICANCiAgICAgICAgQmFja2VyIGJhY2tlciA9IGJhY2tlcnNbYmVuZWZpY2lhcnldOw0KICAgICAgICBjb2luLnRyYW5zZmVyKGJlbmVmaWNpYXJ5LCBjb2luVG9TZW5kKTsgLy8gVHJhbnNmZXIgUHJvamVjdFhzIHJpZ2h0IG5vdyANCiAgICAgICAgYmFja2VyLmNvaW5TZW50ID0gYmFja2VyLmNvaW5TZW50LmFkZChjb2luVG9TZW5kKTsNCiAgICAgICAgYmFja2VyLndlaVJlY2VpdmVkID0gYmFja2VyLndlaVJlY2VpdmVkLmFkZChtc2cudmFsdWUpOyAvLyBVcGRhdGUgdGhlIHRvdGFsIHdlaSBjb2xsZWN0ZWQgZHVyaW5nIHRoZSBjcm93ZGZ1bmRpbmcgZm9yIHRoaXMgYmFja2VyICAgIA0KICAgICAgICBldGhlclJlY2VpdmVkID0gZXRoZXJSZWNlaXZlZC5hZGQobXNnLnZhbHVlKTsgLy8gVXBkYXRlIHRoZSB0b3RhbCB3ZWkgY29sbGVjdGVkIGR1cmluZyB0aGUgY3Jvd2RmdW5kaW5nDQogICAgICAgIGNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQoY29pblRvU2VuZCk7DQogICAgICAgIC8vIFNlbmQgZXZlbnRzDQogICAgICAgIExvZ0NvaW5zRW1pdGVkKG1zZy5zZW5kZXIgLGNvaW5Ub1NlbmQpOw0KICAgICAgICBMb2dSZWNlaXZlZEVUSChiZW5lZmljaWFyeSwgZXRoZXJSZWNlaXZlZCk7IA0KICAgIH0NCiAgICANCiAgICAvKg0KICAgICAqQ29tcHV0ZSB0aGUgUHJvamVjdFggYm9udXMgYWNjb3JkaW5nIHRvIHRoZSBpbnZlc3RtZW50IHBlcmlvZA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGJvbnVzKHVpbnQgYW1vdW50KSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIGlmIChub3cgPCBzdGFydFRpbWUuYWRkKDEgZGF5cykpIHJldHVybiBhbW91bnQuYWRkKGFtb3VudC5kaXYoNCkpOyAgIC8vIGJvbnVzIDI1JQ0KICAgICAgICByZXR1cm4gYW1vdW50Ow0KICAgIH0NCiAgICAvKiAgDQogICAgICogRmluYWxpemUgdGhlIGNyb3dkc2FsZSwgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGUgcmVmdW5kIHBlcmlvZA0KICAgICovDQogICAgZnVuY3Rpb24gZmluYWxpemUoKSBvbmx5T3duZXIgcHVibGljIHsNCiAgICAgICAgaWYgKG5vdyA8IGVuZFRpbWUpIHsgLy8gQ2Fubm90IGZpbmFsaXNlIGJlZm9yZSBDUk9XRFNBTEVfUEVSSU9EIG9yIGJlZm9yZSBzZWxsaW5nIGFsbCBjb2lucw0KICAgICAgICAgICAgaWYgKGNvaW5TZW50VG9FdGhlciA9PSBNQVhfQ0FQKSB7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChjb2luU2VudFRvRXRoZXIgPCBNSU5fQ0FQICYmIG5vdyA8IGVuZFRpbWUgKyAzIGRheXMpIHRocm93OyAvLyBJZiBNSU5fQ0FQIGlzIG5vdCByZWFjaGVkIGRvbm9ycyBoYXZlIDE1ZGF5cyB0byBnZXQgcmVmdW5kIGJlZm9yZSB3ZSBjYW4gZmluYWxpc2UNCiAgICAgICAgaWYgKCFtdWx0aXNpZ0V0aGVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7IC8vIE1vdmUgdGhlIHJlbWFpbmluZyBFdGhlciB0byB0aGUgbXVsdGlzaWcgYWRkcmVzcw0KICAgICAgICANCiAgICAgICAgdWludCByZW1haW5zID0gY29pbi5iYWxhbmNlT2YodGhpcyk7DQogICAgICAgIGlmIChyZW1haW5zID4gMCkgeyAvLyBCdXJuIHRoZSByZXN0IG9mIFByb2plY3RYcw0KICAgICAgICAgICAgaWYgKCFjb2luLmJ1cm4ocmVtYWlucykpIHRocm93IDsNCiAgICAgICAgfQ0KICAgICAgICBjcm93ZHNhbGVDbG9zZWQgPSB0cnVlOw0KICAgIH0NCiAgICAvKiAgDQogICAgKiBGYWlsc2FmZSBkcmFpbg0KICAgICovDQogICAgZnVuY3Rpb24gZHJhaW4oKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAoIW93bmVyLnNlbmQodGhpcy5iYWxhbmNlKSkgdGhyb3c7DQogICAgfQ0KICAgIC8qKg0KICAgICAqIEFsbG93IHRvIGNoYW5nZSB0aGUgdGVhbSBtdWx0aXNpZyBhZGRyZXNzIGluIHRoZSBjYXNlIG9mIGVtZXJnZW5jeS4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBzZXRNdWx0aXNpZyhhZGRyZXNzIGFkZHIpIG9ubHlPd25lciBwdWJsaWMgew0KICAgICAgICBpZiAoYWRkciA9PSBhZGRyZXNzKDApKSB0aHJvdzsNCiAgICAgICAgbXVsdGlzaWdFdGhlciA9IGFkZHI7DQogICAgfQ0KICAgIC8qKg0KICAgICAqIE1hbnVhbGx5IGJhY2sgUHJvamVjdFggb3duZXIgYWRkcmVzcy4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBiYWNrUHJvamVjdFhPd25lcigpIG9ubHlPd25lciBwdWJsaWMgew0KICAgICAgICBjb2luLnRyYW5zZmVyT3duZXJzaGlwKG93bmVyKTsNCiAgICB9DQogICAgLyoqDQogICAgICogVHJhbnNmZXIgcmVtYWlucyB0byBvd25lciBpbiBjYXNlIGlmIGltcG9zc2libGUgdG8gZG8gbWluIGludmVzdA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldFJlbWFpbkNvaW5zKCkgb25seU93bmVyIHB1YmxpYyB7DQogICAgICAgIHZhciByZW1haW5zID0gTUFYX0NBUCAtIGNvaW5TZW50VG9FdGhlcjsNCiAgICAgICAgdWludCBtaW5Db2luc1RvU2VsbCA9IGJvbnVzKE1JTl9JTlZFU1RfRVRIRVIubXVsKENPSU5fUEVSX0VUSEVSKSAvICgxIGV0aGVyKSk7DQogICAgICAgIGlmKHJlbWFpbnMgPiBtaW5Db2luc1RvU2VsbCkgdGhyb3c7DQogICAgICAgIEJhY2tlciBiYWNrZXIgPSBiYWNrZXJzW293bmVyXTsNCiAgICAgICAgY29pbi50cmFuc2Zlcihvd25lciwgcmVtYWlucyk7IC8vIFRyYW5zZmVyIFByb2plY3RYcyByaWdodCBub3cgDQogICAgICAgIGJhY2tlci5jb2luU2VudCA9IGJhY2tlci5jb2luU2VudC5hZGQocmVtYWlucyk7DQogICAgICAgIGNvaW5TZW50VG9FdGhlciA9IGNvaW5TZW50VG9FdGhlci5hZGQocmVtYWlucyk7DQogICAgICAgIC8vIFNlbmQgZXZlbnRzDQogICAgICAgIExvZ0NvaW5zRW1pdGVkKHRoaXMgLHJlbWFpbnMpOw0KICAgICAgICBMb2dSZWNlaXZlZEVUSChvd25lciwgZXRoZXJSZWNlaXZlZCk7IA0KICAgIH0NCiAgICAvKiANCiAgICAgKiBXaGVuIE1JTl9DQVAgaXMgbm90IHJlYWNoOg0KICAgICAqIDEpIGJhY2tlciBjYWxsIHRoZSAiYXBwcm92ZSIgZnVuY3Rpb24gb2YgdGhlIFByb2plY3RYIHRva2VuIGNvbnRyYWN0IHdpdGggdGhlIGFtb3VudCBvZiBhbGwgUHJvamVjdFhzIHRoZXkgZ290IGluIG9yZGVyIHRvIGJlIHJlZnVuZA0KICAgICAqIDIpIGJhY2tlciBjYWxsIHRoZSAicmVmdW5kIiBmdW5jdGlvbiBvZiB0aGUgQ3Jvd2RzYWxlIGNvbnRyYWN0IHdpdGggdGhlIHNhbWUgYW1vdW50IG9mIFByb2plY3RYcw0KICAgICAqIDMpIGJhY2tlciBjYWxsIHRoZSAid2l0aGRyYXdQYXltZW50cyIgZnVuY3Rpb24gb2YgdGhlIENyb3dkc2FsZSBjb250cmFjdCB0byBnZXQgYSByZWZ1bmQgaW4gRVRIDQogICAgICovDQogICAgZnVuY3Rpb24gcmVmdW5kKHVpbnQgX3ZhbHVlKSBtaW5DYXBOb3RSZWFjaGVkIHB1YmxpYyB7DQogICAgICAgIA0KICAgICAgICBpZiAoX3ZhbHVlICE9IGJhY2tlcnNbbXNnLnNlbmRlcl0uY29pblNlbnQpIHRocm93OyAvLyBjb21wYXJlIHZhbHVlIGZyb20gYmFja2VyIGJhbGFuY2UNCiAgICAgICAgY29pbi50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgYWRkcmVzcyh0aGlzKSwgX3ZhbHVlKTsgLy8gZ2V0IHRoZSB0b2tlbiBiYWNrIHRvIHRoZSBjcm93ZHNhbGUgY29udHJhY3QNCiAgICAgICAgaWYgKCFjb2luLmJ1cm4oX3ZhbHVlKSkgdGhyb3cgOyAvLyB0b2tlbiBzZW50IGZvciByZWZ1bmQgYXJlIGJ1cm50DQogICAgICAgIHVpbnQgRVRIVG9TZW5kID0gYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZDsNCiAgICAgICAgYmFja2Vyc1ttc2cuc2VuZGVyXS53ZWlSZWNlaXZlZD0wOw0KICAgICAgICBpZiAoRVRIVG9TZW5kID4gMCkgew0KICAgICAgICAgICAgYXN5bmNTZW5kKG1zZy5zZW5kZXIsIEVUSFRvU2VuZCk7IC8vIHB1bGwgcGF5bWVudCB0byBnZXQgcmVmdW5kIGluIEVUSA0KICAgICAgICB9DQogICAgfQ0KfQ=='