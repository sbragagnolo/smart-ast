base 64 content
base64registrar
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLyogRXRoYXJ0IFJlZ2lzdHJhciBDb250cmFjdDoNCg0KCWh0dHBzOi8vZXRoYXJ0LmNvbSAtIFRoZSBFdGhlcmV1bSBBcnQgTmV0d29yaw0KDQoJRXRoYXJ0IEFSQ0hJVEVDVFVSRQ0KCS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJCQkJCV9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fDQoJCQkJCQlWCQkJCQkJCQkJCVYNCglDb250cm9sbGVyIC0tPiBSZWdpc3RyYXIgPC0tPiBGYWN0b3J5IENvbnRyYWN0MSAtLT4gQXJ0d29yayBDb250cmFjdDENCgkJCQkJCQkJICBGYWN0b3J5IENvbnRyYWN0MgkgICAgQXJ0d29yayBDb250cmFjdDINCgkJCQkJCQkJICAJCS4uLgkJCQkJLi4uDQoJCQkJCQkJCSAgRmFjdG9yeSBDb250cmFjdE4JICAgIEFydHdvcmsgQ29udHJhY3RODQoNCglDb250cm9sbGVyOiBUaGUgY29udHJvbGxlciBjb250cmFjdCBpcyB0aGUgb3duZXIgb2YgdGhlIFJlZ2lzdHJhciBjb250cmFjdCBhbmQgY2FuDQoJCS0gU2V0IGEgbmV3IG93bmVyDQoJCS0gQ29udHJvbCB0aGUgYXNzZXRzIG9mIHRoZSBSZWdpc3RyYXIgKHdpdGhkcmF3IEVUSCwgdHJhbnNmZXIsIHNlbGwsIGJ1cm4gcGllY2VzIG93bmVkIGJ5IHRoZSBSZWdpc3RyYXIpDQoJCS0gVGhlIHBsYW4gaXMgdG8gaGF2ZSB0aGUgY29udHJvbGxlciBjb250cmFjdCBiZSBhIERBTyBpbiBwcmVwYXJhdGlvbiBmb3IgYSBwb3NzaWJsZSBJQ08NCgkNCglSZWdpc3RyYXI6DQoJCS0gVGhlIFJlZ2lzdHJhciBjb250cmFjdCBhY3RzIGFzIHRoZSBjZW50cmFsIHJlZ2lzdHJ5IGZvciBhbGwgc2hhMjU2IGhhc2hlcyBpbiB0aGUgRXRoYXJ0IGZhY3RvcnkgY29udHJhY3QgbmV0d29yay4NCgkJLSBBcHByb3ZlZCBGYWN0b3J5IENvbnRyYWN0cyBjYW4gcmVnaXN0ZXIgc2hhMjU2IGhhc2hlcyB1c2luZyB0aGUgUmVnaXN0cmFyIGludGVyZmFjZS4NCgkJLSBldGhhcnRBcnRSZXdhcmQgb2YgdGhlIGFydCBwcm9kdWNlZCBhbmQgZXRoYXJ0UmV2ZW51ZVJld2FyZCBvZiB0dXJub3ZlciBvZiB0aGUgY29udHJhY3QgbmV0d29yayB3aWxsIGJlIGF3YXJkZWQgdG8gdGhlIFJlZ2lzdHJhci4NCgkNCglGYWN0b3J5IENvbnRyYWN0czoNCgkJLSBGYWN0b3J5IENvbnRyYWN0cyBjYW4gc3Bhd24gQXJ0d29yayBDb250cmFjdHMgaW4gbGluZSB3aXRoIGFydGlzdHMgc3BlY2lmaWNhdGlvbnMNCgkJLSBGYWN0b3J5IENvbnRyYWN0cyB3aWxsIG9ubHkgc3Bhd24gQXJ0d29yayBDb250cmFjdHMgd2hvJ3Mgc2hhMjU2IGhhc2hlcyBhcmUgdW5pcXVlIHBlciB0aGUgUmVnaXN0cmFyJ3Mgc2hhMjU2IHJlZ2lzdHJ5DQoJCS0gRmFjdG9yeSBDb250cmFjdHMgd2lsbCByZWdpc3RlciBldmVyeSBuZXcgQXJ0d29yayBDb250cmFjdCB3aXRoIGl0J3MgZGV0YWlscyB3aXRoIHRoZSBSZWdpc3RyYXIgY29udHJhY3QNCgkNCglBcnR3b3JrIENvbnRyYWN0czoNCgkJLSBBcnR3b3JrIENvbnRyYWN0cyBhY3QgYXMgbWluaW1hbGlzdCBkZWNlbnRyYWxpc2VkIGV4Y2hhbmdlcyBmb3IgdGhlaXIgcGllY2VzIGluIGxpbmUgd2l0aCBzcGVjaWZpZWQgY29uZGl0aW9ucw0KCQktIEFydHdvcmsgQ29udHJhY3RzIHdpbGwgaW50ZXJhY3Qgd2l0aCB0aGUgUmVnaXN0cmFyIHRvIGlzc3VlIGJ1eWVycyBvZiBwaWVjZXMgYSBwcmVkZXRlcm1pbmVkIGFtb3VudCBvZiBQYXRyb24gdG9rZW5zIGJhc2VkIG9uIHRoZSB0cmFuc2FjdGlvbiB2YWx1ZSANCgkJLSBBcnR3b3JrIENvbnRyYWN0cyBjYW4gYmUgaW50ZXJhY3RlZCB3aXRoIGJ5IHRoZSBDb250cm9sbGVyIHZpYSB0aGUgUmVnaXN0cmFyIHVzaW5nIHRoZWlyIGludGVyZmFjZXMgdG8gdHJhbnNmZXIsIHNlbGwsIGJ1cm4gZXRjIHBpZWNlcw0KCQ0KCShjKSBTdGVmYW4gUGVybmFyIDIwMTcgLSBhbGwgcmlnaHRzIHJlc2VydmVkDQoJKGMpIEVSQzIwIGZ1bmN0aW9ucyBCb2treVBvb0JhaCAyMDE3LiBUaGUgTUlUIExpY2VuY2UuDQoqLw0KDQpjb250cmFjdCBJbnRlcmZhY2Ugew0KDQoJLy8gRXRoYXJ0IG5ldHdvcmsgaW50ZXJmYWNlDQoJZnVuY3Rpb24gcmVnaXN0ZXJBcnR3b3JrIChhZGRyZXNzIF9jb250cmFjdCwgYnl0ZXMzMiBfU0hBMjU2SGFzaCwgdWludDI1NiBfZWRpdGlvblNpemUsIHN0cmluZyBfdGl0bGUsIHN0cmluZyBfZmlsZUxpbmssIHVpbnQyNTYgX293bmVyQ29tbWlzc2lvbiwgYWRkcmVzcyBfYXJ0aXN0LCBib29sIF9pbmRleGVkLCBib29sIF9vdXJvYm9yb3MpOw0KCWZ1bmN0aW9uIGlzU0hBMjU2SGFzaFJlZ2lzdGVyZWQgKGJ5dGVzMzIgX1NIQTI1Nkhhc2gpIHJldHVybnMgKGJvb2wgX3JlZ2lzdGVyZWQpOwkJCS8vIENoZWNrIGlmIGEgc2hhMjU2IGhhc2ggaXMgcmVnaXN0ZXJlZA0KCWZ1bmN0aW9uIGlzRmFjdG9yeUFwcHJvdmVkIChhZGRyZXNzIF9mYWN0b3J5KSByZXR1cm5zIChib29sIF9hcHByb3ZlZCk7CQkJCQkJLy8gQ2hlY2sgaWYgYW4gYWRkcmVzcyBpcyBhIHJlZ2lzdGVyZWQgZmFjdG9yeSBjb250cmFjdA0KCWZ1bmN0aW9uIGlzc3VlUGF0cm9ucyAoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCk7CQkJCQkJCQkJCS8vIElzc3VlcyBQYXRyb24gdG9rZW5zIGFjY29yZGluZyB0byBjb25kaXRpb25zIHNwZWNpZmllZCBpbiBmYWN0b3J5IGNvbnRyYWN0cw0KCWZ1bmN0aW9uIGFwcHJvdmVGYWN0b3J5Q29udHJhY3QgKGFkZHJlc3MgX2ZhY3RvcnlDb250cmFjdEFkZHJlc3MsIGJvb2wgX2FwcHJvdmVkKTsJCQkvLyBBcHByb3Zlcy9kaXNhcHByb3ZlcyBmYWN0b3J5IGNvbnRyYWN0cy4NCglmdW5jdGlvbiBjaGFuZ2VPd25lciAoYWRkcmVzcyBuZXdPd25lcik7CQkJCQkJCQkJCQkJCS8vIENoYW5nZSB0aGUgcmVnaXN0cmFyJ3Mgb3duZXIuDQoNCglmdW5jdGlvbiBvZmZlclBpZWNlRm9yU2FsZUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QsIHVpbnQyNTYgX3ByaWNlKTsJCQkJCS8vIFNlbGwgYSBwaWVjZSBvd25lZCBieSB0aGUgcmVnaXN0cmFyLg0KCWZ1bmN0aW9uIG9mZmVyUGllY2VGb3JTYWxlICh1aW50MjU2IF9wcmljZSk7DQoJZnVuY3Rpb24gZmlsbEJpZEJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QpOwkJCQkJCQkJCQkJCS8vIEZpbGwgYSBiaWQgd2l0aCBhbiB1bmluZGV4ZWQgcGllY2Ugb3duZWQgYnkgdGhlIHJlZ2lzdHJhcg0KCWZ1bmN0aW9uIGZpbGxCaWQoKTsNCglmdW5jdGlvbiBjYW5jZWxTYWxlQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCk7CQkJCQkJCQkJCQkvLyBDYW5jZWwgdGhlIHNhbGUgb2YgYW4gdW5pbmRleGVkIHBpZWNlIG93bmVkIGJ5IHRoZSByZWdpc3RyYXINCglmdW5jdGlvbiBjYW5jZWxTYWxlKCk7DQoJZnVuY3Rpb24gb2ZmZXJJbmRleGVkUGllY2VGb3JTYWxlQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfaW5kZXgsIHVpbnQyNTYgX3ByaWNlKTsJCQkJLy8gU2VsbCBhbiBpbmRleGVkIHBpZWNlIG93bmVkIGJ5IHRoZSByZWdpc3RyYXIuDQoJZnVuY3Rpb24gb2ZmZXJJbmRleGVkUGllY2VGb3JTYWxlKHVpbnQyNTYgX2luZGV4LCB1aW50MjU2IF9wcmljZSk7DQoJZnVuY3Rpb24gZmlsbEluZGV4ZWRCaWRCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9pbmRleCk7CQkJCQkJLy8gRmlsbCBhIGJpZCB3aXRoIGFuIGluZGV4ZWQgcGllY2Ugb3duZWQgYnkgdGhlIHJlZ2lzdHJhcg0KCWZ1bmN0aW9uIGZpbGxJbmRleGVkQmlkICh1aW50MjU2IF9pbmRleCk7DQoJZnVuY3Rpb24gY2FuY2VsSW5kZXhlZFNhbGVCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0KTsJCQkJCQkJCQkvLyBDYW5jZWwgdGhlIHNhbGUgb2YgYW4gdW5pbmRleGVkIHBpZWNlIG93bmVkIGJ5IHRoZSByZWdpc3RyYXINCglmdW5jdGlvbiBjYW5jZWxJbmRleGVkU2FsZSgpOw0KDQoJZnVuY3Rpb24gdHJhbnNmZXJCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9hbW91bnQsIGFkZHJlc3MgX3RvKTsJCQkJLy8gVHJhbnNmZXJzIHVuaW5kZXhlZCBwaWVjZXMgb3duZWQgYnkgdGhlIHJlZ2lzdHJhciBjb250cmFjdA0KCWZ1bmN0aW9uIHRyYW5zZmVySW5kZXhlZEJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QsIHVpbnQyNTYgX2luZGV4LCBhZGRyZXNzIF90byk7CQkJLy8gVHJhbnNmZXJzIGluZGV4ZWQgcGllY2VzIG93bmVkIGJ5IHRoZSByZWdpc3RyYXIgY29udHJhY3QNCglmdW5jdGlvbiBhcHByb3ZlQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KTsJCQkvLyBTZXRzIGFuIGFsbG93YW5jZSBmb3IgdW5pbmRleGVkIHBpZWNlcyBvd25lZCBieSB0aGUgcmVnaXN0cmFyIGNvbnRyYWN0DQoJZnVuY3Rpb24gYXBwcm92ZUluZGV4ZWRCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9pbmRleCk7CQkvLyBTZXRzIGFuIGFsbG93YW5jZSBmb3IgaW5kZXhlZCBwaWVjZXMgb3duZWQgYnkgdGhlIHJlZ2lzdHJhciBjb250cmFjdA0KCWZ1bmN0aW9uIGJ1cm5CeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9hbW91bnQpOwkJCQkJCQkJLy8gQnVybiBhbiB1bmluZGV4ZWQgcGllY2Ugb3duZWQgYnkgdGhlIHJlZ2lzdHJhciBjb250cmFjdA0KCWZ1bmN0aW9uIGJ1cm5Gcm9tQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfYW1vdW50LCBhZGRyZXNzIF9mcm9tKTsJCQkJLy8gQnVybiBhbiB1bmluZGV4ZWQgcGllY2Ugb3duZWQgYnkgYW5ub3RoZXIgYWRkcmVzcw0KCWZ1bmN0aW9uIGJ1cm5JbmRleGVkQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfaW5kZXgpOwkJCQkJCQkvLyBCdXJuIGFuIGluZGV4ZWQgcGllY2Ugb3duZWQgYnkgdGhlIHJlZ2lzdHJhciBjb250cmFjdA0KCWZ1bmN0aW9uIGJ1cm5JbmRleGVkRnJvbUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QsIGFkZHJlc3MgX2Zyb20sIHVpbnQyNTYgX2luZGV4KTsJCS8vIEJ1cm4gYW4gaW5kZXhlZCBwaWVjZSBvd25lZCBieSBhbm90aGVyIGFkZHJlc3MNCg0KCS8vIEVSQzIwIGludGVyZmFjZQ0KCWZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFN1cHBseSk7CQkJCQkJCQkJLy8gUmV0dXJucyB0aGUgdG90YWwgc3VwcGx5IG9mIGFuIGFydHdvcmsgb3IgdG9rZW4NCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7CQkJCQkJCS8vIFJldHVybnMgYW4gYWRkcmVzcycgYmFsYW5jZSBvZiBhbiBhcnR3b3JrIG9yIHRva2VuDQogCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsJCQkJCQkJLy8gVHJhbnNmZXJzIHBpZWNlcyBvZiBhcnQgb3IgdG9rZW5zIHRvIGFuIGFkZHJlc3MNCiAJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsJCS8vIFRyYW5zZmVycyBwaWVjZXMgb2YgYXJ0IG9mIHRva2VucyBvd25lZCBieSBhbm90aGVyIGFkZHJlc3MgdG8gYW4gYWRkcmVzcw0KCWZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CQkJCQkJLy8gU2V0cyBhbiBhbGxvd2FuY2UgZm9yIGFuIGFkZHJlc3MNCglmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsJCS8vIFJldHVybnMgdGhlIGFsbG93YW5jZSBvZiBhbiBhZGRyZXNzIGZvciBhbm90aGVyIGFkZHJlc3MNCg0KCS8vIEFkZGl0aW9uYWwgdG9rZW4gZnVuY3Rpb25zDQoJZnVuY3Rpb24gYnVybih1aW50MjU2IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CQkJCQkJCQkJCS8vIEJ1cm5zIChyZW1vdmVzIGZyb20gY2lyY3VsYXRpb24pIHVuaW5kZXhlZCBwaWVjZXMgb2YgYXJ0IG9yIHRva2Vucy4NCgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCS8vIEluIHRoZSBjYXNlIG9mICdvdXJvYm9yb3MnIHBpZWNlcyB0aGlzIGZ1bmN0aW9uIGFsc28gcmV0dXJucyB0aGUgcGllY2Uncw0KCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJLy8gY29tcG9uZW50cyB0byB0aGUgbWVzc2FnZSBzZW5kZXINCgkNCglmdW5jdGlvbiBidXJuRnJvbShhZGRyZXNzIF9mcm9tLCB1aW50MjU2IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CQkJCQkvLyBCdXJucyAocmVtb3ZlcyBmcm9tIGNpcmN1bGF0aW9uKSB1bmluZGV4ZWQgcGllY2VzIG9mIGFydCBvciB0b2tlbnMNCgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCS8vIG93bmVkIGJ5IGFub3RoZXIgYWRkcmVzcy4gSW4gdGhlIGNhc2Ugb2YgJ291cm9ib3JvcycgcGllY2VzIHRoaXMNCgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCS8vIGZ1bmN0aW9uIGFsc28gcmV0dXJucyB0aGUgcGllY2UncyBjb21wb25lbnRzIHRvIHRoZSBtZXNzYWdlIHNlbmRlcg0KCQ0KCS8vIEV4dGVuZGVkIEVSQzIwIGludGVyZmFjZSBmb3IgaW5kZXhlZCBwaWVjZXMNCglmdW5jdGlvbiB0cmFuc2ZlckluZGV4ZWQgKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9faW5kZXgpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7CQkJCS8vIFRyYW5zZmVycyBhbiBpbmRleGVkIHBpZWNlIG9mIGFydA0KCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbUluZGV4ZWQgKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9pbmRleCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsJLy8gVHJhbnNmZXJzIGFuIGluZGV4ZWQgcGllY2Ugb2YgYXJ0IGZyb20gYW5vdGhlciBhZGRyZXNzDQoJZnVuY3Rpb24gYXBwcm92ZUluZGV4ZWQgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX2luZGV4KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOwkJCS8vIFNldHMgYW4gYWxsb3dhbmNlIGZvciBhbiBpbmRleGVkIHBpZWNlIG9mIGFydCBmb3IgYW5vdGhlciBhZGRyZXNzDQoJZnVuY3Rpb24gYnVybkluZGV4ZWQgKHVpbnQyNTYgX2luZGV4KTsJCQkJCQkJCQkJCQkJCS8vIEJ1cm5zIChyZW1vdmVzIGZyb20gY2lyY3VsYXRpb24pIGluZGV4ZWQgcGllY2VzIG9mIGFydCBvciB0b2tlbnMuDQoJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkvLyBJbiB0aGUgY2FzZSBvZiAnb3Vyb2Jvcm9zJyBwaWVjZXMgdGhpcyBmdW5jdGlvbiBhbHNvIHJldHVybnMgdGhlDQoJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkvLyBwaWVjZSdzIGNvbXBvbmVudHMgdG8gdGhlIG1lc3NhZ2Ugc2VuZGVyDQoJDQoJZnVuY3Rpb24gYnVybkluZGV4ZWRGcm9tIChhZGRyZXNzIF9vd25lciwgdWludDI1NiBfaW5kZXgpOwkJCQkJCQkJCS8vIEJ1cm5zIChyZW1vdmVzIGZyb20gY2lyY3VsYXRpb24pIGluZGV4ZWQgcGllY2VzIG9mIGFydCBvciB0b2tlbnMNCgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCS8vIG93bmVkIGJ5IGFub3RoZXIgYWRkcmVzcy4gSW4gdGhlIGNhc2Ugb2YgJ291cm9ib3JvcycgcGllY2VzIHRoaXMNCgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCS8vIGZ1bmN0aW9uIGFsc28gcmV0dXJucyB0aGUgcGllY2UncyBjb21wb25lbnRzIHRvIHRoZSBtZXNzYWdlIHNlbmRlcg0KDQp9DQoNCmNvbnRyYWN0IFJlZ2lzdHJhciB7DQoNCgkvLyBQYXRyb24gdG9rZW4gRVJDMjAgcHVibGljIHZhcmlhYmxlcw0KCXN0cmluZyBwdWJsaWMgY29uc3RhbnQgc3ltYm9sID0gIkFSVCI7DQoJc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lID0gIlBhdHJvbiAtIEV0aGFydCBOZXR3b3JrIFRva2VuIjsNCgl1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsNCgl1aW50MjU2IF90b3RhbFBhdHJvblN1cHBseTsNCg0KCWV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCglldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQoJZXZlbnQgQnVybihhZGRyZXNzIGluZGV4ZWQgX293bmVyLCB1aW50MjU2IF9hbW91bnQpOw0KDQogICAgLy8gUGF0cm9uIHRva2VuIGJhbGFuY2VzIGZvciBlYWNoIGFjY291bnQNCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VzOwkJCQkJCS8vIFBhdHJvbiB0b2tlbiBiYWxhbmNlcw0KDQoJZXZlbnQgTmV3QXJ0d29yayhhZGRyZXNzIF9jb250cmFjdCwgYnl0ZXMzMiBfU0hBMjU2SGFzaCwgdWludDI1NiBfZWRpdGlvblNpemUsIHN0cmluZyBfdGl0bGUsIHN0cmluZyBfZmlsZUxpbmssIHVpbnQyNTYgX293bmVyQ29tbWlzc2lvbiwgYWRkcmVzcyBfYXJ0aXN0LCBib29sIF9pbmRleGVkLCBib29sIF9vdXJvYm9yb3MpOw0KDQoJLy8gT3duZXIgb2YgYWNjb3VudCBhcHByb3ZlcyB0aGUgdHJhbnNmZXIgb2YgYW4gYW1vdW50IG9mIFBhdHJvbiB0b2tlbnMgdG8gYW5vdGhlciBhY2NvdW50DQoJbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikpIGFsbG93ZWQ7CQkJLy8gUGF0cm9uIHRva2VuIGFsbG93YW5jZXMNCgkNCgkvLyBNaXRpZ2F0aW5nIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrcyAoaHR0cDovL3Zlc3NlbmVzLmNvbS90aGUtZXJjMjAtc2hvcnQtYWRkcmVzcy1hdHRhY2stZXhwbGFpbmVkLykNCgltb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKQ0KCXsNCgkJcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOw0KCQlfOw0KCX0NCgkNCgkvLyBCRUdJTiBFUkMyMCBmdW5jdGlvbnMgKGMpIEJva2t5UG9vQmFoIDIwMTcuIFRoZSBNSVQgTGljZW5jZS4NCg0KCWZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFBhdHJvblN1cHBseSkgew0KCQl0b3RhbFBhdHJvblN1cHBseSA9IF90b3RhbFBhdHJvblN1cHBseTsNCgkJfQ0KDQoJLy8gV2hhdCBpcyB0aGUgYmFsYW5jZSBvZiBhIHBhcnRpY3VsYXIgYWNjb3VudD8NCglmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KIAkJcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQoJCX0NCg0KCS8vIFRyYW5zZmVyIHRoZSBiYWxhbmNlIGZyb20gb3duZXIncyBhY2NvdW50IHRvIGFub3RoZXIgYWNjb3VudA0KCWZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KCQlpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCANCgkJCSYmIF9hbW91bnQgPiAwDQogCQkgICAJJiYgYmFsYW5jZXNbX3RvXSArIF9hbW91bnQgPiBiYWxhbmNlc1tfdG9dDQoJCQkmJiBfdG8gIT0gMHgwKQkJCQkJCQkJCQkvLyB1c2UgYnVybigpIGluc3RlYWQNCgkJCXsNCgkJCWJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF9hbW91bnQ7DQoJCQliYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7DQoJCQlUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF9hbW91bnQpOw0KIAkJICAgCXJldHVybiB0cnVlOw0KCQkJfQ0KCQkJZWxzZSB7IHJldHVybiBmYWxzZTt9DQogCQkgfQ0KDQoJLy8gU2VuZCBfdmFsdWUgYW1vdW50IG9mIHRva2VucyBmcm9tIGFkZHJlc3MgX2Zyb20gdG8gYWRkcmVzcyBfdG8NCgkvLyBUaGUgdHJhbnNmZXJGcm9tIG1ldGhvZCBpcyB1c2VkIGZvciBhIHdpdGhkcmF3IHdvcmtmbG93LCBhbGxvd2luZyBjb250cmFjdHMgdG8gc2VuZA0KIAkvLyB0b2tlbnMgb24geW91ciBiZWhhbGYsIGZvciBleGFtcGxlIHRvICJkZXBvc2l0IiB0byBhIGNvbnRyYWN0IGFkZHJlc3MgYW5kL29yIHRvIGNoYXJnZQ0KIAkvLyBmZWVzIGluIHN1Yi1jdXJyZW5jaWVzOyB0aGUgY29tbWFuZCBzaG91bGQgZmFpbCB1bmxlc3MgdGhlIF9mcm9tIGFjY291bnQgaGFzDQogCS8vIGRlbGliZXJhdGVseSBhdXRob3Jpc2VkIHRoZSBzZW5kZXIgb2YgdGhlIG1lc3NhZ2UgdmlhIHNvbWUgbWVjaGFuaXNtOyB3ZSBwcm9wb3NlDQogCS8vIHRoZXNlIHN0YW5kYXJkaXNlZCBBUElzIGZvciBhcHByb3ZhbDoNCiAJZnVuY3Rpb24gdHJhbnNmZXJGcm9tKCBhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfYW1vdW50KSBvbmx5UGF5bG9hZFNpemUoMyAqIDMyKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpDQoJCXsNCgkJCWlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX2Ftb3VudA0KCQkJCSYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQNCgkJCQkmJiBfYW1vdW50ID4gMA0KCQkJCSYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXQ0KCQkJCSYmIF90byAhPSAweDApCQkJCQkJCQkJCS8vIHVzZSBidXJuKCkgaW5zdGVhZA0KCQkJCQl7DQoJCQkJCWJhbGFuY2VzW19mcm9tXSAtPSBfYW1vdW50Ow0KCQkJCQlhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfYW1vdW50Ow0KCQkJCQliYWxhbmNlc1tfdG9dICs9IF9hbW91bnQ7DQoJCQkJCVRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOw0KCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQkJfSBlbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCQl9DQoNCgkvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50Lg0KCS8vIElmIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluIGl0IG92ZXJ3cml0ZXMgdGhlIGN1cnJlbnQgYWxsb3dhbmNlIHdpdGggX3ZhbHVlLg0KCS8vIFRvIGJlIGV4dHJhIHNlY3VyZSBzZXQgYWxsb3dhbmNlIHRvIDAgYW5kIGNoZWNrIHRoYXQgbm9uZSBvZiB0aGUgYWxsb3dhbmNlIHdhcyBzcGVuZCBiZXR3ZWVuIHlvdSBzZW5kaW5nIHRoZSB0eCBhbmQgaXQgZ2V0dGluZyBtaW5lZC4gT25seSB0aGVuIGRlY3JlYXNlL2luY3JlYXNlIHRoZSBhbGxvd2FuY2UuDQoJLy8gU2VlIGh0dHBzOi8vZG9jcy5nb29nbGUuY29tL2RvY3VtZW50L2QvMVlMUHRReFp1MVVBdk85Y1oxTzJSUFhCYlQwbW9vaDREWUtqQV9qcC1STE0vZWRpdCNoZWFkaW5nPWgubTlmaHF5bncyeHZ0DQoJZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KCQlhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF9hbW91bnQ7DQoJCUFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfYW1vdW50KTsNCgkJcmV0dXJuIHRydWU7DQoJCX0NCg0KCWZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCgkJcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQoJCX0NCg0KCS8vIEVORCBFUkMyMCBmdW5jdGlvbnMgKGMpIEJva2t5UG9vQmFoIDIwMTcuIFRoZSBNSVQgTGljZW5jZS4NCgkNCgkvLyBBZGRpdGlvbmFsIFBhdHJvbiB0b2tlbiBmdW5jdGlvbnMNCgkNCglmdW5jdGlvbiBidXJuKHVpbnQyNTYgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQoJCQlpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudCkgew0KCQkJCWJhbGFuY2VzW21zZy5zZW5kZXJdIC09IF9hbW91bnQ7DQoJCQkJX3RvdGFsUGF0cm9uU3VwcGx5IC09IF9hbW91bnQ7DQoJCQkJQnVybihtc2cuc2VuZGVyLCBfYW1vdW50KTsNCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0NCgkJCWVsc2Uge3Rocm93O30NCgkJfQ0KDQoJZnVuY3Rpb24gYnVybkZyb20oYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KCQlpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUpIHsNCgkJCWJhbGFuY2VzW19mcm9tXSAtPSBfdmFsdWU7DQoJCQlhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQoJCQlfdG90YWxQYXRyb25TdXBwbHkgLT0gX3ZhbHVlOw0KCQkJQnVybihfZnJvbSwgX3ZhbHVlKTsNCgkJCXJldHVybiB0cnVlOw0KCQl9DQoJCWVsc2Uge3Rocm93O30NCgl9DQoNCgkvLyBCRUdJTiBzYWZlIG1hdGggZnVuY3Rpb25zIGJ5IE9wZW4gWmVwcGVsaW4NCgkvLyBodHRwczovL2dpdGh1Yi5jb20vT3BlblplcHBlbGluL3plcHBlbGluLXNvbGlkaXR5L2Jsb2IvbWFzdGVyL2NvbnRyYWN0cy9tYXRoL1NhZmVNYXRoLnNvbA0KDQoJZnVuY3Rpb24gbXVsKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQoJCXVpbnQyNTYgYyA9IGEgKiBiOw0KCQlhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KCQlyZXR1cm4gYzsNCgl9DQoNCglmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCgkJLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwDQoJCXVpbnQyNTYgYyA9IGEgLyBiOw0KCQkvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZA0KCQlyZXR1cm4gYzsNCgl9DQoNCglmdW5jdGlvbiBzdWIodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCgkJYXNzZXJ0KGIgPD0gYSk7DQoJCXJldHVybiBhIC0gYjsNCgl9DQoNCglmdW5jdGlvbiBhZGQodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCgkJdWludDI1NiBjID0gYSArIGI7DQoJCWFzc2VydChjID49IGEpOw0KCQlyZXR1cm4gYzsNCgl9DQoNCgkvLyBFTkQgc2FmZSBtYXRoIGZ1bmN0aW9ucyBieSBPcGVuIFplcHBlbGluDQoNCgkvLyBFdGhhcnQgdmFyaWFibGVzDQoJDQoJLy8gUmVnaXN0ZXIgb2YgYWxsIFNIQTI1NiBIYXNoZXMNCiAgICBtYXBwaW5nIChieXRlczMyID0+IGFkZHJlc3MpIHB1YmxpYyBTSEEyNTZIYXNoUmVnaXN0ZXI7DQoJDQoJLy8gUmVnaXN0ZXIgb2YgYWxsIGFwcHJvdmVkIGZhY3RvcnkgY29udHJhY3RzDQoJbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYXBwcm92ZWRGYWN0b3JpZXM7DQoJDQoJLy8gUmVnaXN0ZXIgb2YgYWxsIGFwcHJvdmVkIGFydHdvcmsgY29udHJhY3RzDQoJDQoJLy8gUmVnaXN0ZXIgb2YgYWxsIGFwcHJvdmVkIGNvbnRyYWN0cyBmb3IgYW1lbmRpbmcgcGVuZGluZyB3aXRoZHJhd2FscyBhbmQgaXNzdWluZyBQYXRyb24gdG9rZW5zDQoJbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBwdWJsaWMgYXBwcm92ZWRDb250cmFjdHM7DQoJDQoJLy8gUmVnaXN0ZXIgb2YgYWxsIHJlZmVycmVycyAocmVmZXJlZSA9PiByZWZlcnJlcikgdXNlZCBmb3IgdGhlIGFmZmlsaWF0ZSBwcm9ncmFtDQoJbWFwcGluZyAoYWRkcmVzcyA9PiBhZGRyZXNzKSBwdWJsaWMgcmVmZXJyZWQ7DQoJDQoJLy8gUmVmZXJyZXIgZm9yIGFuIGFydGlzdCBoYXMgdG8gYmUgc2V0IF9iZWZvcmVfIHRoZSBmaXJzdCBwaWVjZSBoYXMgYmVlbiBjcmVhdGVkIGJ5IGFuIGFkZHJlc3MNCgltYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIHB1YmxpYyBjYW50U2V0UmVmZXJyZXI7DQoNCgkvLyBSZWdpc3RlciBvZiBhbGwgYXJ0d29ya3MgYW5kIHRoZWlyIGRldGFpbHMgYnkgdGhlaXIgcmVzcGVjdGl2ZSBhZGRyZXNzZXMNCglzdHJ1Y3QgYXJ0d29yayB7DQoJCWJ5dGVzMzIgU0hBMjU2SGFzaDsNCgkJdWludDI1NiBlZGl0aW9uU2l6ZTsNCgkJc3RyaW5nIHRpdGxlOw0KCQlzdHJpbmcgZmlsZUxpbms7DQoJCXVpbnQyNTYgb3duZXJDb21taXNzaW9uOw0KCQlhZGRyZXNzIGFydGlzdDsNCgkJYWRkcmVzcyBmYWN0b3J5Ow0KCQlib29sIGlzSW5kZXhlZDsNCgkJYm9vbCBpc091cm9ib3Jvczt9DQoJDQoJbWFwcGluZyAoYWRkcmVzcyA9PiBhcnR3b3JrKSBwdWJsaWMgYXJ0d29ya1JlZ2lzdGVyOw0KDQoJLy8gQW4gaW5kZXhlZCByZWdpc3RlciBvZiBhbGwgb2YgYW4gYXJ0aXN0J3MgYXJ0d29ya3MNCg0KCS8vIEVudGVyIGFydGlzdCBhZGRyZXNzIGFuZCBhIHJ1bm5pbmcgbnVtYmVyIHRvIGdldCB0aGUgYXJ0aXN0J3MgYXJ0d29yayBhZGRyZXNzZXMNCgltYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyAodWludDI1NiA9PiBhZGRyZXNzKSkgcHVibGljIGFydGlzdHNBcnR3b3JrczsNCg0KCS8vIEEgcnVubmluZyBudW1iZXIgY291bnRpbmcgYW4gYXJ0aXN0J3MgYXJ0d29ya3MNCgltYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGFydGlzdHNBcnR3b3JrQ291bnQ7CQkJCQkJDQoNCgkvLyBLZWVwcyB0cmFjayBvZiB0aGUgbnVtYmVyIG9mIGFydHdvcmsgY29udHJhY3RzIGluIHRoZSBuZXR3b3JrDQoJdWludDI1NiBwdWJsaWMgYXJ0d29ya0NvdW50Ow0KDQoJLy8gQW4gaW5kZXggb2YgYWxsIHRoZSBhcnR3b3JrIGNvbnRyYWN0cyBpbiB0aGUgbmV0d29yaw0KCW1hcHBpbmcgKHVpbnQyNTYgPT4gYWRkcmVzcykgcHVibGljIGFydHdvcmtJbmRleDsNCg0KCS8vIEFsbCBwZW5kaW5nIHdpdGhkcmF3YWxzDQoJbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgcGVuZGluZ1dpdGhkcmF3YWxzOw0KCXVpbnQyNTYgcHVibGljIHRvdGFsUGVuZGluZ1dpdGhkcmF3YWxzOw0KDQoJLy8gVGhlIGFkZHJlc3Mgb2YgdGhlIFJlZ2lzdHJhcidzIG93bmVyDQoJYWRkcmVzcyBwdWJsaWMgb3duZXI7DQoJDQoJLy8gRGV0ZXJtaW5lcyBob3cgbWFueSBQYXRyb25zIGFyZSBpc3N1ZXMgcGVyIGRvbmF0aW9uDQoJdWludDI1NiBwdWJsaWMgZG9uYXRpb25NdWx0aXBsaWVyOw0KCQ0KCS8vIERldGVybWluZXMgaG93IG1hbnkgUGF0cm9ucyBhcmUgaXNzdWVzIHBlciBwdXJjaGFzZSBvZiBhbiBhcnR3b3JrIGluIGJhc2lzIHBvaW50cyAoMTAsMDAwID0gMTAwJSkNCgl1aW50MjU2IHB1YmxpYyBwYXRyb25SZXdhcmRNdWx0aXBsaWVyOw0KCQ0KCS8vIERldGVybWluZXMgaG93IG11Y2ggRXRoYXJ0IGlzIGVudGl0bGVkIHRvIGFydHdvcmtzL3JldmVudWUgcGVyY2VudGFnZXMgaW4gYmFzaXMgcG9pbnRzICgxMCwwMDAgPSAxMDAlKQ0KCXVpbnQyNTYgcHVibGljIGV0aGFydFJldmVudWVSZXdhcmQ7DQoJdWludDI1NiBwdWJsaWMgZXRoYXJ0QXJ0UmV3YXJkOw0KCQ0KCS8vIERldGVybWluZXMgaG93IG11Y2ggb2YgYSBwZXJjZW50YWdlIGEgcmVmZXJyZXIgZ2V0IG9mIGV0aGFydFJldmVudWVSZXdhcmQNCgl1aW50MjU2IHB1YmxpYyByZWZlcnJlclJld2FyZDsNCg0KCS8vIEZ1bmN0aW9ucyB3aXRoIHRoaXMgbW9kaWZpZXIgY2FuIG9ubHkgYmUgZXhlY3V0ZWQgYnkgYSBzcGVjaWZpYyBhZGRyZXNzDQoJbW9kaWZpZXIgb25seUJ5IChhZGRyZXNzIF9hY2NvdW50KQ0KCXsNCgkJcmVxdWlyZShtc2cuc2VuZGVyID09IF9hY2NvdW50KTsNCgkJXzsNCgkJfQ0KDQoJLy8gRnVuY3Rpb25zIHdpdGggdGhpcyBtb2RpZmllciBjYW4gb25seSBiZSBleGVjdXRlZCBieSBhcHByb3ZlZCBmYWN0b3J5IGNvbnRyYWN0cw0KCW1vZGlmaWVyIHJlZ2lzdGVyZWRGYWN0b3JpZXNPbmx5ICgpDQoJew0KCQlyZXF1aXJlKGFwcHJvdmVkRmFjdG9yaWVzW21zZy5zZW5kZXJdKTsNCgkJXzsNCgl9DQoNCgkvLyBGdW5jdGlvbnMgd2l0aCB0aGlzIG1vZGlmaWVyIGNhbiBvbmx5IGJlIGV4ZWN1dGVkIGJ5IGFwcHJvdmVkIGNvbnRyYWN0cw0KCW1vZGlmaWVyIGFwcHJvdmVkQ29udHJhY3RzT25seSAoKQ0KCXsNCgkJcmVxdWlyZShhcHByb3ZlZENvbnRyYWN0c1ttc2cuc2VuZGVyXSk7DQoJCV87DQoJfQ0KDQoJLy8gU2V0IHRoZSByZWZlcnJlciBvZiBhbiBhcnRpc3QuIFRoaXMgaGFzIHRvIGJlIGRvbmUgYmVmb3JlIGFuIGFydGlzdCBjcmVhdGVzIHRoZWlyIGZpcnN0IGFydHdvcmsuDQoJZnVuY3Rpb24gc2V0UmVmZXJyZXIgKGFkZHJlc3MgX3JlZmVycmVyKQ0KCQl7DQoJCQlpZiAocmVmZXJyZWRbbXNnLnNlbmRlcl0gPT0gMHgwICYmICFjYW50U2V0UmVmZXJyZXJbbXNnLnNlbmRlcl0gJiYgX3JlZmVycmVyICE9IG1zZy5zZW5kZXIpDQoJCQl7DQoJCQkJcmVmZXJyZWRbbXNnLnNlbmRlcl0gPSBfcmVmZXJyZXI7DQoJCQl9DQoJCX0NCg0KCWZ1bmN0aW9uIGdldFJlZmVycmVyIChhZGRyZXNzIF9hcnRpc3QpIHJldHVybnMgKGFkZHJlc3MgX3JlZmVycmVyKQ0KCQl7DQoJCQlyZXR1cm4gcmVmZXJyZWRbX2FydGlzdF07DQoJCX0NCgkNCglmdW5jdGlvbiBzZXRSZWZlcnJlclJld2FyZCAodWludDI1NiBfcmVmZXJyZXJSZXdhcmQpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCXVpbnQgYTsNCgkJCWlmIChfcmVmZXJyZXJSZXdhcmQgPiAxMDAwMCAtIGV0aGFydFJldmVudWVSZXdhcmQpIHt0aHJvdzt9DQoJCQlhID0gMTAwMDAgLyBfcmVmZXJyZXJSZXdhcmQ7DQoJCQkvLyAxMDAwMCAvIF9yZWZlcnJlclJld2FyZCBoYXMgdG8gYmUgYW4gZXZlbiBudW1iZXINCgkJCWlmIChhICogX3JlZmVycmVyUmV3YXJkICE9IDEwMDAwKSB7dGhyb3c7fQ0KCQkJcmVmZXJyZXJSZXdhcmQgPSBfcmVmZXJyZXJSZXdhcmQ7DQoJCX0NCgkNCglmdW5jdGlvbiBnZXRSZWZlcnJlclJld2FyZCAoKSByZXR1cm5zICh1aW50MjU2IF9yZWZlcnJlclJld2FyZCkNCgkJew0KCQkJcmV0dXJuIHJlZmVycmVyUmV3YXJkOw0KCQl9DQoNCgkvLyBDb25zdHJ1Y3Rvcg0KCWZ1bmN0aW9uIFJlZ2lzdHJhciAoKSB7DQoJCW93bmVyID0gbXNnLnNlbmRlcjsNCgkJDQoJCS8vIERvbm9ycyByZWNlaXZlIDEwMCBQYXRyb25zIHBlciAxIHdlaSBkb25hdGlvbg0KCQlkb25hdGlvbk11bHRpcGxpZXIgPSAxMDA7DQoJCQ0KCQkvLyBQYXRyb25zIHJlY2VpdmUgMi41IFBhdHJvbnMgKDI1LDAwMCBiYXNpcyBwb2ludHMpIHBlciAxIHdlaSBwdXJjaGFzZXMNCgkJcGF0cm9uUmV3YXJkTXVsdGlwbGllciA9IDI1MDAwOw0KCQkNCgkJLy8gRXRoYXJ0IHJlY2VpdmVzIDIuNSUgb2YgcmV2ZW51ZXMgYW5kIGFydHdvcmsncyBlZGl0aW9uIHNpemVzDQoJCWV0aGFydFJldmVudWVSZXdhcmQgPSAyNTA7DQoJCWV0aGFydEFydFJld2FyZCA9IDI1MDsNCgkJDQoJCS8vIEZvciBiYWxhbmNlZCBmaWd1cmVzIHBhdHJvblJld2FyZE11bHRpcGxpZXIgLyBkb25hdGlvbk11bHRpcGxpZXIgPD0gZXRoYXJ0UmV2ZW51ZVJld2FyZA0KCQkNCgkJLy8gUmVmZXJyZXJzIHJlY2VpdmUgMTAlIG9mIGV0aGFydFJldmVudWVSZXdhcmQNCgkJcmVmZXJyZXJSZXdhcmQgPSAxMDAwOw0KCX0NCg0KCWZ1bmN0aW9uIHNldFBhdHJvblJld2FyZCAodWludDI1NiBfZG9uYXRpb25NdWx0aXBsaWVyKSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQlkb25hdGlvbk11bHRpcGxpZXIgPSBfZG9uYXRpb25NdWx0aXBsaWVyOw0KCQkJcGF0cm9uUmV3YXJkTXVsdGlwbGllciA9IGV0aGFydFJldmVudWVSZXdhcmQgKiBfZG9uYXRpb25NdWx0aXBsaWVyOw0KCQkJaWYgKHBhdHJvblJld2FyZE11bHRpcGxpZXIgLyBkb25hdGlvbk11bHRpcGxpZXIgPiBldGhhcnRSZXZlbnVlUmV3YXJkKSB7dGhyb3c7fQ0KCQl9DQoNCglmdW5jdGlvbiBzZXRFdGhhcnRSZXZlbnVlUmV3YXJkICh1aW50MjU2IF9ldGhhcnRSZXZlbnVlUmV3YXJkKSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQl1aW50MjU2IGE7DQoJCQkvLyBFdGhhcnQgcmV2ZW51ZSByZXdhcmQgY2FuIG5ldmVyIGJlIGdyZWF0ZXIgdGhhbiAxMCUNCgkJCWlmIChfZXRoYXJ0UmV2ZW51ZVJld2FyZCA+MTAwMCkge3Rocm93O30NCgkJCWEgPSAxMDAwMCAvIF9ldGhhcnRSZXZlbnVlUmV3YXJkOw0KCQkJLy8gU2hvdWxkIDEwMDAwIC8gX2V0aGFydFJldmVudWVSZXdhcmQgbm90IGJlIGV2ZW4gdGhyb3cNCgkJCWlmIChhICogX2V0aGFydFJldmVudWVSZXdhcmQgPCAxMDAwMCkge3Rocm93O30NCgkJCWV0aGFydFJldmVudWVSZXdhcmQgPSBfZXRoYXJ0UmV2ZW51ZVJld2FyZDsNCgkJfQ0KCQ0KCWZ1bmN0aW9uIGdldEV0aGFydFJldmVudWVSZXdhcmQgKCkgcmV0dXJucyAodWludDI1NiBfZXRoYXJ0UmV2ZW51ZVJld2FyZCkNCgkJew0KCQkJcmV0dXJuIGV0aGFydFJldmVudWVSZXdhcmQ7DQoJCX0NCg0KCWZ1bmN0aW9uIHNldEV0aGFydEFydFJld2FyZCAodWludDI1NiBfZXRoYXJ0QXJ0UmV3YXJkKSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQl1aW50MjU2IGE7DQoJCQkvLyBFdGhhcnQgYXJ0IHJld2FyZCBjYW4gbmV2ZXIgYmUgZ3JlYXRlciB0aGFuIDEwJQ0KCQkJaWYgKF9ldGhhcnRBcnRSZXdhcmQgPjEwMDApIHt0aHJvdzt9DQoJCQlhID0gMTAwMDAgLyBfZXRoYXJ0QXJ0UmV3YXJkOw0KCQkJLy8gU2hvdWxkIDEwMDAwIC8gX2V0aGFydEFydFJld2FyZCBub3QgYmUgZXZlbiB0aHJvdw0KCQkJaWYgKGEgKiBfZXRoYXJ0QXJ0UmV3YXJkIDwgMTAwMDApIHt0aHJvdzt9DQoJCQlldGhhcnRBcnRSZXdhcmQgPSBfZXRoYXJ0QXJ0UmV3YXJkOw0KCQl9DQoNCglmdW5jdGlvbiBnZXRFdGhhcnRBcnRSZXdhcmQgKCkgcmV0dXJucyAodWludDI1NiBfZXRoYXJ0QXJ0UmV3YXJkKQ0KCQl7DQoJCQlyZXR1cm4gZXRoYXJ0QXJ0UmV3YXJkOw0KCQl9DQoNCgkvLyBBbGxvd3MgdGhlIGN1cnJlbnQgb3duZXIgdG8gYXNzaWduIGEgbmV3IG93bmVyDQoJZnVuY3Rpb24gY2hhbmdlT3duZXIgKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlCeSAob3duZXIpIA0KCQl7DQoJCQlvd25lciA9IG5ld093bmVyOw0KCQl9DQoNCgkvLyBBbGxvd3MgYXBwcm92ZWQgY29udHJhY3RzIHRvIGlzc3VlIFBhdHJvbiB0b2tlbnMNCglmdW5jdGlvbiBpc3N1ZVBhdHJvbnMgKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIGFwcHJvdmVkQ29udHJhY3RzT25seQ0KCQl7DQoJCQliYWxhbmNlc1tfdG9dICs9IF9hbW91bnQgLyAxMDAwMCAqIHBhdHJvblJld2FyZE11bHRpcGxpZXI7DQoJCQlfdG90YWxQYXRyb25TdXBwbHkgKz0gX2Ftb3VudCAvIDEwMDAwICogcGF0cm9uUmV3YXJkTXVsdGlwbGllcjsNCgkJfQ0KDQoJLy8gQ2hhbmdlIHRoZSBhbW91bnQgb2YgUGF0cm9uIHRva2VucyBhIGRvbm9yIHJlY2VpdmVzDQoJZnVuY3Rpb24gc2V0RG9uYXRpb25SZXdhcmQgKHVpbnQyNTYgX211bHRpcGxpZXIpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCWRvbmF0aW9uTXVsdGlwbGllciA9IF9tdWx0aXBsaWVyOw0KCQl9DQoNCgkvLyBSZWNlaXZlIFBhdHJvbiB0b2tlbnMgaW4gcmV0dXJucyBmb3IgZG9uYXRpb25zDQoJLy8gTm90IGdvaW5nIHRvIHdvcnJ5IGFib3V0IGEgdGhlb3JldGljYWwgSW50ZWdlciBvdmVyZmxvdyBoZXJlLg0KCWZ1bmN0aW9uIGRvbmF0ZSAoKSBwYXlhYmxlDQoJCXsNCgkJCWJhbGFuY2VzW21zZy5zZW5kZXJdICs9IG1zZy52YWx1ZSAqIGRvbmF0aW9uTXVsdGlwbGllcjsNCgkJCV90b3RhbFBhdHJvblN1cHBseSArPSBtc2cudmFsdWUgKiBkb25hdGlvbk11bHRpcGxpZXI7DQoJCQlhc3luY1NlbmQodGhpcywgbXNnLnZhbHVlKTsNCgkJfQ0KDQoJZnVuY3Rpb24gcmVnaXN0ZXJBcnR3b3JrIChhZGRyZXNzIF9jb250cmFjdCwgYnl0ZXMzMiBfU0hBMjU2SGFzaCwgdWludDI1NiBfZWRpdGlvblNpemUsIHN0cmluZyBfdGl0bGUsIHN0cmluZyBfZmlsZUxpbmssIHVpbnQyNTYgX293bmVyQ29tbWlzc2lvbiwgYWRkcmVzcyBfYXJ0aXN0LCBib29sIF9pbmRleGVkLCBib29sIF9vdXJvYm9yb3MpIHJlZ2lzdGVyZWRGYWN0b3JpZXNPbmx5DQoJCXsNCgkJaWYgKFNIQTI1Nkhhc2hSZWdpc3RlcltfU0hBMjU2SGFzaF0gPT0gMHgwKSB7DQoJCSAgIAlTSEEyNTZIYXNoUmVnaXN0ZXJbX1NIQTI1Nkhhc2hdID0gX2NvbnRyYWN0Ow0KCQkJYXBwcm92ZWRDb250cmFjdHNbX2NvbnRyYWN0XSA9IHRydWU7DQoJCQljYW50U2V0UmVmZXJyZXJbX2FydGlzdF0gPSB0cnVlOw0KCQkJYXJ0d29ya1JlZ2lzdGVyW19jb250cmFjdF0uU0hBMjU2SGFzaCA9IF9TSEEyNTZIYXNoOw0KCQkJYXJ0d29ya1JlZ2lzdGVyW19jb250cmFjdF0uZWRpdGlvblNpemUgPSBfZWRpdGlvblNpemU7DQoJCQlhcnR3b3JrUmVnaXN0ZXJbX2NvbnRyYWN0XS50aXRsZSA9IF90aXRsZTsNCgkJCWFydHdvcmtSZWdpc3RlcltfY29udHJhY3RdLmZpbGVMaW5rID0gX2ZpbGVMaW5rOw0KCQkJYXJ0d29ya1JlZ2lzdGVyW19jb250cmFjdF0ub3duZXJDb21taXNzaW9uID0gX293bmVyQ29tbWlzc2lvbjsNCgkJCWFydHdvcmtSZWdpc3RlcltfY29udHJhY3RdLmFydGlzdCA9IF9hcnRpc3Q7DQoJCQlhcnR3b3JrUmVnaXN0ZXJbX2NvbnRyYWN0XS5mYWN0b3J5ID0gbXNnLnNlbmRlcjsNCgkJCWFydHdvcmtSZWdpc3RlcltfY29udHJhY3RdLmlzSW5kZXhlZCA9IF9pbmRleGVkOw0KCQkJYXJ0d29ya1JlZ2lzdGVyW19jb250cmFjdF0uaXNPdXJvYm9yb3MgPSBfb3Vyb2Jvcm9zOw0KCQkJYXJ0d29ya0luZGV4W2FydHdvcmtDb3VudF0gPSBfY29udHJhY3Q7DQoJCQlhcnRpc3RzQXJ0d29ya3NbX2FydGlzdF1bYXJ0aXN0c0FydHdvcmtDb3VudFtfYXJ0aXN0XV0gPSBfY29udHJhY3Q7DQoJCQlhcnRpc3RzQXJ0d29ya0NvdW50W19hcnRpc3RdKys7DQoJCQlOZXdBcnR3b3JrIChfY29udHJhY3QsIF9TSEEyNTZIYXNoLCBfZWRpdGlvblNpemUsIF90aXRsZSwgX2ZpbGVMaW5rLCBfb3duZXJDb21taXNzaW9uLCBfYXJ0aXN0LCBfaW5kZXhlZCwgX291cm9ib3Jvcyk7DQoJCQlhcnR3b3JrQ291bnQrKzsNCgkJCX0NCgkJCWVsc2Uge3Rocm93O30NCgkJfQ0KDQoJLy8gQ2hlY2sgaWYgYSBzcGVjaWZpYyBzaGEyNTYgaGFzaCBoYXMgYmVlbiB1c2VkIGJ5IGFub3RoZXIgYXJ0d29yayBiZWZvcmUNCglmdW5jdGlvbiBpc1NIQTI1Nkhhc2hSZWdpc3RlcmVkIChieXRlczMyIF9TSEEyNTZIYXNoKSByZXR1cm5zIChib29sIF9yZWdpc3RlcmVkKQ0KCQl7DQoJCWlmIChTSEEyNTZIYXNoUmVnaXN0ZXJbX1NIQTI1Nkhhc2hdID09IDB4MCkNCgkJCXtyZXR1cm4gZmFsc2U7fQ0KCQllbHNlIHtyZXR1cm4gdHJ1ZTt9DQoJCX0NCg0KCS8vIEFwcHJvdmUgZmFjdG9yeSBjb250cmFjdHMNCglmdW5jdGlvbiBhcHByb3ZlRmFjdG9yeUNvbnRyYWN0IChhZGRyZXNzIF9mYWN0b3J5Q29udHJhY3RBZGRyZXNzLCBib29sIF9hcHByb3ZlZCkgb25seUJ5IChvd25lcikNCgkJew0KCQkJYXBwcm92ZWRGYWN0b3JpZXNbX2ZhY3RvcnlDb250cmFjdEFkZHJlc3NdID0gX2FwcHJvdmVkOw0KCQl9DQoJDQoJLy8gT3BlbiBaZXBwZWxpbiBhc3luY1NlbmQgZnVuY3Rpb24gZm9yIHB1bGwgcGF5bWVudHMNCglmdW5jdGlvbiBhc3luY1NlbmQgKGFkZHJlc3MgX3BheWVlLCB1aW50MjU2IF9hbW91bnQpIGFwcHJvdmVkQ29udHJhY3RzT25seQ0KCQl7DQoJCQlwZW5kaW5nV2l0aGRyYXdhbHNbX3BheWVlXSA9IGFkZChwZW5kaW5nV2l0aGRyYXdhbHNbX3BheWVlXSwgX2Ftb3VudCk7DQoJCQl0b3RhbFBlbmRpbmdXaXRoZHJhd2FscyA9IGFkZCh0b3RhbFBlbmRpbmdXaXRoZHJhd2FscywgX2Ftb3VudCk7DQoJCX0NCg0KCWZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudHNSZWdpc3RyYXIgKGFkZHJlc3MgX2Rlc3QsIHVpbnQyNTYgX3BheW1lbnQpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCWlmIChfcGF5bWVudCA9PSAwKSB7DQoJCQkJdGhyb3c7DQoJCQl9DQoNCgkJCWlmICh0aGlzLmJhbGFuY2UgPCBfcGF5bWVudCkgew0KCQkJCXRocm93Ow0KCQkJfQ0KCQkJDQoJCQl0b3RhbFBlbmRpbmdXaXRoZHJhd2FscyA9IHN1Yih0b3RhbFBlbmRpbmdXaXRoZHJhd2FscywgX3BheW1lbnQpOw0KCQkJcGVuZGluZ1dpdGhkcmF3YWxzW3RoaXNdID0gc3ViKHBlbmRpbmdXaXRoZHJhd2Fsc1t0aGlzXSwgX3BheW1lbnQpOw0KDQoJCQlpZiAoIV9kZXN0LnNlbmQoX3BheW1lbnQpKSB7DQoJCQkJdGhyb3c7DQoJCQl9DQoJCX0NCg0KCWZ1bmN0aW9uIHdpdGhkcmF3UGF5bWVudHMoKSB7DQoJCWFkZHJlc3MgcGF5ZWUgPSBtc2cuc2VuZGVyOw0KCQl1aW50MjU2IHBheW1lbnQgPSBwZW5kaW5nV2l0aGRyYXdhbHNbcGF5ZWVdOw0KDQoJCWlmIChwYXltZW50ID09IDApIHsNCgkJCXRocm93Ow0KCQl9DQoNCgkJaWYgKHRoaXMuYmFsYW5jZSA8IHBheW1lbnQpIHsNCgkJCXRocm93Ow0KCQl9DQoNCgkJdG90YWxQZW5kaW5nV2l0aGRyYXdhbHMgPSBzdWIodG90YWxQZW5kaW5nV2l0aGRyYXdhbHMsIHBheW1lbnQpOw0KCQlwZW5kaW5nV2l0aGRyYXdhbHNbcGF5ZWVdID0gMDsNCg0KCQlpZiAoIXBheWVlLnNlbmQocGF5bWVudCkpIHsNCgkJCXRocm93Ow0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gdHJhbnNmZXJCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9hbW91bnQsIGFkZHJlc3MgX3RvKSBvbmx5QnkgKG93bmVyKSANCgkJew0KCQkJSW50ZXJmYWNlIGMgPSBJbnRlcmZhY2UoX2NvbnRyYWN0KTsNCgkJCWMudHJhbnNmZXIoX3RvLCBfYW1vdW50KTsNCgkJfQ0KDQoJZnVuY3Rpb24gdHJhbnNmZXJJbmRleGVkQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfaW5kZXgsIGFkZHJlc3MgX3RvKSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQlJbnRlcmZhY2UgYyA9IEludGVyZmFjZShfY29udHJhY3QpOw0KCQkJYy50cmFuc2ZlckluZGV4ZWQoX3RvLCBfaW5kZXgpOw0KCQl9DQoNCglmdW5jdGlvbiBhcHByb3ZlQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQlJbnRlcmZhY2UgYyA9IEludGVyZmFjZShfY29udHJhY3QpOw0KCQkJYy5hcHByb3ZlKF9zcGVuZGVyLCBfYW1vdW50KTsNCgkJfQkNCg0KCWZ1bmN0aW9uIGFwcHJvdmVJbmRleGVkQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfaW5kZXgpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCUludGVyZmFjZSBjID0gSW50ZXJmYWNlKF9jb250cmFjdCk7DQoJCQljLmFwcHJvdmVJbmRleGVkKF9zcGVuZGVyLCBfaW5kZXgpOw0KCQl9DQoNCglmdW5jdGlvbiBidXJuQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfYW1vdW50KSBvbmx5QnkgKG93bmVyKQ0KCQl7DQoJCQlJbnRlcmZhY2UgYyA9IEludGVyZmFjZShfY29udHJhY3QpOw0KCQkJYy5idXJuKF9hbW91bnQpOw0KCQl9DQoNCglmdW5jdGlvbiBidXJuRnJvbUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QsIHVpbnQyNTYgX2Ftb3VudCwgYWRkcmVzcyBfZnJvbSkgb25seUJ5IChvd25lcikNCgkJew0KCQkJSW50ZXJmYWNlIGMgPSBJbnRlcmZhY2UoX2NvbnRyYWN0KTsNCgkJCWMuYnVybkZyb20gKF9mcm9tLCBfYW1vdW50KTsNCgkJfQ0KDQoJZnVuY3Rpb24gYnVybkluZGV4ZWRCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9pbmRleCkgb25seUJ5IChvd25lcikNCgkJew0KCQkJSW50ZXJmYWNlIGMgPSBJbnRlcmZhY2UoX2NvbnRyYWN0KTsNCgkJCWMuYnVybkluZGV4ZWQoX2luZGV4KTsNCgkJfQ0KDQoJZnVuY3Rpb24gYnVybkluZGV4ZWRGcm9tQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfaW5kZXgpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCUludGVyZmFjZSBjID0gSW50ZXJmYWNlKF9jb250cmFjdCk7DQoJCQljLmJ1cm5JbmRleGVkRnJvbShfZnJvbSwgX2luZGV4KTsNCgkJfQ0KDQoJZnVuY3Rpb24gb2ZmZXJQaWVjZUZvclNhbGVCeUFkZHJlc3MgKGFkZHJlc3MgX2NvbnRyYWN0LCB1aW50MjU2IF9wcmljZSkgb25seUJ5IChvd25lcikNCgkJew0KCQkJSW50ZXJmYWNlIGMgPSBJbnRlcmZhY2UoX2NvbnRyYWN0KTsNCgkJCWMub2ZmZXJQaWVjZUZvclNhbGUoX3ByaWNlKTsNCgkJfQ0KDQoJLy8gRmlsbCBhIGJpZCB3aXRoIGFuIHVuaW5kZXhlZCBwaWVjZSBvd25lZCBieSB0aGUgcmVnaXN0cmFyDQoJZnVuY3Rpb24gZmlsbEJpZEJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCUludGVyZmFjZSBjID0gSW50ZXJmYWNlKF9jb250cmFjdCk7DQoJCQljLmZpbGxCaWQoKTsNCgkJfQ0KDQoJLy8gQ2FuY2VsIHRoZSBzYWxlIG9mIGFuIHVuaW5kZXhlZCBwaWVjZSBvd25lZCBieSB0aGUgcmVnaXN0cmFyDQoJZnVuY3Rpb24gY2FuY2VsU2FsZUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QpIG9ubHlCeSAob3duZXIpCQ0KCQl7DQoJCQlJbnRlcmZhY2UgYyA9IEludGVyZmFjZShfY29udHJhY3QpOw0KCQkJYy5jYW5jZWxTYWxlKCk7DQoJCX0NCg0KCS8vIFNlbGwgYW4gaW5kZXhlZCBwaWVjZSBvd25lZCBieSB0aGUgcmVnaXN0cmFyLg0KCWZ1bmN0aW9uIG9mZmVySW5kZXhlZFBpZWNlRm9yU2FsZUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QsIHVpbnQyNTYgX2luZGV4LCB1aW50MjU2IF9wcmljZSkgb25seUJ5IChvd25lcikNCgkJew0KCQkJSW50ZXJmYWNlIGMgPSBJbnRlcmZhY2UoX2NvbnRyYWN0KTsNCgkJCWMub2ZmZXJJbmRleGVkUGllY2VGb3JTYWxlKF9pbmRleCwgX3ByaWNlKTsNCgkJfQ0KDQoJLy8gRmlsbCBhIGJpZCB3aXRoIGFuIGluZGV4ZWQgcGllY2Ugb3duZWQgYnkgdGhlIHJlZ2lzdHJhcg0KCWZ1bmN0aW9uIGZpbGxJbmRleGVkQmlkQnlBZGRyZXNzIChhZGRyZXNzIF9jb250cmFjdCwgdWludDI1NiBfaW5kZXgpIG9ubHlCeSAob3duZXIpCQ0KCQl7DQoJCQlJbnRlcmZhY2UgYyA9IEludGVyZmFjZShfY29udHJhY3QpOw0KCQkJYy5maWxsSW5kZXhlZEJpZChfaW5kZXgpOw0KCQl9DQoNCgkvLyBDYW5jZWwgdGhlIHNhbGUgb2YgYW4gdW5pbmRleGVkIHBpZWNlIG93bmVkIGJ5IHRoZSByZWdpc3RyYXINCglmdW5jdGlvbiBjYW5jZWxJbmRleGVkU2FsZUJ5QWRkcmVzcyAoYWRkcmVzcyBfY29udHJhY3QpIG9ubHlCeSAob3duZXIpDQoJCXsNCgkJCUludGVyZmFjZSBjID0gSW50ZXJmYWNlKF9jb250cmFjdCk7DQoJCQljLmNhbmNlbEluZGV4ZWRTYWxlKCk7DQoJCX0NCgkNCgkvLyB1c2UgZG9uYXRlICgpIGZvciBkb25hdGlvbnMgYW5kIHlvdSB3aWxsIGdldCBkb25hdGlvbk11bHRpcGxpZXIgKiB5b3VyIGRvbmF0aW9uIGluIFBhdHJvbiB0b2tlbnMuIFlheSENCglmdW5jdGlvbigpIHBheWFibGUNCgkJew0KCQkJaWYgKCFhcHByb3ZlZENvbnRyYWN0c1ttc2cuc2VuZGVyXSkge3Rocm93O30NCgkJfQ0KfQ=='