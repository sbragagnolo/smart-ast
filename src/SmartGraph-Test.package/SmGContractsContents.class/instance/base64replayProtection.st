base 64 content
base64replayProtection
	^'Y29udHJhY3QgVG9rZW4geyANCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KfQ0KDQovLyByZXBsYXkgcHJvdGVjdGlvbg0KY29udHJhY3QgUmVwbGF5UHJvdGVjdGlvbiB7DQogICAgYm9vbCBwdWJsaWMgaXNNYWluQ2hhaW47DQoNCiAgICBmdW5jdGlvbiBSZXBsYXlQcm90ZWN0aW9uKCkgew0KICAgICAgICBieXRlczMyIGJsb2NrSGFzaCA9IDB4Y2Y5MDU1YzY0OGIzNjg5YTJiNzRlOTgwZmM2ZmEyNzgxNzYyMmZhOWFjMDc0OWQ2MGE2NDg5YTdmYmNmZTgzMTsNCiAgICAgICAgLy8gY3JlYXRlcyBhIHVuaXF1ZSBzaWduYXR1cmUgd2l0aCB0aGUgbGF0ZXN0IDE2IGJsb2Nrcw0KICAgICAgICBmb3IgKHVpbnQgaSA9IDE7IGkgPCA2NDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoYmxvY2tIYXNoID09IGJsb2NrLmJsb2NraGFzaChibG9jay5udW1iZXIgLSBpKSkgaXNNYWluQ2hhaW4gPSB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gU3BsaXRzIHRoZSBmdW5kcyBpbnRvIDIgYWRkcmVzc2VzDQogICAgZnVuY3Rpb24gZXRoZXJTcGxpdChhZGRyZXNzIHJlY2lwaWVudCwgYWRkcmVzcyBhbHRDaGFpblJlY2lwaWVudCkgcmV0dXJucyhib29sKSB7DQogICAgICAgIGlmIChpc01haW5DaGFpbiAmJiByZWNpcGllbnQuc2VuZChtc2cudmFsdWUpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIGlmICghaXNNYWluQ2hhaW4gJiYgYWx0Q2hhaW5SZWNpcGllbnQgPiAwICYmIGFsdENoYWluUmVjaXBpZW50LnNlbmQobXNnLnZhbHVlKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgdGhyb3c7IC8vIGRvbid0IGFjY2VwdCB2YWx1ZSB0cmFuc2Zlciwgb3RoZXJ3aXNlIGl0IHdvdWxkIGJlIHRyYXBwZWQuDQogICAgfQ0KDQoNCiAgICBmdW5jdGlvbiB0b2tlblNwbGl0KGFkZHJlc3MgcmVjaXBpZW50LCBhZGRyZXNzIGFsdENoYWluUmVjaXBpZW50LCBhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludCBhbW91bnQpIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgaWYgKG1zZy52YWx1ZSA+IDAgKSB0aHJvdzsNCg0KICAgICAgICBUb2tlbiB0b2tlbiA9IFRva2VuKHRva2VuQWRkcmVzcyk7DQoNCiAgICAgICAgaWYgKGlzTWFpbkNoYWluICYmIHRva2VuLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCByZWNpcGllbnQsIGFtb3VudCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2UgaWYgKCFpc01haW5DaGFpbiAmJiBhbHRDaGFpblJlY2lwaWVudCA+IDAgJiYgdG9rZW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFsdENoYWluUmVjaXBpZW50LCBhbW91bnQpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiAoKSB7DQogICAgICAgIHRocm93Ow0KICAgIH0NCn0='