base 64 content
base64rexToken1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3QgRVJDMjBCYXNpYyB7DQogIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQp9DQoNCmNvbnRyYWN0IEVSQzIwIGlzIEVSQzIwQmFzaWMgew0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludDI1NiB2YWx1ZSk7DQp9DQoNCmNvbnRyYWN0IEZpbmFsaXphYmxlVG9rZW4gew0KICAgIGJvb2wgcHVibGljIGlzRmluYWxpemVkID0gZmFsc2U7DQp9DQoNCmNvbnRyYWN0IEJhc2ljVG9rZW4gaXMgRmluYWxpemFibGVUb2tlbiwgRVJDMjBCYXNpYyB7DQogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50MjU2Ow0KDQogIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCg0KICAvKioNCiAgKiBAZGV2IHRyYW5zZmVyIHRva2VuIGZvciBhIHNwZWNpZmllZCBhZGRyZXNzDQogICogQHBhcmFtIF90byBUaGUgYWRkcmVzcyB0byB0cmFuc2ZlciB0by4NCiAgKiBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgdG8gYmUgdHJhbnNmZXJyZWQuDQogICovDQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgew0KICAgIGlmICghaXNGaW5hbGl6ZWQpIHJldmVydCgpOw0KDQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBiYWxhbmNlc1ttc2cuc2VuZGVyXS5zdWIoX3ZhbHVlKTsNCiAgICBiYWxhbmNlc1tfdG9dID0gYmFsYW5jZXNbX3RvXS5hZGQoX3ZhbHVlKTsNCiAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogIH0NCg0KICAvKioNCiAgKiBAZGV2IEdldHMgdGhlIGJhbGFuY2Ugb2YgdGhlIHNwZWNpZmllZCBhZGRyZXNzLg0KICAqIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdG8gcXVlcnkgdGhlIHRoZSBiYWxhbmNlIG9mLiANCiAgKiBAcmV0dXJuIEFuIHVpbnQyNTYgcmVwcmVzZW50aW5nIHRoZSBhbW91bnQgb3duZWQgYnkgdGhlIHBhc3NlZCBhZGRyZXNzLg0KICAqLw0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSkgew0KICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICB9DQoNCn0NCg0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBFUkMyMCwgQmFzaWNUb2tlbiB7DQoNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQoNCiAgLyoqDQogICAqIEBkZXYgVHJhbnNmZXIgdG9rZW5zIGZyb20gb25lIGFkZHJlc3MgdG8gYW5vdGhlcg0KICAgKiBAcGFyYW0gX2Zyb20gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byBzZW5kIHRva2VucyBmcm9tDQogICAqIEBwYXJhbSBfdG8gYWRkcmVzcyBUaGUgYWRkcmVzcyB3aGljaCB5b3Ugd2FudCB0byB0cmFuc2ZlciB0bw0KICAgKiBAcGFyYW0gX3ZhbHVlIHVpbnQyNTYgdGhlIGFtb3V0IG9mIHRva2VucyB0byBiZSB0cmFuc2ZlcmVkDQogICAqLw0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSB7DQogICAgaWYgKCFpc0ZpbmFsaXplZCkgcmV2ZXJ0KCk7DQoNCiAgICB2YXIgX2FsbG93YW5jZSA9IGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdOw0KDQogICAgLy8gQ2hlY2sgaXMgbm90IG5lZWRlZCBiZWNhdXNlIHN1YihfYWxsb3dhbmNlLCBfdmFsdWUpIHdpbGwgYWxyZWFkeSB0aHJvdyBpZiB0aGlzIGNvbmRpdGlvbiBpcyBub3QgbWV0DQogICAgLy8gaWYgKF92YWx1ZSA+IF9hbGxvd2FuY2UpIHRocm93Ow0KDQogICAgYmFsYW5jZXNbX3RvXSA9IGJhbGFuY2VzW190b10uYWRkKF92YWx1ZSk7DQogICAgYmFsYW5jZXNbX2Zyb21dID0gYmFsYW5jZXNbX2Zyb21dLnN1YihfdmFsdWUpOw0KICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gX2FsbG93YW5jZS5zdWIoX3ZhbHVlKTsNCiAgICBUcmFuc2ZlcihfZnJvbSwgX3RvLCBfdmFsdWUpOw0KICB9DQoNCiAgLyoqDQogICAqIEBkZXYgQXByb3ZlIHRoZSBwYXNzZWQgYWRkcmVzcyB0byBzcGVuZCB0aGUgc3BlY2lmaWVkIGFtb3VudCBvZiB0b2tlbnMgb24gYmVoYWxmIG9mIG1zZy5zZW5kZXIuDQogICAqIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyB3aGljaCB3aWxsIHNwZW5kIHRoZSBmdW5kcy4NCiAgICogQHBhcmFtIF92YWx1ZSBUaGUgYW1vdW50IG9mIHRva2VucyB0byBiZSBzcGVudC4NCiAgICovDQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHsNCg0KICAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgDQogICAgLy8gIGFsbG93YW5jZSB0byB6ZXJvIGJ5IGNhbGxpbmcgYGFwcHJvdmUoX3NwZW5kZXIsIDApYCBpZiBpdCBpcyBub3QNCiAgICAvLyAgYWxyZWFkeSAwIHRvIG1pdGlnYXRlIHRoZSByYWNlIGNvbmRpdGlvbiBkZXNjcmliZWQgaGVyZToNCiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkNCiAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gIT0gMCkpIHJldmVydCgpOw0KDQogICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogIH0NCg0KICAvKioNCiAgICogQGRldiBGdW5jdGlvbiB0byBjaGVjayB0aGUgYW1vdW50IG9mIHRva2VucyB0aGF0IGFuIG93bmVyIGFsbG93ZWQgdG8gYSBzcGVuZGVyLg0KICAgKiBAcGFyYW0gX293bmVyIGFkZHJlc3MgVGhlIGFkZHJlc3Mgd2hpY2ggb3ducyB0aGUgZnVuZHMuDQogICAqIEBwYXJhbSBfc3BlbmRlciBhZGRyZXNzIFRoZSBhZGRyZXNzIHdoaWNoIHdpbGwgc3BlbmQgdGhlIGZ1bmRzLg0KICAgKiBAcmV0dXJuIEEgdWludDI1NiBzcGVjaWZpbmcgdGhlIGFtb3VudCBvZiB0b2tlbnMgc3RpbGwgYXZhaWJsZSBmb3IgdGhlIHNwZW5kZXIuDQogICAqLw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogIH0NCg0KfQ0KDQpjb250cmFjdCBTaW1wbGVUb2tlbiBpcyBTdGFuZGFyZFRva2VuIHsNCg0KICBzdHJpbmcgcHVibGljIG5hbWUgPSAiU2ltcGxlVG9rZW4iOw0KICBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJTSU0iOw0KICB1aW50MjU2IHB1YmxpYyBkZWNpbWFscyA9IDE4Ow0KICB1aW50MjU2IHB1YmxpYyBJTklUSUFMX1NVUFBMWSA9IDEwMDAwOw0KDQogIC8qKg0KICAgKiBAZGV2IENvbnRydWN0b3IgdGhhdCBnaXZlcyBtc2cuc2VuZGVyIGFsbCBvZiBleGlzdGluZyB0b2tlbnMuIA0KICAgKi8NCiAgZnVuY3Rpb24gU2ltcGxlVG9rZW4oKSB7DQogICAgdG90YWxTdXBwbHkgPSBJTklUSUFMX1NVUFBMWTsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IElOSVRJQUxfU1VQUExZOw0KICB9DQoNCn0NCg0KDQoNCg0KY29udHJhY3QgT3duYWJsZSB7DQogIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQoNCiAgLyoqIA0KICAgKiBAZGV2IFRoZSBPd25hYmxlIGNvbnN0cnVjdG9yIHNldHMgdGhlIG9yaWdpbmFsIGBvd25lcmAgb2YgdGhlIGNvbnRyYWN0IHRvIHRoZSBzZW5kZXINCiAgICogYWNjb3VudC4NCiAgICovDQogIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICB9DQoNCg0KICAvKioNCiAgICogQGRldiBUaHJvd3MgaWYgY2FsbGVkIGJ5IGFueSBhY2NvdW50IG90aGVyIHRoYW4gdGhlIG93bmVyLiANCiAgICovDQogIG1vZGlmaWVyIG9ubHlPd25lcigpIHsNCiAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgew0KICAgICAgcmV2ZXJ0KCk7DQogICAgfQ0KICAgIF87DQogIH0NCg0KDQogIC8qKg0KICAgKiBAZGV2IEFsbG93cyB0aGUgY3VycmVudCBvd25lciB0byB0cmFuc2ZlciBjb250cm9sIG9mIHRoZSBjb250cmFjdCB0byBhIG5ld093bmVyLg0KICAgKiBAcGFyYW0gbmV3T3duZXIgVGhlIGFkZHJlc3MgdG8gdHJhbnNmZXIgb3duZXJzaGlwIHRvLiANCiAgICovDQogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsNCiAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KICB9DQoNCn0NCg0KbGlicmFyeSBTYWZlTWF0aCB7DQogIGZ1bmN0aW9uIG11bCh1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgIHVpbnQyNTYgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBkaXYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICAvLyBhc3NlcnQoYiA+IDApOyAvLyBTb2xpZGl0eSBhdXRvbWF0aWNhbGx5IHRocm93cyB3aGVuIGRpdmlkaW5nIGJ5IDANCiAgICB1aW50MjU2IGMgPSBhIC8gYjsNCiAgICAvLyBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsgLy8gVGhlcmUgaXMgbm8gY2FzZSBpbiB3aGljaCB0aGlzIGRvZXNuJ3QgaG9sZA0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gc3ViKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgcmV0dXJuIGEgLSBiOw0KICB9DQoNCiAgZnVuY3Rpb24gYWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgdWludDI1NiBjID0gYSArIGI7DQogICAgYXNzZXJ0KGMgPj0gYSk7DQogICAgcmV0dXJuIGM7DQogIH0NCn0NCg0KbGlicmFyeSBNYXRoIHsNCiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCn0NCg0KDQpjb250cmFjdCBSZXhUb2tlbiBpcyBTdGFuZGFyZFRva2VuLCBPd25hYmxlIHsNCg0KICBmdW5jdGlvbiB2ZXJzaW9uKCkgY29uc3RhbnQgcmV0dXJucyAoYnl0ZXMzMikgew0KICAgICAgcmV0dXJuICIwLjEuMSI7DQogIH0NCg0KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IG5hbWUgPSAiUkVYIC0gUmVhbCBFc3RhdGUgdG9rZW5zIjsNCiAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiUkVYIjsNCiAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsNCg0KICB1aW50MjU2IGNvbnN0YW50IEJBU0VfUkFURSA9IDcwMDsNCiAgdWludDI1NiBjb25zdGFudCBFVEhfUkFURSA9IDIyNTsgDQogIHVpbnQyNTYgY29uc3RhbnQgVVNEX1JBSVNFRF9DQVAgPSAzMCoxMCoqNjsgDQogIHVpbnQyNTYgY29uc3RhbnQgRVRIRVJfUkFJU0VEX0NBUCA9IFVTRF9SQUlTRURfQ0FQIC8gRVRIX1JBVEU7DQogIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IFdFSV9SQUlTRURfQ0FQID0gRVRIRVJfUkFJU0VEX0NBUCAqIDEgZXRoZXI7DQogIHVpbnQyNTYgY29uc3RhbnQgRFVSQVRJT04gPSA0IHdlZWtzOw0KDQoNCiAgdWludDI1NiBUT1RBTF9TSEFSRSA9IDEwMDA7DQogIHVpbnQyNTYgQ1JPV0RTQUxFX1NIQVJFID0gNTAwOw0KDQogIGFkZHJlc3MgQU5HRUxTX0FERFJFU1MgPSAweDAwOTk4ZWJhMEU1QjgzMDE4YTBDRkNkZUNjNTMwNGY5ZjE2N2QyN2E7DQogIHVpbnQyNTYgQU5HRUxTX1NIQVJFID0gNTA7DQoNCiAgYWRkcmVzcyBDT1JFXzFfQUREUkVTUyA9IDB4NGFENDhCRTliZjZFMmQzNTI3N0JkMzNDMTAwRDI4M0MyOUM3OTUxRjsNCiAgdWludDI1NiBDT1JFXzFfU0hBUkUgPSA3NTsNCiAgYWRkcmVzcyBDT1JFXzJfQUREUkVTUyA9IDB4MmE2MjYwOWM2QTZiREJFMjVEYTRmYjA1OTgwZTg1ZGI5QTQ3OUM1ZTsNCiAgdWludDI1NiBDT1JFXzJfU0hBUkUgPSA3NTsNCg0KICBhZGRyZXNzIFBBUlRORVJTSElQX0FERFJFU1MgPSAweDUzQjhmRkJlMzVBRTU0OGYyMmQ1YTNiMzFENkU1ZTBDMDRmMGQyREY7DQogIHVpbnQyNTYgUEFSVE5FUlNISVBfU0hBUkUgPSA3MDsNCg0KICBhZGRyZXNzIFJFV0FSRFNfQUREUkVTUyA9IDB4NDNGMWFhMDQ3RDMyNDFCN0REMjUwRUIzN2IyNWZjNTA5MDg1ZkRmOTsNCiAgdWludDI1NiBSRVdBUkRTX1NIQVJFID0gMjAwOw0KDQogIGFkZHJlc3MgQUZGSUxJQVRFX0FERFJFU1MgPSAweDY0ZWE2MkE4MDgwZUQxQzJiOGQ5OTZBQ0M3YTgyMTA4OTc1ZTUzNjE7DQogIHVpbnQyNTYgQUZGSUxJQVRFX1NIQVJFID0gMzA7DQoNCiAgLy8gc3RhdGUgdmFyaWFibGVzDQogIGFkZHJlc3MgdmF1bHQ7DQogIHVpbnQyNTYgcHVibGljIHN0YXJ0VGltZTsNCiAgdWludDI1NiBwdWJsaWMgd2VpUmFpc2VkOw0KDQogIGV2ZW50IFRva2VuQ3JlYXRlZChhZGRyZXNzIGluZGV4ZWQgaW52ZXN0b3IsIHVpbnQyNTYgYW1vdW50KTsNCg0KICBmdW5jdGlvbiBSZXhUb2tlbih1aW50MjU2IF9zdGFydCwgYWRkcmVzcyBfdmF1bHQpIHsNCiAgICBzdGFydFRpbWUgPSBfc3RhcnQ7DQogICAgdmF1bHQgPSBfdmF1bHQ7DQogICAgaXNGaW5hbGl6ZWQgPSBmYWxzZTsNCiAgfQ0KDQogIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgIGNyZWF0ZVRva2Vucyhtc2cuc2VuZGVyKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGNyZWF0ZVRva2VucyhhZGRyZXNzIHJlY2lwaWVudCkgcGF5YWJsZSB7DQogICAgaWYgKHRva2VuU2FsZU9uSG9sZCkgcmV2ZXJ0KCk7DQogICAgaWYgKG1zZy52YWx1ZSA9PSAwKSByZXZlcnQoKTsNCiAgICBpZiAobm93IDwgc3RhcnRUaW1lKSByZXZlcnQoKTsNCiAgICBpZiAobm93ID4gc3RhcnRUaW1lICsgRFVSQVRJT04pIHJldmVydCgpOw0KDQogICAgdWludDI1NiB3ZWlBbW91bnQgPSBtc2cudmFsdWU7DQoNCiAgICBpZiAod2VpUmFpc2VkID49IFdFSV9SQUlTRURfQ0FQKSByZXZlcnQoKTsNCg0KICAgIC8vaWYgZnVuZGVyIHNlbnQgbW9yZSB0aGFuIHRoZSByZW1haW5pbmcgYW1vdW50IHRoZW4gc2VuZCB0aGVtIGEgcmVmdW5kIG9mIHRoZSBkaWZmZXJlbmNlDQogICAgaWYgKCh3ZWlSYWlzZWQgKyB3ZWlBbW91bnQpID4gV0VJX1JBSVNFRF9DQVApIHsNCiAgICAgIHdlaUFtb3VudCA9IFdFSV9SQUlTRURfQ0FQIC0gd2VpUmFpc2VkOw0KICAgICAgaWYgKCFtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlIC0gd2VpQW1vdW50KSkgDQogICAgICAgIHJldmVydCgpOw0KICAgIH0NCg0KICAgIC8vIGNhbGN1bGF0ZSB0b2tlbiBhbW91bnQgdG8gYmUgY3JlYXRlZA0KICAgIHVpbnQyNTYgdG9rZW5zID0gd2VpQW1vdW50Lm11bChnZXRSYXRlKCkpOw0KDQogICAgLy8gdXBkYXRlIHRvdGFscw0KICAgIHRvdGFsU3VwcGx5ID0gdG90YWxTdXBwbHkuYWRkKHRva2Vucyk7DQogICAgd2VpUmFpc2VkID0gd2VpUmFpc2VkLmFkZCh3ZWlBbW91bnQpOw0KDQogICAgYmFsYW5jZXNbcmVjaXBpZW50XSA9IGJhbGFuY2VzW3JlY2lwaWVudF0uYWRkKHRva2Vucyk7DQogICAgVG9rZW5DcmVhdGVkKHJlY2lwaWVudCwgdG9rZW5zKTsNCg0KICAgIC8vIHNlbmQgZXRoZXIgdG8gdGhlIHZhdWx0DQogICAgaWYgKCF2YXVsdC5zZW5kKHdlaUFtb3VudCkpIHJldmVydCgpOw0KICB9DQoNCiAgLy8gcmV0dXJuIGR5bmFtaWMgcHJpY2luZw0KICBmdW5jdGlvbiBnZXRSYXRlKCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHVpbnQyNTYgYm9udXMgPSAwOw0KICAgIGlmIChub3cgPCAoc3RhcnRUaW1lICsgMSB3ZWVrcykpIHsNCiAgICAgIGJvbnVzID0gMzAwOw0KICAgIH0gZWxzZSBpZiAobm93IDwgKHN0YXJ0VGltZSArIDIgd2Vla3MpKSB7DQogICAgICBib251cyA9IDIwMDsNCiAgICB9IGVsc2UgaWYgKG5vdyA8IChzdGFydFRpbWUgKyAzIHdlZWtzKSkgew0KICAgICAgYm9udXMgPSAxMDA7DQogICAgfQ0KICAgIHJldHVybiBCQVNFX1JBVEUuYWRkKGJvbnVzKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRva2VuQW1vdW50KHVpbnQyNTYgc2hhcmUsIHVpbnQyNTYgZmluYWxTdXBwbHkpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICBpZiAoc2hhcmUgPiBUT1RBTF9TSEFSRSkgcmV2ZXJ0KCk7DQoNCiAgICByZXR1cm4gc2hhcmUubXVsKGZpbmFsU3VwcGx5KS5kaXYoVE9UQUxfU0hBUkUpOw0KICB9DQoNCiAgLy8gZ3JhbnQgcmVndWxhciB0b2tlbnMgYnkgc2hhcmUNCiAgZnVuY3Rpb24gZ3JhbnRUb2tlbnNCeVNoYXJlKGFkZHJlc3MgdG8sIHVpbnQyNTYgc2hhcmUsIHVpbnQyNTYgZmluYWxTdXBwbHkpIGludGVybmFsIHsNCiAgICB1aW50MjU2IHRva2VucyA9IHRva2VuQW1vdW50KHNoYXJlLCBmaW5hbFN1cHBseSk7DQogICAgYmFsYW5jZXNbdG9dID0gYmFsYW5jZXNbdG9dLmFkZCh0b2tlbnMpOw0KICAgIFRva2VuQ3JlYXRlZCh0bywgdG9rZW5zKTsNCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LmFkZCh0b2tlbnMpOw0KICB9DQoNCiAgZnVuY3Rpb24gZ2V0RmluYWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIFRPVEFMX1NIQVJFLm11bCh0b3RhbFN1cHBseSkuZGl2KENST1dEU0FMRV9TSEFSRSk7DQogIH0NCg0KDQogIC8vIGRvIGZpbmFsIHRva2VuIGRpc3RyaWJ1dGlvbg0KICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lcigpIHsNCiAgICBpZiAoaXNGaW5hbGl6ZWQpIHJldmVydCgpOw0KDQogICAgLy9pZiB3ZSBhcmUgdW5kZXIgdGhlIGNhcCBhbmQgbm90IGhpdCB0aGUgZHVyYXRpb24gdGhlbiB0aHJvdw0KICAgIGlmICh3ZWlSYWlzZWQgPCBXRUlfUkFJU0VEX0NBUCAmJiBub3cgPD0gc3RhcnRUaW1lICsgRFVSQVRJT04pIHJldmVydCgpOw0KDQogICAgdWludDI1NiBmaW5hbFN1cHBseSA9IGdldEZpbmFsU3VwcGx5KCk7DQoNCiAgICBncmFudFRva2Vuc0J5U2hhcmUoQU5HRUxTX0FERFJFU1MsIEFOR0VMU19TSEFSRSwgZmluYWxTdXBwbHkpOw0KICAgIGdyYW50VG9rZW5zQnlTaGFyZShDT1JFXzFfQUREUkVTUywgQ09SRV8xX1NIQVJFLCBmaW5hbFN1cHBseSk7DQogICAgZ3JhbnRUb2tlbnNCeVNoYXJlKENPUkVfMl9BRERSRVNTLCBDT1JFXzJfU0hBUkUsIGZpbmFsU3VwcGx5KTsNCg0KICAgIGdyYW50VG9rZW5zQnlTaGFyZShQQVJUTkVSU0hJUF9BRERSRVNTLCBQQVJUTkVSU0hJUF9TSEFSRSwgZmluYWxTdXBwbHkpOw0KICAgIGdyYW50VG9rZW5zQnlTaGFyZShSRVdBUkRTX0FERFJFU1MsIFJFV0FSRFNfU0hBUkUsIGZpbmFsU3VwcGx5KTsNCiAgICBncmFudFRva2Vuc0J5U2hhcmUoQUZGSUxJQVRFX0FERFJFU1MsIEFGRklMSUFURV9TSEFSRSwgZmluYWxTdXBwbHkpOw0KICAgIA0KICAgIGlzRmluYWxpemVkID0gdHJ1ZTsNCiAgfQ0KDQogIGJvb2wgcHVibGljIHRva2VuU2FsZU9uSG9sZDsNCg0KICBmdW5jdGlvbiB0b2dnbGVUb2tlblNhbGVPbkhvbGQoKSBvbmx5T3duZXIoKSB7DQogICAgaWYgKHRva2VuU2FsZU9uSG9sZCkNCiAgICAgIHRva2VuU2FsZU9uSG9sZCA9IGZhbHNlOw0KICAgIGVsc2UNCiAgICAgIHRva2VuU2FsZU9uSG9sZCA9IHRydWU7DQogIH0NCg0KICBib29sIHB1YmxpYyBtaWdyYXRlRGlzYWJsZWQ7DQoNCiAgc3RydWN0IHN0cnVjdE1pZ3JhdGUgew0KICAgIHVpbnQgZGF0ZVRpbWVDcmVhdGVkOw0KICAgIHVpbnQgYW1vdW50Ow0KICB9DQoNCiAgbWFwcGluZyhhZGRyZXNzID0+IHN0cnVjdE1pZ3JhdGUpIHBlbmRpbmdNaWdyYXRpb25zOw0KDQogIGZ1bmN0aW9uIHRvZ2dsZU1pZ3JhdGlvblN0YXR1cygpIG9ubHlPd25lcigpIHsNCiAgICBpZiAobWlncmF0ZURpc2FibGVkKQ0KICAgICAgbWlncmF0ZURpc2FibGVkID0gZmFsc2U7DQogICAgZWxzZQ0KICAgICAgbWlncmF0ZURpc2FibGVkID0gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pZ3JhdGUodWludDI1NiBhbW91bnQpIHsNCg0KICAgIC8vZG9udCBhbGxvdyBtaWdyYXRpb25zIHVudGlsIGNyb3dkZnVuZCBpcyBkb25lDQogICAgaWYgKCFpc0ZpbmFsaXplZCkgDQogICAgICByZXZlcnQoKTsNCg0KICAgIC8vZG9udCBwcm9jZWVkIGlmIG1pZ3JhdGUgaXMgZGlzYWJsZWQNCiAgICBpZiAobWlncmF0ZURpc2FibGVkKSANCiAgICAgIHJldmVydCgpOw0KDQogICAgLy9kb250IHByb2NlZWQgaWYgdGhlcmUgaXMgcGVuZGluZyB2YWx1ZQ0KICAgIGlmIChwZW5kaW5nTWlncmF0aW9uc1ttc2cuc2VuZGVyXS5hbW91bnQgPiAwKQ0KICAgICAgcmV2ZXJ0KCk7DQoNCiAgICAvL2Ftb3VudCBwYXJhbWV0ZXIgaXMgaW4gV2VpDQogICAgLy9vbGQgcmV4IHRva2VuIGlzIG9ubHkgNCBkZWNpbWFsIHBsYWNlcw0KICAgIC8vaS5lLiB0byBtaWdyYXRlIDggb2xkIFJFWCAoODAwMDApIHVzZXIgaW5wdXRzIDgsIHVpIGNvbnZlcnRzIHRvIDgqKjE4ICh3ZWkpLCB0aGVuIHdlIGRpdmlkZSBieSAxNGRwIHRvIGdldCB0aGUgb3JpZ2luYWwgODAwMDAuDQogICAgdWludDI1NiBhbW91bnRfNGRwID0gYW1vdW50IC8gKDEwKioxNCk7DQoNCiAgICAvL3RoaXMgd2lsbCB0aHJvdyBpZiB0aGV5IGRvbnQgaGF2ZSB0aGUgYmFsYW5jZS9hbGxvd2FuY2UNCiAgICBTdGFuZGFyZFRva2VuKDB4MDA0MmE2ODlmMWViZmNhNDA0ZTEzYzI5Y2I2ZDAxZTAwMDU5YmE5ZGJjKS50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgdGhpcywgYW1vdW50XzRkcCk7DQoNCiAgICAvL3N0b3JlIHRpbWUgYW5kIGFtb3VudCBpbiBwZW5kaW5nIG1hcHBpbmcNCiAgICBwZW5kaW5nTWlncmF0aW9uc1ttc2cuc2VuZGVyXS5kYXRlVGltZUNyZWF0ZWQgPSBub3c7DQogICAgcGVuZGluZ01pZ3JhdGlvbnNbbXNnLnNlbmRlcl0uYW1vdW50ID0gYW1vdW50Ow0KICB9DQoNCiAgZnVuY3Rpb24gY2xhaW1NaWdyYXRlKCkgew0KDQogICAgLy9kb250IGFsbG93IGlmIG1pZ3JhdGlvbnMgYXJlIGRpc2FibGVkDQogICAgaWYgKG1pZ3JhdGVEaXNhYmxlZCkgDQogICAgICByZXZlcnQoKTsNCg0KICAgIC8vZG9udCBwcm9jZWVkIGlmIG5vIHZhbHVlDQogICAgaWYgKHBlbmRpbmdNaWdyYXRpb25zW21zZy5zZW5kZXJdLmFtb3VudCA9PSAwKQ0KICAgICAgcmV2ZXJ0KCk7DQoNCiAgICAvL2NhbiBvbmx5IGNsYWltIGFmdGVyIGEgd2VlayBoYXMgcGFzc2VkDQogICAgaWYgKG5vdyA8IHBlbmRpbmdNaWdyYXRpb25zW21zZy5zZW5kZXJdLmRhdGVUaW1lQ3JlYXRlZCArIDEgd2Vla3MpDQogICAgICByZXZlcnQoKTsNCg0KICAgIC8vY3JlZGl0IHRoZSBiYWxhbmNlcw0KICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdICs9IHBlbmRpbmdNaWdyYXRpb25zW21zZy5zZW5kZXJdLmFtb3VudDsNCiAgICB0b3RhbFN1cHBseSArPSBwZW5kaW5nTWlncmF0aW9uc1ttc2cuc2VuZGVyXS5hbW91bnQ7DQoNCiAgICAvL3JlbW92ZSB0aGUgcGVuZGluZyBtaWdyYXRpb24gZnJvbSB0aGUgbWFwcGluZw0KICAgIGRlbGV0ZSBwZW5kaW5nTWlncmF0aW9uc1ttc2cuc2VuZGVyXTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyT3duQ29pbnMoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5T3duZXIoKSB7DQogICAgaWYgKCFpc0ZpbmFsaXplZCkgcmV2ZXJ0KCk7DQoNCiAgICBiYWxhbmNlc1t0aGlzXSA9IGJhbGFuY2VzW3RoaXNdLnN1YihfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIFRyYW5zZmVyKHRoaXMsIF90bywgX3ZhbHVlKTsNCiAgfQ0KDQp9'