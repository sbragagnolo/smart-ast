base 64 content
base64rouleth
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBPd25lZEJ5V2luc29tZSB7DQoNCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgYWxsb3dlZFdvcmtlcjsNCg0KICBmdW5jdGlvbiBpbml0T3duZXJzaGlwKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF93b3JrZXIpIGludGVybmFsew0KICAgIG93bmVyID0gX293bmVyOw0KICAgIGFsbG93ZWRXb3JrZXJbX293bmVyXSA9IHRydWU7DQogICAgYWxsb3dlZFdvcmtlcltfd29ya2VyXSA9IHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd1dvcmtlcihhZGRyZXNzIF9uZXdfd29ya2VyKSBvbmx5T3duZXJ7DQogICAgYWxsb3dlZFdvcmtlcltfbmV3X3dvcmtlcl0gPSB0cnVlOw0KICB9DQogIGZ1bmN0aW9uIHJlbW92ZVdvcmtlcihhZGRyZXNzIF9vbGRfd29ya2VyKSBvbmx5T3duZXJ7DQogICAgYWxsb3dlZFdvcmtlcltfb2xkX3dvcmtlcl0gPSBmYWxzZTsNCiAgfQ0KICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9uZXdfb3duZXIpIG9ubHlPd25lcnsNCiAgICBvd25lciA9IF9uZXdfb3duZXI7DQogIH0NCgkJCQkJCSAgICANCiAgbW9kaWZpZXIgb25seUFsbG93ZWRXb3JrZXJ7DQogICAgaWYgKCFhbGxvd2VkV29ya2VyW21zZy5zZW5kZXJdKXsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seU93bmVyew0KICAgIGlmIChtc2cuc2VuZGVyICE9IG93bmVyKXsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgICBfOw0KICB9DQoNCiAgDQp9DQoNCi8qKg0KICogTWF0aCBvcGVyYXRpb25zIHdpdGggc2FmZXR5IGNoZWNrcw0KICovDQpsaWJyYXJ5IFNhZmVNYXRoIHsNCiAgZnVuY3Rpb24gbXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSAqIGI7DQogICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGRpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiID4gMCk7DQogICAgdWludCBjID0gYSAvIGI7DQogICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBzdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBhZGQodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICsgYjsNCiAgICBhc3NlcnQoYyA+PSBhKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7DQogICAgaWYgKCFhc3NlcnRpb24pIHsNCiAgICAgIHRocm93Ow0KICAgIH0NCiAgfQ0KfQ0KDQoNCi8qDQogKiBCYXNpYyB0b2tlbg0KICogQmFzaWMgdmVyc2lvbiBvZiBTdGFuZGFyZFRva2VuLCB3aXRoIG5vIGFsbG93YW5jZXMNCiAqLw0KY29udHJhY3QgQmFzaWNUb2tlbiB7DQogIHVzaW5nIFNhZmVNYXRoIGZvciB1aW50Ow0KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsNCiAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KICB1aW50IHB1YmxpYyAgICAgdG90YWxTdXBwbHkgPSAgICAwOyAgICAJCQkgLy8gVG90YWwgc3VwcGx5IG9mIDUwMCBtaWxsaW9uIFRva2Vucw0KICANCiAgLyoNCiAgICogRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgIA0KICAgKi8NCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgew0KICAgICBpZihtc2cuZGF0YS5sZW5ndGggPCBzaXplICsgNCkgew0KICAgICAgIHRocm93Ow0KICAgICB9DQogICAgIF87DQogIH0NCg0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIG9ubHlQYXlsb2FkU2l6ZSgyICogMzIpIHsNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGJhbGFuY2VzW21zZy5zZW5kZXJdLnN1YihfdmFsdWUpOw0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7DQogICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogIH0NCiAgDQp9DQoNCg0KY29udHJhY3QgU3RhbmRhcmRUb2tlbiBpcyBCYXNpY1Rva2Vuew0KICANCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7DQoNCiAgDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCg0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSB7DQogICAgdmFyIF9hbGxvd2FuY2UgPSBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXTsNCg0KICAgIC8vIENoZWNrIGlzIG5vdCBuZWVkZWQgYmVjYXVzZSBzdWIoX2FsbG93YW5jZSwgX3ZhbHVlKSB3aWxsIGFscmVhZHkgdGhyb3cgaWYgdGhpcyBjb25kaXRpb24gaXMgbm90IG1ldA0KICAgIC8vIGlmIChfdmFsdWUgPiBfYWxsb3dhbmNlKSB0aHJvdzsNCg0KICAgIGJhbGFuY2VzW190b10gPSBiYWxhbmNlc1tfdG9dLmFkZChfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IGJhbGFuY2VzW19mcm9tXS5zdWIoX3ZhbHVlKTsNCiAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IF9hbGxvd2FuY2Uuc3ViKF92YWx1ZSk7DQogICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHsNCiAgICBhbGxvd2VkW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpIHsNCiAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgfQ0KDQp9DQoNCg0KY29udHJhY3QgV2luVG9rZW4gaXMgU3RhbmRhcmRUb2tlbiwgT3duZWRCeVdpbnNvbWV7DQoNCiAgc3RyaW5nIHB1YmxpYyAgIG5hbWUgPSAgICAgICAgICAgIldpbnNvbWUuaW8gVG9rZW4iOw0KICBzdHJpbmcgcHVibGljICAgc3ltYm9sID0gICAgICAgICAiV0lOIjsNCiAgdWludCBwdWJsaWMgICAgIGRlY2ltYWxzID0gICAgICAgMTg7DQogIA0KICBtYXBwaW5nIChhZGRyZXNzID0+IGJvb2wpIGFsbG93ZWRNaW50ZXI7DQoNCiAgZnVuY3Rpb24gV2luVG9rZW4oYWRkcmVzcyBfb3duZXIpew0KICAgIGFsbG93ZWRNaW50ZXJbX293bmVyXSA9IHRydWU7DQogICAgaW5pdE93bmVyc2hpcChfb3duZXIsIF9vd25lcik7DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd01pbnRlcihhZGRyZXNzIF9uZXdfbWludGVyKSBvbmx5T3duZXJ7DQogICAgYWxsb3dlZE1pbnRlcltfbmV3X21pbnRlcl0gPSB0cnVlOw0KICB9DQogIGZ1bmN0aW9uIHJlbW92ZU1pbnRlcihhZGRyZXNzIF9vbGRfbWludGVyKSBvbmx5T3duZXJ7DQogICAgYWxsb3dlZE1pbnRlcltfb2xkX21pbnRlcl0gPSBmYWxzZTsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlBbGxvd2VkTWludGVyew0KICAgIGlmICghYWxsb3dlZE1pbnRlclttc2cuc2VuZGVyXSl7DQogICAgICB0aHJvdzsNCiAgICB9DQogICAgXzsNCiAgfQ0KICBmdW5jdGlvbiBtaW50VG9rZW5zKGFkZHJlc3MgX2ZvciwgdWludCBfdmFsdWVfd2VpKSBvbmx5QWxsb3dlZE1pbnRlciB7DQogICAgYmFsYW5jZXNbX2Zvcl0gPSBiYWxhbmNlc1tfZm9yXS5hZGQoX3ZhbHVlX3dlaSk7DQogICAgdG90YWxTdXBwbHkgPSB0b3RhbFN1cHBseS5hZGQoX3ZhbHVlX3dlaSkgOw0KICAgIFRyYW5zZmVyKGFkZHJlc3MoMCksIF9mb3IsIF92YWx1ZV93ZWkpOw0KICB9DQogIGZ1bmN0aW9uIGRlc3Ryb3lUb2tlbnMoYWRkcmVzcyBfZm9yLCB1aW50IF92YWx1ZV93ZWkpIG9ubHlBbGxvd2VkTWludGVyIHsNCiAgICBiYWxhbmNlc1tfZm9yXSA9IGJhbGFuY2VzW19mb3JdLnN1YihfdmFsdWVfd2VpKTsNCiAgICB0b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5LnN1YihfdmFsdWVfd2VpKTsNCiAgICBUcmFuc2ZlcihfZm9yLCBhZGRyZXNzKDApLCBfdmFsdWVfd2VpKTsgICAgDQogIH0NCiAgDQp9DQoNCmNvbnRyYWN0IFJvdWxldGgNCnsNCiAgLy9HYW1lIGFuZCBHbG9iYWwgVmFyaWFibGVzLCBTdHJ1Y3R1cmUgb2YgZ2FtYmxlcw0KICBhZGRyZXNzIHB1YmxpYyBkZXZlbG9wZXI7DQogIHVpbnQ4IHB1YmxpYyBibG9ja0RlbGF5OyAvL25iIG9mIGJsb2NrcyB0byB3YWl0IGJlZm9yZSBzcGluDQogIHVpbnQ4IHB1YmxpYyBibG9ja0V4cGlyYXRpb247IC8vbmIgb2YgYmxvY2tzIGJlZm9yZSBiZXQgZXhwaXJhdGlvbiAoZHVlIHRvIGhhc2ggc3RvcmFnZSBsaW1pdHMpDQogIHVpbnQyNTYgcHVibGljIG1heEdhbWJsZTsgLy9tYXggZ2FtYmxlIHZhbHVlIG1hbnVhbGx5IHNldCBieSBjb25maWcNCiAgdWludDI1NiBwdWJsaWMgbWluR2FtYmxlOyAvL21pbiBnYW1ibGUgdmFsdWUgbWFudWFsbHkgc2V0IGJ5IGNvbmZpZw0KDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkgcGVuZGluZ1Rva2VuczsNCiAgDQogIGFkZHJlc3MgcHVibGljIFdJTlRPS0VOQUREUkVTUzsNCiAgV2luVG9rZW4gd2luVG9rZW5JbnN0YW5jZTsNCg0KICB1aW50IHB1YmxpYyBlbWlzc2lvblJhdGU7DQogIA0KICAvL0dhbWJsZXMNCiAgZW51bSBCZXRUeXBlc3tudW1iZXIsIGNvbG9yLCBwYXJpdHksIGRvemVuLCBjb2x1bW4sIGxvd2hpZ2h9IA0KICBzdHJ1Y3QgR2FtYmxlDQogIHsNCiAgICBhZGRyZXNzIHBsYXllcjsNCiAgICBib29sIHNwaW5uZWQ7IC8vV2FzIHRoZSByb3VsZXRoIHNwaW5uZWQgPw0KICAgIGJvb2wgd2luOw0KICAgIC8vUG9zc2libGUgYmV0IHR5cGVzDQogICAgQmV0VHlwZXMgYmV0VHlwZTsNCiAgICB1aW50IGlucHV0OyAvL3N0b3JlcyBudW1iZXIsIGNvbG9yLCBkb3plbiBvciBvZGRldmVuDQogICAgdWludDI1NiB3YWdlcjsNCiAgICB1aW50MjU2IGJsb2NrTnVtYmVyOyAvL2Jsb2NrIG9mIGJldA0KICAgIHVpbnQyNTYgYmxvY2tTcGlubmVkOyAvL2Jsb2NrIG9mIHNwaW4NCiAgICB1aW50OCB3aGVlbFJlc3VsdDsNCiAgfQ0KICBHYW1ibGVbXSBwcml2YXRlIGdhbWJsZXM7DQoNCiAgLy9UcmFja2luZyBwcm9ncmVzcyBvZiBwbGF5ZXJzDQogIG1hcHBpbmcgKGFkZHJlc3M9PnVpbnQpIGdhbWJsZUluZGV4OyAvL2N1cnJlbnQgZ2FtYmxlIGluZGV4IG9mIHRoZSBwbGF5ZXINCiAgLy9yZWNvcmRzIGN1cnJlbnQgc3RhdHVzIG9mIHBsYXllcg0KICBlbnVtIFN0YXR1cyB7d2FpdGluZ0ZvckJldCwgd2FpdGluZ0ZvclNwaW59IG1hcHBpbmcgKGFkZHJlc3M9PlN0YXR1cykgcGxheWVyU3RhdHVzOyANCg0KDQogIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAvLyAgICAgICAgTWFuYWdlbWVudCAmIENvbmZpZyBGVU5DVElPTlMgICAgICAgIC8vDQogIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQogIGZ1bmN0aW9uICBSb3VsZXRoKGFkZHJlc3MgX2RldmVsb3BlciwgYWRkcmVzcyBfd2luVG9rZW4pIC8vY3JlYXRpb24gc2V0dGluZ3MNCiAgew0KICAgIFdJTlRPS0VOQUREUkVTUyA9IF93aW5Ub2tlbjsNCiAgICB3aW5Ub2tlbkluc3RhbmNlID0gV2luVG9rZW4oX3dpblRva2VuKTsNCiAgICBkZXZlbG9wZXIgPSBfZGV2ZWxvcGVyOw0KICAgIGJsb2NrRGVsYXk9MDsgLy9pbmRpY2F0ZXMgd2hpY2ggYmxvY2sgYWZ0ZXIgYmV0IHdpbGwgYmUgdXNlZCBmb3IgUk5HDQogICAgYmxvY2tFeHBpcmF0aW9uPTI0NTsgLy9kZWxheSBhZnRlciB3aGljaCBnYW1ibGUgZXhwaXJlcw0KICAgIG1pbkdhbWJsZT0xMCBmaW5uZXk7IC8vY29uZmlndXJhYmxlIG1pbiBiZXQNCiAgICBtYXhHYW1ibGU9MSBldGhlcjsgLy9jb25maWd1cmFibGUgbWF4IGJldA0KICAgIGVtaXNzaW9uUmF0ZSA9IDU7DQogIH0NCiAgICANCiAgbW9kaWZpZXIgb25seURldmVsb3BlcigpIA0KICB7DQogICAgaWYgKG1zZy5zZW5kZXIhPWRldmVsb3BlcikgdGhyb3c7DQogICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFkZEJhbmtyb2xsKCkNCiAgICBvbmx5RGV2ZWxvcGVyDQogICAgcGF5YWJsZSB7DQogIH0NCg0KICBmdW5jdGlvbiByZW1vdmVCYW5rcm9sbCh1aW50MjU2IF9hbW91bnRfd2VpKQ0KICAgIG9ubHlEZXZlbG9wZXINCiAgew0KICAgIGlmICghZGV2ZWxvcGVyLnNlbmQoX2Ftb3VudF93ZWkpKSB0aHJvdzsNCiAgfQ0KICAgIA0KICBmdW5jdGlvbiBjaGFuZ2VEZXZlbG9wZXJfb25seV9EZXYoYWRkcmVzcyBuZXdfZGV2KQ0KICAgIG9ubHlEZXZlbG9wZXINCiAgew0KICAgIGRldmVsb3Blcj1uZXdfZGV2Ow0KICB9DQoNCg0KDQoNCg0KICAvL0NoYW5nZSBzb21lIHNldHRpbmdzIHdpdGhpbiBzYWZldHkgYm91bmRzDQogIGZ1bmN0aW9uIGNoYW5nZVNldHRpbmdzX29ubHlfRGV2KHVpbnQyNTYgbmV3TWluR2FtYmxlLCB1aW50MjU2IG5ld01heEdhbWJsZSwgdWludDggbmV3QmxvY2tEZWxheSwgdWludDggbmV3QmxvY2tFeHBpcmF0aW9uLCB1aW50IG5ld0VtaXNzaW9uUmF0ZSkNCiAgICBvbmx5RGV2ZWxvcGVyDQogIHsNCiAgICBlbWlzc2lvblJhdGUgPSBuZXdFbWlzc2lvblJhdGU7DQogICAgLy9NQVggQkVUIDogbGltaXRlZCBieSBwYXlyb2xsLyhjYXNpbm9TdGF0aXN0aWNhbExpbWl0KjM1KQ0KICAgIGlmIChuZXdNYXhHYW1ibGU8bmV3TWluR2FtYmxlKSB0aHJvdzsgIA0KICAgIG1heEdhbWJsZT1uZXdNYXhHYW1ibGU7IA0KICAgIG1pbkdhbWJsZT1uZXdNaW5HYW1ibGU7DQogICAgLy9EZWxheSBiZWZvcmUgc3BpbiA6DQogICAgYmxvY2tEZWxheT1uZXdCbG9ja0RlbGF5Ow0KICAgIGlmIChuZXdCbG9ja0V4cGlyYXRpb24gPCBibG9ja0RlbGF5ICsgMjUwKSB0aHJvdzsNCiAgICBibG9ja0V4cGlyYXRpb249bmV3QmxvY2tFeHBpcmF0aW9uOw0KICB9DQoNCg0KICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAgLy8gICAgICAgICAgICAgICAgIEJFVFRJTkcgRlVOQ1RJT05TICAgICAgICAgICAgICAgICAgICAvLw0KICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KICAvLyoqKi8vYmFzaWMgYmV0dGluZyB3aXRob3V0IE1pc3Qgb3IgY29udHJhY3QgY2FsbA0KICAvL2FjdGl2YXRlcyB3aGVuIHRoZSBwbGF5ZXIgb25seSBzZW5kcyBldGggdG8gdGhlIGNvbnRyYWN0DQogIC8vd2l0aG91dCBzcGVjaWZ5aW5nIGFueSB0eXBlIG9mIGJldC4NCiAgZnVuY3Rpb24gKCkNCiAgICBwYXlhYmxlDQogICAgew0KICAgICAgLy9kZWZhdXQgYmV0IDogYmV0IG9uIHJlZA0KICAgICAgYmV0T25Db2xvcihmYWxzZSk7DQogICAgfSANCg0KICAvLyoqKi8vR3VhcmFudGVlcyB0aGF0IGdhbWJsZSBpcyB1bmRlciBtYXggYmV0IGFuZCBhYm92ZSBtaW4uDQogIC8vIHJldHVybnMgYmV0IHZhbHVlDQogIGZ1bmN0aW9uIGNoZWNrQmV0VmFsdWUoKSBwcml2YXRlIHJldHVybnModWludDI1NikNCiAgew0KICAgIGlmIChtc2cudmFsdWUgPCBtaW5HYW1ibGUpIHRocm93Ow0KICAgIGlmIChtc2cudmFsdWUgPiBtYXhHYW1ibGUpew0KICAgICAgcmV0dXJuIG1heEdhbWJsZTsNCiAgICB9DQogICAgZWxzZXsNCiAgICAgIHJldHVybiBtc2cudmFsdWU7DQogICAgfQ0KICB9DQoNCg0KDQogIC8vRnVuY3Rpb24gcmVjb3JkIGJldCBjYWxsZWQgYnkgYWxsIG90aGVycyBiZXR0aW5nIGZ1bmN0aW9ucw0KICBmdW5jdGlvbiBwbGFjZUJldChCZXRUeXBlcyBiZXRUeXBlLCB1aW50IGlucHV0KSBwcml2YXRlDQogIHsNCg0KICAgIGlmIChwbGF5ZXJTdGF0dXNbbXNnLnNlbmRlcl0gIT0gU3RhdHVzLndhaXRpbmdGb3JCZXQpIHsNCiAgICAgIGlmICghU3BpblRoZVdoZWVsKG1zZy5zZW5kZXIpKSB0aHJvdzsNCiAgICB9DQoNCiAgICAvL09uY2UgdGhpcyBpcyBkb25lLCB3ZSBjYW4gcmVjb3JkIHRoZSBuZXcgYmV0DQogICAgcGxheWVyU3RhdHVzW21zZy5zZW5kZXJdID0gU3RhdHVzLndhaXRpbmdGb3JTcGluOw0KICAgIGdhbWJsZUluZGV4W21zZy5zZW5kZXJdID0gZ2FtYmxlcy5sZW5ndGg7DQogICAgDQogICAgLy9hZGFwdHMgd2FnZXIgdG8gY2FzaW5vIGxpbWl0cw0KICAgIHVpbnQyNTYgYmV0VmFsdWUgPSBjaGVja0JldFZhbHVlKCk7DQogICAgcGVuZGluZ1Rva2Vuc1ttc2cuc2VuZGVyXSArPSBiZXRWYWx1ZSAqIGVtaXNzaW9uUmF0ZTsNCg0KICAgIA0KICAgIGdhbWJsZXMucHVzaChHYW1ibGUobXNnLnNlbmRlciwgZmFsc2UsIGZhbHNlLCBiZXRUeXBlLCBpbnB1dCwgYmV0VmFsdWUsIGJsb2NrLm51bWJlciwgMCwgMzcpKTsgLy8zNyBpbmRpY2F0ZXMgbm90IHNwaW5uZWQgeWV0DQogICAgDQogICAgLy9yZWZ1bmQgZXhjZXNzIGJldCAoYXQgbGFzdCBzdGVwIHZzIHJlLWVudHJ5KQ0KICAgIGlmIChiZXRWYWx1ZSA8IG1zZy52YWx1ZSkgew0KICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUtYmV0VmFsdWUpPT1mYWxzZSkgdGhyb3c7DQogICAgfQ0KICB9DQoNCiAgZnVuY3Rpb24gZ2V0UGVuZGluZ1Rva2VucyhhZGRyZXNzIGFjY291bnQpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpew0KICAgIHJldHVybiBwZW5kaW5nVG9rZW5zW2FjY291bnRdOw0KICB9DQogIA0KICBmdW5jdGlvbiByZWRlZW1Ub2tlbnMoKXsNCiAgICB1aW50IHRvdGFsVG9rZW5zID0gcGVuZGluZ1Rva2Vuc1ttc2cuc2VuZGVyXTsNCiAgICBpZiAodG90YWxUb2tlbnMgPT0gMCkgcmV0dXJuOw0KICAgIHBlbmRpbmdUb2tlbnNbbXNnLnNlbmRlcl0gPSAwOw0KDQogICAgLy9BREQgUE9URU5USUFMIEJPTlVTIEJBU0VEIE9OIEhvdyBsb25nIHdhaXRlZCENCiAgICANCiAgICAvL21pbnQgV0lOIFRva2Vucw0KICAgIHdpblRva2VuSW5zdGFuY2UubWludFRva2Vucyhtc2cuc2VuZGVyLCB0b3RhbFRva2Vucyk7DQogIH0NCg0KICANCg0KICAvLyoqKi8vYmV0IG9uIE51bWJlcgkNCiAgZnVuY3Rpb24gYmV0T25OdW1iZXIodWludCBudW1iZXJDaG9zZW4pDQogICAgcGF5YWJsZQ0KICB7DQogICAgLy9jaGVjayB0aGF0IG51bWJlciBjaG9zZW4gaXMgdmFsaWQgYW5kIHJlY29yZHMgYmV0DQogICAgaWYgKG51bWJlckNob3Nlbj4zNikgdGhyb3c7DQogICAgcGxhY2VCZXQoQmV0VHlwZXMubnVtYmVyLCBudW1iZXJDaG9zZW4pOw0KICB9DQoNCiAgLy8qKiovLyBmdW5jdGlvbiBiZXRPbkNvbG9yDQogIC8vYmV0IHR5cGUgOiBjb2xvcg0KICAvL2lucHV0IDogMCBmb3IgcmVkDQogIC8vaW5wdXQgOiAxIGZvciBibGFjaw0KICBmdW5jdGlvbiBiZXRPbkNvbG9yKGJvb2wgQmxhY2spDQogICAgcGF5YWJsZQ0KICB7DQogICAgdWludCBpbnB1dDsNCiAgICBpZiAoIUJsYWNrKSANCiAgICAgIHsgDQoJaW5wdXQ9MDsNCiAgICAgIH0NCiAgICBlbHNlew0KICAgICAgaW5wdXQ9MTsNCiAgICB9DQogICAgcGxhY2VCZXQoQmV0VHlwZXMuY29sb3IsIGlucHV0KTsNCiAgfQ0KDQogIC8vKioqLy8gZnVuY3Rpb24gYmV0T25Mb3dfSGlnaA0KICAvL2JldCB0eXBlIDogbG93aGlnaA0KICAvL2lucHV0IDogMCBmb3IgbG93DQogIC8vaW5wdXQgOiAxIGZvciBsb3cNCiAgZnVuY3Rpb24gYmV0T25Mb3dIaWdoKGJvb2wgSGlnaCkNCiAgICBwYXlhYmxlDQogIHsNCiAgICB1aW50IGlucHV0Ow0KICAgIGlmICghSGlnaCkgDQogICAgICB7IA0KCWlucHV0PTA7DQogICAgICB9DQogICAgZWxzZSANCiAgICAgIHsNCglpbnB1dD0xOw0KICAgICAgfQ0KICAgIHBsYWNlQmV0KEJldFR5cGVzLmxvd2hpZ2gsIGlucHV0KTsNCiAgfQ0KDQogIC8vKioqLy8gZnVuY3Rpb24gYmV0T25PZGRFdmVuDQogIC8vYmV0IHR5cGUgOiBwYXJpdHkNCiAgLy9pbnB1dCA6IDAgZm9yIGV2ZW4NCiAgLy9pbnB1dCA6IDEgZm9yIG9kZA0KICBmdW5jdGlvbiBiZXRPbk9kZEV2ZW4oYm9vbCBPZGQpDQogICAgcGF5YWJsZQ0KICB7DQogICAgdWludCBpbnB1dDsNCiAgICBpZiAoIU9kZCkgDQogICAgICB7IA0KCWlucHV0PTA7DQogICAgICB9DQogICAgZWxzZXsNCiAgICAgIGlucHV0PTE7DQogICAgfQ0KICAgIHBsYWNlQmV0KEJldFR5cGVzLnBhcml0eSwgaW5wdXQpOw0KICB9DQoNCiAgLy8qKiovLyBmdW5jdGlvbiBiZXRPbkRvemVuDQogIC8vICAgICAvL2JldCB0eXBlIDogZG96ZW4NCiAgLy8gICAgIC8vaW5wdXQgOiAwIGZvciBmaXJzdCBkb3plbg0KICAvLyAgICAgLy9pbnB1dCA6IDEgZm9yIHNlY29uZCBkb3plbg0KICAvLyAgICAgLy9pbnB1dCA6IDIgZm9yIHRoaXJkIGRvemVuDQogIGZ1bmN0aW9uIGJldE9uRG96ZW4odWludCBkb3plbl9zZWxlY3RlZF8wXzFfMikNCiAgICBwYXlhYmxlDQoNCiAgew0KICAgIGlmIChkb3plbl9zZWxlY3RlZF8wXzFfMiA+IDIpIHRocm93Ow0KICAgIHBsYWNlQmV0KEJldFR5cGVzLmRvemVuLCBkb3plbl9zZWxlY3RlZF8wXzFfMik7DQogIH0NCg0KDQogIC8vIC8vKioqLy8gZnVuY3Rpb24gYmV0T25Db2x1bW4NCiAgLy8gICAgIC8vYmV0IHR5cGUgOiBjb2x1bW4NCiAgLy8gICAgIC8vaW5wdXQgOiAwIGZvciBmaXJzdCBjb2x1bW4NCiAgLy8gICAgIC8vaW5wdXQgOiAxIGZvciBzZWNvbmQgY29sdW1uDQogIC8vICAgICAvL2lucHV0IDogMiBmb3IgdGhpcmQgY29sdW1uDQogIGZ1bmN0aW9uIGJldE9uQ29sdW1uKHVpbnQgY29sdW1uX3NlbGVjdGVkXzBfMV8yKQ0KICAgIHBheWFibGUNCiAgew0KICAgIGlmIChjb2x1bW5fc2VsZWN0ZWRfMF8xXzIgPiAyKSB0aHJvdzsNCiAgICBwbGFjZUJldChCZXRUeXBlcy5jb2x1bW4sIGNvbHVtbl9zZWxlY3RlZF8wXzFfMik7DQogIH0NCg0KICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAgLy8gU3BpbiBUaGUgV2hlZWwgJiBDaGVjayBSZXN1bHQgRlVOQ1RJT05TLy8NCiAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCiAgZXZlbnQgV2luKGFkZHJlc3MgcGxheWVyLCB1aW50OCByZXN1bHQsIHVpbnQgdmFsdWVfd29uLCBieXRlczMyIGJIYXNoLCBieXRlczMyIHNoYTNQbGF5ZXIsIHVpbnQgZ2FtYmxlSWQsIHVpbnQgYmV0KTsNCiAgZXZlbnQgTG9zcyhhZGRyZXNzIHBsYXllciwgdWludDggcmVzdWx0LCB1aW50IHZhbHVlX2xvc3MsIGJ5dGVzMzIgYkhhc2gsIGJ5dGVzMzIgc2hhM1BsYXllciwgdWludCBnYW1ibGVJZCwgdWludCBiZXQpOw0KDQogIC8vKioqLy9mdW5jdGlvbiB0byBzcGluIGNhbGxhYmxlDQogIC8vIG5vIGV0aCBhbGxvd2VkDQogIGZ1bmN0aW9uIHNwaW5UaGVXaGVlbChhZGRyZXNzIHNwaW5fZm9yX3BsYXllcikNCiAgew0KICAgIFNwaW5UaGVXaGVlbChzcGluX2Zvcl9wbGF5ZXIpOw0KICB9DQoNCg0KICBmdW5jdGlvbiBTcGluVGhlV2hlZWwoYWRkcmVzcyBwbGF5ZXJTcGlubmVkKSBwcml2YXRlIHJldHVybnMoYm9vbCkNCiAgew0KICAgIGlmIChwbGF5ZXJTcGlubmVkPT0wKQ0KICAgICAgew0KCXBsYXllclNwaW5uZWQ9bXNnLnNlbmRlcjsgICAgICAgICAvL2lmIG5vIGluZGV4IHNwaW5zIGZvciB0aGUgc2VuZGVyDQogICAgICB9DQoNCiAgICAvL2NoZWNrIHRoYXQgcGxheWVyIGhhcyB0byBzcGluDQogICAgaWYgKHBsYXllclN0YXR1c1twbGF5ZXJTcGlubmVkXSAhPSBTdGF0dXMud2FpdGluZ0ZvclNwaW4pIHJldHVybiBmYWxzZTsNCg0KICAgIC8vcmVkdW5kZW50IGRvdWJsZSBjaGVjayA6IGNoZWNrIHRoYXQgZ2FtYmxlIGhhcyBub3QgYmVlbiBzcGlubmVkIGFscmVhZHkNCiAgICBpZiAoZ2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJTcGlubmVkXV0uc3Bpbm5lZCA9PSB0cnVlKSB0aHJvdzsNCg0KICAgIA0KICAgIC8vY2hlY2sgdGhhdCB0aGUgcGxheWVyIHdhaXRlZCBmb3IgdGhlIGRlbGF5IGJlZm9yZSBzcGluDQogICAgLy9hbmQgYWxzbyB0aGF0IHRoZSBiZXQgaXMgbm90IGV4cGlyZWQNCiAgICB1aW50IHBsYXllcmJsb2NrID0gZ2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJTcGlubmVkXV0uYmxvY2tOdW1iZXI7DQogICAgLy90b28gZWFybHkgdG8gc3Bpbg0KICAgIGlmIChibG9jay5udW1iZXIgPD0gcGxheWVyYmxvY2srYmxvY2tEZWxheSkgdGhyb3c7DQogICAgLy90b28gbGF0ZSwgYmV0IGV4cGlyZWQsIHBsYXllciBsb3N0DQogICAgZWxzZSBpZiAoYmxvY2subnVtYmVyID4gcGxheWVyYmxvY2srYmxvY2tFeHBpcmF0aW9uKSBzb2x2ZUJldChwbGF5ZXJTcGlubmVkLCAyNTUsIGZhbHNlLCAxLCAwLCAwKSA7DQogICAgLy9zcGluICENCiAgICBlbHNlDQogICAgICB7DQoJdWludDggd2hlZWxSZXN1bHQ7DQoJLy9TcGluIHRoZSB3aGVlbCwgDQoJYnl0ZXMzMiBibG9ja0hhc2g9IGJsb2NrLmJsb2NraGFzaChwbGF5ZXJibG9jaytibG9ja0RlbGF5KTsNCgkvL3NlY3VyaXR5IGNoZWNrIHRoYXQgdGhlIEhhc2ggaXMgbm90IGVtcHR5DQoJaWYgKGJsb2NrSGFzaD09MCkgdGhyb3c7DQoJLy8gZ2VuZXJhdGUgdGhlIGhhc2ggZm9yIFJORyBmcm9tIHRoZSBibG9ja0hhc2ggYW5kIHRoZSBwbGF5ZXIncyBhZGRyZXNzDQoJYnl0ZXMzMiBzaGFQbGF5ZXIgPSBzaGEzKHBsYXllclNwaW5uZWQsIGJsb2NrSGFzaCwgdGhpcyk7DQoJLy8gZ2V0IHRoZSBmaW5hbCB3aGVlbCByZXN1bHQNCgl3aGVlbFJlc3VsdCA9IHVpbnQ4KHVpbnQyNTYoc2hhUGxheWVyKSUzNyk7DQoJLy9jaGVjayByZXN1bHQgYWdhaW5zdCBiZXQgYW5kIHBheSBpZiB3aW4NCgljaGVja0JldFJlc3VsdCh3aGVlbFJlc3VsdCwgcGxheWVyU3Bpbm5lZCwgYmxvY2tIYXNoLCBzaGFQbGF5ZXIpOw0KICAgICAgfQ0KICAgIHJldHVybiB0cnVlOw0KICB9DQogICAgDQoNCiAgLy9DSEVDSyBCRVRTIEZVTkNUSU9OUyBwcml2YXRlDQogIGZ1bmN0aW9uIGNoZWNrQmV0UmVzdWx0KHVpbnQ4IHJlc3VsdCwgYWRkcmVzcyBwbGF5ZXIsIGJ5dGVzMzIgYmxvY2tIYXNoLCBieXRlczMyIHNoYVBsYXllcikgcHJpdmF0ZQ0KICB7DQogICAgQmV0VHlwZXMgYmV0VHlwZT1nYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmJldFR5cGU7DQogICAgLy9iZXQgb24gTnVtYmVyDQogICAgaWYgKGJldFR5cGU9PUJldFR5cGVzLm51bWJlcikgY2hlY2tCZXROdW1iZXIocmVzdWx0LCBwbGF5ZXIsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgICBlbHNlIGlmIChiZXRUeXBlPT1CZXRUeXBlcy5wYXJpdHkpIGNoZWNrQmV0UGFyaXR5KHJlc3VsdCwgcGxheWVyLCBibG9ja0hhc2gsIHNoYVBsYXllcik7DQogICAgZWxzZSBpZiAoYmV0VHlwZT09QmV0VHlwZXMuY29sb3IpIGNoZWNrQmV0Q29sb3IocmVzdWx0LCBwbGF5ZXIsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgICBlbHNlIGlmIChiZXRUeXBlPT1CZXRUeXBlcy5sb3doaWdoKSBjaGVja0JldExvd2hpZ2gocmVzdWx0LCBwbGF5ZXIsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgICBlbHNlIGlmIChiZXRUeXBlPT1CZXRUeXBlcy5kb3plbikgY2hlY2tCZXREb3plbihyZXN1bHQsIHBsYXllciwgYmxvY2tIYXNoLCBzaGFQbGF5ZXIpOw0KICAgIGVsc2UgaWYgKGJldFR5cGU9PUJldFR5cGVzLmNvbHVtbikgY2hlY2tCZXRDb2x1bW4ocmVzdWx0LCBwbGF5ZXIsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgfQ0KDQogIC8vIGZ1bmN0aW9uIHNvbHZlIEJldCBvbmNlIHJlc3VsdCBpcyBkZXRlcm1pbmVkIDogc2VuZHMgdG8gd2lubmVyLCBhZGRzIGxvc3MgdG8gcHJvZml0DQogIGZ1bmN0aW9uIHNvbHZlQmV0KGFkZHJlc3MgcGxheWVyLCB1aW50OCByZXN1bHQsIGJvb2wgd2luLCB1aW50OCBtdWx0aXBsaWVyLCBieXRlczMyIGJsb2NrSGFzaCwgYnl0ZXMzMiBzaGFQbGF5ZXIpIHByaXZhdGUNCiAgew0KICAgIC8vVXBkYXRlIHN0YXR1cyBhbmQgcmVjb3JkIHNwaW5uZWQNCiAgICBwbGF5ZXJTdGF0dXNbcGxheWVyXT1TdGF0dXMud2FpdGluZ0ZvckJldDsNCiAgICBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLndoZWVsUmVzdWx0PXJlc3VsdDsNCiAgICBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLnNwaW5uZWQ9dHJ1ZTsNCiAgICBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmJsb2NrU3Bpbm5lZD1ibG9jay5udW1iZXI7DQogICAgdWludCBiZXRfdiA9IGdhbWJsZXNbZ2FtYmxlSW5kZXhbcGxheWVyXV0ud2FnZXI7DQoJDQogICAgaWYgKHdpbikNCiAgICAgIHsNCglnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLndpbj10cnVlOw0KCXVpbnQgd2luX3YgPSAobXVsdGlwbGllci0xKSpiZXRfdjsNCglXaW4ocGxheWVyLCByZXN1bHQsIHdpbl92LCBibG9ja0hhc2gsIHNoYVBsYXllciwgZ2FtYmxlSW5kZXhbcGxheWVyXSwgYmV0X3YpOw0KCS8vc2VuZCB3aW4hDQoJLy9zYWZlIHNlbmQgdnMgcG90ZW50aWFsIGNhbGxzdGFjayBvdmVyZmxvd2VkIHNwaW5zDQoJaWYgKHBsYXllci5zZW5kKHdpbl92K2JldF92KT09ZmFsc2UpIHRocm93Ow0KICAgICAgfQ0KICAgIGVsc2UNCiAgICAgIHsNCglMb3NzKHBsYXllciwgcmVzdWx0LCBiZXRfdi0xLCBibG9ja0hhc2gsIHNoYVBsYXllciwgZ2FtYmxlSW5kZXhbcGxheWVyXSwgYmV0X3YpOw0KCS8vc2VuZCAxIHdlaSB0byBjb25maXJtIHNwaW4gaWYgbG9zcw0KCWlmIChwbGF5ZXIuc2VuZCgxKT09ZmFsc2UpIHRocm93Ow0KICAgICAgfQ0KDQogIH0NCg0KICAvLyBjaGVja2JldG9uIG51bWJlcihpbnB1dCkNCiAgLy8gYmV0IHR5cGUgOiBudW1iZXINCiAgLy8gaW5wdXQgOiBjaG9zZW4gbnVtYmVyDQogIGZ1bmN0aW9uIGNoZWNrQmV0TnVtYmVyKHVpbnQ4IHJlc3VsdCwgYWRkcmVzcyBwbGF5ZXIsIGJ5dGVzMzIgYmxvY2tIYXNoLCBieXRlczMyIHNoYVBsYXllcikgcHJpdmF0ZQ0KICB7DQogICAgYm9vbCB3aW47DQogICAgLy93aW4NCiAgICBpZiAocmVzdWx0PT1nYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0KQ0KICAgICAgew0KCXdpbj10cnVlOyAgDQogICAgICB9DQogICAgc29sdmVCZXQocGxheWVyLCByZXN1bHQsd2luLDM2LCBibG9ja0hhc2gsIHNoYVBsYXllcik7DQogIH0NCg0KDQogIC8vIGNoZWNrYmV0IG9uIG9kZGV2ZW4NCiAgLy8gYmV0IHR5cGUgOiBwYXJpdHkNCiAgLy8gaW5wdXQgOiAwIGZvciBldmVuLCAxIGZvciBvZGQNCiAgZnVuY3Rpb24gY2hlY2tCZXRQYXJpdHkodWludDggcmVzdWx0LCBhZGRyZXNzIHBsYXllciwgYnl0ZXMzMiBibG9ja0hhc2gsIGJ5dGVzMzIgc2hhUGxheWVyKSBwcml2YXRlDQogIHsNCiAgICBib29sIHdpbjsNCiAgICAvL3dpbg0KICAgIGlmIChyZXN1bHQlMj09Z2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5pbnB1dCAmJiByZXN1bHQhPTApDQogICAgICB7DQoJd2luPXRydWU7ICAgICAgICAgICAgICAgIA0KICAgICAgfQ0KICAgIHNvbHZlQmV0KHBsYXllcixyZXN1bHQsd2luLDIsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgfQ0KICAgIA0KICAvLyBjaGVja2JldCBvbiBsb3doaWdoDQogIC8vIGJldCB0eXBlIDogbG93aGlnaA0KICAvLyBpbnB1dCA6IDAgbG93LCAxIGhpZ2gNCiAgZnVuY3Rpb24gY2hlY2tCZXRMb3doaWdoKHVpbnQ4IHJlc3VsdCwgYWRkcmVzcyBwbGF5ZXIsIGJ5dGVzMzIgYmxvY2tIYXNoLCBieXRlczMyIHNoYVBsYXllcikgcHJpdmF0ZQ0KICB7DQogICAgYm9vbCB3aW47DQogICAgLy93aW4NCiAgICBpZiAocmVzdWx0IT0wICYmICggKHJlc3VsdDwxOSAmJiBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0wKQ0KCQkgICAgICAgfHwgKHJlc3VsdD4xOCAmJiBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0xKQ0KCQkgICAgICAgKSApDQogICAgICB7DQoJd2luPXRydWU7DQogICAgICB9DQogICAgc29sdmVCZXQocGxheWVyLHJlc3VsdCx3aW4sMiwgYmxvY2tIYXNoLCBzaGFQbGF5ZXIpOw0KICB9DQoNCiAgLy8gY2hlY2tiZXQgb24gY29sb3INCiAgLy8gYmV0IHR5cGUgOiBjb2xvcg0KICAvLyBpbnB1dCA6IDAgcmVkLCAxIGJsYWNrDQogIHVpbnRbMThdIHJlZF9saXN0PVsxLDMsNSw3LDksMTIsMTQsMTYsMTgsMTksMjEsMjMsMjUsMjcsMzAsMzIsMzQsMzZdOw0KICBmdW5jdGlvbiBjaGVja0JldENvbG9yKHVpbnQ4IHJlc3VsdCwgYWRkcmVzcyBwbGF5ZXIsIGJ5dGVzMzIgYmxvY2tIYXNoLCBieXRlczMyIHNoYVBsYXllcikgcHJpdmF0ZQ0KICB7DQogICAgYm9vbCByZWQ7DQogICAgLy9jaGVjayBpZiByZWQNCiAgICBmb3IgKHVpbnQ4IGs7IGs8MTg7IGsrKykNCiAgICAgIHsgDQoJaWYgKHJlZF9saXN0W2tdPT1yZXN1bHQpIA0KCSAgeyANCgkgICAgcmVkPXRydWU7IA0KCSAgICBicmVhazsNCgkgIH0NCiAgICAgIH0NCiAgICBib29sIHdpbjsNCiAgICAvL3dpbg0KICAgIGlmICggcmVzdWx0IT0wDQoJICYmICggKGdhbWJsZXNbZ2FtYmxlSW5kZXhbcGxheWVyXV0uaW5wdXQ9PTAgJiYgcmVkKSAgDQoJICAgICAgfHwgKCBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0xICYmICFyZWQpICApICkNCiAgICAgIHsNCgl3aW49dHJ1ZTsNCiAgICAgIH0NCiAgICBzb2x2ZUJldChwbGF5ZXIscmVzdWx0LHdpbiwyLCBibG9ja0hhc2gsIHNoYVBsYXllcik7DQogIH0NCg0KICAvLyBjaGVja2JldCBvbiBkb3plbg0KICAvLyBiZXQgdHlwZSA6IGRvemVuDQogIC8vIGlucHV0IDogMCBmaXJzdCwgMSBzZWNvbmQsIDIgdGhpcmQNCiAgZnVuY3Rpb24gY2hlY2tCZXREb3plbih1aW50OCByZXN1bHQsIGFkZHJlc3MgcGxheWVyLCBieXRlczMyIGJsb2NrSGFzaCwgYnl0ZXMzMiBzaGFQbGF5ZXIpIHByaXZhdGUNCiAgeyANCiAgICBib29sIHdpbjsNCiAgICAvL3dpbiBvbiBmaXJzdCBkb3plbg0KICAgIGlmICggcmVzdWx0IT0wICYmDQoJICggKHJlc3VsdDwxMyAmJiBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0wKQ0KCSAgIHx8DQoJICAgKHJlc3VsdD4xMiAmJiByZXN1bHQ8MjUgJiYgZ2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5pbnB1dD09MSkNCgkgICB8fA0KCSAgIChyZXN1bHQ+MjQgJiYgZ2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5pbnB1dD09MikgKSApDQogICAgICB7DQoJd2luPXRydWU7ICAgICAgICAgICAgICAgIA0KICAgICAgfQ0KICAgIHNvbHZlQmV0KHBsYXllcixyZXN1bHQsd2luLDMsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgfQ0KDQogIC8vIGNoZWNrYmV0IG9uIGNvbHVtbg0KICAvLyBiZXQgdHlwZSA6IGNvbHVtbg0KICAvLyBpbnB1dCA6IDAgZmlyc3QsIDEgc2Vjb25kLCAyIHRoaXJkDQogIGZ1bmN0aW9uIGNoZWNrQmV0Q29sdW1uKHVpbnQ4IHJlc3VsdCwgYWRkcmVzcyBwbGF5ZXIsIGJ5dGVzMzIgYmxvY2tIYXNoLCBieXRlczMyIHNoYVBsYXllcikgcHJpdmF0ZQ0KICB7DQogICAgYm9vbCB3aW47DQogICAgLy93aW4NCiAgICBpZiAoIHJlc3VsdCE9MA0KCSAmJiAoIChnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0wICYmIHJlc3VsdCUzPT0xKSAgDQoJICAgICAgfHwgKCBnYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLmlucHV0PT0xICYmIHJlc3VsdCUzPT0yKQ0KCSAgICAgIHx8ICggZ2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5pbnB1dD09MiAmJiByZXN1bHQlMz09MCkgICkgKQ0KICAgICAgew0KCXdpbj10cnVlOw0KICAgICAgfQ0KICAgIHNvbHZlQmV0KHBsYXllcixyZXN1bHQsd2luLDMsIGJsb2NrSGFzaCwgc2hhUGxheWVyKTsNCiAgfQ0KDQoNCiAgZnVuY3Rpb24gY2hlY2tNeUJldChhZGRyZXNzIHBsYXllcikgY29uc3RhbnQgcmV0dXJucyhTdGF0dXMgcGxheWVyX3N0YXR1cywgQmV0VHlwZXMgYmV0dHlwZSwgdWludCBpbnB1dCwgdWludCB2YWx1ZSwgdWludDggcmVzdWx0LCBib29sIHdoZWVsc3Bpbm5lZCwgYm9vbCB3aW4sIHVpbnQgYmxvY2tOYiwgdWludCBibG9ja1NwaW4sIHVpbnQgZ2FtYmxlSUQpDQogIHsNCiAgICBwbGF5ZXJfc3RhdHVzPXBsYXllclN0YXR1c1twbGF5ZXJdOw0KICAgIGJldHR5cGU9Z2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5iZXRUeXBlOw0KICAgIGlucHV0PWdhbWJsZXNbZ2FtYmxlSW5kZXhbcGxheWVyXV0uaW5wdXQ7DQogICAgdmFsdWU9Z2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS53YWdlcjsNCiAgICByZXN1bHQ9Z2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS53aGVlbFJlc3VsdDsNCiAgICB3aGVlbHNwaW5uZWQ9Z2FtYmxlc1tnYW1ibGVJbmRleFtwbGF5ZXJdXS5zcGlubmVkOw0KICAgIHdpbj1nYW1ibGVzW2dhbWJsZUluZGV4W3BsYXllcl1dLndpbjsNCiAgICBibG9ja05iPWdhbWJsZXNbZ2FtYmxlSW5kZXhbcGxheWVyXV0uYmxvY2tOdW1iZXI7DQogICAgYmxvY2tTcGluPWdhbWJsZXNbZ2FtYmxlSW5kZXhbcGxheWVyXV0uYmxvY2tTcGlubmVkOw0KICAgIGdhbWJsZUlEPWdhbWJsZUluZGV4W3BsYXllcl07DQogICAgcmV0dXJuOw0KICB9DQoNCiAgZnVuY3Rpb24gZ2V0VG90YWxHYW1ibGVzKCkgY29uc3RhbnQgcmV0dXJucyh1aW50KXsNCiAgICByZXR1cm4gZ2FtYmxlcy5sZW5ndGg7DQogIH0NCg0KICANCiAgZnVuY3Rpb24gZ2V0R2FtYmxlc0xpc3QodWludDI1NiBpbmRleCkgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzIHBsYXllciwgQmV0VHlwZXMgYmV0dHlwZSwgdWludCBpbnB1dCwgdWludCB2YWx1ZSwgdWludDggcmVzdWx0LCBib29sIHdoZWVsc3Bpbm5lZCwgYm9vbCB3aW4sIHVpbnQgYmxvY2tOYiwgdWludCBibG9ja1NwaW4pDQogIHsNCiAgICBwbGF5ZXI9Z2FtYmxlc1tpbmRleF0ucGxheWVyOw0KICAgIGJldHR5cGU9Z2FtYmxlc1tpbmRleF0uYmV0VHlwZTsNCiAgICBpbnB1dD1nYW1ibGVzW2luZGV4XS5pbnB1dDsNCiAgICB2YWx1ZT1nYW1ibGVzW2luZGV4XS53YWdlcjsNCiAgICByZXN1bHQ9Z2FtYmxlc1tpbmRleF0ud2hlZWxSZXN1bHQ7DQogICAgd2hlZWxzcGlubmVkPWdhbWJsZXNbaW5kZXhdLnNwaW5uZWQ7DQogICAgd2luPWdhbWJsZXNbaW5kZXhdLndpbjsNCiAgICBibG9ja05iPWdhbWJsZXNbaW5kZXhdLmJsb2NrTnVtYmVyOw0KICAgIGJsb2NrU3Bpbj1nYW1ibGVzW2luZGV4XS5ibG9ja1NwaW5uZWQ7DQogICAgcmV0dXJuOw0KICB9DQoNCn0gLy9lbmQgb2YgY29udHJhY3Q='