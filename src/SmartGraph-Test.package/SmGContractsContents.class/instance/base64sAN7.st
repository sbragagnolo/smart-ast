base 64 content
base64sAN7
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLy8gPT09PSBESVNDTEFJTUVSID09PT0NCi8vDQovLyBFVEhFUkVVTSBJUyBTVElMTCBBTiBFWFBFUkVNRU5UQUwgVEVDSE5PTE9HWS4NCi8vIEFMVEhPVUdIIFRISVMgU01BUlQgQ09OVFJBQ1QgV0FTIENSRUFURUQgV0lUSCBHUkVBVCBDQVJFIEFORCBJTiBUSEUgSE9QRSBPRiBCRUlORyBVU0VGVUwsIE5PIEdVQVJBTlRFRVMgT0YgRkxBV0xFU1MgT1BFUkFUSU9OIENBTiBCRSBHSVZFTi4NCi8vIElOIFBBUlRJQ1VMQVIgLSBTVUJUSUxFIEJVR1MsIEhBQ0tFUiBBVFRBQ0tTIE9SIE1BTEZVTkNUSU9OIE9GIFVOREVSTFlJTkcgVEVDSE5PTE9HWSBDQU4gQ0FVU0UgVU5JTlRFTlRJT05BTCBCRUhBVklPVVIuDQovLyBZT1UgQVJFIFNUUk9OR0xZIEVOQ09VUkFHRUQgVE8gU1RVRFkgVEhJUyBTTUFSVCBDT05UUkFDVCBDQVJFRlVMTFkgSU4gT1JERVIgVE8gVU5ERVJTVEFORCBQT1NTSUJMRSBFREdFIENBU0VTIEFORCBSSVNLUy4NCi8vIERPTidUIFVTRSBUSElTIFNNQVJUIENPTlRSQUNUIElGIFlPVSBIQVZFIFNVQlNUQU5USUFMIERPVUJUUyBPUiBJRiBZT1UgRE9OJ1QgS05PVyBXSEFUIFlPVSBBUkUgRE9JTkcuDQovLw0KLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiIEFORCBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQ0KLy8gQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULA0KLy8gSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwNCi8vIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLA0KLy8gT1IgVE9SVCAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS4NCi8vID09PT0NCi8vDQoNCi8vLyBAYXV0aG9yIFNhbnRpbWVudCBMTEMNCi8vLyBAdGl0bGUgIENyb3dkc2FsZU1pbnRlcg0KDQpjb250cmFjdCBCYXNlIHsNCg0KICAgIGZ1bmN0aW9uIG1heCh1aW50IGEsIHVpbnQgYikgcmV0dXJucyAodWludCkgeyByZXR1cm4gYSA+PSBiID8gYSA6IGI7IH0NCiAgICBmdW5jdGlvbiBtaW4odWludCBhLCB1aW50IGIpIHJldHVybnMgKHVpbnQpIHsgcmV0dXJuIGEgPD0gYiA/IGEgOiBiOyB9DQoNCiAgICBtb2RpZmllciBvbmx5KGFkZHJlc3MgYWxsb3dlZCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBhbGxvd2VkKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCg0KICAgIC8vL0ByZXR1cm4gVHJ1ZSBpZiBgX2FkZHJgIGlzIGEgY29udHJhY3QNCiAgICBmdW5jdGlvbiBpc0NvbnRyYWN0KGFkZHJlc3MgX2FkZHIpIGNvbnN0YW50IGludGVybmFsIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgaWYgKF9hZGRyID09IDApIHJldHVybiBmYWxzZTsNCiAgICAgICAgdWludCBzaXplOw0KICAgICAgICBhc3NlbWJseSB7DQogICAgICAgICAgICBzaXplIDo9IGV4dGNvZGVzaXplKF9hZGRyKQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAoc2l6ZSA+IDApOw0KICAgIH0NCg0KICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAgICAvLyAqICAgICAgICAgIHJlZW50cmFuY3kgaGFuZGxpbmcgICAgICAgICAgICAgICAgICAqDQogICAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQogICAgLy9AZGV2IHByZWRlZmluZWQgbG9ja3MgKHVwIHRvIHVpbnQgYml0IGxlbmd0aCwgaS5lLiAyNTYgcG9zc2libGUpDQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDAgPSAyICoqIDA7DQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDEgPSAyICoqIDE7DQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDIgPSAyICoqIDI7DQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDMgPSAyICoqIDM7DQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDQgPSAyICoqIDQ7DQogICAgdWludCBjb25zdGFudCBpbnRlcm5hbCBMMDUgPSAyICoqIDU7DQoNCiAgICAvL3ByZXZlbnRzIHJlZW50cmFuY3kgYXR0YWNzOiBzcGVjaWZpYyBsb2Nrcw0KICAgIHVpbnQgcHJpdmF0ZSBiaXRsb2NrcyA9IDA7DQogICAgbW9kaWZpZXIgbm9SZWVudHJhbmN5KHVpbnQgbSkgew0KICAgICAgICB2YXIgX2xvY2tzID0gYml0bG9ja3M7DQogICAgICAgIGlmIChfbG9ja3MgJiBtID4gMCkgdGhyb3c7DQogICAgICAgIGJpdGxvY2tzIHw9IG07DQogICAgICAgIF87DQogICAgICAgIGJpdGxvY2tzID0gX2xvY2tzOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG5vQW55UmVlbnRyYW5jeSB7DQogICAgICAgIHZhciBfbG9ja3MgPSBiaXRsb2NrczsNCiAgICAgICAgaWYgKF9sb2NrcyA+IDApIHRocm93Ow0KICAgICAgICBiaXRsb2NrcyA9IHVpbnQoLTEpOw0KICAgICAgICBfOw0KICAgICAgICBiaXRsb2NrcyA9IF9sb2NrczsNCiAgICB9DQoNCiAgICAvLy9AZGV2IGVtcHR5IG1hcmtpbmcgbW9kaWZpZXIgc2lnbmFsaW5nIHRvIHVzZXIgb2YgdGhlIG1hcmtlZCBmdW5jdGlvbiAsIHRoYXQgaXQgY2FuIGNhdXNlIGFuIHJlZW50cmFudCBjYWxsLg0KICAgIC8vLyAgICAgZGV2ZWxvcGVyIHNob3VsZCBtYWtlIHRoZSBjYWxsZXIgZnVuY3Rpb24gcmVlbnRyYW50LXNhZmUgaWYgaXQgdXNlIGEgcmVlbnRyYW50IGZ1bmN0aW9uLg0KICAgIG1vZGlmaWVyIHJlZW50cmFudCB7IF87IH0NCg0KfQ0KDQpjb250cmFjdCBPd25lZCBpcyBCYXNlIHsNCg0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KICAgIGFkZHJlc3MgcHVibGljIG5ld093bmVyOw0KDQogICAgZnVuY3Rpb24gT3duZWQoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgb25seShvd25lcikgew0KICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSBvbmx5KG5ld093bmVyKSB7DQogICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7DQogICAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KDQogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsNCg0KfQ0KDQoNCmNvbnRyYWN0IEVSQzIwIGlzIE93bmVkIHsNCg0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpOw0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc1N0YXJ0ZWRPbmx5IHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7DQogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dICs9IF92YWx1ZTsNCiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBpc1N0YXJ0ZWRPbmx5IHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF92YWx1ZSAmJiBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgYmFsYW5jZXNbX3RvXSArIF92YWx1ZSA+IGJhbGFuY2VzW190b10pIHsNCiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX2Zyb21dIC09IF92YWx1ZTsNCiAgICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgaXNTdGFydGVkT25seSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBfdmFsdWUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKSB7DQogICAgICAgIHJldHVybiBhbGxvd2VkW19vd25lcl1bX3NwZW5kZXJdOw0KICAgIH0NCg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KDQogICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQogICAgYm9vbCAgICBwdWJsaWMgaXNTdGFydGVkID0gZmFsc2U7DQoNCiAgICBtb2RpZmllciBvbmx5SG9sZGVyKGFkZHJlc3MgaG9sZGVyKSB7DQogICAgICAgIGlmIChiYWxhbmNlT2YoaG9sZGVyKSA9PSAwKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc1N0YXJ0ZWRPbmx5KCkgew0KICAgICAgICBpZiAoIWlzU3RhcnRlZCkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQp9DQoNCg0KY29udHJhY3QgU3Vic2NyaXB0aW9uTW9kdWxlIHsNCiAgICBmdW5jdGlvbiBhdHRhY2hUb2tlbihhZGRyZXNzIGFkZHIpIHB1YmxpYyA7DQp9DQoNCmNvbnRyYWN0IFNBTiBpcyBPd25lZCwgRVJDMjAgew0KDQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBuYW1lICAgICA9ICJTQU50aW1lbnQgbmV0d29yayB0b2tlbiI7DQogICAgc3RyaW5nIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgICA9ICJTQU4iOw0KICAgIHVpbnQ4ICBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxNTsNCg0KICAgIGFkZHJlc3MgQ1JPV0RTQUxFX01JTlRFUiA9IDB4RGEyQ2Y4MTBjNTcxODEzNTI0NzYyODY4OUQ4NEY5NGM2MUI0MWQ2QTsNCiAgICBhZGRyZXNzIHB1YmxpYyBTVUJTQ1JJUFRJT05fTU9EVUxFID0gMHgwMDAwMDAwMDsNCiAgICBhZGRyZXNzIHB1YmxpYyBiZW5lZmljaWFyeTsNCg0KICAgIHVpbnQgcHVibGljIFBMQVRGT1JNX0ZFRV9QRVJfMTAwMDAgPSAxOyAvLzAuMDElDQogICAgdWludCBwdWJsaWMgdG90YWxPbkRlcG9zaXQ7DQogICAgdWludCBwdWJsaWMgdG90YWxJbkNpcmN1bGF0aW9uOw0KDQogICAgLy8vQGRldiBjb25zdHJ1Y3Rvcg0KICAgIGZ1bmN0aW9uIFNBTigpIHsNCiAgICAgICAgYmVuZWZpY2lhcnkgPSBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgLy8gRG9uJ3QgYWNjZXB0IGV0aGVycw0KICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhyb3c7DQogICAgfQ0KDQogICAgLy89PT09PT09PSBTRUNUSU9OIENvbmZpZ3VyYXRpb246IE93bmVyIG9ubHkgPT09PT09PT0NCiAgICAvLw0KICAgIC8vL0Bub3RpY2Ugc2V0IGJlbmVmaWNpYXJ5IC0gdGhlIGFjY291bnQgcmVjZWl2aW5nIHBsYXRmb3JtIGZlZXMuDQogICAgZnVuY3Rpb24gc2V0QmVuZWZpY2lhcnkoYWRkcmVzcyBuZXdCZW5lZmljaWFyeSkNCiAgICBleHRlcm5hbA0KICAgIG9ubHkob3duZXIpIHsNCiAgICAgICAgYmVuZWZpY2lhcnkgPSBuZXdCZW5lZmljaWFyeTsNCiAgICB9DQoNCg0KICAgIC8vL0Bub3RpY2UgYXR0YWNoIG1vZHVsZSBtYW5hZ2luZyBzdWJzY3JpcHRpb25zLiBpZiBzdWJNb2R1bGU9PTB4MCwgdGhlbiBkaXNhYmxlcyBzdWJzY3JpcHRpb24gZnVuY3Rpb25hbGl0eSBmb3IgdGhpcyB0b2tlbi4NCiAgICAvLy8gZGV0YWNoZWQgbW9kdWxlIGNhbiB1c3VhbGx5IG1hbmFnZSBzdWJzY3JpcHRpb25zLCBidXQgYWxsIG9wZXJhdGlvbnMgY2hhbmdpbmcgdG9rZW4gYmFsYW5jZXMgYXJlIGRpc2FibGVkLg0KICAgIGZ1bmN0aW9uIGF0dGFjaFN1YnNjcmlwdGlvbk1vZHVsZShTdWJzY3JpcHRpb25Nb2R1bGUgc3ViTW9kdWxlKQ0KICAgIG5vQW55UmVlbnRyYW5jeQ0KICAgIGV4dGVybmFsDQogICAgb25seShvd25lcikgew0KICAgICAgICBTVUJTQ1JJUFRJT05fTU9EVUxFID0gc3ViTW9kdWxlOw0KICAgICAgICBpZiAoYWRkcmVzcyhzdWJNb2R1bGUpID4gMCkgc3ViTW9kdWxlLmF0dGFjaFRva2VuKHRoaXMpOw0KICAgIH0NCg0KICAgIC8vL0Bub3RpY2Ugc2V0IHBsYXRmb3JtIGZlZSBkZW5vbWluYXRlZCBpbiAxLzEwMDAwIG9mIFNBTiB0b2tlbi4gVGh1cyAiMSIgbWVhbnMgMC4wMSUgb2YgU0FOIHRva2VuLg0KICAgIGZ1bmN0aW9uIHNldFBsYXRmb3JtRmVlUGVyMTAwMDAodWludCBuZXdGZWUpDQogICAgZXh0ZXJuYWwNCiAgICBvbmx5KG93bmVyKSB7DQogICAgICAgIHJlcXVpcmUgKG5ld0ZlZSA8PSAxMDAwMCk7IC8vZm9ybWFsbHkgbWF4aW11bSBmZWUgaXMgMTAwJSAoY29tcGxldGVseSBpbnNhbmUgYnV0IHRlY2huaWNhbGx5IHBvc3NpYmxlKQ0KICAgICAgICBQTEFURk9STV9GRUVfUEVSXzEwMDAwID0gbmV3RmVlOw0KICAgIH0NCg0KDQogICAgLy89PT09PT09PSBJbnRlcmZhY2UgWFJhdGVQcm92aWRlcjogYSB0cml2aWFsIGV4Y2hhbmdlIHJhdGUgcHJvdmlkZXIuIFJhdGUgaXMgMToxIGFuZCBTQU4gc3ltYm9sIGFzIHRoZSBjb2RlDQogICAgLy8NCiAgICAvLy9AZGV2IHVzZWQgYXMgYSBkZWZhdWx0IFhSYXRlUHJvdmlkZXIgKGlkPT0wKSBieSBzdWJzY3JpcHRpb24gbW9kdWxlLg0KICAgIC8vL0Bub3RpY2UgcmV0dXJucyBhbHdheXMgMSBiZWNhdXNlIGV4Y2hhbmdlIHJhdGUgb2YgdGhlIHRva2VuIHRvIGl0c2VsZiBpcyBhbHdheXMgMS4NCiAgICBmdW5jdGlvbiBnZXRSYXRlKCkgcmV0dXJucyh1aW50MzIgLHVpbnQzMikgeyByZXR1cm4gKDEsMSk7ICB9DQogICAgZnVuY3Rpb24gZ2V0Q29kZSgpIHB1YmxpYyByZXR1cm5zKHN0cmluZykgIHsgcmV0dXJuIHN5bWJvbDsgfQ0KDQoNCiAgICAvLz09PT0gSW50ZXJmYWNlIEVSQzIwTW9kdWxlU3VwcG9ydDogU3Vic2NyaXB0aW9uLCBEZXBvc2l0IGFuZCBQYXltZW50IFN1cHBvcnQgPT09PT0NCiAgICAvLy8NCiAgICAvLy9AZGV2IHVzZWQgYnkgc3Vic2NyaXB0aW9uIG1vZHVsZSB0byBvcGVyYXRlIG9uIHRva2VuIGJhbGFuY2VzLg0KICAgIC8vL0BwYXJhbSBtc2dfc2VuZGVyIHNob3VsZCBiZSBhbiBvcmlnaW5hbCBtc2cuc2VuZGVyIHByb3ZpZGVkIHRvIHN1YnNjcmlwdGlvbiBtb2R1bGUuDQogICAgZnVuY3Rpb24gX2Z1bGZpbGxQcmVhcHByb3ZlZFBheW1lbnQoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBhZGRyZXNzIG1zZ19zZW5kZXIpDQogICAgcHVibGljDQogICAgb25seVRydXN0ZWQNCiAgICByZXR1cm5zKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBzdWNjZXNzID0gX2Zyb20gIT0gbXNnX3NlbmRlciAmJiBhbGxvd2VkW19mcm9tXVttc2dfc2VuZGVyXSA+PSBfdmFsdWU7DQogICAgICAgIGlmICghc3VjY2Vzcykgew0KICAgICAgICAgICAgUGF5bWVudChfZnJvbSwgX3RvLCBfdmFsdWUsIF9mZWUoX3ZhbHVlKSwgbXNnX3NlbmRlciwgUGF5bWVudFN0YXR1cy5BUFBST1ZBTF9FUlJPUiwgMCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdWNjZXNzID0gX2Z1bGZpbGxQYXltZW50KF9mcm9tLCBfdG8sIF92YWx1ZSwgMCwgbXNnX3NlbmRlcik7DQogICAgICAgICAgICBpZiAoc3VjY2Vzcykgew0KICAgICAgICAgICAgICAgIGFsbG93ZWRbX2Zyb21dW21zZ19zZW5kZXJdIC09IF92YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gc3VjY2VzczsNCiAgICB9DQoNCiAgICAvLy9AZGV2IHVzZWQgYnkgc3Vic2NyaXB0aW9uIG1vZHVsZSB0byBvcGVyYXRlIG9uIHRva2VuIGJhbGFuY2VzLg0KICAgIC8vL0BwYXJhbSBtc2dfc2VuZGVyIHNob3VsZCBiZSBhbiBvcmlnaW5hbCBtc2cuc2VuZGVyIHByb3ZpZGVkIHRvIHN1YnNjcmlwdGlvbiBtb2R1bGUuDQogICAgZnVuY3Rpb24gX2Z1bGZpbGxQYXltZW50KGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgdWludCBzdWJJZCwgYWRkcmVzcyBtc2dfc2VuZGVyKQ0KICAgIHB1YmxpYw0KICAgIG9ubHlUcnVzdGVkDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHZhciBmZWUgPSBfZmVlKF92YWx1ZSk7DQogICAgICAgIGFzc2VydCAoZmVlIDw9IF92YWx1ZSk7IC8vaW50ZXJuYWwgc2FuaXR5IGNoZWNrDQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGJhbGFuY2VzW190b10gKyBfdmFsdWUgPiBiYWxhbmNlc1tfdG9dKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfZnJvbV0gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSArPSBfdmFsdWUgLSBmZWU7DQogICAgICAgICAgICBiYWxhbmNlc1tiZW5lZmljaWFyeV0gKz0gZmVlOw0KICAgICAgICAgICAgUGF5bWVudChfZnJvbSwgX3RvLCBfdmFsdWUsIGZlZSwgbXNnX3NlbmRlciwgUGF5bWVudFN0YXR1cy5PSywgc3ViSWQpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBQYXltZW50KF9mcm9tLCBfdG8sIF92YWx1ZSwgZmVlLCBtc2dfc2VuZGVyLCBQYXltZW50U3RhdHVzLkJBTEFOQ0VfRVJST1IsIHN1YklkKTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIF9mZWUodWludCBfdmFsdWUpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQgZmVlKSB7DQogICAgICAgIHJldHVybiBfdmFsdWUgKiBQTEFURk9STV9GRUVfUEVSXzEwMDAwIC8gMTAwMDA7DQogICAgfQ0KDQogICAgLy8vQG5vdGljZSB1c2VkIGJ5IHN1YnNjcmlwdGlvbiBtb2R1bGUgdG8gcmUtY3JlYXRlIHRva2VuIGZyb20gcmV0dXJuaW5nIGRlcG9zaXQuDQogICAgLy8vQGRldiBhIHN1YnNjcmlwdGlvbiBtb2R1bGUgaXMgcmVzcG9uc2libGUgdG8gY29ycmVjdCBkZXBvc2l0IG1hbmFnZW1lbnQuDQogICAgZnVuY3Rpb24gX21pbnRGcm9tRGVwb3NpdChhZGRyZXNzIG93bmVyLCB1aW50IGFtb3VudCkNCiAgICBwdWJsaWMNCiAgICBvbmx5VHJ1c3RlZCB7DQogICAgICAgIGJhbGFuY2VzW293bmVyXSArPSBhbW91bnQ7DQogICAgICAgIHRvdGFsT25EZXBvc2l0IC09IGFtb3VudDsNCiAgICAgICAgdG90YWxJbkNpcmN1bGF0aW9uICs9IGFtb3VudDsNCiAgICB9DQoNCiAgICAvLy9Abm90aWNlIHVzZWQgYnkgc3Vic2NyaXB0aW9uIG1vZHVsZSB0byBidXJuIHRva2VuIHdoaWxlIGNyZWF0aW5nIGEgbmV3IGRlcG9zaXQuDQogICAgLy8vQGRldiBhIHN1YnNjcmlwdGlvbiBtb2R1bGUgaXMgcmVzcG9uc2libGUgdG8gY3JlYXRlIGFuZCBtYWludGFpbiB0aGUgZGVwb3NpdCByZWNvcmQuDQogICAgZnVuY3Rpb24gX2J1cm5Gb3JEZXBvc2l0KGFkZHJlc3Mgb3duZXIsIHVpbnQgYW1vdW50KQ0KICAgIHB1YmxpYw0KICAgIG9ubHlUcnVzdGVkDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1tvd25lcl0gPj0gYW1vdW50KSB7DQogICAgICAgICAgICBiYWxhbmNlc1tvd25lcl0gLT0gYW1vdW50Ow0KICAgICAgICAgICAgdG90YWxPbkRlcG9zaXQgKz0gYW1vdW50Ow0KICAgICAgICAgICAgdG90YWxJbkNpcmN1bGF0aW9uIC09IGFtb3VudDsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0NCiAgICB9DQoNCiAgICAvLz09PT09PT09PSBDcm93ZHNhbGUgT25seSA9PT09PT09PT09PT09PT0NCiAgICAvLy9Abm90aWNlIG1pbnQgbmV3IHRva2VuIGZvciBnaXZlbiBhY2NvdW50IGluIGNyb3dkc2FsZSBzdGFnZQ0KICAgIC8vL0BkZXYgYWxsb3dlZCBvbmx5IGlmIHRva2VuIG5vdCBzdGFydGVkIHlldCBhbmQgb25seSBmb3IgcmVnaXN0ZXJlZCBtaW50ZXIuDQogICAgLy8vQGRldiB0b2tlbnMgYXJlIGJlY29tZSBpbiBjaXJjdWxhdGlvbiBhZnRlciB0b2tlbiBzdGFydC4NCiAgICBmdW5jdGlvbiBtaW50KHVpbnQgYW1vdW50LCBhZGRyZXNzIGFjY291bnQpDQogICAgb25seUNyb3dkc2FsZU1pbnRlcg0KICAgIGlzTm90U3RhcnRlZE9ubHkNCiAgICB7DQogICAgICAgIHRvdGFsU3VwcGx5ICs9IGFtb3VudDsNCiAgICAgICAgYmFsYW5jZXNbYWNjb3VudF0rPWFtb3VudDsNCiAgICB9DQoNCiAgICAvLy9Abm90aWNlIHN0YXJ0IG5vcm1hbCBvcGVyYXRpb24gb2YgdGhlIHRva2VuLiBObyBtaW50aW5nIGlzIHBvc3NpYmxlIGFmdGVyIHRoaXMgcG9pbnQuDQogICAgZnVuY3Rpb24gc3RhcnQoKQ0KICAgIGlzTm90U3RhcnRlZE9ubHkNCiAgICBvbmx5KG93bmVyKSB7DQogICAgICAgIHRvdGFsSW5DaXJjdWxhdGlvbiA9IHRvdGFsU3VwcGx5Ow0KICAgICAgICBpc1N0YXJ0ZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIC8vPT09PT09PT09IFNFQ1RJT046IE1vZGlmaWVyID09PT09PT09PT09PT09PQ0KDQogICAgbW9kaWZpZXIgb25seUNyb3dkc2FsZU1pbnRlcigpIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gQ1JPV0RTQUxFX01JTlRFUikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seVRydXN0ZWQoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IFNVQlNDUklQVElPTl9NT0RVTEUpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8vL0BkZXYgdG9rZW4gbm90IHN0YXJ0ZWQgbWVhbnMgbWludGluZyBpcyBwb3NzaWJsZSwgYnV0IHVzdWFsIHRva2VuIG9wZXJhdGlvbnMgYXJlIG5vdC4NCiAgICBtb2RpZmllciBpc05vdFN0YXJ0ZWRPbmx5KCkgew0KICAgICAgICBpZiAoaXNTdGFydGVkKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBlbnVtIFBheW1lbnRTdGF0dXMge09LLCBCQUxBTkNFX0VSUk9SLCBBUFBST1ZBTF9FUlJPUn0NCiAgICAvLy9Abm90aWNlIGV2ZW50IGlzc3VlZCBvbiBhbnkgZmVlIGJhc2VkIHBheW1lbnQgKG1hZGUgb2YgZmFpbGVkKS4NCiAgICAvLy9AcGFyYW0gc3ViSWQgLSByZWxhdGVkIHN1YnNjcmlwdGlvbiBJZCBpZiBhbnksIG9yIHplcm8gb3RoZXJ3aXNlLg0KICAgIGV2ZW50IFBheW1lbnQoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCB1aW50IF9mZWUsIGFkZHJlc3MgY2FsbGVyLCBQYXltZW50U3RhdHVzIHN0YXR1cywgdWludCBzdWJJZCk7DQoNCn0vL2NvbnRyYWN0IFNBTg=='