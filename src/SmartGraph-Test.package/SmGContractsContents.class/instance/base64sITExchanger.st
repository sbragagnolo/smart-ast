base 64 content
base64sITExchanger
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLyoNCiAgQ29weXJpZ2h0IDIwMTcsIEFudG9uIEVnb3JvdiAoTW90aGVyc2hpcCBGb3VuZGF0aW9uKQ0KICBDb3B5cmlnaHQgMjAxNywgS2xhdXMgSG90dCAoQmxvY2tjaGFpbkxhYnMubnopDQogIENvcHlyaWdodCAyMDE3LCBKb3JnZSBJenF1aWVyZG8gKEFyYWdvbiBGb3VuZGF0aW9uKQ0KICBDb3B5cmlnaHQgMjAxNywgSm9yZGkgQmF5bGluYSAoR2l2ZXRoKQ0KDQogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNCiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCg0KICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiovDQoNCmxpYnJhcnkgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwDQogICAgdWludCBjID0gYSAvIGI7DQogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgIGFzc2VydChjID49IGEpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCn0NCg0KY29udHJhY3QgQ29udHJvbGxlZCB7DQogIC8vLyBAbm90aWNlIFRoZSBhZGRyZXNzIG9mIHRoZSBjb250cm9sbGVyIGlzIHRoZSBvbmx5IGFkZHJlc3MgdGhhdCBjYW4gY2FsbA0KICAvLy8gIGEgZnVuY3Rpb24gd2l0aCB0aGlzIG1vZGlmaWVyDQogIG1vZGlmaWVyIG9ubHlDb250cm9sbGVyIHsgaWYgKG1zZy5zZW5kZXIgIT0gY29udHJvbGxlcikgdGhyb3c7IF87IH0NCg0KICBhZGRyZXNzIHB1YmxpYyBjb250cm9sbGVyOw0KDQogIGZ1bmN0aW9uIENvbnRyb2xsZWQoKSB7IGNvbnRyb2xsZXIgPSBtc2cuc2VuZGVyO30NCg0KICAvLy8gQG5vdGljZSBDaGFuZ2VzIHRoZSBjb250cm9sbGVyIG9mIHRoZSBjb250cmFjdA0KICAvLy8gQHBhcmFtIF9uZXdDb250cm9sbGVyIFRoZSBuZXcgY29udHJvbGxlciBvZiB0aGUgY29udHJhY3QNCiAgZnVuY3Rpb24gY2hhbmdlQ29udHJvbGxlcihhZGRyZXNzIF9uZXdDb250cm9sbGVyKSBvbmx5Q29udHJvbGxlciB7DQogICAgY29udHJvbGxlciA9IF9uZXdDb250cm9sbGVyOw0KICB9DQp9DQoNCmNvbnRyYWN0IFJlZnVuZGFibGUgew0KICBmdW5jdGlvbiByZWZ1bmQoYWRkcmVzcyB0aCwgdWludCBhbW91bnQpIHJldHVybnMgKGJvb2wpOw0KfQ0KDQovLy8gQGRldiBUaGUgdG9rZW4gY29udHJvbGxlciBjb250cmFjdCBtdXN0IGltcGxlbWVudCB0aGVzZSBmdW5jdGlvbnMNCmNvbnRyYWN0IFRva2VuQ29udHJvbGxlciB7DQogIC8vLyBAbm90aWNlIENhbGxlZCB3aGVuIGBfb3duZXJgIHNlbmRzIGV0aGVyIHRvIHRoZSBNaW5pTWUgVG9rZW4gY29udHJhY3QNCiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCBzZW50IHRoZSBldGhlciB0byBjcmVhdGUgdG9rZW5zDQogIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIGV0aGVyIGlzIGFjY2VwdGVkLCBmYWxzZSBpZiBpdCB0aHJvd3MNCiAgZnVuY3Rpb24gcHJveHlQYXltZW50KGFkZHJlc3MgX293bmVyKSBwYXlhYmxlIHJldHVybnMoYm9vbCk7DQoNCiAgLy8vIEBub3RpY2UgTm90aWZpZXMgdGhlIGNvbnRyb2xsZXIgYWJvdXQgYSB0b2tlbiB0cmFuc2ZlciBhbGxvd2luZyB0aGUNCiAgLy8vICBjb250cm9sbGVyIHRvIHJlYWN0IGlmIGRlc2lyZWQNCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgb3JpZ2luIG9mIHRoZSB0cmFuc2Zlcg0KICAvLy8gQHBhcmFtIF90byBUaGUgZGVzdGluYXRpb24gb2YgdGhlIHRyYW5zZmVyDQogIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IG9mIHRoZSB0cmFuc2Zlcg0KICAvLy8gQHJldHVybiBGYWxzZSBpZiB0aGUgY29udHJvbGxlciBkb2VzIG5vdCBhdXRob3JpemUgdGhlIHRyYW5zZmVyDQogIGZ1bmN0aW9uIG9uVHJhbnNmZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX2Ftb3VudCkgcmV0dXJucyhib29sKTsNCg0KICAvLy8gQG5vdGljZSBOb3RpZmllcyB0aGUgY29udHJvbGxlciBhYm91dCBhbiBhcHByb3ZhbCBhbGxvd2luZyB0aGUNCiAgLy8vICBjb250cm9sbGVyIHRvIHJlYWN0IGlmIGRlc2lyZWQNCiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgdGhhdCBjYWxscyBgYXBwcm92ZSgpYA0KICAvLy8gQHBhcmFtIF9zcGVuZGVyIFRoZSBzcGVuZGVyIGluIHRoZSBgYXBwcm92ZSgpYCBjYWxsDQogIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgYW1vdW50IGluIHRoZSBgYXBwcm92ZSgpYCBjYWxsDQogIC8vLyBAcmV0dXJuIEZhbHNlIGlmIHRoZSBjb250cm9sbGVyIGRvZXMgbm90IGF1dGhvcml6ZSB0aGUgYXBwcm92YWwNCiAgZnVuY3Rpb24gb25BcHByb3ZlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyLCB1aW50IF9hbW91bnQpDQogICAgcmV0dXJucyhib29sKTsNCn0NCg0KY29udHJhY3QgRVJDMjBUb2tlbiB7DQogIC8qIFRoaXMgaXMgYSBzbGlnaHQgY2hhbmdlIHRvIHRoZSBFUkMyMCBiYXNlIHN0YW5kYXJkLg0KICAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgc3VwcGx5KTsNCiAgICAgaXMgcmVwbGFjZWQgd2l0aDoNCiAgICAgdWludDI1NiBwdWJsaWMgdG90YWxTdXBwbHk7DQogICAgIFRoaXMgYXV0b21hdGljYWxseSBjcmVhdGVzIGEgZ2V0dGVyIGZ1bmN0aW9uIGZvciB0aGUgdG90YWxTdXBwbHkuDQogICAgIFRoaXMgaXMgbW92ZWQgdG8gdGhlIGJhc2UgY29udHJhY3Qgc2luY2UgcHVibGljIGdldHRlciBmdW5jdGlvbnMgYXJlIG5vdA0KICAgICBjdXJyZW50bHkgcmVjb2duaXNlZCBhcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgbWF0Y2hpbmcgYWJzdHJhY3QNCiAgICAgZnVuY3Rpb24gYnkgdGhlIGNvbXBpbGVyLg0KICAqLw0KICAvLy8gdG90YWwgYW1vdW50IG9mIHRva2Vucw0KICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7DQoNCiAgLy8vIEBwYXJhbSBfb3duZXIgVGhlIGFkZHJlc3MgZnJvbSB3aGljaCB0aGUgYmFsYW5jZSB3aWxsIGJlIHJldHJpZXZlZA0KICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZQ0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgYmFsYW5jZSk7DQoNCiAgLy8vIEBub3RpY2Ugc2VuZCBgX3ZhbHVlYCB0b2tlbiB0byBgX3RvYCBmcm9tIGBtc2cuc2VuZGVyYA0KICAvLy8gQHBhcmFtIF90byBUaGUgYWRkcmVzcyBvZiB0aGUgcmVjaXBpZW50DQogIC8vLyBAcGFyYW0gX3ZhbHVlIFRoZSBhbW91bnQgb2YgdG9rZW4gdG8gYmUgdHJhbnNmZXJyZWQNCiAgLy8vIEByZXR1cm4gV2hldGhlciB0aGUgdHJhbnNmZXIgd2FzIHN1Y2Nlc3NmdWwgb3Igbm90DQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAvLy8gQG5vdGljZSBzZW5kIGBfdmFsdWVgIHRva2VuIHRvIGBfdG9gIGZyb20gYF9mcm9tYCBvbiB0aGUgY29uZGl0aW9uIGl0IGlzIGFwcHJvdmVkIGJ5IGBfZnJvbWANCiAgLy8vIEBwYXJhbSBfZnJvbSBUaGUgYWRkcmVzcyBvZiB0aGUgc2VuZGVyDQogIC8vLyBAcGFyYW0gX3RvIFRoZSBhZGRyZXNzIG9mIHRoZSByZWNpcGllbnQNCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbiB0byBiZSB0cmFuc2ZlcnJlZA0KICAvLy8gQHJldHVybiBXaGV0aGVyIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCBvciBub3QNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCg0KICAvLy8gQG5vdGljZSBgbXNnLnNlbmRlcmAgYXBwcm92ZXMgYF9zcGVuZGVyYCB0byBzcGVuZCBgX3ZhbHVlYCB0b2tlbnMNCiAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMNCiAgLy8vIEBwYXJhbSBfdmFsdWUgVGhlIGFtb3VudCBvZiB0b2tlbnMgdG8gYmUgYXBwcm92ZWQgZm9yIHRyYW5zZmVyDQogIC8vLyBAcmV0dXJuIFdoZXRoZXIgdGhlIGFwcHJvdmFsIHdhcyBzdWNjZXNzZnVsIG9yIG5vdA0KICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQogIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIG9mIHRoZSBhY2NvdW50IG93bmluZyB0b2tlbnMNCiAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgYWNjb3VudCBhYmxlIHRvIHRyYW5zZmVyIHRoZSB0b2tlbnMNCiAgLy8vIEByZXR1cm4gQW1vdW50IG9mIHJlbWFpbmluZyB0b2tlbnMgYWxsb3dlZCB0byBzcGVudA0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBfb3duZXIsIGFkZHJlc3MgX3NwZW5kZXIpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgcmVtYWluaW5nKTsNCg0KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3ZhbHVlKTsNCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQp9DQoNCmNvbnRyYWN0IEJ1cm5hYmxlIGlzIENvbnRyb2xsZWQgew0KICAvLy8gQG5vdGljZSBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJvbGxlciBpcyB0aGUgb25seSBhZGRyZXNzIHRoYXQgY2FuIGNhbGwNCiAgLy8vICBhIGZ1bmN0aW9uIHdpdGggdGhpcyBtb2RpZmllciwgYWxzbyB0aGUgYnVybmVyIGNhbiBjYWxsIGJ1dCBhbHNvIHRoZQ0KICAvLy8gdGFyZ2V0IG9mIHRoZSBmdW5jdGlvbiBtdXN0IGJlIHRoZSBidXJuZXINCiAgbW9kaWZpZXIgb25seUNvbnRyb2xsZXJPckJ1cm5lcihhZGRyZXNzIHRhcmdldCkgew0KICAgIGFzc2VydChtc2cuc2VuZGVyID09IGNvbnRyb2xsZXIgfHwgKG1zZy5zZW5kZXIgPT0gYnVybmVyICYmIG1zZy5zZW5kZXIgPT0gdGFyZ2V0KSk7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlCdXJuZXIgew0KICAgIGFzc2VydChtc2cuc2VuZGVyID09IGJ1cm5lcik7DQogICAgXzsNCiAgfQ0KICBhZGRyZXNzIHB1YmxpYyBidXJuZXI7DQoNCiAgZnVuY3Rpb24gQnVybmFibGUoKSB7IGJ1cm5lciA9IG1zZy5zZW5kZXI7fQ0KDQogIC8vLyBAbm90aWNlIENoYW5nZXMgdGhlIGJ1cm5lciBvZiB0aGUgY29udHJhY3QNCiAgLy8vIEBwYXJhbSBfbmV3QnVybmVyIFRoZSBuZXcgYnVybmVyIG9mIHRoZSBjb250cmFjdA0KICBmdW5jdGlvbiBjaGFuZ2VCdXJuZXIoYWRkcmVzcyBfbmV3QnVybmVyKSBvbmx5QnVybmVyIHsNCiAgICBidXJuZXIgPSBfbmV3QnVybmVyOw0KICB9DQp9DQoNCmNvbnRyYWN0IE1pbmlNZVRva2VuSSBpcyBFUkMyMFRva2VuLCBCdXJuYWJsZSB7DQoNCiAgICAgIHN0cmluZyBwdWJsaWMgbmFtZTsgICAgICAgICAgICAgICAgLy9UaGUgVG9rZW4ncyBuYW1lOiBlLmcuIERpZ2l4REFPIFRva2Vucw0KICAgICAgdWludDggcHVibGljIGRlY2ltYWxzOyAgICAgICAgICAgICAvL051bWJlciBvZiBkZWNpbWFscyBvZiB0aGUgc21hbGxlc3QgdW5pdA0KICAgICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7ICAgICAgICAgICAgICAvL0FuIGlkZW50aWZpZXI6IGUuZy4gUkVQDQogICAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnTU1UXzAuMSc7IC8vQW4gYXJiaXRyYXJ5IHZlcnNpb25pbmcgc2NoZW1lDQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIEVSQzIwIE1ldGhvZHMNCi8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KDQogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc2VuZCBgX2Ftb3VudGAgdG9rZW5zIG9uDQogICAgLy8vICBpdHMgYmVoYWxmLCBhbmQgdGhlbiBhIGZ1bmN0aW9uIGlzIHRyaWdnZXJlZCBpbiB0aGUgY29udHJhY3QgdGhhdCBpcw0KICAgIC8vLyAgYmVpbmcgYXBwcm92ZWQsIGBfc3BlbmRlcmAuIFRoaXMgYWxsb3dzIHVzZXJzIHRvIHVzZSB0aGVpciB0b2tlbnMgdG8NCiAgICAvLy8gIGludGVyYWN0IHdpdGggY29udHJhY3RzIGluIG9uZSBmdW5jdGlvbiBjYWxsIGluc3RlYWQgb2YgdHdvDQogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3QgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGFwcHJvdmVkIGZvciB0cmFuc2Zlcg0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIGZ1bmN0aW9uIGNhbGwgd2FzIHN1Y2Nlc3NmdWwNCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbCgNCiAgICAgICAgYWRkcmVzcyBfc3BlbmRlciwNCiAgICAgICAgdWludDI1NiBfYW1vdW50LA0KICAgICAgICBieXRlcyBfZXh0cmFEYXRhDQogICAgKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KDQovLy8vLy8vLy8vLy8vLy8vDQovLyBRdWVyeSBiYWxhbmNlIGFuZCB0b3RhbFN1cHBseSBpbiBIaXN0b3J5DQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvLy8gQGRldiBRdWVyaWVzIHRoZSBiYWxhbmNlIG9mIGBfb3duZXJgIGF0IGEgc3BlY2lmaWMgYF9ibG9ja051bWJlcmANCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyBmcm9tIHdoaWNoIHRoZSBiYWxhbmNlIHdpbGwgYmUgcmV0cmlldmVkDQogICAgLy8vIEBwYXJhbSBfYmxvY2tOdW1iZXIgVGhlIGJsb2NrIG51bWJlciB3aGVuIHRoZSBiYWxhbmNlIGlzIHF1ZXJpZWQNCiAgICAvLy8gQHJldHVybiBUaGUgYmFsYW5jZSBhdCBgX2Jsb2NrTnVtYmVyYA0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZkF0KA0KICAgICAgICBhZGRyZXNzIF9vd25lciwNCiAgICAgICAgdWludCBfYmxvY2tOdW1iZXINCiAgICApIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KDQogICAgLy8vIEBub3RpY2UgVG90YWwgYW1vdW50IG9mIHRva2VucyBhdCBhIHNwZWNpZmljIGBfYmxvY2tOdW1iZXJgLg0KICAgIC8vLyBAcGFyYW0gX2Jsb2NrTnVtYmVyIFRoZSBibG9jayBudW1iZXIgd2hlbiB0aGUgdG90YWxTdXBwbHkgaXMgcXVlcmllZA0KICAgIC8vLyBAcmV0dXJuIFRoZSB0b3RhbCBhbW91bnQgb2YgdG9rZW5zIGF0IGBfYmxvY2tOdW1iZXJgDQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHlBdCh1aW50IF9ibG9ja051bWJlcikgY29uc3RhbnQgcmV0dXJucyh1aW50KTsNCg0KLy8vLy8vLy8vLy8vLy8vLw0KLy8gQ2xvbmUgVG9rZW4gTWV0aG9kDQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvLy8gQG5vdGljZSBDcmVhdGVzIGEgbmV3IGNsb25lIHRva2VuIHdpdGggdGhlIGluaXRpYWwgZGlzdHJpYnV0aW9uIGJlaW5nDQogICAgLy8vICB0aGlzIHRva2VuIGF0IGBfc25hcHNob3RCbG9ja2ANCiAgICAvLy8gQHBhcmFtIF9jbG9uZVRva2VuTmFtZSBOYW1lIG9mIHRoZSBjbG9uZSB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX2Nsb25lRGVjaW1hbFVuaXRzIE51bWJlciBvZiBkZWNpbWFscyBvZiB0aGUgc21hbGxlc3QgdW5pdA0KICAgIC8vLyBAcGFyYW0gX2Nsb25lVG9rZW5TeW1ib2wgU3ltYm9sIG9mIHRoZSBjbG9uZSB0b2tlbg0KICAgIC8vLyBAcGFyYW0gX3NuYXBzaG90QmxvY2sgQmxvY2sgd2hlbiB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBwYXJlbnQgdG9rZW4gaXMNCiAgICAvLy8gIGNvcGllZCB0byBzZXQgdGhlIGluaXRpYWwgZGlzdHJpYnV0aW9uIG9mIHRoZSBuZXcgY2xvbmUgdG9rZW47DQogICAgLy8vICBpZiB0aGUgYmxvY2sgaXMgemVybyB0aGFuIHRoZSBhY3R1YWwgYmxvY2ssIHRoZSBjdXJyZW50IGJsb2NrIGlzIHVzZWQNCiAgICAvLy8gQHBhcmFtIF90cmFuc2ZlcnNFbmFibGVkIFRydWUgaWYgdHJhbnNmZXJzIGFyZSBhbGxvd2VkIGluIHRoZSBjbG9uZQ0KICAgIC8vLyBAcmV0dXJuIFRoZSBhZGRyZXNzIG9mIHRoZSBuZXcgTWluaU1lVG9rZW4gQ29udHJhY3QNCiAgICBmdW5jdGlvbiBjcmVhdGVDbG9uZVRva2VuKA0KICAgICAgICBzdHJpbmcgX2Nsb25lVG9rZW5OYW1lLA0KICAgICAgICB1aW50OCBfY2xvbmVEZWNpbWFsVW5pdHMsDQogICAgICAgIHN0cmluZyBfY2xvbmVUb2tlblN5bWJvbCwNCiAgICAgICAgdWludCBfc25hcHNob3RCbG9jaywNCiAgICAgICAgYm9vbCBfdHJhbnNmZXJzRW5hYmxlZA0KICAgICkgcmV0dXJucyhhZGRyZXNzKTsNCg0KLy8vLy8vLy8vLy8vLy8vLw0KLy8gR2VuZXJhdGUgYW5kIGRlc3Ryb3kgdG9rZW5zDQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvLy8gQG5vdGljZSBHZW5lcmF0ZXMgYF9hbW91bnRgIHRva2VucyB0aGF0IGFyZSBhc3NpZ25lZCB0byBgX293bmVyYA0KICAgIC8vLyBAcGFyYW0gX293bmVyIFRoZSBhZGRyZXNzIHRoYXQgd2lsbCBiZSBhc3NpZ25lZCB0aGUgbmV3IHRva2Vucw0KICAgIC8vLyBAcGFyYW0gX2Ftb3VudCBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIGdlbmVyYXRlZA0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIHRva2VucyBhcmUgZ2VuZXJhdGVkIGNvcnJlY3RseQ0KICAgIGZ1bmN0aW9uIGdlbmVyYXRlVG9rZW5zKGFkZHJlc3MgX293bmVyLCB1aW50IF9hbW91bnQpIHJldHVybnMgKGJvb2wpOw0KDQoNCiAgICAvLy8gQG5vdGljZSBCdXJucyBgX2Ftb3VudGAgdG9rZW5zIGZyb20gYF9vd25lcmANCiAgICAvLy8gQHBhcmFtIF9vd25lciBUaGUgYWRkcmVzcyB0aGF0IHdpbGwgbG9zZSB0aGUgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gYnVybg0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIHRva2VucyBhcmUgYnVybmVkIGNvcnJlY3RseQ0KICAgIGZ1bmN0aW9uIGRlc3Ryb3lUb2tlbnMoYWRkcmVzcyBfb3duZXIsIHVpbnQgX2Ftb3VudCkgcmV0dXJucyAoYm9vbCk7DQoNCi8vLy8vLy8vLy8vLy8vLy8NCi8vIEVuYWJsZSB0b2tlbnMgdHJhbnNmZXJzDQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvLy8gQG5vdGljZSBFbmFibGVzIHRva2VuIGhvbGRlcnMgdG8gdHJhbnNmZXIgdGhlaXIgdG9rZW5zIGZyZWVseSBpZiB0cnVlDQogICAgLy8vIEBwYXJhbSBfdHJhbnNmZXJzRW5hYmxlZCBUcnVlIGlmIHRyYW5zZmVycyBhcmUgYWxsb3dlZCBpbiB0aGUgY2xvbmUNCiAgICBmdW5jdGlvbiBlbmFibGVUcmFuc2ZlcnMoYm9vbCBfdHJhbnNmZXJzRW5hYmxlZCk7DQoNCi8vLy8vLy8vLy8NCi8vIFNhZmV0eSBNZXRob2RzDQovLy8vLy8vLy8vDQoNCiAgICAvLy8gQG5vdGljZSBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBieSB0aGUgY29udHJvbGxlciB0byBleHRyYWN0IG1pc3Rha2VubHkNCiAgICAvLy8gIHNlbnQgdG9rZW5zIHRvIHRoaXMgY29udHJhY3QuDQogICAgLy8vIEBwYXJhbSBfdG9rZW4gVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0IHRoYXQgeW91IHdhbnQgdG8gcmVjb3Zlcg0KICAgIC8vLyAgc2V0IHRvIDAgaW4gY2FzZSB5b3Ugd2FudCB0byBleHRyYWN0IGV0aGVyLg0KICAgIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgX3Rva2VuKTsNCg0KLy8vLy8vLy8vLy8vLy8vLw0KLy8gRXZlbnRzDQovLy8vLy8vLy8vLy8vLy8vDQoNCiAgICBldmVudCBDbGFpbWVkVG9rZW5zKGFkZHJlc3MgaW5kZXhlZCBfdG9rZW4sIGFkZHJlc3MgaW5kZXhlZCBfY29udHJvbGxlciwgdWludCBfYW1vdW50KTsNCiAgICBldmVudCBOZXdDbG9uZVRva2VuKGFkZHJlc3MgaW5kZXhlZCBfY2xvbmVUb2tlbiwgdWludCBfc25hcHNob3RCbG9jayk7DQp9DQoNCmNvbnRyYWN0IEZpbmFsaXphYmxlIHsNCiAgdWludDI1NiBwdWJsaWMgZmluYWxpemVkQmxvY2s7DQogIGJvb2wgcHVibGljIGdvYWxNZXQ7DQoNCiAgZnVuY3Rpb24gZmluYWxpemUoKTsNCn0NCg0KY29udHJhY3QgQ29udHJpYnV0aW9uIGlzIENvbnRyb2xsZWQsIFRva2VuQ29udHJvbGxlciwgRmluYWxpemFibGUgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsNCg0KICB1aW50MjU2IHB1YmxpYyB0b3RhbFN1cHBseUNhcDsgLy8gVG90YWwgTVNQIHN1cHBseSB0byBiZSBnZW5lcmF0ZWQNCiAgdWludDI1NiBwdWJsaWMgZXhjaGFuZ2VSYXRlOyAvLyBFVEgtTVNQIGV4Y2hhbmdlIHJhdGUNCiAgdWludDI1NiBwdWJsaWMgdG90YWxTb2xkOyAvLyBIb3cgbXVjaCB0b2tlbnMgc29sZA0KICB1aW50MjU2IHB1YmxpYyB0b3RhbFNhbGVTdXBwbHlDYXA7IC8vIFRva2VuIHNhbGUgY2FwDQoNCiAgTWluaU1lVG9rZW5JIHB1YmxpYyBzaXQ7DQogIE1pbmlNZVRva2VuSSBwdWJsaWMgbXNwOw0KDQogIHVpbnQyNTYgcHVibGljIHN0YXJ0QmxvY2s7DQogIHVpbnQyNTYgcHVibGljIGVuZEJsb2NrOw0KDQogIGFkZHJlc3MgcHVibGljIGRlc3RFdGhEZXZzOw0KICBhZGRyZXNzIHB1YmxpYyBkZXN0VG9rZW5zU2l0Ow0KICBhZGRyZXNzIHB1YmxpYyBkZXN0VG9rZW5zVGVhbTsNCiAgYWRkcmVzcyBwdWJsaWMgZGVzdFRva2Vuc1JlZmVyYWxzOw0KDQogIGFkZHJlc3MgcHVibGljIG1zcENvbnRyb2xsZXI7DQoNCiAgdWludDI1NiBwdWJsaWMgaW5pdGlhbGl6ZWRCbG9jazsNCiAgdWludDI1NiBwdWJsaWMgZmluYWxpemVkVGltZTsNCg0KICB1aW50MjU2IHB1YmxpYyBtaW5pbXVtX2ludmVzdG1lbnQ7DQogIHVpbnQyNTYgcHVibGljIG1pbmltdW1fZ29hbDsNCg0KICBib29sIHB1YmxpYyBwYXVzZWQ7DQoNCiAgbW9kaWZpZXIgaW5pdGlhbGl6ZWQoKSB7DQogICAgYXNzZXJ0KGFkZHJlc3MobXNwKSAhPSAweDApOw0KICAgIF87DQogIH0NCg0KICBtb2RpZmllciBjb250cmlidXRpb25PcGVuKCkgew0KICAgIGFzc2VydChnZXRCbG9ja051bWJlcigpID49IHN0YXJ0QmxvY2sgJiYNCiAgICAgICAgICAgIGdldEJsb2NrTnVtYmVyKCkgPD0gZW5kQmxvY2sgJiYNCiAgICAgICAgICAgIGZpbmFsaXplZEJsb2NrID09IDAgJiYNCiAgICAgICAgICAgIGFkZHJlc3MobXNwKSAhPSAweDApOw0KICAgIF87DQogIH0NCg0KICBtb2RpZmllciBub3RQYXVzZWQoKSB7DQogICAgcmVxdWlyZSghcGF1c2VkKTsNCiAgICBfOw0KICB9DQoNCiAgZnVuY3Rpb24gQ29udHJpYnV0aW9uKCkgew0KICAgIC8vIEJvb2xlYW5zIGFyZSBmYWxzZSBieSBkZWZhdWx0IGNvbnNpZGVyIHJlbW92aW5nIHRoaXMNCiAgICBwYXVzZWQgPSBmYWxzZTsNCiAgfQ0KDQogIC8vLyBAbm90aWNlIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyb2xsZXIgYmVmb3JlIHRoZSBjb250cmlidXRpb24NCiAgLy8vICBwZXJpb2Qgc3RhcnRzIFRoaXMgaW5pdGlhbGl6ZXMgbW9zdCBvZiB0aGUgcGFyYW1ldGVycw0KICAvLy8gQHBhcmFtIF9tc3AgQWRkcmVzcyBvZiB0aGUgTVNQIHRva2VuIGNvbnRyYWN0DQogIC8vLyBAcGFyYW0gX21zcENvbnRyb2xsZXIgVG9rZW4gY29udHJvbGxlciBmb3IgdGhlIE1TUCB0aGF0IHdpbGwgYmUgdHJhbnNmZXJyZWQgYWZ0ZXINCiAgLy8vICB0aGUgY29udHJpYnV0aW9uIGZpbmFsaXplcy4NCiAgLy8vIEBwYXJhbSBfdG90YWxTdXBwbHlDYXAgTWF4aW11bSBhbW91bnQgb2YgdG9rZW5zIHRvIGdlbmVyYXRlIGR1cmluZyB0aGUgY29udHJpYnV0aW9uDQogIC8vLyBAcGFyYW0gX2V4Y2hhbmdlUmF0ZSBFVEggdG8gTVNQIHJhdGUgZm9yIHRoZSB0b2tlbiBzYWxlDQogIC8vLyBAcGFyYW0gX3N0YXJ0QmxvY2sgQmxvY2sgd2hlbiB0aGUgY29udHJpYnV0aW9uIHBlcmlvZCBzdGFydHMNCiAgLy8vIEBwYXJhbSBfZW5kQmxvY2sgVGhlIGxhc3QgYmxvY2sgdGhhdCB0aGUgY29udHJpYnV0aW9uIHBlcmlvZCBpcyBhY3RpdmUNCiAgLy8vIEBwYXJhbSBfZGVzdEV0aERldnMgRGVzdGluYXRpb24gYWRkcmVzcyB3aGVyZSB0aGUgY29udHJpYnV0aW9uIGV0aGVyIGlzIHNlbnQNCiAgLy8vIEBwYXJhbSBfZGVzdFRva2Vuc1NpdCBBZGRyZXNzIG9mIHRoZSBleGNoYW5nZXIgU0lULU1TUCB3aGVyZSB0aGUgTVNQIGFyZSBzZW50DQogIC8vLyAgdG8gYmUgZGlzdHJpYnV0ZWQgdG8gdGhlIFNJVCBob2xkZXJzLg0KICAvLy8gQHBhcmFtIF9kZXN0VG9rZW5zVGVhbSBBZGRyZXNzIHdoZXJlIHRoZSB0b2tlbnMgZm9yIHRoZSB0ZWFtIGFyZSBzZW50DQogIC8vLyBAcGFyYW0gX2Rlc3RUb2tlbnNSZWZlcmFscyBBZGRyZXNzIHdoZXJlIHRoZSB0b2tlbnMgZm9yIHRoZSByZWZlcmFsIHN5c3RlbSBhcmUgc2VudA0KICAvLy8gQHBhcmFtIF9zaXQgQWRkcmVzcyBvZiB0aGUgU0lUIHRva2VuIGNvbnRyYWN0DQogIGZ1bmN0aW9uIGluaXRpYWxpemUoDQogICAgICBhZGRyZXNzIF9tc3AsDQogICAgICBhZGRyZXNzIF9tc3BDb250cm9sbGVyLA0KDQogICAgICB1aW50MjU2IF90b3RhbFN1cHBseUNhcCwNCiAgICAgIHVpbnQyNTYgX2V4Y2hhbmdlUmF0ZSwNCiAgICAgIHVpbnQyNTYgX21pbmltdW1fZ29hbCwNCg0KICAgICAgdWludDI1NiBfc3RhcnRCbG9jaywNCiAgICAgIHVpbnQyNTYgX2VuZEJsb2NrLA0KDQogICAgICBhZGRyZXNzIF9kZXN0RXRoRGV2cywNCiAgICAgIGFkZHJlc3MgX2Rlc3RUb2tlbnNTaXQsDQogICAgICBhZGRyZXNzIF9kZXN0VG9rZW5zVGVhbSwNCiAgICAgIGFkZHJlc3MgX2Rlc3RUb2tlbnNSZWZlcmFscywNCg0KICAgICAgYWRkcmVzcyBfc2l0DQogICkgcHVibGljIG9ubHlDb250cm9sbGVyIHsNCiAgICAvLyBJbml0aWFsaXplIG9ubHkgb25jZQ0KICAgIGFzc2VydChhZGRyZXNzKG1zcCkgPT0gMHgwKTsNCg0KICAgIG1zcCA9IE1pbmlNZVRva2VuSShfbXNwKTsNCiAgICBhc3NlcnQobXNwLnRvdGFsU3VwcGx5KCkgPT0gMCk7DQogICAgYXNzZXJ0KG1zcC5jb250cm9sbGVyKCkgPT0gYWRkcmVzcyh0aGlzKSk7DQogICAgYXNzZXJ0KG1zcC5kZWNpbWFscygpID09IDE4KTsgIC8vIFNhbWUgYW1vdW50IG9mIGRlY2ltYWxzIGFzIEVUSA0KDQogICAgcmVxdWlyZShfbXNwQ29udHJvbGxlciAhPSAweDApOw0KICAgIG1zcENvbnRyb2xsZXIgPSBfbXNwQ29udHJvbGxlcjsNCg0KICAgIHJlcXVpcmUoX2V4Y2hhbmdlUmF0ZSA+IDApOw0KICAgIGV4Y2hhbmdlUmF0ZSA9IF9leGNoYW5nZVJhdGU7DQoNCiAgICBhc3NlcnQoX3N0YXJ0QmxvY2sgPj0gZ2V0QmxvY2tOdW1iZXIoKSk7DQogICAgcmVxdWlyZShfc3RhcnRCbG9jayA8IF9lbmRCbG9jayk7DQogICAgc3RhcnRCbG9jayA9IF9zdGFydEJsb2NrOw0KICAgIGVuZEJsb2NrID0gX2VuZEJsb2NrOw0KDQogICAgcmVxdWlyZShfZGVzdEV0aERldnMgIT0gMHgwKTsNCiAgICBkZXN0RXRoRGV2cyA9IF9kZXN0RXRoRGV2czsNCg0KICAgIHJlcXVpcmUoX2Rlc3RUb2tlbnNTaXQgIT0gMHgwKTsNCiAgICBkZXN0VG9rZW5zU2l0ID0gX2Rlc3RUb2tlbnNTaXQ7DQoNCiAgICByZXF1aXJlKF9kZXN0VG9rZW5zVGVhbSAhPSAweDApOw0KICAgIGRlc3RUb2tlbnNUZWFtID0gX2Rlc3RUb2tlbnNUZWFtOw0KDQogICAgcmVxdWlyZShfZGVzdFRva2Vuc1JlZmVyYWxzICE9IDB4MCk7DQogICAgZGVzdFRva2Vuc1JlZmVyYWxzID0gX2Rlc3RUb2tlbnNSZWZlcmFsczsNCg0KICAgIHJlcXVpcmUoX3NpdCAhPSAweDApOw0KICAgIHNpdCA9IE1pbmlNZVRva2VuSShfc2l0KTsNCg0KICAgIGluaXRpYWxpemVkQmxvY2sgPSBnZXRCbG9ja051bWJlcigpOw0KICAgIC8vIFNJVCBhbW91bnQgc2hvdWxkIGJlIG5vIG1vcmUgdGhhbiAyMCUgb2YgTVNQIHRvdGFsIHN1cHBseSBjYXANCiAgICBhc3NlcnQoc2l0LnRvdGFsU3VwcGx5QXQoaW5pdGlhbGl6ZWRCbG9jaykgKiA1IDw9IF90b3RhbFN1cHBseUNhcCk7DQogICAgdG90YWxTdXBwbHlDYXAgPSBfdG90YWxTdXBwbHlDYXA7DQoNCiAgICAvLyBXZSBhcmUgZ29pbmcgdG8gc2FsZSA3MCUgb2YgdG90YWwgc3VwcGx5IGNhcA0KICAgIHRvdGFsU2FsZVN1cHBseUNhcCA9IHBlcmNlbnQoNzApLm11bChfdG90YWxTdXBwbHlDYXApLmRpdihwZXJjZW50KDEwMCkpOw0KDQogICAgbWluaW11bV9nb2FsID0gX21pbmltdW1fZ29hbDsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNldE1pbmltdW1JbnZlc3RtZW50KA0KICAgICAgdWludCBfbWluaW11bV9pbnZlc3RtZW50DQogICkgcHVibGljIG9ubHlDb250cm9sbGVyIHsNCiAgICBtaW5pbXVtX2ludmVzdG1lbnQgPSBfbWluaW11bV9pbnZlc3RtZW50Ow0KICB9DQoNCiAgZnVuY3Rpb24gc2V0RXhjaGFuZ2VSYXRlKA0KICAgICAgdWludCBfZXhjaGFuZ2VSYXRlDQogICkgcHVibGljIG9ubHlDb250cm9sbGVyIHsNCiAgICBhc3NlcnQoZ2V0QmxvY2tOdW1iZXIoKSA8IHN0YXJ0QmxvY2spOw0KICAgIGV4Y2hhbmdlUmF0ZSA9IF9leGNoYW5nZVJhdGU7DQogIH0NCg0KICAvLy8gQG5vdGljZSBJZiBhbnlib2R5IHNlbmRzIEV0aGVyIGRpcmVjdGx5IHRvIHRoaXMgY29udHJhY3QsIGNvbnNpZGVyIGhlIGlzDQogIC8vLyAgZ2V0dGluZyBNU1BzLg0KICBmdW5jdGlvbiAoKSBwdWJsaWMgcGF5YWJsZSBub3RQYXVzZWQgew0KICAgIHByb3h5UGF5bWVudChtc2cuc2VuZGVyKTsNCiAgfQ0KDQoNCiAgLy8vLy8vLy8vLw0KICAvLyBUb2tlbkNvbnRyb2xsZXIgZnVuY3Rpb25zDQogIC8vLy8vLy8vLy8NCg0KICAvLy8gQG5vdGljZSBUaGlzIG1ldGhvZCB3aWxsIGdlbmVyYWxseSBiZSBjYWxsZWQgYnkgdGhlIE1TUCB0b2tlbiBjb250cmFjdCB0bw0KICAvLy8gIGFjcXVpcmUgTVNQcy4gT3IgZGlyZWN0bHkgZnJvbSB0aGlyZCBwYXJ0aWVzIHRoYXQgd2FudCB0byBhY3F1aXJlIE1TUHMgaW4NCiAgLy8vICBiZWhhbGYgb2YgYSB0b2tlbiBob2xkZXIuDQogIC8vLyBAcGFyYW0gX3RoIE1TUCBob2xkZXIgd2hlcmUgdGhlIE1TUHMgd2lsbCBiZSBtaW50ZWQuDQogIGZ1bmN0aW9uIHByb3h5UGF5bWVudChhZGRyZXNzIF90aCkgcHVibGljIHBheWFibGUgbm90UGF1c2VkIGluaXRpYWxpemVkIGNvbnRyaWJ1dGlvbk9wZW4gcmV0dXJucyAoYm9vbCkgew0KICAgIHJlcXVpcmUoX3RoICE9IDB4MCk7DQogICAgZG9CdXkoX3RoKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG9uVHJhbnNmZXIoYWRkcmVzcywgYWRkcmVzcywgdWludDI1NikgcHVibGljIHJldHVybnMgKGJvb2wpIHsNCiAgICByZXR1cm4gZmFsc2U7DQogIH0NCg0KICBmdW5jdGlvbiBvbkFwcHJvdmUoYWRkcmVzcywgYWRkcmVzcywgdWludDI1NikgcHVibGljIHJldHVybnMgKGJvb2wpIHsNCiAgICByZXR1cm4gZmFsc2U7DQogIH0NCg0KICBmdW5jdGlvbiBkb0J1eShhZGRyZXNzIF90aCkgaW50ZXJuYWwgew0KICAgIHJlcXVpcmUobXNnLnZhbHVlID49IG1pbmltdW1faW52ZXN0bWVudCk7DQoNCiAgICAvLyBBbnRpc3BhbSBtZWNoYW5pc20NCiAgICBhZGRyZXNzIGNhbGxlcjsNCiAgICBpZiAobXNnLnNlbmRlciA9PSBhZGRyZXNzKG1zcCkpIHsNCiAgICAgIGNhbGxlciA9IF90aDsNCiAgICB9IGVsc2Ugew0KICAgICAgY2FsbGVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICAvLyBEbyBub3QgYWxsb3cgY29udHJhY3RzIHRvIGdhbWUgdGhlIHN5c3RlbQ0KICAgIGFzc2VydCghaXNDb250cmFjdChjYWxsZXIpKTsNCg0KICAgIHVpbnQyNTYgdG9GdW5kID0gbXNnLnZhbHVlOw0KICAgIHVpbnQyNTYgbGVmdEZvclNhbGUgPSB0b2tlbnNGb3JTYWxlKCk7DQogICAgaWYgKHRvRnVuZCA+IDApIHsNCiAgICAgIGlmIChsZWZ0Rm9yU2FsZSA+IDApIHsNCiAgICAgICAgdWludDI1NiB0b2tlbnNHZW5lcmF0ZWQgPSB0b0Z1bmQubXVsKGV4Y2hhbmdlUmF0ZSk7DQoNCiAgICAgICAgLy8gQ2hlY2sgdG90YWwgc3VwcGx5IGNhcCByZWFjaGVkLCBzZWxsIHRoZSBhbGwgcmVtYWluaW5nIHRva2Vucw0KICAgICAgICBpZiAodG9rZW5zR2VuZXJhdGVkID4gbGVmdEZvclNhbGUpIHsNCiAgICAgICAgICB0b2tlbnNHZW5lcmF0ZWQgPSBsZWZ0Rm9yU2FsZTsNCiAgICAgICAgICB0b0Z1bmQgPSBsZWZ0Rm9yU2FsZS5kaXYoZXhjaGFuZ2VSYXRlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGFzc2VydChtc3AuZ2VuZXJhdGVUb2tlbnMoX3RoLCB0b2tlbnNHZW5lcmF0ZWQpKTsNCiAgICAgICAgdG90YWxTb2xkID0gdG90YWxTb2xkLmFkZCh0b2tlbnNHZW5lcmF0ZWQpOw0KICAgICAgICBpZiAodG90YWxTb2xkID49IG1pbmltdW1fZ29hbCkgew0KICAgICAgICAgIGdvYWxNZXQgPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIGRlc3RFdGhEZXZzLnRyYW5zZmVyKHRvRnVuZCk7DQogICAgICAgIE5ld1NhbGUoX3RoLCB0b0Z1bmQsIHRva2Vuc0dlbmVyYXRlZCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0b0Z1bmQgPSAwOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIHVpbnQyNTYgdG9SZXR1cm4gPSBtc2cudmFsdWUuc3ViKHRvRnVuZCk7DQogICAgaWYgKHRvUmV0dXJuID4gMCkgew0KICAgICAgLy8gSWYgdGhlIGNhbGwgY29tZXMgZnJvbSB0aGUgVG9rZW4gY29udHJvbGxlciwNCiAgICAgIC8vIHRoZW4gd2UgcmV0dXJuIGl0IHRvIHRoZSB0b2tlbiBIb2xkZXIuDQogICAgICAvLyBPdGhlcndpc2Ugd2UgcmV0dXJuIHRvIHRoZSBzZW5kZXIuDQogICAgICBpZiAobXNnLnNlbmRlciA9PSBhZGRyZXNzKG1zcCkpIHsNCiAgICAgICAgX3RoLnRyYW5zZmVyKHRvUmV0dXJuKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIodG9SZXR1cm4pOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8vLyBAZGV2IEludGVybmFsIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhbiBhZGRyZXNzIGlzIGEgY29udHJhY3QNCiAgLy8vIEBwYXJhbSBfYWRkciBUaGUgYWRkcmVzcyBiZWluZyBxdWVyaWVkDQogIC8vLyBAcmV0dXJuIFRydWUgaWYgYF9hZGRyYCBpcyBhIGNvbnRyYWN0DQogIGZ1bmN0aW9uIGlzQ29udHJhY3QoYWRkcmVzcyBfYWRkcikgY29uc3RhbnQgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgew0KICAgIGlmIChfYWRkciA9PSAwKSByZXR1cm4gZmFsc2U7DQogICAgdWludDI1NiBzaXplOw0KICAgIGFzc2VtYmx5IHsNCiAgICAgIHNpemUgOj0gZXh0Y29kZXNpemUoX2FkZHIpDQogICAgfQ0KICAgIHJldHVybiAoc2l6ZSA+IDApOw0KICB9DQoNCiAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIHsNCiAgICByZXF1aXJlKGZpbmFsaXplZEJsb2NrICE9IDApOw0KICAgIHJlcXVpcmUoIWdvYWxNZXQpOw0KDQogICAgdWludDI1NiBhbW91bnRUb2tlbnMgPSBtc3AuYmFsYW5jZU9mKG1zZy5zZW5kZXIpOw0KICAgIHJlcXVpcmUoYW1vdW50VG9rZW5zID4gMCk7DQogICAgdWludDI1NiBhbW91bnRFdGhlciA9IGFtb3VudFRva2Vucy5kaXYoZXhjaGFuZ2VSYXRlKTsNCiAgICBhZGRyZXNzIHRoID0gbXNnLnNlbmRlcjsNCg0KICAgIFJlZnVuZGFibGUobXNwQ29udHJvbGxlcikucmVmdW5kKHRoLCBhbW91bnRUb2tlbnMpOw0KICAgIFJlZnVuZGFibGUoZGVzdEV0aERldnMpLnJlZnVuZCh0aCwgYW1vdW50RXRoZXIpOw0KDQogICAgUmVmdW5kKHRoLCBhbW91bnRUb2tlbnMsIGFtb3VudEV0aGVyKTsNCiAgfQ0KDQogIGV2ZW50IFJlZnVuZChhZGRyZXNzIF90b2tlbl9ob2xkZXIsIHVpbnQyNTYgX2Ftb3VudF90b2tlbnMsIHVpbnQyNTYgX2Ftb3VudF9ldGhlcik7DQoNCiAgLy8vIEBub3RpY2UgVGhpcyBtZXRob2Qgd2lsbCBjYW4gYmUgY2FsbGVkIGJ5IHRoZSBjb250cm9sbGVyIGJlZm9yZSB0aGUgY29udHJpYnV0aW9uIHBlcmlvZA0KICAvLy8gIGVuZCBvciBieSBhbnlib2R5IGFmdGVyIHRoZSBgZW5kQmxvY2tgLiBUaGlzIG1ldGhvZCBmaW5hbGl6ZXMgdGhlIGNvbnRyaWJ1dGlvbiBwZXJpb2QNCiAgLy8vICBieSBjcmVhdGluZyB0aGUgcmVtYWluaW5nIHRva2VucyBhbmQgdHJhbnNmZXJyaW5nIHRoZSBjb250cm9sbGVyIHRvIHRoZSBjb25maWd1cmVkDQogIC8vLyAgY29udHJvbGxlci4NCiAgZnVuY3Rpb24gZmluYWxpemUoKSBwdWJsaWMgaW5pdGlhbGl6ZWQgew0KICAgIGFzc2VydChnZXRCbG9ja051bWJlcigpID49IHN0YXJ0QmxvY2spOw0KICAgIGFzc2VydChtc2cuc2VuZGVyID09IGNvbnRyb2xsZXIgfHwgZ2V0QmxvY2tOdW1iZXIoKSA+IGVuZEJsb2NrIHx8IHRva2Vuc0ZvclNhbGUoKSA9PSAwKTsNCiAgICByZXF1aXJlKGZpbmFsaXplZEJsb2NrID09IDApOw0KDQogICAgZmluYWxpemVkQmxvY2sgPSBnZXRCbG9ja051bWJlcigpOw0KICAgIGZpbmFsaXplZFRpbWUgPSBub3c7DQoNCiAgICBpZiAoZ29hbE1ldCkgew0KICAgICAgLy8gR2VuZXJhdGUgNSUgZm9yIHRoZSB0ZWFtDQogICAgICBhc3NlcnQobXNwLmdlbmVyYXRlVG9rZW5zKA0KICAgICAgICBkZXN0VG9rZW5zVGVhbSwNCiAgICAgICAgcGVyY2VudCg1KS5tdWwodG90YWxTdXBwbHlDYXApLmRpdihwZXJjZW50KDEwMCkpKSk7DQoNCiAgICAgIC8vIEdlbmVyYXRlIDUlIGZvciB0aGUgcmVmZXJhbCBib251c2VzDQogICAgICBhc3NlcnQobXNwLmdlbmVyYXRlVG9rZW5zKA0KICAgICAgICBkZXN0VG9rZW5zUmVmZXJhbHMsDQogICAgICAgIHBlcmNlbnQoNSkubXVsKHRvdGFsU3VwcGx5Q2FwKS5kaXYocGVyY2VudCgxMDApKSkpOw0KDQogICAgICAvLyBHZW5lcmF0ZSB0b2tlbnMgZm9yIFNJVCBleGNoYW5nZXINCiAgICAgIGFzc2VydChtc3AuZ2VuZXJhdGVUb2tlbnMoDQogICAgICAgIGRlc3RUb2tlbnNTaXQsDQogICAgICAgIHNpdC50b3RhbFN1cHBseUF0KGluaXRpYWxpemVkQmxvY2spKSk7DQogICAgfQ0KDQogICAgbXNwLmNoYW5nZUNvbnRyb2xsZXIobXNwQ29udHJvbGxlcik7DQogICAgRmluYWxpemVkKCk7DQogIH0NCg0KICBmdW5jdGlvbiBwZXJjZW50KHVpbnQyNTYgcCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBwLm11bCgxMCoqMTYpOw0KICB9DQoNCg0KICAvLy8vLy8vLy8vDQogIC8vIENvbnN0YW50IGZ1bmN0aW9ucw0KICAvLy8vLy8vLy8vDQoNCiAgLy8vIEByZXR1cm4gVG90YWwgdG9rZW5zIGlzc3VlZCBpbiB3ZWlzLg0KICBmdW5jdGlvbiB0b2tlbnNJc3N1ZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBtc3AudG90YWxTdXBwbHkoKTsNCiAgfQ0KDQogIC8vLyBAcmV0dXJuIFRvdGFsIHRva2VucyBhdmFpbGFsZSBmb3IgdGhlIHNhbGUgaW4gd2Vpcy4NCiAgZnVuY3Rpb24gdG9rZW5zRm9yU2FsZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gdG90YWxTYWxlU3VwcGx5Q2FwID4gdG90YWxTb2xkID8gdG90YWxTYWxlU3VwcGx5Q2FwIC0gdG90YWxTb2xkIDogMDsNCiAgfQ0KDQoNCiAgLy8vLy8vLy8vLw0KICAvLyBUZXN0aW5nIHNwZWNpZmljIG1ldGhvZHMNCiAgLy8vLy8vLy8vLw0KDQogIC8vLyBAbm90aWNlIFRoaXMgZnVuY3Rpb24gaXMgb3ZlcnJpZGRlbiBieSB0aGUgdGVzdCBNb2Nrcy4NCiAgZnVuY3Rpb24gZ2V0QmxvY2tOdW1iZXIoKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGJsb2NrLm51bWJlcjsNCiAgfQ0KDQoNCiAgLy8vLy8vLy8vLw0KICAvLyBTYWZldHkgTWV0aG9kcw0KICAvLy8vLy8vLy8vDQoNCiAgLy8vIEBub3RpY2UgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgYnkgdGhlIGNvbnRyb2xsZXIgdG8gZXh0cmFjdCBtaXN0YWtlbmx5DQogIC8vLyAgc2VudCB0b2tlbnMgdG8gdGhpcyBjb250cmFjdC4NCiAgLy8vIEBwYXJhbSBfdG9rZW4gVGhlIGFkZHJlc3Mgb2YgdGhlIHRva2VuIGNvbnRyYWN0IHRoYXQgeW91IHdhbnQgdG8gcmVjb3Zlcg0KICAvLy8gIHNldCB0byAwIGluIGNhc2UgeW91IHdhbnQgdG8gZXh0cmFjdCBldGhlci4NCiAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pIHB1YmxpYyBvbmx5Q29udHJvbGxlciB7DQogICAgaWYgKG1zcC5jb250cm9sbGVyKCkgPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgbXNwLmNsYWltVG9rZW5zKF90b2tlbik7DQogICAgfQ0KICAgIGlmIChfdG9rZW4gPT0gMHgwKSB7DQogICAgICBjb250cm9sbGVyLnRyYW5zZmVyKHRoaXMuYmFsYW5jZSk7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgRVJDMjBUb2tlbiB0b2tlbiA9IEVSQzIwVG9rZW4oX3Rva2VuKTsNCiAgICB1aW50MjU2IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7DQogICAgdG9rZW4udHJhbnNmZXIoY29udHJvbGxlciwgYmFsYW5jZSk7DQogICAgQ2xhaW1lZFRva2VucyhfdG9rZW4sIGNvbnRyb2xsZXIsIGJhbGFuY2UpOw0KICB9DQoNCg0KICAvLy8gQG5vdGljZSBQYXVzZXMgdGhlIGNvbnRyaWJ1dGlvbiBpZiB0aGVyZSBpcyBhbnkgaXNzdWUNCiAgZnVuY3Rpb24gcGF1c2VDb250cmlidXRpb24oKSBvbmx5Q29udHJvbGxlciB7DQogICAgcGF1c2VkID0gdHJ1ZTsNCiAgfQ0KDQogIC8vLyBAbm90aWNlIFJlc3VtZXMgdGhlIGNvbnRyaWJ1dGlvbg0KICBmdW5jdGlvbiByZXN1bWVDb250cmlidXRpb24oKSBvbmx5Q29udHJvbGxlciB7DQogICAgcGF1c2VkID0gZmFsc2U7DQogIH0NCg0KICBldmVudCBDbGFpbWVkVG9rZW5zKGFkZHJlc3MgaW5kZXhlZCBfdG9rZW4sIGFkZHJlc3MgaW5kZXhlZCBfY29udHJvbGxlciwgdWludDI1NiBfYW1vdW50KTsNCiAgZXZlbnQgTmV3U2FsZShhZGRyZXNzIGluZGV4ZWQgX3RoLCB1aW50MjU2IF9hbW91bnQsIHVpbnQyNTYgX3Rva2Vucyk7DQogIGV2ZW50IEZpbmFsaXplZCgpOw0KfQ0KDQovLy8gQHRpdGxlIFNJVEV4Y2hhbmdlciBDb250cmFjdA0KLy8vIEBhdXRob3IgQW50b24gRWdvcm92DQovLy8gQGRldiBUaGlzIGNvbnRyYWN0IHdpbGwgYmUgdXNlZCB0byBkaXN0cmlidXRlIE1TUCBiZXR3ZWVuIFNJVCBob2xkZXJzLg0KLy8vICBTSVQgdG9rZW4gaXMgbm90IHRyYW5zZmVyYWJsZSwgYW5kIHdlIGp1c3Qga2VlcCBhbiBhY2NvdW50aW5nIGJldHdlZW4gYWxsIHRva2Vucw0KLy8vICBkZXBvc2l0ZWQgYW5kIHRoZSB0b2tlbnMgY29sbGVjdGVkLg0KLy8vICBUaGUgY29udHJvbGxlclNoaXAgb2YgU0lUIHNob3VsZCBiZSB0cmFuc2ZlcnJlZCB0byB0aGlzIGNvbnRyYWN0IGJlZm9yZSB0aGUNCi8vLyAgY29udHJpYnV0aW9uIHBlcmlvZCBzdGFydHMuDQoNCmNvbnRyYWN0IFNJVEV4Y2hhbmdlciBpcyBDb250cm9sbGVkLCBUb2tlbkNvbnRyb2xsZXIgew0KICB1c2luZyBTYWZlTWF0aCBmb3IgdWludDI1NjsNCg0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBjb2xsZWN0ZWQ7DQogIHVpbnQyNTYgcHVibGljIHRvdGFsQ29sbGVjdGVkOw0KICBNaW5pTWVUb2tlbkkgcHVibGljIHNpdDsNCiAgTWluaU1lVG9rZW5JIHB1YmxpYyBtc3A7DQogIENvbnRyaWJ1dGlvbiBwdWJsaWMgY29udHJpYnV0aW9uOw0KDQogIGZ1bmN0aW9uIFNJVEV4Y2hhbmdlcihhZGRyZXNzIF9zaXQsIGFkZHJlc3MgX21zcCwgYWRkcmVzcyBfY29udHJpYnV0aW9uKSB7DQogICAgc2l0ID0gTWluaU1lVG9rZW5JKF9zaXQpOw0KICAgIG1zcCA9IE1pbmlNZVRva2VuSShfbXNwKTsNCiAgICBjb250cmlidXRpb24gPSBDb250cmlidXRpb24oX2NvbnRyaWJ1dGlvbik7DQogIH0NCg0KICAvLy8gQG5vdGljZSBUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIGJ5IHRoZSBTSVQgaG9sZGVycyB0byBjb2xsZWN0IHRoZWlyDQogIC8vLyAgY29ycmVzcG9uZGluZyBNU1BzDQogIGZ1bmN0aW9uIGNvbGxlY3QoKSBwdWJsaWMgew0KICAgIC8vIFNJVCBzaG9sZGVyIGNvdWxkIGNvbGxlY3QgTVNQIHJpZ2h0IGFmdGVyIGNvbnRyaWJ1dGlvbiBzdGFydGVkDQogICAgYXNzZXJ0KGdldEJsb2NrTnVtYmVyKCkgPiBjb250cmlidXRpb24uc3RhcnRCbG9jaygpKTsNCg0KICAgIC8vIEdldCBjdXJyZW50IE1TUCBiYWxsYW5jZQ0KICAgIHVpbnQyNTYgYmFsYW5jZSA9IHNpdC5iYWxhbmNlT2ZBdChtc2cuc2VuZGVyLCBjb250cmlidXRpb24uaW5pdGlhbGl6ZWRCbG9jaygpKTsNCg0KICAgIC8vIEFuZCB0aGVuIHN1YnRyYWN0IHRoZSBhbW91bnQgYWxyZWFkeSBjb2xsZWN0ZWQNCiAgICB1aW50MjU2IGFtb3VudCA9IGJhbGFuY2Uuc3ViKGNvbGxlY3RlZFttc2cuc2VuZGVyXSk7DQoNCiAgICByZXF1aXJlKGFtb3VudCA+IDApOyAgLy8gTm90aWZ5IHRoZSB1c2VyIHRoYXQgdGhlcmUgYXJlIG5vIHRva2VucyB0byBleGNoYW5nZQ0KDQogICAgdG90YWxDb2xsZWN0ZWQgPSB0b3RhbENvbGxlY3RlZC5hZGQoYW1vdW50KTsNCiAgICBjb2xsZWN0ZWRbbXNnLnNlbmRlcl0gPSBjb2xsZWN0ZWRbbXNnLnNlbmRlcl0uYWRkKGFtb3VudCk7DQoNCiAgICBhc3NlcnQobXNwLnRyYW5zZmVyKG1zZy5zZW5kZXIsIGFtb3VudCkpOw0KDQogICAgVG9rZW5zQ29sbGVjdGVkKG1zZy5zZW5kZXIsIGFtb3VudCk7DQogIH0NCg0KICBmdW5jdGlvbiBwcm94eVBheW1lbnQoYWRkcmVzcykgcHVibGljIHBheWFibGUgcmV0dXJucyAoYm9vbCkgew0KICAgIHRocm93Ow0KICB9DQoNCiAgZnVuY3Rpb24gb25UcmFuc2ZlcihhZGRyZXNzLCBhZGRyZXNzLCB1aW50MjU2KSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIG9uQXBwcm92ZShhZGRyZXNzLCBhZGRyZXNzLCB1aW50MjU2KSBwdWJsaWMgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KDQogIC8vLy8vLy8vLy8NCiAgLy8gVGVzdGluZyBzcGVjaWZpYyBtZXRob2RzDQogIC8vLy8vLy8vLy8NCg0KICAvLy8gQG5vdGljZSBUaGlzIGZ1bmN0aW9uIGlzIG92ZXJyaWRkZW4gYnkgdGhlIHRlc3QgTW9ja3MuDQogIGZ1bmN0aW9uIGdldEJsb2NrTnVtYmVyKCkgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgIHJldHVybiBibG9jay5udW1iZXI7DQogIH0NCg0KICAvLy8vLy8vLy8vDQogIC8vIFNhZmV0eSBNZXRob2QNCiAgLy8vLy8vLy8vLw0KDQogIC8vLyBAbm90aWNlIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGJ5IHRoZSBjb250cm9sbGVyIHRvIGV4dHJhY3QgbWlzdGFrZW5seQ0KICAvLy8gIHNlbnQgdG9rZW5zIHRvIHRoaXMgY29udHJhY3QuDQogIC8vLyBAcGFyYW0gX3Rva2VuIFRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbiBjb250cmFjdCB0aGF0IHlvdSB3YW50IHRvIHJlY292ZXINCiAgLy8vICBzZXQgdG8gMCBpbiBjYXNlIHlvdSB3YW50IHRvIGV4dHJhY3QgZXRoZXIuDQogIGZ1bmN0aW9uIGNsYWltVG9rZW5zKGFkZHJlc3MgX3Rva2VuKSBwdWJsaWMgb25seUNvbnRyb2xsZXIgew0KICAgIGFzc2VydChfdG9rZW4gIT0gYWRkcmVzcyhtc3ApKTsNCiAgICBpZiAoX3Rva2VuID09IDB4MCkgew0KICAgICAgY29udHJvbGxlci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIEVSQzIwVG9rZW4gdG9rZW4gPSBFUkMyMFRva2VuKF90b2tlbik7DQogICAgdWludDI1NiBiYWxhbmNlID0gdG9rZW4uYmFsYW5jZU9mKHRoaXMpOw0KICAgIHRva2VuLnRyYW5zZmVyKGNvbnRyb2xsZXIsIGJhbGFuY2UpOw0KICAgIENsYWltZWRUb2tlbnMoX3Rva2VuLCBjb250cm9sbGVyLCBiYWxhbmNlKTsNCiAgfQ0KDQogIGV2ZW50IENsYWltZWRUb2tlbnMoYWRkcmVzcyBpbmRleGVkIF90b2tlbiwgYWRkcmVzcyBpbmRleGVkIF9jb250cm9sbGVyLCB1aW50MjU2IF9hbW91bnQpOw0KICBldmVudCBUb2tlbnNDb2xsZWN0ZWQoYWRkcmVzcyBpbmRleGVkIF9ob2xkZXIsIHVpbnQyNTYgX2Ftb3VudCk7DQoNCn0='