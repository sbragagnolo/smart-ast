base 64 content
base64smartRoulette3
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBXaW5NYXRyaXgNCiB7DQogICBmdW5jdGlvbiBnZXRDb2VmZih1aW50MTYgbikgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7DQogICBmdW5jdGlvbiBnZXRCZXRzUHJvY2Vzc2VkKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDE2KTsNCiB9DQoNCmNvbnRyYWN0IFNtYXJ0Um91bGV0dGVUb2tlbiANCnsNCiAgIGZ1bmN0aW9uIGVtaXNzaW9uKGFkZHJlc3MgcGxheWVyLCBhZGRyZXNzIHBhcnRuZXIsIHVpbnQyNTYgdmFsdWVfYmV0LCB1aW50MTYgY29lZl9wbGF5ZXIsIHVpbnQxNiBjb2VmX3BhcnRuZXIpIGV4dGVybmFsIHJldHVybnModWludDI1Nik7DQp9DQoNCmNvbnRyYWN0IFNtYXJ0QWZmaWxpYXRlIA0Kew0KICAgZnVuY3Rpb24gcmVnaXN0ZXIoYWRkcmVzcyBwbGF5ZXIsIGFkZHJlc3MgYWZmaWxpYXRlKSBleHRlcm5hbDsNCiAgIGZ1bmN0aW9uIGdldEFmZmlsaWF0ZUluZm8oYWRkcmVzcyBwbGF5ZXIpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyBhZmZpbGlhdGUsIHVpbnQxNiBjb2VmX2FmZmlsaWF0ZSk7DQp9DQoNCmNvbnRyYWN0IFNtYXJ0Um91bGV0dGUNCnsNCiAgICBhZGRyZXNzIGRldmVsb3BlcjsNCiAgICBhZGRyZXNzIG9wZXJhdG9yOw0KDQogICAgLy8gV2FpdCBCbG9ja0RlbGF5IGJsb2NrcyBiZWZvcmUgc3BpbiB0aGUgd2hlZWwgDQogICAgdWludDggQmxvY2tEZWxheTsNCg0KICAgIC8vIE1heGltdW0gYmV0IHZhbHVlIGZvciBnYW1lDQogICAgdWludDI1NiBjdXJyZW50TWF4QmV0OyAgICANCg0KICAgIC8vIG1heGltdW0gZ2FtZXMgY291bnQgcGVyIGJsb2NrDQogICAgdWludDY0IG1heEdhbWJsZXNQZXJCbG9jazsNCiAgICAgICAgDQogICAgLy8gRW5hYmxlXGRpc2FibGUgdG8gcGxhY2UgbmV3IGJldHMNCiAgICBib29sIENvbnRyYWN0U3RhdGU7DQoNCiAgICAvLyB0YWJsZSB3aXRoIHdpbm5lciBjb2VmZmljaWVudHMNCiAgICBXaW5NYXRyaXggd2luTWF0cml4Ow0KDQogICAgU21hcnRSb3VsZXR0ZVRva2VuIHNtYXJ0VG9rZW47DQoNCiAgICBhZGRyZXNzIHByb2ZpdERpc3RyaWJ1dGlvbkNvbnRyYWN0Ow0KDQogICAgU21hcnRBZmZpbGlhdGUgc21hcnRBZmZpbGlhdGVDb250cmFjdDsNCg0KICAgIHVpbnQxNiBjb25zdGFudCBtYXhUeXBlQmV0cyA9IDE1NzsNCiAgICAgIA0KICAgLy8gbGFzdCBnYW1lIGluZGV4IGZvciBwbGF5ZXIgKHVzZWQgZm9yIGZhc3QgYWNjZXNzKQ0KICAgLy9tYXBwaW5nIChhZGRyZXNzID0+IHVpbnQ2NCkgcHJpdmF0ZSBnYW1ibGVJbmRleDsgICANCiAgIA0KICAgdWludDE2IGNvZWZfcGxheWVyOyAgIA0KICAgLy8gDQogICB1aW50OCBkZWZhdWx0TWluQ3JlZGl0c09uQmV0OyANCiAgIC8vDQogICBtYXBwaW5nICh1aW50OCA9PiB1aW50OCkgcHJpdmF0ZSBtaW5DcmVkaXRzT25CZXQ7DQoNCiAgIHN0cnVjdCBHYW1lSW5mbw0KICAgew0KICAgICAgICBhZGRyZXNzIHBsYXllcjsNCiAgICAgICAgdWludDI1NiBibG9ja051bWJlcjsNCiAgICAgICAgdWludDggd2hlZWxSZXN1bHQ7DQogICAgICAgIHVpbnQyNTYgYmV0czsNCiAgICAgICAgYnl0ZXMzMiB2YWx1ZXM7DQogICAgICAgIGJ5dGVzMzIgdmFsdWVzMjsNCiAgIH0NCiAgICAgICANCiAgIEdhbWVJbmZvW10gcHJpdmF0ZSBnYW1ibGVzOw0KDQogICBlbnVtIEdhbWVTdGF0dXMge1N1Y2Nlc3MsIFNraXBwZWQsIFN0b3B9DQoNCiAgIGVudW0gQmV0VHlwZXN7bnVtYmVyMCwgbnVtYmVyMSxudW1iZXIyLG51bWJlcjMsbnVtYmVyNCxudW1iZXI1LG51bWJlcjYsbnVtYmVyNyxudW1iZXI4LG51bWJlcjksDQogICAgIG51bWJlcjEwLG51bWJlcjExLG51bWJlcjEyLG51bWJlcjEzLG51bWJlcjE0LG51bWJlcjE1LG51bWJlcjE2LG51bWJlcjE3LG51bWJlcjE4LG51bWJlcjE5LG51bWJlcjIwLG51bWJlcjIxLA0KICAgICBudW1iZXIyMixudW1iZXIyMyxudW1iZXIyNCxudW1iZXIyNSxudW1iZXIyNixudW1iZXIyNyxudW1iZXIyOCxudW1iZXIyOSxudW1iZXIzMCxudW1iZXIzMSxudW1iZXIzMixudW1iZXIzMywNCiAgICAgbnVtYmVyMzQsbnVtYmVyMzUsbnVtYmVyMzYsIHJlZCwgYmxhY2ssIG9kZCwgZXZlbiwgZG96ZW4xLGRvemVuMixkb3plbjMsIGNvbHVtbjEsY29sdW1uMixjb2x1bW4zLCBsb3csaGlnaCwNCiAgICAgcGFpcl8wMSwgcGFpcl8wMiwgcGFpcl8wMywgcGFpcl8xMiwgcGFpcl8yMywgcGFpcl8zNiwgcGFpcl8yNSwgcGFpcl8xNCwgcGFpcl80NSwgcGFpcl81NiwgcGFpcl82OSwgcGFpcl81OCwgcGFpcl80NywNCiAgICAgcGFpcl83OCwgcGFpcl84OSwgcGFpcl85MTIsIHBhaXJfODExLCBwYWlyXzcxMCwgcGFpcl8xMDExLCBwYWlyXzExMTIsIHBhaXJfMTIxNSwgcGFpcl8xNTE4LCBwYWlyXzE2MTcsIHBhaXJfMTcxOCwgcGFpcl8xNzIwLA0KICAgICBwYWlyXzE2MTksIHBhaXJfMTkyMiwgcGFpcl8yMDIzLCBwYWlyXzIxMjQsIHBhaXJfMjIyMywgcGFpcl8yMzI0LCBwYWlyXzI1MjgsIHBhaXJfMjYyOSwgcGFpcl8yNzMwLCBwYWlyXzI4MjksIHBhaXJfMjkzMCwgcGFpcl8xMTE0LA0KICAgICBwYWlyXzEwMTMsIHBhaXJfMTMxNCwgcGFpcl8xNDE1LCBwYWlyXzEzMTYsIHBhaXJfMTQxNywgcGFpcl8xODIxLCBwYWlyXzE5MjAsIHBhaXJfMjAyMSwgcGFpcl8yMjI1LCBwYWlyXzIzMjYsIHBhaXJfMjQyNywgcGFpcl8yNTI2LA0KICAgICBwYWlyXzI2MjcsIHBhaXJfMjgzMSwgcGFpcl8yOTMyLCBwYWlyXzMwMzMsIHBhaXJfMzEzMiwgcGFpcl8zMjMzLCBwYWlyXzMxMzQsIHBhaXJfMzIzNSwgcGFpcl8zMzM2LCBwYWlyXzM0MzUsIHBhaXJfMzUzNiwgY29ybmVyXzBfMV8yXzMsDQogICAgIGNvcm5lcl8xXzJfNV80LCBjb3JuZXJfMl8zXzZfNSwgY29ybmVyXzRfNV84XzcsIGNvcm5lcl81XzZfOV84LCBjb3JuZXJfN184XzExXzEwLCBjb3JuZXJfOF85XzEyXzExLCBjb3JuZXJfMTBfMTFfMTRfMTMsIGNvcm5lcl8xMV8xMl8xNV8xNCwNCiAgICAgY29ybmVyXzEzXzE0XzE3XzE2LCBjb3JuZXJfMTRfMTVfMThfMTcsIGNvcm5lcl8xNl8xN18yMF8xOSwgY29ybmVyXzE3XzE4XzIxXzIwLCBjb3JuZXJfMTlfMjBfMjNfMjIsIGNvcm5lcl8yMF8yMV8yNF8yMywgY29ybmVyXzIyXzIzXzI2XzI1LA0KICAgICBjb3JuZXJfMjNfMjRfMjdfMjYsIGNvcm5lcl8yNV8yNl8yOV8yOCwgY29ybmVyXzI2XzI3XzMwXzI5LCBjb3JuZXJfMjhfMjlfMzJfMzEsIGNvcm5lcl8yOV8zMF8zM18zMiwgY29ybmVyXzMxXzMyXzM1XzM0LCBjb3JuZXJfMzJfMzNfMzZfMzUsDQogICAgIHRocmVlXzBfMl8zLCB0aHJlZV8wXzFfMiwgdGhyZWVfMV8yXzMsIHRocmVlXzRfNV82LCB0aHJlZV83XzhfOSwgdGhyZWVfMTBfMTFfMTIsIHRocmVlXzEzXzE0XzE1LCB0aHJlZV8xNl8xN18xOCwgdGhyZWVfMTlfMjBfMjEsIHRocmVlXzIyXzIzXzI0LA0KICAgICB0aHJlZV8yNV8yNl8yNywgdGhyZWVfMjhfMjlfMzAsIHRocmVlXzMxXzMyXzMzLCB0aHJlZV8zNF8zNV8zNiwgc2l4XzFfMl8zXzRfNV82LCBzaXhfNF81XzZfN184XzksIHNpeF83XzhfOV8xMF8xMV8xMiwgc2l4XzEwXzExXzEyXzEzXzE0XzE1LA0KICAgICBzaXhfMTNfMTRfMTVfMTZfMTdfMTgsIHNpeF8xNl8xN18xOF8xOV8yMF8yMSwgc2l4XzE5XzIwXzIxXzIyXzIzXzI0LCBzaXhfMjJfMjNfMjRfMjVfMjZfMjcsIHNpeF8yNV8yNl8yN18yOF8yOV8zMCwgc2l4XzI4XzI5XzMwXzMxXzMyXzMzLA0KICAgICBzaXhfMzFfMzJfMzNfMzRfMzVfMzZ9DQogICANCg0KICAgZnVuY3Rpb24gU21hcnRSb3VsZXR0ZSgpIGludGVybmFsDQogICB7ICAgICAgICANCiAgICAgICAgZGV2ZWxvcGVyICA9IG1zZy5zZW5kZXI7DQogICAgICAgIG9wZXJhdG9yICAgPSBtc2cuc2VuZGVyOw0KICAgICAgICANCiAgICAgICAgd2luTWF0cml4ID0gV2luTWF0cml4KDB4MDczRDY2MjFFOTE1MGJGZjlkMUQ0NTBjYUFkM2M3OTBiNkYwNzFGMiApOw0KICAgICAgICBpZiAod2luTWF0cml4LmdldEJldHNQcm9jZXNzZWQoKSAhPSBtYXhUeXBlQmV0cykgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBzbWFydFRva2VuID0gU21hcnRSb3VsZXR0ZVRva2VuKDB4N2REOEQ0YzU1NmQyMDA1YzViYWZjM2Q1NDQ5QTk5RmI0NjI3OUU2Yik7DQoNCiAgICAgICAgY3VycmVudE1heEJldCA9IDI1NjAgZmlubmV5OyAvLyAyLjU2IGV0aGVyDQogICAgICAgIEJsb2NrRGVsYXkgPSAxOyAgICAgICAgDQogICAgICAgIG1heEdhbWJsZXNQZXJCbG9jayA9IDU7DQogICAgICAgIGRlZmF1bHRNaW5DcmVkaXRzT25CZXQgPSAxOyAgIA0KICAgICAgICBDb250cmFjdFN0YXRlICA9IHRydWU7ICANCiAgICAgICAgYmFua3JvbExpbWl0ID0gMjc3IGV0aGVyOw0KICAgICAgICBwcm9maXRMaW1pdCAgPSA1MCBldGhlcjsNCiAgICAgICAgY29lZl9wbGF5ZXIgPSAzMDA7DQogICB9DQoNCiAgIGZ1bmN0aW9uIGNoYW5nZU1heEJldCh1aW50MjU2IG5ld01heEJldCkgcHVibGljIG9ubHlEZXZlbG9wZXIgDQogICB7ICAgICAgICAgICAgIA0KICAgICAgLy8gcm91bmRzIHRvIDIgZGlndHMNCiAgICAgIG5ld01heEJldCA9IG5ld01heEJldCAvIDI1NjAwMDAwMDAwMDAwMDAwMDAgKiAyNTYwMDAwMDAwMDAwMDAwMDAwOyAgDQogICAgICBpZiAobmV3TWF4QmV0ICE9IGN1cnJlbnRNYXhCZXQpIA0KICAgICAgew0KICAgICAgICBjdXJyZW50TWF4QmV0ID0gbmV3TWF4QmV0Ow0KICAgICAgICBTZXR0aW5nc0NoYW5nZWQoY3VycmVudE1heEJldCwgY3VycmVudE1heEJldCAvIDI1NiwgIGRlZmF1bHRNaW5DcmVkaXRzT25CZXQsIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5sb3cpXSwgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmRvemVuMSldLCBCbG9ja0RlbGF5LCBDb250cmFjdFN0YXRlKTsNCiAgICAgIH0NCiAgIH0NCg0KICAgdWludDI1NiBiYW5rcm9sTGltaXQ7DQogICB1aW50MjU2IHByb2ZpdExpbWl0Ow0KICAgdWludDI1NiBsYXN0RGlzdHJpYnV0ZWRQcm9maXQ7DQogICB1aW50MjU2IGxhc3REYXRlRGlzdHJpYnV0ZWRQcm9maXQ7DQogICANCiAgIGZ1bmN0aW9uIGdldERpc3RyaWJ1dGVQcm9maXRzSW5mbygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGxhc3RQcm9maXQsIHVpbnQyNTYgbGFzdERhdGUpDQogICB7DQogICAgICBsYXN0UHJvZml0ID0gbGFzdERpc3RyaWJ1dGVkUHJvZml0Ow0KICAgICAgbGFzdERhdGUgPSBsYXN0RGF0ZURpc3RyaWJ1dGVkUHJvZml0Ow0KICAgfQ0KDQogICBmdW5jdGlvbiBzZXRQcm9maXREaXN0cmlidXRpb25Db250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcmVzcykgb25seURldmVsb3Blcg0KICAgew0KICAgICAgaWYgKHByb2ZpdERpc3RyaWJ1dGlvbkNvbnRyYWN0ID4gMCkgdGhyb3c7DQogICAgICBwcm9maXREaXN0cmlidXRpb25Db250cmFjdCA9IGNvbnRyYWN0QWRkcmVzczsNCiAgIH0NCg0KICAgZnVuY3Rpb24gc2V0U21hcnRBZmZpbGlhdGVDb250cmFjdChhZGRyZXNzIGNvbnRyYWN0QWRkcmVzcykgb25seURldmVsb3Blcg0KICAgew0KICAgICAgaWYgKGFkZHJlc3Moc21hcnRBZmZpbGlhdGVDb250cmFjdCkgPiAwKSB0aHJvdzsNCiAgICAgIHNtYXJ0QWZmaWxpYXRlQ29udHJhY3QgPSBTbWFydEFmZmlsaWF0ZShjb250cmFjdEFkZHJlc3MpOw0KICAgfQ0KDQogICBmdW5jdGlvbiBkaXN0cmlidXRlUHJvZml0cyh1aW50MjU2IGdhc1ZhbHVlKSBvbmx5RGV2ZWxvcGVyT3JPcGVyYXRvcg0KICAgew0KICAgICAgaWYgKHByb2ZpdERpc3RyaWJ1dGlvbkNvbnRyYWN0ID4gMCAmJiB0aGlzLmJhbGFuY2UgPj0gKGJhbmtyb2xMaW1pdCtwcm9maXRMaW1pdCkpDQogICAgICB7DQogICAgICAgICB1aW50MjU2IGRpZmYgPSB0aGlzLmJhbGFuY2UgLSBiYW5rcm9sTGltaXQ7DQogICAgICAgICBpZiAoYWRkcmVzcyhwcm9maXREaXN0cmlidXRpb25Db250cmFjdCkuY2FsbC5nYXMoZ2FzVmFsdWUpLnZhbHVlKGRpZmYpKCkgPT0gZmFsc2UpIHRocm93Ow0KICAgICAgICAgbGFzdERpc3RyaWJ1dGVkUHJvZml0ID0gZGlmZjsNCiAgICAgICAgIGxhc3REYXRlRGlzdHJpYnV0ZWRQcm9maXQgPSBibG9jay50aW1lc3RhbXA7DQogICAgICB9ICAgICAgDQogICB9DQoNCiAgIGZ1bmN0aW9uIGdldFRva2VuU2V0dGluZ3MoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyh1aW50MTYgQ29lZl9wbGF5ZXIsIHVpbnQyNTYgQmFua3JvbExpbWl0LCB1aW50MjU2IFByb2ZpdExpbWl0KQ0KICAgew0KICAgICAgQ29lZl9wbGF5ZXIgPSBjb2VmX3BsYXllcjsgICAgICANCiAgICAgIEJhbmtyb2xMaW1pdCA9IGJhbmtyb2xMaW1pdDsNCiAgICAgIFByb2ZpdExpbWl0ID0gcHJvZml0TGltaXQ7DQogICB9DQoNCiAgIGZ1bmN0aW9uIGNoYW5nZVRva2VuU2V0dGluZ3ModWludDE2IG5ld0NvZWZfcGxheWVyLCB1aW50MjU2IG5ld0Jhbmtyb2xMaW1pdCwgdWludDI1NiBuZXdQcm9maXRMaW1pdCkgb25seURldmVsb3Blcg0KICAgew0KICAgICAgY29lZl9wbGF5ZXIgID0gbmV3Q29lZl9wbGF5ZXI7ICAgICAgDQogICAgICBiYW5rcm9sTGltaXQgPSBuZXdCYW5rcm9sTGltaXQ7DQogICAgICBwcm9maXRMaW1pdCAgPSBuZXdQcm9maXRMaW1pdDsNCiAgIH0NCg0KICAgZnVuY3Rpb24gY2hhbmdlU2V0dGluZ3ModWludDY0IE5ld01heEJldHNQZXJCbG9jaywgdWludDggTmV3QmxvY2tEZWxheSwgdWludDggTWluQ3JlZGl0c09uQmV0NTAsIHVpbnQ4IE1pbkNyZWRpdHNPbkJldDMzLCB1aW50OCBOZXdEZWZhdWx0TWluQ3JlZGl0c09uQmV0KSBvbmx5RGV2ZWxvcGVyDQogICB7ICAgICANCiAgICAgIEJsb2NrRGVsYXkgPSBOZXdCbG9ja0RlbGF5OyAgICAgDQoNCiAgICAgIGlmIChOZXdNYXhCZXRzUGVyQmxvY2sgIT0gMCkgbWF4R2FtYmxlc1BlckJsb2NrID0gTmV3TWF4QmV0c1BlckJsb2NrOyAgICAgDQoNCiAgICAgIGlmIChNaW5DcmVkaXRzT25CZXQ1MCA+IDApDQogICAgICB7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5sb3cpXSAgID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5oaWdoKV0gID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5yZWQpXSAgID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5ibGFjayldID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5vZGQpXSAgID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5ldmVuKV0gID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICB9ICANCg0KICAgICAgaWYgKE1pbkNyZWRpdHNPbkJldDMzID4gMCkNCiAgICAgIHsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmRvemVuMSldID0gTWluQ3JlZGl0c09uQmV0MzM7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5kb3plbjIpXSA9IE1pbkNyZWRpdHNPbkJldDMzOw0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuZG96ZW4zKV0gPSBNaW5DcmVkaXRzT25CZXQzMzsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmNvbHVtbjEpXSA9IE1pbkNyZWRpdHNPbkJldDMzOw0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuY29sdW1uMildID0gTWluQ3JlZGl0c09uQmV0MzM7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5jb2x1bW4zKV0gPSBNaW5DcmVkaXRzT25CZXQzMzsNCiAgICAgIH0NCg0KICAgICAgaWYgKE5ld0RlZmF1bHRNaW5DcmVkaXRzT25CZXQgPiAwKSBkZWZhdWx0TWluQ3JlZGl0c09uQmV0ID0gTmV3RGVmYXVsdE1pbkNyZWRpdHNPbkJldDsgICANCiAgIH0NCiAgIA0KICAgZnVuY3Rpb24gZGVsZXRlQ29udHJhY3QoKSBvbmx5RGV2ZWxvcGVyICANCiAgIHsNCiAgICAgICAgc3VpY2lkZShtc2cuc2VuZGVyKTsNCiAgIH0NCg0KICAgLy8gYml0IGZyb20gMCB0byAyNTUNCiAgIGZ1bmN0aW9uIGlzQml0U2V0KHVpbnQyNTYgZGF0YSwgdWludDggYml0KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wgcmV0KQ0KICAgew0KICAgICAgIGFzc2VtYmx5IHsNCiAgICAgICAgICAgIHJldCA6PSBpc3plcm8oaXN6ZXJvKGFuZChkYXRhLCBleHAoMixiaXQpKSkpDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHJldDsNCiAgIH0NCg0KICAgLy8gdW5pcXVlIGNvbWJpbmF0aW9uIG9mIGJldCBhbmQgd2hlZWxSZXN1bHQsIHVzZWQgZm9yIGFjY2VzcyB0byBXaW5NYXRyaXgNCiAgIGZ1bmN0aW9uIGdldEluZGV4KHVpbnQxNiBiZXQsIHVpbnQxNiB3aGVlbFJlc3VsdCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50MTYpDQogICB7DQogICAgICByZXR1cm4gKGJldCsxKSoyNTYgKyAod2hlZWxSZXN1bHQrMSk7DQogICB9DQoNCiAgIC8vIG4gZm9ybSAxIDw9IHRvIDw9IDMyDQogICBmdW5jdGlvbiBnZXRCZXRWYWx1ZShieXRlczMyIHZhbHVlcywgdWludDggbikgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQ0KICAgew0KICAgICAgICAvLyBiZXQgaW4gY3JlZGl0cyAoMS4uMjU2KSANCiAgICAgICAgdWludDI1NiBiZXQgPSB1aW50MjU2KHZhbHVlc1szMi1uXSkrMTsNCg0KICAgICAgICAgLy8gY2hlY2sgbWluIGJldA0KICAgICAgICB1aW50OCBtaW5DcmVkaXRzID0gbWluQ3JlZGl0c09uQmV0W25dOw0KICAgICAgICBpZiAobWluQ3JlZGl0cyA9PSAwKSBtaW5DcmVkaXRzID0gZGVmYXVsdE1pbkNyZWRpdHNPbkJldDsNCiAgICAgICAgaWYgKGJldCA8IG1pbkNyZWRpdHMpIHRocm93Ow0KICAgICAgICANCiAgICAgICAgLy8gYmV0IGluIHdlaQ0KICAgICAgICBiZXQgPSBjdXJyZW50TWF4QmV0KmJldC8yNTY7DQogICAgICAgIGlmIChiZXQgPiBjdXJyZW50TWF4QmV0KSB0aHJvdzsgICAgICAgICANCg0KICAgICAgICByZXR1cm4gYmV0OyAgICAgICAgDQogICB9DQoNCiAgIGZ1bmN0aW9uIGdldEJldFZhbHVlQnlHYW1ibGUoR2FtZUluZm8gbWVtb3J5IGdhbWJsZSwgdWludDggbikgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSANCiAgIHsNCiAgICAgIGlmIChuPD0zMikgcmV0dXJuIGdldEJldFZhbHVlKGdhbWJsZS52YWx1ZXMsIG4pOw0KICAgICAgaWYgKG48PTY0KSByZXR1cm4gZ2V0QmV0VmFsdWUoZ2FtYmxlLnZhbHVlczIsIG4tMzIpOw0KICAgICAgLy8gdGhlcmUgYXJlIDY0IG1heGltdW0gdW5pcXVlIGJldHMgKHBvc2l0aW9ucykgaW4gb25lIGdhbWUNCiAgICAgIHRocm93Ow0KICAgfQ0KICANCiAgIGZ1bmN0aW9uIHRvdGFsR2FtZXMoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQ0KICAgew0KICAgICAgIHJldHVybiBnYW1ibGVzLmxlbmd0aDsNCiAgIH0NCiAgIA0KICAgZnVuY3Rpb24gZ2V0U2V0dGluZ3MoKSBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYgbWF4QmV0LCB1aW50MjU2IG9uZUNyZWRpdCwgdWludDggTWluQmV0SW5DcmVkaXRzLCB1aW50OCBNaW5CZXRJbkNyZWRpdHNfNTAsdWludDggTWluQmV0SW5DcmVkaXRzXzMzLCB1aW50OCBibG9ja0RlbGF5QmVmb3JlU3BpbiwgYm9vbCBjb250cmFjdFN0YXRlKQ0KICAgIHsNCiAgICAgICAgbWF4QmV0ICAgID0gY3VycmVudE1heEJldDsNCiAgICAgICAgb25lQ3JlZGl0ID0gY3VycmVudE1heEJldCAvIDI1NjsgDQogICAgICAgIGJsb2NrRGVsYXlCZWZvcmVTcGluID0gQmxvY2tEZWxheTsgICAgICAgIA0KICAgICAgICBNaW5CZXRJbkNyZWRpdHMgICAgICA9IGRlZmF1bHRNaW5DcmVkaXRzT25CZXQ7DQogICAgICAgIE1pbkJldEluQ3JlZGl0c181MCAgID0gbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmxvdyldOyANCiAgICAgICAgTWluQmV0SW5DcmVkaXRzXzMzICAgPSBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuY29sdW1uMSldOyANCiAgICAgICAgY29udHJhY3RTdGF0ZSAgICAgICAgPSBDb250cmFjdFN0YXRlOw0KICAgIH0NCiAgIA0KICAgIG1vZGlmaWVyIG9ubHlEZXZlbG9wZXIoKSANCiAgICB7DQogICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVyKSB0aHJvdzsNCiAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yKCkgDQogICAgew0KICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGRldmVsb3BlciAmJiBtc2cuc2VuZGVyICE9IG9wZXJhdG9yKSB0aHJvdzsNCiAgICAgICBfOw0KICAgIH0NCg0KICAgZnVuY3Rpb24gZGlzYWJsZUJldHRpbmdfb25seV9EZXYoKQ0KICAgIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yDQogICAgew0KICAgICAgICBDb250cmFjdFN0YXRlPWZhbHNlOw0KICAgIH0NCg0KDQogICAgZnVuY3Rpb24gY2hhbmdlT3BlcmF0b3IoYWRkcmVzcyBuZXdPcGVyYXRvcikgb25seURldmVsb3Blcg0KICAgIHsNCiAgICAgICBvcGVyYXRvciA9IG5ld09wZXJhdG9yOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGVuYWJsZUJldHRpbmdfb25seV9EZXYoKQ0KICAgIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yDQogICAgew0KICAgICAgICBDb250cmFjdFN0YXRlPXRydWU7DQoNCiAgICB9DQoNCiAgICBldmVudCBQbGF5ZXJCZXQodWludDI1NiBnYW1ibGVJZCwgdWludDI1NiBwbGF5ZXJUb2tlbnMpOw0KICAgIGV2ZW50IEVuZEdhbWUoYWRkcmVzcyBwbGF5ZXIsIHVpbnQ4IHJlc3VsdCwgdWludDI1NiBnYW1ibGVJZCk7DQogICAgZXZlbnQgU2V0dGluZ3NDaGFuZ2VkKHVpbnQyNTYgbWF4QmV0LCB1aW50MjU2IG9uZUNyZWRpdCwgdWludDggRGVmYXVsdE1pbkJldEluQ3JlZGl0cywgdWludDggTWluQmV0SW5DcmVkaXRzNTAsIHVpbnQ4IE1pbkJldEluQ3JlZGl0czMzLCB1aW50OCBibG9ja0RlbGF5QmVmb3JlU3BpbiwgYm9vbCBjb250cmFjdFN0YXRlKTsNCiAgICBldmVudCBFcnJvckxvZyhhZGRyZXNzIHBsYXllciwgc3RyaW5nIG1lc3NhZ2UpOw0KICAgIGV2ZW50IEdhc0xvZyhzdHJpbmcgbXNnLCB1aW50MjU2IGxldmVsLCB1aW50MjU2IGdhcyk7DQoNCiAgIGZ1bmN0aW9uIHRvdGFsQmV0VmFsdWUoR2FtZUluZm8gbWVtb3J5IGcpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludDI1NikNCiAgIHsgICAgICAgICAgICAgIA0KICAgICAgIHVpbnQyNTYgdG90YWxCZXRzVmFsdWUgPSAwOyANCiAgICAgICB1aW50OCBuUGxheWVyQmV0Tm8gPSAwOw0KICAgICAgIHVpbnQ4IGJldHNDb3VudCA9IHVpbnQ4KGJ5dGVzMzIoZy5iZXRzKVswXSk7DQoNCiAgICAgICBmb3IodWludDggaSA9IDA7IGkgPCBtYXhUeXBlQmV0cztpKyspIA0KICAgICAgICBpZiAoaXNCaXRTZXQoZy5iZXRzLCBpKSkNCiAgICAgICAgew0KICAgICAgICAgIHRvdGFsQmV0c1ZhbHVlICs9IGdldEJldFZhbHVlQnlHYW1ibGUoZywgblBsYXllckJldE5vKzEpOw0KICAgICAgICAgIG5QbGF5ZXJCZXRObysrOw0KDQogICAgICAgICAgaWYgKGJldHNDb3VudCA9PSAxKSBicmVhazsNCiAgICAgICAgICBiZXRzQ291bnQtLTsgICAgICAgICAgDQogICAgICAgIH0NCg0KICAgICAgIHJldHVybiB0b3RhbEJldHNWYWx1ZTsNCiAgIH0NCg0KICAgZnVuY3Rpb24gdG90YWxCZXRDb3VudChHYW1lSW5mbyBtZW1vcnkgZykgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KQ0KICAgeyAgICAgICAgICAgICAgDQogICAgICAgdWludDI1NiB0b3RhbEJldHMgPSAwOyANCiAgICAgICBmb3IodWludDggaT0wOyBpIDwgbWF4VHlwZUJldHM7aSsrKSANCiAgICAgICAgaWYgKGlzQml0U2V0KGcuYmV0cywgaSkpIHRvdGFsQmV0cysrOyAgICAgICAgICANCiAgICAgICByZXR1cm4gdG90YWxCZXRzOyAgIA0KICAgfQ0KDQogICBmdW5jdGlvbiBwbGFjZUJldCh1aW50MjU2IGJldHMsIGJ5dGVzMzIgdmFsdWVzMSxieXRlczMyIHZhbHVlczIpIHB1YmxpYyBwYXlhYmxlDQogICB7DQogICAgICAgaWYgKENvbnRyYWN0U3RhdGUgPT0gZmFsc2UpDQogICAgICAgew0KICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIkNvbnRyYWN0RGlzYWJsZWQiKTsNCiAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICByZXR1cm47DQogICAgICAgfSANCg0KICAgICAgIHZhciBnYW1ibGVzTGVuZ3RoID0gZ2FtYmxlcy5sZW5ndGg7DQoNCiAgICAgICBpZiAoZ2FtYmxlc0xlbmd0aCA+IDApDQogICAgICAgew0KICAgICAgICAgIHVpbnQ4IGdhbWJsZXNDb3VudEluQ3VycmVudEJsb2NrID0gMDsNCiAgICAgICAgICBmb3IodmFyIGkgPSBnYW1ibGVzTGVuZ3RoIC0gMTtpID4gMDsgaS0tKQ0KICAgICAgICAgIHsNCiAgICAgICAgICAgIGlmIChnYW1ibGVzW2ldLmJsb2NrTnVtYmVyID09IGJsb2NrLm51bWJlcikgDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICBpZiAoZ2FtYmxlc1tpXS5wbGF5ZXIgPT0gbXNnLnNlbmRlcikNCiAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICBFcnJvckxvZyhtc2cuc2VuZGVyLCAiUGxheSB0d2ljZSB0aGUgc2FtZSBibG9jayIpOw0KICAgICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICBnYW1ibGVzQ291bnRJbkN1cnJlbnRCbG9jaysrOw0KICAgICAgICAgICAgICAgaWYgKGdhbWJsZXNDb3VudEluQ3VycmVudEJsb2NrID49IG1heEdhbWJsZXNQZXJCbG9jaykNCiAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgIEVycm9yTG9nKG1zZy5zZW5kZXIsICJtYXhHYW1ibGVzUGVyQmxvY2siKTsNCiAgICAgICAgICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgfQ0KICAgICAgIA0KICAgICAgIHZhciBfY3VycmVudE1heEJldCA9IGN1cnJlbnRNYXhCZXQ7DQoNCiAgICAgICBpZiAobXNnLnZhbHVlIDwgX2N1cnJlbnRNYXhCZXQvMjU2IHx8IGJldHMgPT0gMCkNCiAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIldyb25nIGJldCB2YWx1ZSIpOw0KICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgIH0NCg0KICAgICAgIGlmIChtc2cudmFsdWUgPiBfY3VycmVudE1heEJldCkNCiAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIkxpbWl0IGZvciB0YWJsZSIpOw0KICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgIH0NCg0KICAgICAgIEdhbWVJbmZvIG1lbW9yeSBnID0gR2FtZUluZm8obXNnLnNlbmRlciwgYmxvY2subnVtYmVyLCAzNywgYmV0cywgdmFsdWVzMSx2YWx1ZXMyKTsNCg0KICAgICAgIGlmICh0b3RhbEJldFZhbHVlKGcpICE9IG1zZy52YWx1ZSkNCiAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIldyb25nIGJldCB2YWx1ZSIpOw0KICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgIH0NCg0KICAgICAgIGdhbWJsZXMucHVzaChnKTsNCg0KICAgICAgIGFkZHJlc3MgYWZmaWxpYXRlID0gMDsNCiAgICAgICB1aW50MTYgY29lZl9hZmZpbGlhdGUgPSAwOw0KICAgICAgIGlmIChhZGRyZXNzKHNtYXJ0QWZmaWxpYXRlQ29udHJhY3QpID4gMCkNCiAgICAgICB7DQogICAgICAgICAoYWZmaWxpYXRlLCBjb2VmX2FmZmlsaWF0ZSkgPSBzbWFydEFmZmlsaWF0ZUNvbnRyYWN0LmdldEFmZmlsaWF0ZUluZm8obXNnLnNlbmRlcik7ICAgDQogICAgICAgfQ0KICAgICAgIA0KICAgICAgIHVpbnQyNTYgcGxheWVyVG9rZW5zID0gc21hcnRUb2tlbi5lbWlzc2lvbihtc2cuc2VuZGVyLCBhZmZpbGlhdGUsIG1zZy52YWx1ZSwgY29lZl9wbGF5ZXIsIGNvZWZfYWZmaWxpYXRlKTsgICAgICAgICAgICANCg0KICAgICAgIFBsYXllckJldChnYW1ibGVzTGVuZ3RoLCBwbGF5ZXJUb2tlbnMpOyANCiAgIH0NCg0KICAgIGZ1bmN0aW9uIEludmVzdCgpIHBheWFibGUgb25seURldmVsb3Blcg0KICAgIHsNCiAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIEdldEdhbWVJbmRleGVzVG9Qcm9jZXNzKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTZbNjRdIGdhbWVJbmRleGVzKQ0KICAgIHsgICAgICAgICAgIA0KICAgICAgdWludDggaW5kZXggPSAwOw0KICAgICAgZm9yKGludDI1NiBpID0gaW50MjU2KGdhbWJsZXMubGVuZ3RoKSAtIDE7aSA+PSAwO2ktLSkNCiAgICAgIHsgICAgICANCiAgICAgICAgIEdhbWVJbmZvIG1lbW9yeSBnID0gZ2FtYmxlc1t1aW50MjU2KGkpXTsNCiAgICAgICAgIGlmIChibG9jay5udW1iZXIgLSBnLmJsb2NrTnVtYmVyID49IDI1NikgYnJlYWs7DQoNCiAgICAgICAgIGlmIChnLndoZWVsUmVzdWx0ID09IDM3ICYmIGJsb2NrLm51bWJlciA+PSBnLmJsb2NrTnVtYmVyICsgQmxvY2tEZWxheSkNCiAgICAgICAgIHsgDQogICAgICAgICAgICBnYW1lSW5kZXhlc1tpbmRleCsrXSA9IHVpbnQyNTYoaSArIDEpOw0KICAgICAgICAgfQ0KICAgICAgfSAgICAgIA0KICAgIH0NCg0KICAgIHVpbnQyNTYgbGFzdEJsb2NrR2FtZXNQcm9jZXNzZWQ7DQoNCiAgICBmdW5jdGlvbiBQcm9jZXNzR2FtZXModWludDI1NltdIGdhbWVJbmRleGVzLCBib29sIHNpbXVsYXRlKSANCiAgICB7DQogICAgICBpZiAoIXNpbXVsYXRlKQ0KICAgICAgew0KICAgICAgICAgaWYgKGxhc3RCbG9ja0dhbWVzUHJvY2Vzc2VkID09IGJsb2NrLm51bWJlcikgIHJldHVybjsNCiAgICAgICAgIGxhc3RCbG9ja0dhbWVzUHJvY2Vzc2VkID0gYmxvY2subnVtYmVyOw0KICAgICAgfQ0KDQogICAgICB1aW50OCBkZWxheSA9IEJsb2NrRGVsYXk7DQogICAgICB1aW50MjU2IGxlbmd0aCA9IGdhbWVJbmRleGVzLmxlbmd0aDsNCiAgICAgIGJvb2wgc3VjY2VzcyA9IGZhbHNlOw0KICAgICAgZm9yKHVpbnQyNTYgaSA9IDA7aSA8IGxlbmd0aDtpKyspDQogICAgICB7ICAgICAgDQogICAgICAgICBpZiAoUHJvY2Vzc0dhbWUoZ2FtZUluZGV4ZXNbaV0sIGRlbGF5KSA9PSBHYW1lU3RhdHVzLlN1Y2Nlc3MpIHN1Y2Nlc3MgPSB0cnVlOyAgICAgICAgIA0KICAgICAgfSAgICAgIA0KICAgICAgaWYgKHNpbXVsYXRlICYmICFzdWNjZXNzKSB0aHJvdzsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gUHJvY2Vzc0dhbWVFeHQodWludDI1NiBpbmRleCkgcHVibGljIHJldHVybnMgKEdhbWVTdGF0dXMpDQogICAgew0KICAgICAgcmV0dXJuIFByb2Nlc3NHYW1lKGluZGV4LCBCbG9ja0RlbGF5KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBQcm9jZXNzR2FtZSh1aW50MjU2IGluZGV4LCB1aW50MjU2IGRlbGF5KSBwcml2YXRlIHJldHVybnMgKEdhbWVTdGF0dXMpDQogICAgeyAgICAgICAgICAgIA0KICAgICAgR2FtZUluZm8gbWVtb3J5IGcgPSBnYW1ibGVzW2luZGV4XTsNCiAgICAgIGlmIChibG9jay5udW1iZXIgLSBnLmJsb2NrTnVtYmVyID49IDI1NikgcmV0dXJuIEdhbWVTdGF0dXMuU3RvcDsNCg0KICAgICAgaWYgKGcud2hlZWxSZXN1bHQgPT0gMzcgJiYgYmxvY2subnVtYmVyID4gZy5ibG9ja051bWJlciArIGRlbGF5KQ0KICAgICAgeyAgICAgICAgICAgIA0KICAgICAgICAgZ2FtYmxlc1tpbmRleF0ud2hlZWxSZXN1bHQgPSBnZXRSYW5kb21OdW1iZXIoZy5wbGF5ZXIsIGcuYmxvY2tOdW1iZXIpOw0KICAgICAgICAgICAgICAgICANCiAgICAgICAgIHVpbnQyNTYgcGxheWVyV2lubmluZ3MgPSBnZXRHYW1lUmVzdWx0KHVpbnQ2NChpbmRleCkpOw0KICAgICAgICAgaWYgKHBsYXllcldpbm5pbmdzID4gMCkgDQogICAgICAgICB7DQogICAgICAgICAgICBpZiAoZy5wbGF5ZXIuc2VuZChwbGF5ZXJXaW5uaW5ncykgPT0gZmFsc2UpIHRocm93Ow0KICAgICAgICAgfQ0KDQogICAgICAgICBFbmRHYW1lKGcucGxheWVyLCBnYW1ibGVzW2luZGV4XS53aGVlbFJlc3VsdCwgaW5kZXgpOw0KICAgICAgICAgcmV0dXJuIEdhbWVTdGF0dXMuU3VjY2VzczsNCiAgICAgIH0NCg0KICAgICAgcmV0dXJuIEdhbWVTdGF0dXMuU2tpcHBlZDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRSYW5kb21OdW1iZXIoYWRkcmVzcyBwbGF5ZXIsIHVpbnQyNTYgcGxheWVyYmxvY2spIHByaXZhdGUgcmV0dXJucyh1aW50OCB3aGVlbFJlc3VsdCkNCiAgICB7DQogICAgICAgIC8vIGJsb2NrLmJsb2NraGFzaCAtIGhhc2ggb2YgdGhlIGdpdmVuIGJsb2NrIC0gb25seSB3b3JrcyBmb3IgMjU2IG1vc3QgcmVjZW50IGJsb2NrcyBleGNsdWRpbmcgY3VycmVudA0KICAgICAgICBieXRlczMyIGJsb2NrSGFzaCA9IGJsb2NrLmJsb2NraGFzaChwbGF5ZXJibG9jaytCbG9ja0RlbGF5KTsgDQogICAgICAgIA0KICAgICAgICBpZiAoYmxvY2tIYXNoPT0wKSANCiAgICAgICAgew0KICAgICAgICAgIEVycm9yTG9nKG1zZy5zZW5kZXIsICJDYW5ub3QgZ2VuZXJhdGUgcmFuZG9tIG51bWJlciIpOw0KICAgICAgICAgIHdoZWVsUmVzdWx0ID0gMjAwOw0KICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgIGJ5dGVzMzIgc2hhUGxheWVyID0gc2hhMyhwbGF5ZXIsIGJsb2NrSGFzaCk7DQogICAgDQogICAgICAgICAgd2hlZWxSZXN1bHQgPSB1aW50OCh1aW50MjU2KHNoYVBsYXllciklMzcpOw0KICAgICAgICB9ICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVJhbmRvbU51bWJlckJ5QmxvY2toYXNoKHVpbnQyNTYgYmxvY2tIYXNoLCBhZGRyZXNzIHBsYXllcikgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQ4IHdoZWVsUmVzdWx0KSANCiAgICB7IA0KICAgICAgICAgIGJ5dGVzMzIgc2hhUGxheWVyID0gc2hhMyhwbGF5ZXIsIGJsb2NrSGFzaCk7DQogICAgDQogICAgICAgICAgd2hlZWxSZXN1bHQgPSB1aW50OCh1aW50MjU2KHNoYVBsYXllciklMzcpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGVtZXJnZW5jeUZpeEdhbWVSZXN1bHQodWludDY0IGdhbWJsZUlkLCB1aW50MjU2IGJsb2NrSGFzaCkgb25seURldmVsb3Blck9yT3BlcmF0b3INCiAgICB7DQogICAgICAvLyBQcm9iYWJseSB0aGlzIGZ1bmN0aW9uIHdpbGwgbmV2ZXIgYmUgY2FsbGVkLCBidXQNCiAgICAgIC8vIGlmIGdhbWUgd2FzIG5vdCBzcGlubmVkIGluIDI1NiBibG9ja3MgdGhlbiBibG9jay5ibG9ja2hhc2ggd2lsbCByZXR1cm5zIGFsd2F5cyAwIGFuZCANCiAgICAgIC8vIHdlIHNob3VsZCBmaXggdGhpcyBtYW51YWxseSAoeW91IGNhbiBjaGVjayByZXN1bHQgd2l0aCBwdWJsaWMgZnVuY3Rpb24gY2FsY3VsYXRlUmFuZG9tTnVtYmVyQnlCbG9ja2hhc2gpDQogICAgICBHYW1lSW5mbyBtZW1vcnkgZ2FtYmxlID0gZ2FtYmxlc1tnYW1ibGVJZF07DQogICAgICBpZiAoZ2FtYmxlLndoZWVsUmVzdWx0ICE9IDIwMCkgdGhyb3c7DQoNCiAgICAgIGdhbWJsZXNbZ2FtYmxlSWRdLndoZWVsUmVzdWx0ID0gY2FsY3VsYXRlUmFuZG9tTnVtYmVyQnlCbG9ja2hhc2goYmxvY2tIYXNoLCBnYW1ibGUucGxheWVyKTsNCiAgICAgIC8vZ2FtYmxlc1tnYW1ibGVJZF0uYmxvY2tTcGlubmVkID0gYmxvY2subnVtYmVyOw0KDQogICAgICBpZiAoZ2FtYmxlLnBsYXllci5zZW5kKGdldEdhbWVSZXN1bHQoZ2FtYmxlSWQpKSA9PSBmYWxzZSkgdGhyb3c7DQoNCiAgICAgIEVuZEdhbWUoZ2FtYmxlLnBsYXllciwgZ2FtYmxlLndoZWVsUmVzdWx0LCBnYW1ibGVJZCk7DQogICAgfQ0KDQoNCiAgICANCiAgICAvLw0KICAgIGZ1bmN0aW9uIGNoZWNrR2FtZXNSZWFkeUZvclNwaW5uaW5nKCkgY29uc3RhbnQgcmV0dXJucyAoaW50MjU2WzI1Nl0gcmV0KSANCiAgICB7IA0KICAgICAgdWludDE2IGluZGV4ID0gMDsgICAgDQogICAgICBmb3IoaW50MjU2IGkgPSBpbnQyNTYoZ2FtYmxlcy5sZW5ndGgpIC0gMTtpID49IDA7aS0tKQ0KICAgICAgeyAgICAgIA0KICAgICAgICAgR2FtZUluZm8gbWVtb3J5IGcgPSBnYW1ibGVzW3VpbnQyNTYoaSldOw0KICAgICAgICAgaWYgKGJsb2NrLm51bWJlciAtIGcuYmxvY2tOdW1iZXIgPj0gMjU2KSByZXR1cm4gOw0KDQogICAgICAgICBpZiAoZy53aGVlbFJlc3VsdCA9PSAzNyAmJiBibG9jay5udW1iZXIgPiBnLmJsb2NrTnVtYmVyICsgQmxvY2tEZWxheSkNCiAgICAgICAgIHsgICAgICAgICAgICANCiAgICAgICAgICAgIHJldFtpbmRleCsrXSA9IGkrMTsgICAgICAgICAgICANCiAgICAgICAgIH0gICAgICAgICAgICAgICANCiAgICAgIH0gDQogICAgfQ0KDQogICAgZnVuY3Rpb24gcHJlbGltaW5hcnlHYW1lUmVzdWx0KHVpbnQ2NCBnYW1ibGVJbmRleCkgY29uc3RhbnQgcmV0dXJucyAodWludDY0IGdhbWJsZUlkLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBibG9ja051bWJlciwgdWludDI1NiB0b3RhbFdpbiwgdWludDggd2hlZWxSZXN1bHQsIHVpbnQyNTYgYmV0cywgdWludDI1NiB2YWx1ZXMxLCB1aW50MjU2IHZhbHVlczIsIHVpbnQyNTYgblRvdGFsQmV0VmFsdWUsIHVpbnQyNTYgblRvdGFsQmV0Q291bnQpIA0KICAgIHsgDQogICAgICBHYW1lSW5mbyBtZW1vcnkgZyA9IGdhbWJsZXNbdWludDI1NihnYW1ibGVJbmRleCldOw0KICAgICAgDQogICAgICBpZiAoZy53aGVlbFJlc3VsdCA9PSAzNyAmJiBibG9jay5udW1iZXIgPiBnLmJsb2NrTnVtYmVyICsgQmxvY2tEZWxheSkNCiAgICAgIHsNCiAgICAgICAgIGdhbWJsZXNbZ2FtYmxlSW5kZXhdLndoZWVsUmVzdWx0ID0gZ2V0UmFuZG9tTnVtYmVyKGcucGxheWVyLCBnLmJsb2NrTnVtYmVyKTsNCiAgICAgICAgIHJldHVybiBnZXRHYW1lKGdhbWJsZUluZGV4KTsNCiAgICAgIH0NCiAgICAgIHRocm93OyAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldEdhbWVSZXN1bHQodWludDY0IGluZGV4KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxXaW4pIA0KICAgIHsNCiAgICAgICAgR2FtZUluZm8gbWVtb3J5IGdhbWUgPSBnYW1ibGVzW2luZGV4XTsNCiAgICAgICAgdG90YWxXaW4gPSAwOw0KICAgICAgICB1aW50OCBuUGxheWVyQmV0Tm8gPSAwOw0KICAgICAgICAvLyB3ZSBzZW50IGNvdW50IGJldHMgYXQgbGFzdCBieXRlIA0KICAgICAgICB1aW50OCBiZXRzQ291bnQgPSB1aW50OChieXRlczMyKGdhbWUuYmV0cylbMF0pOyANCiAgICAgICAgZm9yKHVpbnQ4IGk9MDsgaTxtYXhUeXBlQmV0czsgaSsrKQ0KICAgICAgICB7ICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGlzQml0U2V0KGdhbWUuYmV0cywgaSkpDQogICAgICAgICAgICB7ICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgdmFyIHdpbk11bCA9IHdpbk1hdHJpeC5nZXRDb2VmZihnZXRJbmRleChpLCBnYW1lLndoZWVsUmVzdWx0KSk7IC8vIGdldCB3aW4gY29lZg0KICAgICAgICAgICAgICBpZiAod2luTXVsID4gMCkgd2luTXVsKys7IC8vICsgcmV0dXJuIHBsYXllciBiZXQNCiAgICAgICAgICAgICAgdG90YWxXaW4gKz0gd2luTXVsICogZ2V0QmV0VmFsdWVCeUdhbWJsZShnYW1lLCBuUGxheWVyQmV0Tm8rMSk7DQogICAgICAgICAgICAgIG5QbGF5ZXJCZXRObysrOyANCg0KICAgICAgICAgICAgICBpZiAoYmV0c0NvdW50ID09IDEpIGJyZWFrOw0KICAgICAgICAgICAgICBiZXRzQ291bnQtLTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSAgICAgICAgDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0R2FtZSh1aW50NjQgaW5kZXgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCBnYW1ibGVJZCwgYWRkcmVzcyBwbGF5ZXIsIHVpbnQyNTYgYmxvY2tOdW1iZXIsIHVpbnQyNTYgdG90YWxXaW4sIHVpbnQ4IHdoZWVsUmVzdWx0LCB1aW50MjU2IGJldHMsIHVpbnQyNTYgdmFsdWVzMSwgdWludDI1NiB2YWx1ZXMyLCB1aW50MjU2IG5Ub3RhbEJldFZhbHVlLCB1aW50MjU2IG5Ub3RhbEJldENvdW50KSANCiAgICB7DQogICAgICAgIGdhbWJsZUlkID0gaW5kZXg7DQogICAgICAgIHBsYXllciA9IGdhbWJsZXNbaW5kZXhdLnBsYXllcjsNCiAgICAgICAgdG90YWxXaW4gPSBnZXRHYW1lUmVzdWx0KGluZGV4KTsNCiAgICAgICAgYmxvY2tOdW1iZXIgPSBnYW1ibGVzW2luZGV4XS5ibG9ja051bWJlcjsgICAgICAgIA0KICAgICAgICB3aGVlbFJlc3VsdCA9IGdhbWJsZXNbaW5kZXhdLndoZWVsUmVzdWx0Ow0KICAgICAgICBuVG90YWxCZXRWYWx1ZSA9IHRvdGFsQmV0VmFsdWUoZ2FtYmxlc1tpbmRleF0pOw0KICAgICAgICBuVG90YWxCZXRDb3VudCA9IHRvdGFsQmV0Q291bnQoZ2FtYmxlc1tpbmRleF0pOw0KICAgICAgICBiZXRzID0gZ2FtYmxlc1tpbmRleF0uYmV0czsNCiAgICAgICAgdmFsdWVzMSA9IHVpbnQyNTYoZ2FtYmxlc1tpbmRleF0udmFsdWVzKTsNCiAgICAgICAgdmFsdWVzMiA9IHVpbnQyNTYoZ2FtYmxlc1tpbmRleF0udmFsdWVzMik7ICAgICAgICANCiAgICB9DQoNCiAgIGZ1bmN0aW9uKCkgDQogICB7DQogICAgICB0aHJvdzsNCiAgIH0NCiAgIA0KDQp9'