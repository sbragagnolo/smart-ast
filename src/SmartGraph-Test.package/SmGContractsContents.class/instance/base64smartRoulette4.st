base 64 content
base64smartRoulette4
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBXaW5NYXRyaXgNCiB7DQogICBmdW5jdGlvbiBnZXRDb2VmZih1aW50MTYgbikgZXh0ZXJuYWwgcmV0dXJucyAodWludDI1Nik7DQogICBmdW5jdGlvbiBnZXRCZXRzUHJvY2Vzc2VkKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDE2KTsNCiB9DQoNCmNvbnRyYWN0IFNtYXJ0Um91bGV0dGUNCnsNCiAgICBhZGRyZXNzIGRldmVsb3BlcjsNCiAgICBhZGRyZXNzIG9wZXJhdG9yOw0KDQogICAgLy8gV2FpdCBCbG9ja0RlbGF5IGJsb2NrcyBiZWZvcmUgc3BpbiB0aGUgd2hlZWwgDQogICAgdWludDggQmxvY2tEZWxheTsNCg0KICAgIC8vIE1heGltdW0gYmV0IHZhbHVlIGZvciBnYW1lDQogICAgdWludDI1NiBjdXJyZW50TWF4QmV0OyAgICANCg0KICAgIC8vIG1heGltdW0gZ2FtZXMgY291bnQgcGVyIGJsb2NrDQogICAgdWludDY0IG1heEJldHNQZXJCbG9jazsNCiAgICB1aW50NjQgbmJCZXRzQ3VycmVudEJsb2NrOw0KICAgIA0KICAgIC8vIEVuYWJsZVxkaXNhYmxlIHRvIHBsYWNlIG5ldyBiZXRzDQogICAgYm9vbCBDb250cmFjdFN0YXRlOw0KDQogICAgLy8gdGFibGUgd2l0aCB3aW5uZXIgY29lZmZpY2llbnRzDQogICAgV2luTWF0cml4IHdpbk1hdHJpeDsNCg0KICAgIHVpbnQxNiBjb25zdGFudCBtYXhUeXBlQmV0cyA9IDE1NzsNCg0KICAgIC8vDQogICAgdWludDI1NiBwcml2YXRlIFNtYXJ0Um91bGV0dGVMaW1pdCA9IDE7DQoNCiAgIC8vIGxhc3QgZ2FtZSBpbmRleCBmb3IgcGxheWVyICh1c2VkIGZvciBmYXN0IGFjY2VzcykNCiAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDY0KSBwcml2YXRlIGdhbWJsZUluZGV4OyAgIA0KICAgDQogICAvLyANCiAgIHVpbnQ4IGRlZmF1bHRNaW5DcmVkaXRzT25CZXQ7IA0KICAgLy8NCiAgIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQ4KSBwcml2YXRlIG1pbkNyZWRpdHNPbkJldDsNCg0KICAgc3RydWN0IEdhbWJsZQ0KICAgew0KICAgICAgICBhZGRyZXNzIHBsYXllcjsNCiAgICAgICAgdWludDI1NiBibG9ja051bWJlcjsNCiAgICAgICAgdWludDI1NiBibG9ja1NwaW5uZWQ7DQogICAgICAgIHVpbnQ4IHdoZWVsUmVzdWx0Ow0KICAgICAgICB1aW50MjU2IGJldHM7DQogICAgICAgIGJ5dGVzMzIgdmFsdWVzOw0KICAgICAgICBieXRlczMyIHZhbHVlczI7DQogICB9DQogICAgICAgDQogICBHYW1ibGVbXSBwcml2YXRlIGdhbWJsZXM7DQoNCiAgIGVudW0gQmV0VHlwZXN7bnVtYmVyMCwgbnVtYmVyMSxudW1iZXIyLG51bWJlcjMsbnVtYmVyNCxudW1iZXI1LG51bWJlcjYsbnVtYmVyNyxudW1iZXI4LG51bWJlcjksDQogICAgIG51bWJlcjEwLG51bWJlcjExLG51bWJlcjEyLG51bWJlcjEzLG51bWJlcjE0LG51bWJlcjE1LG51bWJlcjE2LG51bWJlcjE3LG51bWJlcjE4LG51bWJlcjE5LG51bWJlcjIwLG51bWJlcjIxLA0KICAgICBudW1iZXIyMixudW1iZXIyMyxudW1iZXIyNCxudW1iZXIyNSxudW1iZXIyNixudW1iZXIyNyxudW1iZXIyOCxudW1iZXIyOSxudW1iZXIzMCxudW1iZXIzMSxudW1iZXIzMixudW1iZXIzMywNCiAgICAgbnVtYmVyMzQsbnVtYmVyMzUsbnVtYmVyMzYsIHJlZCwgYmxhY2ssIG9kZCwgZXZlbiwgZG96ZW4xLGRvemVuMixkb3plbjMsIGNvbHVtbjEsY29sdW1uMixjb2x1bW4zLCBsb3csaGlnaCwNCiAgICAgcGFpcl8wMSwgcGFpcl8wMiwgcGFpcl8wMywgcGFpcl8xMiwgcGFpcl8yMywgcGFpcl8zNiwgcGFpcl8yNSwgcGFpcl8xNCwgcGFpcl80NSwgcGFpcl81NiwgcGFpcl82OSwgcGFpcl81OCwgcGFpcl80NywNCiAgICAgcGFpcl83OCwgcGFpcl84OSwgcGFpcl85MTIsIHBhaXJfODExLCBwYWlyXzcxMCwgcGFpcl8xMDExLCBwYWlyXzExMTIsIHBhaXJfMTIxNSwgcGFpcl8xNTE4LCBwYWlyXzE2MTcsIHBhaXJfMTcxOCwgcGFpcl8xNzIwLA0KICAgICBwYWlyXzE2MTksIHBhaXJfMTkyMiwgcGFpcl8yMDIzLCBwYWlyXzIxMjQsIHBhaXJfMjIyMywgcGFpcl8yMzI0LCBwYWlyXzI1MjgsIHBhaXJfMjYyOSwgcGFpcl8yNzMwLCBwYWlyXzI4MjksIHBhaXJfMjkzMCwgcGFpcl8xMTE0LA0KICAgICBwYWlyXzEwMTMsIHBhaXJfMTMxNCwgcGFpcl8xNDE1LCBwYWlyXzEzMTYsIHBhaXJfMTQxNywgcGFpcl8xODIxLCBwYWlyXzE5MjAsIHBhaXJfMjAyMSwgcGFpcl8yMjI1LCBwYWlyXzIzMjYsIHBhaXJfMjQyNywgcGFpcl8yNTI2LA0KICAgICBwYWlyXzI2MjcsIHBhaXJfMjgzMSwgcGFpcl8yOTMyLCBwYWlyXzMwMzMsIHBhaXJfMzEzMiwgcGFpcl8zMjMzLCBwYWlyXzMxMzQsIHBhaXJfMzIzNSwgcGFpcl8zMzM2LCBwYWlyXzM0MzUsIHBhaXJfMzUzNiwgY29ybmVyXzBfMV8yXzMsDQogICAgIGNvcm5lcl8xXzJfNV80LCBjb3JuZXJfMl8zXzZfNSwgY29ybmVyXzRfNV84XzcsIGNvcm5lcl81XzZfOV84LCBjb3JuZXJfN184XzExXzEwLCBjb3JuZXJfOF85XzEyXzExLCBjb3JuZXJfMTBfMTFfMTRfMTMsIGNvcm5lcl8xMV8xMl8xNV8xNCwNCiAgICAgY29ybmVyXzEzXzE0XzE3XzE2LCBjb3JuZXJfMTRfMTVfMThfMTcsIGNvcm5lcl8xNl8xN18yMF8xOSwgY29ybmVyXzE3XzE4XzIxXzIwLCBjb3JuZXJfMTlfMjBfMjNfMjIsIGNvcm5lcl8yMF8yMV8yNF8yMywgY29ybmVyXzIyXzIzXzI2XzI1LA0KICAgICBjb3JuZXJfMjNfMjRfMjdfMjYsIGNvcm5lcl8yNV8yNl8yOV8yOCwgY29ybmVyXzI2XzI3XzMwXzI5LCBjb3JuZXJfMjhfMjlfMzJfMzEsIGNvcm5lcl8yOV8zMF8zM18zMiwgY29ybmVyXzMxXzMyXzM1XzM0LCBjb3JuZXJfMzJfMzNfMzZfMzUsDQogICAgIHRocmVlXzBfMl8zLCB0aHJlZV8wXzFfMiwgdGhyZWVfMV8yXzMsIHRocmVlXzRfNV82LCB0aHJlZV83XzhfOSwgdGhyZWVfMTBfMTFfMTIsIHRocmVlXzEzXzE0XzE1LCB0aHJlZV8xNl8xN18xOCwgdGhyZWVfMTlfMjBfMjEsIHRocmVlXzIyXzIzXzI0LA0KICAgICB0aHJlZV8yNV8yNl8yNywgdGhyZWVfMjhfMjlfMzAsIHRocmVlXzMxXzMyXzMzLCB0aHJlZV8zNF8zNV8zNiwgc2l4XzFfMl8zXzRfNV82LCBzaXhfNF81XzZfN184XzksIHNpeF83XzhfOV8xMF8xMV8xMiwgc2l4XzEwXzExXzEyXzEzXzE0XzE1LA0KICAgICBzaXhfMTNfMTRfMTVfMTZfMTdfMTgsIHNpeF8xNl8xN18xOF8xOV8yMF8yMSwgc2l4XzE5XzIwXzIxXzIyXzIzXzI0LCBzaXhfMjJfMjNfMjRfMjVfMjZfMjcsIHNpeF8yNV8yNl8yN18yOF8yOV8zMCwgc2l4XzI4XzI5XzMwXzMxXzMyXzMzLA0KICAgICBzaXhfMzFfMzJfMzNfMzRfMzVfMzZ9DQogICANCg0KICAgZnVuY3Rpb24gU21hcnRSb3VsZXR0ZSgpIGludGVybmFsDQogICB7ICAgICAgICANCiAgICAgICAgZGV2ZWxvcGVyICA9IG1zZy5zZW5kZXI7DQogICAgICAgIG9wZXJhdG9yICAgPSBtc2cuc2VuZGVyOw0KICAgICAgICANCiAgICAgICAgd2luTWF0cml4ID0gV2luTWF0cml4KDB4REExNjI1MUIyOTc3Rjg2Y0I4ZDRDMzMxOGU5YzZGOTJEN2ZDMUE4Zik7DQogICAgICAgIGlmICh3aW5NYXRyaXguZ2V0QmV0c1Byb2Nlc3NlZCgpICE9IG1heFR5cGVCZXRzKSB0aHJvdzsNCg0KICAgICAgICBCbG9ja0RlbGF5ID0gMTsgICAgICAgIA0KICAgICAgICBtYXhCZXRzUGVyQmxvY2sgPSA1Ow0KICAgICAgICBkZWZhdWx0TWluQ3JlZGl0c09uQmV0ID0gMTsgICANCiAgICAgICAgQ29udHJhY3RTdGF0ZSAgPSB0cnVlOyAgDQogICB9DQoNCiAgIGZ1bmN0aW9uIHVwZGF0ZU1heEJldCgpIHByaXZhdGUgb25seURldmVsb3BlciANCiAgIHsgICAgICANCiAgICAgIHVpbnQyNTYgbmV3TWF4QmV0ID0gdGhpcy5iYWxhbmNlLygzNSpTbWFydFJvdWxldHRlTGltaXQpOw0KDQogICAgICAvLyByb3VuZHMgdG8gMiBkaWd0cw0KICAgICAgbmV3TWF4QmV0ID0gbmV3TWF4QmV0IC8gMjU2MDAwMDAwMDAwMDAwMDAwMCAqIDI1NjAwMDAwMDAwMDAwMDAwMDA7ICANCiAgICAgIGlmIChuZXdNYXhCZXQgIT0gY3VycmVudE1heEJldCkgDQogICAgICB7DQogICAgICAgIGN1cnJlbnRNYXhCZXQgPSBuZXdNYXhCZXQ7DQogICAgICAgIFNldHRpbmdzQ2hhbmdlZChjdXJyZW50TWF4QmV0LCBjdXJyZW50TWF4QmV0IC8gMjU2LCAgZGVmYXVsdE1pbkNyZWRpdHNPbkJldCwgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmxvdyldLCBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuZG96ZW4xKV0sIEJsb2NrRGVsYXksIENvbnRyYWN0U3RhdGUpOw0KICAgICAgfQ0KICAgfQ0KDQogICBmdW5jdGlvbiBjaGFuZ2VTZXR0aW5ncyh1aW50MjU2IE5ld1NtYXJ0Um91bGV0dGVMaW1pdCwgdWludDY0IE5ld01heEJldHNQZXJCbG9jaywgdWludDggTmV3QmxvY2tEZWxheSwgdWludDggTWluQ3JlZGl0c09uQmV0NTAsIHVpbnQ4IE1pbkNyZWRpdHNPbkJldDMzLCB1aW50OCBOZXdEZWZhdWx0TWluQ3JlZGl0c09uQmV0KSBvbmx5RGV2ZWxvcGVyDQogICB7DQogICAgIGlmIChOZXdTbWFydFJvdWxldHRlTGltaXQgPiAwKSBTbWFydFJvdWxldHRlTGltaXQgPSBOZXdTbWFydFJvdWxldHRlTGltaXQ7DQoNCiAgICAgQmxvY2tEZWxheSA9IE5ld0Jsb2NrRGVsYXk7ICAgICANCg0KICAgICBpZiAoTmV3TWF4QmV0c1BlckJsb2NrICE9IDApIG1heEJldHNQZXJCbG9jayA9IE5ld01heEJldHNQZXJCbG9jazsgICAgIA0KDQogICAgICBpZiAoTWluQ3JlZGl0c09uQmV0NTAgPiAwKQ0KICAgICAgew0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMubG93KV0gPSBNaW5DcmVkaXRzT25CZXQ1MDsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmhpZ2gpXSA9IE1pbkNyZWRpdHNPbkJldDUwOw0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMucmVkKV0gPSBNaW5DcmVkaXRzT25CZXQ1MDsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmJsYWNrKV0gPSBNaW5DcmVkaXRzT25CZXQ1MDsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLm9kZCldID0gTWluQ3JlZGl0c09uQmV0NTA7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5ldmVuKV0gPSBNaW5DcmVkaXRzT25CZXQ1MDsNCiAgICAgIH0gIA0KDQogICAgICBpZiAoTWluQ3JlZGl0c09uQmV0MzMgPiAwKQ0KICAgICAgew0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuZG96ZW4xKV0gPSBNaW5DcmVkaXRzT25CZXQzMzsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmRvemVuMildID0gTWluQ3JlZGl0c09uQmV0MzM7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5kb3plbjMpXSA9IE1pbkNyZWRpdHNPbkJldDMzOw0KICAgICAgICBtaW5DcmVkaXRzT25CZXRbdWludDgoQmV0VHlwZXMuY29sdW1uMSldID0gTWluQ3JlZGl0c09uQmV0MzM7DQogICAgICAgIG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5jb2x1bW4yKV0gPSBNaW5DcmVkaXRzT25CZXQzMzsNCiAgICAgICAgbWluQ3JlZGl0c09uQmV0W3VpbnQ4KEJldFR5cGVzLmNvbHVtbjMpXSA9IE1pbkNyZWRpdHNPbkJldDMzOw0KICAgICAgfQ0KDQogICAgICBpZiAoTmV3RGVmYXVsdE1pbkNyZWRpdHNPbkJldCA+IDApIGRlZmF1bHRNaW5DcmVkaXRzT25CZXQgPSBOZXdEZWZhdWx0TWluQ3JlZGl0c09uQmV0Ow0KDQogICAgIHVwZGF0ZU1heEJldCgpOw0KICAgfQ0KICAgDQogICBmdW5jdGlvbiBkZWxldGVDb250cmFjdCgpIG9ubHlEZXZlbG9wZXIgIA0KICAgew0KICAgICAgICBzdWljaWRlKG1zZy5zZW5kZXIpOw0KICAgfQ0KDQogICAvLyBiaXQgZnJvbSAwIHRvIDI1NQ0KICAgZnVuY3Rpb24gaXNCaXRTZXQodWludDI1NiBkYXRhLCB1aW50OCBiaXQpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoYm9vbCByZXQpDQogICB7DQogICAgICAgYXNzZW1ibHkgew0KICAgICAgICAgICAgcmV0IDo9IGlzemVybyhpc3plcm8oYW5kKGRhdGEsIGV4cCgyLGJpdCkpKSkNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gcmV0Ow0KICAgfQ0KDQogICAvLyB1bmlxdWUgY29tYmluYXRpb24gb2YgYmV0IGFuZCB3aGVlbFJlc3VsdCwgdXNlZCBmb3IgYWNjZXNzIHRvIFdpbk1hdHJpeA0KICAgZnVuY3Rpb24gZ2V0SW5kZXgodWludDE2IGJldCwgdWludDE2IHdoZWVsUmVzdWx0KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQxNikNCiAgIHsNCiAgICAgIHJldHVybiAoYmV0KzEpKjI1NiArICh3aGVlbFJlc3VsdCsxKTsNCiAgIH0NCg0KICAgLy8gbiBmb3JtIDEgPD0gdG8gPD0gMzINCiAgIGZ1bmN0aW9uIGdldEJldFZhbHVlKGJ5dGVzMzIgdmFsdWVzLCB1aW50OCBuKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpDQogICB7DQogICAgICAgIC8vIGJldCBpbiBjcmVkaXRzICgxLi4yNTYpIA0KICAgICAgICB1aW50MjU2IGJldCA9IHVpbnQyNTYodmFsdWVzWzMyLW5dKSsxOw0KDQogICAgICAgICAvLyBjaGVjayBtaW4gYmV0DQogICAgICAgIHVpbnQ4IG1pbkNyZWRpdHMgPSBtaW5DcmVkaXRzT25CZXRbbl07DQogICAgICAgIGlmIChtaW5DcmVkaXRzID09IDApIG1pbkNyZWRpdHMgPSBkZWZhdWx0TWluQ3JlZGl0c09uQmV0Ow0KICAgICAgICBpZiAoYmV0IDwgbWluQ3JlZGl0cykgdGhyb3c7DQogICAgICAgIA0KICAgICAgICAvLyBiZXQgaW4gd2VpDQogICAgICAgIGJldCA9IGN1cnJlbnRNYXhCZXQqYmV0LzI1NjsNCiAgICAgICAgaWYgKGJldCA+IGN1cnJlbnRNYXhCZXQpIHRocm93OyAgICAgICAgIA0KDQogICAgICAgIHJldHVybiBiZXQ7ICAgICAgICANCiAgIH0NCg0KICAgZnVuY3Rpb24gZ2V0QmV0VmFsdWVCeUdhbWJsZShHYW1ibGUgZ2FtYmxlLCB1aW50OCBuKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIA0KICAgew0KICAgICAgaWYgKG48PTMyKSByZXR1cm4gZ2V0QmV0VmFsdWUoZ2FtYmxlLnZhbHVlcywgbik7DQogICAgICBpZiAobjw9NjQpIHJldHVybiBnZXRCZXRWYWx1ZShnYW1ibGUudmFsdWVzMiwgbi0zMik7DQogICAgICAvLyB0aGVyZSBhcmUgNjQgbWF4aW11bSB1bmlxdWUgYmV0cyAocG9zaXRpb25zKSBpbiBvbmUgZ2FtZQ0KICAgICAgdGhyb3c7DQogICB9DQogIA0KICAgZnVuY3Rpb24gdG90YWxHYW1lcygpIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpDQogICB7DQogICAgICAgcmV0dXJuIGdhbWJsZXMubGVuZ3RoOw0KICAgfQ0KICAgDQogICBmdW5jdGlvbiBnZXRTZXR0aW5ncygpIGNvbnN0YW50IHJldHVybnModWludDI1NiBtYXhCZXQsIHVpbnQyNTYgb25lQ3JlZGl0LCB1aW50OCBNaW5CZXRJbkNyZWRpdHMsIHVpbnQ4IE1pbkJldEluQ3JlZGl0c181MCx1aW50OCBNaW5CZXRJbkNyZWRpdHNfMzMsIHVpbnQ4IGJsb2NrRGVsYXlCZWZvcmVTcGluLCBib29sIGNvbnRyYWN0U3RhdGUpDQogICAgew0KICAgICAgICBtYXhCZXQ9Y3VycmVudE1heEJldDsNCiAgICAgICAgb25lQ3JlZGl0PWN1cnJlbnRNYXhCZXQgLyAyNTY7IA0KICAgICAgICBibG9ja0RlbGF5QmVmb3JlU3Bpbj1CbG9ja0RlbGF5OyAgICAgICAgDQogICAgICAgIE1pbkJldEluQ3JlZGl0cyA9IGRlZmF1bHRNaW5DcmVkaXRzT25CZXQ7DQogICAgICAgIE1pbkJldEluQ3JlZGl0c181MCA9IG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5sb3cpXTsgDQogICAgICAgIE1pbkJldEluQ3JlZGl0c18zMyA9IG1pbkNyZWRpdHNPbkJldFt1aW50OChCZXRUeXBlcy5jb2x1bW4xKV07IA0KICAgICAgICBjb250cmFjdFN0YXRlID0gQ29udHJhY3RTdGF0ZTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgIA0KICAgIG1vZGlmaWVyIG9ubHlEZXZlbG9wZXIoKSANCiAgICB7DQogICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVyKSB0aHJvdzsNCiAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yKCkgDQogICAgew0KICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGRldmVsb3BlciAmJiBtc2cuc2VuZGVyICE9IG9wZXJhdG9yKSB0aHJvdzsNCiAgICAgICBfOw0KICAgIH0NCg0KICAgZnVuY3Rpb24gZGlzYWJsZUJldHRpbmdfb25seV9EZXYoKQ0KICAgIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yDQogICAgew0KICAgICAgICBDb250cmFjdFN0YXRlPWZhbHNlOw0KICAgIH0NCg0KDQogICAgZnVuY3Rpb24gY2hhbmdlT3BlcmF0b3IoYWRkcmVzcyBuZXdPcGVyYXRvcikgb25seURldmVsb3Blcg0KICAgIHsNCiAgICAgICBvcGVyYXRvciA9IG5ld09wZXJhdG9yOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGVuYWJsZUJldHRpbmdfb25seV9EZXYoKQ0KICAgIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yDQogICAgew0KICAgICAgICBDb250cmFjdFN0YXRlPXRydWU7DQoNCiAgICB9DQoNCiAgICBldmVudCBQbGF5ZXJCZXQoYWRkcmVzcyBwbGF5ZXIsIHVpbnQyNTYgYmxvY2ssIHVpbnQyNTYgZ2FtYmxlSWQpOw0KICAgIGV2ZW50IEVuZEdhbWUoYWRkcmVzcyBwbGF5ZXIsIHVpbnQ4IHJlc3VsdCwgdWludDI1NiBnYW1ibGVJZCk7DQogICAgZXZlbnQgU2V0dGluZ3NDaGFuZ2VkKHVpbnQyNTYgbWF4QmV0LCB1aW50MjU2IG9uZUNyZWRpdCwgdWludDggRGVmYXVsdE1pbkJldEluQ3JlZGl0cywgdWludDggTWluQmV0SW5DcmVkaXRzNTAsIHVpbnQ4IE1pbkJldEluQ3JlZGl0czMzLCB1aW50OCBibG9ja0RlbGF5QmVmb3JlU3BpbiwgYm9vbCBjb250cmFjdFN0YXRlKTsNCiAgICBldmVudCBFcnJvckxvZyhhZGRyZXNzIHBsYXllciwgc3RyaW5nIG1lc3NhZ2UpOw0KDQogICBmdW5jdGlvbiB0b3RhbEJldFZhbHVlKEdhbWJsZSBnKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpDQogICB7ICAgICAgICAgICAgICANCiAgICAgICB1aW50MjU2IHRvdGFsQmV0c1ZhbHVlID0gMDsgDQogICAgICAgdWludDggblBsYXllckJldE5vID0gMDsNCiAgICAgICBmb3IodWludDggaT0wOyBpIDwgbWF4VHlwZUJldHM7aSsrKSANCiAgICAgICAgaWYgKGlzQml0U2V0KGcuYmV0cywgaSkpDQogICAgICAgIHsNCiAgICAgICAgICB0b3RhbEJldHNWYWx1ZSArPSBnZXRCZXRWYWx1ZUJ5R2FtYmxlKGcsIG5QbGF5ZXJCZXRObysxKTsNCiAgICAgICAgICBuUGxheWVyQmV0Tm8rKzsNCiAgICAgICAgfQ0KDQogICAgICAgcmV0dXJuIHRvdGFsQmV0c1ZhbHVlOw0KICAgfQ0KDQogICBmdW5jdGlvbiB0b3RhbEJldENvdW50KEdhbWJsZSBnKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpDQogICB7ICAgICAgICAgICAgICANCiAgICAgICB1aW50MjU2IHRvdGFsQmV0cyA9IDA7IA0KICAgICAgIGZvcih1aW50OCBpPTA7IGkgPCBtYXhUeXBlQmV0cztpKyspIA0KICAgICAgICBpZiAoaXNCaXRTZXQoZy5iZXRzLCBpKSkgdG90YWxCZXRzKys7ICAgICAgICAgIA0KICAgICAgIHJldHVybiB0b3RhbEJldHM7ICAgDQogICB9DQoNCiAgIGZ1bmN0aW9uIHBsYWNlQmV0KHVpbnQyNTYgYmV0cywgYnl0ZXMzMiB2YWx1ZXMxLGJ5dGVzMzIgdmFsdWVzMikgIHBheWFibGUNCiAgIHsNCiAgICAgICBpZiAoQ29udHJhY3RTdGF0ZSA9PSBmYWxzZSkNCiAgICAgICB7DQogICAgICAgICBFcnJvckxvZyhtc2cuc2VuZGVyLCAiQ29udHJhY3REaXNhYmxlZCIpOw0KICAgICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpID09IGZhbHNlKSB0aHJvdzsNCiAgICAgICAgIHJldHVybjsNCiAgICAgICB9IA0KDQogICAgICAgaWYgKG5iQmV0c0N1cnJlbnRCbG9jayA+PSBtYXhCZXRzUGVyQmxvY2spIA0KICAgICAgIHsNCiAgICAgICAgIEVycm9yTG9nKG1zZy5zZW5kZXIsICJjaGVja05iQmV0c0N1cnJlbnRCbG9jayIpOw0KICAgICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpID09IGZhbHNlKSB0aHJvdzsNCiAgICAgICAgIHJldHVybjsNCiAgICAgICB9DQoNCiAgICAgICBpZiAobXNnLnZhbHVlIDwgY3VycmVudE1heEJldC8yNTYgfHwgYmV0cyA9PSAwKQ0KICAgICAgIHsNCiAgICAgICAgICBFcnJvckxvZyhtc2cuc2VuZGVyLCAiV3JvbmcgYmV0IHZhbHVlIik7DQogICAgICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpID09IGZhbHNlKSB0aHJvdzsNCiAgICAgICAgICByZXR1cm47DQogICAgICAgfQ0KDQogICAgICAgaWYgKG1zZy52YWx1ZSA+IGN1cnJlbnRNYXhCZXQpDQogICAgICAgew0KICAgICAgICAgIEVycm9yTG9nKG1zZy5zZW5kZXIsICJMaW1pdCBmb3IgdGFibGUiKTsNCiAgICAgICAgICBpZiAobXNnLnNlbmRlci5zZW5kKG1zZy52YWx1ZSkgPT0gZmFsc2UpIHRocm93Ow0KICAgICAgICAgIHJldHVybjsNCiAgICAgICB9DQoNCiAgICAgICBHYW1ibGUgbWVtb3J5IGcgPSBHYW1ibGUobXNnLnNlbmRlciwgYmxvY2subnVtYmVyLCAwLCAzNywgYmV0cywgdmFsdWVzMSx2YWx1ZXMyKTsNCg0KICAgICAgIGlmICh0b3RhbEJldFZhbHVlKGcpICE9IG1zZy52YWx1ZSkNCiAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIldyb25nIGJldCB2YWx1ZSIpOw0KICAgICAgICAgIGlmIChtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlKSA9PSBmYWxzZSkgdGhyb3c7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgIH0gICAgICAgDQoNCiAgICAgICB1aW50NjQgaW5kZXggPSBnYW1ibGVJbmRleFttc2cuc2VuZGVyXTsNCiAgICAgICBpZiAoaW5kZXggIT0gMCkNCiAgICAgICB7DQogICAgICAgICAgaWYgKGdhbWJsZXNbaW5kZXgtMV0ud2hlZWxSZXN1bHQgPT0gMzcpIA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIEVycm9yTG9nKG1zZy5zZW5kZXIsICJwcmV2aW91cyBnYW1lIGlzIG5vdCBmaW5pc2hlZCIpOw0KICAgICAgICAgICAgaWYgKG1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpID09IGZhbHNlKSB0aHJvdzsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9DQogICAgICAgfQ0KDQogICAgICAgaWYgKGdhbWJsZXMubGVuZ3RoICE9IDAgJiYgYmxvY2subnVtYmVyPT1nYW1ibGVzW2dhbWJsZXMubGVuZ3RoLTFdLmJsb2NrTnVtYmVyKSANCiAgICAgICAgbmJCZXRzQ3VycmVudEJsb2NrKys7DQogICAgICAgZWxzZSANCiAgICAgICAgbmJCZXRzQ3VycmVudEJsb2NrID0gMDsNCg0KICAgICAgIC8vIGdhbWJsZUluZGV4IGlzIGluZGV4IG9mIGdhbWJsZXMgYXJyYXkgKyAxDQogICAgICAgZ2FtYmxlSW5kZXhbbXNnLnNlbmRlcl0gPSB1aW50NjQoZ2FtYmxlcy5sZW5ndGggKyAxKTsNCg0KICAgICAgIGdhbWJsZXMucHVzaChnKTsNCiAgICAgICAgICAgIA0KICAgICAgIFBsYXllckJldChtc2cuc2VuZGVyLCBibG9jay5udW1iZXIsIGdhbWJsZXMubGVuZ3RoIC0gMSk7DQogICB9DQoNCiAgICBmdW5jdGlvbiBJbnZlc3QoKSBwYXlhYmxlDQogICAgew0KICAgICAgdXBkYXRlTWF4QmV0KCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gU3BpblRoZVdoZWVsKGFkZHJlc3MgcGxheWVyU3Bpbm5lZCkgDQogICAgew0KICAgICAgICBpZiAocGxheWVyU3Bpbm5lZD09MCl7DQogICAgICAgICAgIHBsYXllclNwaW5uZWQ9bXNnLnNlbmRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIHVpbnQ2NCBpbmRleCA9IGdhbWJsZUluZGV4W3BsYXllclNwaW5uZWRdOw0KICAgICAgICBpZiAoaW5kZXggPT0gMCkgDQogICAgICAgIHsNCiAgICAgICAgICBFcnJvckxvZyhwbGF5ZXJTcGlubmVkLCAiTm8gZ2FtZXMgZm9yIHBsYXllciIpOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpbmRleC0tOyAgICAgICAgDQoNCiAgICAgICAgaWYgKGdhbWJsZXNbaW5kZXhdLndoZWVsUmVzdWx0ICE9IDM3KQ0KICAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cocGxheWVyU3Bpbm5lZCwgIkdhbWJsZSBhbHJlYWR5IHNwaW5uZWQiKTsNCiAgICAgICAgICByZXR1cm47DQogICAgICAgIH0gDQoNCiAgICAgICAgdWludDI1NiBwbGF5ZXJibG9jayA9IGdhbWJsZXNbaW5kZXhdLmJsb2NrTnVtYmVyOw0KICAgICAgICANCiAgICAgICAgaWYgKGJsb2NrLm51bWJlciA8PSBwbGF5ZXJibG9jayArIEJsb2NrRGVsYXkpIA0KICAgICAgICB7DQogICAgICAgICAgRXJyb3JMb2cobXNnLnNlbmRlciwgIldhaXQgZm9yIHBsYXllcmJsb2NrK2Jsb2NrRGVsYXkiKTsNCiAgICAgICAgICByZXR1cm47ICAgICAgICAgIA0KICAgICAgICB9DQoNCiAgICAgICAgZ2FtYmxlc1tpbmRleF0ud2hlZWxSZXN1bHQgPSBnZXRSYW5kb21OdW1iZXIoZ2FtYmxlc1tpbmRleF0ucGxheWVyLCBwbGF5ZXJibG9jayk7DQogICAgICAgIGdhbWJsZXNbaW5kZXhdLmJsb2NrU3Bpbm5lZCA9IGJsb2NrLm51bWJlcjsNCiAgICAgICAgDQogICAgICAgIGlmIChnYW1ibGVzW2luZGV4XS5wbGF5ZXIuc2VuZChnZXRHYW1lUmVzdWx0KGluZGV4KSkgPT0gZmFsc2UpIHRocm93Ow0KDQogICAgICAgIEVuZEdhbWUoZ2FtYmxlc1tpbmRleF0ucGxheWVyLCBnYW1ibGVzW2luZGV4XS53aGVlbFJlc3VsdCwgaW5kZXgpOyAgICAgICAgDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0UmFuZG9tTnVtYmVyKGFkZHJlc3MgcGxheWVyLCB1aW50MjU2IHBsYXllcmJsb2NrKSBwcml2YXRlIHJldHVybnModWludDggd2hlZWxSZXN1bHQpDQogICAgew0KICAgICAgICAvLyBibG9jay5ibG9ja2hhc2ggLSBoYXNoIG9mIHRoZSBnaXZlbiBibG9jayAtIG9ubHkgd29ya3MgZm9yIDI1NiBtb3N0IHJlY2VudCBibG9ja3MgZXhjbHVkaW5nIGN1cnJlbnQNCiAgICAgICAgYnl0ZXMzMiBibG9ja0hhc2ggPSBibG9jay5ibG9ja2hhc2gocGxheWVyYmxvY2srQmxvY2tEZWxheSk7IA0KICAgICAgICANCiAgICAgICAgaWYgKGJsb2NrSGFzaD09MCkgDQogICAgICAgIHsNCiAgICAgICAgICBFcnJvckxvZyhtc2cuc2VuZGVyLCAiQ2Fubm90IGdlbmVyYXRlIHJhbmRvbSBudW1iZXIiKTsNCiAgICAgICAgICB3aGVlbFJlc3VsdCA9IDIwMDsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICBieXRlczMyIHNoYVBsYXllciA9IHNoYTMocGxheWVyLCBibG9ja0hhc2gpOw0KICAgIA0KICAgICAgICAgIHdoZWVsUmVzdWx0ID0gdWludDgodWludDI1NihzaGFQbGF5ZXIpJTM3KTsNCiAgICAgICAgfSAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVSYW5kb21OdW1iZXJCeUJsb2NraGFzaCh1aW50MjU2IGJsb2NrSGFzaCwgYWRkcmVzcyBwbGF5ZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCB3aGVlbFJlc3VsdCkgDQogICAgeyANCiAgICAgICAgICBieXRlczMyIHNoYVBsYXllciA9IHNoYTMocGxheWVyLCBibG9ja0hhc2gpOw0KICAgIA0KICAgICAgICAgIHdoZWVsUmVzdWx0ID0gdWludDgodWludDI1NihzaGFQbGF5ZXIpJTM3KTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBlbWVyZ2VuY3lGaXhHYW1lUmVzdWx0KHVpbnQ2NCBnYW1ibGVJZCwgdWludDI1NiBibG9ja0hhc2gpIG9ubHlEZXZlbG9wZXJPck9wZXJhdG9yDQogICAgew0KICAgICAgLy8gUHJvYmFibHkgdGhpcyBmdW5jdGlvbiB3aWxsIG5ldmVyIGJlIGNhbGxlZCwgYnV0DQogICAgICAvLyBpZiBnYW1lIHdhcyBub3Qgc3Bpbm5lZCBpbiAyNTYgYmxvY2tzIHRoZW4gYmxvY2suYmxvY2toYXNoIHdpbGwgcmV0dXJucyBhbHdheXMgMCBhbmQgDQogICAgICAvLyB3ZSBzaG91bGQgZml4IHRoaXMgbWFudWFsbHkgKHlvdSBjYW4gY2hlY2sgcmVzdWx0IHdpdGggcHVibGljIGZ1bmN0aW9uIGNhbGN1bGF0ZVJhbmRvbU51bWJlckJ5QmxvY2toYXNoKQ0KICAgICAgR2FtYmxlIG1lbW9yeSBnYW1ibGUgPSBnYW1ibGVzW2dhbWJsZUlkXTsNCiAgICAgIGlmIChnYW1ibGUud2hlZWxSZXN1bHQgIT0gMjAwKSB0aHJvdzsNCg0KICAgICAgZ2FtYmxlc1tnYW1ibGVJZF0ud2hlZWxSZXN1bHQgPSBjYWxjdWxhdGVSYW5kb21OdW1iZXJCeUJsb2NraGFzaChibG9ja0hhc2gsIGdhbWJsZS5wbGF5ZXIpOw0KICAgICAgZ2FtYmxlc1tnYW1ibGVJZF0uYmxvY2tTcGlubmVkID0gYmxvY2subnVtYmVyOw0KDQogICAgICBpZiAoZ2FtYmxlLnBsYXllci5zZW5kKGdldEdhbWVSZXN1bHQoZ2FtYmxlSWQpKSA9PSBmYWxzZSkgdGhyb3c7DQoNCiAgICAgIEVuZEdhbWUoZ2FtYmxlLnBsYXllciwgZ2FtYmxlLndoZWVsUmVzdWx0LCBnYW1ibGVJZCk7DQogICAgfQ0KDQogICAgLy8gDQogICAgZnVuY3Rpb24gY2hlY2tHYW1lUmVzdWx0KGFkZHJlc3MgcGxheWVyU3Bpbm5lZCkgY29uc3RhbnQgcmV0dXJucyAodWludDY0IGdhbWJsZUlkLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBibG9ja051bWJlciwgdWludDI1NiBibG9ja1NwaW5uZWQsIHVpbnQyNTYgdG90YWxXaW4sIHVpbnQ4IHdoZWVsUmVzdWx0LCB1aW50MjU2IGJldHMsIHVpbnQyNTYgdmFsdWVzMSwgdWludDI1NiB2YWx1ZXMyLCB1aW50MjU2IG5Ub3RhbEJldFZhbHVlLCB1aW50MjU2IG5Ub3RhbEJldENvdW50KSANCiAgICB7DQogICAgICAgIGlmIChwbGF5ZXJTcGlubmVkPT0wKXsNCiAgICAgICAgICAgcGxheWVyU3Bpbm5lZD1tc2cuc2VuZGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgdWludDY0IGluZGV4ID0gZ2FtYmxlSW5kZXhbcGxheWVyU3Bpbm5lZF07DQogICAgICAgIGlmIChpbmRleCA9PSAwKSB0aHJvdzsNCiAgICAgICAgaW5kZXgtLTsgICAgICAgIA0KDQogICAgICAgIHVpbnQyNTYgcGxheWVyYmxvY2sgPSBnYW1ibGVzW2luZGV4XS5ibG9ja051bWJlcjsgICAgICAgIA0KICAgICAgICBpZiAoYmxvY2subnVtYmVyIDw9IHBsYXllcmJsb2NrICsgQmxvY2tEZWxheSkgdGhyb3c7DQogICAgICAgIA0KICAgICAgICBnYW1ibGVzW2luZGV4XS53aGVlbFJlc3VsdCA9IGdldFJhbmRvbU51bWJlcihnYW1ibGVzW2luZGV4XS5wbGF5ZXIsIHBsYXllcmJsb2NrKTsNCiAgICAgICAgZ2FtYmxlc1tpbmRleF0uYmxvY2tTcGlubmVkID0gYmxvY2subnVtYmVyOw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIGdldEdhbWUoaW5kZXgpOyAgICAgIA0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldEdhbWVSZXN1bHQodWludDY0IGluZGV4KSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxXaW4pIA0KICAgIHsNCiAgICAgICAgR2FtYmxlIG1lbW9yeSBnYW1lID0gZ2FtYmxlc1tpbmRleF07DQogICAgICAgIHRvdGFsV2luID0gMDsNCiAgICAgICAgdWludDggblBsYXllckJldE5vID0gMDsNCiAgICAgICAgZm9yKHVpbnQ4IGk9MDsgaTxtYXhUeXBlQmV0czsgaSsrKQ0KICAgICAgICB7ICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGlzQml0U2V0KGdhbWUuYmV0cywgaSkpDQogICAgICAgICAgICB7ICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgdmFyIHdpbk11bCA9IHdpbk1hdHJpeC5nZXRDb2VmZihnZXRJbmRleChpLCBnYW1lLndoZWVsUmVzdWx0KSk7IC8vIGdldCB3aW4gY29lZg0KICAgICAgICAgICAgICBpZiAod2luTXVsID4gMCkgd2luTXVsKys7IC8vICsgcmV0dXJuIHBsYXllciBiZXQNCiAgICAgICAgICAgICAgdG90YWxXaW4gKz0gd2luTXVsICogZ2V0QmV0VmFsdWVCeUdhbWJsZShnYW1lLCBuUGxheWVyQmV0Tm8rMSk7DQogICAgICAgICAgICAgIG5QbGF5ZXJCZXRObysrOyANCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAodG90YWxXaW4gPT0gMCkgdG90YWxXaW4gPSAxIHdlaTsgLy8gMSB3ZWkgaWYgbG9zZSAgICAgICAgICAgICAgICAgICAgICANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRHYW1lKHVpbnQ2NCBpbmRleCkgY29uc3RhbnQgcmV0dXJucyAodWludDY0IGdhbWJsZUlkLCBhZGRyZXNzIHBsYXllciwgdWludDI1NiBibG9ja051bWJlciwgdWludDI1NiBibG9ja1NwaW5uZWQsIHVpbnQyNTYgdG90YWxXaW4sIHVpbnQ4IHdoZWVsUmVzdWx0LCB1aW50MjU2IGJldHMsIHVpbnQyNTYgdmFsdWVzMSwgdWludDI1NiB2YWx1ZXMyLCB1aW50MjU2IG5Ub3RhbEJldFZhbHVlLCB1aW50MjU2IG5Ub3RhbEJldENvdW50KSANCiAgICB7DQogICAgICAgIGdhbWJsZUlkID0gaW5kZXg7DQogICAgICAgIHBsYXllciA9IGdhbWJsZXNbaW5kZXhdLnBsYXllcjsNCiAgICAgICAgdG90YWxXaW4gPSBnZXRHYW1lUmVzdWx0KGluZGV4KTsNCiAgICAgICAgYmxvY2tOdW1iZXIgPSBnYW1ibGVzW2luZGV4XS5ibG9ja051bWJlcjsNCiAgICAgICAgYmxvY2tTcGlubmVkID0gZ2FtYmxlc1tpbmRleF0uYmxvY2tTcGlubmVkOw0KICAgICAgICB3aGVlbFJlc3VsdCA9IGdhbWJsZXNbaW5kZXhdLndoZWVsUmVzdWx0Ow0KICAgICAgICBuVG90YWxCZXRWYWx1ZSA9IHRvdGFsQmV0VmFsdWUoZ2FtYmxlc1tpbmRleF0pOw0KICAgICAgICBuVG90YWxCZXRDb3VudCA9IHRvdGFsQmV0Q291bnQoZ2FtYmxlc1tpbmRleF0pOw0KICAgICAgICBiZXRzID0gZ2FtYmxlc1tpbmRleF0uYmV0czsNCiAgICAgICAgdmFsdWVzMSA9IHVpbnQyNTYoZ2FtYmxlc1tpbmRleF0udmFsdWVzKTsNCiAgICAgICAgdmFsdWVzMiA9IHVpbnQyNTYoZ2FtYmxlc1tpbmRleF0udmFsdWVzMik7ICAgICAgICANCiAgICB9DQoNCiAgIGZ1bmN0aW9uKCkgDQogICB7DQogICAgICB0aHJvdzsNCiAgIH0NCiAgIA0KDQp9'