base 64 content
base64smartRouletteToken2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC44Ow0KDQpjb250cmFjdCBTbWFydFJvdWxldHRlVG9rZW4gew0KCS8vVG9rZW5zIGRhdGENCglzdHJpbmcgcHVibGljIHN0YW5kYXJkID0gJ0VSQzIwJzsNCiAgICBzdHJpbmcgcHVibGljIG5hbWU7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7DQogICAgdWludDggcHVibGljIGRlY2ltYWxzOw0KDQoJc3RydWN0IGhvbGRlckRhdGEgew0KCQl1aW50MjU2IHRva2Vuc19jb3VudDsNCgkJYm9vbCBpbml0Ow0KCX0NCg0KCXN0cnVjdCB0ZW1wSG9sZGVyRGF0YSB7DQoJCXVpbnQyNTYgdG9rZW5zX2NvdW50Ow0KCQl1aW50MjU2IHN0YXJ0X2RhdGU7DQoJCXVpbnQyNTYgZW5kX2RhdGU7DQoJfQ0KDQoJYWRkcmVzc1tdIGxpc3RBZGRySG9sZGVyczsNCg0KCW1hcHBpbmcoIGFkZHJlc3MgPT4gaG9sZGVyRGF0YSApIF9iYWxhbmNlczsNCgltYXBwaW5nKCBhZGRyZXNzID0+IHRlbXBIb2xkZXJEYXRhICkgX3RlbXBfYmFsYW5jZTsNCgltYXBwaW5nKCBhZGRyZXNzID0+IG1hcHBpbmcoIGFkZHJlc3MgPT4gdWludDI1NiApICkgX2FwcHJvdmFsczsNCg0KCWJvb2wgc3RvcF9vcGVyYXRpb247DQoJDQoJdWludDI1NiBfc3VwcGx5Ow0KCXVpbnQyNTYgX2luaXRfY291bnRfdG9rZW5zOw0KCXVpbnQyNTYgcHVibGljIGNvc3RPZk9uZVRva2VuOyAvL3RoZSBjb3N0IG9mIG9uZSB0b2tlbiBpbiB3ZWkNCgkNCglhZGRyZXNzIHdhbGxldF9JQ087DQoJYm9vbCBlbmFibGVJQ087DQoJdWludDI1NiBtaW5fdmFsdWVfYnV5VG9rZW47IC8vaW4gd2VpDQoJdWludDI1NiBtYXhfdmFsdWVfYnV5VG9rZW47IC8vaW4gd2VpDQoNCglhZGRyZXNzIGZvbmRfd2FsbGV0Ow0KCWFkZHJlc3MgZGV2ZWxvcGVyX3dhbGxldDsNCg0KCWFkZHJlc3MgZGl2aWRlbnRfY29udHJhY3QgPSBhZGRyZXNzKDB4MCk7DQoJDQoJZXZlbnQgVG9rZW5CdXkoYWRkcmVzcyBidXllciwgdWludDI1NiBhbW91bnRPZlRva2Vucyk7DQoNCiAgICAvL0NvbnRyYWN0IGRhdGENCglhZGRyZXNzIGRldmVsb3BlcjsNCglhZGRyZXNzIG1hbmFnZXI7DQoNCglzdHJ1Y3QgZ2FtZXNEYXRhIHsNCgkJYm9vbCBpbml0Ow0KCX0NCg0KCW1hcHBpbmcoIGFkZHJlc3MgPT4gZ2FtZXNEYXRhKSBsaXN0R2FtZXM7DQoJYWRkcmVzc1tdIGFkZHJHYW1lczsNCg0KDQoJZnVuY3Rpb24gU21hcnRSb3VsZXR0ZVRva2VuKCkNCgl7DQoJCV9zdXBwbHkgPSAxMDAwMDAwMDAwMDAwMDAwMDA7DQoJCV9pbml0X2NvdW50X3Rva2VucyA9IDEwMDAwMDAwMDAwMDAwMDAwMDsNCg0KCQlkZXZlbG9wZXJfd2FsbGV0ID0gYWRkcmVzcygweDg1MjFFMWY5MjIwQTI1MWRFMGFiNzhmNmEyRTg3NTRDYTlFNzUyNDIpOw0KCQlfYmFsYW5jZXNbZGV2ZWxvcGVyX3dhbGxldF0gPSBob2xkZXJEYXRhKChfc3VwcGx5KjIwKS8xMDAsIHRydWUpOw0KCQkNCgkJd2FsbGV0X0lDTyA9IGFkZHJlc3MoMHgyZGZmODdmODg5MmQ2NWY3YTk3YjEyODdlNzk1NDA1MDk4YWU3YjdmKTsNCgkJX2JhbGFuY2VzW3dhbGxldF9JQ09dID0gaG9sZGVyRGF0YSgoX3N1cHBseSo2MCkvMTAwLCB0cnVlKTsNCgkJDQoJCWZvbmRfd2FsbGV0ID0gYWRkcmVzcygweDM1MDFERDJCNTE1RURDMTkyMGY5MDA3NzgyRGE1YWMwMTg5MjI1MDIpOw0KCQlfYmFsYW5jZXNbZm9uZF93YWxsZXRdID0gaG9sZGVyRGF0YSgoX3N1cHBseSoyMCkvMTAwLCB0cnVlKTsNCgkJDQoJCWxpc3RBZGRySG9sZGVycy5wdXNoKGRldmVsb3Blcl93YWxsZXQpOw0KCQlsaXN0QWRkckhvbGRlcnMucHVzaCh3YWxsZXRfSUNPKTsNCgkJbGlzdEFkZHJIb2xkZXJzLnB1c2goZm9uZF93YWxsZXQpOw0KICAgICAgICANCiAgICAgICAgbmFtZSA9ICdSb3VsZXR0ZSBUb2tlbic7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgc3ltYm9sID0gJ1JMVCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICBkZWNpbWFscyA9IDEwOw0KICAgICAgICBjb3N0T2ZPbmVUb2tlbiA9IDE1MDAwMDAwMDAwMDAwMDA7DQoNCgkJZGV2ZWxvcGVyID0gbXNnLnNlbmRlcjsNCgkJbWFuYWdlciA9IG1zZy5zZW5kZXI7CQkNCgkJDQoJCWVuYWJsZUlDTyA9IGZhbHNlOw0KCQltaW5fdmFsdWVfYnV5VG9rZW4gPSAxMDAwMDAwMDAwMDAwMDAwMDAwOw0KCQltYXhfdmFsdWVfYnV5VG9rZW4gPSA1MDAwMDAwMDAwMDAwMDAwMDAwMDA7DQoNCgkJc3RvcF9vcGVyYXRpb24gPSBmYWxzZTsNCgl9DQoNCgltb2RpZmllciBpc0RldmVsb3Blcigpew0KCQlpZiAobXNnLnNlbmRlciE9ZGV2ZWxvcGVyKSB0aHJvdzsNCgkJXzsNCgl9DQoNCgltb2RpZmllciBpc01hbmFnZXIoKXsNCgkJaWYgKG1zZy5zZW5kZXIhPW1hbmFnZXIgJiYgbXNnLnNlbmRlciE9ZGV2ZWxvcGVyKSB0aHJvdzsNCgkJXzsNCgl9DQoNCgltb2RpZmllciBpc0FjY2Vzc1N0b3BPcGVyYXRpb24oKXsNCgkJaWYgKG1zZy5zZW5kZXIhPW1hbmFnZXIgJiYgbXNnLnNlbmRlciE9ZGV2ZWxvcGVyICYmIChtc2cuc2VuZGVyIT1kaXZpZGVudF9jb250cmFjdCB8fCBkaXZpZGVudF9jb250cmFjdD09YWRkcmVzcygweDApKSkgdGhyb3c7DQoJCV87DQoJfQ0KDQoJZnVuY3Rpb24gY2hhbmdlRGV2ZWxvcGVyKGFkZHJlc3MgbmV3X2RldmVsb3BlcikNCglpc0RldmVsb3Blcg0KCXsNCgkJaWYobmV3X2RldmVsb3BlciA9PSBhZGRyZXNzKDB4MCkpIHRocm93Ow0KCQlkZXZlbG9wZXIgPSBuZXdfZGV2ZWxvcGVyOw0KCX0NCg0KCWZ1bmN0aW9uIGNoYW5nZU1hbmFnZXIoYWRkcmVzcyBuZXdfbWFuYWdlcikNCglpc0RldmVsb3Blcg0KCXsNCgkJaWYobmV3X21hbmFnZXIgPT0gYWRkcmVzcygweDApKSB0aHJvdzsNCgkJbWFuYWdlciA9IG5ld19tYW5hZ2VyOw0KCX0NCg0KCWZ1bmN0aW9uIGNoYW5nZURpdmlkZW50Q29udHJhY3QoYWRkcmVzcyBuZXdfY29udHJhY3QpIGlzTWFuYWdlcg0KCXsNCgkJaWYoZGl2aWRlbnRfY29udHJhY3QhPWFkZHJlc3MoMHgwKSkgdGhyb3c7DQoJCWlmKGRpdmlkZW50X2NvbnRyYWN0PT1hZGRyZXNzKDB4MCkpIHRocm93Ow0KCQlkaXZpZGVudF9jb250cmFjdCA9IG5ld19jb250cmFjdDsNCgl9DQoNCglmdW5jdGlvbiBuZXdDb3N0VG9rZW4odWludDI1NiBuZXdfY29zdCkNCglpc01hbmFnZXINCgl7DQoJCWlmKG5ld19jb3N0ID09IDApIHRocm93Ow0KCQljb3N0T2ZPbmVUb2tlbiA9IG5ld19jb3N0Ow0KCX0NCg0KCWZ1bmN0aW9uIGdldG9zdFRva2VuKCkgZXh0ZXJuYWwgY29uc3RhbnQgcmV0dXJucyh1aW50MjU2KQ0KCXsNCgkJcmV0dXJuIGNvc3RPZk9uZVRva2VuOw0KCX0NCg0KCWZ1bmN0aW9uIGFkZE5ld0dhbWUoYWRkcmVzcyBuZXdfZ2FtZSkNCglpc01hbmFnZXINCgl7DQoJCWlmKG5ld19nYW1lID09IGFkZHJlc3MoMHgwKSkgdGhyb3c7DQoJCWxpc3RHYW1lc1tuZXdfZ2FtZV0gPSBnYW1lc0RhdGEodHJ1ZSk7DQoJCWFkZHJHYW1lcy5wdXNoKG5ld19nYW1lKTsNCgl9DQoNCglmdW5jdGlvbiBkZWxldGVHYW1lKGFkZHJlc3MgZ2FtZSkNCglpc01hbmFnZXINCgl7DQoJCWlmKGdhbWUgPT0gYWRkcmVzcygweDApKSB0aHJvdzsNCgkJaWYobGlzdEdhbWVzW2dhbWVdLmluaXQpew0KCQkJbGlzdEdhbWVzW2dhbWVdLmluaXQgPSBmYWxzZTsNCgkJfQ0KCX0NCg0KCWZ1bmN0aW9uIGtpbGwoKSBpc0RldmVsb3BlciB7DQoJCXN1aWNpZGUoZGV2ZWxvcGVyKTsNCgl9DQoNCglmdW5jdGlvbiBhZGRVc2VyVG9MaXN0KGFkZHJlc3MgdXNlcikgaW50ZXJuYWwgew0KCQlpZighX2JhbGFuY2VzW3VzZXJdLmluaXQpew0KCQkJbGlzdEFkZHJIb2xkZXJzLnB1c2godXNlcik7DQoJCX0NCgl9DQoNCglmdW5jdGlvbiBnYW1lTGlzdE9mKCBhZGRyZXNzIHdobyApIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wgdmFsdWUpIHsNCgkJZ2FtZXNEYXRhIGdhbWVfZGF0YSA9IGxpc3RHYW1lc1t3aG9dOw0KCQlyZXR1cm4gZ2FtZV9kYXRhLmluaXQ7DQoJfQ0KDQoJLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkvLyBUb2tlbnMgRnVuY3Rpb25zDQoJLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCglldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50MjU2IHZhbHVlKTsNCg0KICAgIGZ1bmN0aW9uIHN0b3BPcGVyYXRpb24oKSBpc0FjY2Vzc1N0b3BPcGVyYXRpb24gew0KCQlzdG9wX29wZXJhdGlvbiA9IHRydWU7DQoJfQ0KDQoJZnVuY3Rpb24gc3RhcnRPcGVyYXRpb24oKSBpc0FjY2Vzc1N0b3BPcGVyYXRpb24gew0KCQlzdG9wX29wZXJhdGlvbiA9IGZhbHNlOw0KCX0NCg0KCWZ1bmN0aW9uIGlzT3BlcmF0aW9uQmxvY2tlZCgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGJvb2wpew0KCQlyZXR1cm4gc3RvcF9vcGVyYXRpb247DQoJfQ0KDQoJZnVuY3Rpb24gcnVuSUNPKCkgaXNNYW5hZ2VyIHsNCgkJZW5hYmxlSUNPID0gdHJ1ZTsNCgl9DQoNCglmdW5jdGlvbiBzdG9wSUNPKCkgaXNNYW5hZ2VyIHsNCgkJZW5hYmxlSUNPID0gZmFsc2U7DQoJfQ0KDQoJZnVuY3Rpb24gaW5mb0lDTygpIGNvbnN0YW50IHJldHVybnMgKGJvb2wpew0KCQlyZXR1cm4gZW5hYmxlSUNPOw0KCX0NCg0KCWZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBzdXBwbHkpIHsNCgkJcmV0dXJuIF9zdXBwbHk7DQoJfQ0KDQoJZnVuY3Rpb24gaW5pdENvdW50VG9rZW5zKCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBpbml0X2NvdW50KSB7DQoJCXJldHVybiBfaW5pdF9jb3VudF90b2tlbnM7DQoJfQ0KDQoJZnVuY3Rpb24gYmFsYW5jZU9mKCBhZGRyZXNzIHdobyApIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdmFsdWUpIHsNCgkJcmV0dXJuIF9iYWxhbmNlc1t3aG9dLnRva2Vuc19jb3VudDsNCgl9DQoNCglmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IF9hbGxvd2FuY2UpIHsNCgkJcmV0dXJuIF9hcHByb3ZhbHNbb3duZXJdW3NwZW5kZXJdOw0KCX0NCg0KCS8vIG92ZXJmbG93IGNoZWNrDQoJZnVuY3Rpb24gc2FmZVRvQWRkKHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7DQoJCXJldHVybiAoYSArIGIgPj0gYSAmJiBhICsgYiA+PSBiKTsNCgl9DQoNCglmdW5jdGlvbiB0cmFuc2ZlciggYWRkcmVzcyB0bywgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvaykgew0KCQlpZihzdG9wX29wZXJhdGlvbikgdGhyb3c7DQoNCgkJaWYoIF9iYWxhbmNlc1ttc2cuc2VuZGVyXS50b2tlbnNfY291bnQgPCB2YWx1ZSApIHsNCgkJICAgIHRocm93Ow0KCQl9DQoJCWlmKCAhc2FmZVRvQWRkKF9iYWxhbmNlc1t0b10udG9rZW5zX2NvdW50LCB2YWx1ZSkgKSB7DQoJCSAgICB0aHJvdzsNCgkJfQ0KDQoJCV9iYWxhbmNlc1ttc2cuc2VuZGVyXS50b2tlbnNfY291bnQgLT0gdmFsdWU7DQoJCWlmKF9iYWxhbmNlc1t0b10uaW5pdCl7DQoJCQlfYmFsYW5jZXNbdG9dLnRva2Vuc19jb3VudCArPSB2YWx1ZTsNCgkJfQ0KCQllbHNlew0KCQkJYWRkVXNlclRvTGlzdCh0byk7DQoJCQlfYmFsYW5jZXNbdG9dID0gaG9sZGVyRGF0YSh2YWx1ZSwgdHJ1ZSk7DQoJCX0NCg0KCQlUcmFuc2ZlciggbXNnLnNlbmRlciwgdG8sIHZhbHVlICk7DQoJCXJldHVybiB0cnVlOw0KCX0NCg0KCWZ1bmN0aW9uIHRyYW5zZmVyRnJvbSggYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50MjU2IHZhbHVlKSByZXR1cm5zIChib29sIG9rKSB7DQoJCWlmKHN0b3Bfb3BlcmF0aW9uKSB0aHJvdzsNCg0KCQlpZiggX2JhbGFuY2VzW2Zyb21dLnRva2Vuc19jb3VudCA8IHZhbHVlICkgew0KCQkgICAgdGhyb3c7DQoJCX0NCgkJDQoJCWlmKCBfYXBwcm92YWxzW2Zyb21dW21zZy5zZW5kZXJdIDwgdmFsdWUgKSB7DQoJCSAgICB0aHJvdzsNCgkJfQ0KCQlpZiggIXNhZmVUb0FkZChfYmFsYW5jZXNbdG9dLnRva2Vuc19jb3VudCwgdmFsdWUpICkgew0KCQkgICAgdGhyb3c7DQoJCX0NCgkJLy8gdHJhbnNmZXIgYW5kIHJldHVybiB0cnVlDQoJCV9hcHByb3ZhbHNbZnJvbV1bbXNnLnNlbmRlcl0gLT0gdmFsdWU7DQoJCV9iYWxhbmNlc1tmcm9tXS50b2tlbnNfY291bnQgLT0gdmFsdWU7DQoJCWlmKF9iYWxhbmNlc1t0b10uaW5pdCl7DQoJCQlfYmFsYW5jZXNbdG9dLnRva2Vuc19jb3VudCArPSB2YWx1ZTsNCgkJfQ0KCQllbHNlew0KCQkJYWRkVXNlclRvTGlzdCh0byk7DQoJCQlfYmFsYW5jZXNbdG9dID0gaG9sZGVyRGF0YSh2YWx1ZSwgdHJ1ZSk7DQoJCX0JCQ0KCQkNCgkJVHJhbnNmZXIoIGZyb20sIHRvLCB2YWx1ZSApOw0KCQlyZXR1cm4gdHJ1ZTsNCgl9DQoNCglmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvaykgew0KCQlpZihzdG9wX29wZXJhdGlvbikgdGhyb3c7DQoNCgkJX2FwcHJvdmFsc1ttc2cuc2VuZGVyXVtzcGVuZGVyXSA9IHZhbHVlOw0KCQlBcHByb3ZhbCggbXNnLnNlbmRlciwgc3BlbmRlciwgdmFsdWUgKTsNCgkJcmV0dXJuIHRydWU7DQoJfQ0KDQoJZXZlbnQgRW1pc3Npb24oYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50MjU2IHZhbHVlLCB1aW50MjU2IGJldCwgdWludDI1NiBjb2VmLCB1aW50MjU2IGRlY2ltYWxzLCB1aW50MjU2IGNvc3RfdG9rZW4pOw0KDQoJZnVuY3Rpb24gZW1pc3Npb24oYWRkcmVzcyBwbGF5ZXIsIGFkZHJlc3MgcGFydG5lciwgdWludDI1NiB2YWx1ZV9iZXQsIHVpbnQxNiBjb2VmX3BsYXllciwgdWludDE2IGNvZWZfcGFydG5lcikgZXh0ZXJuYWwgcmV0dXJucyh1aW50MjU2KSB7DQoJCWlmKHN0b3Bfb3BlcmF0aW9uKSB0aHJvdzsNCg0KCQlpZihsaXN0R2FtZXNbbXNnLnNlbmRlcl0uaW5pdCA9PSBmYWxzZSkgdGhyb3c7DQoJCWlmKHBsYXllciA9PSBhZGRyZXNzKDB4MCkpIHRocm93Ow0KCQlpZih2YWx1ZV9iZXQgPT0gMCkgdGhyb3c7DQoNCgkJdWludDI1NiBkZWNpbWFsc190b2tlbiA9IDEwKip1aW50MjU2KGRlY2ltYWxzKTsNCg0KCQl1aW50MjU2IHBsYXllcl90b2tlbiA9ICgodmFsdWVfYmV0KmNvZWZfcGxheWVyKmRlY2ltYWxzX3Rva2VuKS8xMDAwMCkvY29zdE9mT25lVG9rZW47DQoJCWlmKF9iYWxhbmNlc1twbGF5ZXJdLmluaXQpew0KCQkJX2JhbGFuY2VzW3BsYXllcl0udG9rZW5zX2NvdW50ICs9IHBsYXllcl90b2tlbjsNCgkJfQ0KCQllbHNlew0KCQkJYWRkVXNlclRvTGlzdChwbGF5ZXIpOw0KCQkJX2JhbGFuY2VzW3BsYXllcl0gPSBob2xkZXJEYXRhKHBsYXllcl90b2tlbiwgdHJ1ZSk7DQoJCX0NCgkJRW1pc3Npb24ocGxheWVyLCBwbGF5ZXJfdG9rZW4sIHZhbHVlX2JldCwgY29lZl9wbGF5ZXIsIGRlY2ltYWxzX3Rva2VuLCBjb3N0T2ZPbmVUb2tlbik7DQoNCgkJdWludDI1NiBwYXJ0bmVyX3Rva2VuID0gMDsNCgkJaWYocGFydG5lciAhPSBhZGRyZXNzKDB4MCkpew0KCQkJcGFydG5lcl90b2tlbiA9ICgodmFsdWVfYmV0KmNvZWZfcGFydG5lcipkZWNpbWFsc190b2tlbikvMTAwMDApL2Nvc3RPZk9uZVRva2VuOw0KCQkJaWYoX2JhbGFuY2VzW3BhcnRuZXJdLmluaXQpew0KCQkJCV9iYWxhbmNlc1twYXJ0bmVyXS50b2tlbnNfY291bnQgKz0gcGFydG5lcl90b2tlbjsNCgkJCX0NCgkJCWVsc2V7DQoJCQkJYWRkVXNlclRvTGlzdChwYXJ0bmVyKTsNCgkJCQlfYmFsYW5jZXNbcGFydG5lcl0gPSBob2xkZXJEYXRhKHBhcnRuZXJfdG9rZW4sIHRydWUpOw0KCQkJfQ0KCQkJRW1pc3Npb24ocGFydG5lciwgcGFydG5lcl90b2tlbiwgdmFsdWVfYmV0LCBjb2VmX3BhcnRuZXIsIGRlY2ltYWxzX3Rva2VuLCBjb3N0T2ZPbmVUb2tlbik7DQoJCX0NCg0KCQlfc3VwcGx5ICs9IChwbGF5ZXJfdG9rZW4rcGFydG5lcl90b2tlbik7DQoNCgkJcmV0dXJuIHBsYXllcl90b2tlbjsNCgl9DQoNCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIFRlbXBvcmFyeSBUb2tlbnMNCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCWFkZHJlc3NbXSBsaXN0QWRkclRlbXBIb2xkZXJzOw0KCWV2ZW50IFRlbXBUb2tlbnNTZW5kKGFkZHJlc3MgaW5kZXhlZCByZWNpcGllbnQsIHVpbnQyNTYgY291bnQsIHVpbnQyNTYgc3RhcnQsIHVpbnQyNTYgZW5kKTsNCg0KCWZ1bmN0aW9uIHNlbmRUZW1wVG9rZW5zKGFkZHJlc3MgcmVjaXBpZW50LCB1aW50MjU2IGNvdW50LCB1aW50MjU2IHBlcmlvZCkgaXNNYW5hZ2VyIHsNCgkJaWYoc3RvcF9vcGVyYXRpb24pIHRocm93Ow0KDQoJCWlmKGNvdW50PT0wIHx8IHBlcmlvZD09MCkgdGhyb3c7DQoJCQ0KCQl1aW50MjU2IGRlY2ltYWxzX3Rva2VuID0gMTAqKnVpbnQyNTYoZGVjaW1hbHMpOw0KCQljb3VudCA9IGNvdW50KmRlY2ltYWxzX3Rva2VuOw0KDQoJCWlmKF9iYWxhbmNlc1tmb25kX3dhbGxldF0udG9rZW5zX2NvdW50IDwgY291bnQpIHRocm93Ow0KCQlpZihfdGVtcF9iYWxhbmNlW3JlY2lwaWVudF0udG9rZW5zX2NvdW50ID4gMCkgdGhyb3c7DQoNCgkJX3RlbXBfYmFsYW5jZVtyZWNpcGllbnRdID0gdGVtcEhvbGRlckRhdGEoY291bnQsIG5vdywgbm93ICsgcGVyaW9kKTsNCgkJbGlzdEFkZHJUZW1wSG9sZGVycy5wdXNoKHJlY2lwaWVudCk7DQoJCV9iYWxhbmNlc1tmb25kX3dhbGxldF0udG9rZW5zX2NvdW50IC09IGNvdW50Ow0KCQlUZW1wVG9rZW5zU2VuZChyZWNpcGllbnQsIGNvdW50LCBfdGVtcF9iYWxhbmNlW3JlY2lwaWVudF0uc3RhcnRfZGF0ZSwgX3RlbXBfYmFsYW5jZVtyZWNpcGllbnRdLmVuZF9kYXRlKTsNCgl9DQoNCglmdW5jdGlvbiB0ZW1wVG9rZW5zQmFsYW5jZU9mKCBhZGRyZXNzIHdobyApIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCgkJLy90ZW1wSG9sZGVyRGF0YSBkYXRhX2hvbGRlciA9IF9fdGVtcF9iYWxhbmNlW3dob107DQoJCWlmKF90ZW1wX2JhbGFuY2Vbd2hvXS5lbmRfZGF0ZSA8IG5vdykgcmV0dXJuIDA7DQoJCWVsc2UgcmV0dXJuIF90ZW1wX2JhbGFuY2Vbd2hvXS50b2tlbnNfY291bnQ7DQoJfQ0KDQoJZnVuY3Rpb24gdGVtcFRva2Vuc1BlcmlvZE9mKCBhZGRyZXNzIHdobyApIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCgkJaWYoX3RlbXBfYmFsYW5jZVt3aG9dLmVuZF9kYXRlIDwgbm93KSByZXR1cm4gMDsNCgkJZWxzZSByZXR1cm4gX3RlbXBfYmFsYW5jZVt3aG9dLmVuZF9kYXRlOw0KCX0NCg0KCWZ1bmN0aW9uIHJldHVyblRlbXBUb2tlbnMoYWRkcmVzcyByZWNpcGllbnQpIGlzTWFuYWdlciB7DQoJCWlmKHN0b3Bfb3BlcmF0aW9uKSB0aHJvdzsNCgkJDQoJCWlmKF90ZW1wX2JhbGFuY2VbcmVjaXBpZW50XS50b2tlbnNfY291bnQgPT0gMCkgdGhyb3c7DQoNCgkJX2JhbGFuY2VzW2ZvbmRfd2FsbGV0XS50b2tlbnNfY291bnQgKz0gX3RlbXBfYmFsYW5jZVtyZWNpcGllbnRdLnRva2Vuc19jb3VudDsNCgkJX3RlbXBfYmFsYW5jZVtyZWNpcGllbnRdID0gdGVtcEhvbGRlckRhdGEoMCwgMCwgMCk7CQkNCgl9DQoNCglmdW5jdGlvbiBnZXRMaXN0VGVtcEhvbGRlcnMoKSBjb25zdGFudCByZXR1cm5zKGFkZHJlc3NbXSl7DQoJCXJldHVybiBsaXN0QWRkclRlbXBIb2xkZXJzOw0KCX0NCg0KCWZ1bmN0aW9uIGdldENvdW50VGVtcEhvbGRlcnMoKSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zKHVpbnQyNTYpew0KCQlyZXR1cm4gbGlzdEFkZHJUZW1wSG9sZGVycy5sZW5ndGg7DQoJfQ0KDQoJZnVuY3Rpb24gZ2V0SXRlbVRlbXBIb2xkZXJzKHVpbnQyNTYgaW5kZXgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyl7DQoJCWlmKGluZGV4ID49IGxpc3RBZGRyVGVtcEhvbGRlcnMubGVuZ3RoKSByZXR1cm4gYWRkcmVzcygweDApOw0KCQllbHNlIHJldHVybiBsaXN0QWRkclRlbXBIb2xkZXJzW2luZGV4XTsNCgl9DQoNCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8vIEludmVzdCBGdW5jdGlvbnMNCgkvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCS8qZXZlbnQgU3VjY2Vzc1Byb2ZpdFNlbmQoYWRkcmVzcyBpbmRleGVkIGhvbGRlciwgdWludCB2YWx1ZSk7DQoJZXZlbnQgRmFpbFByb2ZpdFNlbmQoYWRkcmVzcyBpbmRleGVkIGhvbGRlciwgdWludCB2YWx1ZSk7Ki8NCg0KCWZ1bmN0aW9uKCkgcGF5YWJsZQ0KCXsJDQoJCWlmKHN0b3Bfb3BlcmF0aW9uKSB0aHJvdzsNCgkJaWYobXNnLnNlbmRlciA9PSBkZXZlbG9wZXIpIHRocm93Ow0KCQlpZihtc2cuc2VuZGVyID09IG1hbmFnZXIpIHRocm93Ow0KCQlpZihtc2cuc2VuZGVyID09IGRldmVsb3Blcl93YWxsZXQpIHRocm93Ow0KCQlpZihtc2cuc2VuZGVyID09IHdhbGxldF9JQ08pIHRocm93Ow0KCQlpZihtc2cuc2VuZGVyID09IGZvbmRfd2FsbGV0KSB0aHJvdzsNCg0KCQlpZihsaXN0R2FtZXNbbXNnLnNlbmRlcl0uaW5pdCkgdGhyb3c7DQoNCgkJaWYoZW5hYmxlSUNPID09IGZhbHNlKSB0aHJvdzsNCgkJCQ0KCQlpZihtc2cudmFsdWUgPCBtaW5fdmFsdWVfYnV5VG9rZW4pIHRocm93Ow0KCQkNCgkJdWludDI1NiB2YWx1ZV9zZW5kID0gbXNnLnZhbHVlOw0KCQlpZih2YWx1ZV9zZW5kID4gbWF4X3ZhbHVlX2J1eVRva2VuKXsNCgkJCXZhbHVlX3NlbmQgPSBtYXhfdmFsdWVfYnV5VG9rZW47DQoJCQlpZihtc2cuc2VuZGVyLnNlbmQobXNnLnZhbHVlLW1heF92YWx1ZV9idXlUb2tlbik9PWZhbHNlKSB0aHJvdzsNCgkJfQ0KDQoJCXVpbnQyNTYgZGVjaW1hbHNfdG9rZW4gPSAxMCoqdWludDI1NihkZWNpbWFscyk7DQoJCQ0KCQl1aW50MjU2IGNvdW50X3Rva2VucyA9ICh2YWx1ZV9zZW5kKmRlY2ltYWxzX3Rva2VuKS9jb3N0T2ZPbmVUb2tlbjsNCgkJDQoJCWlmKGNvdW50X3Rva2VucyA+X2JhbGFuY2VzW3dhbGxldF9JQ09dLnRva2Vuc19jb3VudCApew0KCQkJY291bnRfdG9rZW5zID0gX2JhbGFuY2VzW3dhbGxldF9JQ09dLnRva2Vuc19jb3VudDsNCgkJfQ0KCQlpZih2YWx1ZV9zZW5kID4gKGNvdW50X3Rva2Vucypjb3N0T2ZPbmVUb2tlbikvZGVjaW1hbHNfdG9rZW4pewkJCQkNCgkJCWlmKG1zZy5zZW5kZXIuc2VuZCh2YWx1ZV9zZW5kLSgoY291bnRfdG9rZW5zKmNvc3RPZk9uZVRva2VuKS9kZWNpbWFsc190b2tlbikpPT1mYWxzZSkgdGhyb3c7DQoJCQl2YWx1ZV9zZW5kID0gdmFsdWVfc2VuZCAtICgoY291bnRfdG9rZW5zKmNvc3RPZk9uZVRva2VuKS9kZWNpbWFsc190b2tlbik7DQoJCX0NCg0KCQlpZighX2JhbGFuY2VzW21zZy5zZW5kZXJdLmluaXQpew0KCQkJYWRkVXNlclRvTGlzdChtc2cuc2VuZGVyKTsNCgkJCV9iYWxhbmNlc1t3YWxsZXRfSUNPXS50b2tlbnNfY291bnQgLT0gY291bnRfdG9rZW5zOwkJCQ0KCQkJX2JhbGFuY2VzW21zZy5zZW5kZXJdID0gaG9sZGVyRGF0YShjb3VudF90b2tlbnMsIHRydWUpOw0KCQl9DQoJCWVsc2V7DQoJCQlpZigoKF9iYWxhbmNlc1ttc2cuc2VuZGVyXS50b2tlbnNfY291bnQqY29zdE9mT25lVG9rZW4pL2RlY2ltYWxzX3Rva2VuKSsoKGNvdW50X3Rva2Vucypjb3N0T2ZPbmVUb2tlbikvZGVjaW1hbHNfdG9rZW4pPm1heF92YWx1ZV9idXlUb2tlbikgew0KCQkJCWNvdW50X3Rva2VucyA9ICgobWF4X3ZhbHVlX2J1eVRva2VuKmRlY2ltYWxzX3Rva2VuKS9jb3N0T2ZPbmVUb2tlbiktX2JhbGFuY2VzW21zZy5zZW5kZXJdLnRva2Vuc19jb3VudDsJCQkJCQ0KCQkJCWlmKG1zZy5zZW5kZXIuc2VuZCh2YWx1ZV9zZW5kLSgoY291bnRfdG9rZW5zKmNvc3RPZk9uZVRva2VuKS9kZWNpbWFsc190b2tlbikpPT1mYWxzZSkgdGhyb3c7DQoJCQkJdmFsdWVfc2VuZCA9ICgoY291bnRfdG9rZW5zKmNvc3RPZk9uZVRva2VuKS9kZWNpbWFsc190b2tlbik7DQoJCQl9DQoNCgkJCV9iYWxhbmNlc1t3YWxsZXRfSUNPXS50b2tlbnNfY291bnQgLT0gY291bnRfdG9rZW5zOw0KCQkJX2JhbGFuY2VzW21zZy5zZW5kZXJdLnRva2Vuc19jb3VudCArPSBjb3VudF90b2tlbnM7DQoJCX0NCg0KCQlpZih2YWx1ZV9zZW5kPjApew0KCQkJaWYod2FsbGV0X0lDTy5zZW5kKHZhbHVlX3NlbmQpPT1mYWxzZSkgdGhyb3c7DQoJCX0NCg0KCQlpZihjb3VudF90b2tlbnM+MCl7DQoJCQlUb2tlbkJ1eShtc2cuc2VuZGVyLCBjb3VudF90b2tlbnMpOw0KCQl9DQoNCgkJaWYoX2JhbGFuY2VzW3dhbGxldF9JQ09dLnRva2Vuc19jb3VudCA9PSAwKXsNCgkJCWVuYWJsZUlDTyA9IGZhbHNlOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gZ2V0TGlzdEFkZHJlc3NIb2xkZXJzKCkgY29uc3RhbnQgcmV0dXJucyhhZGRyZXNzW10pew0KCQlyZXR1cm4gbGlzdEFkZHJIb2xkZXJzOw0KCX0NCg0KCWZ1bmN0aW9uIGdldENvdW50SG9sZGVycygpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnModWludDI1Nil7DQoJCXJldHVybiBsaXN0QWRkckhvbGRlcnMubGVuZ3RoOw0KCX0NCg0KCWZ1bmN0aW9uIGdldEl0ZW1Ib2xkZXJzKHVpbnQyNTYgaW5kZXgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMoYWRkcmVzcyl7DQoJCWlmKGluZGV4ID49IGxpc3RBZGRySG9sZGVycy5sZW5ndGgpIHJldHVybiBhZGRyZXNzKDB4MCk7DQoJCWVsc2UgcmV0dXJuIGxpc3RBZGRySG9sZGVyc1tpbmRleF07DQoJfQ0KfQ=='