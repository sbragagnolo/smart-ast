base 64 content
base64smartToken6
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLyoNCiAgICBPd25lZCBjb250cmFjdCBpbnRlcmZhY2UNCiovDQpjb250cmFjdCBJT3duZWQgew0KICAgIC8vIHRoaXMgZnVuY3Rpb24gaXNuJ3QgYWJzdHJhY3Qgc2luY2UgdGhlIGNvbXBpbGVyIGVtaXRzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGdldHRlciBmdW5jdGlvbnMgYXMgZXh0ZXJuYWwNCiAgICBmdW5jdGlvbiBvd25lcigpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzIG93bmVyKSB7IG93bmVyOyB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljOw0KICAgIGZ1bmN0aW9uIGFjY2VwdE93bmVyc2hpcCgpIHB1YmxpYzsNCn0NCg0KDQovKg0KICAgIFByb3ZpZGVzIHN1cHBvcnQgYW5kIHV0aWxpdGllcyBmb3IgY29udHJhY3Qgb3duZXJzaGlwDQoqLw0KY29udHJhY3QgT3duZWQgaXMgSU93bmVkIHsNCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCiAgICBhZGRyZXNzIHB1YmxpYyBuZXdPd25lcjsNCg0KICAgIGV2ZW50IE93bmVyVXBkYXRlKGFkZHJlc3MgX3ByZXZPd25lciwgYWRkcmVzcyBfbmV3T3duZXIpOw0KDQogICAgLyoqDQogICAgICAgIEBkZXYgY29uc3RydWN0b3INCiAgICAqLw0KICAgIGZ1bmN0aW9uIE93bmVkKCkgew0KICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgLy8gYWxsb3dzIGV4ZWN1dGlvbiBieSB0aGUgb3duZXIgb25seQ0KICAgIG1vZGlmaWVyIG93bmVyT25seSB7DQogICAgICAgIGFzc2VydChtc2cuc2VuZGVyID09IG93bmVyKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgICAgQGRldiBhbGxvd3MgdHJhbnNmZXJyaW5nIHRoZSBjb250cmFjdCBvd25lcnNoaXANCiAgICAgICAgdGhlIG5ldyBvd25lciBzdGlsbCBuZWVkIHRvIGFjY2VwdCB0aGUgdHJhbnNmZXINCiAgICAgICAgY2FuIG9ubHkgYmUgY2FsbGVkIGJ5IHRoZSBjb250cmFjdCBvd25lcg0KDQogICAgICAgIEBwYXJhbSBfbmV3T3duZXIgICAgbmV3IGNvbnRyYWN0IG93bmVyDQogICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIF9uZXdPd25lcikgcHVibGljIG93bmVyT25seSB7DQogICAgICAgIHJlcXVpcmUoX25ld093bmVyICE9IG93bmVyKTsNCiAgICAgICAgbmV3T3duZXIgPSBfbmV3T3duZXI7DQogICAgfQ0KDQogICAgLyoqDQogICAgICAgIEBkZXYgdXNlZCBieSBhIG5ldyBvd25lciB0byBhY2NlcHQgYW4gb3duZXJzaGlwIHRyYW5zZmVyDQogICAgKi8NCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSBwdWJsaWMgew0KICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gbmV3T3duZXIpOw0KICAgICAgICBPd25lclVwZGF0ZShvd25lciwgbmV3T3duZXIpOw0KICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgICAgICBuZXdPd25lciA9IDB4MDsNCiAgICB9DQp9DQoNCi8qDQogICAgVG9rZW4gSG9sZGVyIGludGVyZmFjZQ0KKi8NCmNvbnRyYWN0IElUb2tlbkhvbGRlciBpcyBJT3duZWQgew0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3VG9rZW5zKElFUkMyMFRva2VuIF90b2tlbiwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljOw0KfQ0KDQoNCi8qDQogICAgT3ZlcmZsb3cgcHJvdGVjdGVkIG1hdGggZnVuY3Rpb25zDQoqLw0KY29udHJhY3QgU2FmZU1hdGggew0KICAgIC8qKg0KICAgICAgICBjb25zdHJ1Y3Rvcg0KICAgICovDQogICAgZnVuY3Rpb24gU2FmZU1hdGgoKSB7DQogICAgfQ0KDQogICAgLyoqDQogICAgICAgIEBkZXYgcmV0dXJucyB0aGUgc3VtIG9mIF94IGFuZCBfeSwgYXNzZXJ0cyBpZiB0aGUgY2FsY3VsYXRpb24gb3ZlcmZsb3dzDQoNCiAgICAgICAgQHBhcmFtIF94ICAgdmFsdWUgMQ0KICAgICAgICBAcGFyYW0gX3kgICB2YWx1ZSAyDQoNCiAgICAgICAgQHJldHVybiBzdW0NCiAgICAqLw0KICAgIGZ1bmN0aW9uIHNhZmVBZGQodWludDI1NiBfeCwgdWludDI1NiBfeSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICB1aW50MjU2IHogPSBfeCArIF95Ow0KICAgICAgICBhc3NlcnQoeiA+PSBfeCk7DQogICAgICAgIHJldHVybiB6Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IHJldHVybnMgdGhlIGRpZmZlcmVuY2Ugb2YgX3ggbWludXMgX3ksIGFzc2VydHMgaWYgdGhlIHN1YnRyYWN0aW9uIHJlc3VsdHMgaW4gYSBuZWdhdGl2ZSBudW1iZXINCg0KICAgICAgICBAcGFyYW0gX3ggICBtaW51ZW5kDQogICAgICAgIEBwYXJhbSBfeSAgIHN1YnRyYWhlbmQNCg0KICAgICAgICBAcmV0dXJuIGRpZmZlcmVuY2UNCiAgICAqLw0KICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludDI1NiBfeCwgdWludDI1NiBfeSkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICBhc3NlcnQoX3ggPj0gX3kpOw0KICAgICAgICByZXR1cm4gX3ggLSBfeTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgICAgQGRldiByZXR1cm5zIHRoZSBwcm9kdWN0IG9mIG11bHRpcGx5aW5nIF94IGJ5IF95LCBhc3NlcnRzIGlmIHRoZSBjYWxjdWxhdGlvbiBvdmVyZmxvd3MNCg0KICAgICAgICBAcGFyYW0gX3ggICBmYWN0b3IgMQ0KICAgICAgICBAcGFyYW0gX3kgICBmYWN0b3IgMg0KDQogICAgICAgIEByZXR1cm4gcHJvZHVjdA0KICAgICovDQogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50MjU2IF94LCB1aW50MjU2IF95KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgICAgIHVpbnQyNTYgeiA9IF94ICogX3k7DQogICAgICAgIGFzc2VydChfeCA9PSAwIHx8IHogLyBfeCA9PSBfeSk7DQogICAgICAgIHJldHVybiB6Ow0KICAgIH0NCn0gDQoNCi8qDQogICAgRVJDMjAgU3RhbmRhcmQgVG9rZW4gaW50ZXJmYWNlDQoqLw0KY29udHJhY3QgSUVSQzIwVG9rZW4gew0KICAgIC8vIHRoZXNlIGZ1bmN0aW9ucyBhcmVuJ3QgYWJzdHJhY3Qgc2luY2UgdGhlIGNvbXBpbGVyIGVtaXRzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGdldHRlciBmdW5jdGlvbnMgYXMgZXh0ZXJuYWwNCiAgICBmdW5jdGlvbiBuYW1lKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHN0cmluZyBuYW1lKSB7IG5hbWU7IH0NCiAgICBmdW5jdGlvbiBzeW1ib2woKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoc3RyaW5nIHN5bWJvbCkgeyBzeW1ib2w7IH0NCiAgICBmdW5jdGlvbiBkZWNpbWFscygpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50OCBkZWNpbWFscykgeyBkZWNpbWFsczsgfQ0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYgdG90YWxTdXBwbHkpIHsgdG90YWxTdXBwbHk7IH0NCiAgICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyBfb3duZXIpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsgX293bmVyOyBiYWxhbmNlOyB9DQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsgX293bmVyOyBfc3BlbmRlcjsgcmVtYWluaW5nOyB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfdmFsdWUpIHB1YmxpYyByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KfQ0KDQovKioNCiAgICBFUkMyMCBTdGFuZGFyZCBUb2tlbiBpbXBsZW1lbnRhdGlvbg0KKi8NCmNvbnRyYWN0IEVSQzIwVG9rZW4gaXMgSUVSQzIwVG9rZW4sIFNhZmVNYXRoIHsNCiAgICBzdHJpbmcgcHVibGljIHN0YW5kYXJkID0gJ1Rva2VuIDAuMSc7DQogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gJyc7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2wgPSAnJzsNCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHMgPSAwOw0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsU3VwcGx5ID0gMDsNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgYWxsb3dhbmNlOw0KDQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50MjU2IF92YWx1ZSk7DQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSk7DQoNCiAgICAvKioNCiAgICAgICAgQGRldiBjb25zdHJ1Y3Rvcg0KDQogICAgICAgIEBwYXJhbSBfbmFtZSAgICAgICAgdG9rZW4gbmFtZQ0KICAgICAgICBAcGFyYW0gX3N5bWJvbCAgICAgIHRva2VuIHN5bWJvbA0KICAgICAgICBAcGFyYW0gX2RlY2ltYWxzICAgIGRlY2ltYWwgcG9pbnRzLCBmb3IgZGlzcGxheSBwdXJwb3Nlcw0KICAgICovDQogICAgZnVuY3Rpb24gRVJDMjBUb2tlbihzdHJpbmcgX25hbWUsIHN0cmluZyBfc3ltYm9sLCB1aW50OCBfZGVjaW1hbHMpIHsNCiAgICAgICAgcmVxdWlyZShieXRlcyhfbmFtZSkubGVuZ3RoID4gMCAmJiBieXRlcyhfc3ltYm9sKS5sZW5ndGggPiAwKTsgLy8gdmFsaWRhdGUgaW5wdXQNCg0KICAgICAgICBuYW1lID0gX25hbWU7DQogICAgICAgIHN5bWJvbCA9IF9zeW1ib2w7DQogICAgICAgIGRlY2ltYWxzID0gX2RlY2ltYWxzOw0KICAgIH0NCg0KICAgIC8vIHZhbGlkYXRlcyBhbiBhZGRyZXNzIC0gY3VycmVudGx5IG9ubHkgY2hlY2tzIHRoYXQgaXQgaXNuJ3QgbnVsbA0KICAgIG1vZGlmaWVyIHZhbGlkQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSB7DQogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gMHgwKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgICAgQGRldiBzZW5kIGNvaW5zDQogICAgICAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycw0KDQogICAgICAgIEBwYXJhbSBfdG8gICAgICB0YXJnZXQgYWRkcmVzcw0KICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50DQoNCiAgICAgICAgQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2UgaWYgaXQgd2Fzbid0DQogICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpDQogICAgICAgIHB1YmxpYw0KICAgICAgICB2YWxpZEFkZHJlc3MoX3RvKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpDQogICAgew0KICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VPZlttc2cuc2VuZGVyXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBzYWZlQWRkKGJhbGFuY2VPZltfdG9dLCBfdmFsdWUpOw0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IGFuIGFjY291bnQvY29udHJhY3QgYXR0ZW1wdHMgdG8gZ2V0IHRoZSBjb2lucw0KICAgICAgICB0aHJvd3Mgb24gYW55IGVycm9yIHJhdGhlciB0aGVuIHJldHVybiBhIGZhbHNlIGZsYWcgdG8gbWluaW1pemUgdXNlciBlcnJvcnMNCg0KICAgICAgICBAcGFyYW0gX2Zyb20gICAgc291cmNlIGFkZHJlc3MNCiAgICAgICAgQHBhcmFtIF90byAgICAgIHRhcmdldCBhZGRyZXNzDQogICAgICAgIEBwYXJhbSBfdmFsdWUgICB0cmFuc2ZlciBhbW91bnQNCg0KICAgICAgICBAcmV0dXJuIHRydWUgaWYgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVsLCBmYWxzZSBpZiBpdCB3YXNuJ3QNCiAgICAqLw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpDQogICAgICAgIHB1YmxpYw0KICAgICAgICB2YWxpZEFkZHJlc3MoX2Zyb20pDQogICAgICAgIHZhbGlkQWRkcmVzcyhfdG8pDQogICAgICAgIHJldHVybnMgKGJvb2wgc3VjY2VzcykNCiAgICB7DQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VPZltfZnJvbV0sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX3ZhbHVlKTsNCiAgICAgICAgVHJhbnNmZXIoX2Zyb20sIF90bywgX3ZhbHVlKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICAgIEBkZXYgYWxsb3cgYW5vdGhlciBhY2NvdW50L2NvbnRyYWN0IHRvIHNwZW5kIHNvbWUgdG9rZW5zIG9uIHlvdXIgYmVoYWxmDQogICAgICAgIHRocm93cyBvbiBhbnkgZXJyb3IgcmF0aGVyIHRoZW4gcmV0dXJuIGEgZmFsc2UgZmxhZyB0byBtaW5pbWl6ZSB1c2VyIGVycm9ycw0KDQogICAgICAgIGFsc28sIHRvIG1pbmltaXplIHRoZSByaXNrIG9mIHRoZSBhcHByb3ZlL3RyYW5zZmVyRnJvbSBhdHRhY2sgdmVjdG9yDQogICAgICAgIChzZWUgaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xWUxQdFF4WnUxVUF2TzljWjFPMlJQWEJiVDBtb29oNERZS2pBX2pwLVJMTS8pLCBhcHByb3ZlIGhhcyB0byBiZSBjYWxsZWQgdHdpY2UNCiAgICAgICAgaW4gMiBzZXBhcmF0ZSB0cmFuc2FjdGlvbnMgLSBvbmNlIHRvIGNoYW5nZSB0aGUgYWxsb3dhbmNlIHRvIDAgYW5kIHNlY29uZGx5IHRvIGNoYW5nZSBpdCB0byB0aGUgbmV3IGFsbG93YW5jZSB2YWx1ZQ0KDQogICAgICAgIEBwYXJhbSBfc3BlbmRlciBhcHByb3ZlZCBhZGRyZXNzDQogICAgICAgIEBwYXJhbSBfdmFsdWUgICBhbGxvd2FuY2UgYW1vdW50DQoNCiAgICAgICAgQHJldHVybiB0cnVlIGlmIHRoZSBhcHByb3ZhbCB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2UgaWYgaXQgd2Fzbid0DQogICAgKi8NCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQyNTYgX3ZhbHVlKQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgdmFsaWRBZGRyZXNzKF9zcGVuZGVyKQ0KICAgICAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpDQogICAgew0KICAgICAgICAvLyBpZiB0aGUgYWxsb3dhbmNlIGlzbid0IDAsIGl0IGNhbiBvbmx5IGJlIHVwZGF0ZWQgdG8gMCB0byBwcmV2ZW50IGFuIGFsbG93YW5jZSBjaGFuZ2UgaW1tZWRpYXRlbHkgYWZ0ZXIgd2l0aGRyYXdhbA0KICAgICAgICByZXF1aXJlKF92YWx1ZSA9PSAwIHx8IGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPT0gMCk7DQoNCiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0NCg0KDQoNCi8qDQogICAgV2UgY29uc2lkZXIgZXZlcnkgY29udHJhY3QgdG8gYmUgYSAndG9rZW4gaG9sZGVyJyBzaW5jZSBpdCdzIGN1cnJlbnRseSBub3QgcG9zc2libGUNCiAgICBmb3IgYSBjb250cmFjdCB0byBkZW55IHJlY2VpdmluZyB0b2tlbnMuDQoNCiAgICBUaGUgVG9rZW5Ib2xkZXIncyBjb250cmFjdCBzb2xlIHB1cnBvc2UgaXMgdG8gcHJvdmlkZSBhIHNhZmV0eSBtZWNoYW5pc20gdGhhdCBhbGxvd3MNCiAgICB0aGUgb3duZXIgdG8gc2VuZCB0b2tlbnMgdGhhdCB3ZXJlIHNlbnQgdG8gdGhlIGNvbnRyYWN0IGJ5IG1pc3Rha2UgYmFjayB0byB0aGVpciBzZW5kZXIuDQoqLw0KY29udHJhY3QgVG9rZW5Ib2xkZXIgaXMgSVRva2VuSG9sZGVyLCBPd25lZCB7DQogICAgLyoqDQogICAgICAgIEBkZXYgY29uc3RydWN0b3INCiAgICAqLw0KICAgIGZ1bmN0aW9uIFRva2VuSG9sZGVyKCkgew0KICAgIH0NCg0KICAgIC8vIHZhbGlkYXRlcyBhbiBhZGRyZXNzIC0gY3VycmVudGx5IG9ubHkgY2hlY2tzIHRoYXQgaXQgaXNuJ3QgbnVsbA0KICAgIG1vZGlmaWVyIHZhbGlkQWRkcmVzcyhhZGRyZXNzIF9hZGRyZXNzKSB7DQogICAgICAgIHJlcXVpcmUoX2FkZHJlc3MgIT0gMHgwKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICAvLyB2ZXJpZmllcyB0aGF0IHRoZSBhZGRyZXNzIGlzIGRpZmZlcmVudCB0aGFuIHRoaXMgY29udHJhY3QgYWRkcmVzcw0KICAgIG1vZGlmaWVyIG5vdFRoaXMoYWRkcmVzcyBfYWRkcmVzcykgew0KICAgICAgICByZXF1aXJlKF9hZGRyZXNzICE9IGFkZHJlc3ModGhpcykpOw0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IHdpdGhkcmF3cyB0b2tlbnMgaGVsZCBieSB0aGUgY29udHJhY3QgYW5kIHNlbmRzIHRoZW0gdG8gYW4gYWNjb3VudA0KICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIG93bmVyDQoNCiAgICAgICAgQHBhcmFtIF90b2tlbiAgIEVSQzIwIHRva2VuIGNvbnRyYWN0IGFkZHJlc3MNCiAgICAgICAgQHBhcmFtIF90byAgICAgIGFjY291bnQgdG8gcmVjZWl2ZSB0aGUgbmV3IGFtb3VudA0KICAgICAgICBAcGFyYW0gX2Ftb3VudCAgYW1vdW50IHRvIHdpdGhkcmF3DQogICAgKi8NCiAgICBmdW5jdGlvbiB3aXRoZHJhd1Rva2VucyhJRVJDMjBUb2tlbiBfdG9rZW4sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpDQogICAgICAgIHB1YmxpYw0KICAgICAgICBvd25lck9ubHkNCiAgICAgICAgdmFsaWRBZGRyZXNzKF90b2tlbikNCiAgICAgICAgdmFsaWRBZGRyZXNzKF90bykNCiAgICAgICAgbm90VGhpcyhfdG8pDQogICAgew0KICAgICAgICBhc3NlcnQoX3Rva2VuLnRyYW5zZmVyKF90bywgX2Ftb3VudCkpOw0KICAgIH0NCn0NCg0KDQoNCi8qDQogICAgU21hcnQgVG9rZW4gaW50ZXJmYWNlDQoqLw0KY29udHJhY3QgSVNtYXJ0VG9rZW4gaXMgSVRva2VuSG9sZGVyLCBJRVJDMjBUb2tlbiB7DQogICAgZnVuY3Rpb24gZGlzYWJsZVRyYW5zZmVycyhib29sIF9kaXNhYmxlKSBwdWJsaWM7DQogICAgZnVuY3Rpb24gaXNzdWUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkgcHVibGljOw0KICAgIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfYW1vdW50KSBwdWJsaWM7DQp9DQoNCg0KLyoNCiAgICBTbWFydCBUb2tlbiB2MC4yDQoNCiAgICAnT3duZWQnIGlzIHNwZWNpZmllZCBoZXJlIGZvciByZWFkYWJpbGl0eSByZWFzb25zDQoqLw0KY29udHJhY3QgU21hcnRUb2tlbiBpcyBJU21hcnRUb2tlbiwgRVJDMjBUb2tlbiwgT3duZWQsIFRva2VuSG9sZGVyIHsNCiAgICBzdHJpbmcgcHVibGljIHZlcnNpb24gPSAnMC4yJzsNCg0KICAgIGJvb2wgcHVibGljIHRyYW5zZmVyc0VuYWJsZWQgPSB0cnVlOyAgICAvLyB0cnVlIGlmIHRyYW5zZmVyL3RyYW5zZmVyRnJvbSBhcmUgZW5hYmxlZCwgZmFsc2UgaWYgbm90DQoNCiAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIHNtYXJ0IHRva2VuIGlzIGRlcGxveWVkIC0gdGhlIF90b2tlbiBhZGRyZXNzIGlzIGRlZmluZWQgZm9yIGZvcndhcmQgY29tcGF0aWJpbGl0eSwgaW4gY2FzZSB3ZSB3YW50IHRvIHRyaWdnZXIgdGhlIGV2ZW50IGZyb20gYSBmYWN0b3J5DQogICAgZXZlbnQgTmV3U21hcnRUb2tlbihhZGRyZXNzIF90b2tlbik7DQogICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHRvdGFsIHN1cHBseSBpcyBpbmNyZWFzZWQNCiAgICBldmVudCBJc3N1YW5jZSh1aW50MjU2IF9hbW91bnQpOw0KICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSB0b3RhbCBzdXBwbHkgaXMgZGVjcmVhc2VkDQogICAgZXZlbnQgRGVzdHJ1Y3Rpb24odWludDI1NiBfYW1vdW50KTsNCg0KICAgIC8qKg0KICAgICAgICBAZGV2IGNvbnN0cnVjdG9yDQoNCiAgICAgICAgQHBhcmFtIF9uYW1lICAgICAgIHRva2VuIG5hbWUNCiAgICAgICAgQHBhcmFtIF9zeW1ib2wgICAgIHRva2VuIHNob3J0IHN5bWJvbCwgMS02IGNoYXJhY3RlcnMNCiAgICAgICAgQHBhcmFtIF9kZWNpbWFscyAgIGZvciBkaXNwbGF5IHB1cnBvc2VzIG9ubHkNCiAgICAqLw0KICAgIGZ1bmN0aW9uIFNtYXJ0VG9rZW4oc3RyaW5nIF9uYW1lLCBzdHJpbmcgX3N5bWJvbCwgdWludDggX2RlY2ltYWxzKQ0KICAgICAgICBFUkMyMFRva2VuKF9uYW1lLCBfc3ltYm9sLCBfZGVjaW1hbHMpDQogICAgew0KICAgICAgICByZXF1aXJlKGJ5dGVzKF9zeW1ib2wpLmxlbmd0aCA8PSA2KTsgLy8gdmFsaWRhdGUgaW5wdXQNCiAgICAgICAgTmV3U21hcnRUb2tlbihhZGRyZXNzKHRoaXMpKTsNCiAgICB9DQoNCiAgICAvLyBhbGxvd3MgZXhlY3V0aW9uIG9ubHkgd2hlbiB0cmFuc2ZlcnMgYXJlbid0IGRpc2FibGVkDQogICAgbW9kaWZpZXIgdHJhbnNmZXJzQWxsb3dlZCB7DQogICAgICAgIGFzc2VydCh0cmFuc2ZlcnNFbmFibGVkKTsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgICAgQGRldiBkaXNhYmxlcy9lbmFibGVzIHRyYW5zZmVycw0KICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyDQoNCiAgICAgICAgQHBhcmFtIF9kaXNhYmxlICAgIHRydWUgdG8gZGlzYWJsZSB0cmFuc2ZlcnMsIGZhbHNlIHRvIGVuYWJsZSB0aGVtDQogICAgKi8NCiAgICBmdW5jdGlvbiBkaXNhYmxlVHJhbnNmZXJzKGJvb2wgX2Rpc2FibGUpIHB1YmxpYyBvd25lck9ubHkgew0KICAgICAgICB0cmFuc2ZlcnNFbmFibGVkID0gIV9kaXNhYmxlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IGluY3JlYXNlcyB0aGUgdG9rZW4gc3VwcGx5IGFuZCBzZW5kcyB0aGUgbmV3IHRva2VucyB0byBhbiBhY2NvdW50DQogICAgICAgIGNhbiBvbmx5IGJlIGNhbGxlZCBieSB0aGUgY29udHJhY3Qgb3duZXINCg0KICAgICAgICBAcGFyYW0gX3RvICAgICAgICAgYWNjb3VudCB0byByZWNlaXZlIHRoZSBuZXcgYW1vdW50DQogICAgICAgIEBwYXJhbSBfYW1vdW50ICAgICBhbW91bnQgdG8gaW5jcmVhc2UgdGhlIHN1cHBseSBieQ0KICAgICovDQogICAgZnVuY3Rpb24gaXNzdWUoYWRkcmVzcyBfdG8sIHVpbnQyNTYgX2Ftb3VudCkNCiAgICAgICAgcHVibGljDQogICAgICAgIG93bmVyT25seQ0KICAgICAgICB2YWxpZEFkZHJlc3MoX3RvKQ0KICAgICAgICBub3RUaGlzKF90bykNCiAgICB7DQogICAgICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSwgX2Ftb3VudCk7DQogICAgICAgIGJhbGFuY2VPZltfdG9dID0gc2FmZUFkZChiYWxhbmNlT2ZbX3RvXSwgX2Ftb3VudCk7DQoNCiAgICAgICAgSXNzdWFuY2UoX2Ftb3VudCk7DQogICAgICAgIFRyYW5zZmVyKHRoaXMsIF90bywgX2Ftb3VudCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICAgIEBkZXYgcmVtb3ZlcyB0b2tlbnMgZnJvbSBhbiBhY2NvdW50IGFuZCBkZWNyZWFzZXMgdGhlIHRva2VuIHN1cHBseQ0KICAgICAgICBjYW4gb25seSBiZSBjYWxsZWQgYnkgdGhlIGNvbnRyYWN0IG93bmVyDQoNCiAgICAgICAgQHBhcmFtIF9mcm9tICAgICAgIGFjY291bnQgdG8gcmVtb3ZlIHRoZSBhbW91bnQgZnJvbQ0KICAgICAgICBAcGFyYW0gX2Ftb3VudCAgICAgYW1vdW50IHRvIGRlY3JlYXNlIHRoZSBzdXBwbHkgYnkNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGRlc3Ryb3koYWRkcmVzcyBfZnJvbSwgdWludDI1NiBfYW1vdW50KQ0KICAgICAgICBwdWJsaWMNCiAgICAgICAgb3duZXJPbmx5DQogICAgew0KICAgICAgICBiYWxhbmNlT2ZbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlT2ZbX2Zyb21dLCBfYW1vdW50KTsNCiAgICAgICAgdG90YWxTdXBwbHkgPSBzYWZlU3ViKHRvdGFsU3VwcGx5LCBfYW1vdW50KTsNCg0KICAgICAgICBUcmFuc2ZlcihfZnJvbSwgdGhpcywgX2Ftb3VudCk7DQogICAgICAgIERlc3RydWN0aW9uKF9hbW91bnQpOw0KICAgIH0NCg0KICAgIC8vIEVSQzIwIHN0YW5kYXJkIG1ldGhvZCBvdmVycmlkZXMgd2l0aCBzb21lIGV4dHJhIGZ1bmN0aW9uYWxpdHkNCg0KICAgIC8qKg0KICAgICAgICBAZGV2IHNlbmQgY29pbnMNCiAgICAgICAgdGhyb3dzIG9uIGFueSBlcnJvciByYXRoZXIgdGhlbiByZXR1cm4gYSBmYWxzZSBmbGFnIHRvIG1pbmltaXplIHVzZXIgZXJyb3JzDQogICAgICAgIG5vdGUgdGhhdCB3aGVuIHRyYW5zZmVycmluZyB0byB0aGUgc21hcnQgdG9rZW4ncyBhZGRyZXNzLCB0aGUgY29pbnMgYXJlIGFjdHVhbGx5IGRlc3Ryb3llZA0KDQogICAgICAgIEBwYXJhbSBfdG8gICAgICB0YXJnZXQgYWRkcmVzcw0KICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50DQoNCiAgICAgICAgQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2UgaWYgaXQgd2Fzbid0DQogICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHB1YmxpYyB0cmFuc2ZlcnNBbGxvd2VkIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBhc3NlcnQoc3VwZXIudHJhbnNmZXIoX3RvLCBfdmFsdWUpKTsNCg0KICAgICAgICAvLyB0cmFuc2ZlcnJpbmcgdG8gdGhlIGNvbnRyYWN0IGFkZHJlc3MgZGVzdHJveXMgdG9rZW5zDQogICAgICAgIGlmIChfdG8gPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgICAgICAgYmFsYW5jZU9mW190b10gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgdG90YWxTdXBwbHkgLT0gX3ZhbHVlOw0KICAgICAgICAgICAgRGVzdHJ1Y3Rpb24oX3ZhbHVlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IGFuIGFjY291bnQvY29udHJhY3QgYXR0ZW1wdHMgdG8gZ2V0IHRoZSBjb2lucw0KICAgICAgICB0aHJvd3Mgb24gYW55IGVycm9yIHJhdGhlciB0aGVuIHJldHVybiBhIGZhbHNlIGZsYWcgdG8gbWluaW1pemUgdXNlciBlcnJvcnMNCiAgICAgICAgbm90ZSB0aGF0IHdoZW4gdHJhbnNmZXJyaW5nIHRvIHRoZSBzbWFydCB0b2tlbidzIGFkZHJlc3MsIHRoZSBjb2lucyBhcmUgYWN0dWFsbHkgZGVzdHJveWVkDQoNCiAgICAgICAgQHBhcmFtIF9mcm9tICAgIHNvdXJjZSBhZGRyZXNzDQogICAgICAgIEBwYXJhbSBfdG8gICAgICB0YXJnZXQgYWRkcmVzcw0KICAgICAgICBAcGFyYW0gX3ZhbHVlICAgdHJhbnNmZXIgYW1vdW50DQoNCiAgICAgICAgQHJldHVybiB0cnVlIGlmIHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2UgaWYgaXQgd2Fzbid0DQogICAgKi8NCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgdHJhbnNmZXJzQWxsb3dlZCByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYXNzZXJ0KHN1cGVyLnRyYW5zZmVyRnJvbShfZnJvbSwgX3RvLCBfdmFsdWUpKTsNCg0KICAgICAgICAvLyB0cmFuc2ZlcnJpbmcgdG8gdGhlIGNvbnRyYWN0IGFkZHJlc3MgZGVzdHJveXMgdG9rZW5zDQogICAgICAgIGlmIChfdG8gPT0gYWRkcmVzcyh0aGlzKSkgew0KICAgICAgICAgICAgYmFsYW5jZU9mW190b10gLT0gX3ZhbHVlOw0KICAgICAgICAgICAgdG90YWxTdXBwbHkgLT0gX3ZhbHVlOw0KICAgICAgICAgICAgRGVzdHJ1Y3Rpb24oX3ZhbHVlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0='