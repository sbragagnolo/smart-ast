base 64 content
base64solarDaoTokenCrowdsale
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMzsNCg0KDQogLy8vIEB0aXRsZSBTYWZlTWF0aCBjb250cmFjdCAtIG1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MNCmNvbnRyYWN0IFNhZmVNYXRoIHsNCiAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPiAwKTsNCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSArIGI7DQogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIHJlcXVpcmUoYXNzZXJ0aW9uKTsNCiAgfQ0KfQ0KDQoNCg0KIC8vLyBAdGl0bGUgT3duYWJsZSBjb250cmFjdCAtIGJhc2UgY29udHJhY3Qgd2l0aCBhbiBvd25lcg0KY29udHJhY3QgT3duYWJsZSB7DQogIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7DQogICAgXzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyT3duZXJzaGlwKGFkZHJlc3MgbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgaWYgKG5ld093bmVyICE9IGFkZHJlc3MoMCkpIHsNCiAgICAgIG93bmVyID0gbmV3T3duZXI7DQogICAgfQ0KICB9DQp9DQoNCg0KLy8vIEB0aXRsZSBIYWx0YWJsZSBjb250cmFjdCAtIGFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQovLy8gT3JpZ2luYWxseSBlbnZpc2lvbmVkIGluIEZpcnN0Qmxvb2QgSUNPIGNvbnRyYWN0Lg0KY29udHJhY3QgSGFsdGFibGUgaXMgT3duYWJsZSB7DQogIGJvb2wgcHVibGljIGhhbHRlZDsNCg0KICBtb2RpZmllciBzdG9wSW5FbWVyZ2VuY3kgew0KICAgIHJlcXVpcmUoIWhhbHRlZCk7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlJbkVtZXJnZW5jeSB7DQogICAgcmVxdWlyZShoYWx0ZWQpOw0KICAgIF87DQogIH0NCg0KICAvLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUNCiAgZnVuY3Rpb24gaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciB7DQogICAgaGFsdGVkID0gdHJ1ZTsNCiAgfQ0KDQogIC8vLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlDQogIGZ1bmN0aW9uIHVuaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIGhhbHRlZCA9IGZhbHNlOw0KICB9DQp9DQoNCg0KDQoNCiAvLy8gQHRpdGxlIEVSQzIwIGludGVyZmFjZSBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwDQpjb250cmFjdCBFUkMyMCB7DQogIHVpbnQgcHVibGljIHRvdGFsU3VwcGx5Ow0KICBmdW5jdGlvbiBiYWxhbmNlT2YoYWRkcmVzcyB3aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCiAgZnVuY3Rpb24gbWludChhZGRyZXNzIHJlY2VpdmVyLCB1aW50IGFtb3VudCk7DQogIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgdG8sIHVpbnQgdmFsdWUpIHJldHVybnMgKGJvb2wgb2spOw0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIHNwZW5kZXIsIHVpbnQgdmFsdWUpIHJldHVybnMgKGJvb2wgb2spOw0KICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsNCiAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIG93bmVyLCBhZGRyZXNzIGluZGV4ZWQgc3BlbmRlciwgdWludCB2YWx1ZSk7DQp9DQoNCg0KDQovLy8gQHRpdGxlIFNvbGFyRGFvVG9rZW4gY29udHJhY3QgLSBzdGFuZGFyZCBFUkMyMCB0b2tlbiB3aXRoIFNob3J0IEhhbmQgQXR0YWNrIGFuZCBhcHByb3ZlKCkgcmFjZSBjb25kaXRpb24gbWl0aWdhdGlvbi4NCmNvbnRyYWN0IFNvbGFyRGFvVG9rZW4gaXMgU2FmZU1hdGgsIEVSQzIwLCBPd25hYmxlIHsNCiBzdHJpbmcgcHVibGljIG5hbWUgPSAiU29sYXIgREFPIFRva2VuIjsNCiBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJTREFPIjsNCiB1aW50IHB1YmxpYyBkZWNpbWFscyA9IDQ7DQoNCiAvLy8gY29udHJhY3QgdGhhdCBpcyBhbGxvd2VkIHRvIGNyZWF0ZSBuZXcgdG9rZW5zIGFuZCBhbGxvd3MgdW5saWZ0IHRoZSB0cmFuc2ZlciBsaW1pdHMgb24gdGhpcyB0b2tlbg0KIGFkZHJlc3MgcHVibGljIGNyb3dkc2FsZUFnZW50Ow0KIC8vLyBBIGNyb3dkc2FsZSBjb250cmFjdCBjYW4gcmVsZWFzZSB1cyB0byB0aGUgd2lsZCBpZiBJQ08gc3VjY2Vzcy4gSWYgZmFsc2Ugd2UgYXJlIGFyZSBpbiB0cmFuc2ZlciBsb2NrIHVwIHBlcmlvZC4NCiBib29sIHB1YmxpYyByZWxlYXNlZCA9IGZhbHNlOw0KIC8vLyBhcHByb3ZlKCkgYWxsb3dhbmNlcw0KIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCiAvLy8gaG9sZGVyIGJhbGFuY2VzDQogbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KDQogLy8vIEBkZXYgTGltaXQgdG9rZW4gdHJhbnNmZXIgdW50aWwgdGhlIGNyb3dkc2FsZSBpcyBvdmVyLg0KIG1vZGlmaWVyIGNhblRyYW5zZmVyKCkgew0KICAgaWYoIXJlbGVhc2VkKSB7DQogICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFnZW50KTsNCiAgIH0NCiAgIF87DQogfQ0KDQogLy8vIEBkZXYgVGhlIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgb25seSBiZWZvcmUgb3IgYWZ0ZXIgdGhlIHRva2VucyBoYXZlIGJlZW4gcmVsZWFzZXNkDQogLy8vIEBwYXJhbSBfcmVsZWFzZWQgdG9rZW4gdHJhbnNmZXIgYW5kIG1pbnQgc3RhdGUNCiBtb2RpZmllciBpblJlbGVhc2VTdGF0ZShib29sIF9yZWxlYXNlZCkgew0KICAgcmVxdWlyZShfcmVsZWFzZWQgPT0gcmVsZWFzZWQpOw0KICAgXzsNCiB9DQoNCiAvLy8gQGRldiBUaGUgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBvbmx5IGJ5IHJlbGVhc2UgYWdlbnQuDQogbW9kaWZpZXIgb25seUNyb3dkc2FsZUFnZW50KCkgew0KICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFnZW50KTsNCiAgIF87DQogfQ0KDQogLy8vIEBkZXYgRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgaHR0cDovL3Zlc3NlbmVzLmNvbS90aGUtZXJjMjAtc2hvcnQtYWRkcmVzcy1hdHRhY2stZXhwbGFpbmVkLw0KIC8vLyBAcGFyYW0gc2l6ZSBwYXlsb2FkIHNpemUNCiBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7DQogICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOw0KICAgIF87DQogfQ0KDQogLy8vIEBkZXYgTWFrZSBzdXJlIHdlIGFyZSBub3QgZG9uZSB5ZXQuDQogbW9kaWZpZXIgY2FuTWludCgpIHsNCiAgICByZXF1aXJlKCFyZWxlYXNlZCk7DQogICAgXzsNCiAgfQ0KDQogLy8vIEBkZXYgQ29uc3RydWN0b3INCiBmdW5jdGlvbiBTb2xhckRhb1Rva2VuKCkgew0KICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KIH0NCg0KIC8vLyBGYWxsYmFjayBtZXRob2Qgd2lsbCBidXlvdXQgdG9rZW5zDQogZnVuY3Rpb24oKSBwYXlhYmxlIHsNCiAgIHJldmVydCgpOw0KIH0NCg0KIC8vLyBAZGV2IENyZWF0ZSBuZXcgdG9rZW5zIGFuZCBhbGxvY2F0ZSB0aGVtIHRvIGFuIGFkZHJlc3MuIE9ubHkgY2FsbGFibHkgYnkgYSBjcm93ZHNhbGUgY29udHJhY3QNCiAvLy8gQHBhcmFtIHJlY2VpdmVyIEFkZHJlc3Mgb2YgcmVjZWl2ZXINCiAvLy8gQHBhcmFtIGFtb3VudCAgTnVtYmVyIG9mIHRva2VucyB0byBpc3N1ZS4NCiBmdW5jdGlvbiBtaW50KGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KSBvbmx5Q3Jvd2RzYWxlQWdlbnQgY2FuTWludCBwdWJsaWMgew0KICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSwgYW1vdW50KTsNCiAgICBiYWxhbmNlc1tyZWNlaXZlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW3JlY2VpdmVyXSwgYW1vdW50KTsNCiAgICBUcmFuc2ZlcigwLCByZWNlaXZlciwgYW1vdW50KTsNCiB9DQoNCiAvLy8gQGRldiBTZXQgdGhlIGNvbnRyYWN0IHRoYXQgY2FuIGNhbGwgcmVsZWFzZSBhbmQgbWFrZSB0aGUgdG9rZW4gdHJhbnNmZXJhYmxlLg0KIC8vLyBAcGFyYW0gX2Nyb3dkc2FsZUFnZW50IGNyb3dkc2FsZSBjb250cmFjdCBhZGRyZXNzDQogZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlQWdlbnQoYWRkcmVzcyBfY3Jvd2RzYWxlQWdlbnQpIG9ubHlPd25lciBpblJlbGVhc2VTdGF0ZShmYWxzZSkgcHVibGljIHsNCiAgIGNyb3dkc2FsZUFnZW50ID0gX2Nyb3dkc2FsZUFnZW50Ow0KIH0NCiAvLy8gQGRldiBPbmUgd2F5IGZ1bmN0aW9uIHRvIHJlbGVhc2UgdGhlIHRva2VucyB0byB0aGUgd2lsZC4gQ2FuIGJlIGNhbGxlZCBvbmx5IGZyb20gdGhlIHJlbGVhc2UgYWdlbnQgdGhhdCBpcyB0aGUgZmluYWwgSUNPIGNvbnRyYWN0LiBJdCBpcyBvbmx5IGNhbGxlZCBpZiB0aGUgY3Jvd2RzYWxlIGhhcyBiZWVuIHN1Y2Nlc3MgKGZpcnN0IG1pbGVzdG9uZSByZWFjaGVkKS4NCiBmdW5jdGlvbiByZWxlYXNlVG9rZW5UcmFuc2ZlcigpIHB1YmxpYyBvbmx5Q3Jvd2RzYWxlQWdlbnQgew0KICAgcmVsZWFzZWQgPSB0cnVlOw0KIH0NCiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyB0byBhZGRyZXNzDQogLy8vIEBwYXJhbSBfdG8gZGVzdCBhZGRyZXNzDQogLy8vIEBwYXJhbSBfdmFsdWUgdG9rZW5zIGFtb3VudA0KIC8vLyBAcmV0dXJuIHRyYW5zZmVyIHJlc3VsdA0KIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgY2FuVHJhbnNmZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOw0KDQogICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICByZXR1cm4gdHJ1ZTsNCiB9DQoNCiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIG90aGVyDQogLy8vIEBwYXJhbSBfZnJvbSBzb3VyY2UgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3RvIGRlc3QgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQNCiAvLy8gQHJldHVybiB0cmFuc2ZlciByZXN1bHQNCiBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQoNCiAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOw0KICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc2FmZVN1YihfYWxsb3dhbmNlLCBfdmFsdWUpOw0KICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogfQ0KIC8vLyBAZGV2IFRva2VucyBiYWxhbmNlDQogLy8vIEBwYXJhbSBfb3duZXIgaG9sZGVyIGFkZHJlc3MNCiAvLy8gQHJldHVybiBiYWxhbmNlIGFtb3VudA0KIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7DQogICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCiB9DQoNCiAvLy8gQGRldiBBcHByb3ZlIHRyYW5zZmVyDQogLy8vIEBwYXJhbSBfc3BlbmRlciBob2xkZXIgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQNCiAvLy8gQHJldHVybiByZXN1bHQNCiBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgDQogICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdA0KICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkNCiAgIHJlcXVpcmUgKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsNCg0KICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgIHJldHVybiB0cnVlOw0KIH0NCg0KIC8vLyBAZGV2IFRva2VuIGFsbG93YW5jZQ0KIC8vLyBAcGFyYW0gX293bmVyIGhvbGRlciBhZGRyZXNzDQogLy8vIEBwYXJhbSBfc3BlbmRlciBzcGVuZGVyIGFkZHJlc3MNCiAvLy8gQHJldHVybiByZW1haW4gYW1vdW50DQogZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgew0KICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogfQ0KfQ0KLy8vIEB0aXRsZSBLaWxsYWJsZSBjb250cmFjdCAtIGJhc2UgY29udHJhY3QgdGhhdCBjYW4gYmUga2lsbGVkIGJ5IG93bmVyLiBBbGwgZnVuZHMgaW4gY29udHJhY3Qgd2lsbCBiZSBzZW50IHRvIHRoZSBvd25lci4NCmNvbnRyYWN0IEtpbGxhYmxlIGlzIE93bmFibGUgew0KIGZ1bmN0aW9uIGtpbGwoKSBvbmx5T3duZXIgew0KICAgc2VsZmRlc3RydWN0KG93bmVyKTsNCiB9DQp9DQoNCg0KLy8vIEB0aXRsZSBTb2xhckRhb1Rva2VuQ3Jvd2RzYWxlIGNvbnRyYWN0IC0gY29udHJhY3QgZm9yIHRva2VuIHNhbGVzLg0KY29udHJhY3QgU29sYXJEYW9Ub2tlbkNyb3dkc2FsZSBpcyBIYWx0YWJsZSwgS2lsbGFibGUsIFNhZmVNYXRoIHsNCg0KICAvLy8gUHJlZnVuZGluZyBnb2FsIGluIFVTRCBjZW50cywgaWYgdGhlIHByZWZ1bmRpbmcgZ29hbCBpcyByZWFjaGVkLCBpY28gd2lsbCBzdGFydA0KICB1aW50IHB1YmxpYyBjb25zdGFudCBQUkVfRlVORElOR19HT0FMID0gNGU2ICogUFJJQ0U7DQoNCiAgLy8vIFRva2VucyBmdW5kaW5nIGdvYWwgaW4gVVNEIGNlbnRzLCBpZiB0aGUgZnVuZGluZyBnb2FsIGlzIHJlYWNoZWQsIGljbyB3aWxsIHN0b3ANCiAgdWludCBwdWJsaWMgY29uc3RhbnQgSUNPX0dPQUwgPSA4ZTcgKiBQUklDRTsNCg0KICAvLy8gTWltaW5hbCB0b2tlbnMgZnVuZGluZyBnb2FsIGluIFVTRCBjZW50cywgaWYgdGhpcyBnb2FsIGlzbid0IHJlYWNoZWQgZHVyaW5nIElDTywgcmVmdW5kIHdpbGwgYmVnaW4NCiAgdWludCBwdWJsaWMgY29uc3RhbnQgTUlOX0lDT19HT0FMID0gMWU3Ow0KDQogIC8vLyBQZXJjZW50IG9mIGJvbnVzIHRva2VucyB0ZWFtIHJlY2VpdmVzIGZyb20gZWFjaCBpbnZlc3RtZW50DQogIHVpbnQgcHVibGljIGNvbnN0YW50IFRFQU1fQk9OVVNfUEVSQ0VOVCA9IDI1Ow0KDQogIC8vLyBUaGUgdG9rZW4gcHJpY2UgaW4gVVNEIGNlbnRzDQogIHVpbnQgY29uc3RhbnQgcHVibGljIFBSSUNFID0gMTAwOw0KDQogIC8vLyBEdXJhdGlvbiBvZiB0aGUgcHJlLUlDTyBzdGFnZQ0KICB1aW50IGNvbnN0YW50IHB1YmxpYyBQUkVfSUNPX0RVUkFUSU9OID0gNSB3ZWVrczsNCg0KICAvLy8gVGhlIHRva2VuIHdlIGFyZSBzZWxsaW5nDQogIFNvbGFyRGFvVG9rZW4gcHVibGljIHRva2VuOw0KDQogIC8vLyB0b2tlbnMgd2lsbCBiZSB0cmFuc2ZlcmVkIGZyb20gdGhpcyBhZGRyZXNzDQogIGFkZHJlc3MgcHVibGljIG11bHRpc2lnV2FsbGV0Ow0KDQogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgc3RhcnQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlDQogIHVpbnQgcHVibGljIHN0YXJ0c0F0Ow0KDQogIC8vLyB0aGUgVU5JWCB0aW1lc3RhbXAgZW5kIGRhdGUgb2YgdGhlIGNyb3dkc2FsZQ0KICB1aW50IHB1YmxpYyBlbmRzQXQ7DQoNCiAgLy8vIHRoZSBVTklYIHRpbWVzdGFtcCBzdGFydCBkYXRlIG9mIHRoZSBwcmUgaW52ZXN0IGNyb3dkc2FsZQ0KICB1aW50IHB1YmxpYyBwcmVJbnZlc3RTdGFydDsNCg0KICAvLy8gdGhlIG51bWJlciBvZiB0b2tlbnMgYWxyZWFkeSBzb2xkIHRocm91Z2ggdGhpcyBjb250cmFjdA0KICB1aW50IHB1YmxpYyB0b2tlbnNTb2xkID0gMDsNCg0KICAvLy8gSG93IG1hbnkgd2VpIG9mIGZ1bmRpbmcgd2UgaGF2ZSByYWlzZWQNCiAgdWludCBwdWJsaWMgd2VpUmFpc2VkID0gMDsNCg0KICAvLy8gSG93IG1hbnkgZGlzdGluY3QgYWRkcmVzc2VzIGhhdmUgaW52ZXN0ZWQNCiAgdWludCBwdWJsaWMgaW52ZXN0b3JDb3VudCA9IDA7DQoNCiAgLy8vIEhvdyBtdWNoIHdlaSB3ZSBoYXZlIHJldHVybmVkIGJhY2sgdG8gdGhlIGNvbnRyYWN0IGFmdGVyIGEgZmFpbGVkIGNyb3dkZnVuZC4NCiAgdWludCBwdWJsaWMgbG9hZGVkUmVmdW5kID0gMDsNCg0KICAvLy8gSG93IG11Y2ggd2VpIHdlIGhhdmUgZ2l2ZW4gYmFjayB0byBpbnZlc3RvcnMuDQogIHVpbnQgcHVibGljIHdlaVJlZnVuZGVkID0gMDsNCg0KICAvLy8gSGFzIHRoaXMgY3Jvd2RzYWxlIGJlZW4gZmluYWxpemVkDQogIGJvb2wgcHVibGljIGZpbmFsaXplZDsNCg0KICAvLy8gVVNEIHRvIEV0aGVyIHJhdGUgaW4gY2VudHMNCiAgdWludCBwdWJsaWMgZXhjaGFuZ2VSYXRlOw0KDQogIC8vLyBleGNoYW5nZVJhdGUgdGltZXN0YW1wDQogIHVpbnQgcHVibGljIGV4Y2hhbmdlUmF0ZVRpbWVzdGFtcDsNCg0KICAvLy8gRXh0ZXJuYWwgYWdlbnQgdGhhdCB3aWxsIGNhbiBjaGFuZ2UgZXhjaGFuZ2UgcmF0ZQ0KICBhZGRyZXNzIHB1YmxpYyBleGNoYW5nZVJhdGVBZ2VudDsNCg0KICAvLy8gSG93IG11Y2ggRVRIIGVhY2ggYWRkcmVzcyBoYXMgaW52ZXN0ZWQgdG8gdGhpcyBjcm93ZHNhbGUNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgaW52ZXN0ZWRBbW91bnRPZjsNCg0KICAvLy8gSG93IG11Y2ggdG9rZW5zIHRoaXMgY3Jvd2RzYWxlIGhhcyBjcmVkaXRlZCBmb3IgZWFjaCBpbnZlc3RvciBhZGRyZXNzDQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIHRva2VuQW1vdW50T2Y7DQoNCiAgLy8vIERlZmluZSBwcmVJQ08gcHJpY2luZyBzY2hlZHVsZSB1c2luZyBtaWxlc3RvbmVzLg0KICBzdHJ1Y3QgTWlsZXN0b25lIHsNCiAgICAgIC8vIFVOSVggdGltZXN0YW1wIHdoZW4gdGhpcyBtaWxlc3RvbmUga2lja3MgaW4NCiAgICAgIHVpbnQgc3RhcnQ7DQogICAgICAvLyBVTklYIHRpbWVzdGFtcCB3aGVuIHRoaXMgbWlsZXN0b25lIGtpY2tzIG91dA0KICAgICAgdWludCBlbmQ7DQogICAgICAvLyBIb3cgbWFueSAlIHRva2VucyB3aWxsIGFkZA0KICAgICAgdWludCBib251czsNCiAgfQ0KDQogIE1pbGVzdG9uZVtdIHB1YmxpYyBtaWxlc3RvbmVzOw0KDQogIC8vLyBTdGF0ZSBtYWNoaW5lDQogIC8vLyBQcmVwYXJpbmc6IEFsbCBjb250cmFjdCBpbml0aWFsaXphdGlvbiBjYWxscyBhbmQgdmFyaWFibGVzIGhhdmUgbm90IGJlZW4gc2V0IHlldA0KICAvLy8gUHJlZnVuZGluZzogV2UgaGF2ZSBub3QgcGFzc2VkIHN0YXJ0IHRpbWUgeWV0DQogIC8vLyBGdW5kaW5nOiBBY3RpdmUgY3Jvd2RzYWxlDQogIC8vLyBTdWNjZXNzOiBNaW5pbXVtIGZ1bmRpbmcgZ29hbCByZWFjaGVkDQogIC8vLyBGYWlsdXJlOiBNaW5pbXVtIGZ1bmRpbmcgZ29hbCBub3QgcmVhY2hlZCBiZWZvcmUgZW5kaW5nIHRpbWUNCiAgLy8vIEZpbmFsaXplZDogVGhlIGZpbmFsaXplZCBoYXMgYmVlbiBjYWxsZWQgYW5kIHN1Y2Nlc2Z1bGx5IGV4ZWN1dGVkXA0KICAvLy8gUmVmdW5kaW5nOiBSZWZ1bmRzIGFyZSBsb2FkZWQgb24gdGhlIGNvbnRyYWN0IGZvciByZWNsYWltLg0KICBlbnVtIFN0YXRle1Vua25vd24sIFByZXBhcmluZywgUHJlRnVuZGluZywgRnVuZGluZywgU3VjY2VzcywgRmFpbHVyZSwgRmluYWxpemVkLCBSZWZ1bmRpbmd9DQoNCiAgLy8vIEEgbmV3IGludmVzdG1lbnQgd2FzIG1hZGUNCiAgZXZlbnQgSW52ZXN0ZWQoYWRkcmVzcyBpbnZlc3RvciwgdWludCB3ZWlBbW91bnQsIHVpbnQgdG9rZW5BbW91bnQpOw0KICAvLy8gUmVmdW5kIHdhcyBwcm9jZXNzZWQgZm9yIGEgY29udHJpYnV0b3INCiAgZXZlbnQgUmVmdW5kKGFkZHJlc3MgaW52ZXN0b3IsIHVpbnQgd2VpQW1vdW50KTsNCiAgLy8vIENyb3dkc2FsZSBlbmQgdGltZSBoYXMgYmVlbiBjaGFuZ2VkDQogIGV2ZW50IEVuZHNBdENoYW5nZWQodWludCBlbmRzQXQpOw0KICAvLy8gQ2FsY3VsYXRlZCBuZXcgcHJpY2UNCiAgZXZlbnQgRXhjaGFuZ2VSYXRlQ2hhbmdlZCh1aW50IG9sZFZhbHVlLCB1aW50IG5ld1ZhbHVlKTsNCg0KICAvLy8gQGRldiBNb2RpZmllZCBhbGxvd2luZyBleGVjdXRpb24gb25seSBpZiB0aGUgY3Jvd2RzYWxlIGlzIGN1cnJlbnRseSBydW5uaW5nDQogIG1vZGlmaWVyIGluU3RhdGUoU3RhdGUgc3RhdGUpIHsNCiAgICByZXF1aXJlKGdldFN0YXRlKCkgPT0gc3RhdGUpOw0KICAgIF87DQogIH0NCg0KICBtb2RpZmllciBvbmx5RXhjaGFuZ2VSYXRlQWdlbnQoKSB7DQogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGV4Y2hhbmdlUmF0ZUFnZW50KTsNCiAgICBfOw0KICB9DQoNCiAgLy8vIEBkZXYgQ29uc3RydWN0b3INCiAgLy8vIEBwYXJhbSBfdG9rZW4gU29sYXIgRGFvIHRva2VuIGFkZHJlc3MNCiAgLy8vIEBwYXJhbSBfbXVsdGlzaWdXYWxsZXQgdGVhbSB3YWxsZXQNCiAgLy8vIEBwYXJhbSBfcHJlSW52ZXN0U3RhcnQgcHJlSUNPIHN0YXJ0IGRhdGUNCiAgLy8vIEBwYXJhbSBfc3RhcnQgdG9rZW4gSUNPIHN0YXJ0IGRhdGUNCiAgLy8vIEBwYXJhbSBfZW5kIHRva2VuIElDTyBlbmQgZGF0ZQ0KICBmdW5jdGlvbiBTb2xhckRhb1Rva2VuQ3Jvd2RzYWxlKGFkZHJlc3MgX3Rva2VuLCBhZGRyZXNzIF9tdWx0aXNpZ1dhbGxldCwgdWludCBfcHJlSW52ZXN0U3RhcnQsIHVpbnQgX3N0YXJ0LCB1aW50IF9lbmQpIHsNCiAgICByZXF1aXJlKF9tdWx0aXNpZ1dhbGxldCAhPSAwKTsNCiAgICByZXF1aXJlKF9wcmVJbnZlc3RTdGFydCAhPSAwKTsNCiAgICByZXF1aXJlKF9zdGFydCAhPSAwKTsNCiAgICByZXF1aXJlKF9lbmQgIT0gMCk7DQogICAgcmVxdWlyZShfc3RhcnQgPCBfZW5kKTsNCiAgICByZXF1aXJlKF9lbmQgPiBfcHJlSW52ZXN0U3RhcnQgKyBQUkVfSUNPX0RVUkFUSU9OKTsNCg0KICAgIHRva2VuID0gU29sYXJEYW9Ub2tlbihfdG9rZW4pOw0KDQogICAgbXVsdGlzaWdXYWxsZXQgPSBfbXVsdGlzaWdXYWxsZXQ7DQogICAgc3RhcnRzQXQgPSBfc3RhcnQ7DQogICAgZW5kc0F0ID0gX2VuZDsNCiAgICBwcmVJbnZlc3RTdGFydCA9IF9wcmVJbnZlc3RTdGFydDsNCg0KICAgIHZhciBwcmVJY29Cb251c2VzID0gW3VpbnQoMTAwKSwgODAsIDcwLCA2MCwgNTBdOw0KICAgIGZvciAodWludCBpID0gMDsgaSA8IHByZUljb0JvbnVzZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUocHJlSW52ZXN0U3RhcnQgKyBpICogMSB3ZWVrcywgcHJlSW52ZXN0U3RhcnQgKyAoaSArIDEpICogMSB3ZWVrcywgcHJlSWNvQm9udXNlc1tpXSkpOw0KICAgIH0NCiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHN0YXJ0c0F0LCBzdGFydHNBdCArIDQgZGF5cywgMjUpKTsNCiAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHN0YXJ0c0F0ICsgNCBkYXlzLCBzdGFydHNBdCArIDEgd2Vla3MsIDIwKSk7DQogICAgZGVsZXRlIHByZUljb0JvbnVzZXM7DQoNCiAgICB2YXIgaWNvQm9udXNlcyA9IFt1aW50KDE1KSwgMTAsIDVdOw0KICAgIGZvciAoaSA9IDE7IGkgPD0gaWNvQm9udXNlcy5sZW5ndGg7IGkrKykgew0KICAgICAgbWlsZXN0b25lcy5wdXNoKE1pbGVzdG9uZShzdGFydHNBdCArIGkgKiAxIHdlZWtzLCBzdGFydHNBdCArIChpICsgMSkgKiAxIHdlZWtzLCBpY29Cb251c2VzW2kgLSAxXSkpOw0KICAgIH0NCiAgICBkZWxldGUgaWNvQm9udXNlczsNCiAgfQ0KDQogIGZ1bmN0aW9uKCkgcGF5YWJsZSB7DQogICAgYnV5KCk7DQogIH0NCg0KICAvLy8gQGRldiBHZXQgdGhlIGN1cnJlbnQgbWlsZXN0b25lIG9yIGJhaWwgb3V0IGlmIHdlIGFyZSBub3QgaW4gdGhlIG1pbGVzdG9uZSBwZXJpb2RzLg0KICAvLy8gQHJldHVybiBNaWxlc3RvbmUgY3VycmVudCBib251cyBtaWxlc3RvbmUNCiAgZnVuY3Rpb24gZ2V0Q3VycmVudE1pbGVzdG9uZSgpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoTWlsZXN0b25lKSB7DQogICAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCBtaWxlc3RvbmVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmIChtaWxlc3RvbmVzW2ldLnN0YXJ0IDw9IG5vdyAmJiBtaWxlc3RvbmVzW2ldLmVuZCA+IG5vdykgew0KICAgICAgICAgIHJldHVybiBtaWxlc3RvbmVzW2ldOw0KICAgICAgICB9DQogICAgICB9DQogIH0NCg0KICAgLy8vIEBkZXYgTWFrZSBhbiBpbnZlc3RtZW50LiBDcm93ZHNhbGUgbXVzdCBiZSBydW5uaW5nIGZvciBvbmUgdG8gaW52ZXN0Lg0KICAgLy8vIEBwYXJhbSByZWNlaXZlciBUaGUgRXRoZXJldW0gYWRkcmVzcyB3aG8gcmVjZWl2ZXMgdGhlIHRva2Vucw0KICBmdW5jdGlvbiBpbnZlc3RJbnRlcm5hbChhZGRyZXNzIHJlY2VpdmVyKSBzdG9wSW5FbWVyZ2VuY3kgcHJpdmF0ZSB7DQogICAgdmFyIHN0YXRlID0gZ2V0U3RhdGUoKTsNCiAgICByZXF1aXJlKHN0YXRlID09IFN0YXRlLkZ1bmRpbmcgfHwgc3RhdGUgPT0gU3RhdGUuUHJlRnVuZGluZyk7DQoNCiAgICB1aW50IHdlaUFtb3VudCA9IG1zZy52YWx1ZTsNCiAgICB1aW50IHRva2Vuc0Ftb3VudCA9IGNhbGN1bGF0ZVRva2Vucyh3ZWlBbW91bnQpOw0KICAgIGFzc2VydCAodG9rZW5zQW1vdW50ID4gMCk7DQoNCiAgICBpZihzdGF0ZSA9PSBTdGF0ZS5QcmVGdW5kaW5nKSB7DQogICAgICAgIHRva2Vuc0Ftb3VudCArPSBzYWZlRGl2KHNhZmVNdWwodG9rZW5zQW1vdW50LCBnZXRDdXJyZW50TWlsZXN0b25lKCkuYm9udXMpLCAxMDApOw0KICAgIH0NCg0KICAgIGlmKGludmVzdGVkQW1vdW50T2ZbcmVjZWl2ZXJdID09IDApIHsNCiAgICAgICAvLyBBIG5ldyBpbnZlc3Rvcg0KICAgICAgIGludmVzdG9yQ291bnQrKzsNCiAgICB9DQoNCiAgICAvLyBVcGRhdGUgaW52ZXN0b3INCiAgICBpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXSA9IHNhZmVBZGQoaW52ZXN0ZWRBbW91bnRPZltyZWNlaXZlcl0sIHdlaUFtb3VudCk7DQogICAgdG9rZW5BbW91bnRPZltyZWNlaXZlcl0gPSBzYWZlQWRkKHRva2VuQW1vdW50T2ZbcmVjZWl2ZXJdLCB0b2tlbnNBbW91bnQpOw0KICAgIC8vIFVwZGF0ZSB0b3RhbHMNCiAgICB3ZWlSYWlzZWQgPSBzYWZlQWRkKHdlaVJhaXNlZCwgd2VpQW1vdW50KTsNCiAgICB0b2tlbnNTb2xkID0gc2FmZUFkZCh0b2tlbnNTb2xkLCB0b2tlbnNBbW91bnQpOyAgIA0KDQogICAgYXNzaWduVG9rZW5zKHJlY2VpdmVyLCB0b2tlbnNBbW91bnQpOw0KICAgIHZhciB0ZWFtQm9udXNUb2tlbnMgPSBzYWZlRGl2KHNhZmVNdWwodG9rZW5zQW1vdW50LCBURUFNX0JPTlVTX1BFUkNFTlQpLCAxMDAgLSBURUFNX0JPTlVTX1BFUkNFTlQpOw0KICAgIGFzc2lnblRva2VucyhtdWx0aXNpZ1dhbGxldCwgdGVhbUJvbnVzVG9rZW5zKTsNCg0KICAgIG11bHRpc2lnV2FsbGV0LnRyYW5zZmVyKHdlaUFtb3VudCk7DQogICAgLy8gVGVsbCB1cyBpbnZlc3Qgd2FzIHN1Y2Nlc3MNCiAgICBJbnZlc3RlZChyZWNlaXZlciwgd2VpQW1vdW50LCB0b2tlbnNBbW91bnQpOw0KICB9DQoNCiAgLy8vIEBkZXYgQWxsb3cgYW5vbnltb3VzIGNvbnRyaWJ1dGlvbnMgdG8gdGhpcyBjcm93ZHNhbGUuDQogIC8vLyBAcGFyYW0gcmVjZWl2ZXIgVGhlIEV0aGVyZXVtIGFkZHJlc3Mgd2hvIHJlY2VpdmVzIHRoZSB0b2tlbnMNCiAgZnVuY3Rpb24gaW52ZXN0KGFkZHJlc3MgcmVjZWl2ZXIpIHB1YmxpYyBwYXlhYmxlIHsNCiAgICBpbnZlc3RJbnRlcm5hbChyZWNlaXZlcik7DQogIH0NCg0KICAvLy8gQGRldiBUaGUgYmFzaWMgZW50cnkgcG9pbnQgdG8gcGFydGljaXBhdGUgdGhlIGNyb3dkc2FsZSBwcm9jZXNzLg0KICBmdW5jdGlvbiBidXkoKSBwdWJsaWMgcGF5YWJsZSB7DQogICAgaW52ZXN0KG1zZy5zZW5kZXIpOw0KICB9DQoNCiAgLy8vIEBkZXYgRmluYWxpemUgYSBzdWNjY2VzZnVsIGNyb3dkc2FsZS4NCiAgZnVuY3Rpb24gZmluYWxpemUoKSBwdWJsaWMgaW5TdGF0ZShTdGF0ZS5TdWNjZXNzKSBvbmx5T3duZXIgc3RvcEluRW1lcmdlbmN5IHsNCiAgICByZXF1aXJlKCFmaW5hbGl6ZWQpOw0KDQogICAgZmluYWxpemVkID0gdHJ1ZTsNCiAgICBmaW5hbGl6ZUNyb3dkc2FsZSgpOw0KICB9DQoNCiAgLy8vIEBkZXYgRmluYWxpemUgYSBzdWNjY2VzZnVsIGNyb3dkc2FsZS4NCiAgZnVuY3Rpb24gZmluYWxpemVDcm93ZHNhbGUoKSBpbnRlcm5hbCB7ICAgIA0KICAgIHRva2VuLnJlbGVhc2VUb2tlblRyYW5zZmVyKCk7DQogIH0NCg0KICAgLy8vIEBkZXYgTWV0aG9kIGZvciBzZXR0aW5nIFVTRCB0byBFdGhlciByYXRlIGZyb20gUG9sb25pZXgNCiAgIC8vLyBAcGFyYW0gdmFsdWUgVVNEIGFtb3V0IGluIGNlbnRzIGZvciAxIEV0aGVyDQogICAvLy8gQHBhcmFtIHRpbWUgdGltZXN0YW1wDQogIGZ1bmN0aW9uIHNldEV4Y2hhbmdlUmF0ZSh1aW50IHZhbHVlLCB1aW50IHRpbWUpIG9ubHlFeGNoYW5nZVJhdGVBZ2VudCB7DQogICAgcmVxdWlyZSh2YWx1ZSA+IDApOw0KICAgIHJlcXVpcmUodGltZSA+IDApOw0KICAgIHJlcXVpcmUoZXhjaGFuZ2VSYXRlVGltZXN0YW1wID09IDAgfHwgZ2V0RGlmZmVyZW5jZShpbnQodGltZSksIGludChub3cpKSA8PSAxIG1pbnV0ZXMpOw0KICAgIHJlcXVpcmUoZXhjaGFuZ2VSYXRlID09IDAgfHwgKGdldERpZmZlcmVuY2UoaW50KHZhbHVlKSwgaW50KGV4Y2hhbmdlUmF0ZSkpICogMTAwIC8gZXhjaGFuZ2VSYXRlIDw9IDMwKSk7DQoNCiAgICBFeGNoYW5nZVJhdGVDaGFuZ2VkKGV4Y2hhbmdlUmF0ZSwgdmFsdWUpOw0KICAgIGV4Y2hhbmdlUmF0ZSA9IHZhbHVlOw0KICAgIGV4Y2hhbmdlUmF0ZVRpbWVzdGFtcCA9IHRpbWU7DQogIH0NCg0KICAvLy8gQGRldiBNZXRob2Qgc2V0IGV4Y2hhbmdlIHJhdGUgYWdlbnQNCiAgLy8vIEBwYXJhbSBuZXdBZ2VudCBuZXcgYWdlbnQNCiBmdW5jdGlvbiBzZXRFeGNoYW5nZVJhdGVBZ2VudChhZGRyZXNzIG5ld0FnZW50KSBvbmx5T3duZXIgew0KICAgaWYgKG5ld0FnZW50ICE9IGFkZHJlc3MoMCkpIHsNCiAgICAgZXhjaGFuZ2VSYXRlQWdlbnQgPSBuZXdBZ2VudDsNCiAgIH0NCiB9DQogDQogIC8vLyBAZGV2IE1ldGhvZCBzZXQgZGF0YSBmcm9tIG1pZ3JhdGVkIGNvbnRyYWN0DQogIC8vLyBAcGFyYW0gX3Rva2Vuc1NvbGQgdG9rZW5zIHNvbGQNCiAgLy8vIEBwYXJhbSBfd2VpUmFpc2VkIF93ZWkgcmFpc2VkDQogIC8vLyBAcGFyYW0gX2ludmVzdG9yQ291bnQgaW52ZXN0b3IgY291bnQNCiBmdW5jdGlvbiBzZXRDcm93ZHNhbGVEYXRhKHVpbnQgX3Rva2Vuc1NvbGQsIHVpbnQgX3dlaVJhaXNlZCwgdWludCBfaW52ZXN0b3JDb3VudCkgb25seU93bmVyIHsgIA0KCXJlcXVpcmUoX3Rva2Vuc1NvbGQgPiAwKTsNCglyZXF1aXJlKF93ZWlSYWlzZWQgPiAwKTsNCglyZXF1aXJlKF9pbnZlc3RvckNvdW50ID4gMCk7DQoJDQoJdG9rZW5zU29sZCA9IF90b2tlbnNTb2xkOw0KCXdlaVJhaXNlZCA9IF93ZWlSYWlzZWQ7DQoJaW52ZXN0b3JDb3VudCA9IF9pbnZlc3RvckNvdW50OwkNCiB9DQoNCiAgZnVuY3Rpb24gZ2V0RGlmZmVyZW5jZShpbnQgb25lLCBpbnQgdHdvKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsNCiAgICB2YXIgZGlmZiA9IG9uZSAtIHR3bzsNCiAgICBpZiAoZGlmZiA8IDApDQogICAgICBkaWZmID0gLWRpZmY7DQogICAgcmV0dXJuIHVpbnQoZGlmZik7DQogIH0NCg0KICAvLy8gQGRldiBBbGxvdyBjcm93ZHNhbGUgb3duZXIgdG8gY2xvc2UgZWFybHkgb3IgZXh0ZW5kIHRoZSBjcm93ZHNhbGUuDQogIC8vLyBAcGFyYW0gdGltZSB0aW1lc3RhbXANCiAgZnVuY3Rpb24gc2V0RW5kc0F0KHVpbnQgdGltZSkgb25seU93bmVyIHsNCiAgICByZXF1aXJlKHRpbWUgPj0gbm93KTsNCiAgICBlbmRzQXQgPSB0aW1lOw0KICAgIEVuZHNBdENoYW5nZWQoZW5kc0F0KTsNCiAgfQ0KDQogIC8vLyBAZGV2IEFsbG93IGxvYWQgcmVmdW5kcyBiYWNrIG9uIHRoZSBjb250cmFjdCBmb3IgdGhlIHJlZnVuZGluZy4NCiAgZnVuY3Rpb24gbG9hZFJlZnVuZCgpIHB1YmxpYyBwYXlhYmxlIGluU3RhdGUoU3RhdGUuRmFpbHVyZSkgew0KICAgIHJlcXVpcmUobXNnLnZhbHVlID4gMCk7DQogICAgbG9hZGVkUmVmdW5kID0gc2FmZUFkZChsb2FkZWRSZWZ1bmQsIG1zZy52YWx1ZSk7DQogIH0NCg0KICAvLy8gQGRldiBJbnZlc3RvcnMgY2FuIGNsYWltIHJlZnVuZC4NCiAgZnVuY3Rpb24gcmVmdW5kKCkgcHVibGljIGluU3RhdGUoU3RhdGUuUmVmdW5kaW5nKSB7DQogICAgdWludDI1NiB3ZWlWYWx1ZSA9IGludmVzdGVkQW1vdW50T2ZbbXNnLnNlbmRlcl07DQogICAgaWYgKHdlaVZhbHVlID09IDApDQogICAgICByZXR1cm47DQogICAgaW52ZXN0ZWRBbW91bnRPZlttc2cuc2VuZGVyXSA9IDA7DQogICAgd2VpUmVmdW5kZWQgPSBzYWZlQWRkKHdlaVJlZnVuZGVkLCB3ZWlWYWx1ZSk7DQogICAgUmVmdW5kKG1zZy5zZW5kZXIsIHdlaVZhbHVlKTsNCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHdlaVZhbHVlKTsNCiAgfQ0KDQogIC8vLyBAZGV2IE1pbmltdW0gZ29hbCB3YXMgcmVhY2hlZA0KICAvLy8gQHJldHVybiB0cnVlIGlmIHRoZSBjcm93ZHNhbGUgaGFzIHJhaXNlZCBlbm91Z2ggbW9uZXkgdG8gbm90IGluaXRpYXRlIHRoZSByZWZ1bmRpbmcNCiAgZnVuY3Rpb24gaXNNaW5pbXVtR29hbFJlYWNoZWQoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCByZWFjaGVkKSB7DQogICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBNSU5fSUNPX0dPQUw7DQogIH0NCg0KICAvLy8gQGRldiBDaGVjayBpZiB0aGUgSUNPIGdvYWwgd2FzIHJlYWNoZWQuDQogIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIGNyb3dkc2FsZSBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBiZSBhIHN1Y2Nlc3MNCiAgZnVuY3Rpb24gaXNDcm93ZHNhbGVGdWxsKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsNCiAgICByZXR1cm4gd2VpVG9Vc2RDZW50cyh3ZWlSYWlzZWQpID49IElDT19HT0FMOw0KICB9DQoNCiAgLy8vIEBkZXYgQ3Jvd2RmdW5kIHN0YXRlIG1hY2hpbmUgbWFuYWdlbWVudC4NCiAgLy8vIEByZXR1cm4gU3RhdGUgY3VycmVudCBzdGF0ZQ0KICBmdW5jdGlvbiBnZXRTdGF0ZSgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChTdGF0ZSkgew0KICAgIGlmIChmaW5hbGl6ZWQpDQogICAgICByZXR1cm4gU3RhdGUuRmluYWxpemVkOw0KICAgIGlmIChhZGRyZXNzKHRva2VuKSA9PSAwIHx8IGFkZHJlc3MobXVsdGlzaWdXYWxsZXQpID09IDAgfHwgbm93IDwgcHJlSW52ZXN0U3RhcnQpDQogICAgICByZXR1cm4gU3RhdGUuUHJlcGFyaW5nOw0KICAgIGlmIChwcmVJbnZlc3RTdGFydCA8PSBub3cgJiYgbm93IDwgc3RhcnRzQXQgJiYgIWlzTWF4aW11bVByZUZ1bmRpbmdHb2FsUmVhY2hlZCgpKQ0KICAgICAgcmV0dXJuIFN0YXRlLlByZUZ1bmRpbmc7DQogICAgaWYgKG5vdyA8PSBlbmRzQXQgJiYgIWlzQ3Jvd2RzYWxlRnVsbCgpKQ0KICAgICAgcmV0dXJuIFN0YXRlLkZ1bmRpbmc7DQogICAgaWYgKGlzTWluaW11bUdvYWxSZWFjaGVkKCkpDQogICAgICByZXR1cm4gU3RhdGUuU3VjY2VzczsNCiAgICBpZiAoIWlzTWluaW11bUdvYWxSZWFjaGVkKCkgJiYgd2VpUmFpc2VkID4gMCAmJiBsb2FkZWRSZWZ1bmQgPj0gd2VpUmFpc2VkKQ0KICAgICAgcmV0dXJuIFN0YXRlLlJlZnVuZGluZzsNCiAgICByZXR1cm4gU3RhdGUuRmFpbHVyZTsNCiAgfQ0KDQogIC8vLyBAZGV2IENhbGN1bGF0aW5nIHRva2VucyBjb3VudA0KICAvLy8gQHBhcmFtIHdlaUFtb3VudCBpbnZlc3RlZA0KICAvLy8gQHJldHVybiB0b2tlbnMgYW1vdW50DQogIGZ1bmN0aW9uIGNhbGN1bGF0ZVRva2Vucyh1aW50IHdlaUFtb3VudCkgaW50ZXJuYWwgcmV0dXJucyAodWludCB0b2tlbkFtb3VudCkgew0KICAgIHZhciBtdWx0aXBsaWVyID0gMTAgKiogdG9rZW4uZGVjaW1hbHMoKTsNCg0KICAgIHVpbnQgdXNkQW1vdW50ID0gd2VpVG9Vc2RDZW50cyh3ZWlBbW91bnQpOw0KICAgIGFzc2VydCAodXNkQW1vdW50ID49IFBSSUNFKTsNCg0KICAgIHJldHVybiBzYWZlTXVsKHVzZEFtb3VudCwgc2FmZURpdihtdWx0aXBsaWVyLCBQUklDRSkpOw0KICB9ICANCg0KICAgLy8vIEBkZXYgQ2hlY2sgaWYgdGhlIHByZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4NCiAgIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIHByZUlDTyBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBiZSBhIHN1Y2Nlc3MNCiAgIGZ1bmN0aW9uIGlzTWF4aW11bVByZUZ1bmRpbmdHb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIHJlYWNoZWQpIHsNCiAgICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBQUkVfRlVORElOR19HT0FMOw0KICAgfQ0KDQogICAvLy8gQGRldiBDb252ZXJ0cyB3ZWkgdmFsdWUgaW50byBVU0QgY2VudHMgYWNjb3JkaW5nIHRvIGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQ0KICAgLy8vIEBwYXJhbSB3ZWlWYWx1ZSB3ZWkgdmFsdWUgdG8gY29udmVydA0KICAgLy8vIEByZXR1cm4gVVNEIGNlbnRzIGVxdWl2YWxlbnQgb2YgdGhlIHdlaSB2YWx1ZQ0KICAgZnVuY3Rpb24gd2VpVG9Vc2RDZW50cyh1aW50IHdlaVZhbHVlKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsNCiAgICAgcmV0dXJuIHNhZmVEaXYoc2FmZU11bCh3ZWlWYWx1ZSwgZXhjaGFuZ2VSYXRlKSwgMWUxOCk7DQogICB9DQoNCiAgIC8vLyBAZGV2IER5bmFtaWNhbGx5IGNyZWF0ZSB0b2tlbnMgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBpbnZlc3Rvci4NCiAgIC8vLyBAcGFyYW0gcmVjZWl2ZXIgaW52ZXN0b3IgYWRkcmVzcw0KICAgLy8vIEBwYXJhbSB0b2tlbkFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB3ZSB0cnkgdG8gZ2l2ZSB0byB0aGUgaW52ZXN0b3IgaW4gdGhlIGN1cnJlbnQgdHJhbnNhY3Rpb24NCiAgIGZ1bmN0aW9uIGFzc2lnblRva2VucyhhZGRyZXNzIHJlY2VpdmVyLCB1aW50IHRva2VuQW1vdW50KSBwcml2YXRlIHsNCiAgICAgdG9rZW4ubWludChyZWNlaXZlciwgdG9rZW5BbW91bnQpOw0KICAgfQ0KfQ=='