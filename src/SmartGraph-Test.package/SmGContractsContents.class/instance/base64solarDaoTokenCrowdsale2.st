base 64 content
base64solarDaoTokenCrowdsale2
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMzsNCg0KIC8vLyBAdGl0bGUgT3duYWJsZSBjb250cmFjdCAtIGJhc2UgY29udHJhY3Qgd2l0aCBhbiBvd25lcg0KIC8vLyBAYXV0aG9yIGRldkBzbWFydGNvbnRyYWN0ZWFtLmNvbQ0KY29udHJhY3QgT3duYWJsZSB7DQogIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogIGZ1bmN0aW9uIE93bmFibGUoKSB7DQogICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgIHJlcXVpcmUobXNnLnNlbmRlciA9PSBvd25lcik7ICANCiAgICBfOw0KICB9DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsNCiAgICBpZiAobmV3T3duZXIgIT0gYWRkcmVzcygwKSkgew0KICAgICAgb3duZXIgPSBuZXdPd25lcjsNCiAgICB9DQogIH0NCn0NCg0KLy8vIEB0aXRsZSBIYWx0YWJsZSBjb250cmFjdCAtIGFic3RyYWN0IGNvbnRyYWN0IHRoYXQgYWxsb3dzIGNoaWxkcmVuIHRvIGltcGxlbWVudCBhbiBlbWVyZ2VuY3kgc3RvcCBtZWNoYW5pc20uDQovLy8gQGF1dGhvciBkZXZAc21hcnRjb250cmFjdGVhbS5jb20NCi8vLyBPcmlnaW5hbGx5IGVudmlzaW9uZWQgaW4gRmlyc3RCbG9vZCBJQ08gY29udHJhY3QuDQpjb250cmFjdCBIYWx0YWJsZSBpcyBPd25hYmxlIHsNCiAgYm9vbCBwdWJsaWMgaGFsdGVkOw0KDQogIG1vZGlmaWVyIHN0b3BJbkVtZXJnZW5jeSB7DQogICAgcmVxdWlyZSghaGFsdGVkKTsNCiAgICBfOw0KICB9DQoNCiAgbW9kaWZpZXIgb25seUluRW1lcmdlbmN5IHsNCiAgICByZXF1aXJlKGhhbHRlZCk7ICAgICAgIA0KICAgIF87DQogIH0NCg0KICAvLy8gY2FsbGVkIGJ5IHRoZSBvd25lciBvbiBlbWVyZ2VuY3ksIHRyaWdnZXJzIHN0b3BwZWQgc3RhdGUNCiAgZnVuY3Rpb24gaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciB7DQogICAgaGFsdGVkID0gdHJ1ZTsNCiAgfQ0KDQogIC8vLyBjYWxsZWQgYnkgdGhlIG93bmVyIG9uIGVuZCBvZiBlbWVyZ2VuY3ksIHJldHVybnMgdG8gbm9ybWFsIHN0YXRlDQogIGZ1bmN0aW9uIHVuaGFsdCgpIGV4dGVybmFsIG9ubHlPd25lciBvbmx5SW5FbWVyZ2VuY3kgew0KICAgIGhhbHRlZCA9IGZhbHNlOw0KICB9DQp9DQoNCg0KDQogLy8vIEB0aXRsZSBFUkMyMCBpbnRlcmZhY2Ugc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KIC8vLyBAYXV0aG9yIGRldkBzbWFydGNvbnRyYWN0ZWFtLmNvbQ0KY29udHJhY3QgRVJDMjAgew0KICB1aW50IHB1YmxpYyB0b3RhbFN1cHBseTsNCiAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3Mgd2hvKSBjb25zdGFudCByZXR1cm5zICh1aW50KTsNCiAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyByZWNlaXZlciwgdWludCBhbW91bnQpOw0KICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludCB2YWx1ZSk7DQogIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBvd25lciwgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsIHVpbnQgdmFsdWUpOw0KfQ0KDQogLy8vIEB0aXRsZSBTYWZlTWF0aCBjb250cmFjdCAtIG1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MNCiAvLy8gQGF1dGhvciBkZXZAc21hcnRjb250cmFjdGVhbS5jb20NCmNvbnRyYWN0IFNhZmVNYXRoIHsNCiAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgIGFzc2VydChhID09IDAgfHwgYyAvIGEgPT0gYik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlRGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgYXNzZXJ0KGIgPiAwKTsNCiAgICB1aW50IGMgPSBhIC8gYjsNCiAgICBhc3NlcnQoYSA9PSBiICogYyArIGEgJSBiKTsNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICByZXR1cm4gYSAtIGI7DQogIH0NCg0KICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgdWludCBjID0gYSArIGI7DQogICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7DQogICAgcmV0dXJuIGM7DQogIH0NCg0KICBmdW5jdGlvbiBtYXg2NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIG1pbjY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtYXgyNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW4yNTYodWludDI1NiBhLCB1aW50MjU2IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQyNTYpIHsNCiAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgIHJlcXVpcmUoYXNzZXJ0aW9uKTsgIA0KICB9DQp9DQoNCg0KLy8vIEB0aXRsZSBTb2xhckRhb1Rva2VuIGNvbnRyYWN0IC0gc3RhbmRhcmQgRVJDMjAgdG9rZW4gd2l0aCBTaG9ydCBIYW5kIEF0dGFjayBhbmQgYXBwcm92ZSgpIHJhY2UgY29uZGl0aW9uIG1pdGlnYXRpb24uDQovLy8gQGF1dGhvciBkZXZAc21hcnRjb250cmFjdGVhbS5jb20NCmNvbnRyYWN0IFNvbGFyRGFvVG9rZW4gaXMgU2FmZU1hdGgsIEVSQzIwLCBPd25hYmxlIHsNCiBzdHJpbmcgcHVibGljIG5hbWUgPSAiU29sYXIgREFPIFRva2VuIjsNCiBzdHJpbmcgcHVibGljIHN5bWJvbCA9ICJTREFPIjsNCiB1aW50IHB1YmxpYyBkZWNpbWFscyA9IDQ7DQoNCiAvLy8gY29udHJhY3QgdGhhdCBpcyBhbGxvd2VkIHRvIGNyZWF0ZSBuZXcgdG9rZW5zIGFuZCBhbGxvd3MgdW5saWZ0IHRoZSB0cmFuc2ZlciBsaW1pdHMgb24gdGhpcyB0b2tlbg0KIGFkZHJlc3MgcHVibGljIGNyb3dkc2FsZUFnZW50Ow0KIC8vLyBBIGNyb3dkc2FsZSBjb250cmFjdCBjYW4gcmVsZWFzZSB1cyB0byB0aGUgd2lsZCBpZiBJQ08gc3VjY2Vzcy4gSWYgZmFsc2Ugd2UgYXJlIGFyZSBpbiB0cmFuc2ZlciBsb2NrIHVwIHBlcmlvZC4NCiBib29sIHB1YmxpYyByZWxlYXNlZCA9IGZhbHNlOw0KIC8vLyBhcHByb3ZlKCkgYWxsb3dhbmNlcw0KIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50KSkgYWxsb3dlZDsNCiAvLy8gaG9sZGVyIGJhbGFuY2VzDQogbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIGJhbGFuY2VzOw0KDQogLy8vIEBkZXYgTGltaXQgdG9rZW4gdHJhbnNmZXIgdW50aWwgdGhlIGNyb3dkc2FsZSBpcyBvdmVyLg0KIG1vZGlmaWVyIGNhblRyYW5zZmVyKCkgew0KICAgaWYoIXJlbGVhc2VkKSB7DQogICAgICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFnZW50KTsNCiAgIH0NCiAgIF87DQogfQ0KDQogLy8vIEBkZXYgVGhlIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgb25seSBiZWZvcmUgb3IgYWZ0ZXIgdGhlIHRva2VucyBoYXZlIGJlZW4gcmVsZWFzZXNkDQogLy8vIEBwYXJhbSBfcmVsZWFzZWQgdG9rZW4gdHJhbnNmZXIgYW5kIG1pbnQgc3RhdGUNCiBtb2RpZmllciBpblJlbGVhc2VTdGF0ZShib29sIF9yZWxlYXNlZCkgew0KICAgcmVxdWlyZShfcmVsZWFzZWQgPT0gcmVsZWFzZWQpOw0KICAgXzsNCiB9DQoNCiAvLy8gQGRldiBUaGUgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBvbmx5IGJ5IHJlbGVhc2UgYWdlbnQuDQogbW9kaWZpZXIgb25seUNyb3dkc2FsZUFnZW50KCkgew0KICAgcmVxdWlyZShtc2cuc2VuZGVyID09IGNyb3dkc2FsZUFnZW50KTsNCiAgIF87DQogfQ0KDQogLy8vIEBkZXYgRml4IGZvciB0aGUgRVJDMjAgc2hvcnQgYWRkcmVzcyBhdHRhY2sgaHR0cDovL3Zlc3NlbmVzLmNvbS90aGUtZXJjMjAtc2hvcnQtYWRkcmVzcy1hdHRhY2stZXhwbGFpbmVkLw0KIC8vLyBAcGFyYW0gc2l6ZSBwYXlsb2FkIHNpemUNCiBtb2RpZmllciBvbmx5UGF5bG9hZFNpemUodWludCBzaXplKSB7DQogICAgcmVxdWlyZShtc2cuZGF0YS5sZW5ndGggPj0gc2l6ZSArIDQpOw0KICAgIF87DQogfQ0KDQogLy8vIEBkZXYgTWFrZSBzdXJlIHdlIGFyZSBub3QgZG9uZSB5ZXQuDQogbW9kaWZpZXIgY2FuTWludCgpIHsNCiAgICByZXF1aXJlKCFyZWxlYXNlZCk7DQogICAgXzsNCiAgfQ0KDQogLy8vIEBkZXYgQ29uc3RydWN0b3INCiBmdW5jdGlvbiBTb2xhckRhb1Rva2VuKCkgew0KICAgb3duZXIgPSBtc2cuc2VuZGVyOw0KIH0NCg0KIC8vLyBGYWxsYmFjayBtZXRob2Qgd2lsbCBidXlvdXQgdG9rZW5zDQogZnVuY3Rpb24oKSBwYXlhYmxlIHsNCiAgIHJldmVydCgpOw0KIH0NCg0KIC8vLyBAZGV2IENyZWF0ZSBuZXcgdG9rZW5zIGFuZCBhbGxvY2F0ZSB0aGVtIHRvIGFuIGFkZHJlc3MuIE9ubHkgY2FsbGFibHkgYnkgYSBjcm93ZHNhbGUgY29udHJhY3QNCiAvLy8gQHBhcmFtIHJlY2VpdmVyIEFkZHJlc3Mgb2YgcmVjZWl2ZXINCiAvLy8gQHBhcmFtIGFtb3VudCAgTnVtYmVyIG9mIHRva2VucyB0byBpc3N1ZS4NCiBmdW5jdGlvbiBtaW50KGFkZHJlc3MgcmVjZWl2ZXIsIHVpbnQgYW1vdW50KSBvbmx5Q3Jvd2RzYWxlQWdlbnQgY2FuTWludCBwdWJsaWMgew0KICAgIHRvdGFsU3VwcGx5ID0gc2FmZUFkZCh0b3RhbFN1cHBseSwgYW1vdW50KTsNCiAgICBiYWxhbmNlc1tyZWNlaXZlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW3JlY2VpdmVyXSwgYW1vdW50KTsNCiAgICBUcmFuc2ZlcigwLCByZWNlaXZlciwgYW1vdW50KTsNCiB9DQoNCiAvLy8gQGRldiBTZXQgdGhlIGNvbnRyYWN0IHRoYXQgY2FuIGNhbGwgcmVsZWFzZSBhbmQgbWFrZSB0aGUgdG9rZW4gdHJhbnNmZXJhYmxlLg0KIC8vLyBAcGFyYW0gX2Nyb3dkc2FsZUFnZW50IGNyb3dkc2FsZSBjb250cmFjdCBhZGRyZXNzDQogZnVuY3Rpb24gc2V0Q3Jvd2RzYWxlQWdlbnQoYWRkcmVzcyBfY3Jvd2RzYWxlQWdlbnQpIG9ubHlPd25lciBpblJlbGVhc2VTdGF0ZShmYWxzZSkgcHVibGljIHsNCiAgIGNyb3dkc2FsZUFnZW50ID0gX2Nyb3dkc2FsZUFnZW50Ow0KIH0NCiAvLy8gQGRldiBPbmUgd2F5IGZ1bmN0aW9uIHRvIHJlbGVhc2UgdGhlIHRva2VucyB0byB0aGUgd2lsZC4gQ2FuIGJlIGNhbGxlZCBvbmx5IGZyb20gdGhlIHJlbGVhc2UgYWdlbnQgdGhhdCBpcyB0aGUgZmluYWwgSUNPIGNvbnRyYWN0LiBJdCBpcyBvbmx5IGNhbGxlZCBpZiB0aGUgY3Jvd2RzYWxlIGhhcyBiZWVuIHN1Y2Nlc3MgKGZpcnN0IG1pbGVzdG9uZSByZWFjaGVkKS4NCiBmdW5jdGlvbiByZWxlYXNlVG9rZW5UcmFuc2ZlcigpIHB1YmxpYyBvbmx5Q3Jvd2RzYWxlQWdlbnQgew0KICAgcmVsZWFzZWQgPSB0cnVlOw0KIH0NCiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyB0byBhZGRyZXNzDQogLy8vIEBwYXJhbSBfdG8gZGVzdCBhZGRyZXNzDQogLy8vIEBwYXJhbSBfdmFsdWUgdG9rZW5zIGFtb3VudA0KIC8vLyBAcmV0dXJuIHRyYW5zZmVyIHJlc3VsdA0KIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgb25seVBheWxvYWRTaXplKDIgKiAzMikgY2FuVHJhbnNmZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF92YWx1ZSk7DQogICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOw0KDQogICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICByZXR1cm4gdHJ1ZTsNCiB9DQoNCiAvLy8gQGRldiBUcmFuZmVyIHRva2VucyBmcm9tIG9uZSBhZGRyZXNzIHRvIG90aGVyDQogLy8vIEBwYXJhbSBfZnJvbSBzb3VyY2UgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3RvIGRlc3QgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQNCiAvLy8gQHJldHVybiB0cmFuc2ZlciByZXN1bHQNCiBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSBvbmx5UGF5bG9hZFNpemUoMiAqIDMyKSBjYW5UcmFuc2ZlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQoNCiAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOw0KICAgIGJhbGFuY2VzW19mcm9tXSA9IHNhZmVTdWIoYmFsYW5jZXNbX2Zyb21dLCBfdmFsdWUpOw0KICAgIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID0gc2FmZVN1YihfYWxsb3dhbmNlLCBfdmFsdWUpOw0KICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgcmV0dXJuIHRydWU7DQogfQ0KIC8vLyBAZGV2IFRva2VucyBiYWxhbmNlDQogLy8vIEBwYXJhbSBfb3duZXIgaG9sZGVyIGFkZHJlc3MNCiAvLy8gQHJldHVybiBiYWxhbmNlIGFtb3VudA0KIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKSB7DQogICByZXR1cm4gYmFsYW5jZXNbX293bmVyXTsNCiB9DQoNCiAvLy8gQGRldiBBcHByb3ZlIHRyYW5zZmVyDQogLy8vIEBwYXJhbSBfc3BlbmRlciBob2xkZXIgYWRkcmVzcw0KIC8vLyBAcGFyYW0gX3ZhbHVlIHRva2VucyBhbW91bnQNCiAvLy8gQHJldHVybiByZXN1bHQNCiBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgIC8vIFRvIGNoYW5nZSB0aGUgYXBwcm92ZSBhbW91bnQgeW91IGZpcnN0IGhhdmUgdG8gcmVkdWNlIHRoZSBhZGRyZXNzZXNgDQogICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwgMClgIGlmIGl0IGlzIG5vdA0KICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL0VJUHMvaXNzdWVzLzIwI2lzc3VlY29tbWVudC0yNjM1MjQ3MjkNCiAgIHJlcXVpcmUgKChfdmFsdWUgPT0gMCkgfHwgKGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID09IDApKTsNCg0KICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfdmFsdWU7DQogICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgIHJldHVybiB0cnVlOw0KIH0NCg0KIC8vLyBAZGV2IFRva2VuIGFsbG93YW5jZQ0KIC8vLyBAcGFyYW0gX293bmVyIGhvbGRlciBhZGRyZXNzDQogLy8vIEBwYXJhbSBfc3BlbmRlciBzcGVuZGVyIGFkZHJlc3MNCiAvLy8gQHJldHVybiByZW1haW4gYW1vdW50DQogZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZykgew0KICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogfQ0KfQ0KDQoNCi8vLyBAdGl0bGUgU29sYXJEYW9Ub2tlbkNyb3dkc2FsZSBjb250cmFjdCAtIGNvbnRyYWN0IGZvciB0b2tlbiBzYWxlcy4NCi8vLyBAYXV0aG9yIGRldkBzbWFydGNvbnRyYWN0ZWFtLmNvbQ0KY29udHJhY3QgU29sYXJEYW9Ub2tlbkNyb3dkc2FsZSBpcyBIYWx0YWJsZSwgU2FmZU1hdGggew0KDQogIC8vLyBQcmVmdW5kaW5nIGdvYWwgaW4gVVNEIGNlbnRzLCBpZiB0aGUgcHJlZnVuZGluZyBnb2FsIGlzIHJlYWNoZWQsIGljbyB3aWxsIHN0YXJ0DQogIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRV9GVU5ESU5HX0dPQUwgPSA0ZTYgKiBQUklDRTsNCg0KICAvLy8gVG9rZW5zIGZ1bmRpbmcgZ29hbCBpbiBVU0QgY2VudHMsIGlmIHRoZSBmdW5kaW5nIGdvYWwgaXMgcmVhY2hlZCwgaWNvIHdpbGwgc3RvcA0KICB1aW50IHB1YmxpYyBjb25zdGFudCBJQ09fR09BTCA9IDhlNyAqIFBSSUNFOw0KDQogIC8vLyBNaW1pbmFsIHRva2VucyBmdW5kaW5nIGdvYWwgaW4gVVNEIGNlbnRzLCBpZiB0aGlzIGdvYWwgaXNuJ3QgcmVhY2hlZCBkdXJpbmcgSUNPLCByZWZ1bmQgd2lsbCBiZWdpbg0KICB1aW50IHB1YmxpYyBjb25zdGFudCBNSU5fSUNPX0dPQUwgPSAxZTc7DQoNCiAgLy8vIFBlcmNlbnQgb2YgYm9udXMgdG9rZW5zIHRlYW0gcmVjZWl2ZXMgZnJvbSBlYWNoIGludmVzdG1lbnQNCiAgdWludCBwdWJsaWMgY29uc3RhbnQgVEVBTV9CT05VU19QRVJDRU5UID0gMjU7DQoNCiAgLy8vIFRoZSB0b2tlbiBwcmljZSBpbiBVU0QgY2VudHMNCiAgdWludCBjb25zdGFudCBwdWJsaWMgUFJJQ0UgPSAxMDA7DQoNCiAgLy8vIER1cmF0aW9uIG9mIHRoZSBwcmUtSUNPIHN0YWdlDQogIHVpbnQgY29uc3RhbnQgcHVibGljIFBSRV9JQ09fRFVSQVRJT04gPSA1IHdlZWtzOw0KDQogIC8vLyBUaGUgdG9rZW4gd2UgYXJlIHNlbGxpbmcNCiAgU29sYXJEYW9Ub2tlbiBwdWJsaWMgdG9rZW47DQoNCiAgLy8vIHRva2VucyB3aWxsIGJlIHRyYW5zZmVyZWQgZnJvbSB0aGlzIGFkZHJlc3MNCiAgYWRkcmVzcyBwdWJsaWMgbXVsdGlzaWdXYWxsZXQ7DQoNCiAgLy8vIHRoZSBVTklYIHRpbWVzdGFtcCBzdGFydCBkYXRlIG9mIHRoZSBjcm93ZHNhbGUNCiAgdWludCBwdWJsaWMgc3RhcnRzQXQ7DQoNCiAgLy8vIHRoZSBVTklYIHRpbWVzdGFtcCBlbmQgZGF0ZSBvZiB0aGUgY3Jvd2RzYWxlDQogIHVpbnQgcHVibGljIGVuZHNBdDsNCg0KICAvLy8gdGhlIFVOSVggdGltZXN0YW1wIHN0YXJ0IGRhdGUgb2YgdGhlIHByZSBpbnZlc3QgY3Jvd2RzYWxlDQogIHVpbnQgcHVibGljIHByZUludmVzdFN0YXJ0Ow0KDQogIC8vLyB0aGUgbnVtYmVyIG9mIHRva2VucyBhbHJlYWR5IHNvbGQgdGhyb3VnaCB0aGlzIGNvbnRyYWN0DQogIHVpbnQgcHVibGljIHRva2Vuc1NvbGQgPSAwOw0KDQogIC8vLyBIb3cgbWFueSB3ZWkgb2YgZnVuZGluZyB3ZSBoYXZlIHJhaXNlZA0KICB1aW50IHB1YmxpYyB3ZWlSYWlzZWQgPSAwOw0KDQogIC8vLyBIb3cgbWFueSBkaXN0aW5jdCBhZGRyZXNzZXMgaGF2ZSBpbnZlc3RlZA0KICB1aW50IHB1YmxpYyBpbnZlc3RvckNvdW50ID0gMDsNCg0KICAvLy8gSG93IG11Y2ggd2VpIHdlIGhhdmUgcmV0dXJuZWQgYmFjayB0byB0aGUgY29udHJhY3QgYWZ0ZXIgYSBmYWlsZWQgY3Jvd2RmdW5kLg0KICB1aW50IHB1YmxpYyBsb2FkZWRSZWZ1bmQgPSAwOw0KDQogIC8vLyBIb3cgbXVjaCB3ZWkgd2UgaGF2ZSBnaXZlbiBiYWNrIHRvIGludmVzdG9ycy4NCiAgdWludCBwdWJsaWMgd2VpUmVmdW5kZWQgPSAwOw0KDQogIC8vLyBIYXMgdGhpcyBjcm93ZHNhbGUgYmVlbiBmaW5hbGl6ZWQNCiAgYm9vbCBwdWJsaWMgZmluYWxpemVkOw0KDQogIC8vLyBVU0QgdG8gRXRoZXIgcmF0ZSBpbiBjZW50cw0KICB1aW50IHB1YmxpYyBleGNoYW5nZVJhdGU7DQoNCiAgLy8vIGV4Y2hhbmdlUmF0ZSB0aW1lc3RhbXANCiAgdWludCBwdWJsaWMgZXhjaGFuZ2VSYXRlVGltZXN0YW1wOw0KDQogIC8vLyBFeHRlcm5hbCBhZ2VudCB0aGF0IHdpbGwgY2FuIGNoYW5nZSBleGNoYW5nZSByYXRlDQogIGFkZHJlc3MgcHVibGljIGV4Y2hhbmdlUmF0ZUFnZW50Ow0KDQogIC8vLyBIb3cgbXVjaCBFVEggZWFjaCBhZGRyZXNzIGhhcyBpbnZlc3RlZCB0byB0aGlzIGNyb3dkc2FsZQ0KICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBpbnZlc3RlZEFtb3VudE9mOw0KDQogIC8vLyBIb3cgbXVjaCB0b2tlbnMgdGhpcyBjcm93ZHNhbGUgaGFzIGNyZWRpdGVkIGZvciBlYWNoIGludmVzdG9yIGFkZHJlc3MNCiAgbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSBwdWJsaWMgdG9rZW5BbW91bnRPZjsNCg0KICAvLy8gRGVmaW5lIHByZUlDTyBwcmljaW5nIHNjaGVkdWxlIHVzaW5nIG1pbGVzdG9uZXMuDQogIHN0cnVjdCBNaWxlc3RvbmUgew0KICAgICAgLy8gVU5JWCB0aW1lc3RhbXAgd2hlbiB0aGlzIG1pbGVzdG9uZSBraWNrcyBpbg0KICAgICAgdWludCBzdGFydDsNCiAgICAgIC8vIFVOSVggdGltZXN0YW1wIHdoZW4gdGhpcyBtaWxlc3RvbmUga2lja3Mgb3V0DQogICAgICB1aW50IGVuZDsNCiAgICAgIC8vIEhvdyBtYW55ICUgdG9rZW5zIHdpbGwgYWRkDQogICAgICB1aW50IGJvbnVzOw0KICB9DQoNCiAgTWlsZXN0b25lW10gcHVibGljIG1pbGVzdG9uZXM7DQoNCiAgLy8vIFN0YXRlIG1hY2hpbmUNCiAgLy8vIFByZXBhcmluZzogQWxsIGNvbnRyYWN0IGluaXRpYWxpemF0aW9uIGNhbGxzIGFuZCB2YXJpYWJsZXMgaGF2ZSBub3QgYmVlbiBzZXQgeWV0DQogIC8vLyBQcmVmdW5kaW5nOiBXZSBoYXZlIG5vdCBwYXNzZWQgc3RhcnQgdGltZSB5ZXQNCiAgLy8vIEZ1bmRpbmc6IEFjdGl2ZSBjcm93ZHNhbGUNCiAgLy8vIFN1Y2Nlc3M6IE1pbmltdW0gZnVuZGluZyBnb2FsIHJlYWNoZWQNCiAgLy8vIEZhaWx1cmU6IE1pbmltdW0gZnVuZGluZyBnb2FsIG5vdCByZWFjaGVkIGJlZm9yZSBlbmRpbmcgdGltZQ0KICAvLy8gRmluYWxpemVkOiBUaGUgZmluYWxpemVkIGhhcyBiZWVuIGNhbGxlZCBhbmQgc3VjY2VzZnVsbHkgZXhlY3V0ZWRcDQogIC8vLyBSZWZ1bmRpbmc6IFJlZnVuZHMgYXJlIGxvYWRlZCBvbiB0aGUgY29udHJhY3QgZm9yIHJlY2xhaW0uDQogIGVudW0gU3RhdGV7VW5rbm93biwgUHJlcGFyaW5nLCBQcmVGdW5kaW5nLCBGdW5kaW5nLCBTdWNjZXNzLCBGYWlsdXJlLCBGaW5hbGl6ZWQsIFJlZnVuZGluZ30NCg0KICAvLy8gQSBuZXcgaW52ZXN0bWVudCB3YXMgbWFkZQ0KICBldmVudCBJbnZlc3RlZChhZGRyZXNzIGludmVzdG9yLCB1aW50IHdlaUFtb3VudCwgdWludCB0b2tlbkFtb3VudCk7DQogIC8vLyBSZWZ1bmQgd2FzIHByb2Nlc3NlZCBmb3IgYSBjb250cmlidXRvcg0KICBldmVudCBSZWZ1bmQoYWRkcmVzcyBpbnZlc3RvciwgdWludCB3ZWlBbW91bnQpOw0KICAvLy8gQ3Jvd2RzYWxlIGVuZCB0aW1lIGhhcyBiZWVuIGNoYW5nZWQNCiAgZXZlbnQgRW5kc0F0Q2hhbmdlZCh1aW50IGVuZHNBdCk7DQogIC8vLyBDYWxjdWxhdGVkIG5ldyBwcmljZQ0KICBldmVudCBFeGNoYW5nZVJhdGVDaGFuZ2VkKHVpbnQgb2xkVmFsdWUsIHVpbnQgbmV3VmFsdWUpOw0KDQogIC8vLyBAZGV2IE1vZGlmaWVkIGFsbG93aW5nIGV4ZWN1dGlvbiBvbmx5IGlmIHRoZSBjcm93ZHNhbGUgaXMgY3VycmVudGx5IHJ1bm5pbmcNCiAgbW9kaWZpZXIgaW5TdGF0ZShTdGF0ZSBzdGF0ZSkgew0KICAgIHJlcXVpcmUoZ2V0U3RhdGUoKSA9PSBzdGF0ZSk7DQogICAgXzsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlFeGNoYW5nZVJhdGVBZ2VudCgpIHsNCiAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gZXhjaGFuZ2VSYXRlQWdlbnQpOw0KICAgIF87DQogIH0NCg0KICAvLy8gQGRldiBDb25zdHJ1Y3Rvcg0KICAvLy8gQHBhcmFtIF90b2tlbiBTb2xhciBEYW8gdG9rZW4gYWRkcmVzcw0KICAvLy8gQHBhcmFtIF9tdWx0aXNpZ1dhbGxldCB0ZWFtIHdhbGxldA0KICAvLy8gQHBhcmFtIF9wcmVJbnZlc3RTdGFydCBwcmVJQ08gc3RhcnQgZGF0ZQ0KICAvLy8gQHBhcmFtIF9zdGFydCB0b2tlbiBJQ08gc3RhcnQgZGF0ZQ0KICAvLy8gQHBhcmFtIF9lbmQgdG9rZW4gSUNPIGVuZCBkYXRlDQogIGZ1bmN0aW9uIENyb3dkc2FsZShhZGRyZXNzIF90b2tlbiwgYWRkcmVzcyBfbXVsdGlzaWdXYWxsZXQsIHVpbnQgX3ByZUludmVzdFN0YXJ0LCB1aW50IF9zdGFydCwgdWludCBfZW5kKSB7DQogICAgcmVxdWlyZShfbXVsdGlzaWdXYWxsZXQgIT0gMCk7DQogICAgcmVxdWlyZShfcHJlSW52ZXN0U3RhcnQgIT0gMCk7DQogICAgcmVxdWlyZShfc3RhcnQgIT0gMCk7DQogICAgcmVxdWlyZShfZW5kICE9IDApOw0KICAgIHJlcXVpcmUoX3N0YXJ0IDwgX2VuZCk7DQogICAgcmVxdWlyZShfZW5kID4gX3ByZUludmVzdFN0YXJ0ICsgUFJFX0lDT19EVVJBVElPTik7DQoNCiAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgdG9rZW4gPSBTb2xhckRhb1Rva2VuKF90b2tlbik7DQoNCiAgICBtdWx0aXNpZ1dhbGxldCA9IF9tdWx0aXNpZ1dhbGxldDsNCiAgICBzdGFydHNBdCA9IF9zdGFydDsNCiAgICBlbmRzQXQgPSBfZW5kOw0KICAgIHByZUludmVzdFN0YXJ0ID0gX3ByZUludmVzdFN0YXJ0Ow0KDQogICAgdmFyIHByZUljb0JvbnVzZXMgPSBbdWludCgxMDApLCA4MCwgNzAsIDYwLCA1MF07DQogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgcHJlSWNvQm9udXNlcy5sZW5ndGg7IGkrKykgew0KICAgICAgbWlsZXN0b25lcy5wdXNoKE1pbGVzdG9uZShwcmVJbnZlc3RTdGFydCArIGkgKiAxIHdlZWtzLCBwcmVJbnZlc3RTdGFydCArIChpICsgMSkgKiAxIHdlZWtzLCBwcmVJY29Cb251c2VzW2ldKSk7DQogICAgfQ0KICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUoc3RhcnRzQXQsIHN0YXJ0c0F0ICsgNCBkYXlzLCAyNSkpOw0KICAgIG1pbGVzdG9uZXMucHVzaChNaWxlc3RvbmUoc3RhcnRzQXQgKyA0IGRheXMsIHN0YXJ0c0F0ICsgMSB3ZWVrcywgMjApKTsNCiAgICBkZWxldGUgcHJlSWNvQm9udXNlczsNCg0KICAgIHZhciBpY29Cb251c2VzID0gW3VpbnQoMTUpLCAxMCwgNV07DQogICAgZm9yIChpID0gMTsgaSA8PSBpY29Cb251c2VzLmxlbmd0aDsgaSsrKSB7DQogICAgICBtaWxlc3RvbmVzLnB1c2goTWlsZXN0b25lKHN0YXJ0c0F0ICsgaSAqIDEgd2Vla3MsIHN0YXJ0c0F0ICsgKGkgKyAxKSAqIDEgd2Vla3MsIGljb0JvbnVzZXNbaSAtIDFdKSk7DQogICAgfQ0KICAgIGRlbGV0ZSBpY29Cb251c2VzOw0KICB9DQoNCiAgZnVuY3Rpb24oKSBwYXlhYmxlIHsNCiAgICBidXkoKTsNCiAgfQ0KDQogIC8vLyBAZGV2IEdldCB0aGUgY3VycmVudCBtaWxlc3RvbmUgb3IgYmFpbCBvdXQgaWYgd2UgYXJlIG5vdCBpbiB0aGUgbWlsZXN0b25lIHBlcmlvZHMuDQogIC8vLyBAcmV0dXJuIE1pbGVzdG9uZSBjdXJyZW50IGJvbnVzIG1pbGVzdG9uZQ0KICBmdW5jdGlvbiBnZXRDdXJyZW50TWlsZXN0b25lKCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChNaWxlc3RvbmUpIHsNCiAgICAgIGZvciAodWludCBpID0gMDsgaSA8IG1pbGVzdG9uZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgaWYgKG1pbGVzdG9uZXNbaV0uc3RhcnQgPD0gbm93ICYmIG1pbGVzdG9uZXNbaV0uZW5kID4gbm93KSB7DQogICAgICAgICAgcmV0dXJuIG1pbGVzdG9uZXNbaV07DQogICAgICAgIH0NCiAgICAgIH0NCiAgfQ0KDQogICAvLy8gQGRldiBNYWtlIGFuIGludmVzdG1lbnQuIENyb3dkc2FsZSBtdXN0IGJlIHJ1bm5pbmcgZm9yIG9uZSB0byBpbnZlc3QuDQogICAvLy8gQHBhcmFtIHJlY2VpdmVyIFRoZSBFdGhlcmV1bSBhZGRyZXNzIHdobyByZWNlaXZlcyB0aGUgdG9rZW5zDQogIGZ1bmN0aW9uIGludmVzdEludGVybmFsKGFkZHJlc3MgcmVjZWl2ZXIpIHN0b3BJbkVtZXJnZW5jeSBwcml2YXRlIHsNCiAgICB2YXIgc3RhdGUgPSBnZXRTdGF0ZSgpOw0KICAgIHJlcXVpcmUoc3RhdGUgPT0gU3RhdGUuRnVuZGluZyB8fCBzdGF0ZSA9PSBTdGF0ZS5QcmVGdW5kaW5nKTsNCg0KICAgIHVpbnQgd2VpQW1vdW50ID0gbXNnLnZhbHVlOw0KICAgIHVpbnQgdG9rZW5zQW1vdW50ID0gY2FsY3VsYXRlVG9rZW5zKHdlaUFtb3VudCk7DQogICAgYXNzZXJ0ICh0b2tlbnNBbW91bnQgPiAwKTsNCg0KICAgIGlmKHN0YXRlID09IFN0YXRlLlByZUZ1bmRpbmcpIHsNCiAgICAgICAgdG9rZW5zQW1vdW50ICs9IHNhZmVEaXYoc2FmZU11bCh0b2tlbnNBbW91bnQsIGdldEN1cnJlbnRNaWxlc3RvbmUoKS5ib251cyksIDEwMCk7DQogICAgfQ0KDQogICAgaWYoaW52ZXN0ZWRBbW91bnRPZltyZWNlaXZlcl0gPT0gMCkgew0KICAgICAgIC8vIEEgbmV3IGludmVzdG9yDQogICAgICAgaW52ZXN0b3JDb3VudCsrOw0KICAgIH0NCg0KICAgIC8vIFVwZGF0ZSBpbnZlc3Rvcg0KICAgIGludmVzdGVkQW1vdW50T2ZbcmVjZWl2ZXJdID0gc2FmZUFkZChpbnZlc3RlZEFtb3VudE9mW3JlY2VpdmVyXSwgd2VpQW1vdW50KTsNCiAgICB0b2tlbkFtb3VudE9mW3JlY2VpdmVyXSA9IHNhZmVBZGQodG9rZW5BbW91bnRPZltyZWNlaXZlcl0sIHRva2Vuc0Ftb3VudCk7DQogICAgLy8gVXBkYXRlIHRvdGFscw0KICAgIHdlaVJhaXNlZCA9IHNhZmVBZGQod2VpUmFpc2VkLCB3ZWlBbW91bnQpOw0KICAgIHRva2Vuc1NvbGQgPSBzYWZlQWRkKHRva2Vuc1NvbGQsIHRva2Vuc0Ftb3VudCk7DQoNCiAgICAvLyBDaGVjayB0aGF0IHdlIGRpZCBub3QgYnVzdCB0aGUgY2FwDQogICAgLyoNCiAgICBpZihpc0JyZWFraW5nQ2FwKHdlaUFtb3VudCwgdG9rZW5zQW1vdW50LCB3ZWlSYWlzZWQsIHRva2Vuc1NvbGQpKSB7DQogICAgICB0aHJvdzsNCiAgICB9Ki8NCg0KICAgIGFzc2lnblRva2VucyhyZWNlaXZlciwgdG9rZW5zQW1vdW50KTsNCiAgICB2YXIgdGVhbUJvbnVzVG9rZW5zID0gc2FmZURpdihzYWZlTXVsKHRva2Vuc0Ftb3VudCwgVEVBTV9CT05VU19QRVJDRU5UKSwgMTAwIC0gVEVBTV9CT05VU19QRVJDRU5UKTsNCiAgICBhc3NpZ25Ub2tlbnMobXVsdGlzaWdXYWxsZXQsIHRlYW1Cb251c1Rva2Vucyk7DQoNCiAgICBtdWx0aXNpZ1dhbGxldC50cmFuc2Zlcih3ZWlBbW91bnQpOw0KICAgIC8vIFRlbGwgdXMgaW52ZXN0IHdhcyBzdWNjZXNzDQogICAgSW52ZXN0ZWQocmVjZWl2ZXIsIHdlaUFtb3VudCwgdG9rZW5zQW1vdW50KTsNCiAgfQ0KDQogIC8vLyBAZGV2IEFsbG93IGFub255bW91cyBjb250cmlidXRpb25zIHRvIHRoaXMgY3Jvd2RzYWxlLg0KICAvLy8gQHBhcmFtIHJlY2VpdmVyIFRoZSBFdGhlcmV1bSBhZGRyZXNzIHdobyByZWNlaXZlcyB0aGUgdG9rZW5zDQogIGZ1bmN0aW9uIGludmVzdChhZGRyZXNzIHJlY2VpdmVyKSBwdWJsaWMgcGF5YWJsZSB7DQogICAgaW52ZXN0SW50ZXJuYWwocmVjZWl2ZXIpOw0KICB9DQoNCiAgLy8vIEBkZXYgVGhlIGJhc2ljIGVudHJ5IHBvaW50IHRvIHBhcnRpY2lwYXRlIHRoZSBjcm93ZHNhbGUgcHJvY2Vzcy4NCiAgZnVuY3Rpb24gYnV5KCkgcHVibGljIHBheWFibGUgew0KICAgIGludmVzdChtc2cuc2VuZGVyKTsNCiAgfQ0KDQogIC8vLyBAZGV2IEZpbmFsaXplIGEgc3VjY2Nlc2Z1bCBjcm93ZHNhbGUuDQogIGZ1bmN0aW9uIGZpbmFsaXplKCkgcHVibGljIGluU3RhdGUoU3RhdGUuU3VjY2Vzcykgb25seU93bmVyIHN0b3BJbkVtZXJnZW5jeSB7DQogICAgcmVxdWlyZSghZmluYWxpemVkKTsNCg0KICAgIGZpbmFsaXplZCA9IHRydWU7DQogICAgZmluYWxpemVDcm93ZHNhbGUoKTsNCiAgfQ0KDQogIC8vLyBAZGV2IEZpbmFsaXplIGEgc3VjY2Nlc2Z1bCBjcm93ZHNhbGUuDQogIGZ1bmN0aW9uIGZpbmFsaXplQ3Jvd2RzYWxlKCkgaW50ZXJuYWwgew0KICAgIC8vYXNzaWduVG9rZW5zKG93bmVyLCBzYWZlQWRkKHNhZmVTdWIodWludChNQVhfVE9LRU5TX1RPX1NPTEQpLCB0b2tlbnNTb2xkKSwgVEVBTV9UT0tFTlNfQU1PVU5UKSk7DQogICAgdG9rZW4ucmVsZWFzZVRva2VuVHJhbnNmZXIoKTsNCiAgfQ0KDQogICAvLy8gQGRldiBNZXRob2QgZm9yIHNldHRpbmcgVVNEIHRvIEV0aGVyIHJhdGUgZnJvbSBQb2xvbmlleA0KICAgLy8vIEBwYXJhbSB2YWx1ZSBVU0QgYW1vdXQgaW4gY2VudHMgZm9yIDEgRXRoZXINCiAgIC8vLyBAcGFyYW0gdGltZSB0aW1lc3RhbXANCiAgZnVuY3Rpb24gc2V0RXhjaGFuZ2VSYXRlKHVpbnQgdmFsdWUsIHVpbnQgdGltZSkgb25seUV4Y2hhbmdlUmF0ZUFnZW50IHsNCiAgICByZXF1aXJlKHZhbHVlID4gMCk7DQogICAgcmVxdWlyZSh0aW1lID4gMCk7DQogICAgcmVxdWlyZShleGNoYW5nZVJhdGVUaW1lc3RhbXAgPT0gMCB8fCBnZXREaWZmZXJlbmNlKGludCh0aW1lKSwgaW50KG5vdykpIDw9IDEgbWludXRlcyk7DQogICAgcmVxdWlyZShleGNoYW5nZVJhdGUgPT0gMCB8fCAoZ2V0RGlmZmVyZW5jZShpbnQodmFsdWUpLCBpbnQoZXhjaGFuZ2VSYXRlKSkgKiAxMDAgLyBleGNoYW5nZVJhdGUgPD0gMzApKTsNCg0KICAgIEV4Y2hhbmdlUmF0ZUNoYW5nZWQoZXhjaGFuZ2VSYXRlLCB2YWx1ZSk7DQogICAgZXhjaGFuZ2VSYXRlID0gdmFsdWU7DQogICAgZXhjaGFuZ2VSYXRlVGltZXN0YW1wID0gdGltZTsNCiAgfQ0KDQogIC8vLyBAZGV2IE1ldGhvZCBzZXQgZXhjaGFuZ2UgcmF0ZSBhZ2VudA0KICAvLy8gQHBhcmFtIG5ld0FnZW50IG5ldyBhZ2VudA0KIGZ1bmN0aW9uIHNldEV4Y2hhbmdlUmF0ZUFnZW50KGFkZHJlc3MgbmV3QWdlbnQpIG9ubHlPd25lciB7DQogICBpZiAobmV3QWdlbnQgIT0gYWRkcmVzcygwKSkgew0KICAgICBleGNoYW5nZVJhdGVBZ2VudCA9IG5ld0FnZW50Ow0KICAgfQ0KIH0NCg0KICBmdW5jdGlvbiBnZXREaWZmZXJlbmNlKGludCBvbmUsIGludCB0d28pIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAodWludCkgew0KICAgIHZhciBkaWZmID0gb25lIC0gdHdvOw0KICAgIGlmIChkaWZmIDwgMCkNCiAgICAgIGRpZmYgPSAtZGlmZjsNCiAgICByZXR1cm4gdWludChkaWZmKTsNCiAgfQ0KDQogIC8vLyBAZGV2IEFsbG93IGNyb3dkc2FsZSBvd25lciB0byBjbG9zZSBlYXJseSBvciBleHRlbmQgdGhlIGNyb3dkc2FsZS4NCiAgLy8vIEBwYXJhbSB0aW1lIHRpbWVzdGFtcA0KICBmdW5jdGlvbiBzZXRFbmRzQXQodWludCB0aW1lKSBvbmx5T3duZXIgew0KICAgIHJlcXVpcmUodGltZSA+PSBub3cpOw0KICAgIGVuZHNBdCA9IHRpbWU7DQogICAgRW5kc0F0Q2hhbmdlZChlbmRzQXQpOw0KICB9DQoNCiAgLy8vIEBkZXYgQWxsb3cgbG9hZCByZWZ1bmRzIGJhY2sgb24gdGhlIGNvbnRyYWN0IGZvciB0aGUgcmVmdW5kaW5nLg0KICBmdW5jdGlvbiBsb2FkUmVmdW5kKCkgcHVibGljIHBheWFibGUgaW5TdGF0ZShTdGF0ZS5GYWlsdXJlKSB7DQogICAgcmVxdWlyZShtc2cudmFsdWUgPiAwKTsNCiAgICBsb2FkZWRSZWZ1bmQgPSBzYWZlQWRkKGxvYWRlZFJlZnVuZCwgbXNnLnZhbHVlKTsNCiAgfQ0KDQogIC8vLyBAZGV2IEludmVzdG9ycyBjYW4gY2xhaW0gcmVmdW5kLg0KICBmdW5jdGlvbiByZWZ1bmQoKSBwdWJsaWMgaW5TdGF0ZShTdGF0ZS5SZWZ1bmRpbmcpIHsNCiAgICB1aW50MjU2IHdlaVZhbHVlID0gaW52ZXN0ZWRBbW91bnRPZlttc2cuc2VuZGVyXTsNCiAgICBpZiAod2VpVmFsdWUgPT0gMCkNCiAgICAgIHJldHVybjsNCiAgICBpbnZlc3RlZEFtb3VudE9mW21zZy5zZW5kZXJdID0gMDsNCiAgICB3ZWlSZWZ1bmRlZCA9IHNhZmVBZGQod2VpUmVmdW5kZWQsIHdlaVZhbHVlKTsNCiAgICBSZWZ1bmQobXNnLnNlbmRlciwgd2VpVmFsdWUpOw0KICAgIG1zZy5zZW5kZXIudHJhbnNmZXIod2VpVmFsdWUpOw0KICB9DQoNCiAgLy8vIEBkZXYgTWluaW11bSBnb2FsIHdhcyByZWFjaGVkDQogIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIGNyb3dkc2FsZSBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBub3QgaW5pdGlhdGUgdGhlIHJlZnVuZGluZw0KICBmdW5jdGlvbiBpc01pbmltdW1Hb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIHJlYWNoZWQpIHsNCiAgICByZXR1cm4gd2VpVG9Vc2RDZW50cyh3ZWlSYWlzZWQpID49IE1JTl9JQ09fR09BTDsNCiAgfQ0KDQogIC8vLyBAZGV2IENoZWNrIGlmIHRoZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4NCiAgLy8vIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY3Jvd2RzYWxlIGhhcyByYWlzZWQgZW5vdWdoIG1vbmV5IHRvIGJlIGEgc3VjY2Vzcw0KICBmdW5jdGlvbiBpc0Nyb3dkc2FsZUZ1bGwoKSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgIHJldHVybiB3ZWlUb1VzZENlbnRzKHdlaVJhaXNlZCkgPj0gSUNPX0dPQUw7DQogIH0NCg0KICAvLy8gQGRldiBDcm93ZGZ1bmQgc3RhdGUgbWFjaGluZSBtYW5hZ2VtZW50Lg0KICAvLy8gQHJldHVybiBTdGF0ZSBjdXJyZW50IHN0YXRlDQogIGZ1bmN0aW9uIGdldFN0YXRlKCkgcHVibGljIGNvbnN0YW50IHJldHVybnMgKFN0YXRlKSB7DQogICAgaWYgKGZpbmFsaXplZCkNCiAgICAgIHJldHVybiBTdGF0ZS5GaW5hbGl6ZWQ7DQogICAgaWYgKGFkZHJlc3ModG9rZW4pID09IDAgfHwgYWRkcmVzcyhtdWx0aXNpZ1dhbGxldCkgPT0gMCkNCiAgICAgIHJldHVybiBTdGF0ZS5QcmVwYXJpbmc7DQogICAgaWYgKHByZUludmVzdFN0YXJ0IDw9IG5vdyAmJiBub3cgPCBzdGFydHNBdCAmJiAhaXNNYXhpbXVtUHJlRnVuZGluZ0dvYWxSZWFjaGVkKCkpDQogICAgICByZXR1cm4gU3RhdGUuUHJlRnVuZGluZzsNCiAgICBpZiAobm93IDw9IGVuZHNBdCAmJiAhaXNDcm93ZHNhbGVGdWxsKCkpDQogICAgICByZXR1cm4gU3RhdGUuRnVuZGluZzsNCiAgICBpZiAoaXNNaW5pbXVtR29hbFJlYWNoZWQoKSkNCiAgICAgIHJldHVybiBTdGF0ZS5TdWNjZXNzOw0KICAgIGlmICghaXNNaW5pbXVtR29hbFJlYWNoZWQoKSAmJiB3ZWlSYWlzZWQgPiAwICYmIGxvYWRlZFJlZnVuZCA+PSB3ZWlSYWlzZWQpDQogICAgICByZXR1cm4gU3RhdGUuUmVmdW5kaW5nOw0KICAgIHJldHVybiBTdGF0ZS5GYWlsdXJlOw0KICB9DQoNCiAgLy8vIEBkZXYgQ2FsY3VsYXRpbmcgdG9rZW5zIGNvdW50DQogIC8vLyBAcGFyYW0gd2VpQW1vdW50IGludmVzdGVkDQogIC8vLyBAcmV0dXJuIHRva2VucyBhbW91bnQNCiAgZnVuY3Rpb24gY2FsY3VsYXRlVG9rZW5zKHVpbnQgd2VpQW1vdW50KSBpbnRlcm5hbCByZXR1cm5zICh1aW50IHRva2VuQW1vdW50KSB7DQogICAgdmFyIG11bHRpcGxpZXIgPSAxMCAqKiB0b2tlbi5kZWNpbWFscygpOw0KDQogICAgdWludCB1c2RBbW91bnQgPSB3ZWlUb1VzZENlbnRzKHdlaUFtb3VudCk7DQogICAgYXNzZXJ0ICh1c2RBbW91bnQgPj0gUFJJQ0UpOw0KDQogICAgcmV0dXJuIHNhZmVNdWwodXNkQW1vdW50LCBzYWZlRGl2KG11bHRpcGxpZXIsIFBSSUNFKSk7DQogIH0NCg0KICAgLy8vIEBkZXYgQ2hlY2sgaWYgdGhlIGN1cnJlbnQgaW52ZXN0ZWQgYnJlYWtzIG91ciBjYXAgcnVsZXMuDQogICAvLy8gQHBhcmFtIHdlaUFtb3VudCBUaGUgYW1vdW50IG9mIHdlaSB0aGUgaW52ZXN0b3IgdHJpZXMgdG8gaW52ZXN0IGluIHRoZSBjdXJyZW50IHRyYW5zYWN0aW9uDQogICAvLy8gQHBhcmFtIHRva2VuQW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHdlIHRyeSB0byBnaXZlIHRvIHRoZSBpbnZlc3RvciBpbiB0aGUgY3VycmVudCB0cmFuc2FjdGlvbg0KICAgLy8vIEBwYXJhbSB3ZWlSYWlzZWRUb3RhbCBXaGF0IHdvdWxkIGJlIG91ciB0b3RhbCByYWlzZWQgYmFsYW5jZSBhZnRlciB0aGlzIHRyYW5zYWN0aW9uDQogICAvLy8gQHBhcmFtIHRva2Vuc1NvbGRUb3RhbCBXaGF0IHdvdWxkIGJlIG91ciB0b3RhbCBzb2xkIHRva2VucyBjb3VudCBhZnRlciB0aGlzIHRyYW5zYWN0aW9uDQogICAvLy8gQHJldHVybiByZXN1bHQNCiAgIGZ1bmN0aW9uIGlzQnJlYWtpbmdDYXAodWludCB3ZWlBbW91bnQsIHVpbnQgdG9rZW5BbW91bnQsIHVpbnQgd2VpUmFpc2VkVG90YWwsIHVpbnQgdG9rZW5zU29sZFRvdGFsKSBjb25zdGFudCByZXR1cm5zIChib29sIGxpbWl0QnJva2VuKSB7DQogICAgIHJldHVybiBmYWxzZTsNCiAgIH0NCg0KICAgLy8vIEBkZXYgQ2hlY2sgaWYgdGhlIHByZSBJQ08gZ29hbCB3YXMgcmVhY2hlZC4NCiAgIC8vLyBAcmV0dXJuIHRydWUgaWYgdGhlIHByZUlDTyBoYXMgcmFpc2VkIGVub3VnaCBtb25leSB0byBiZSBhIHN1Y2Nlc3MNCiAgIGZ1bmN0aW9uIGlzTWF4aW11bVByZUZ1bmRpbmdHb2FsUmVhY2hlZCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zIChib29sIHJlYWNoZWQpIHsNCiAgICAgcmV0dXJuIHdlaVRvVXNkQ2VudHMod2VpUmFpc2VkKSA+PSBQUkVfRlVORElOR19HT0FMOw0KICAgfQ0KDQogICAvLy8gQGRldiBDb252ZXJ0cyB3ZWkgdmFsdWUgaW50byBVU0QgY2VudHMgYWNjb3JkaW5nIHRvIGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQ0KICAgLy8vIEBwYXJhbSB3ZWlWYWx1ZSB3ZWkgdmFsdWUgdG8gY29udmVydA0KICAgLy8vIEByZXR1cm4gVVNEIGNlbnRzIGVxdWl2YWxlbnQgb2YgdGhlIHdlaSB2YWx1ZQ0KICAgZnVuY3Rpb24gd2VpVG9Vc2RDZW50cyh1aW50IHdlaVZhbHVlKSBwcml2YXRlIHJldHVybnMgKHVpbnQpIHsNCiAgICAgcmV0dXJuIHNhZmVEaXYoc2FmZU11bCh3ZWlWYWx1ZSwgZXhjaGFuZ2VSYXRlKSwgMWUxOCk7DQogICB9DQoNCiAgIC8vLyBAZGV2IER5bmFtaWNhbGx5IGNyZWF0ZSB0b2tlbnMgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBpbnZlc3Rvci4NCiAgIC8vLyBAcGFyYW0gcmVjZWl2ZXIgaW52ZXN0b3IgYWRkcmVzcw0KICAgLy8vIEBwYXJhbSB0b2tlbkFtb3VudCBUaGUgYW1vdW50IG9mIHRva2VucyB3ZSB0cnkgdG8gZ2l2ZSB0byB0aGUgaW52ZXN0b3IgaW4gdGhlIGN1cnJlbnQgdHJhbnNhY3Rpb24NCiAgIGZ1bmN0aW9uIGFzc2lnblRva2VucyhhZGRyZXNzIHJlY2VpdmVyLCB1aW50IHRva2VuQW1vdW50KSBwcml2YXRlIHsNCiAgICAgdG9rZW4ubWludChyZWNlaXZlciwgdG9rZW5BbW91bnQpOw0KICAgfQ0KfQ=='