base 64 content
base64token38
	^'cHJhZ21hIHNvbGlkaXR5ID49MC40LjQ7DQoNCi8vIENvcHlyaWdodCAyMDE3IEFsY2hlbXkgTGltaXRlZCBMTEMsIERvIG5vdCBkaXN0cmlidXRlDQoNCmNvbnRyYWN0IENvbnN0YW50cyB7DQogICAgdWludCBERUNJTUFMUyA9IDg7DQp9DQoNCg0KY29udHJhY3QgT3duZWQgew0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyOw0KDQogICAgbW9kaWZpZXIgb25seU93bmVyKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgYWRkcmVzcyBuZXdPd25lcjsNCg0KICAgIGZ1bmN0aW9uIGNoYW5nZU93bmVyKGFkZHJlc3MgX25ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBuZXdPd25lciA9IF9uZXdPd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhY2NlcHRPd25lcnNoaXAoKSB7DQogICAgICAgIGlmIChtc2cuc2VuZGVyID09IG5ld093bmVyKSB7DQogICAgICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQovL2Zyb20gWmVwcGVsaW4NCmNvbnRyYWN0IFNhZmVNYXRoIHsNCiAgICBmdW5jdGlvbiBzYWZlTXVsKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKiBiOw0KICAgICAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgICAgICByZXR1cm4gYzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzYWZlU3ViKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIGFzc2VydChiIDw9IGEpOw0KICAgICAgICByZXR1cm4gYSAtIGI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2FmZUFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICB1aW50IGMgPSBhICsgYjsNCiAgICAgICAgYXNzZXJ0KGM+PWEgJiYgYz49Yik7DQogICAgICAgIHJldHVybiBjOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFzc2VydChib29sIGFzc2VydGlvbikgaW50ZXJuYWwgew0KICAgICAgICBpZiAoIWFzc2VydGlvbikgdGhyb3c7DQogICAgfQ0KfQ0KDQoNCg0KLy9Db3B5cmlnaHQgMjAxNyBBbGNoZW15IExpbWl0ZWQgTExDIERPIG5vdCBkaXN0cmlidXRlDQovL0VSQzIwIHRva2VuDQoNCmNvbnRyYWN0IFRva2VuIGlzIFNhZmVNYXRoLCBPd25lZCwgQ29uc3RhbnRzIHsNCiAgICB1aW50IHB1YmxpYyBjdXJyZW50U3VwcGx5Ow0KICAgIHVpbnQgcHVibGljIHJlbWFpbmluZ093bmVyOw0KICAgIHVpbnQgcHVibGljIHJlbWFpbmluZ0F1Y3Rpb25hYmxlOw0KICAgIHVpbnQgcHVibGljIG93bmVyVG9rZW5zRnJlZURheTsNCiAgICBib29sIHB1YmxpYyBsYXVuY2hlZCA9IGZhbHNlOw0KDQogICAgYm9vbCBwdWJsaWMgcmVtYWluZGVyc1NldCA9IGZhbHNlOw0KICAgIGJvb2wgcHVibGljIG1pbnRpbmdEb25lID0gZmFsc2U7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBjb250cm9sbGVyOw0KDQogICAgc3RyaW5nIHB1YmxpYyBuYW1lOw0KICAgIHVpbnQ4IHB1YmxpYyBkZWNpbWFsczsNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCg0KICAgIG1vZGlmaWVyIG9ubHlDb250cm9sbGVyKCkgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBjb250cm9sbGVyKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc0xhdW5jaGVkKCkgew0KICAgICAgICBhc3NlcnQobGF1bmNoZWQgPT0gdHJ1ZSk7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgbnVtd29yZHMpIHsNCiAgICAgICAgYXNzZXJ0KG1zZy5kYXRhLmxlbmd0aCA9PSBudW13b3JkcyAqIDMyICsgNCk7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gVG9rZW4oKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICAgICAgbmFtZSA9ICJNb25vbGl0aCBUS04iOw0KICAgICAgICBkZWNpbWFscyA9IHVpbnQ4KERFQ0lNQUxTKTsNCiAgICAgICAgc3ltYm9sID0gIlRLTiI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gTGF1bmNoKCkgb25seU93bmVyIHsNCiAgICAgICAgbGF1bmNoZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNldE93bmVyRnJlZURheSh1aW50IGRheSkgb25seU93bmVyIHsNCiAgICAgICAgaWYgKG93bmVyVG9rZW5zRnJlZURheSAhPSAwKSB0aHJvdzsNCg0KICAgICAgICBvd25lclRva2Vuc0ZyZWVEYXkgPSBkYXk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zKHVpbnQpIHsNCiAgICAgICAgcmV0dXJuIGN1cnJlbnRTdXBwbHkgKyByZW1haW5pbmdPd25lcjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRSZW1haW5kZXJzKHVpbnQgX3JlbWFpbmluZ093bmVyLCB1aW50IF9yZW1haW5pbmdBdWN0aW9uYWJsZSkgb25seU93bmVyIHsNCiAgICAgICAgaWYgKHJlbWFpbmRlcnNTZXQpIHsgdGhyb3c7IH0NCg0KICAgICAgICByZW1haW5pbmdPd25lciA9IF9yZW1haW5pbmdPd25lcjsNCiAgICAgICAgcmVtYWluaW5nQXVjdGlvbmFibGUgPSBfcmVtYWluaW5nQXVjdGlvbmFibGU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZmluYWxpemVSZW1haW5kZXJzKCkgb25seU93bmVyIHsNCiAgICAgICAgcmVtYWluZGVyc1NldCA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0Q29udHJvbGxlcihhZGRyZXNzIF9jb250cm9sbGVyKSBvbmx5T3duZXIgew0KICAgICAgICBjb250cm9sbGVyID0gX2NvbnRyb2xsZXI7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2xhaW1Pd25lclN1cHBseSgpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChub3cgPCBvd25lclRva2Vuc0ZyZWVEYXkpIHRocm93Ow0KICAgICAgICBpZiAocmVtYWluaW5nT3duZXIgPT0gMCkgdGhyb3c7DQogICAgICAgIGlmICghcmVtYWluZGVyc1NldCkgdGhyb3c7IC8vIG11c3QgZmluYWxpemUgcmVtYWluZGVycw0KDQogICAgICAgIGJhbGFuY2VPZltvd25lcl0gPSBzYWZlQWRkKGJhbGFuY2VPZltvd25lcl0sIHJlbWFpbmluZ093bmVyKTsNCiAgICAgICAgcmVtYWluaW5nT3duZXIgPSAwOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsYWltQXVjdGlvbmFibGVUb2tlbnModWludCBhbW91bnQpIG9ubHlDb250cm9sbGVyIHsNCiAgICAgICAgaWYgKGFtb3VudCA+IHJlbWFpbmluZ0F1Y3Rpb25hYmxlKSB0aHJvdzsNCg0KICAgICAgICBiYWxhbmNlT2ZbY29udHJvbGxlcl0gPSBzYWZlQWRkKGJhbGFuY2VPZltjb250cm9sbGVyXSwgYW1vdW50KTsNCiAgICAgICAgY3VycmVudFN1cHBseSA9IHNhZmVBZGQoY3VycmVudFN1cHBseSwgYW1vdW50KTsNCiAgICAgICAgcmVtYWluaW5nQXVjdGlvbmFibGUgPSBzYWZlU3ViKHJlbWFpbmluZ0F1Y3Rpb25hYmxlLGFtb3VudCk7DQoNCiAgICAgICAgVHJhbnNmZXIoMCwgY29udHJvbGxlciwgYW1vdW50KTsNCiAgICB9DQoNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsNCg0KICAgIGZ1bmN0aW9uIG1pbnQoYWRkcmVzcyBhZGRyLCB1aW50IGFtb3VudCkgb25seU93bmVyIG9ubHlQYXlsb2FkU2l6ZSgyKSB7DQogICAgICAgIGlmIChtaW50aW5nRG9uZSkgdGhyb3c7DQoNCiAgICAgICAgYmFsYW5jZU9mW2FkZHJdID0gc2FmZUFkZChiYWxhbmNlT2ZbYWRkcl0sIGFtb3VudCk7DQoNCiAgICAgICAgY3VycmVudFN1cHBseSA9IHNhZmVBZGQoY3VycmVudFN1cHBseSwgYW1vdW50KTsNCg0KICAgICAgICBUcmFuc2ZlcigwLCBhZGRyLCBhbW91bnQpOw0KICAgIH0NCg0KDQogICAgdWludCBjb25zdGFudCBEMTYwID0gMHgwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOw0KDQogICAgLy8gV2UgZG9uJ3QgdXNlIHNhZmUgbWF0aCBpbiB0aGlzIGZ1bmN0aW9uDQogICAgLy8gYmVjYXVzZSB0aGlzIHdpbGwgYmUgY2FsbGVkIGZvciB0aGUgb3duZXIgYmVmb3JlIHRoZSBjb250cmFjdA0KICAgIC8vIGlzIHB1Ymxpc2hlZCBhbmQgd2UgbmVlZCB0byBzYXZlIGdhcy4NCiAgICBmdW5jdGlvbiBtdWx0aU1pbnQodWludFtdIGRhdGEpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChtaW50aW5nRG9uZSkgdGhyb3c7DQoNCiAgICAgICAgdWludCBzdXBwbHlBZGQ7DQogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICBhZGRyZXNzIGFkZHIgPSBhZGRyZXNzKCBkYXRhW2ldICYgKEQxNjAtMSkgKTsNCiAgICAgICAgICAgIHVpbnQgYW1vdW50ID0gZGF0YVtpXSAvIEQxNjA7DQoNCiAgICAgICAgICAgIGJhbGFuY2VPZlthZGRyXSArPSBhbW91bnQ7DQogICAgICAgICAgICBzdXBwbHlBZGQgKz0gYW1vdW50Ow0KICAgICAgICAgICAgVHJhbnNmZXIoMCwgYWRkciwgYW1vdW50KTsNCiAgICAgICAgfQ0KICAgICAgICBjdXJyZW50U3VwcGx5ICs9IHN1cHBseUFkZDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjb21wbGV0ZU1pbnRpbmcoKSBvbmx5T3duZXIgew0KICAgICAgICBtaW50aW5nRG9uZSA9IHRydWU7DQogICAgfQ0KDQogICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQpIHB1YmxpYyBiYWxhbmNlT2Y7DQogICAgbWFwcGluZyhhZGRyZXNzID0+IG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludCkpIHB1YmxpYyBhbGxvd2FuY2U7DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIGlzTGF1bmNoZWQgbm90UGF1c2VkDQogICAgb25seVBheWxvYWRTaXplKDIpDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHJldHVybiBmYWxzZTsNCiAgICAgICAgaWYgKF90byA9PSAweDApIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VPZlttc2cuc2VuZGVyXSwgX3ZhbHVlKTsNCiAgICAgICAgYmFsYW5jZU9mW190b10gPSBzYWZlQWRkKGJhbGFuY2VPZltfdG9dLCBfdmFsdWUpOw0KICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfdG8sIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bywgdWludCBfdmFsdWUpICBpc0xhdW5jaGVkIG5vdFBhdXNlZA0KICAgIG9ubHlQYXlsb2FkU2l6ZSgzKQ0KICAgIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoX3RvID09IDB4MCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICBpZiAoYmFsYW5jZU9mW19mcm9tXSA8IF92YWx1ZSkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIHZhciBhbGxvd2VkID0gYWxsb3dhbmNlW19mcm9tXVttc2cuc2VuZGVyXTsNCiAgICAgICAgaWYgKGFsbG93ZWQgPCBfdmFsdWUpIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBiYWxhbmNlT2ZbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZU9mW190b10sIF92YWx1ZSk7DQogICAgICAgIGJhbGFuY2VPZltfZnJvbV0gPSBzYWZlU3ViKGJhbGFuY2VPZltfZnJvbV0sIF92YWx1ZSk7DQogICAgICAgIGFsbG93YW5jZVtfZnJvbV1bbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGFsbG93ZWQsIF92YWx1ZSk7DQogICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpDQogICAgb25seVBheWxvYWRTaXplKDIpDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIC8vcmVxdWlyZSB1c2VyIHRvIHNldCB0byB6ZXJvIGJlZm9yZSByZXNldHRpbmcgdG8gbm9uemVybw0KICAgICAgICBpZiAoKF92YWx1ZSAhPSAwKSAmJiAoYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSAhPSAwKSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IF92YWx1ZTsNCiAgICAgICAgQXBwcm92YWwobXNnLnNlbmRlciwgX3NwZW5kZXIsIF92YWx1ZSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGluY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX2FkZGVkVmFsdWUpDQogICAgb25seVBheWxvYWRTaXplKDIpDQogICAgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHVpbnQgb2xkVmFsdWUgPSBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdOw0KICAgICAgICBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gc2FmZUFkZChvbGRWYWx1ZSwgX2FkZGVkVmFsdWUpOw0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGRlY3JlYXNlQXBwcm92YWwgKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3N1YnRyYWN0ZWRWYWx1ZSkNCiAgICBvbmx5UGF5bG9hZFNpemUoMikNCiAgICByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgdWludCBvbGRWYWx1ZSA9IGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl07DQogICAgICAgIGlmIChfc3VidHJhY3RlZFZhbHVlID4gb2xkVmFsdWUpIHsNCiAgICAgICAgICAgIGFsbG93YW5jZVttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSAwOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYWxsb3dhbmNlW21zZy5zZW5kZXJdW19zcGVuZGVyXSA9IHNhZmVTdWIob2xkVmFsdWUsIF9zdWJ0cmFjdGVkVmFsdWUpOw0KICAgICAgICB9DQogICAgICAgIEFwcHJvdmFsKG1zZy5zZW5kZXIsIF9zcGVuZGVyLCBhbGxvd2FuY2VbbXNnLnNlbmRlcl1bX3NwZW5kZXJdKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8vIEBub3RpY2UgYG1zZy5zZW5kZXJgIGFwcHJvdmVzIGBfc3BlbmRlcmAgdG8gc2VuZCBgX2Ftb3VudGAgdG9rZW5zIG9uDQogICAgLy8vICBpdHMgYmVoYWxmLCBhbmQgdGhlbiBhIGZ1bmN0aW9uIGlzIHRyaWdnZXJlZCBpbiB0aGUgY29udHJhY3QgdGhhdCBpcw0KICAgIC8vLyAgYmVpbmcgYXBwcm92ZWQsIGBfc3BlbmRlcmAuIFRoaXMgYWxsb3dzIHVzZXJzIHRvIHVzZSB0aGVpciB0b2tlbnMgdG8NCiAgICAvLy8gIGludGVyYWN0IHdpdGggY29udHJhY3RzIGluIG9uZSBmdW5jdGlvbiBjYWxsIGluc3RlYWQgb2YgdHdvDQogICAgLy8vIEBwYXJhbSBfc3BlbmRlciBUaGUgYWRkcmVzcyBvZiB0aGUgY29udHJhY3QgYWJsZSB0byB0cmFuc2ZlciB0aGUgdG9rZW5zDQogICAgLy8vIEBwYXJhbSBfYW1vdW50IFRoZSBhbW91bnQgb2YgdG9rZW5zIHRvIGJlIGFwcHJvdmVkIGZvciB0cmFuc2Zlcg0KICAgIC8vLyBAcmV0dXJuIFRydWUgaWYgdGhlIGZ1bmN0aW9uIGNhbGwgd2FzIHN1Y2Nlc3NmdWwNCiAgICBmdW5jdGlvbiBhcHByb3ZlQW5kQ2FsbChhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF9hbW91bnQsIGJ5dGVzIF9leHRyYURhdGENCiAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoIWFwcHJvdmUoX3NwZW5kZXIsIF9hbW91bnQpKSB0aHJvdzsNCg0KICAgICAgICBBcHByb3ZlQW5kQ2FsbEZhbGxCYWNrKF9zcGVuZGVyKS5yZWNlaXZlQXBwcm92YWwoDQogICAgICAgICAgICBtc2cuc2VuZGVyLA0KICAgICAgICAgICAgX2Ftb3VudCwNCiAgICAgICAgICAgIHRoaXMsDQogICAgICAgICAgICBfZXh0cmFEYXRhDQogICAgICAgICk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy9Ib2xkcyBhY2N1bXVsYXRlZCBkaXZpZGVuZCB0b2tlbnMgb3RoZXIgdGhhbiBUS04NCiAgICBUb2tlbkhvbGRlciBwdWJsaWMgdG9rZW5ob2xkZXI7DQoNCiAgICAvL29uY2UgbG9ja2VkLCBjYW4gbm8gbG9uZ2VyIHVwZ3JhZGUgdG9rZW5ob2xkZXINCiAgICBib29sIHB1YmxpYyBsb2NrZWRUb2tlbkhvbGRlcjsNCg0KICAgIGZ1bmN0aW9uIGxvY2tUb2tlbkhvbGRlcigpIG9ubHlPd25lciB7DQogICAgICAgIGxvY2tlZFRva2VuSG9sZGVyID0gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZXRUb2tlbkhvbGRlcihhZGRyZXNzIF90aCkgb25seU93bmVyIHsNCiAgICAgICAgaWYgKGxvY2tlZFRva2VuSG9sZGVyKSB0aHJvdzsNCiAgICAgICAgdG9rZW5ob2xkZXIgPSBUb2tlbkhvbGRlcihfdGgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJ1cm4odWludCBfYW1vdW50KSBub3RQYXVzZWQgcmV0dXJucyAoYm9vbCByZXN1bHQpICB7DQogICAgICAgIGlmIChfYW1vdW50ID4gYmFsYW5jZU9mW21zZy5zZW5kZXJdKSByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgYmFsYW5jZU9mW21zZy5zZW5kZXJdID0gc2FmZVN1YihiYWxhbmNlT2ZbbXNnLnNlbmRlcl0sIF9hbW91bnQpOw0KICAgICAgICBjdXJyZW50U3VwcGx5ICA9IHNhZmVTdWIoY3VycmVudFN1cHBseSwgX2Ftb3VudCk7DQogICAgICAgIHJlc3VsdCA9IHRva2VuaG9sZGVyLmJ1cm4obXNnLnNlbmRlciwgX2Ftb3VudCk7DQogICAgICAgIGlmICghcmVzdWx0KSB0aHJvdzsNCiAgICAgICAgVHJhbnNmZXIobXNnLnNlbmRlciwgMCwgX2Ftb3VudCk7DQogICAgfQ0KDQogICAgLy8gUGV0ZXJzb24ncyBMYXcgUHJvdGVjdGlvbg0KICAgIGV2ZW50IGxvZ1Rva2VuVHJhbnNmZXIoYWRkcmVzcyB0b2tlbiwgYWRkcmVzcyB0bywgdWludCBhbW91bnQpOw0KDQogICAgZnVuY3Rpb24gY2xhaW1Ub2tlbnMoYWRkcmVzcyBfdG9rZW4pIG9ubHlPd25lciB7DQogICAgICAgIGlmIChfdG9rZW4gPT0gMHgwKSB7DQogICAgICAgICAgICBvd25lci50cmFuc2Zlcih0aGlzLmJhbGFuY2UpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgVG9rZW4gdG9rZW4gPSBUb2tlbihfdG9rZW4pOw0KICAgICAgICB1aW50IGJhbGFuY2UgPSB0b2tlbi5iYWxhbmNlT2YodGhpcyk7DQogICAgICAgIHRva2VuLnRyYW5zZmVyKG93bmVyLCBiYWxhbmNlKTsNCiAgICAgICAgbG9nVG9rZW5UcmFuc2ZlcihfdG9rZW4sIG93bmVyLCBiYWxhbmNlKTsNCiAgICB9DQoNCiAgICAvLyBQYXVzZSBtZWNoYW5pc20NCg0KICAgIGJvb2wgcHVibGljIHBhdXNpbmdNZWNoYW5pc21Mb2NrZWQgPSBmYWxzZTsNCiAgICBib29sIHB1YmxpYyBwYXVzZWQgPSBmYWxzZTsNCg0KICAgIG1vZGlmaWVyIG5vdFBhdXNlZCgpIHsNCiAgICAgICAgaWYgKHBhdXNlZCkgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcGF1c2UoKSBvbmx5T3duZXIgew0KICAgICAgICBpZiAocGF1c2luZ01lY2hhbmlzbUxvY2tlZCkgdGhyb3c7DQogICAgICAgIHBhdXNlZCA9IHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdW5wYXVzZSgpIG9ubHlPd25lciB7DQogICAgICAgIGlmIChwYXVzaW5nTWVjaGFuaXNtTG9ja2VkKSB0aHJvdzsNCiAgICAgICAgcGF1c2VkID0gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbmV2ZXJQYXVzZUFnYWluKCkgb25seU93bmVyIHsNCiAgICAgICAgcGF1c2luZ01lY2hhbmlzbUxvY2tlZCA9IHRydWU7DQogICAgfQ0KfQ0KDQpjb250cmFjdCBUb2tlbkhvbGRlciB7DQogICAgZnVuY3Rpb24gYnVybihhZGRyZXNzICwgdWludCApDQogICAgcmV0dXJucyAoYm9vbCByZXN1bHQpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCn0NCg0KY29udHJhY3QgQXBwcm92ZUFuZENhbGxGYWxsQmFjayB7DQogICAgZnVuY3Rpb24gcmVjZWl2ZUFwcHJvdmFsKGFkZHJlc3MgZnJvbSwgdWludDI1NiBfYW1vdW50LCBhZGRyZXNzIF90b2tlbiwgYnl0ZXMgX2RhdGEpOw0KfQ=='