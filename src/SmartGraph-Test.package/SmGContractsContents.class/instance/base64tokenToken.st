base 64 content
base64tokenToken
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBUb2tlblRyYWRlckZhY3RvcnkNCi8vDQovLyBEZWNlbnRyYWxpc2VkIHRydXN0bGVzcyBFUkMyMC1jb21wbGlhbnQgdG9rZW4gdG8gRVRIIGV4Y2hhbmdlIGNvbnRyYWN0DQovLyBvbiB0aGUgRXRoZXJldW0gYmxvY2tjaGFpbi4NCi8vDQovLyBOb3RlIHRoYXQgdGhpcyBUb2tlblRyYWRlciBjYW5ub3QgYmUgdXNlZCB3aXRoIHRoZSBHb2xlbSBOZXR3b3JrIFRva2VuDQovLyBkaXJlY3RseSBhcyB0aGUgdG9rZW4gZG9lcyBub3QgaW1wbGVtZW50IHRoZSBFUkMyMA0KLy8gdHJhbnNmZXJGcm9tKC4uLiksIGFwcHJvdmUoLi4uKSBhbmQgYWxsb3dhbmNlKC4uLikgbWV0aG9kcw0KLy8NCi8vIEhpc3Rvcnk6DQovLyAgIEphbiAyNSAyMDE3IC0gQlBCIEFkZGVkIG1ha2VyVHJhbnNmZXJBc3NldCguLi4pIGFuZA0KLy8gICAgICAgICAgICAgICAgICAgICBtYWtlclRyYW5zZmVyRXRoZXIoLi4uKQ0KLy8gICBGZWIgMDUgMjAxNyAtIEJQQiBCdWcgZml4IGluIHRoZSBjaGFuZ2UgY2FsY3VsYXRpb24gZm9yIHRoZSBVbmljb3JuDQovLyAgICAgICAgICAgICAgICAgICAgIHRva2VuIHdpdGggbmF0dXJhbCBudW1iZXIgMQ0KLy8gICBGZWIgMDggMjAxNyAtIEJQQi9KTCBSZW5hbWVkIGV0aGVyVmFsdWVPZlRva2Vuc1RvU2VsbCB0bw0KLy8gICAgICAgICAgICAgICAgICAgICBhbW91bnRPZlRva2Vuc1RvU2VsbCBpbiB0YWtlclNlbGxBc3NldCguLi4pIHRvDQovLyAgICAgICAgICAgICAgICAgICAgIGJldHRlciBkZXNjcmliZSB0aGUgcGFyYW1ldGVyDQovLyAgICAgICAgICAgICAgICAgICAgIEFkZGVkIGNoZWNrIGluIGNyZWF0ZVRyYWRlQ29udHJhY3QoLi4uKSB0byBwcmV2ZW50DQovLyAgICAgICAgICAgICAgICAgICAgIEdOVHMgZnJvbSBiZWluZyB1c2VkIHdpdGggdGhpcyBjb250cmFjdC4gVGhlIGFzc2V0DQovLyAgICAgICAgICAgICAgICAgICAgIHRva2VuIHdpbGwgbmVlZCB0byBoYXZlIGFuIGFsbG93YW5jZSguLi4pIGZ1bmN0aW9uLg0KLy8NCi8vIEVuam95LiAoYykgSm9ubnlMYXR0ZSAmIEJva2t5UG9vQmFoIDIwMTcuIFRoZSBNSVQgbGljZW5jZS4NCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCmNvbnRyYWN0IEVSQzIwIHsNCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdG90YWxTdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpOw0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOw0KfQ0KDQpjb250cmFjdCBPd25lZCB7DQogICAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQogICAgZXZlbnQgT3duZXJzaGlwVHJhbnNmZXJyZWQoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvKTsNCg0KICAgIGZ1bmN0aW9uIE93bmVkKCkgew0KICAgICAgICBvd25lciA9IG1zZy5zZW5kZXI7DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seU93bmVyIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIpIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIG9ubHlPd25lck9yVG9rZW5UcmFkZXJXaXRoU2FtZU93bmVyIHsNCiAgICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gb3duZXIgJiYgVG9rZW5UcmFkZXIobXNnLnNlbmRlcikub3duZXIoKSAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsNCiAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQob3duZXIsIG5ld093bmVyKTsNCiAgICAgICAgb3duZXIgPSBuZXdPd25lcjsNCiAgICB9DQp9DQoNCi8vIGNvbnRyYWN0IGNhbiBidXkgb3Igc2VsbCB0b2tlbnMgZm9yIEVUSA0KLy8gcHJpY2VzIGFyZSBpbiBhbW91bnQgb2Ygd2VpIHBlciBiYXRjaCBvZiB0b2tlbiB1bml0cw0KDQpjb250cmFjdCBUb2tlblRyYWRlciBpcyBPd25lZCB7DQoNCiAgICBhZGRyZXNzIHB1YmxpYyBhc3NldDsgICAgICAgLy8gYWRkcmVzcyBvZiB0b2tlbg0KICAgIHVpbnQyNTYgcHVibGljIGJ1eVByaWNlOyAgICAvLyBjb250cmFjdCBidXlzIGxvdHMgb2YgdG9rZW4gYXQgdGhpcyBwcmljZQ0KICAgIHVpbnQyNTYgcHVibGljIHNlbGxQcmljZTsgICAvLyBjb250cmFjdCBzZWxscyBsb3RzIGF0IHRoaXMgcHJpY2UNCiAgICB1aW50MjU2IHB1YmxpYyB1bml0czsgICAgICAgLy8gbG90IHNpemUgKHRva2VuLXdlaSkNCg0KICAgIGJvb2wgcHVibGljIGJ1eXNUb2tlbnM7ICAgICAvLyBpcyBjb250cmFjdCBidXlpbmcNCiAgICBib29sIHB1YmxpYyBzZWxsc1Rva2VuczsgICAgLy8gaXMgY29udHJhY3Qgc2VsbGluZw0KDQogICAgZXZlbnQgQWN0aXZhdGVkRXZlbnQoYm9vbCBidXlzLCBib29sIHNlbGxzKTsNCiAgICBldmVudCBNYWtlckRlcG9zaXRlZEV0aGVyKHVpbnQyNTYgYW1vdW50KTsNCiAgICBldmVudCBNYWtlcldpdGhkcmV3QXNzZXQodWludDI1NiB0b2tlbnMpOw0KICAgIGV2ZW50IE1ha2VyVHJhbnNmZXJyZWRBc3NldChhZGRyZXNzIHRvVG9rZW5UcmFkZXIsIHVpbnQyNTYgdG9rZW5zKTsNCiAgICBldmVudCBNYWtlcldpdGhkcmV3RVJDMjBUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludDI1NiB0b2tlbnMpOw0KICAgIGV2ZW50IE1ha2VyV2l0aGRyZXdFdGhlcih1aW50MjU2IGV0aGVycyk7DQogICAgZXZlbnQgTWFrZXJUcmFuc2ZlcnJlZEV0aGVyKGFkZHJlc3MgdG9Ub2tlblRyYWRlciwgdWludDI1NiBldGhlcnMpOw0KICAgIGV2ZW50IFRha2VyQm91Z2h0QXNzZXQoYWRkcmVzcyBpbmRleGVkIGJ1eWVyLCB1aW50MjU2IGV0aGVyc1NlbnQsDQogICAgICAgIHVpbnQyNTYgZXRoZXJzUmV0dXJuZWQsIHVpbnQyNTYgdG9rZW5zQm91Z2h0KTsNCiAgICBldmVudCBUYWtlclNvbGRBc3NldChhZGRyZXNzIGluZGV4ZWQgc2VsbGVyLCB1aW50MjU2IGFtb3VudE9mVG9rZW5zVG9TZWxsLA0KICAgICAgICB1aW50MjU2IHRva2Vuc1NvbGQsIHVpbnQyNTYgZXRoZXJWYWx1ZU9mVG9rZW5zU29sZCk7DQoNCiAgICAvLyBDb25zdHJ1Y3RvciAtIG9ubHkgdG8gYmUgY2FsbGVkIGJ5IHRoZSBUb2tlblRyYWRlckZhY3RvcnkgY29udHJhY3QNCiAgICBmdW5jdGlvbiBUb2tlblRyYWRlciAoDQogICAgICAgIGFkZHJlc3MgX2Fzc2V0LA0KICAgICAgICB1aW50MjU2IF9idXlQcmljZSwNCiAgICAgICAgdWludDI1NiBfc2VsbFByaWNlLA0KICAgICAgICB1aW50MjU2IF91bml0cywNCiAgICAgICAgYm9vbCAgICBfYnV5c1Rva2VucywNCiAgICAgICAgYm9vbCAgICBfc2VsbHNUb2tlbnMNCiAgICApIHsNCiAgICAgICAgYXNzZXQgICAgICAgPSBfYXNzZXQ7DQogICAgICAgIGJ1eVByaWNlICAgID0gX2J1eVByaWNlOw0KICAgICAgICBzZWxsUHJpY2UgICA9IF9zZWxsUHJpY2U7DQogICAgICAgIHVuaXRzICAgICAgID0gX3VuaXRzOw0KICAgICAgICBidXlzVG9rZW5zICA9IF9idXlzVG9rZW5zOw0KICAgICAgICBzZWxsc1Rva2VucyA9IF9zZWxsc1Rva2VuczsNCiAgICAgICAgQWN0aXZhdGVkRXZlbnQoYnV5c1Rva2Vucywgc2VsbHNUb2tlbnMpOw0KICAgIH0NCg0KICAgIC8vIE1ha2VyIGNhbiBhY3RpdmF0ZSBvciBkZWFjdGl2YXRlIHRoaXMgY29udHJhY3QncyBidXlpbmcgYW5kDQogICAgLy8gc2VsbGluZyBzdGF0dXMNCiAgICAvLw0KICAgIC8vIFRoZSBBY3RpdmF0ZWRFdmVudCgpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcNCiAgICAvLyBwYXJhbWV0ZXI6DQogICAgLy8gICBidXlzVG9rZW5zICAgdGhpcyBjb250cmFjdCBjYW4gYnV5IGFzc2V0IHRva2Vucw0KICAgIC8vICAgc2VsbHNUb2tlbnMgIHRoaXMgY29udHJhY3QgY2FuIHNlbGwgYXNzZXQgdG9rZW5zDQogICAgLy8NCiAgICBmdW5jdGlvbiBhY3RpdmF0ZSAoDQogICAgICAgIGJvb2wgX2J1eXNUb2tlbnMsDQogICAgICAgIGJvb2wgX3NlbGxzVG9rZW5zDQogICAgKSBvbmx5T3duZXIgew0KICAgICAgICBidXlzVG9rZW5zICA9IF9idXlzVG9rZW5zOw0KICAgICAgICBzZWxsc1Rva2VucyA9IF9zZWxsc1Rva2VuczsNCiAgICAgICAgQWN0aXZhdGVkRXZlbnQoYnV5c1Rva2Vucywgc2VsbHNUb2tlbnMpOw0KICAgIH0NCg0KICAgIC8vIE1ha2VyIGNhbiBkZXBvc2l0IGV0aGVycyB0byB0aGlzIGNvbnRyYWN0IHNvIHRoaXMgY29udHJhY3QNCiAgICAvLyBjYW4gYnV5IGFzc2V0IHRva2Vucy4NCiAgICAvLw0KICAgIC8vIE1ha2VyIGRlcG9zaXRzIGFzc2V0IHRva2VucyB0byB0aGlzIGNvbnRyYWN0IGJ5IGNhbGxpbmcgdGhlDQogICAgLy8gYXNzZXQncyB0cmFuc2ZlcigpIG1ldGhvZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVycw0KICAgIC8vICAgX3RvICAgICBpcyB0aGUgYWRkcmVzcyBvZiBUSElTIGNvbnRyYWN0DQogICAgLy8gICBfdmFsdWUgIGlzIHRoZSBudW1iZXIgb2YgYXNzZXQgdG9rZW5zIHRvIGJlIHRyYW5zZmVycmVkDQogICAgLy8NCiAgICAvLyBUYWtlciBNVVNUIE5PVCBzZW5kIHRva2VucyBkaXJlY3RseSB0byB0aGlzIGNvbnRyYWN0LiBUYWtlcnMNCiAgICAvLyBNVVNUIHVzZSB0aGUgdGFrZXJTZWxsQXNzZXQoKSBtZXRob2QgdG8gc2VsbCBhc3NldCB0b2tlbnMNCiAgICAvLyB0byB0aGlzIGNvbnRyYWN0DQogICAgLy8NCiAgICAvLyBNYWtlciBjYW4gYWxzbyB0cmFuc2ZlciBldGhlcnMgZnJvbSBvbmUgVG9rZW5UcmFkZXIgY29udHJhY3QNCiAgICAvLyB0byBhbm90aGVyIFRva2VuVHJhZGVyIGNvbnRyYWN0LCBib3RoIG93bmVkIGJ5IHRoZSBNYWtlcg0KICAgIC8vDQogICAgLy8gVGhlIE1ha2VyRGVwb3NpdGVkRXRoZXIoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nDQogICAgLy8gcGFyYW1ldGVyOg0KICAgIC8vICAgZXRoZXJzICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyBkZXBvc2l0ZWQgYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIGRlcG9zaXQoKSBpbiB0aGUgb2xkIHZlcnNpb24NCiAgICAvLw0KICAgIGZ1bmN0aW9uIG1ha2VyRGVwb3NpdEV0aGVyKCkgcGF5YWJsZSBvbmx5T3duZXJPclRva2VuVHJhZGVyV2l0aFNhbWVPd25lciB7DQogICAgICAgIE1ha2VyRGVwb3NpdGVkRXRoZXIobXNnLnZhbHVlKTsNCiAgICB9DQoNCiAgICAvLyBNYWtlciBjYW4gd2l0aGRyYXcgYXNzZXQgdG9rZW5zIGZyb20gdGhpcyBjb250cmFjdCwgd2l0aCB0aGUNCiAgICAvLyBmb2xsb3dpbmcgcGFyYW1ldGVyOg0KICAgIC8vICAgdG9rZW5zICBpcyB0aGUgbnVtYmVyIG9mIGFzc2V0IHRva2VucyB0byBiZSB3aXRoZHJhd24NCiAgICAvLw0KICAgIC8vIFRoZSBNYWtlcldpdGhkcmV3QXNzZXQoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nDQogICAgLy8gcGFyYW1ldGVyOg0KICAgIC8vICAgdG9rZW5zICBpcyB0aGUgbnVtYmVyIG9mIHRva2VucyB3aXRoZHJhd24gYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIHdpdGhkcmF3QXNzZXQoKSBpbiB0aGUgb2xkIHZlcnNpb24NCiAgICAvLw0KICAgIGZ1bmN0aW9uIG1ha2VyV2l0aGRyYXdBc3NldCh1aW50MjU2IHRva2Vucykgb25seU93bmVyIHJldHVybnMgKGJvb2wgb2spIHsNCiAgICAgICAgTWFrZXJXaXRoZHJld0Fzc2V0KHRva2Vucyk7DQogICAgICAgIHJldHVybiBFUkMyMChhc3NldCkudHJhbnNmZXIob3duZXIsIHRva2Vucyk7DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIHRyYW5zZmVyIGFzc2V0IHRva2VucyBmcm9tIHRoaXMgY29udHJhY3QgdG8gYW5vdGhlcg0KICAgIC8vIFRva2VuVHJhZGVyIGNvbnRyYWN0LCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyOg0KICAgIC8vICAgdG9Ub2tlblRyYWRlciAgQW5vdGhlciBUb2tlblRyYWRlciBjb250cmFjdCBvd25lZCBieSB0aGUNCiAgICAvLyAgICAgICAgICAgICAgICAgIHNhbWUgb3duZXIgYW5kIHdpdGggdGhlIHNhbWUgYXNzZXQNCiAgICAvLyAgIHRva2VucyAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgYXNzZXQgdG9rZW5zIHRvIGJlIG1vdmVkDQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJUcmFuc2ZlcnJlZEFzc2V0KCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZw0KICAgIC8vIHBhcmFtZXRlcnM6DQogICAgLy8gICB0b1Rva2VuVHJhZGVyICBUaGUgb3RoZXIgVG9rZW5UcmFkZXIgY29udHJhY3Qgb3duZWQgYnkNCiAgICAvLyAgICAgICAgICAgICAgICAgIHRoZSBzYW1lIG93bmVyIGFuZCB3aXRoIHRoZSBzYW1lIGFzc2V0DQogICAgLy8gICB0b2tlbnMgICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHRva2VucyB0cmFuc2ZlcnJlZA0KICAgIC8vDQogICAgLy8gVGhlIGFzc2V0IFRyYW5zZmVyKCkgZXZlbnQgaXMgYWxzbyBsb2dnZWQgZnJvbSB0aGlzIGNvbnRyYWN0DQogICAgLy8gdG8gdGhlIG90aGVyIGNvbnRyYWN0DQogICAgLy8NCiAgICBmdW5jdGlvbiBtYWtlclRyYW5zZmVyQXNzZXQoDQogICAgICAgIFRva2VuVHJhZGVyIHRvVG9rZW5UcmFkZXIsDQogICAgICAgIHVpbnQyNTYgdG9rZW5zDQogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBpZiAob3duZXIgIT0gdG9Ub2tlblRyYWRlci5vd25lcigpIHx8IGFzc2V0ICE9IHRvVG9rZW5UcmFkZXIuYXNzZXQoKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgTWFrZXJUcmFuc2ZlcnJlZEFzc2V0KHRvVG9rZW5UcmFkZXIsIHRva2Vucyk7DQogICAgICAgIHJldHVybiBFUkMyMChhc3NldCkudHJhbnNmZXIodG9Ub2tlblRyYWRlciwgdG9rZW5zKTsNCiAgICB9DQoNCiAgICAvLyBNYWtlciBjYW4gd2l0aGRyYXcgYW55IEVSQzIwIGFzc2V0IHRva2VucyBmcm9tIHRoaXMgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIFRoaXMgbWV0aG9kIGlzIGluY2x1ZGVkIGluIHRoZSBjYXNlIHdoZXJlIHRoaXMgY29udHJhY3QgcmVjZWl2ZXMNCiAgICAvLyB0aGUgd3JvbmcgdG9rZW5zDQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJXaXRoZHJld0VSQzIwVG9rZW4oKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nDQogICAgLy8gcGFyYW1ldGVyOg0KICAgIC8vICAgdG9rZW5BZGRyZXNzICBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgdG9rZW5zIHdpdGhkcmF3biBieSB0aGUgbWFrZXINCiAgICAvLyAgIHRva2VucyAgICAgICAgaXMgdGhlIG51bWJlciBvZiB0b2tlbnMgd2l0aGRyYXduIGJ5IHRoZSBtYWtlcg0KICAgIC8vDQogICAgLy8gVGhpcyBtZXRob2Qgd2FzIGNhbGxlZCB3aXRoZHJhd1Rva2VuKCkgaW4gdGhlIG9sZCB2ZXJzaW9uDQogICAgLy8NCiAgICBmdW5jdGlvbiBtYWtlcldpdGhkcmF3RVJDMjBUb2tlbigNCiAgICAgICAgYWRkcmVzcyB0b2tlbkFkZHJlc3MsDQogICAgICAgIHVpbnQyNTYgdG9rZW5zDQogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBNYWtlcldpdGhkcmV3RVJDMjBUb2tlbih0b2tlbkFkZHJlc3MsIHRva2Vucyk7DQogICAgICAgIHJldHVybiBFUkMyMCh0b2tlbkFkZHJlc3MpLnRyYW5zZmVyKG93bmVyLCB0b2tlbnMpOw0KICAgIH0NCg0KICAgIC8vIE1ha2VyIGNhbiB3aXRoZHJhdyBldGhlcnMgZnJvbSB0aGlzIGNvbnRyYWN0DQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJXaXRoZHJld0V0aGVyKCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXINCiAgICAvLyAgIGV0aGVycyAgaXMgdGhlIG51bWJlciBvZiBldGhlcnMgd2l0aGRyYXduIGJ5IHRoZSBtYWtlcg0KICAgIC8vDQogICAgLy8gVGhpcyBtZXRob2Qgd2FzIGNhbGxlZCB3aXRoZHJhdygpIGluIHRoZSBvbGQgdmVyc2lvbg0KICAgIC8vDQogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0V0aGVyKHVpbnQyNTYgZXRoZXJzKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBpZiAodGhpcy5iYWxhbmNlID49IGV0aGVycykgew0KICAgICAgICAgICAgTWFrZXJXaXRoZHJld0V0aGVyKGV0aGVycyk7DQogICAgICAgICAgICByZXR1cm4gb3duZXIuc2VuZChldGhlcnMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIHRyYW5zZmVyIGV0aGVycyBmcm9tIHRoaXMgY29udHJhY3QgdG8gYW5vdGhlciBUb2tlblRyYWRlcg0KICAgIC8vIGNvbnRyYWN0LCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoNCiAgICAvLyAgIHRvVG9rZW5UcmFkZXIgIEFub3RoZXIgVG9rZW5UcmFkZXIgY29udHJhY3Qgb3duZWQgYnkgdGhlDQogICAgLy8gICAgICAgICAgICAgICAgICBzYW1lIG93bmVyIGFuZCB3aXRoIHRoZSBzYW1lIGFzc2V0DQogICAgLy8gICBldGhlcnMgICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyB0byBiZSBtb3ZlZA0KICAgIC8vDQogICAgLy8gVGhlIE1ha2VyVHJhbnNmZXJyZWRFdGhlcigpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyDQogICAgLy8gICB0b1Rva2VuVHJhZGVyICBUaGUgb3RoZXIgVG9rZW5UcmFkZXIgY29udHJhY3Qgb3duZWQgYnkgdGhlDQogICAgLy8gICAgICAgICAgICAgICAgICBzYW1lIG93bmVyIGFuZCB3aXRoIHRoZSBzYW1lIGFzc2V0DQogICAgLy8gICBldGhlcnMgICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyB0cmFuc2ZlcnJlZA0KICAgIC8vDQogICAgLy8gVGhlIE1ha2VyRGVwb3NpdGVkRXRoZXIoKSBldmVudCBpcyBsb2dnZWQgb24gdGhlIG90aGVyDQogICAgLy8gY29udHJhY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcjoNCiAgICAvLyAgIGV0aGVycyAgaXMgdGhlIG51bWJlciBvZiBldGhlcnMgZGVwb3NpdGVkIGJ5IHRoZSBtYWtlcg0KICAgIC8vDQogICAgZnVuY3Rpb24gbWFrZXJUcmFuc2ZlckV0aGVyKA0KICAgICAgICBUb2tlblRyYWRlciB0b1Rva2VuVHJhZGVyLA0KICAgICAgICB1aW50MjU2IGV0aGVycw0KICAgICkgb25seU93bmVyIHJldHVybnMgKGJvb2wgb2spIHsNCiAgICAgICAgaWYgKG93bmVyICE9IHRvVG9rZW5UcmFkZXIub3duZXIoKSB8fCBhc3NldCAhPSB0b1Rva2VuVHJhZGVyLmFzc2V0KCkpIHsNCiAgICAgICAgICAgIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPj0gZXRoZXJzKSB7DQogICAgICAgICAgICBNYWtlclRyYW5zZmVycmVkRXRoZXIodG9Ub2tlblRyYWRlciwgZXRoZXJzKTsNCiAgICAgICAgICAgIHRvVG9rZW5UcmFkZXIubWFrZXJEZXBvc2l0RXRoZXIudmFsdWUoZXRoZXJzKSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gVGFrZXIgYnV5cyBhc3NldCB0b2tlbnMgYnkgc2VuZGluZyBldGhlcnMNCiAgICAvLw0KICAgIC8vIFRoZSBUYWtlckJvdWdodEFzc2V0KCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzDQogICAgLy8gICBidXllciAgICAgICAgICAgaXMgdGhlIGJ1eWVyJ3MgYWRkcmVzcw0KICAgIC8vICAgZXRoZXJzU2VudCAgICAgIGlzIHRoZSBudW1iZXIgb2YgZXRoZXJzIHNlbnQgYnkgdGhlIGJ1eWVyDQogICAgLy8gICBldGhlcnNSZXR1cm5lZCAgaXMgdGhlIG51bWJlciBvZiBldGhlcnMgc2VudCBiYWNrIHRvIHRoZSBidXllciBhcw0KICAgIC8vICAgICAgICAgICAgICAgICAgIGNoYW5nZQ0KICAgIC8vICAgdG9rZW5zQm91Z2h0ICAgIGlzIHRoZSBudW1iZXIgb2YgYXNzZXQgdG9rZW5zIHNlbnQgdG8gdGhlIGJ1eWVyDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIGJ1eSgpIGluIHRoZSBvbGQgdmVyc2lvbg0KICAgIC8vDQogICAgZnVuY3Rpb24gdGFrZXJCdXlBc3NldCgpIHBheWFibGUgew0KICAgICAgICBpZiAoc2VsbHNUb2tlbnMgfHwgbXNnLnNlbmRlciA9PSBvd25lcikgew0KICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHNlbGxQcmljZSBoYXMgYWxyZWFkeSBiZWVuIHZhbGlkYXRlZCBhcyA+IDANCiAgICAgICAgICAgIHVpbnQgb3JkZXIgICAgPSBtc2cudmFsdWUgLyBzZWxsUHJpY2U7DQogICAgICAgICAgICAvLyBOb3RlIHRoYXQgdW5pdHMgaGFzIGFscmVhZHkgYmVlbiB2YWxpZGF0ZWQgYXMgPiAwDQogICAgICAgICAgICB1aW50IGNhbl9zZWxsID0gRVJDMjAoYXNzZXQpLmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKSAvIHVuaXRzOw0KICAgICAgICAgICAgdWludDI1NiBjaGFuZ2UgPSAwOw0KICAgICAgICAgICAgaWYgKG1zZy52YWx1ZSA+IChjYW5fc2VsbCAqIHNlbGxQcmljZSkpIHsNCiAgICAgICAgICAgICAgICBjaGFuZ2UgID0gbXNnLnZhbHVlIC0gKGNhbl9zZWxsICogc2VsbFByaWNlKTsNCiAgICAgICAgICAgICAgICBvcmRlciA9IGNhbl9zZWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHsNCiAgICAgICAgICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChjaGFuZ2UpKSB0aHJvdzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChvcmRlciA+IDApIHsNCiAgICAgICAgICAgICAgICBpZiAoIUVSQzIwKGFzc2V0KS50cmFuc2Zlcihtc2cuc2VuZGVyLCBvcmRlciAqIHVuaXRzKSkgdGhyb3c7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBUYWtlckJvdWdodEFzc2V0KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSwgY2hhbmdlLCBvcmRlciAqIHVuaXRzKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBSZXR1cm4gdXNlciBmdW5kcyBpZiB0aGUgY29udHJhY3QgaXMgbm90IHNlbGxpbmcNCiAgICAgICAgZWxzZSBpZiAoIW1zZy5zZW5kZXIuc2VuZChtc2cudmFsdWUpKSB0aHJvdzsNCiAgICB9DQoNCiAgICAvLyBUYWtlciBzZWxscyBhc3NldCB0b2tlbnMgZm9yIGV0aGVycyBieToNCiAgICAvLyAxLiBDYWxsaW5nIHRoZSBhc3NldCdzIGFwcHJvdmUoKSBtZXRob2Qgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnMNCiAgICAvLyAgICBfc3BlbmRlciAgICAgICAgICAgIGlzIHRoZSBhZGRyZXNzIG9mIHRoaXMgY29udHJhY3QNCiAgICAvLyAgICBfdmFsdWUgICAgICAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgdG9rZW5zIHRvIGJlIHNvbGQNCiAgICAvLyAyLiBDYWxsaW5nIHRoaXMgdGFrZXJTZWxsQXNzZXQoKSBtZXRob2Qgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcg0KICAgIC8vICAgIGV0aGVyVmFsdWVPZlRva2VucyAgaXMgdGhlIGV0aGVyIHZhbHVlIG9mIHRoZSBhc3NldCB0b2tlbnMgdG8gYmUgc29sZA0KICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgYnkgdGhlIHRha2VyDQogICAgLy8NCiAgICAvLyBUaGUgVGFrZXJTb2xkQXNzZXQoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnMNCiAgICAvLyAgIHNlbGxlciAgICAgICAgICAgICAgICAgIGlzIHRoZSBzZWxsZXIncyBhZGRyZXNzDQogICAgLy8gICBhbW91bnRPZlRva2Vuc1RvU2VsbCAgICBpcyB0aGUgYW1vdW50IG9mIHRoZSBhc3NldCB0b2tlbnMgYmVpbmcNCiAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbGQgYnkgdGhlIHRha2VyDQogICAgLy8gICB0b2tlbnNTb2xkICAgICAgICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHRoZSBhc3NldCB0b2tlbnMgc29sZA0KICAgIC8vICAgZXRoZXJWYWx1ZU9mVG9rZW5zU29sZCAgaXMgdGhlIGV0aGVyIHZhbHVlIG9mIHRoZSBhc3NldCB0b2tlbnMgc29sZA0KICAgIC8vDQogICAgLy8gVGhpcyBtZXRob2Qgd2FzIGNhbGxlZCBzZWxsKCkgaW4gdGhlIG9sZCB2ZXJzaW9uDQogICAgLy8NCiAgICBmdW5jdGlvbiB0YWtlclNlbGxBc3NldCh1aW50MjU2IGFtb3VudE9mVG9rZW5zVG9TZWxsKSB7DQogICAgICAgIGlmIChidXlzVG9rZW5zIHx8IG1zZy5zZW5kZXIgPT0gb3duZXIpIHsNCiAgICAgICAgICAgIC8vIE1heGltdW0gbnVtYmVyIG9mIHRva2VuIHRoZSBjb250cmFjdCBjYW4gYnV5DQogICAgICAgICAgICAvLyBOb3RlIHRoYXQgYnV5UHJpY2UgaGFzIGFscmVhZHkgYmVlbiB2YWxpZGF0ZWQgYXMgPiAwDQogICAgICAgICAgICB1aW50MjU2IGNhbl9idXkgPSB0aGlzLmJhbGFuY2UgLyBidXlQcmljZTsNCiAgICAgICAgICAgIC8vIFRva2VuIGxvdHMgYXZhaWxhYmxlDQogICAgICAgICAgICAvLyBOb3RlIHRoYXQgdW5pdHMgaGFzIGFscmVhZHkgYmVlbiB2YWxpZGF0ZWQgYXMgPiAwDQogICAgICAgICAgICB1aW50MjU2IG9yZGVyID0gYW1vdW50T2ZUb2tlbnNUb1NlbGwgLyB1bml0czsNCiAgICAgICAgICAgIC8vIEFkanVzdCBvcmRlciBmb3IgZnVuZHMgYXZhaWxhYmxlDQogICAgICAgICAgICBpZiAob3JkZXIgPiBjYW5fYnV5KSBvcmRlciA9IGNhbl9idXk7DQogICAgICAgICAgICBpZiAob3JkZXIgPiAwKSB7DQogICAgICAgICAgICAgICAgLy8gRXh0cmFjdCB1c2VyIHRva2Vucw0KICAgICAgICAgICAgICAgIGlmICghRVJDMjAoYXNzZXQpLnRyYW5zZmVyRnJvbShtc2cuc2VuZGVyLCBhZGRyZXNzKHRoaXMpLCBvcmRlciAqIHVuaXRzKSkgdGhyb3c7DQogICAgICAgICAgICAgICAgLy8gUGF5IHVzZXINCiAgICAgICAgICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZChvcmRlciAqIGJ1eVByaWNlKSkgdGhyb3c7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBUYWtlclNvbGRBc3NldChtc2cuc2VuZGVyLCBhbW91bnRPZlRva2Vuc1RvU2VsbCwgb3JkZXIgKiB1bml0cywgb3JkZXIgKiBidXlQcmljZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBUYWtlciBidXlzIHRva2VucyBieSBzZW5kaW5nIGV0aGVycw0KICAgIGZ1bmN0aW9uICgpIHBheWFibGUgew0KICAgICAgICB0YWtlckJ1eUFzc2V0KCk7DQogICAgfQ0KfQ0KDQovLyBUaGlzIGNvbnRyYWN0IGRlcGxveXMgVG9rZW5UcmFkZXIgY29udHJhY3RzIGFuZCBsb2dzIHRoZSBldmVudA0KY29udHJhY3QgVG9rZW5UcmFkZXJGYWN0b3J5IGlzIE93bmVkIHsNCg0KICAgIGV2ZW50IFRyYWRlTGlzdGluZyhhZGRyZXNzIGluZGV4ZWQgb3duZXJBZGRyZXNzLCBhZGRyZXNzIGluZGV4ZWQgdG9rZW5UcmFkZXJBZGRyZXNzLA0KICAgICAgICBhZGRyZXNzIGluZGV4ZWQgYXNzZXQsIHVpbnQyNTYgYnV5UHJpY2UsIHVpbnQyNTYgc2VsbFByaWNlLCB1aW50MjU2IHVuaXRzLA0KICAgICAgICBib29sIGJ1eXNUb2tlbnMsIGJvb2wgc2VsbHNUb2tlbnMpOw0KICAgIGV2ZW50IE93bmVyV2l0aGRyZXdFUkMyMFRva2VuKGFkZHJlc3MgaW5kZXhlZCB0b2tlbkFkZHJlc3MsIHVpbnQyNTYgdG9rZW5zKTsNCg0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiBib29sKSBfdmVyaWZ5Ow0KDQogICAgLy8gQW55b25lIGNhbiBjYWxsIHRoaXMgbWV0aG9kIHRvIHZlcmlmeSB0aGUgc2V0dGluZ3Mgb2YgYQ0KICAgIC8vIFRva2VuVHJhZGVyIGNvbnRyYWN0LiBUaGUgcGFyYW1ldGVycyBhcmU6DQogICAgLy8gICB0cmFkZUNvbnRyYWN0ICBpcyB0aGUgYWRkcmVzcyBvZiBhIFRva2VuVHJhZGVyIGNvbnRyYWN0DQogICAgLy8NCiAgICAvLyBSZXR1cm4gdmFsdWVzOg0KICAgIC8vICAgdmFsaWQgICAgICAgIGRpZCB0aGlzIFRva2VuVHJhZGVyRmFjdG9yeSBjcmVhdGUgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0Pw0KICAgIC8vICAgb3duZXIgICAgICAgIGlzIHRoZSBvd25lciBvZiB0aGUgVG9rZW5UcmFkZXIgY29udHJhY3QNCiAgICAvLyAgIGFzc2V0ICAgICAgICBpcyB0aGUgRVJDMjAgYXNzZXQgYWRkcmVzcw0KICAgIC8vICAgYnV5UHJpY2UgICAgIGlzIHRoZSBidXkgcHJpY2UgaW4gZXRoZXJzIHBlciBgdW5pdHNgIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgc2VsbFByaWNlICAgIGlzIHRoZSBzZWxsIHByaWNlIGluIGV0aGVycyBwZXIgYHVuaXRzYCBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIHVuaXRzICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHVuaXRzIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgYnV5c1Rva2VucyAgIGlzIHRoZSBUb2tlblRyYWRlciBjb250cmFjdCBidXlpbmcgdG9rZW5zPw0KICAgIC8vICAgc2VsbHNUb2tlbnMgIGlzIHRoZSBUb2tlblRyYWRlciBjb250cmFjdCBzZWxsaW5nIHRva2Vucz8NCiAgICAvLw0KICAgIGZ1bmN0aW9uIHZlcmlmeShhZGRyZXNzIHRyYWRlQ29udHJhY3QpIGNvbnN0YW50IHJldHVybnMgKA0KICAgICAgICBib29sICAgIHZhbGlkLA0KICAgICAgICBhZGRyZXNzIG93bmVyLA0KICAgICAgICBhZGRyZXNzIGFzc2V0LA0KICAgICAgICB1aW50MjU2IGJ1eVByaWNlLA0KICAgICAgICB1aW50MjU2IHNlbGxQcmljZSwNCiAgICAgICAgdWludDI1NiB1bml0cywNCiAgICAgICAgYm9vbCAgICBidXlzVG9rZW5zLA0KICAgICAgICBib29sICAgIHNlbGxzVG9rZW5zDQogICAgKSB7DQogICAgICAgIHZhbGlkID0gX3ZlcmlmeVt0cmFkZUNvbnRyYWN0XTsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgICBUb2tlblRyYWRlciB0ID0gVG9rZW5UcmFkZXIodHJhZGVDb250cmFjdCk7DQogICAgICAgICAgICBvd25lciAgICAgICAgID0gdC5vd25lcigpOw0KICAgICAgICAgICAgYXNzZXQgICAgICAgICA9IHQuYXNzZXQoKTsNCiAgICAgICAgICAgIGJ1eVByaWNlICAgICAgPSB0LmJ1eVByaWNlKCk7DQogICAgICAgICAgICBzZWxsUHJpY2UgICAgID0gdC5zZWxsUHJpY2UoKTsNCiAgICAgICAgICAgIHVuaXRzICAgICAgICAgPSB0LnVuaXRzKCk7DQogICAgICAgICAgICBidXlzVG9rZW5zICAgID0gdC5idXlzVG9rZW5zKCk7DQogICAgICAgICAgICBzZWxsc1Rva2VucyAgID0gdC5zZWxsc1Rva2VucygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIGNhbGwgdGhpcyBtZXRob2QgdG8gY3JlYXRlIGEgbmV3IFRva2VuVHJhZGVyIGNvbnRyYWN0DQogICAgLy8gd2l0aCB0aGUgbWFrZXIgYmVpbmcgdGhlIG93bmVyIG9mIHRoaXMgbmV3IGNvbnRyYWN0DQogICAgLy8NCiAgICAvLyBQYXJhbWV0ZXJzOg0KICAgIC8vICAgYXNzZXQgICAgICAgIGlzIHRoZSBFUkMyMCBhc3NldCBhZGRyZXNzDQogICAgLy8gICBidXlQcmljZSAgICAgaXMgdGhlIGJ1eSBwcmljZSBpbiBldGhlcnMgcGVyIGB1bml0c2Agb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICBzZWxsUHJpY2UgICAgaXMgdGhlIHNlbGwgcHJpY2UgaW4gZXRoZXJzIHBlciBgdW5pdHNgIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgdW5pdHMgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgdW5pdHMgb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICBidXlzVG9rZW5zICAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IGJ1eWluZyB0b2tlbnM/DQogICAgLy8gICBzZWxsc1Rva2VucyAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IHNlbGxpbmcgdG9rZW5zPw0KICAgIC8vDQogICAgLy8gRm9yIGV4YW1wbGUsIGxpc3RpbmcgYSBUb2tlblRyYWRlciBjb250cmFjdCBvbiB0aGUgUkVQIEF1Z3VyIHRva2VuIHdoZXJlDQogICAgLy8gdGhlIGNvbnRyYWN0IHdpbGwgYnV5IFJFUCB0b2tlbnMgYXQgYSByYXRlIG9mIDM5MDAwLzEwMDAwMCA9IDAuMzkgRVRIDQogICAgLy8gcGVyIFJFUCB0b2tlbiBhbmQgc2VsbCBSRVAgdG9rZW5zIGF0IGEgcmF0ZSBvZiA0MTAwMC8xMDAwMDAgPSAwLjQxIEVUSA0KICAgIC8vIHBlciBSRVAgdG9rZW46DQogICAgLy8gICBhc3NldCAgICAgICAgMHg0OGM4MGYxZjRkNTNkNTk1MWU1ZDU0MzhiNTRjYmE4NGYyOWYzMmE1DQogICAgLy8gICBidXlQcmljZSAgICAgMzkwMDANCiAgICAvLyAgIHNlbGxQcmljZSAgICA0MTAwMA0KICAgIC8vICAgdW5pdHMgICAgICAgIDEwMDAwMA0KICAgIC8vICAgYnV5c1Rva2VucyAgIHRydWUNCiAgICAvLyAgIHNlbGxzVG9rZW5zICB0cnVlDQogICAgLy8NCiAgICAvLyBUaGUgVHJhZGVMaXN0aW5nKCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzDQogICAgLy8gICBvd25lckFkZHJlc3MgICAgICAgIGlzIHRoZSBNYWtlcidzIGFkZHJlc3MNCiAgICAvLyAgIHRva2VuVHJhZGVyQWRkcmVzcyAgaXMgdGhlIGFkZHJlc3Mgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgVG9rZW5UcmFkZXIgY29udHJhY3QNCiAgICAvLyAgIGFzc2V0ICAgICAgICAgICAgICAgaXMgdGhlIEVSQzIwIGFzc2V0IGFkZHJlc3MNCiAgICAvLyAgIGJ1eVByaWNlICAgICAgICAgICAgaXMgdGhlIGJ1eSBwcmljZSBpbiBldGhlcnMgcGVyIGB1bml0c2Agb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICBzZWxsUHJpY2UgICAgICAgICAgIGlzIHRoZSBzZWxsIHByaWNlIGluIGV0aGVycyBwZXIgYHVuaXRzYCBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIHVuaXQgICAgICAgICAgICAgICAgaXMgdGhlIG51bWJlciBvZiB1bml0cyBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIGJ1eXNUb2tlbnMgICAgICAgICAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IGJ1eWluZyB0b2tlbnM/DQogICAgLy8gICBzZWxsc1Rva2VucyAgICAgICAgIGlzIHRoZSBUb2tlblRyYWRlciBjb250cmFjdCBzZWxsaW5nIHRva2Vucz8NCiAgICAvLw0KICAgIGZ1bmN0aW9uIGNyZWF0ZVRyYWRlQ29udHJhY3QoDQogICAgICAgIGFkZHJlc3MgYXNzZXQsDQogICAgICAgIHVpbnQyNTYgYnV5UHJpY2UsDQogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLA0KICAgICAgICB1aW50MjU2IHVuaXRzLA0KICAgICAgICBib29sICAgIGJ1eXNUb2tlbnMsDQogICAgICAgIGJvb2wgICAgc2VsbHNUb2tlbnMNCiAgICApIHJldHVybnMgKGFkZHJlc3MgdHJhZGVyKSB7DQogICAgICAgIC8vIENhbm5vdCBoYXZlIGludmFsaWQgYXNzZXQNCiAgICAgICAgaWYgKGFzc2V0ID09IDB4MCkgdGhyb3c7DQogICAgICAgIC8vIENoZWNrIGZvciBFUkMyMCBhbGxvd2FuY2UgZnVuY3Rpb24NCiAgICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGFuIGVycm9yIGlmIHRoZSBhbGxvd2FuY2UgZnVuY3Rpb24NCiAgICAgICAgLy8gaXMgdW5kZWZpbmVkIHRvIHByZXZlbnQgR05UcyBmcm9tIGJlaW5nIHVzZWQNCiAgICAgICAgLy8gd2l0aCB0aGlzIGZhY3RvcnkNCiAgICAgICAgdWludDI1NiBhbGxvd2FuY2UgPSBFUkMyMChhc3NldCkuYWxsb3dhbmNlKG1zZy5zZW5kZXIsIHRoaXMpOw0KICAgICAgICAvLyBDYW5ub3Qgc2V0IHplcm8gb3IgbmVnYXRpdmUgcHJpY2UNCiAgICAgICAgaWYgKGJ1eVByaWNlIDw9IDAgfHwgc2VsbFByaWNlIDw9IDApIHRocm93Ow0KICAgICAgICAvLyBNdXN0IG1ha2UgcHJvZml0IG9uIHNwcmVhZA0KICAgICAgICBpZiAoYnV5UHJpY2UgPj0gc2VsbFByaWNlKSB0aHJvdzsNCiAgICAgICAgLy8gQ2Fubm90IGJ1eSBvciBzZWxsIHplcm8gb3IgbmVnYXRpdmUgdW5pdHMNCiAgICAgICAgaWYgKHVuaXRzIDw9IDApIHRocm93Ow0KDQogICAgICAgIHRyYWRlciA9IG5ldyBUb2tlblRyYWRlcigNCiAgICAgICAgICAgIGFzc2V0LA0KICAgICAgICAgICAgYnV5UHJpY2UsDQogICAgICAgICAgICBzZWxsUHJpY2UsDQogICAgICAgICAgICB1bml0cywNCiAgICAgICAgICAgIGJ1eXNUb2tlbnMsDQogICAgICAgICAgICBzZWxsc1Rva2Vucyk7DQogICAgICAgIC8vIFJlY29yZCB0aGF0IHRoaXMgZmFjdG9yeSBjcmVhdGVkIHRoZSB0cmFkZXINCiAgICAgICAgX3ZlcmlmeVt0cmFkZXJdID0gdHJ1ZTsNCiAgICAgICAgLy8gU2V0IHRoZSBvd25lciB0byB3aG9ldmVyIGNhbGxlZCB0aGUgZnVuY3Rpb24NCiAgICAgICAgVG9rZW5UcmFkZXIodHJhZGVyKS50cmFuc2Zlck93bmVyc2hpcChtc2cuc2VuZGVyKTsNCiAgICAgICAgVHJhZGVMaXN0aW5nKG1zZy5zZW5kZXIsIHRyYWRlciwgYXNzZXQsIGJ1eVByaWNlLCBzZWxsUHJpY2UsIHVuaXRzLCBidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7DQogICAgfQ0KDQogICAgLy8gRmFjdG9yeSBvd25lciBjYW4gd2l0aGRyYXcgYW55IEVSQzIwIGFzc2V0IHRva2VucyBmcm9tIHRoaXMgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIFRoaXMgbWV0aG9kIGlzIGluY2x1ZGVkIGluIHRoZSBjYXNlIHdoZXJlIHRoaXMgY29udHJhY3QgcmVjZWl2ZXMNCiAgICAvLyB0aGUgd3JvbmcgdG9rZW5zDQogICAgLy8NCiAgICAvLyBUaGUgT3duZXJXaXRoZHJld0VSQzIwVG9rZW4oKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nDQogICAgLy8gcGFyYW1ldGVyOg0KICAgIC8vICAgdG9rZW5BZGRyZXNzICBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgdG9rZW5zIHdpdGhkcmF3biBieSB0aGUgbWFrZXINCiAgICAvLyAgIHRva2VucyAgICAgICAgaXMgdGhlIG51bWJlciBvZiB0b2tlbnMgd2l0aGRyYXduIGJ5IHRoZSBtYWtlcg0KICAgIC8vDQogICAgZnVuY3Rpb24gb3duZXJXaXRoZHJhd0VSQzIwVG9rZW4oYWRkcmVzcyB0b2tlbkFkZHJlc3MsIHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBPd25lcldpdGhkcmV3RVJDMjBUb2tlbih0b2tlbkFkZHJlc3MsIHRva2Vucyk7DQogICAgICAgIHJldHVybiBFUkMyMCh0b2tlbkFkZHJlc3MpLnRyYW5zZmVyKG93bmVyLCB0b2tlbnMpOw0KICAgIH0NCg0KICAgIC8vIFByZXZlbnRzIGFjY2lkZW50YWwgc2VuZGluZyBvZiBldGhlciB0byB0aGUgZmFjdG9yeQ0KICAgIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhyb3c7DQogICAgfQ0KfQ0KDQpjb250cmFjdCBGaXhlZFN1cHBseVRva2VuIGlzIEVSQzIwIHsNCiAgICBzdHJpbmcgcHVibGljIG5hbWU7DQogICAgc3RyaW5nIHB1YmxpYyBzeW1ib2w7DQogICAgdWludDI1NiBfdG90YWxTdXBwbHk7DQogICAgdWludDggcHVibGljIGRlY2ltYWxzOw0KDQogICAgLy8gQmFsYW5jZXMgZm9yIGVhY2ggYWNjb3VudA0KICAgIG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSBiYWxhbmNlczsNCg0KICAgIC8vIE93bmVyIG9mIGFjY291bnQgYXBwcm92ZXMgdGhlIHRyYW5zZmVyIG9mIGFuIGFtb3VudCB0byBhbm90aGVyIGFjY291bnQNCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiB1aW50MjU2KSkgYWxsb3dlZDsNCg0KICAgIC8vIENvbnN0cnVjdG9yDQogICAgZnVuY3Rpb24gRml4ZWRTdXBwbHlUb2tlbigNCiAgICAgIHN0cmluZyBfbmFtZSwNCiAgICAgIHN0cmluZyBfc3ltYm9sLA0KICAgICAgdWludDI1NiBfc3VwcGx5LA0KICAgICAgdWludDggX2RlY2ltYWxzDQogICAgKSB7DQogICAgICAgIG5hbWUgPSBfbmFtZTsNCiAgICAgICAgc3ltYm9sID0gX3N5bWJvbDsNCiAgICAgICAgX3RvdGFsU3VwcGx5ID0gX3N1cHBseTsNCiAgICAgICAgZGVjaW1hbHMgPSBfZGVjaW1hbHM7DQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gX3RvdGFsU3VwcGx5Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFN1cHBseSkgew0KICAgICAgICB0b3RhbFN1cHBseSA9IF90b3RhbFN1cHBseTsNCiAgICB9DQoNCiAgICAvLyBXaGF0IGlzIHRoZSBiYWxhbmNlIG9mIGEgcGFydGljdWxhciBhY2NvdW50Pw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBiYWxhbmNlKSB7DQogICAgICAgIHJldHVybiBiYWxhbmNlc1tfb3duZXJdOw0KICAgIH0NCg0KICAgIC8vIFRyYW5zZmVyIHRoZSBiYWxhbmNlIGZyb20gb3duZXIncyBhY2NvdW50IHRvIGFub3RoZXIgYWNjb3VudA0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX2Ftb3VudA0KICAgICAgICAgICAgJiYgX2Ftb3VudCA+IDANCiAgICAgICAgICAgICYmIGJhbGFuY2VzW190b10gKyBfYW1vdW50ID4gYmFsYW5jZXNbX3RvXSkgew0KICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsNCiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX2Ftb3VudDsNCiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX2Ftb3VudCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFNlbmQgX3ZhbHVlIGFtb3VudCBvZiB0b2tlbnMgZnJvbSBhZGRyZXNzIF9mcm9tIHRvIGFkZHJlc3MgX3RvDQogICAgLy8gVGhlIHRyYW5zZmVyRnJvbSBtZXRob2QgaXMgdXNlZCBmb3IgYSB3aXRoZHJhdyB3b3JrZmxvdywgYWxsb3dpbmcgY29udHJhY3RzIHRvIHNlbmQNCiAgICAvLyB0b2tlbnMgb24geW91ciBiZWhhbGYsIGZvciBleGFtcGxlIHRvICJkZXBvc2l0IiB0byBhIGNvbnRyYWN0IGFkZHJlc3MgYW5kL29yIHRvIGNoYXJnZQ0KICAgIC8vIGZlZXMgaW4gc3ViLWN1cnJlbmNpZXM7IHRoZSBjb21tYW5kIHNob3VsZCBmYWlsIHVubGVzcyB0aGUgX2Zyb20gYWNjb3VudCBoYXMNCiAgICAvLyBkZWxpYmVyYXRlbHkgYXV0aG9yaXplZCB0aGUgc2VuZGVyIG9mIHRoZSBtZXNzYWdlIHZpYSBzb21lIG1lY2hhbmlzbTsgd2UgcHJvcG9zZQ0KICAgIC8vIHRoZXNlIHN0YW5kYXJkaXplZCBBUElzIGZvciBhcHByb3ZhbDoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oDQogICAgICAgIGFkZHJlc3MgX2Zyb20sDQogICAgICAgIGFkZHJlc3MgX3RvLA0KICAgICAgICB1aW50MjU2IF9hbW91bnQNCiAgICApIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICBpZiAoYmFsYW5jZXNbX2Zyb21dID49IF9hbW91bnQNCiAgICAgICAgICAgICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF9hbW91bnQNCiAgICAgICAgICAgICYmIF9hbW91bnQgPiAwDQogICAgICAgICAgICAmJiBiYWxhbmNlc1tfdG9dICsgX2Ftb3VudCA+IGJhbGFuY2VzW190b10pIHsNCiAgICAgICAgICAgIGJhbGFuY2VzW19mcm9tXSAtPSBfYW1vdW50Ow0KICAgICAgICAgICAgYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl0gLT0gX2Ftb3VudDsNCiAgICAgICAgICAgIGJhbGFuY2VzW190b10gKz0gX2Ftb3VudDsNCiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF9hbW91bnQpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBBbGxvdyBfc3BlbmRlciB0byB3aXRoZHJhdyBmcm9tIHlvdXIgYWNjb3VudCwgbXVsdGlwbGUgdGltZXMsIHVwIHRvIHRoZSBfdmFsdWUgYW1vdW50Lg0KICAgIC8vIElmIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluIGl0IG92ZXJ3cml0ZXMgdGhlIGN1cnJlbnQgYWxsb3dhbmNlIHdpdGggX3ZhbHVlLg0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludDI1NiBfYW1vdW50KSByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgYWxsb3dlZFttc2cuc2VuZGVyXVtfc3BlbmRlcl0gPSBfYW1vdW50Ow0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX2Ftb3VudCk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiByZW1haW5pbmcpIHsNCiAgICAgICAgcmV0dXJuIGFsbG93ZWRbX293bmVyXVtfc3BlbmRlcl07DQogICAgfQ0KfQ0KDQpjb250cmFjdCBUb2tlblRva2VuIGlzIEZpeGVkU3VwcGx5VG9rZW57DQogIFRva2VuVHJhZGVyW10gcHVibGljIHRva2VuRXhjaGFuZ2VzOw0KICB1aW50MjU2W10gcHVibGljIHRva2VuUmF0aW9zOyAvLyBNZWFzdXJlZCBpbiBwZXIgMWUxOCwgZS5nLmcgNWUxNyA9IDUwJQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUb2tlblJhdGlvcyBNVVNUIEFERCBUTyAxICgxZTE4KQ0KICB1aW50MjU2IHRva2Vuc0JvdWdodCA9IDA7DQoNCiAgYWRkcmVzcyBwdWJsaWMgb3duZXI7DQogIGV2ZW50IE93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90byk7DQoNCiAgLyogVGhpcyBnZW5lcmF0ZXMgYSBwdWJsaWMgZXZlbnQgb24gdGhlIGJsb2NrY2hhaW4gdGhhdCB3aWxsIG5vdGlmeSBjbGllbnRzICovDQogIC8vZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQoNCiAgLyogSW5pdGlhbGl6ZXMgY29udHJhY3Qgd2l0aCBpbml0aWFsIHN1cHBseSB0b2tlbnMgdG8gdGhlIGNyZWF0b3Igb2YgdGhlIGNvbnRyYWN0ICovDQoNCiAgZnVuY3Rpb24gVG9rZW5Ub2tlbigNCiAgICBzdHJpbmcgX25hbWUsDQogICAgc3RyaW5nIF9zeW1ib2wsDQogICAgdWludDI1NiBfc3VwcGx5LA0KICAgIHVpbnQ4IF9kZWNpbWFscywNCiAgICBUb2tlblRyYWRlcltdIGluaXRpYWxUb2tlbkV4Y2hhbmdlcywNCiAgICB1aW50MjU2W10gaW5pdGlhbFRva2VuUmF0aW9zDQogICAgKSBGaXhlZFN1cHBseVRva2VuKA0KICAgICAgX25hbWUsDQogICAgICBfc3ltYm9sLA0KICAgICAgX3N1cHBseSwNCiAgICAgIF9kZWNpbWFscw0KICAgICkgew0KICAgIHRva2VuRXhjaGFuZ2VzID0gaW5pdGlhbFRva2VuRXhjaGFuZ2VzOw0KICAgIHRva2VuUmF0aW9zID0gaW5pdGlhbFRva2VuUmF0aW9zOw0KICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgfQ0KDQogIG1vZGlmaWVyIG9ubHlPd25lciB7DQogICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICBfOw0KICB9DQoNCiAgZnVuY3Rpb24gdHJhbnNmZXJPd25lcnNoaXAoYWRkcmVzcyBuZXdPd25lcikgb25seU93bmVyIHsNCiAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKG93bmVyLCBuZXdPd25lcik7DQogICAgICBvd25lciA9IG5ld093bmVyOw0KICB9DQoNCiAgZnVuY3Rpb24gc2V0UHVyY2hhc2VSYXRpb3MgKA0KICAgIFRva2VuVHJhZGVyW10gbmV3VG9rZW5FeGNoYW5nZXMsDQogICAgdWludDI1NltdIG5ld1Rva2VuUmF0aW9zDQogICkgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgLy8gU2hvdWxkIGhhdmUgYSBsb3Qgb2YgYXNzZXJ0aW9ucw0KICAgICAgLy8gVE9ETzogQXNzZXJ0IG5ld1Rva2VuUmF0aW9zLmxlbmd0aCA9PSB0b2tlblJhdGlvcy5sZW5ndGgNCiAgICAgIC8vIFRPRE86IEFzc2VydCBuZXdUb2tlblJhdGlvcyBhZGQgdG8gMQ0KICAgICAgdG9rZW5FeGNoYW5nZXMgPSBuZXdUb2tlbkV4Y2hhbmdlczsNCiAgICAgIHRva2VuUmF0aW9zID0gbmV3VG9rZW5SYXRpb3M7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGJ1eVByaWNlKCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiB0b3RhbFByaWNlKSB7DQogICAgdG90YWxQcmljZSA9IDA7DQogICAgZm9yICh1aW50IGkgPSAwOyBpIDwgdG9rZW5FeGNoYW5nZXMubGVuZ3RoOyArK2kpIHsNCiAgICAgIHRvdGFsUHJpY2UgKz0gdG9rZW5FeGNoYW5nZXNbaV0uYnV5UHJpY2UoKSAqIHRva2VuUmF0aW9zW2ldIC8gMWUxODsNCiAgICB9DQogICAgcmV0dXJuIHRvdGFsUHJpY2U7DQogIH0NCg0KICBmdW5jdGlvbiBzZWxsUHJpY2UoKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHRvdGFsUHJpY2UpIHsNCiAgICB0b3RhbFByaWNlID0gMDsNCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB0b2tlbkV4Y2hhbmdlcy5sZW5ndGg7ICsraSkgew0KICAgICAgdG90YWxQcmljZSArPSB0b2tlbkV4Y2hhbmdlc1tpXS5zZWxsUHJpY2UoKSAqIHRva2VuUmF0aW9zW2ldIC8gMWUxODsNCiAgICB9DQogICAgcmV0dXJuIHRvdGFsUHJpY2U7DQogIH0NCg0KICBmdW5jdGlvbiAoKSB7IC8vIFNlbmRpbmcgZXRoZXIgdG8gaXQgYnV5cyBjb2lucyBhdXRvbWF0aWNhbGx5DQogICAgYnV5KCk7DQogIH0NCiAgZnVuY3Rpb24gYnV5KCkgcGF5YWJsZSByZXR1cm5zICh1aW50MjU2IGFtb3VudCl7ICAgICAgICAvLyBCdXkgaW4gRVRIDQoNCiAgICBhbW91bnQgPSBtc2cudmFsdWUgLyBidXlQcmljZSgpOw0KICAgIGZvciAodWludCBpID0gMDsgaSA8IHRva2VuRXhjaGFuZ2VzLmxlbmd0aDsgKytpKSB7DQogICAgICBUb2tlblRyYWRlciB0b2tlbkV4Y2hhbmdlID0gdG9rZW5FeGNoYW5nZXNbaV07DQogICAgICB0b2tlbkV4Y2hhbmdlLnRyYW5zZmVyKG1zZy52YWx1ZSAqIHRva2VuUmF0aW9zW2ldIC8gMWUxOCk7DQogICAgfQ0KICAgIHRva2Vuc0JvdWdodCArPSBhbW91bnQ7DQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAvLyBhZGRzIHRoZSBhbW91bnQgdG8gYnV5ZXIncyBiYWxhbmNlDQogICAgYmFsYW5jZXNbdGhpc10gLT0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdWJ0cmFjdHMgYW1vdW50IGZyb20gc2VsbGVyJ3MgYmFsYW5jZQ0KICAgIFRyYW5zZmVyKHRoaXMsIG1zZy5zZW5kZXIsIGFtb3VudCk7ICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGUgYW4gZXZlbnQgcmVmbGVjdGluZyB0aGUgY2hhbmdlDQogICAgcmV0dXJuIGFtb3VudDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5kcyBmdW5jdGlvbiBhbmQgcmV0dXJucw0KICB9DQoNCiAgZnVuY3Rpb24gc2VsbCh1aW50IGFtb3VudCkgcmV0dXJucyAodWludDI1NiByZXZlbnVlKXsgICAvLyBTZWxsIGluIHRva2Vucw0KICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA8IGFtb3VudCApIHRocm93OyAgICAgICAgLy8gY2hlY2tzIGlmIHRoZSBzZW5kZXIgaGFzIGVub3VnaCB0byBzZWxsDQogICAgYmFsYW5jZXNbdGhpc10gKz0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRzIHRoZSBhbW91bnQgdG8gb3duZXIncyBiYWxhbmNlDQogICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gYW1vdW50OyAgICAgICAgICAgICAgICAgICAvLyBzdWJ0cmFjdHMgdGhlIGFtb3VudCBmcm9tIHNlbGxlcidzIGJhbGFuY2UNCg0KICAgIHVpbnQyNTYgc3ViVG9rZW5zVG9TZWxsID0gMDsNCiAgICByZXZlbnVlID0gMDsNCiAgICBmb3IgKHVpbnQgaSA9IDA7IGkgPCB0b2tlbkV4Y2hhbmdlcy5sZW5ndGg7ICsraSkgeyAvLyBVbnNhZmUgY29kZTogd2hhdCBpZiB0aGUgbG9vcCBlcnJvcnMgaGFsZndheT8NCiAgICAgIFRva2VuVHJhZGVyIHRva2VuRXhjaGFuZ2UgPSB0b2tlbkV4Y2hhbmdlc1tpXTsNCiAgICAgIHN1YlRva2Vuc1RvU2VsbCA9IEVSQzIwKHRva2VuRXhjaGFuZ2UuYXNzZXQoKSkuYmFsYW5jZU9mKHRoaXMpKmFtb3VudC90b2tlbnNCb3VnaHQ7DQoNCiAgICAgIHJldmVudWUgKz0gc3ViVG9rZW5zVG9TZWxsICogdG9rZW5FeGNoYW5nZS5zZWxsUHJpY2UoKTsNCiAgICAgIEVSQzIwKHRva2VuRXhjaGFuZ2UuYXNzZXQoKSkuYXBwcm92ZShhZGRyZXNzKHRva2VuRXhjaGFuZ2UpLCBzdWJUb2tlbnNUb1NlbGwpOyAvLyBBcHByb3ZlIHNhbGUNCiAgICAgIHRva2VuRXhjaGFuZ2UudGFrZXJTZWxsQXNzZXQoc3ViVG9rZW5zVG9TZWxsKTsgLy8gTWFrZSBTYWxlDQogICAgfQ0KDQogICAgdG9rZW5zQm91Z2h0IC09IGFtb3VudDsNCiAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKHJldmVudWUpOw0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRoaXMsIGFtb3VudCk7ICAgICAgICAgICAgLy8gZXhlY3V0ZXMgYW4gZXZlbnQgcmVmbGVjdGluZyBvbiB0aGUgY2hhbmdlDQogICAgcmV0dXJuIHJldmVudWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbmRzIGZ1bmN0aW9uIGFuZCByZXR1cm5zDQogIH0NCg0KICBmdW5jdGlvbiBicmVha2Rvd24odWludDI1NiBhbW91bnQpIHsgICAvLyBCcmVha2Rvd24gaW4gdG9rZW5zDQogICAgaWYgKGJhbGFuY2VzW21zZy5zZW5kZXJdIDwgYW1vdW50ICkgdGhyb3c7ICAgICAgICAvLyBjaGVja3MgaWYgdGhlIHNlbmRlciBoYXMgZW5vdWdoIHRvIHNlbGwNCiAgICBiYWxhbmNlc1t0aGlzXSArPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZHMgdGhlIGFtb3VudCB0byBvd25lcidzIGJhbGFuY2UNCiAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSAtPSBhbW91bnQ7ICAgICAgICAgICAgICAgICAgIC8vIHN1YnRyYWN0cyB0aGUgYW1vdW50IGZyb20gc2VsbGVyJ3MgYmFsYW5jZQ0KDQogICAgdWludDI1NiBzdWJUb2tlbnNUb1NlbGwgPSAwOw0KICAgIGZvciAodWludCBpID0gMDsgaSA8IHRva2VuRXhjaGFuZ2VzLmxlbmd0aDsgKytpKSB7IC8vIFVuc2FmZSBjb2RlOiB3aGF0IGlmIHRoZSBsb29wIGVycm9ycyBoYWxmd2F5Pw0KICAgICAgVG9rZW5UcmFkZXIgdG9rZW5FeGNoYW5nZSA9IHRva2VuRXhjaGFuZ2VzW2ldOw0KICAgICAgc3ViVG9rZW5zVG9TZWxsID0gRVJDMjAodG9rZW5FeGNoYW5nZS5hc3NldCgpKS5iYWxhbmNlT2YodGhpcykqYW1vdW50L3Rva2Vuc0JvdWdodDsNCiAgICAgIEVSQzIwKHRva2VuRXhjaGFuZ2UuYXNzZXQoKSkudHJhbnNmZXIobXNnLnNlbmRlciwgc3ViVG9rZW5zVG9TZWxsKTsNCiAgICB9DQoNCiAgICB0b2tlbnNCb3VnaHQgLT0gYW1vdW50Ow0KICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRoaXMsIGFtb3VudCk7ICAgICAgICAgICAgLy8gZXhlY3V0ZXMgYW4gZXZlbnQgcmVmbGVjdGluZyBvbiB0aGUgY2hhbmdlDQogIH0NCg0KICBmdW5jdGlvbiByZWJhbGFuY2UoVG9rZW5UcmFkZXIgZnJvbUV4Y2hhbmdlLCBUb2tlblRyYWRlciB0b0V4Y2hhbmdlLCB1aW50MjU2IGZyb21QZXJjZW50KSBvbmx5T3duZXIgew0KICAgIHVpbnQyNTYgc3ViVG9rZW5zVG9TZWxsID0gRVJDMjAoZnJvbUV4Y2hhbmdlLmFzc2V0KCkpLmJhbGFuY2VPZih0aGlzKSAqIGZyb21QZXJjZW50IC8gMWUxODsNCg0KICAgIHVpbnQyNTYgcmV2ZW51ZSA9IHN1YlRva2Vuc1RvU2VsbCAqIGZyb21FeGNoYW5nZS5zZWxsUHJpY2UoKTsNCiAgICBFUkMyMChmcm9tRXhjaGFuZ2UuYXNzZXQoKSkuYXBwcm92ZShhZGRyZXNzKGZyb21FeGNoYW5nZSksIHN1YlRva2Vuc1RvU2VsbCk7IC8vIEFwcHJvdmUgc2FsZQ0KICAgIGZyb21FeGNoYW5nZS50YWtlclNlbGxBc3NldChzdWJUb2tlbnNUb1NlbGwpOyAvLyBNYWtlIHNhbGUNCg0KICAgIHRvRXhjaGFuZ2UudHJhbnNmZXIocmV2ZW51ZSk7IC8vIE1ha2UgcHVyY2hhc2Ugd2l0aCBuZXcgY29udHJhY3QuDQogIH0NCg0KICBmdW5jdGlvbiBraWxsKCkgeyBpZiAobXNnLnNlbmRlciA9PSBvd25lcikgc2VsZmRlc3RydWN0KG93bmVyKTsgfQ0KfQ=='