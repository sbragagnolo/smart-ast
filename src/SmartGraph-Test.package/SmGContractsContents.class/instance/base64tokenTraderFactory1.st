base 64 content
base64tokenTraderFactory1
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC40Ow0KDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIFRva2VuVHJhZGVyRmFjdG9yeQ0KLy8NCi8vIERlY2VudHJhbGlzZWQgdHJ1c3RsZXNzIEVSQzIwLWNvbXBsaWFudCB0b2tlbiB0byBFVEggZXhjaGFuZ2UgY29udHJhY3QNCi8vIG9uIHRoZSBFdGhlcmV1bSBibG9ja2NoYWluLg0KLy8NCi8vIE5vdGUgdGhhdCB0aGlzIFRva2VuVHJhZGVyIGNhbm5vdCBiZSB1c2VkIHdpdGggdGhlIEdvbGVtIE5ldHdvcmsgVG9rZW4NCi8vIGRpcmVjdGx5IGFzIHRoZSB0b2tlbiBkb2VzIG5vdCBpbXBsZW1lbnQgdGhlIEVSQzIwDQovLyB0cmFuc2ZlckZyb20oLi4uKSwgYXBwcm92ZSguLi4pIGFuZCBhbGxvd2FuY2UoLi4uKSBtZXRob2RzDQovLw0KLy8gSGlzdG9yeToNCi8vICAgSmFuIDI1IDIwMTcgLSBCUEIgQWRkZWQgbWFrZXJUcmFuc2ZlckFzc2V0KC4uLikgYW5kDQovLyAgICAgICAgICAgICAgICAgICAgIG1ha2VyVHJhbnNmZXJFdGhlciguLi4pDQovLyAgIEZlYiAwNSAyMDE3IC0gQlBCIEJ1ZyBmaXggaW4gdGhlIGNoYW5nZSBjYWxjdWxhdGlvbiBmb3IgdGhlIFVuaWNvcm4NCi8vICAgICAgICAgICAgICAgICAgICAgdG9rZW4gd2l0aCBuYXR1cmFsIG51bWJlciAxDQovLyAgIEZlYiAwOCAyMDE3IC0gQlBCL0pMIFJlbmFtZWQgZXRoZXJWYWx1ZU9mVG9rZW5zVG9TZWxsIHRvDQovLyAgICAgICAgICAgICAgICAgICAgIGFtb3VudE9mVG9rZW5zVG9TZWxsIGluIHRha2VyU2VsbEFzc2V0KC4uLikgdG8NCi8vICAgICAgICAgICAgICAgICAgICAgYmV0dGVyIGRlc2NyaWJlIHRoZSBwYXJhbWV0ZXINCi8vICAgICAgICAgICAgICAgICAgICAgQWRkZWQgY2hlY2sgaW4gY3JlYXRlVHJhZGVDb250cmFjdCguLi4pIHRvIHByZXZlbnQNCi8vICAgICAgICAgICAgICAgICAgICAgR05UcyBmcm9tIGJlaW5nIHVzZWQgd2l0aCB0aGlzIGNvbnRyYWN0LiBUaGUgYXNzZXQNCi8vICAgICAgICAgICAgICAgICAgICAgdG9rZW4gd2lsbCBuZWVkIHRvIGhhdmUgYW4gYWxsb3dhbmNlKC4uLikgZnVuY3Rpb24uDQovLw0KLy8gRW5qb3kuIChjKSBKb25ueUxhdHRlICYgQm9ra3lQb29CYWggMjAxNy4gVGhlIE1JVCBsaWNlbmNlLg0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMA0KY29udHJhY3QgRVJDMjAgew0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludCB0b3RhbFN1cHBseSk7DQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IGJhbGFuY2UpOw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBfc3BlbmRlciwgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IHJlbWFpbmluZyk7DQogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIF9mcm9tLCBhZGRyZXNzIGluZGV4ZWQgX3RvLCB1aW50IF92YWx1ZSk7DQogICAgZXZlbnQgQXBwcm92YWwoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBpbmRleGVkIF9zcGVuZGVyLCB1aW50IF92YWx1ZSk7DQp9DQoNCmNvbnRyYWN0IE93bmVkIHsNCiAgICBhZGRyZXNzIHB1YmxpYyBvd25lcjsNCiAgICBldmVudCBPd25lcnNoaXBUcmFuc2ZlcnJlZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIGFkZHJlc3MgaW5kZXhlZCBfdG8pOw0KDQogICAgZnVuY3Rpb24gT3duZWQoKSB7DQogICAgICAgIG93bmVyID0gbXNnLnNlbmRlcjsNCiAgICB9DQoNCiAgICBtb2RpZmllciBvbmx5T3duZXIgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lcikgdGhyb3c7DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgb25seU93bmVyT3JUb2tlblRyYWRlcldpdGhTYW1lT3duZXIgew0KICAgICAgICBpZiAobXNnLnNlbmRlciAhPSBvd25lciAmJiBUb2tlblRyYWRlcihtc2cuc2VuZGVyKS5vd25lcigpICE9IG93bmVyKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0cmFuc2Zlck93bmVyc2hpcChhZGRyZXNzIG5ld093bmVyKSBvbmx5T3duZXIgew0KICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChvd25lciwgbmV3T3duZXIpOw0KICAgICAgICBvd25lciA9IG5ld093bmVyOw0KICAgIH0NCn0NCg0KLy8gY29udHJhY3QgY2FuIGJ1eSBvciBzZWxsIHRva2VucyBmb3IgRVRIDQovLyBwcmljZXMgYXJlIGluIGFtb3VudCBvZiB3ZWkgcGVyIGJhdGNoIG9mIHRva2VuIHVuaXRzDQoNCmNvbnRyYWN0IFRva2VuVHJhZGVyIGlzIE93bmVkIHsNCg0KICAgIGFkZHJlc3MgcHVibGljIGFzc2V0OyAgICAgICAvLyBhZGRyZXNzIG9mIHRva2VuDQogICAgdWludDI1NiBwdWJsaWMgYnV5UHJpY2U7ICAgIC8vIGNvbnRyYWN0IGJ1eXMgbG90cyBvZiB0b2tlbiBhdCB0aGlzIHByaWNlDQogICAgdWludDI1NiBwdWJsaWMgc2VsbFByaWNlOyAgIC8vIGNvbnRyYWN0IHNlbGxzIGxvdHMgYXQgdGhpcyBwcmljZQ0KICAgIHVpbnQyNTYgcHVibGljIHVuaXRzOyAgICAgICAvLyBsb3Qgc2l6ZSAodG9rZW4td2VpKQ0KDQogICAgYm9vbCBwdWJsaWMgYnV5c1Rva2VuczsgICAgIC8vIGlzIGNvbnRyYWN0IGJ1eWluZw0KICAgIGJvb2wgcHVibGljIHNlbGxzVG9rZW5zOyAgICAvLyBpcyBjb250cmFjdCBzZWxsaW5nDQoNCiAgICBldmVudCBBY3RpdmF0ZWRFdmVudChib29sIGJ1eXMsIGJvb2wgc2VsbHMpOw0KICAgIGV2ZW50IE1ha2VyRGVwb3NpdGVkRXRoZXIodWludDI1NiBhbW91bnQpOw0KICAgIGV2ZW50IE1ha2VyV2l0aGRyZXdBc3NldCh1aW50MjU2IHRva2Vucyk7DQogICAgZXZlbnQgTWFrZXJUcmFuc2ZlcnJlZEFzc2V0KGFkZHJlc3MgdG9Ub2tlblRyYWRlciwgdWludDI1NiB0b2tlbnMpOw0KICAgIGV2ZW50IE1ha2VyV2l0aGRyZXdFUkMyMFRva2VuKGFkZHJlc3MgdG9rZW5BZGRyZXNzLCB1aW50MjU2IHRva2Vucyk7DQogICAgZXZlbnQgTWFrZXJXaXRoZHJld0V0aGVyKHVpbnQyNTYgZXRoZXJzKTsNCiAgICBldmVudCBNYWtlclRyYW5zZmVycmVkRXRoZXIoYWRkcmVzcyB0b1Rva2VuVHJhZGVyLCB1aW50MjU2IGV0aGVycyk7DQogICAgZXZlbnQgVGFrZXJCb3VnaHRBc3NldChhZGRyZXNzIGluZGV4ZWQgYnV5ZXIsIHVpbnQyNTYgZXRoZXJzU2VudCwNCiAgICAgICAgdWludDI1NiBldGhlcnNSZXR1cm5lZCwgdWludDI1NiB0b2tlbnNCb3VnaHQpOw0KICAgIGV2ZW50IFRha2VyU29sZEFzc2V0KGFkZHJlc3MgaW5kZXhlZCBzZWxsZXIsIHVpbnQyNTYgYW1vdW50T2ZUb2tlbnNUb1NlbGwsDQogICAgICAgIHVpbnQyNTYgdG9rZW5zU29sZCwgdWludDI1NiBldGhlclZhbHVlT2ZUb2tlbnNTb2xkKTsNCg0KICAgIC8vIENvbnN0cnVjdG9yIC0gb25seSB0byBiZSBjYWxsZWQgYnkgdGhlIFRva2VuVHJhZGVyRmFjdG9yeSBjb250cmFjdA0KICAgIGZ1bmN0aW9uIFRva2VuVHJhZGVyICgNCiAgICAgICAgYWRkcmVzcyBfYXNzZXQsDQogICAgICAgIHVpbnQyNTYgX2J1eVByaWNlLA0KICAgICAgICB1aW50MjU2IF9zZWxsUHJpY2UsDQogICAgICAgIHVpbnQyNTYgX3VuaXRzLA0KICAgICAgICBib29sICAgIF9idXlzVG9rZW5zLA0KICAgICAgICBib29sICAgIF9zZWxsc1Rva2Vucw0KICAgICkgew0KICAgICAgICBhc3NldCAgICAgICA9IF9hc3NldDsNCiAgICAgICAgYnV5UHJpY2UgICAgPSBfYnV5UHJpY2U7DQogICAgICAgIHNlbGxQcmljZSAgID0gX3NlbGxQcmljZTsNCiAgICAgICAgdW5pdHMgICAgICAgPSBfdW5pdHM7DQogICAgICAgIGJ1eXNUb2tlbnMgID0gX2J1eXNUb2tlbnM7DQogICAgICAgIHNlbGxzVG9rZW5zID0gX3NlbGxzVG9rZW5zOw0KICAgICAgICBBY3RpdmF0ZWRFdmVudChidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIGFjdGl2YXRlIG9yIGRlYWN0aXZhdGUgdGhpcyBjb250cmFjdCdzIGJ1eWluZyBhbmQNCiAgICAvLyBzZWxsaW5nIHN0YXR1cw0KICAgIC8vDQogICAgLy8gVGhlIEFjdGl2YXRlZEV2ZW50KCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZw0KICAgIC8vIHBhcmFtZXRlcjoNCiAgICAvLyAgIGJ1eXNUb2tlbnMgICB0aGlzIGNvbnRyYWN0IGNhbiBidXkgYXNzZXQgdG9rZW5zDQogICAgLy8gICBzZWxsc1Rva2VucyAgdGhpcyBjb250cmFjdCBjYW4gc2VsbCBhc3NldCB0b2tlbnMNCiAgICAvLw0KICAgIGZ1bmN0aW9uIGFjdGl2YXRlICgNCiAgICAgICAgYm9vbCBfYnV5c1Rva2VucywNCiAgICAgICAgYm9vbCBfc2VsbHNUb2tlbnMNCiAgICApIG9ubHlPd25lciB7DQogICAgICAgIGJ1eXNUb2tlbnMgID0gX2J1eXNUb2tlbnM7DQogICAgICAgIHNlbGxzVG9rZW5zID0gX3NlbGxzVG9rZW5zOw0KICAgICAgICBBY3RpdmF0ZWRFdmVudChidXlzVG9rZW5zLCBzZWxsc1Rva2Vucyk7DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIGRlcG9zaXQgZXRoZXJzIHRvIHRoaXMgY29udHJhY3Qgc28gdGhpcyBjb250cmFjdA0KICAgIC8vIGNhbiBidXkgYXNzZXQgdG9rZW5zLg0KICAgIC8vDQogICAgLy8gTWFrZXIgZGVwb3NpdHMgYXNzZXQgdG9rZW5zIHRvIHRoaXMgY29udHJhY3QgYnkgY2FsbGluZyB0aGUNCiAgICAvLyBhc3NldCdzIHRyYW5zZmVyKCkgbWV0aG9kIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzDQogICAgLy8gICBfdG8gICAgIGlzIHRoZSBhZGRyZXNzIG9mIFRISVMgY29udHJhY3QNCiAgICAvLyAgIF92YWx1ZSAgaXMgdGhlIG51bWJlciBvZiBhc3NldCB0b2tlbnMgdG8gYmUgdHJhbnNmZXJyZWQNCiAgICAvLw0KICAgIC8vIFRha2VyIE1VU1QgTk9UIHNlbmQgdG9rZW5zIGRpcmVjdGx5IHRvIHRoaXMgY29udHJhY3QuIFRha2Vycw0KICAgIC8vIE1VU1QgdXNlIHRoZSB0YWtlclNlbGxBc3NldCgpIG1ldGhvZCB0byBzZWxsIGFzc2V0IHRva2Vucw0KICAgIC8vIHRvIHRoaXMgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIE1ha2VyIGNhbiBhbHNvIHRyYW5zZmVyIGV0aGVycyBmcm9tIG9uZSBUb2tlblRyYWRlciBjb250cmFjdA0KICAgIC8vIHRvIGFub3RoZXIgVG9rZW5UcmFkZXIgY29udHJhY3QsIGJvdGggb3duZWQgYnkgdGhlIE1ha2VyDQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJEZXBvc2l0ZWRFdGhlcigpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcNCiAgICAvLyBwYXJhbWV0ZXI6DQogICAgLy8gICBldGhlcnMgIGlzIHRoZSBudW1iZXIgb2YgZXRoZXJzIGRlcG9zaXRlZCBieSB0aGUgbWFrZXINCiAgICAvLw0KICAgIC8vIFRoaXMgbWV0aG9kIHdhcyBjYWxsZWQgZGVwb3NpdCgpIGluIHRoZSBvbGQgdmVyc2lvbg0KICAgIC8vDQogICAgZnVuY3Rpb24gbWFrZXJEZXBvc2l0RXRoZXIoKSBwYXlhYmxlIG9ubHlPd25lck9yVG9rZW5UcmFkZXJXaXRoU2FtZU93bmVyIHsNCiAgICAgICAgTWFrZXJEZXBvc2l0ZWRFdGhlcihtc2cudmFsdWUpOw0KICAgIH0NCg0KICAgIC8vIE1ha2VyIGNhbiB3aXRoZHJhdyBhc3NldCB0b2tlbnMgZnJvbSB0aGlzIGNvbnRyYWN0LCB3aXRoIHRoZQ0KICAgIC8vIGZvbGxvd2luZyBwYXJhbWV0ZXI6DQogICAgLy8gICB0b2tlbnMgIGlzIHRoZSBudW1iZXIgb2YgYXNzZXQgdG9rZW5zIHRvIGJlIHdpdGhkcmF3bg0KICAgIC8vDQogICAgLy8gVGhlIE1ha2VyV2l0aGRyZXdBc3NldCgpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcNCiAgICAvLyBwYXJhbWV0ZXI6DQogICAgLy8gICB0b2tlbnMgIGlzIHRoZSBudW1iZXIgb2YgdG9rZW5zIHdpdGhkcmF3biBieSB0aGUgbWFrZXINCiAgICAvLw0KICAgIC8vIFRoaXMgbWV0aG9kIHdhcyBjYWxsZWQgd2l0aGRyYXdBc3NldCgpIGluIHRoZSBvbGQgdmVyc2lvbg0KICAgIC8vDQogICAgZnVuY3Rpb24gbWFrZXJXaXRoZHJhd0Fzc2V0KHVpbnQyNTYgdG9rZW5zKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBNYWtlcldpdGhkcmV3QXNzZXQodG9rZW5zKTsNCiAgICAgICAgcmV0dXJuIEVSQzIwKGFzc2V0KS50cmFuc2Zlcihvd25lciwgdG9rZW5zKTsNCiAgICB9DQoNCiAgICAvLyBNYWtlciBjYW4gdHJhbnNmZXIgYXNzZXQgdG9rZW5zIGZyb20gdGhpcyBjb250cmFjdCB0byBhbm90aGVyDQogICAgLy8gVG9rZW5UcmFkZXIgY29udHJhY3QsIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXI6DQogICAgLy8gICB0b1Rva2VuVHJhZGVyICBBbm90aGVyIFRva2VuVHJhZGVyIGNvbnRyYWN0IG93bmVkIGJ5IHRoZQ0KICAgIC8vICAgICAgICAgICAgICAgICAgc2FtZSBvd25lciBhbmQgd2l0aCB0aGUgc2FtZSBhc3NldA0KICAgIC8vICAgdG9rZW5zICAgICAgICAgaXMgdGhlIG51bWJlciBvZiBhc3NldCB0b2tlbnMgdG8gYmUgbW92ZWQNCiAgICAvLw0KICAgIC8vIFRoZSBNYWtlclRyYW5zZmVycmVkQXNzZXQoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nDQogICAgLy8gcGFyYW1ldGVyczoNCiAgICAvLyAgIHRvVG9rZW5UcmFkZXIgIFRoZSBvdGhlciBUb2tlblRyYWRlciBjb250cmFjdCBvd25lZCBieQ0KICAgIC8vICAgICAgICAgICAgICAgICAgdGhlIHNhbWUgb3duZXIgYW5kIHdpdGggdGhlIHNhbWUgYXNzZXQNCiAgICAvLyAgIHRva2VucyAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgdG9rZW5zIHRyYW5zZmVycmVkDQogICAgLy8NCiAgICAvLyBUaGUgYXNzZXQgVHJhbnNmZXIoKSBldmVudCBpcyBhbHNvIGxvZ2dlZCBmcm9tIHRoaXMgY29udHJhY3QNCiAgICAvLyB0byB0aGUgb3RoZXIgY29udHJhY3QNCiAgICAvLw0KICAgIGZ1bmN0aW9uIG1ha2VyVHJhbnNmZXJBc3NldCgNCiAgICAgICAgVG9rZW5UcmFkZXIgdG9Ub2tlblRyYWRlciwNCiAgICAgICAgdWludDI1NiB0b2tlbnMNCiAgICApIG9ubHlPd25lciByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIGlmIChvd25lciAhPSB0b1Rva2VuVHJhZGVyLm93bmVyKCkgfHwgYXNzZXQgIT0gdG9Ub2tlblRyYWRlci5hc3NldCgpKSB7DQogICAgICAgICAgICB0aHJvdzsNCiAgICAgICAgfQ0KICAgICAgICBNYWtlclRyYW5zZmVycmVkQXNzZXQodG9Ub2tlblRyYWRlciwgdG9rZW5zKTsNCiAgICAgICAgcmV0dXJuIEVSQzIwKGFzc2V0KS50cmFuc2Zlcih0b1Rva2VuVHJhZGVyLCB0b2tlbnMpOw0KICAgIH0NCg0KICAgIC8vIE1ha2VyIGNhbiB3aXRoZHJhdyBhbnkgRVJDMjAgYXNzZXQgdG9rZW5zIGZyb20gdGhpcyBjb250cmFjdA0KICAgIC8vDQogICAgLy8gVGhpcyBtZXRob2QgaXMgaW5jbHVkZWQgaW4gdGhlIGNhc2Ugd2hlcmUgdGhpcyBjb250cmFjdCByZWNlaXZlcw0KICAgIC8vIHRoZSB3cm9uZyB0b2tlbnMNCiAgICAvLw0KICAgIC8vIFRoZSBNYWtlcldpdGhkcmV3RVJDMjBUb2tlbigpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcNCiAgICAvLyBwYXJhbWV0ZXI6DQogICAgLy8gICB0b2tlbkFkZHJlc3MgIGlzIHRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbnMgd2l0aGRyYXduIGJ5IHRoZSBtYWtlcg0KICAgIC8vICAgdG9rZW5zICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHRva2VucyB3aXRoZHJhd24gYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIHdpdGhkcmF3VG9rZW4oKSBpbiB0aGUgb2xkIHZlcnNpb24NCiAgICAvLw0KICAgIGZ1bmN0aW9uIG1ha2VyV2l0aGRyYXdFUkMyMFRva2VuKA0KICAgICAgICBhZGRyZXNzIHRva2VuQWRkcmVzcywNCiAgICAgICAgdWludDI1NiB0b2tlbnMNCiAgICApIG9ubHlPd25lciByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIE1ha2VyV2l0aGRyZXdFUkMyMFRva2VuKHRva2VuQWRkcmVzcywgdG9rZW5zKTsNCiAgICAgICAgcmV0dXJuIEVSQzIwKHRva2VuQWRkcmVzcykudHJhbnNmZXIob3duZXIsIHRva2Vucyk7DQogICAgfQ0KDQogICAgLy8gTWFrZXIgY2FuIHdpdGhkcmF3IGV0aGVycyBmcm9tIHRoaXMgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIFRoZSBNYWtlcldpdGhkcmV3RXRoZXIoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcg0KICAgIC8vICAgZXRoZXJzICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyB3aXRoZHJhd24gYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIHdpdGhkcmF3KCkgaW4gdGhlIG9sZCB2ZXJzaW9uDQogICAgLy8NCiAgICBmdW5jdGlvbiBtYWtlcldpdGhkcmF3RXRoZXIodWludDI1NiBldGhlcnMpIG9ubHlPd25lciByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIGlmICh0aGlzLmJhbGFuY2UgPj0gZXRoZXJzKSB7DQogICAgICAgICAgICBNYWtlcldpdGhkcmV3RXRoZXIoZXRoZXJzKTsNCiAgICAgICAgICAgIHJldHVybiBvd25lci5zZW5kKGV0aGVycyk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBNYWtlciBjYW4gdHJhbnNmZXIgZXRoZXJzIGZyb20gdGhpcyBjb250cmFjdCB0byBhbm90aGVyIFRva2VuVHJhZGVyDQogICAgLy8gY29udHJhY3QsIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOg0KICAgIC8vICAgdG9Ub2tlblRyYWRlciAgQW5vdGhlciBUb2tlblRyYWRlciBjb250cmFjdCBvd25lZCBieSB0aGUNCiAgICAvLyAgICAgICAgICAgICAgICAgIHNhbWUgb3duZXIgYW5kIHdpdGggdGhlIHNhbWUgYXNzZXQNCiAgICAvLyAgIGV0aGVycyAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgZXRoZXJzIHRvIGJlIG1vdmVkDQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJUcmFuc2ZlcnJlZEV0aGVyKCkgZXZlbnQgaXMgbG9nZ2VkIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXINCiAgICAvLyAgIHRvVG9rZW5UcmFkZXIgIFRoZSBvdGhlciBUb2tlblRyYWRlciBjb250cmFjdCBvd25lZCBieSB0aGUNCiAgICAvLyAgICAgICAgICAgICAgICAgIHNhbWUgb3duZXIgYW5kIHdpdGggdGhlIHNhbWUgYXNzZXQNCiAgICAvLyAgIGV0aGVycyAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgZXRoZXJzIHRyYW5zZmVycmVkDQogICAgLy8NCiAgICAvLyBUaGUgTWFrZXJEZXBvc2l0ZWRFdGhlcigpIGV2ZW50IGlzIGxvZ2dlZCBvbiB0aGUgb3RoZXINCiAgICAvLyBjb250cmFjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyOg0KICAgIC8vICAgZXRoZXJzICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyBkZXBvc2l0ZWQgYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICBmdW5jdGlvbiBtYWtlclRyYW5zZmVyRXRoZXIoDQogICAgICAgIFRva2VuVHJhZGVyIHRvVG9rZW5UcmFkZXIsDQogICAgICAgIHVpbnQyNTYgZXRoZXJzDQogICAgKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBvaykgew0KICAgICAgICBpZiAob3duZXIgIT0gdG9Ub2tlblRyYWRlci5vd25lcigpIHx8IGFzc2V0ICE9IHRvVG9rZW5UcmFkZXIuYXNzZXQoKSkgew0KICAgICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZSA+PSBldGhlcnMpIHsNCiAgICAgICAgICAgIE1ha2VyVHJhbnNmZXJyZWRFdGhlcih0b1Rva2VuVHJhZGVyLCBldGhlcnMpOw0KICAgICAgICAgICAgdG9Ub2tlblRyYWRlci5tYWtlckRlcG9zaXRFdGhlci52YWx1ZShldGhlcnMpKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBUYWtlciBidXlzIGFzc2V0IHRva2VucyBieSBzZW5kaW5nIGV0aGVycw0KICAgIC8vDQogICAgLy8gVGhlIFRha2VyQm91Z2h0QXNzZXQoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnMNCiAgICAvLyAgIGJ1eWVyICAgICAgICAgICBpcyB0aGUgYnV5ZXIncyBhZGRyZXNzDQogICAgLy8gICBldGhlcnNTZW50ICAgICAgaXMgdGhlIG51bWJlciBvZiBldGhlcnMgc2VudCBieSB0aGUgYnV5ZXINCiAgICAvLyAgIGV0aGVyc1JldHVybmVkICBpcyB0aGUgbnVtYmVyIG9mIGV0aGVycyBzZW50IGJhY2sgdG8gdGhlIGJ1eWVyIGFzDQogICAgLy8gICAgICAgICAgICAgICAgICAgY2hhbmdlDQogICAgLy8gICB0b2tlbnNCb3VnaHQgICAgaXMgdGhlIG51bWJlciBvZiBhc3NldCB0b2tlbnMgc2VudCB0byB0aGUgYnV5ZXINCiAgICAvLw0KICAgIC8vIFRoaXMgbWV0aG9kIHdhcyBjYWxsZWQgYnV5KCkgaW4gdGhlIG9sZCB2ZXJzaW9uDQogICAgLy8NCiAgICBmdW5jdGlvbiB0YWtlckJ1eUFzc2V0KCkgcGF5YWJsZSB7DQogICAgICAgIGlmIChzZWxsc1Rva2VucyB8fCBtc2cuc2VuZGVyID09IG93bmVyKSB7DQogICAgICAgICAgICAvLyBOb3RlIHRoYXQgc2VsbFByaWNlIGhhcyBhbHJlYWR5IGJlZW4gdmFsaWRhdGVkIGFzID4gMA0KICAgICAgICAgICAgdWludCBvcmRlciAgICA9IG1zZy52YWx1ZSAvIHNlbGxQcmljZTsNCiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB1bml0cyBoYXMgYWxyZWFkeSBiZWVuIHZhbGlkYXRlZCBhcyA+IDANCiAgICAgICAgICAgIHVpbnQgY2FuX3NlbGwgPSBFUkMyMChhc3NldCkuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpIC8gdW5pdHM7DQogICAgICAgICAgICB1aW50MjU2IGNoYW5nZSA9IDA7DQogICAgICAgICAgICBpZiAobXNnLnZhbHVlID4gKGNhbl9zZWxsICogc2VsbFByaWNlKSkgew0KICAgICAgICAgICAgICAgIGNoYW5nZSAgPSBtc2cudmFsdWUgLSAoY2FuX3NlbGwgKiBzZWxsUHJpY2UpOw0KICAgICAgICAgICAgICAgIG9yZGVyID0gY2FuX3NlbGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2hhbmdlID4gMCkgew0KICAgICAgICAgICAgICAgIGlmICghbXNnLnNlbmRlci5zZW5kKGNoYW5nZSkpIHRocm93Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKG9yZGVyID4gMCkgew0KICAgICAgICAgICAgICAgIGlmICghRVJDMjAoYXNzZXQpLnRyYW5zZmVyKG1zZy5zZW5kZXIsIG9yZGVyICogdW5pdHMpKSB0aHJvdzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIFRha2VyQm91Z2h0QXNzZXQobXNnLnNlbmRlciwgbXNnLnZhbHVlLCBjaGFuZ2UsIG9yZGVyICogdW5pdHMpOw0KICAgICAgICB9DQogICAgICAgIC8vIFJldHVybiB1c2VyIGZ1bmRzIGlmIHRoZSBjb250cmFjdCBpcyBub3Qgc2VsbGluZw0KICAgICAgICBlbHNlIGlmICghbXNnLnNlbmRlci5zZW5kKG1zZy52YWx1ZSkpIHRocm93Ow0KICAgIH0NCg0KICAgIC8vIFRha2VyIHNlbGxzIGFzc2V0IHRva2VucyBmb3IgZXRoZXJzIGJ5Og0KICAgIC8vIDEuIENhbGxpbmcgdGhlIGFzc2V0J3MgYXBwcm92ZSgpIG1ldGhvZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVycw0KICAgIC8vICAgIF9zcGVuZGVyICAgICAgICAgICAgaXMgdGhlIGFkZHJlc3Mgb2YgdGhpcyBjb250cmFjdA0KICAgIC8vICAgIF92YWx1ZSAgICAgICAgICAgICAgaXMgdGhlIG51bWJlciBvZiB0b2tlbnMgdG8gYmUgc29sZA0KICAgIC8vIDIuIENhbGxpbmcgdGhpcyB0YWtlclNlbGxBc3NldCgpIG1ldGhvZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyDQogICAgLy8gICAgZXRoZXJWYWx1ZU9mVG9rZW5zICBpcyB0aGUgZXRoZXIgdmFsdWUgb2YgdGhlIGFzc2V0IHRva2VucyB0byBiZSBzb2xkDQogICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBieSB0aGUgdGFrZXINCiAgICAvLw0KICAgIC8vIFRoZSBUYWtlclNvbGRBc3NldCgpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVycw0KICAgIC8vICAgc2VsbGVyICAgICAgICAgICAgICAgICAgaXMgdGhlIHNlbGxlcidzIGFkZHJlc3MNCiAgICAvLyAgIGFtb3VudE9mVG9rZW5zVG9TZWxsICAgIGlzIHRoZSBhbW91bnQgb2YgdGhlIGFzc2V0IHRva2VucyBiZWluZw0KICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sZCBieSB0aGUgdGFrZXINCiAgICAvLyAgIHRva2Vuc1NvbGQgICAgICAgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgdGhlIGFzc2V0IHRva2VucyBzb2xkDQogICAgLy8gICBldGhlclZhbHVlT2ZUb2tlbnNTb2xkICBpcyB0aGUgZXRoZXIgdmFsdWUgb2YgdGhlIGFzc2V0IHRva2VucyBzb2xkDQogICAgLy8NCiAgICAvLyBUaGlzIG1ldGhvZCB3YXMgY2FsbGVkIHNlbGwoKSBpbiB0aGUgb2xkIHZlcnNpb24NCiAgICAvLw0KICAgIGZ1bmN0aW9uIHRha2VyU2VsbEFzc2V0KHVpbnQyNTYgYW1vdW50T2ZUb2tlbnNUb1NlbGwpIHsNCiAgICAgICAgaWYgKGJ1eXNUb2tlbnMgfHwgbXNnLnNlbmRlciA9PSBvd25lcikgew0KICAgICAgICAgICAgLy8gTWF4aW11bSBudW1iZXIgb2YgdG9rZW4gdGhlIGNvbnRyYWN0IGNhbiBidXkNCiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCBidXlQcmljZSBoYXMgYWxyZWFkeSBiZWVuIHZhbGlkYXRlZCBhcyA+IDANCiAgICAgICAgICAgIHVpbnQyNTYgY2FuX2J1eSA9IHRoaXMuYmFsYW5jZSAvIGJ1eVByaWNlOw0KICAgICAgICAgICAgLy8gVG9rZW4gbG90cyBhdmFpbGFibGUNCiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB1bml0cyBoYXMgYWxyZWFkeSBiZWVuIHZhbGlkYXRlZCBhcyA+IDANCiAgICAgICAgICAgIHVpbnQyNTYgb3JkZXIgPSBhbW91bnRPZlRva2Vuc1RvU2VsbCAvIHVuaXRzOw0KICAgICAgICAgICAgLy8gQWRqdXN0IG9yZGVyIGZvciBmdW5kcyBhdmFpbGFibGUNCiAgICAgICAgICAgIGlmIChvcmRlciA+IGNhbl9idXkpIG9yZGVyID0gY2FuX2J1eTsNCiAgICAgICAgICAgIGlmIChvcmRlciA+IDApIHsNCiAgICAgICAgICAgICAgICAvLyBFeHRyYWN0IHVzZXIgdG9rZW5zDQogICAgICAgICAgICAgICAgaWYgKCFFUkMyMChhc3NldCkudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIG9yZGVyICogdW5pdHMpKSB0aHJvdzsNCiAgICAgICAgICAgICAgICAvLyBQYXkgdXNlcg0KICAgICAgICAgICAgICAgIGlmICghbXNnLnNlbmRlci5zZW5kKG9yZGVyICogYnV5UHJpY2UpKSB0aHJvdzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIFRha2VyU29sZEFzc2V0KG1zZy5zZW5kZXIsIGFtb3VudE9mVG9rZW5zVG9TZWxsLCBvcmRlciAqIHVuaXRzLCBvcmRlciAqIGJ1eVByaWNlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFRha2VyIGJ1eXMgdG9rZW5zIGJ5IHNlbmRpbmcgZXRoZXJzDQogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7DQogICAgICAgIHRha2VyQnV5QXNzZXQoKTsNCiAgICB9DQp9DQoNCi8vIFRoaXMgY29udHJhY3QgZGVwbG95cyBUb2tlblRyYWRlciBjb250cmFjdHMgYW5kIGxvZ3MgdGhlIGV2ZW50DQpjb250cmFjdCBUb2tlblRyYWRlckZhY3RvcnkgaXMgT3duZWQgew0KDQogICAgZXZlbnQgVHJhZGVMaXN0aW5nKGFkZHJlc3MgaW5kZXhlZCBvd25lckFkZHJlc3MsIGFkZHJlc3MgaW5kZXhlZCB0b2tlblRyYWRlckFkZHJlc3MsDQogICAgICAgIGFkZHJlc3MgaW5kZXhlZCBhc3NldCwgdWludDI1NiBidXlQcmljZSwgdWludDI1NiBzZWxsUHJpY2UsIHVpbnQyNTYgdW5pdHMsDQogICAgICAgIGJvb2wgYnV5c1Rva2VucywgYm9vbCBzZWxsc1Rva2Vucyk7DQogICAgZXZlbnQgT3duZXJXaXRoZHJld0VSQzIwVG9rZW4oYWRkcmVzcyBpbmRleGVkIHRva2VuQWRkcmVzcywgdWludDI1NiB0b2tlbnMpOw0KDQogICAgbWFwcGluZyhhZGRyZXNzID0+IGJvb2wpIF92ZXJpZnk7DQoNCiAgICAvLyBBbnlvbmUgY2FuIGNhbGwgdGhpcyBtZXRob2QgdG8gdmVyaWZ5IHRoZSBzZXR0aW5ncyBvZiBhDQogICAgLy8gVG9rZW5UcmFkZXIgY29udHJhY3QuIFRoZSBwYXJhbWV0ZXJzIGFyZToNCiAgICAvLyAgIHRyYWRlQ29udHJhY3QgIGlzIHRoZSBhZGRyZXNzIG9mIGEgVG9rZW5UcmFkZXIgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIFJldHVybiB2YWx1ZXM6DQogICAgLy8gICB2YWxpZCAgICAgICAgZGlkIHRoaXMgVG9rZW5UcmFkZXJGYWN0b3J5IGNyZWF0ZSB0aGUgVG9rZW5UcmFkZXIgY29udHJhY3Q/DQogICAgLy8gICBvd25lciAgICAgICAgaXMgdGhlIG93bmVyIG9mIHRoZSBUb2tlblRyYWRlciBjb250cmFjdA0KICAgIC8vICAgYXNzZXQgICAgICAgIGlzIHRoZSBFUkMyMCBhc3NldCBhZGRyZXNzDQogICAgLy8gICBidXlQcmljZSAgICAgaXMgdGhlIGJ1eSBwcmljZSBpbiBldGhlcnMgcGVyIGB1bml0c2Agb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICBzZWxsUHJpY2UgICAgaXMgdGhlIHNlbGwgcHJpY2UgaW4gZXRoZXJzIHBlciBgdW5pdHNgIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgdW5pdHMgICAgICAgIGlzIHRoZSBudW1iZXIgb2YgdW5pdHMgb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICBidXlzVG9rZW5zICAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IGJ1eWluZyB0b2tlbnM/DQogICAgLy8gICBzZWxsc1Rva2VucyAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IHNlbGxpbmcgdG9rZW5zPw0KICAgIC8vDQogICAgZnVuY3Rpb24gdmVyaWZ5KGFkZHJlc3MgdHJhZGVDb250cmFjdCkgY29uc3RhbnQgcmV0dXJucyAoDQogICAgICAgIGJvb2wgICAgdmFsaWQsDQogICAgICAgIGFkZHJlc3Mgb3duZXIsDQogICAgICAgIGFkZHJlc3MgYXNzZXQsDQogICAgICAgIHVpbnQyNTYgYnV5UHJpY2UsDQogICAgICAgIHVpbnQyNTYgc2VsbFByaWNlLA0KICAgICAgICB1aW50MjU2IHVuaXRzLA0KICAgICAgICBib29sICAgIGJ1eXNUb2tlbnMsDQogICAgICAgIGJvb2wgICAgc2VsbHNUb2tlbnMNCiAgICApIHsNCiAgICAgICAgdmFsaWQgPSBfdmVyaWZ5W3RyYWRlQ29udHJhY3RdOw0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICAgIFRva2VuVHJhZGVyIHQgPSBUb2tlblRyYWRlcih0cmFkZUNvbnRyYWN0KTsNCiAgICAgICAgICAgIG93bmVyICAgICAgICAgPSB0Lm93bmVyKCk7DQogICAgICAgICAgICBhc3NldCAgICAgICAgID0gdC5hc3NldCgpOw0KICAgICAgICAgICAgYnV5UHJpY2UgICAgICA9IHQuYnV5UHJpY2UoKTsNCiAgICAgICAgICAgIHNlbGxQcmljZSAgICAgPSB0LnNlbGxQcmljZSgpOw0KICAgICAgICAgICAgdW5pdHMgICAgICAgICA9IHQudW5pdHMoKTsNCiAgICAgICAgICAgIGJ1eXNUb2tlbnMgICAgPSB0LmJ1eXNUb2tlbnMoKTsNCiAgICAgICAgICAgIHNlbGxzVG9rZW5zICAgPSB0LnNlbGxzVG9rZW5zKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBNYWtlciBjYW4gY2FsbCB0aGlzIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgVG9rZW5UcmFkZXIgY29udHJhY3QNCiAgICAvLyB3aXRoIHRoZSBtYWtlciBiZWluZyB0aGUgb3duZXIgb2YgdGhpcyBuZXcgY29udHJhY3QNCiAgICAvLw0KICAgIC8vIFBhcmFtZXRlcnM6DQogICAgLy8gICBhc3NldCAgICAgICAgaXMgdGhlIEVSQzIwIGFzc2V0IGFkZHJlc3MNCiAgICAvLyAgIGJ1eVByaWNlICAgICBpcyB0aGUgYnV5IHByaWNlIGluIGV0aGVycyBwZXIgYHVuaXRzYCBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIHNlbGxQcmljZSAgICBpcyB0aGUgc2VsbCBwcmljZSBpbiBldGhlcnMgcGVyIGB1bml0c2Agb2YgYXNzZXQgdG9rZW5zDQogICAgLy8gICB1bml0cyAgICAgICAgaXMgdGhlIG51bWJlciBvZiB1bml0cyBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIGJ1eXNUb2tlbnMgICBpcyB0aGUgVG9rZW5UcmFkZXIgY29udHJhY3QgYnV5aW5nIHRva2Vucz8NCiAgICAvLyAgIHNlbGxzVG9rZW5zICBpcyB0aGUgVG9rZW5UcmFkZXIgY29udHJhY3Qgc2VsbGluZyB0b2tlbnM/DQogICAgLy8NCiAgICAvLyBGb3IgZXhhbXBsZSwgbGlzdGluZyBhIFRva2VuVHJhZGVyIGNvbnRyYWN0IG9uIHRoZSBSRVAgQXVndXIgdG9rZW4gd2hlcmUNCiAgICAvLyB0aGUgY29udHJhY3Qgd2lsbCBidXkgUkVQIHRva2VucyBhdCBhIHJhdGUgb2YgMzkwMDAvMTAwMDAwID0gMC4zOSBFVEgNCiAgICAvLyBwZXIgUkVQIHRva2VuIGFuZCBzZWxsIFJFUCB0b2tlbnMgYXQgYSByYXRlIG9mIDQxMDAwLzEwMDAwMCA9IDAuNDEgRVRIDQogICAgLy8gcGVyIFJFUCB0b2tlbjoNCiAgICAvLyAgIGFzc2V0ICAgICAgICAweDQ4YzgwZjFmNGQ1M2Q1OTUxZTVkNTQzOGI1NGNiYTg0ZjI5ZjMyYTUNCiAgICAvLyAgIGJ1eVByaWNlICAgICAzOTAwMA0KICAgIC8vICAgc2VsbFByaWNlICAgIDQxMDAwDQogICAgLy8gICB1bml0cyAgICAgICAgMTAwMDAwDQogICAgLy8gICBidXlzVG9rZW5zICAgdHJ1ZQ0KICAgIC8vICAgc2VsbHNUb2tlbnMgIHRydWUNCiAgICAvLw0KICAgIC8vIFRoZSBUcmFkZUxpc3RpbmcoKSBldmVudCBpcyBsb2dnZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnMNCiAgICAvLyAgIG93bmVyQWRkcmVzcyAgICAgICAgaXMgdGhlIE1ha2VyJ3MgYWRkcmVzcw0KICAgIC8vICAgdG9rZW5UcmFkZXJBZGRyZXNzICBpcyB0aGUgYWRkcmVzcyBvZiB0aGUgbmV3bHkgY3JlYXRlZCBUb2tlblRyYWRlciBjb250cmFjdA0KICAgIC8vICAgYXNzZXQgICAgICAgICAgICAgICBpcyB0aGUgRVJDMjAgYXNzZXQgYWRkcmVzcw0KICAgIC8vICAgYnV5UHJpY2UgICAgICAgICAgICBpcyB0aGUgYnV5IHByaWNlIGluIGV0aGVycyBwZXIgYHVuaXRzYCBvZiBhc3NldCB0b2tlbnMNCiAgICAvLyAgIHNlbGxQcmljZSAgICAgICAgICAgaXMgdGhlIHNlbGwgcHJpY2UgaW4gZXRoZXJzIHBlciBgdW5pdHNgIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgdW5pdCAgICAgICAgICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHVuaXRzIG9mIGFzc2V0IHRva2Vucw0KICAgIC8vICAgYnV5c1Rva2VucyAgICAgICAgICBpcyB0aGUgVG9rZW5UcmFkZXIgY29udHJhY3QgYnV5aW5nIHRva2Vucz8NCiAgICAvLyAgIHNlbGxzVG9rZW5zICAgICAgICAgaXMgdGhlIFRva2VuVHJhZGVyIGNvbnRyYWN0IHNlbGxpbmcgdG9rZW5zPw0KICAgIC8vDQogICAgZnVuY3Rpb24gY3JlYXRlVHJhZGVDb250cmFjdCgNCiAgICAgICAgYWRkcmVzcyBhc3NldCwNCiAgICAgICAgdWludDI1NiBidXlQcmljZSwNCiAgICAgICAgdWludDI1NiBzZWxsUHJpY2UsDQogICAgICAgIHVpbnQyNTYgdW5pdHMsDQogICAgICAgIGJvb2wgICAgYnV5c1Rva2VucywNCiAgICAgICAgYm9vbCAgICBzZWxsc1Rva2Vucw0KICAgICkgcmV0dXJucyAoYWRkcmVzcyB0cmFkZXIpIHsNCiAgICAgICAgLy8gQ2Fubm90IGhhdmUgaW52YWxpZCBhc3NldA0KICAgICAgICBpZiAoYXNzZXQgPT0gMHgwKSB0aHJvdzsNCiAgICAgICAgLy8gQ2hlY2sgZm9yIEVSQzIwIGFsbG93YW5jZSBmdW5jdGlvbg0KICAgICAgICAvLyBUaGlzIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIGFsbG93YW5jZSBmdW5jdGlvbg0KICAgICAgICAvLyBpcyB1bmRlZmluZWQgdG8gcHJldmVudCBHTlRzIGZyb20gYmVpbmcgdXNlZA0KICAgICAgICAvLyB3aXRoIHRoaXMgZmFjdG9yeQ0KICAgICAgICB1aW50MjU2IGFsbG93YW5jZSA9IEVSQzIwKGFzc2V0KS5hbGxvd2FuY2UobXNnLnNlbmRlciwgdGhpcyk7DQogICAgICAgIC8vIENhbm5vdCBzZXQgemVybyBvciBuZWdhdGl2ZSBwcmljZQ0KICAgICAgICBpZiAoYnV5UHJpY2UgPD0gMCB8fCBzZWxsUHJpY2UgPD0gMCkgdGhyb3c7DQogICAgICAgIC8vIE11c3QgbWFrZSBwcm9maXQgb24gc3ByZWFkDQogICAgICAgIGlmIChidXlQcmljZSA+PSBzZWxsUHJpY2UpIHRocm93Ow0KICAgICAgICAvLyBDYW5ub3QgYnV5IG9yIHNlbGwgemVybyBvciBuZWdhdGl2ZSB1bml0cw0KICAgICAgICBpZiAodW5pdHMgPD0gMCkgdGhyb3c7DQoNCiAgICAgICAgdHJhZGVyID0gbmV3IFRva2VuVHJhZGVyKA0KICAgICAgICAgICAgYXNzZXQsDQogICAgICAgICAgICBidXlQcmljZSwNCiAgICAgICAgICAgIHNlbGxQcmljZSwNCiAgICAgICAgICAgIHVuaXRzLA0KICAgICAgICAgICAgYnV5c1Rva2VucywNCiAgICAgICAgICAgIHNlbGxzVG9rZW5zKTsNCiAgICAgICAgLy8gUmVjb3JkIHRoYXQgdGhpcyBmYWN0b3J5IGNyZWF0ZWQgdGhlIHRyYWRlcg0KICAgICAgICBfdmVyaWZ5W3RyYWRlcl0gPSB0cnVlOw0KICAgICAgICAvLyBTZXQgdGhlIG93bmVyIHRvIHdob2V2ZXIgY2FsbGVkIHRoZSBmdW5jdGlvbg0KICAgICAgICBUb2tlblRyYWRlcih0cmFkZXIpLnRyYW5zZmVyT3duZXJzaGlwKG1zZy5zZW5kZXIpOw0KICAgICAgICBUcmFkZUxpc3RpbmcobXNnLnNlbmRlciwgdHJhZGVyLCBhc3NldCwgYnV5UHJpY2UsIHNlbGxQcmljZSwgdW5pdHMsIGJ1eXNUb2tlbnMsIHNlbGxzVG9rZW5zKTsNCiAgICB9DQoNCiAgICAvLyBGYWN0b3J5IG93bmVyIGNhbiB3aXRoZHJhdyBhbnkgRVJDMjAgYXNzZXQgdG9rZW5zIGZyb20gdGhpcyBjb250cmFjdA0KICAgIC8vDQogICAgLy8gVGhpcyBtZXRob2QgaXMgaW5jbHVkZWQgaW4gdGhlIGNhc2Ugd2hlcmUgdGhpcyBjb250cmFjdCByZWNlaXZlcw0KICAgIC8vIHRoZSB3cm9uZyB0b2tlbnMNCiAgICAvLw0KICAgIC8vIFRoZSBPd25lcldpdGhkcmV3RVJDMjBUb2tlbigpIGV2ZW50IGlzIGxvZ2dlZCB3aXRoIHRoZSBmb2xsb3dpbmcNCiAgICAvLyBwYXJhbWV0ZXI6DQogICAgLy8gICB0b2tlbkFkZHJlc3MgIGlzIHRoZSBhZGRyZXNzIG9mIHRoZSB0b2tlbnMgd2l0aGRyYXduIGJ5IHRoZSBtYWtlcg0KICAgIC8vICAgdG9rZW5zICAgICAgICBpcyB0aGUgbnVtYmVyIG9mIHRva2VucyB3aXRoZHJhd24gYnkgdGhlIG1ha2VyDQogICAgLy8NCiAgICBmdW5jdGlvbiBvd25lcldpdGhkcmF3RVJDMjBUb2tlbihhZGRyZXNzIHRva2VuQWRkcmVzcywgdWludDI1NiB0b2tlbnMpIG9ubHlPd25lciByZXR1cm5zIChib29sIG9rKSB7DQogICAgICAgIE93bmVyV2l0aGRyZXdFUkMyMFRva2VuKHRva2VuQWRkcmVzcywgdG9rZW5zKTsNCiAgICAgICAgcmV0dXJuIEVSQzIwKHRva2VuQWRkcmVzcykudHJhbnNmZXIob3duZXIsIHRva2Vucyk7DQogICAgfQ0KDQogICAgLy8gUHJldmVudHMgYWNjaWRlbnRhbCBzZW5kaW5nIG9mIGV0aGVyIHRvIHRoZSBmYWN0b3J5DQogICAgZnVuY3Rpb24gKCkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQp9'