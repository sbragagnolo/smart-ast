base 64 content
base64unicornRanch
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KY29udHJhY3QgRVJDMjBUb2tlbiB7DQogIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF93aG8pIGNvbnN0YW50IHJldHVybnMgKHVpbnQgYmFsYW5jZSk7DQogIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpOw0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKTsNCiAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlKTsNCn0NCmNvbnRyYWN0IEdyb3ZlQVBJIHsNCiAgZnVuY3Rpb24gaW5zZXJ0KGJ5dGVzMzIgaW5kZXhOYW1lLCBieXRlczMyIGlkLCBpbnQgdmFsdWUpIHB1YmxpYzsNCn0NCg0KLyoqDQogKiBNYXRoIG9wZXJhdGlvbnMgd2l0aCBzYWZldHkgY2hlY2tzDQogKi8NCmxpYnJhcnkgU2FmZU1hdGggew0KICBmdW5jdGlvbiBtdWwodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICB1aW50IGMgPSBhICogYjsNCiAgICBhc3NlcnQoYSA9PSAwIHx8IGMgLyBhID09IGIpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gZGl2KHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgLy8gYXNzZXJ0KGIgPiAwKTsgLy8gU29saWRpdHkgYXV0b21hdGljYWxseSB0aHJvd3Mgd2hlbiBkaXZpZGluZyBieSAwDQogICAgdWludCBjID0gYSAvIGI7DQogICAgLy8gYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7IC8vIFRoZXJlIGlzIG5vIGNhc2UgaW4gd2hpY2ggdGhpcyBkb2Vzbid0IGhvbGQNCiAgICByZXR1cm4gYzsNCiAgfQ0KDQogIGZ1bmN0aW9uIHN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIGFzc2VydChiIDw9IGEpOw0KICAgIHJldHVybiBhIC0gYjsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgIGFzc2VydChjID49IGEpOw0KICAgIHJldHVybiBjOw0KICB9DQoNCiAgZnVuY3Rpb24gbWF4NjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogIH0NCg0KICBmdW5jdGlvbiBtaW42NCh1aW50NjQgYSwgdWludDY0IGIpIGludGVybmFsIGNvbnN0YW50IHJldHVybnMgKHVpbnQ2NCkgew0KICAgIHJldHVybiBhIDwgYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWF4MjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPj0gYiA/IGEgOiBiOw0KICB9DQoNCiAgZnVuY3Rpb24gbWluMjU2KHVpbnQyNTYgYSwgdWludDI1NiBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogIH0NCn0NCg0KY29udHJhY3QgVW5pY29yblJhbmNoIHsNCiAgdXNpbmcgU2FmZU1hdGggZm9yIHVpbnQ7DQoNCiAgZW51bSBWaXNpdFR5cGUgeyBTcGEsIEFmdGVybm9vbiwgRGF5LCBPdmVybmlnaHQsIFdlZWssIEV4dGVuZGVkIH0NCiAgZW51bSBWaXNpdFN0YXRlIHsgSW5Qcm9ncmVzcywgQ29tcGxldGVkLCBSZXBvc3Nlc3NlZCB9DQogIA0KICBzdHJ1Y3QgVmlzaXQgew0KICAgIHVpbnQgdW5pY29ybkNvdW50Ow0KICAgIFZpc2l0VHlwZSB0Ow0KICAgIHVpbnQgc3RhcnRCbG9jazsNCiAgICB1aW50IGV4cGlyZXNCbG9jazsNCiAgICBWaXNpdFN0YXRlIHN0YXRlOw0KICB9DQogIHN0cnVjdCBWaXNpdE1ldGEgew0KICAgIGFkZHJlc3Mgb3duZXI7DQogICAgdWludCBpbmRleDsNCiAgfQ0KICANCiAgYWRkcmVzcyBwdWJsaWMgY2FyZGJvYXJkVW5pY29yblRva2VuQWRkcmVzczsNCiAgYWRkcmVzcyBwdWJsaWMgZ3JvdmVBZGRyZXNzOw0KICBhZGRyZXNzIHB1YmxpYyBvd25lciA9IG1zZy5zZW5kZXI7DQogIG1hcHBpbmcgKGFkZHJlc3MgPT4gVmlzaXRbXSkgYm9va2luZ3M7DQogIG1hcHBpbmcgKGJ5dGVzMzIgPT4gVmlzaXRNZXRhKSBwdWJsaWMgYm9va2luZ01ldGFkYXRhRm9yS2V5Ow0KICBtYXBwaW5nICh1aW50OCA9PiB1aW50KSBwdWJsaWMgdmlzaXRMZW5ndGg7DQogIG1hcHBpbmcgKHVpbnQ4ID0+IHVpbnQpIHB1YmxpYyB2aXNpdENvc3Q7DQogIHVpbnQgcHVibGljIHZpc2l0aW5nVW5pY29ybnMgPSAwOw0KICB1aW50IHB1YmxpYyByZXBvc3Nlc3Npb25CbG9ja3MgPSAxMjA5NjA7DQogIHVpbnQ4IHB1YmxpYyByZXBvc3Nlc3Npb25Cb3VudHlQZXJUZW4gPSAyOw0KICB1aW50OCBwdWJsaWMgcmVwb3NzZXNzaW9uQm91bnR5UGVySHVuZHJlZCA9IDI1Ow0KICB1aW50IHB1YmxpYyBiaXJ0aEJsb2NrVGhyZXNob2xkID0gNjA0ODA7DQogIHVpbnQ4IHB1YmxpYyBiaXJ0aFBlclRlbiA9IDE7DQogIHVpbnQ4IHB1YmxpYyBiaXJ0aFBlckh1bmRyZWQgPSAxNTsNCg0KICBldmVudCBOZXdCb29raW5nKGFkZHJlc3MgaW5kZXhlZCBfd2hvLCB1aW50IGluZGV4ZWQgX2luZGV4LCBWaXNpdFR5cGUgaW5kZXhlZCBfdHlwZSwgdWludCBfdW5pY29ybkNvdW50KTsNCiAgZXZlbnQgQm9va2luZ1VwZGF0ZShhZGRyZXNzIGluZGV4ZWQgX3dobywgdWludCBpbmRleGVkIF9pbmRleCwgVmlzaXRTdGF0ZSBpbmRleGVkIF9uZXdTdGF0ZSwgdWludCBfdW5pY29ybkNvdW50KTsNCiAgZXZlbnQgUmVwb3NzZXNzaW9uQm91bnR5KGFkZHJlc3MgaW5kZXhlZCBfd2hvLCB1aW50IF91bmljb3JuQ291bnQpOw0KICBldmVudCBEb25hdGlvblJlY2VpdmVkKGFkZHJlc3MgaW5kZXhlZCBfd2hvLCB1aW50IF91bmljb3JuQ291bnQpOw0KDQogIG1vZGlmaWVyIG9ubHlPd25lciB7DQogICAgcmVxdWlyZShtc2cuc2VuZGVyID09IG93bmVyKTsNCiAgICBfOw0KICB9DQogIA0KICBmdW5jdGlvbiBVbmljb3JuUmFuY2goKSB7DQogICAgdmlzaXRMZW5ndGhbdWludDgoVmlzaXRUeXBlLlNwYSldID0gNzIwOw0KICAgIHZpc2l0TGVuZ3RoW3VpbnQ4KFZpc2l0VHlwZS5BZnRlcm5vb24pXSA9IDE0NDA7DQogICAgdmlzaXRMZW5ndGhbdWludDgoVmlzaXRUeXBlLkRheSldID0gMjg4MDsNCiAgICB2aXNpdExlbmd0aFt1aW50OChWaXNpdFR5cGUuT3Zlcm5pZ2h0KV0gPSA4NjQwOw0KICAgIHZpc2l0TGVuZ3RoW3VpbnQ4KFZpc2l0VHlwZS5XZWVrKV0gPSA2MDQ4MDsNCiAgICB2aXNpdExlbmd0aFt1aW50OChWaXNpdFR5cGUuRXh0ZW5kZWQpXSA9IDEyMDk2MDsNCiAgICANCiAgICB2aXNpdENvc3RbdWludDgoVmlzaXRUeXBlLlNwYSldID0gMDsNCiAgICB2aXNpdENvc3RbdWludDgoVmlzaXRUeXBlLkFmdGVybm9vbildID0gMDsNCiAgICB2aXNpdENvc3RbdWludDgoVmlzaXRUeXBlLkRheSldID0gMSBzemFibzsNCiAgICB2aXNpdENvc3RbdWludDgoVmlzaXRUeXBlLk92ZXJuaWdodCldID0gMSBzemFibzsNCiAgICB2aXNpdENvc3RbdWludDgoVmlzaXRUeXBlLldlZWspXSA9IDEgc3phYm87DQogICAgdmlzaXRDb3N0W3VpbnQ4KFZpc2l0VHlwZS5FeHRlbmRlZCldID0gMSBzemFibzsNCiAgfQ0KDQoNCiAgZnVuY3Rpb24gZ2V0Qm9va2luZ0NvdW50KGFkZHJlc3MgX3dobykgY29uc3RhbnQgcmV0dXJucyAodWludCBjb3VudCkgew0KICAgIHJldHVybiBib29raW5nc1tfd2hvXS5sZW5ndGg7DQogIH0NCiAgZnVuY3Rpb24gZ2V0Qm9va2luZyhhZGRyZXNzIF93aG8sIHVpbnQgX2luZGV4KSBjb25zdGFudCByZXR1cm5zICh1aW50IF91bmljb3JuQ291bnQsIFZpc2l0VHlwZSBfdHlwZSwgdWludCBfc3RhcnRCbG9jaywgdWludCBfZXhwaXJlc0Jsb2NrLCBWaXNpdFN0YXRlIF9zdGF0ZSkgew0KICAgIFZpc2l0IHN0b3JhZ2UgdiA9IGJvb2tpbmdzW193aG9dW19pbmRleF07DQogICAgcmV0dXJuICh2LnVuaWNvcm5Db3VudCwgdi50LCB2LnN0YXJ0QmxvY2ssIHYuZXhwaXJlc0Jsb2NrLCB2LnN0YXRlKTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGJvb2tTcGFWaXNpdCh1aW50IF91bmljb3JuQ291bnQpIHBheWFibGUgew0KICAgIHJldHVybiBhZGRCb29raW5nKFZpc2l0VHlwZS5TcGEsIF91bmljb3JuQ291bnQpOw0KICB9DQogIGZ1bmN0aW9uIGJvb2tBZnRlcm5vb25WaXNpdCh1aW50IF91bmljb3JuQ291bnQpIHBheWFibGUgew0KICAgIHJldHVybiBhZGRCb29raW5nKFZpc2l0VHlwZS5BZnRlcm5vb24sIF91bmljb3JuQ291bnQpOw0KICB9DQogIGZ1bmN0aW9uIGJvb2tEYXlWaXNpdCh1aW50IF91bmljb3JuQ291bnQpIHBheWFibGUgew0KICAgIHJldHVybiBhZGRCb29raW5nKFZpc2l0VHlwZS5EYXksIF91bmljb3JuQ291bnQpOw0KICB9DQogIGZ1bmN0aW9uIGJvb2tPdmVybmlnaHRWaXNpdCh1aW50IF91bmljb3JuQ291bnQpIHBheWFibGUgew0KICAgIHJldHVybiBhZGRCb29raW5nKFZpc2l0VHlwZS5PdmVybmlnaHQsIF91bmljb3JuQ291bnQpOw0KICB9DQogIGZ1bmN0aW9uIGJvb2tXZWVrVmlzaXQodWludCBfdW5pY29ybkNvdW50KSBwYXlhYmxlIHsNCiAgICByZXR1cm4gYWRkQm9va2luZyhWaXNpdFR5cGUuV2VlaywgX3VuaWNvcm5Db3VudCk7DQogIH0NCiAgZnVuY3Rpb24gYm9va0V4dGVuZGVkVmlzaXQodWludCBfdW5pY29ybkNvdW50KSBwYXlhYmxlIHsNCiAgICByZXR1cm4gYWRkQm9va2luZyhWaXNpdFR5cGUuRXh0ZW5kZWQsIF91bmljb3JuQ291bnQpOw0KICB9DQogIA0KICBmdW5jdGlvbiBhZGRCb29raW5nKFZpc2l0VHlwZSBfdHlwZSwgdWludCBfdW5pY29ybkNvdW50KSBwYXlhYmxlIHsNCiAgICBpZiAoX3R5cGUgPT0gVmlzaXRUeXBlLkFmdGVybm9vbikgew0KICAgICAgcmV0dXJuIGRvbmF0ZVVuaWNvcm5zKGF2YWlsYWJsZUJhbGFuY2UobXNnLnNlbmRlcikpOw0KICAgIH0NCiAgICByZXF1aXJlKG1zZy52YWx1ZSA+PSB2aXNpdENvc3RbdWludDgoX3R5cGUpXS5tdWwoX3VuaWNvcm5Db3VudCkpOyAvLyBNdXN0IGJlIHBheWluZyBwcm9wZXIgYW1vdW50DQoNCiAgICBFUkMyMFRva2VuIGNhcmRib2FyZFVuaWNvcm5zID0gRVJDMjBUb2tlbihjYXJkYm9hcmRVbmljb3JuVG9rZW5BZGRyZXNzKTsNCiAgICBjYXJkYm9hcmRVbmljb3Jucy50cmFuc2ZlckZyb20obXNnLnNlbmRlciwgYWRkcmVzcyh0aGlzKSwgX3VuaWNvcm5Db3VudCk7IC8vIFRyYW5zZmVyIHRoZSBhY3R1YWwgYXNzZXQNCiAgICB2aXNpdGluZ1VuaWNvcm5zID0gdmlzaXRpbmdVbmljb3Jucy5hZGQoX3VuaWNvcm5Db3VudCk7DQogICAgdWludCBleHBpcmVzQmxvY2sgPSBibG9jay5udW1iZXIuYWRkKHZpc2l0TGVuZ3RoW3VpbnQ4KF90eXBlKV0pOyAvLyBDYWxjdWxhdGUgd2hlbiB0aGlzIGJvb2tpbmcgd2lsbCBiZSBkb25lDQogICAgDQogICAgLy8gQWRkIHRoZSBib29raW5nIHRvIHRoZSBsZWRnZXINCiAgICBib29raW5nc1ttc2cuc2VuZGVyXS5wdXNoKFZpc2l0KA0KICAgICAgX3VuaWNvcm5Db3VudCwNCiAgICAgIF90eXBlLA0KICAgICAgYmxvY2subnVtYmVyLA0KICAgICAgZXhwaXJlc0Jsb2NrLA0KICAgICAgVmlzaXRTdGF0ZS5JblByb2dyZXNzDQogICAgKSk7DQogICAgdWludCBuZXdJbmRleCA9IGJvb2tpbmdzW21zZy5zZW5kZXJdLmxlbmd0aCAtIDE7DQogICAgYnl0ZXMzMiB1bmlxdWVLZXkgPSBrZWNjYWsyNTYobXNnLnNlbmRlciwgbmV3SW5kZXgpOyAvLyBDcmVhdGUgYSB1bmlxdWUga2V5IGZvciB0aGlzIGJvb2tpbmcNCiAgICANCiAgICAvLyBBZGQgYSByZWZlcmVuY2UgZm9yIHRoYXQga2V5LCB0byBmaW5kIHRoZSBtZXRhZGF0YSBhYm91dCBpdCBsYXRlcg0KICAgIGJvb2tpbmdNZXRhZGF0YUZvcktleVt1bmlxdWVLZXldID0gVmlzaXRNZXRhKA0KICAgICAgbXNnLnNlbmRlciwNCiAgICAgIG5ld0luZGV4DQogICAgKTsNCiAgICANCiAgICBpZiAoZ3JvdmVBZGRyZXNzID4gMCkgew0KICAgICAgLy8gSW5zZXJ0IGludG8gR3JvdmUgaW5kZXggZm9yIGFwcGxpY2F0aW9ucyB0byBxdWVyeQ0KICAgICAgR3JvdmVBUEkgZyA9IEdyb3ZlQVBJKGdyb3ZlQWRkcmVzcyk7DQogICAgICBnLmluc2VydCgiYm9va2luZ0V4cGlyYXRpb24iLCB1bmlxdWVLZXksIGludChleHBpcmVzQmxvY2spKTsNCiAgICB9DQogICAgDQogICAgLy8gU2VuZCBldmVudCBhYm91dCB0aGlzIG5ldyBib29raW5nDQogICAgTmV3Qm9va2luZyhtc2cuc2VuZGVyLCBuZXdJbmRleCwgX3R5cGUsIF91bmljb3JuQ291bnQpOw0KICB9DQogIA0KICBmdW5jdGlvbiBjb21wbGV0ZUJvb2tpbmcodWludCBfaW5kZXgpIHsNCiAgICByZXF1aXJlKGJvb2tpbmdzW21zZy5zZW5kZXJdLmxlbmd0aCA+IF9pbmRleCk7IC8vIFNlbmRlciBtdXN0IGhhdmUgYXQgbGVhc3QgdGhpcyBtYW55IGJvb2tpbmdzDQogICAgVmlzaXQgc3RvcmFnZSB2ID0gYm9va2luZ3NbbXNnLnNlbmRlcl1bX2luZGV4XTsNCiAgICByZXF1aXJlKGJsb2NrLm51bWJlciA+PSB2LmV4cGlyZXNCbG9jayk7IC8vIEV4cGlyZWQgdGltZSBtdXN0IGJlIHBhc3QNCiAgICByZXF1aXJlKHYuc3RhdGUgPT0gVmlzaXRTdGF0ZS5JblByb2dyZXNzKTsgLy8gVmlzaXQgbXVzdCBub3QgYmUgY29tcGxldGUgb3IgcmVwb3NzZXNzZWQNCiAgICANCiAgICB1aW50IHVuaWNvcm5zVG9SZXR1cm4gPSB2LnVuaWNvcm5Db3VudDsNCiAgICBFUkMyMFRva2VuIGNhcmRib2FyZFVuaWNvcm5zID0gRVJDMjBUb2tlbihjYXJkYm9hcmRVbmljb3JuVG9rZW5BZGRyZXNzKTsNCg0KICAgIC8vIERldGVybWluZSBpZiBhbnkgYmlydGhzIG9jY3VycmVkDQogICAgdWludCBiaXJ0aENvdW50ID0gMDsNCiAgICBpZiAoU2FmZU1hdGguc3ViKGJsb2NrLm51bWJlciwgdi5zdGFydEJsb2NrKSA+PSBiaXJ0aEJsb2NrVGhyZXNob2xkKSB7DQogICAgICBpZiAodi51bmljb3JuQ291bnQgPj0gMTAwKSB7DQogICAgICAgIGJpcnRoQ291bnQgPSB1aW50KGJpcnRoUGVySHVuZHJlZCkubXVsKHYudW5pY29ybkNvdW50IC8gMTAwKTsNCiAgICAgIH0gZWxzZSBpZiAodi51bmljb3JuQ291bnQgPj0gMTApIHsNCiAgICAgICAgYmlydGhDb3VudCA9IHVpbnQoYmlydGhQZXJUZW4pLm11bCh2LnVuaWNvcm5Db3VudCAvIDEwKTsNCiAgICAgIH0NCiAgICB9DQogICAgaWYgKGJpcnRoQ291bnQgPiAwKSB7DQogICAgICB1aW50IGF2YWlsYWJsZVVuaWNvcm5zID0gY2FyZGJvYXJkVW5pY29ybnMuYmFsYW5jZU9mKGFkZHJlc3ModGhpcykpIC0gdmlzaXRpbmdVbmljb3JuczsNCiAgICAgIGlmIChhdmFpbGFibGVVbmljb3JucyA8IGJpcnRoQ291bnQpIHsNCiAgICAgICAgYmlydGhDb3VudCA9IGF2YWlsYWJsZVVuaWNvcm5zOw0KICAgICAgfQ0KICAgICAgdW5pY29ybnNUb1JldHVybiA9IHVuaWNvcm5zVG9SZXR1cm4uYWRkKGJpcnRoQ291bnQpOw0KICAgIH0NCiAgICAgICAgDQogICAgLy8gVXBkYXRlIHRoZSBzdGF0dXMgb2YgdGhlIFZpc2l0DQogICAgdi5zdGF0ZSA9IFZpc2l0U3RhdGUuQ29tcGxldGVkOw0KICAgIGJvb2tpbmdzW21zZy5zZW5kZXJdW19pbmRleF0gPSB2Ow0KICAgIA0KICAgIC8vIFRyYW5zZmVyIHRoZSBhc3NldCBiYWNrIHRvIHRoZSBvd25lcg0KICAgIHZpc2l0aW5nVW5pY29ybnMgPSB2aXNpdGluZ1VuaWNvcm5zLnN1Yih1bmljb3Juc1RvUmV0dXJuKTsNCiAgICBjYXJkYm9hcmRVbmljb3Jucy50cmFuc2Zlcihtc2cuc2VuZGVyLCB1bmljb3Juc1RvUmV0dXJuKTsNCiAgICANCiAgICAvLyBTZW5kIGV2ZW50IGFib3V0IHRoaXMgdXBkYXRlDQogICAgQm9va2luZ1VwZGF0ZShtc2cuc2VuZGVyLCBfaW5kZXgsIFZpc2l0U3RhdGUuQ29tcGxldGVkLCB1bmljb3Juc1RvUmV0dXJuKTsNCiAgfQ0KICANCiAgZnVuY3Rpb24gcmVwb3NzZXNzQm9va2luZyhhZGRyZXNzIF93aG8sIHVpbnQgX2luZGV4KSB7DQogICAgcmVxdWlyZShib29raW5nc1tfd2hvXS5sZW5ndGggPiBfaW5kZXgpOyAvLyBBZGRyZXNzIGluIHF1ZXN0aW9uIG11c3QgaGF2ZSBhdCBsZWFzdCB0aGlzIG1hbnkgYm9va2luZ3MNCiAgICBWaXNpdCBzdG9yYWdlIHYgPSBib29raW5nc1tfd2hvXVtfaW5kZXhdOw0KICAgIHJlcXVpcmUoYmxvY2subnVtYmVyID4gdi5leHBpcmVzQmxvY2suYWRkKHJlcG9zc2Vzc2lvbkJsb2NrcykpOyAvLyBSZXBvc3Nlc3Npb24gdGltZSBtdXN0IGJlIHBhc3QNCiAgICByZXF1aXJlKHYuc3RhdGUgPT0gVmlzaXRTdGF0ZS5JblByb2dyZXNzKTsgLy8gVmlzaXQgbXVzdCBub3QgYmUgY29tcGxldGUgb3IgcmVwb3NzZXNzZWQNCiAgICANCiAgICAvLyBVcGRhdGUgdGhlIHN0YXR1cyBvZiB0aGUgVmlzaXQNCiAgICB2LnN0YXRlID0gVmlzaXRTdGF0ZS5SZXBvc3Nlc3NlZDsNCiAgICBib29raW5nc1tfd2hvXVtfaW5kZXhdID0gdjsNCiAgICB2aXNpdGluZ1VuaWNvcm5zID0gdmlzaXRpbmdVbmljb3Jucy5zdWIodi51bmljb3JuQ291bnQpOw0KICAgIA0KICAgIC8vIFNlbmQgZXZlbnQgYWJvdXQgdGhpcyB1cGRhdGUNCiAgICBCb29raW5nVXBkYXRlKF93aG8sIF9pbmRleCwgVmlzaXRTdGF0ZS5SZXBvc3Nlc3NlZCwgdi51bmljb3JuQ291bnQpOw0KICAgIA0KICAgIC8vIENhbGN1bGF0ZSBCb3VudHkgYW1vdW50DQogICAgdWludCBib3VudHlDb3VudCA9IDE7DQogICAgaWYgKHYudW5pY29ybkNvdW50ID49IDEwMCkgew0KICAgICAgICBib3VudHlDb3VudCA9IHVpbnQocmVwb3NzZXNzaW9uQm91bnR5UGVySHVuZHJlZCkubXVsKHYudW5pY29ybkNvdW50IC8gMTAwKTsNCiAgICB9IGVsc2UgaWYgKHYudW5pY29ybkNvdW50ID49IDEwKSB7DQogICAgICBib3VudHlDb3VudCA9IHVpbnQocmVwb3NzZXNzaW9uQm91bnR5UGVyVGVuKS5tdWwodi51bmljb3JuQ291bnQgLyAxMCk7DQogICAgfQ0KICAgIA0KICAgIC8vIFNlbmQgYm91bnR5IHRvIGJvdW50eSBodW50ZXINCiAgICBFUkMyMFRva2VuIGNhcmRib2FyZFVuaWNvcm5zID0gRVJDMjBUb2tlbihjYXJkYm9hcmRVbmljb3JuVG9rZW5BZGRyZXNzKTsNCiAgICBjYXJkYm9hcmRVbmljb3Jucy50cmFuc2Zlcihtc2cuc2VuZGVyLCBib3VudHlDb3VudCk7DQogICAgDQogICAgLy8gU2VuZCBldmVudCBhYm91dCB0aGUgYm91bnR5IHBheW91dA0KICAgIFJlcG9zc2Vzc2lvbkJvdW50eShtc2cuc2VuZGVyLCBib3VudHlDb3VudCk7DQogIH0NCiAgDQogIGZ1bmN0aW9uIGF2YWlsYWJsZUJhbGFuY2UoYWRkcmVzcyBfd2hvKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgRVJDMjBUb2tlbiBjYXJkYm9hcmRVbmljb3JucyA9IEVSQzIwVG9rZW4oY2FyZGJvYXJkVW5pY29yblRva2VuQWRkcmVzcyk7DQogICAgdWludCBjb3VudCA9IGNhcmRib2FyZFVuaWNvcm5zLmFsbG93YW5jZShfd2hvLCBhZGRyZXNzKHRoaXMpKTsNCiAgICBpZiAoY291bnQgPT0gMCkgew0KICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIHVpbnQgYmFsYW5jZSA9IGNhcmRib2FyZFVuaWNvcm5zLmJhbGFuY2VPZihfd2hvKTsNCiAgICBpZiAoYmFsYW5jZSA8IGNvdW50KSB7DQogICAgICByZXR1cm4gYmFsYW5jZTsNCiAgICB9DQogICAgcmV0dXJuIGNvdW50Ow0KICB9DQogIA0KICBmdW5jdGlvbigpIHBheWFibGUgew0KICAgIGlmIChjYXJkYm9hcmRVbmljb3JuVG9rZW5BZGRyZXNzID09IDApIHsNCiAgICAgIHJldHVybjsNCiAgICB9DQogICAgcmV0dXJuIGRvbmF0ZVVuaWNvcm5zKGF2YWlsYWJsZUJhbGFuY2UobXNnLnNlbmRlcikpOw0KICB9DQogIA0KICBmdW5jdGlvbiBkb25hdGVVbmljb3Jucyh1aW50IF91bmljb3JuQ291bnQpIHBheWFibGUgew0KICAgIGlmIChfdW5pY29ybkNvdW50ID09IDApIHsNCiAgICAgIHJldHVybjsNCiAgICB9DQogICAgRVJDMjBUb2tlbiBjYXJkYm9hcmRVbmljb3JucyA9IEVSQzIwVG9rZW4oY2FyZGJvYXJkVW5pY29yblRva2VuQWRkcmVzcyk7DQogICAgY2FyZGJvYXJkVW5pY29ybnMudHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF91bmljb3JuQ291bnQpOw0KICAgIERvbmF0aW9uUmVjZWl2ZWQobXNnLnNlbmRlciwgX3VuaWNvcm5Db3VudCk7DQogIH0NCiAgDQogIC8qKg0KICAgKiBDaGFuZ2Ugb3duZXJzaGlwIG9mIHRoZSBSYW5jaA0KICAgKi8NCiAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfbmV3T3duZXIpIG9ubHlPd25lciB7DQogICAgb3duZXIgPSBfbmV3T3duZXI7DQogIH0NCg0KICAvKioNCiAgICogQ2hhbmdlIHRoZSBvdXRzaWRlIGNvbnRyYWN0cyB1c2VkIGJ5IHRoaXMgY29udHJhY3QNCiAgICovDQogIGZ1bmN0aW9uIGNoYW5nZUNhcmRib2FyZFVuaWNvcm5Ub2tlbkFkZHJlc3MoYWRkcmVzcyBfbmV3VG9rZW5BZGRyZXNzKSBvbmx5T3duZXIgew0KICAgIGNhcmRib2FyZFVuaWNvcm5Ub2tlbkFkZHJlc3MgPSBfbmV3VG9rZW5BZGRyZXNzOw0KICB9DQogIGZ1bmN0aW9uIGNoYW5nZUdyb3ZlQWRkcmVzcyhhZGRyZXNzIF9uZXdBZGRyZXNzKSBvbmx5T3duZXIgew0KICAgIGdyb3ZlQWRkcmVzcyA9IF9uZXdBZGRyZXNzOw0KICB9DQogIA0KICAvKioNCiAgICogVXBkYXRlIGJsb2NrIGR1cmF0aW9ucyBmb3IgdmFyaW91cyB0eXBlcyBvZiB2aXNpdHMNCiAgICovDQogIGZ1bmN0aW9uIGNoYW5nZVZpc2l0TGVuZ3Rocyh1aW50IF9zcGEsIHVpbnQgX2FmdGVybm9vbiwgdWludCBfZGF5LCB1aW50IF9vdmVybmlnaHQsIHVpbnQgX3dlZWssIHVpbnQgX2V4dGVuZGVkKSBvbmx5T3duZXIgew0KICAgIHZpc2l0TGVuZ3RoW3VpbnQ4KFZpc2l0VHlwZS5TcGEpXSA9IF9zcGE7DQogICAgdmlzaXRMZW5ndGhbdWludDgoVmlzaXRUeXBlLkFmdGVybm9vbildID0gX2FmdGVybm9vbjsNCiAgICB2aXNpdExlbmd0aFt1aW50OChWaXNpdFR5cGUuRGF5KV0gPSBfZGF5Ow0KICAgIHZpc2l0TGVuZ3RoW3VpbnQ4KFZpc2l0VHlwZS5PdmVybmlnaHQpXSA9IF9vdmVybmlnaHQ7DQogICAgdmlzaXRMZW5ndGhbdWludDgoVmlzaXRUeXBlLldlZWspXSA9IF93ZWVrOw0KICAgIHZpc2l0TGVuZ3RoW3VpbnQ4KFZpc2l0VHlwZS5FeHRlbmRlZCldID0gX2V4dGVuZGVkOw0KICB9DQogIA0KICAvKioNCiAgICogVXBkYXRlIGV0aGVyIGNvc3RzIGZvciB2YXJpb3VzIHR5cGVzIG9mIHZpc2l0cw0KICAgKi8NCiAgZnVuY3Rpb24gY2hhbmdlVmlzaXRDb3N0cyh1aW50IF9zcGEsIHVpbnQgX2FmdGVybm9vbiwgdWludCBfZGF5LCB1aW50IF9vdmVybmlnaHQsIHVpbnQgX3dlZWssIHVpbnQgX2V4dGVuZGVkKSBvbmx5T3duZXIgew0KICAgIHZpc2l0Q29zdFt1aW50OChWaXNpdFR5cGUuU3BhKV0gPSBfc3BhOw0KICAgIHZpc2l0Q29zdFt1aW50OChWaXNpdFR5cGUuQWZ0ZXJub29uKV0gPSBfYWZ0ZXJub29uOw0KICAgIHZpc2l0Q29zdFt1aW50OChWaXNpdFR5cGUuRGF5KV0gPSBfZGF5Ow0KICAgIHZpc2l0Q29zdFt1aW50OChWaXNpdFR5cGUuT3Zlcm5pZ2h0KV0gPSBfb3Zlcm5pZ2h0Ow0KICAgIHZpc2l0Q29zdFt1aW50OChWaXNpdFR5cGUuV2VlayldID0gX3dlZWs7DQogICAgdmlzaXRDb3N0W3VpbnQ4KFZpc2l0VHlwZS5FeHRlbmRlZCldID0gX2V4dGVuZGVkOw0KICB9DQogIA0KICAvKioNCiAgICogVXBkYXRlIGJvdW50eSByZXdhcmQgc2V0dGluZ3MNCiAgICovDQogIGZ1bmN0aW9uIGNoYW5nZVJlcG9TZXR0aW5ncyh1aW50IF9yZXBvQmxvY2tzLCB1aW50OCBfcmVwb1BlclRlbiwgdWludDggX3JlcG9QZXJIdW5kcmVkKSBvbmx5T3duZXIgew0KICAgIHJlcG9zc2Vzc2lvbkJsb2NrcyA9IF9yZXBvQmxvY2tzOw0KICAgIHJlcG9zc2Vzc2lvbkJvdW50eVBlclRlbiA9IF9yZXBvUGVyVGVuOw0KICAgIHJlcG9zc2Vzc2lvbkJvdW50eVBlckh1bmRyZWQgPSBfcmVwb1Blckh1bmRyZWQ7DQogIH0NCiAgDQogIC8qKg0KICAgKiBVcGRhdGUgYmlydGggZXZlbnQgc2V0dGluZ3MNCiAgICovDQogIGZ1bmN0aW9uIGNoYW5nZUJpcnRoU2V0dGluZ3ModWludCBfYmlydGhCbG9ja3MsIHVpbnQ4IF9iaXJ0aFBlclRlbiwgdWludDggX2JpcnRoUGVySHVuZHJlZCkgb25seU93bmVyIHsNCiAgICBiaXJ0aEJsb2NrVGhyZXNob2xkID0gX2JpcnRoQmxvY2tzOw0KICAgIGJpcnRoUGVyVGVuID0gX2JpcnRoUGVyVGVuOw0KICAgIGJpcnRoUGVySHVuZHJlZCA9IF9iaXJ0aFBlckh1bmRyZWQ7DQogIH0NCg0KICBmdW5jdGlvbiB3aXRoZHJhdygpIG9ubHlPd25lciB7DQogICAgb3duZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsgLy8gU2VuZCBhbGwgZXRoZXIgaW4gdGhpcyBjb250cmFjdCB0byB0aGlzIGNvbnRyYWN0J3Mgb3duZXINCiAgfQ0KICBmdW5jdGlvbiB3aXRoZHJhd0ZvcmVpZ25Ub2tlbnMoYWRkcmVzcyBfdG9rZW5Db250cmFjdCkgb25seU93bmVyIHsNCiAgICBFUkMyMFRva2VuIHRva2VuID0gRVJDMjBUb2tlbihfdG9rZW5Db250cmFjdCk7DQogICAgdG9rZW4udHJhbnNmZXIob3duZXIsIHRva2VuLmJhbGFuY2VPZihhZGRyZXNzKHRoaXMpKSk7IC8vIFNlbmQgYWxsIG93bmVkIHRva2VucyB0byB0aGlzIGNvbnRyYWN0J3Mgb3duZXINCiAgfQ0KICANCn0='