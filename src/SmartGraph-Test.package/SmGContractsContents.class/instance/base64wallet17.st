base 64 content
base64wallet17
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC42Ow0KDQpjb250cmFjdCBtdWx0aW93bmVkIHsNCg0KCS8vIFRZUEVTDQoNCiAgICAvLyBzdHJ1Y3QgZm9yIHRoZSBzdGF0dXMgb2YgYSBwZW5kaW5nIG9wZXJhdGlvbi4NCiAgICBzdHJ1Y3QgUGVuZGluZ1N0YXRlIHsNCiAgICAgICAgdWludCB5ZXROZWVkZWQ7DQogICAgICAgIHVpbnQgb3duZXJzRG9uZTsNCiAgICAgICAgdWludCBpbmRleDsNCiAgICB9DQoNCgkvLyBFVkVOVFMNCg0KICAgIC8vIHRoaXMgY29udHJhY3Qgb25seSBoYXMgc2l4IHR5cGVzIG9mIGV2ZW50czogaXQgY2FuIGFjY2VwdCBhIGNvbmZpcm1hdGlvbiwgaW4gd2hpY2ggY2FzZQ0KICAgIC8vIHdlIHJlY29yZCBvd25lciBhbmQgb3BlcmF0aW9uIChoYXNoKSBhbG9uZ3NpZGUgaXQuDQogICAgZXZlbnQgQ29uZmlybWF0aW9uKGFkZHJlc3Mgb3duZXIsIGJ5dGVzMzIgb3BlcmF0aW9uKTsNCiAgICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOw0KICAgIC8vIHNvbWUgb3RoZXJzIGFyZSBpbiB0aGUgY2FzZSBvZiBhbiBvd25lciBjaGFuZ2luZy4NCiAgICBldmVudCBPd25lckNoYW5nZWQoYWRkcmVzcyBvbGRPd25lciwgYWRkcmVzcyBuZXdPd25lcik7DQogICAgZXZlbnQgT3duZXJBZGRlZChhZGRyZXNzIG5ld093bmVyKTsNCiAgICBldmVudCBPd25lclJlbW92ZWQoYWRkcmVzcyBvbGRPd25lcik7DQogICAgLy8gdGhlIGxhc3Qgb25lIGlzIGVtaXR0ZWQgaWYgdGhlIHJlcXVpcmVkIHNpZ25hdHVyZXMgY2hhbmdlDQogICAgZXZlbnQgUmVxdWlyZW1lbnRDaGFuZ2VkKHVpbnQgbmV3UmVxdWlyZW1lbnQpOw0KDQoJLy8gTU9ESUZJRVJTDQoNCiAgICAvLyBzaW1wbGUgc2luZ2xlLXNpZyBmdW5jdGlvbiBtb2RpZmllci4NCiAgICBtb2RpZmllciBvbmx5b3duZXIgew0KICAgICAgICBpZiAoaXNPd25lcihtc2cuc2VuZGVyKSkNCiAgICAgICAgICAgIF87DQogICAgfQ0KICAgIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXINCiAgICAvLyB0aGF0IGxhdGVyIGF0dGVtcHRzIGNhbiBiZSByZWFsaXNlZCBhcyB0aGUgc2FtZSB1bmRlcmx5aW5nIG9wZXJhdGlvbiBhbmQNCiAgICAvLyB0aHVzIGNvdW50IGFzIGNvbmZpcm1hdGlvbnMuDQogICAgbW9kaWZpZXIgb25seW1hbnlvd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7DQogICAgICAgIGlmIChjb25maXJtQW5kQ2hlY2soX29wZXJhdGlvbikpDQogICAgICAgICAgICBfOw0KICAgIH0NCg0KCS8vIE1FVEhPRFMNCg0KICAgIC8vIGNvbnN0cnVjdG9yIGlzIGdpdmVuIG51bWJlciBvZiBzaWdzIHJlcXVpcmVkIHRvIGRvIHByb3RlY3RlZCAib25seW1hbnlvd25lcnMiIHRyYW5zYWN0aW9ucw0KICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0uDQogICAgZnVuY3Rpb24gbXVsdGlvd25lZChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIHsNCiAgICAgICAgbV9udW1Pd25lcnMgPSBfb3duZXJzLmxlbmd0aCArIDE7DQogICAgICAgIG1fb3duZXJzWzFdID0gdWludChtc2cuc2VuZGVyKTsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildID0gMTsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX293bmVycy5sZW5ndGg7ICsraSkNCiAgICAgICAgew0KICAgICAgICAgICAgbV9vd25lcnNbMiArIGldID0gdWludChfb3duZXJzW2ldKTsNCiAgICAgICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcnNbaV0pXSA9IDIgKyBpOw0KICAgICAgICB9DQogICAgICAgIG1fcmVxdWlyZWQgPSBfcmVxdWlyZWQ7DQogICAgfQ0KICAgIA0KICAgIC8vIFJldm9rZXMgYSBwcmlvciBjb25maXJtYXRpb24gb2YgdGhlIGdpdmVuIG9wZXJhdGlvbg0KICAgIGZ1bmN0aW9uIHJldm9rZShieXRlczMyIF9vcGVyYXRpb24pIGV4dGVybmFsIHsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildOw0KICAgICAgICAvLyBtYWtlIHN1cmUgdGhleSdyZSBhbiBvd25lcg0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQogICAgICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IDIqKm93bmVySW5kZXg7DQogICAgICAgIHZhciBwZW5kaW5nID0gbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICBpZiAocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA+IDApIHsNCiAgICAgICAgICAgIHBlbmRpbmcueWV0TmVlZGVkKys7DQogICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgLT0gb3duZXJJbmRleEJpdDsNCiAgICAgICAgICAgIFJldm9rZShtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBSZXBsYWNlcyBhbiBvd25lciBgX2Zyb21gIHdpdGggYW5vdGhlciBgX3RvYC4NCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bykgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKGlzT3duZXIoX3RvKSkgcmV0dXJuOw0KICAgICAgICB1aW50IG93bmVySW5kZXggPSBtX293bmVySW5kZXhbdWludChfZnJvbSldOw0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQoNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIG1fb3duZXJzW293bmVySW5kZXhdID0gdWludChfdG8pOw0KICAgICAgICBtX293bmVySW5kZXhbdWludChfZnJvbSldID0gMDsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQoX3RvKV0gPSBvd25lckluZGV4Ow0KICAgICAgICBPd25lckNoYW5nZWQoX2Zyb20sIF90byk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3MgX293bmVyKSBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoaXNPd25lcihfb3duZXIpKSByZXR1cm47DQoNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIGlmIChtX251bU93bmVycyA+PSBjX21heE93bmVycykNCiAgICAgICAgICAgIHJlb3JnYW5pemVPd25lcnMoKTsNCiAgICAgICAgaWYgKG1fbnVtT3duZXJzID49IGNfbWF4T3duZXJzKQ0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICBtX251bU93bmVycysrOw0KICAgICAgICBtX293bmVyc1ttX251bU93bmVyc10gPSB1aW50KF9vd25lcik7DQogICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcildID0gbV9udW1Pd25lcnM7DQogICAgICAgIE93bmVyQWRkZWQoX293bmVyKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBfb3duZXIpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IG1fb3duZXJJbmRleFt1aW50KF9vd25lcildOw0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQogICAgICAgIGlmIChtX3JlcXVpcmVkID4gbV9udW1Pd25lcnMgLSAxKSByZXR1cm47DQoNCiAgICAgICAgbV9vd25lcnNbb3duZXJJbmRleF0gPSAwOw0KICAgICAgICBtX293bmVySW5kZXhbdWludChfb3duZXIpXSA9IDA7DQogICAgICAgIGNsZWFyUGVuZGluZygpOw0KICAgICAgICByZW9yZ2FuaXplT3duZXJzKCk7IC8vbWFrZSBzdXJlIG1fbnVtT3duZXIgaXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvd25lcnMgYW5kIGFsd2F5cyBwb2ludHMgdG8gdGhlIG9wdGltYWwgZnJlZSBzbG90DQogICAgICAgIE93bmVyUmVtb3ZlZChfb3duZXIpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBjaGFuZ2VSZXF1aXJlbWVudCh1aW50IF9uZXdSZXF1aXJlZCkgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKF9uZXdSZXF1aXJlZCA+IG1fbnVtT3duZXJzKSByZXR1cm47DQogICAgICAgIG1fcmVxdWlyZWQgPSBfbmV3UmVxdWlyZWQ7DQogICAgICAgIGNsZWFyUGVuZGluZygpOw0KICAgICAgICBSZXF1aXJlbWVudENoYW5nZWQoX25ld1JlcXVpcmVkKTsNCiAgICB9DQoNCiAgICAvLyBHZXRzIGFuIG93bmVyIGJ5IDAtaW5kZXhlZCBwb3NpdGlvbiAodXNpbmcgbnVtT3duZXJzIGFzIHRoZSBjb3VudCkNCiAgICBmdW5jdGlvbiBnZXRPd25lcih1aW50IG93bmVySW5kZXgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIGFkZHJlc3MobV9vd25lcnNbb3duZXJJbmRleCArIDFdKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX2FkZHIpIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgcmV0dXJuIG1fb3duZXJJbmRleFt1aW50KF9hZGRyKV0gPiAwOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBoYXNDb25maXJtZWQoYnl0ZXMzMiBfb3BlcmF0aW9uLCBhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICB2YXIgcGVuZGluZyA9IG1fcGVuZGluZ1tfb3BlcmF0aW9uXTsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQoX293bmVyKV07DQoNCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4NCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgcmV0dXJuICEocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA9PSAwKTsNCiAgICB9DQogICAgDQogICAgLy8gSU5URVJOQUwgTUVUSE9EUw0KDQogICAgZnVuY3Rpb24gY29uZmlybUFuZENoZWNrKGJ5dGVzMzIgX29wZXJhdGlvbikgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICAvLyBkZXRlcm1pbmUgd2hhdCBpbmRleCB0aGUgcHJlc2VudCBzZW5kZXIgaXM6DQogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IG1fb3duZXJJbmRleFt1aW50KG1zZy5zZW5kZXIpXTsNCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuOw0KDQogICAgICAgIHZhciBwZW5kaW5nID0gbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICAvLyBpZiB3ZSdyZSBub3QgeWV0IHdvcmtpbmcgb24gdGhpcyBvcGVyYXRpb24sIHN3aXRjaCBvdmVyIGFuZCByZXNldCB0aGUgY29uZmlybWF0aW9uIHN0YXR1cy4NCiAgICAgICAgaWYgKHBlbmRpbmcueWV0TmVlZGVkID09IDApIHsNCiAgICAgICAgICAgIC8vIHJlc2V0IGNvdW50IG9mIGNvbmZpcm1hdGlvbnMgbmVlZGVkLg0KICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQgPSBtX3JlcXVpcmVkOw0KICAgICAgICAgICAgLy8gcmVzZXQgd2hpY2ggb3duZXJzIGhhdmUgY29uZmlybWVkIChub25lKSAtIHNldCBvdXIgYml0bWFwIHRvIDAuDQogICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgPSAwOw0KICAgICAgICAgICAgcGVuZGluZy5pbmRleCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aCsrOw0KICAgICAgICAgICAgbV9wZW5kaW5nSW5kZXhbcGVuZGluZy5pbmRleF0gPSBfb3BlcmF0aW9uOw0KICAgICAgICB9DQogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4NCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgLy8gbWFrZSBzdXJlIHdlICh0aGUgbWVzc2FnZSBzZW5kZXIpIGhhdmVuJ3QgY29uZmlybWVkIHRoaXMgb3BlcmF0aW9uIHByZXZpb3VzbHkuDQogICAgICAgIGlmIChwZW5kaW5nLm93bmVyc0RvbmUgJiBvd25lckluZGV4Qml0ID09IDApIHsNCiAgICAgICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsNCiAgICAgICAgICAgIC8vIG9rIC0gY2hlY2sgaWYgY291bnQgaXMgZW5vdWdoIHRvIGdvIGFoZWFkLg0KICAgICAgICAgICAgaWYgKHBlbmRpbmcueWV0TmVlZGVkIDw9IDEpIHsNCiAgICAgICAgICAgICAgICAvLyBlbm91Z2ggY29uZmlybWF0aW9uczogcmVzZXQgYW5kIHJ1biBpbnRlcmlvci4NCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nSW5kZXhbbV9wZW5kaW5nW19vcGVyYXRpb25dLmluZGV4XTsNCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIG5vdCBlbm91Z2g6IHJlY29yZCB0aGF0IHRoaXMgb3duZXIgaW4gcGFydGljdWxhciBjb25maXJtZWQuDQogICAgICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQtLTsNCiAgICAgICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgfD0gb3duZXJJbmRleEJpdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlb3JnYW5pemVPd25lcnMoKSBwcml2YXRlIHsNCiAgICAgICAgdWludCBmcmVlID0gMTsNCiAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycykNCiAgICAgICAgew0KICAgICAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1tmcmVlXSAhPSAwKSBmcmVlKys7DQogICAgICAgICAgICB3aGlsZSAobV9udW1Pd25lcnMgPiAxICYmIG1fb3duZXJzW21fbnVtT3duZXJzXSA9PSAwKSBtX251bU93bmVycy0tOw0KICAgICAgICAgICAgaWYgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1ttX251bU93bmVyc10gIT0gMCAmJiBtX293bmVyc1tmcmVlXSA9PSAwKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIG1fb3duZXJzW2ZyZWVdID0gbV9vd25lcnNbbV9udW1Pd25lcnNdOw0KICAgICAgICAgICAgICAgIG1fb3duZXJJbmRleFttX293bmVyc1tmcmVlXV0gPSBmcmVlOw0KICAgICAgICAgICAgICAgIG1fb3duZXJzW21fbnVtT3duZXJzXSA9IDA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgaW50ZXJuYWwgew0KICAgICAgICB1aW50IGxlbmd0aCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aDsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpDQogICAgICAgICAgICBpZiAobV9wZW5kaW5nSW5kZXhbaV0gIT0gMCkNCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nW21fcGVuZGluZ0luZGV4W2ldXTsNCiAgICAgICAgZGVsZXRlIG1fcGVuZGluZ0luZGV4Ow0KICAgIH0NCiAgICAgICAgDQogICAJLy8gRklFTERTDQoNCiAgICAvLyB0aGUgbnVtYmVyIG9mIG93bmVycyB0aGF0IG11c3QgY29uZmlybSB0aGUgc2FtZSBvcGVyYXRpb24gYmVmb3JlIGl0IGlzIHJ1bi4NCiAgICB1aW50IHB1YmxpYyBtX3JlcXVpcmVkOw0KICAgIC8vIHBvaW50ZXIgdXNlZCB0byBmaW5kIGEgZnJlZSBzbG90IGluIG1fb3duZXJzDQogICAgdWludCBwdWJsaWMgbV9udW1Pd25lcnM7DQogICAgDQogICAgLy8gbGlzdCBvZiBvd25lcnMNCiAgICB1aW50WzI1Nl0gcHVibGljIG1fb3duZXJzOw0KICAgIHVpbnQgY29uc3RhbnQgY19tYXhPd25lcnMgPSAyNTA7DQogICAgLy8gaW5kZXggb24gdGhlIGxpc3Qgb2Ygb3duZXJzIHRvIGFsbG93IHJldmVyc2UgbG9va3VwDQogICAgbWFwcGluZyh1aW50ID0+IHVpbnQpIHB1YmxpYyBtX293bmVySW5kZXg7DQogICAgLy8gdGhlIG9uZ29pbmcgb3BlcmF0aW9ucy4NCiAgICBtYXBwaW5nKGJ5dGVzMzIgPT4gUGVuZGluZ1N0YXRlKSBwdWJsaWMgbV9wZW5kaW5nOw0KICAgIGJ5dGVzMzJbXSBwdWJsaWMgbV9wZW5kaW5nSW5kZXg7DQp9DQoNCi8vIGluaGVyaXRhYmxlICJwcm9wZXJ0eSIgY29udHJhY3QgdGhhdCBlbmFibGVzIG1ldGhvZHMgdG8gYmUgcHJvdGVjdGVkIGJ5IHBsYWNpbmcgYSBsaW5lYXIgbGltaXQgKHNwZWNpZmlhYmxlKQ0KLy8gb24gYSBwYXJ0aWN1bGFyIHJlc291cmNlIHBlciBjYWxlbmRhciBkYXkuIGlzIG11bHRpb3duZWQgdG8gYWxsb3cgdGhlIGxpbWl0IHRvIGJlIGFsdGVyZWQuIHJlc291cmNlIHRoYXQgbWV0aG9kDQovLyB1c2VzIGlzIHNwZWNpZmllZCBpbiB0aGUgbW9kaWZpZXIuDQpjb250cmFjdCBkYXlsaW1pdCBpcyBtdWx0aW93bmVkIHsNCg0KCS8vIE1PRElGSUVSUw0KDQogICAgLy8gc2ltcGxlIG1vZGlmaWVyIGZvciBkYWlseSBsaW1pdC4NCiAgICBtb2RpZmllciBsaW1pdGVkRGFpbHkodWludCBfdmFsdWUpIHsNCiAgICAgICAgaWYgKHVuZGVyTGltaXQoX3ZhbHVlKSkNCiAgICAgICAgICAgIF87DQogICAgfQ0KDQoJLy8gTUVUSE9EUw0KDQogICAgLy8gY29uc3RydWN0b3IgLSBzdG9yZXMgaW5pdGlhbCBkYWlseSBsaW1pdCBhbmQgcmVjb3JkcyB0aGUgcHJlc2VudCBkYXkncyBpbmRleC4NCiAgICBmdW5jdGlvbiBkYXlsaW1pdCh1aW50IF9saW1pdCkgew0KICAgICAgICBtX2RhaWx5TGltaXQgPSBfbGltaXQ7DQogICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgfQ0KICAgIC8vIChyZSlzZXRzIHRoZSBkYWlseSBsaW1pdC4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uIGRvZXNuJ3QgYWx0ZXIgdGhlIGFtb3VudCBhbHJlYWR5IHNwZW50IHRvZGF5Lg0KICAgIGZ1bmN0aW9uIHNldERhaWx5TGltaXQodWludCBfbmV3TGltaXQpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIG1fZGFpbHlMaW1pdCA9IF9uZXdMaW1pdDsNCiAgICB9DQogICAgLy8gcmVzZXRzIHRoZSBhbW91bnQgYWxyZWFkeSBzcGVudCB0b2RheS4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uIA0KICAgIGZ1bmN0aW9uIHJlc2V0U3BlbnRUb2RheSgpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIG1fc3BlbnRUb2RheSA9IDA7DQogICAgfQ0KICAgIA0KICAgIC8vIElOVEVSTkFMIE1FVEhPRFMNCiAgICANCiAgICAvLyBjaGVja3MgdG8gc2VlIGlmIHRoZXJlIGlzIGF0IGxlYXN0IGBfdmFsdWVgIGxlZnQgZnJvbSB0aGUgZGFpbHkgbGltaXQgdG9kYXkuIGlmIHRoZXJlIGlzLCBzdWJ0cmFjdHMgaXQgYW5kDQogICAgLy8gcmV0dXJucyB0cnVlLiBvdGhlcndpc2UganVzdCByZXR1cm5zIGZhbHNlLg0KICAgIGZ1bmN0aW9uIHVuZGVyTGltaXQodWludCBfdmFsdWUpIGludGVybmFsIG9ubHlvd25lciByZXR1cm5zIChib29sKSB7DQogICAgICAgIC8vIHJlc2V0IHRoZSBzcGVuZCBsaW1pdCBpZiB3ZSdyZSBvbiBhIGRpZmZlcmVudCBkYXkgdG8gbGFzdCB0aW1lLg0KICAgICAgICBpZiAodG9kYXkoKSA+IG1fbGFzdERheSkgew0KICAgICAgICAgICAgbV9zcGVudFRvZGF5ID0gMDsNCiAgICAgICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgICAgIH0NCiAgICAgICAgLy8gY2hlY2sgdG8gc2VlIGlmIHRoZXJlJ3MgZW5vdWdoIGxlZnQgLSBpZiBzbywgc3VidHJhY3QgYW5kIHJldHVybiB0cnVlLg0KICAgICAgICAvLyBvdmVyZmxvdyBwcm90ZWN0aW9uICAgICAgICAgICAgICAgICAgICAvLyBkYWlseUxpbWl0IGNoZWNrICANCiAgICAgICAgaWYgKG1fc3BlbnRUb2RheSArIF92YWx1ZSA+PSBtX3NwZW50VG9kYXkgJiYgbV9zcGVudFRvZGF5ICsgX3ZhbHVlIDw9IG1fZGFpbHlMaW1pdCkgew0KICAgICAgICAgICAgbV9zcGVudFRvZGF5ICs9IF92YWx1ZTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgLy8gZGV0ZXJtaW5lcyB0b2RheSdzIGluZGV4Lg0KICAgIGZ1bmN0aW9uIHRvZGF5KCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7IHJldHVybiBub3cgLyAxIGRheXM7IH0NCg0KCS8vIEZJRUxEUw0KDQogICAgdWludCBwdWJsaWMgbV9kYWlseUxpbWl0Ow0KICAgIHVpbnQgcHVibGljIG1fc3BlbnRUb2RheTsNCiAgICB1aW50IHB1YmxpYyBtX2xhc3REYXk7DQp9DQoNCi8vIGludGVyZmFjZSBjb250cmFjdCBmb3IgbXVsdGlzaWcgcHJveHkgY29udHJhY3RzOyBzZWUgYmVsb3cgZm9yIGRvY3MuDQpjb250cmFjdCBtdWx0aXNpZyB7DQoNCgkvLyBFVkVOVFMNCg0KICAgIC8vIGxvZ2dlZCBldmVudHM6DQogICAgLy8gRnVuZHMgaGFzIGFycml2ZWQgaW50byB0aGUgd2FsbGV0IChyZWNvcmQgaG93IG11Y2gpLg0KICAgIGV2ZW50IERlcG9zaXQoYWRkcmVzcyBfZnJvbSwgdWludCB2YWx1ZSk7DQogICAgLy8gU2luZ2xlIHRyYW5zYWN0aW9uIGdvaW5nIG91dCBvZiB0aGUgd2FsbGV0IChyZWNvcmQgd2hvIHNpZ25lZCBmb3IgaXQsIGhvdyBtdWNoLCBhbmQgdG8gd2hvbSBpdCdzIGdvaW5nKS4NCiAgICBldmVudCBTaW5nbGVUcmFuc2FjdChhZGRyZXNzIG93bmVyLCB1aW50IHZhbHVlLCBhZGRyZXNzIHRvLCBieXRlcyBkYXRhKTsNCiAgICAvLyBNdWx0aS1zaWcgdHJhbnNhY3Rpb24gZ29pbmcgb3V0IG9mIHRoZSB3YWxsZXQgKHJlY29yZCB3aG8gc2lnbmVkIGZvciBpdCBsYXN0LCB0aGUgb3BlcmF0aW9uIGhhc2gsIGhvdyBtdWNoLCBhbmQgdG8gd2hvbSBpdCdzIGdvaW5nKS4NCiAgICBldmVudCBNdWx0aVRyYW5zYWN0KGFkZHJlc3Mgb3duZXIsIGJ5dGVzMzIgb3BlcmF0aW9uLCB1aW50IHZhbHVlLCBhZGRyZXNzIHRvLCBieXRlcyBkYXRhKTsNCiAgICAvLyBDb25maXJtYXRpb24gc3RpbGwgbmVlZGVkIGZvciBhIHRyYW5zYWN0aW9uLg0KICAgIGV2ZW50IENvbmZpcm1hdGlvbk5lZWRlZChieXRlczMyIG9wZXJhdGlvbiwgYWRkcmVzcyBpbml0aWF0b3IsIHVpbnQgdmFsdWUsIGFkZHJlc3MgdG8sIGJ5dGVzIGRhdGEpOw0KICAgIA0KICAgIC8vIEZVTkNUSU9OUw0KICAgIA0KICAgIC8vIFRPRE86IGRvY3VtZW50DQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pIGV4dGVybmFsOw0KICAgIGZ1bmN0aW9uIGV4ZWN1dGUoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMik7DQogICAgZnVuY3Rpb24gY29uZmlybShieXRlczMyIF9oKSByZXR1cm5zIChib29sKTsNCn0NCg0KLy8gdXNhZ2U6DQovLyBieXRlczMyIGggPSBXYWxsZXQodykuZnJvbShvbmVPd25lcikuZXhlY3V0ZSh0bywgdmFsdWUsIGRhdGEpOw0KLy8gV2FsbGV0KHcpLmZyb20oYW5vdGhlck93bmVyKS5jb25maXJtKGgpOw0KY29udHJhY3QgV2FsbGV0IGlzIG11bHRpc2lnLCBtdWx0aW93bmVkLCBkYXlsaW1pdCB7DQoNCgkvLyBUWVBFUw0KDQogICAgLy8gVHJhbnNhY3Rpb24gc3RydWN0dXJlIHRvIHJlbWVtYmVyIGRldGFpbHMgb2YgdHJhbnNhY3Rpb24gbGVzdCBpdCBuZWVkIGJlIHNhdmVkIGZvciBhIGxhdGVyIGNhbGwuDQogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsNCiAgICAgICAgYWRkcmVzcyB0bzsNCiAgICAgICAgdWludCB2YWx1ZTsNCiAgICAgICAgYnl0ZXMgZGF0YTsNCiAgICB9DQoNCiAgICAvLyBNRVRIT0RTDQoNCiAgICAvLyBjb25zdHJ1Y3RvciAtIGp1c3QgcGFzcyBvbiB0aGUgb3duZXIgYXJyYXkgdG8gdGhlIG11bHRpb3duZWQgYW5kDQogICAgLy8gdGhlIGxpbWl0IHRvIGRheWxpbWl0DQogICAgZnVuY3Rpb24gV2FsbGV0KGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9yZXF1aXJlZCwgdWludCBfZGF5bGltaXQpDQogICAgICAgICAgICBtdWx0aW93bmVkKF9vd25lcnMsIF9yZXF1aXJlZCkgZGF5bGltaXQoX2RheWxpbWl0KSB7DQogICAgfQ0KICAgIA0KICAgIC8vIGtpbGxzIHRoZSBjb250cmFjdCBzZW5kaW5nIGV2ZXJ5dGhpbmcgdG8gYF90b2AuDQogICAgZnVuY3Rpb24ga2lsbChhZGRyZXNzIF90bykgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgc3VpY2lkZShfdG8pOw0KICAgIH0NCiAgICANCiAgICAvLyBnZXRzIGNhbGxlZCB3aGVuIG5vIG90aGVyIGZ1bmN0aW9uIG1hdGNoZXMNCiAgICBmdW5jdGlvbigpIHBheWFibGUgew0KICAgICAgICAvLyBqdXN0IGJlaW5nIHNlbnQgc29tZSBjYXNoPw0KICAgICAgICBpZiAobXNnLnZhbHVlID4gMCkNCiAgICAgICAgICAgIERlcG9zaXQobXNnLnNlbmRlciwgbXNnLnZhbHVlKTsNCiAgICB9DQogICAgDQogICAgLy8gT3V0c2lkZS12aXNpYmxlIHRyYW5zYWN0IGVudHJ5IHBvaW50LiBFeGVjdXRlcyB0cmFuc2FjdGlvbiBpbW1lZGlhdGVseSBpZiBiZWxvdyBkYWlseSBzcGVuZCBsaW1pdC4NCiAgICAvLyBJZiBub3QsIGdvZXMgaW50byBtdWx0aXNpZyBwcm9jZXNzLiBXZSBwcm92aWRlIGEgaGFzaCBvbiByZXR1cm4gdG8gYWxsb3cgdGhlIHNlbmRlciB0byBwcm92aWRlDQogICAgLy8gc2hvcnRjdXRzIGZvciB0aGUgb3RoZXIgY29uZmlybWF0aW9ucyAoYWxsb3dpbmcgdGhlbSB0byBhdm9pZCByZXBsaWNhdGluZyB0aGUgX3RvLCBfdmFsdWUNCiAgICAvLyBhbmQgX2RhdGEgYXJndW1lbnRzKS4gVGhleSBzdGlsbCBnZXQgdGhlIG9wdGlvbiBvZiB1c2luZyB0aGVtIGlmIHRoZXkgd2FudCwgYW55d2F5cy4NCiAgICBmdW5jdGlvbiBleGVjdXRlKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGV4dGVybmFsIG9ubHlvd25lciByZXR1cm5zIChieXRlczMyIF9yKSB7DQogICAgICAgIC8vIGZpcnN0LCB0YWtlIHRoZSBvcHBvcnR1bml0eSB0byBjaGVjayB0aGF0IHdlJ3JlIHVuZGVyIHRoZSBkYWlseSBsaW1pdC4NCiAgICAgICAgaWYgKHVuZGVyTGltaXQoX3ZhbHVlKSkgew0KICAgICAgICAgICAgU2luZ2xlVHJhbnNhY3QobXNnLnNlbmRlciwgX3ZhbHVlLCBfdG8sIF9kYXRhKTsNCiAgICAgICAgICAgIC8vIHllcyAtIGp1c3QgZXhlY3V0ZSB0aGUgY2FsbC4NCiAgICAgICAgICAgIGJvb2wgcmMgPSBfdG8uY2FsbC52YWx1ZShfdmFsdWUpKF9kYXRhKTsNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQogICAgICAgIC8vIGRldGVybWluZSBvdXIgb3BlcmF0aW9uIGhhc2guDQogICAgICAgIF9yID0gc2hhMyhtc2cuZGF0YSwgYmxvY2subnVtYmVyKTsNCiAgICAgICAgaWYgKCFjb25maXJtKF9yKSAmJiBtX3R4c1tfcl0udG8gPT0gMCkgew0KICAgICAgICAgICAgbV90eHNbX3JdLnRvID0gX3RvOw0KICAgICAgICAgICAgbV90eHNbX3JdLnZhbHVlID0gX3ZhbHVlOw0KICAgICAgICAgICAgbV90eHNbX3JdLmRhdGEgPSBfZGF0YTsNCiAgICAgICAgICAgIENvbmZpcm1hdGlvbk5lZWRlZChfciwgbXNnLnNlbmRlciwgX3ZhbHVlLCBfdG8sIF9kYXRhKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBjb25maXJtIGEgdHJhbnNhY3Rpb24gdGhyb3VnaCBqdXN0IHRoZSBoYXNoLiB3ZSB1c2UgdGhlIHByZXZpb3VzIHRyYW5zYWN0aW9ucyBtYXAsIG1fdHhzLCBpbiBvcmRlcg0KICAgIC8vIHRvIGRldGVybWluZSB0aGUgYm9keSBvZiB0aGUgdHJhbnNhY3Rpb24gZnJvbSB0aGUgaGFzaCBwcm92aWRlZC4NCiAgICBmdW5jdGlvbiBjb25maXJtKGJ5dGVzMzIgX2gpIG9ubHltYW55b3duZXJzKF9oKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIGlmIChtX3R4c1tfaF0udG8gIT0gMCkgew0KICAgICAgICAgICAgYm9vbCByYyA9IG1fdHhzW19oXS50by5jYWxsLnZhbHVlKG1fdHhzW19oXS52YWx1ZSkobV90eHNbX2hdLmRhdGEpOw0KICAgICAgICAgICAgTXVsdGlUcmFuc2FjdChtc2cuc2VuZGVyLCBfaCwgbV90eHNbX2hdLnZhbHVlLCBtX3R4c1tfaF0udG8sIG1fdHhzW19oXS5kYXRhKTsNCiAgICAgICAgICAgIGRlbGV0ZSBtX3R4c1tfaF07DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTDQogICAgDQogICAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgaW50ZXJuYWwgew0KICAgICAgICB1aW50IGxlbmd0aCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aDsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpDQogICAgICAgICAgICBkZWxldGUgbV90eHNbbV9wZW5kaW5nSW5kZXhbaV1dOw0KICAgICAgICBzdXBlci5jbGVhclBlbmRpbmcoKTsNCiAgICB9DQoNCgkvLyBGSUVMRFMNCg0KICAgIC8vIHBlbmRpbmcgdHJhbnNhY3Rpb25zIHdlIGhhdmUgYXQgcHJlc2VudC4NCiAgICBtYXBwaW5nIChieXRlczMyID0+IFRyYW5zYWN0aW9uKSBwdWJsaWMgbV90eHM7DQp9'