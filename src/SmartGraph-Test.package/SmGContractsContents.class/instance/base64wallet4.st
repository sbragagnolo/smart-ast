base 64 content
base64wallet4
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMDsNCg0KY29udHJhY3QgbXVsdGlvd25lZCB7DQoNCgkvLyBUWVBFUw0KDQogICAgLy8gc3RydWN0IGZvciB0aGUgc3RhdHVzIG9mIGEgcGVuZGluZyBvcGVyYXRpb24uDQogICAgc3RydWN0IFBlbmRpbmdTdGF0ZSB7DQogICAgICAgIHVpbnQgeWV0TmVlZGVkOw0KICAgICAgICB1aW50IG93bmVyc0RvbmU7DQogICAgICAgIHVpbnQgaW5kZXg7DQogICAgfQ0KDQoJLy8gRVZFTlRTDQoNCiAgICAvLyB0aGlzIGNvbnRyYWN0IG9ubHkgaGFzIHNpeCB0eXBlcyBvZiBldmVudHM6IGl0IGNhbiBhY2NlcHQgYSBjb25maXJtYXRpb24sIGluIHdoaWNoIGNhc2UNCiAgICAvLyB3ZSByZWNvcmQgb3duZXIgYW5kIG9wZXJhdGlvbiAoaGFzaCkgYWxvbmdzaWRlIGl0Lg0KICAgIGV2ZW50IENvbmZpcm1hdGlvbihhZGRyZXNzIG93bmVyLCBieXRlczMyIG9wZXJhdGlvbik7DQogICAgZXZlbnQgUmV2b2tlKGFkZHJlc3Mgb3duZXIsIGJ5dGVzMzIgb3BlcmF0aW9uKTsNCiAgICAvLyBzb21lIG90aGVycyBhcmUgaW4gdGhlIGNhc2Ugb2YgYW4gb3duZXIgY2hhbmdpbmcuDQogICAgZXZlbnQgT3duZXJDaGFuZ2VkKGFkZHJlc3Mgb2xkT3duZXIsIGFkZHJlc3MgbmV3T3duZXIpOw0KICAgIGV2ZW50IE93bmVyQWRkZWQoYWRkcmVzcyBuZXdPd25lcik7DQogICAgZXZlbnQgT3duZXJSZW1vdmVkKGFkZHJlc3Mgb2xkT3duZXIpOw0KICAgIC8vIHRoZSBsYXN0IG9uZSBpcyBlbWl0dGVkIGlmIHRoZSByZXF1aXJlZCBzaWduYXR1cmVzIGNoYW5nZQ0KICAgIGV2ZW50IFJlcXVpcmVtZW50Q2hhbmdlZCh1aW50IG5ld1JlcXVpcmVtZW50KTsNCg0KCS8vIE1PRElGSUVSUw0KDQogICAgLy8gc2ltcGxlIHNpbmdsZS1zaWcgZnVuY3Rpb24gbW9kaWZpZXIuDQogICAgbW9kaWZpZXIgb25seW93bmVyIHsNCiAgICAgICAgcmVxdWlyZShpc093bmVyKG1zZy5zZW5kZXIpKTsNCiAgICAgICAgXzsNCiAgICB9DQogICAgLy8gbXVsdGktc2lnIGZ1bmN0aW9uIG1vZGlmaWVyOiB0aGUgb3BlcmF0aW9uIG11c3QgaGF2ZSBhbiBpbnRyaW5zaWMgaGFzaCBpbiBvcmRlcg0KICAgIC8vIHRoYXQgbGF0ZXIgYXR0ZW1wdHMgY2FuIGJlIHJlYWxpc2VkIGFzIHRoZSBzYW1lIHVuZGVybHlpbmcgb3BlcmF0aW9uIGFuZA0KICAgIC8vIHRodXMgY291bnQgYXMgY29uZmlybWF0aW9ucy4NCiAgICBtb2RpZmllciBvbmx5bWFueW93bmVycyhieXRlczMyIF9vcGVyYXRpb24pIHsNCiAgICAgICAgcmVxdWlyZShjb25maXJtQW5kQ2hlY2soX29wZXJhdGlvbikpOw0KICAgICAgICBfOw0KICAgIH0NCg0KCS8vIE1FVEhPRFMNCg0KICAgIC8vIGNvbnN0cnVjdG9yIGlzIGdpdmVuIG51bWJlciBvZiBzaWdzIHJlcXVpcmVkIHRvIGRvIHByb3RlY3RlZCAib25seW1hbnlvd25lcnMiIHRyYW5zYWN0aW9ucw0KICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0uDQogICAgZnVuY3Rpb24gbXVsdGlvd25lZChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIHsNCiAgICAgICAgbV9udW1Pd25lcnMgPSBfb3duZXJzLmxlbmd0aCArIDE7DQogICAgICAgIG1fb3duZXJzWzFdID0gdWludChtc2cuc2VuZGVyKTsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildID0gMTsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX293bmVycy5sZW5ndGg7ICsraSkNCiAgICAgICAgew0KICAgICAgICAgICAgbV9vd25lcnNbMiArIGldID0gdWludChfb3duZXJzW2ldKTsNCiAgICAgICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcnNbaV0pXSA9IDIgKyBpOw0KICAgICAgICB9DQogICAgICAgIG1fcmVxdWlyZWQgPSBfcmVxdWlyZWQ7DQogICAgfQ0KICAgIA0KICAgIC8vIFJldm9rZXMgYSBwcmlvciBjb25maXJtYXRpb24gb2YgdGhlIGdpdmVuIG9wZXJhdGlvbg0KICAgIGZ1bmN0aW9uIHJldm9rZShieXRlczMyIF9vcGVyYXRpb24pIGV4dGVybmFsIHsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildOw0KICAgICAgICAvLyBtYWtlIHN1cmUgdGhleSdyZSBhbiBvd25lcg0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQogICAgICAgIHVpbnQgb3duZXJJbmRleEJpdCA9IDIqKm93bmVySW5kZXg7DQogICAgICAgIHZhciBwZW5kaW5nID0gbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICBpZiAocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA+IDApIHsNCiAgICAgICAgICAgIHBlbmRpbmcueWV0TmVlZGVkKys7DQogICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgLT0gb3duZXJJbmRleEJpdDsNCiAgICAgICAgICAgIFJldm9rZShtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBSZXBsYWNlcyBhbiBvd25lciBgX2Zyb21gIHdpdGggYW5vdGhlciBgX3RvYC4NCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9mcm9tLCBhZGRyZXNzIF90bykgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKGlzT3duZXIoX3RvKSkgcmV0dXJuOw0KICAgICAgICB1aW50IG93bmVySW5kZXggPSBtX293bmVySW5kZXhbdWludChfZnJvbSldOw0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQoNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIG1fb3duZXJzW293bmVySW5kZXhdID0gdWludChfdG8pOw0KICAgICAgICBtX293bmVySW5kZXhbdWludChfZnJvbSldID0gMDsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQoX3RvKV0gPSBvd25lckluZGV4Ow0KICAgICAgICBPd25lckNoYW5nZWQoX2Zyb20sIF90byk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3MgX293bmVyKSBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoaXNPd25lcihfb3duZXIpKSByZXR1cm47DQoNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIGlmIChtX251bU93bmVycyA+PSBjX21heE93bmVycykNCiAgICAgICAgICAgIHJlb3JnYW5pemVPd25lcnMoKTsNCiAgICAgICAgaWYgKG1fbnVtT3duZXJzID49IGNfbWF4T3duZXJzKQ0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICBtX251bU93bmVycysrOw0KICAgICAgICBtX293bmVyc1ttX251bU93bmVyc10gPSB1aW50KF9vd25lcik7DQogICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcildID0gbV9udW1Pd25lcnM7DQogICAgICAgIE93bmVyQWRkZWQoX293bmVyKTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcmVtb3ZlT3duZXIoYWRkcmVzcyBfb3duZXIpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IG1fb3duZXJJbmRleFt1aW50KF9vd25lcildOw0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQogICAgICAgIGlmIChtX3JlcXVpcmVkID4gbV9udW1Pd25lcnMgLSAxKSByZXR1cm47DQoNCiAgICAgICAgbV9vd25lcnNbb3duZXJJbmRleF0gPSAwOw0KICAgICAgICBtX293bmVySW5kZXhbdWludChfb3duZXIpXSA9IDA7DQogICAgICAgIGNsZWFyUGVuZGluZygpOw0KICAgICAgICByZW9yZ2FuaXplT3duZXJzKCk7IC8vbWFrZSBzdXJlIG1fbnVtT3duZXIgaXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvd25lcnMgYW5kIGFsd2F5cyBwb2ludHMgdG8gdGhlIG9wdGltYWwgZnJlZSBzbG90DQogICAgICAgIE93bmVyUmVtb3ZlZChfb3duZXIpOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBjaGFuZ2VSZXF1aXJlbWVudCh1aW50IF9uZXdSZXF1aXJlZCkgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgaWYgKF9uZXdSZXF1aXJlZCA+IG1fbnVtT3duZXJzKSByZXR1cm47DQogICAgICAgIG1fcmVxdWlyZWQgPSBfbmV3UmVxdWlyZWQ7DQogICAgICAgIGNsZWFyUGVuZGluZygpOw0KICAgICAgICBSZXF1aXJlbWVudENoYW5nZWQoX25ld1JlcXVpcmVkKTsNCiAgICB9DQoNCiAgICAvLyBHZXRzIGFuIG93bmVyIGJ5IDAtaW5kZXhlZCBwb3NpdGlvbiAodXNpbmcgbnVtT3duZXJzIGFzIHRoZSBjb3VudCkNCiAgICBmdW5jdGlvbiBnZXRPd25lcih1aW50IG93bmVySW5kZXgpIGV4dGVybmFsIGNvbnN0YW50IHJldHVybnMgKGFkZHJlc3MpIHsNCiAgICAgICAgcmV0dXJuIGFkZHJlc3MobV9vd25lcnNbb3duZXJJbmRleCArIDFdKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpc093bmVyKGFkZHJlc3MgX2FkZHIpIHJldHVybnMgKGJvb2wpIHsNCiAgICAgICAgcmV0dXJuIG1fb3duZXJJbmRleFt1aW50KF9hZGRyKV0gPiAwOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBoYXNDb25maXJtZWQoYnl0ZXMzMiBfb3BlcmF0aW9uLCBhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICB2YXIgcGVuZGluZyA9IG1fcGVuZGluZ1tfb3BlcmF0aW9uXTsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQoX293bmVyKV07DQoNCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4NCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgcmV0dXJuICEocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA9PSAwKTsNCiAgICB9DQogICAgDQogICAgLy8gSU5URVJOQUwgTUVUSE9EUw0KDQogICAgZnVuY3Rpb24gY29uZmlybUFuZENoZWNrKGJ5dGVzMzIgX29wZXJhdGlvbikgaW50ZXJuYWwgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICAvLyBkZXRlcm1pbmUgd2hhdCBpbmRleCB0aGUgcHJlc2VudCBzZW5kZXIgaXM6DQogICAgICAgIHVpbnQgb3duZXJJbmRleCA9IG1fb3duZXJJbmRleFt1aW50KG1zZy5zZW5kZXIpXTsNCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuOw0KDQogICAgICAgIHZhciBwZW5kaW5nID0gbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICAvLyBpZiB3ZSdyZSBub3QgeWV0IHdvcmtpbmcgb24gdGhpcyBvcGVyYXRpb24sIHN3aXRjaCBvdmVyIGFuZCByZXNldCB0aGUgY29uZmlybWF0aW9uIHN0YXR1cy4NCiAgICAgICAgaWYgKHBlbmRpbmcueWV0TmVlZGVkID09IDApIHsNCiAgICAgICAgICAgIC8vIHJlc2V0IGNvdW50IG9mIGNvbmZpcm1hdGlvbnMgbmVlZGVkLg0KICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQgPSBtX3JlcXVpcmVkOw0KICAgICAgICAgICAgLy8gcmVzZXQgd2hpY2ggb3duZXJzIGhhdmUgY29uZmlybWVkIChub25lKSAtIHNldCBvdXIgYml0bWFwIHRvIDAuDQogICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgPSAwOw0KICAgICAgICAgICAgcGVuZGluZy5pbmRleCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aCsrOw0KICAgICAgICAgICAgbV9wZW5kaW5nSW5kZXhbcGVuZGluZy5pbmRleF0gPSBfb3BlcmF0aW9uOw0KICAgICAgICB9DQogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4NCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgLy8gbWFrZSBzdXJlIHdlICh0aGUgbWVzc2FnZSBzZW5kZXIpIGhhdmVuJ3QgY29uZmlybWVkIHRoaXMgb3BlcmF0aW9uIHByZXZpb3VzbHkuDQogICAgICAgIGlmIChwZW5kaW5nLm93bmVyc0RvbmUgJiBvd25lckluZGV4Qml0ID09IDApIHsNCiAgICAgICAgICAgIENvbmZpcm1hdGlvbihtc2cuc2VuZGVyLCBfb3BlcmF0aW9uKTsNCiAgICAgICAgICAgIC8vIG9rIC0gY2hlY2sgaWYgY291bnQgaXMgZW5vdWdoIHRvIGdvIGFoZWFkLg0KICAgICAgICAgICAgaWYgKHBlbmRpbmcueWV0TmVlZGVkIDw9IDEpIHsNCiAgICAgICAgICAgICAgICAvLyBlbm91Z2ggY29uZmlybWF0aW9uczogcmVzZXQgYW5kIHJ1biBpbnRlcmlvci4NCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nSW5kZXhbbV9wZW5kaW5nW19vcGVyYXRpb25dLmluZGV4XTsNCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nW19vcGVyYXRpb25dOw0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIG5vdCBlbm91Z2g6IHJlY29yZCB0aGF0IHRoaXMgb3duZXIgaW4gcGFydGljdWxhciBjb25maXJtZWQuDQogICAgICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQtLTsNCiAgICAgICAgICAgICAgICBwZW5kaW5nLm93bmVyc0RvbmUgfD0gb3duZXJJbmRleEJpdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlb3JnYW5pemVPd25lcnMoKSBwcml2YXRlIHsNCiAgICAgICAgdWludCBmcmVlID0gMTsNCiAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycykNCiAgICAgICAgew0KICAgICAgICAgICAgd2hpbGUgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1tmcmVlXSAhPSAwKSBmcmVlKys7DQogICAgICAgICAgICB3aGlsZSAobV9udW1Pd25lcnMgPiAxICYmIG1fb3duZXJzW21fbnVtT3duZXJzXSA9PSAwKSBtX251bU93bmVycy0tOw0KICAgICAgICAgICAgaWYgKGZyZWUgPCBtX251bU93bmVycyAmJiBtX293bmVyc1ttX251bU93bmVyc10gIT0gMCAmJiBtX293bmVyc1tmcmVlXSA9PSAwKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIG1fb3duZXJzW2ZyZWVdID0gbV9vd25lcnNbbV9udW1Pd25lcnNdOw0KICAgICAgICAgICAgICAgIG1fb3duZXJJbmRleFttX293bmVyc1tmcmVlXV0gPSBmcmVlOw0KICAgICAgICAgICAgICAgIG1fb3duZXJzW21fbnVtT3duZXJzXSA9IDA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgaW50ZXJuYWwgew0KICAgICAgICB1aW50IGxlbmd0aCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aDsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpDQogICAgICAgICAgICBpZiAobV9wZW5kaW5nSW5kZXhbaV0gIT0gMCkNCiAgICAgICAgICAgICAgICBkZWxldGUgbV9wZW5kaW5nW21fcGVuZGluZ0luZGV4W2ldXTsNCiAgICAgICAgZGVsZXRlIG1fcGVuZGluZ0luZGV4Ow0KICAgIH0NCiAgICAgICAgDQogICAJLy8gRklFTERTDQoNCiAgICAvLyB0aGUgbnVtYmVyIG9mIG93bmVycyB0aGF0IG11c3QgY29uZmlybSB0aGUgc2FtZSBvcGVyYXRpb24gYmVmb3JlIGl0IGlzIHJ1bi4NCiAgICB1aW50IHB1YmxpYyBtX3JlcXVpcmVkOw0KICAgIC8vIHBvaW50ZXIgdXNlZCB0byBmaW5kIGEgZnJlZSBzbG90IGluIG1fb3duZXJzDQogICAgdWludCBwdWJsaWMgbV9udW1Pd25lcnM7DQogICAgDQogICAgLy8gbGlzdCBvZiBvd25lcnMNCiAgICB1aW50WzI1Nl0gbV9vd25lcnM7DQogICAgdWludCBjb25zdGFudCBjX21heE93bmVycyA9IDI1MDsNCiAgICAvLyBpbmRleCBvbiB0aGUgbGlzdCBvZiBvd25lcnMgdG8gYWxsb3cgcmV2ZXJzZSBsb29rdXANCiAgICBtYXBwaW5nKHVpbnQgPT4gdWludCkgbV9vd25lckluZGV4Ow0KICAgIC8vIHRoZSBvbmdvaW5nIG9wZXJhdGlvbnMuDQogICAgbWFwcGluZyhieXRlczMyID0+IFBlbmRpbmdTdGF0ZSkgbV9wZW5kaW5nOw0KICAgIGJ5dGVzMzJbXSBtX3BlbmRpbmdJbmRleDsNCn0NCg0KLy8gaW5oZXJpdGFibGUgInByb3BlcnR5IiBjb250cmFjdCB0aGF0IGVuYWJsZXMgbWV0aG9kcyB0byBiZSBwcm90ZWN0ZWQgYnkgcGxhY2luZyBhIGxpbmVhciBsaW1pdCAoc3BlY2lmaWFibGUpDQovLyBvbiBhIHBhcnRpY3VsYXIgcmVzb3VyY2UgcGVyIGNhbGVuZGFyIGRheS4gaXMgbXVsdGlvd25lZCB0byBhbGxvdyB0aGUgbGltaXQgdG8gYmUgYWx0ZXJlZC4gcmVzb3VyY2UgdGhhdCBtZXRob2QNCi8vIHVzZXMgaXMgc3BlY2lmaWVkIGluIHRoZSBtb2RpZmllci4NCmNvbnRyYWN0IGRheWxpbWl0IGlzIG11bHRpb3duZWQgew0KDQoJLy8gTU9ESUZJRVJTDQoNCiAgICAvLyBzaW1wbGUgbW9kaWZpZXIgZm9yIGRhaWx5IGxpbWl0Lg0KICAgIG1vZGlmaWVyIGxpbWl0ZWREYWlseSh1aW50IF92YWx1ZSkgew0KICAgICAgICByZXF1aXJlKHVuZGVyTGltaXQoX3ZhbHVlKSk7DQogICAgICAgIF87DQogICAgfQ0KDQoJLy8gTUVUSE9EUw0KDQogICAgLy8gY29uc3RydWN0b3IgLSBzdG9yZXMgaW5pdGlhbCBkYWlseSBsaW1pdCBhbmQgcmVjb3JkcyB0aGUgcHJlc2VudCBkYXkncyBpbmRleC4NCiAgICBmdW5jdGlvbiBkYXlsaW1pdCh1aW50IF9saW1pdCkgew0KICAgICAgICBtX2RhaWx5TGltaXQgPSBfbGltaXQ7DQogICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgfQ0KICAgIC8vIChyZSlzZXRzIHRoZSBkYWlseSBsaW1pdC4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uIGRvZXNuJ3QgYWx0ZXIgdGhlIGFtb3VudCBhbHJlYWR5IHNwZW50IHRvZGF5Lg0KICAgIGZ1bmN0aW9uIHNldERhaWx5TGltaXQodWludCBfbmV3TGltaXQpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIG1fZGFpbHlMaW1pdCA9IF9uZXdMaW1pdDsNCiAgICB9DQogICAgLy8gcmVzZXRzIHRoZSBhbW91bnQgYWxyZWFkeSBzcGVudCB0b2RheS4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uIA0KICAgIGZ1bmN0aW9uIHJlc2V0U3BlbnRUb2RheSgpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIG1fc3BlbnRUb2RheSA9IDA7DQogICAgfQ0KICAgIA0KICAgIC8vIElOVEVSTkFMIE1FVEhPRFMNCiAgICANCiAgICAvLyBjaGVja3MgdG8gc2VlIGlmIHRoZXJlIGlzIGF0IGxlYXN0IGBfdmFsdWVgIGxlZnQgZnJvbSB0aGUgZGFpbHkgbGltaXQgdG9kYXkuIGlmIHRoZXJlIGlzLCBzdWJ0cmFjdHMgaXQgYW5kDQogICAgLy8gcmV0dXJucyB0cnVlLiBvdGhlcndpc2UganVzdCByZXR1cm5zIGZhbHNlLg0KICAgIGZ1bmN0aW9uIHVuZGVyTGltaXQodWludCBfdmFsdWUpIGludGVybmFsIG9ubHlvd25lciByZXR1cm5zIChib29sKSB7DQogICAgICAgIC8vIHJlc2V0IHRoZSBzcGVuZCBsaW1pdCBpZiB3ZSdyZSBvbiBhIGRpZmZlcmVudCBkYXkgdG8gbGFzdCB0aW1lLg0KICAgICAgICBpZiAodG9kYXkoKSA+IG1fbGFzdERheSkgew0KICAgICAgICAgICAgbV9zcGVudFRvZGF5ID0gMDsNCiAgICAgICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgICAgIH0NCiAgICAgICAgLy8gY2hlY2sgdG8gc2VlIGlmIHRoZXJlJ3MgZW5vdWdoIGxlZnQgLSBpZiBzbywgc3VidHJhY3QgYW5kIHJldHVybiB0cnVlLg0KICAgICAgICAvLyBvdmVyZmxvdyBwcm90ZWN0aW9uICAgICAgICAgICAgICAgICAgICAvLyBkYWlseUxpbWl0IGNoZWNrICANCiAgICAgICAgaWYgKG1fc3BlbnRUb2RheSArIF92YWx1ZSA+PSBtX3NwZW50VG9kYXkgJiYgbV9zcGVudFRvZGF5ICsgX3ZhbHVlIDw9IG1fZGFpbHlMaW1pdCkgew0KICAgICAgICAgICAgbV9zcGVudFRvZGF5ICs9IF92YWx1ZTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgLy8gZGV0ZXJtaW5lcyB0b2RheSdzIGluZGV4Lg0KICAgIGZ1bmN0aW9uIHRvZGF5KCkgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zICh1aW50KSB7IHJldHVybiBub3cgLyAxIGRheXM7IH0NCg0KCS8vIEZJRUxEUw0KDQogICAgdWludCBwdWJsaWMgbV9kYWlseUxpbWl0Ow0KICAgIHVpbnQgcHVibGljIG1fc3BlbnRUb2RheTsNCiAgICB1aW50IHB1YmxpYyBtX2xhc3REYXk7DQp9DQoNCi8vIGludGVyZmFjZSBjb250cmFjdCBmb3IgbXVsdGlzaWcgcHJveHkgY29udHJhY3RzOyBzZWUgYmVsb3cgZm9yIGRvY3MuDQpjb250cmFjdCBtdWx0aXNpZyB7DQoNCgkvLyBFVkVOVFMNCg0KICAgIC8vIGxvZ2dlZCBldmVudHM6DQogICAgLy8gRnVuZHMgaGFzIGFycml2ZWQgaW50byB0aGUgd2FsbGV0IChyZWNvcmQgaG93IG11Y2gpLg0KICAgIGV2ZW50IERlcG9zaXQoYWRkcmVzcyBfZnJvbSwgdWludCB2YWx1ZSk7DQogICAgLy8gU2luZ2xlIHRyYW5zYWN0aW9uIGdvaW5nIG91dCBvZiB0aGUgd2FsbGV0IChyZWNvcmQgd2hvIHNpZ25lZCBmb3IgaXQsIGhvdyBtdWNoLCBhbmQgdG8gd2hvbSBpdCdzIGdvaW5nKS4NCiAgICBldmVudCBTaW5nbGVUcmFuc2FjdChhZGRyZXNzIG93bmVyLCB1aW50IHZhbHVlLCBhZGRyZXNzIHRvLCBieXRlcyBkYXRhKTsNCiAgICAvLyBNdWx0aS1zaWcgdHJhbnNhY3Rpb24gZ29pbmcgb3V0IG9mIHRoZSB3YWxsZXQgKHJlY29yZCB3aG8gc2lnbmVkIGZvciBpdCBsYXN0LCB0aGUgb3BlcmF0aW9uIGhhc2gsIGhvdyBtdWNoLCBhbmQgdG8gd2hvbSBpdCdzIGdvaW5nKS4NCiAgICBldmVudCBNdWx0aVRyYW5zYWN0KGFkZHJlc3Mgb3duZXIsIGJ5dGVzMzIgb3BlcmF0aW9uLCB1aW50IHZhbHVlLCBhZGRyZXNzIHRvLCBieXRlcyBkYXRhKTsNCiAgICAvLyBDb25maXJtYXRpb24gc3RpbGwgbmVlZGVkIGZvciBhIHRyYW5zYWN0aW9uLg0KICAgIGV2ZW50IENvbmZpcm1hdGlvbk5lZWRlZChieXRlczMyIG9wZXJhdGlvbiwgYWRkcmVzcyBpbml0aWF0b3IsIHVpbnQgdmFsdWUsIGFkZHJlc3MgdG8sIGJ5dGVzIGRhdGEpOw0KICAgIA0KICAgIC8vIEZVTkNUSU9OUw0KICAgIA0KICAgIC8vIFRPRE86IGRvY3VtZW50DQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pIGV4dGVybmFsOw0KICAgIGZ1bmN0aW9uIGV4ZWN1dGUoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMik7DQogICAgZnVuY3Rpb24gY29uZmlybShieXRlczMyIF9oKSByZXR1cm5zIChib29sKTsNCn0NCg0KLy8gdXNhZ2U6DQovLyBieXRlczMyIGggPSBXYWxsZXQodykuZnJvbShvbmVPd25lcikuZXhlY3V0ZSh0bywgdmFsdWUsIGRhdGEpOw0KLy8gV2FsbGV0KHcpLmZyb20oYW5vdGhlck93bmVyKS5jb25maXJtKGgpOw0KY29udHJhY3QgV2FsbGV0IGlzIG11bHRpc2lnLCBtdWx0aW93bmVkLCBkYXlsaW1pdCB7DQoNCgkvLyBUWVBFUw0KDQogICAgLy8gVHJhbnNhY3Rpb24gc3RydWN0dXJlIHRvIHJlbWVtYmVyIGRldGFpbHMgb2YgdHJhbnNhY3Rpb24gbGVzdCBpdCBuZWVkIGJlIHNhdmVkIGZvciBhIGxhdGVyIGNhbGwuDQogICAgc3RydWN0IFRyYW5zYWN0aW9uIHsNCiAgICAgICAgYWRkcmVzcyB0bzsNCiAgICAgICAgdWludCB2YWx1ZTsNCiAgICAgICAgYnl0ZXMgZGF0YTsNCiAgICB9DQoNCiAgICAvLyBNRVRIT0RTDQoNCiAgICAvLyBjb25zdHJ1Y3RvciAtIGp1c3QgcGFzcyBvbiB0aGUgb3duZXIgYXJyYXkgdG8gdGhlIG11bHRpb3duZWQgYW5kDQogICAgLy8gdGhlIGxpbWl0IHRvIGRheWxpbWl0DQogICAgZnVuY3Rpb24gV2FsbGV0KGFkZHJlc3NbXSBfb3duZXJzLCB1aW50IF9yZXF1aXJlZCwgdWludCBfZGF5bGltaXQpDQogICAgICAgICAgICBtdWx0aW93bmVkKF9vd25lcnMsIF9yZXF1aXJlZCkgZGF5bGltaXQoX2RheWxpbWl0KSB7DQogICAgfQ0KICAgIA0KICAgIC8vIGtpbGxzIHRoZSBjb250cmFjdCBzZW5kaW5nIGV2ZXJ5dGhpbmcgdG8gYF90b2AuDQogICAgZnVuY3Rpb24ga2lsbChhZGRyZXNzIF90bykgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgc2VsZmRlc3RydWN0KF90byk7DQogICAgfQ0KICAgIA0KICAgIC8vIGdldHMgY2FsbGVkIHdoZW4gbm8gb3RoZXIgZnVuY3Rpb24gbWF0Y2hlcw0KICAgIGZ1bmN0aW9uKCkgcGF5YWJsZSB7DQogICAgICAgIC8vIGp1c3QgYmVpbmcgc2VudCBzb21lIGNhc2g/DQogICAgICAgIGlmIChtc2cudmFsdWUgPiAwKQ0KICAgICAgICAgICAgRGVwb3NpdChtc2cuc2VuZGVyLCBtc2cudmFsdWUpOw0KICAgIH0NCiAgICANCiAgICAvLyBPdXRzaWRlLXZpc2libGUgdHJhbnNhY3QgZW50cnkgcG9pbnQuIEV4ZWN1dGVzIHRyYW5zYWN0aW9uIGltbWVkaWF0ZWx5IGlmIGJlbG93IGRhaWx5IHNwZW5kIGxpbWl0Lg0KICAgIC8vIElmIG5vdCwgZ29lcyBpbnRvIG11bHRpc2lnIHByb2Nlc3MuIFdlIHByb3ZpZGUgYSBoYXNoIG9uIHJldHVybiB0byBhbGxvdyB0aGUgc2VuZGVyIHRvIHByb3ZpZGUNCiAgICAvLyBzaG9ydGN1dHMgZm9yIHRoZSBvdGhlciBjb25maXJtYXRpb25zIChhbGxvd2luZyB0aGVtIHRvIGF2b2lkIHJlcGxpY2F0aW5nIHRoZSBfdG8sIF92YWx1ZQ0KICAgIC8vIGFuZCBfZGF0YSBhcmd1bWVudHMpLiBUaGV5IHN0aWxsIGdldCB0aGUgb3B0aW9uIG9mIHVzaW5nIHRoZW0gaWYgdGhleSB3YW50LCBhbnl3YXlzLg0KICAgIGZ1bmN0aW9uIGV4ZWN1dGUoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgb25seW93bmVyIHJldHVybnMgKGJ5dGVzMzIgX3IpIHsNCiAgICAgICAgLy8gZmlyc3QsIHRha2UgdGhlIG9wcG9ydHVuaXR5IHRvIGNoZWNrIHRoYXQgd2UncmUgdW5kZXIgdGhlIGRhaWx5IGxpbWl0Lg0KICAgICAgICBpZiAodW5kZXJMaW1pdChfdmFsdWUpKSB7DQogICAgICAgICAgICBTaW5nbGVUcmFuc2FjdChtc2cuc2VuZGVyLCBfdmFsdWUsIF90bywgX2RhdGEpOw0KICAgICAgICAgICAgLy8geWVzIC0ganVzdCBleGVjdXRlIHRoZSBjYWxsLg0KICAgICAgICAgICAgcmVxdWlyZShfdG8uY2FsbC52YWx1ZShfdmFsdWUpKF9kYXRhKSk7DQogICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgfQ0KICAgICAgICAvLyBkZXRlcm1pbmUgb3VyIG9wZXJhdGlvbiBoYXNoLg0KICAgICAgICBfciA9IHNoYTMobXNnLmRhdGEsIGJsb2NrLm51bWJlcik7DQogICAgICAgIGlmICghY29uZmlybShfcikgJiYgbV90eHNbX3JdLnRvID09IDApIHsNCiAgICAgICAgICAgIG1fdHhzW19yXS50byA9IF90bzsNCiAgICAgICAgICAgIG1fdHhzW19yXS52YWx1ZSA9IF92YWx1ZTsNCiAgICAgICAgICAgIG1fdHhzW19yXS5kYXRhID0gX2RhdGE7DQogICAgICAgICAgICBDb25maXJtYXRpb25OZWVkZWQoX3IsIG1zZy5zZW5kZXIsIF92YWx1ZSwgX3RvLCBfZGF0YSk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gY29uZmlybSBhIHRyYW5zYWN0aW9uIHRocm91Z2gganVzdCB0aGUgaGFzaC4gd2UgdXNlIHRoZSBwcmV2aW91cyB0cmFuc2FjdGlvbnMgbWFwLCBtX3R4cywgaW4gb3JkZXINCiAgICAvLyB0byBkZXRlcm1pbmUgdGhlIGJvZHkgb2YgdGhlIHRyYW5zYWN0aW9uIGZyb20gdGhlIGhhc2ggcHJvdmlkZWQuDQogICAgZnVuY3Rpb24gY29uZmlybShieXRlczMyIF9oKSBvbmx5bWFueW93bmVycyhfaCkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBpZiAobV90eHNbX2hdLnRvICE9IDApIHsNCiAgICAgICAgICAgIHJlcXVpcmUobV90eHNbX2hdLnRvLmNhbGwudmFsdWUobV90eHNbX2hdLnZhbHVlKShtX3R4c1tfaF0uZGF0YSkpOw0KICAgICAgICAgICAgTXVsdGlUcmFuc2FjdChtc2cuc2VuZGVyLCBfaCwgbV90eHNbX2hdLnZhbHVlLCBtX3R4c1tfaF0udG8sIG1fdHhzW19oXS5kYXRhKTsNCiAgICAgICAgICAgIGRlbGV0ZSBtX3R4c1tfaF07DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTDQogICAgDQogICAgZnVuY3Rpb24gY2xlYXJQZW5kaW5nKCkgaW50ZXJuYWwgew0KICAgICAgICB1aW50IGxlbmd0aCA9IG1fcGVuZGluZ0luZGV4Lmxlbmd0aDsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpDQogICAgICAgICAgICBkZWxldGUgbV90eHNbbV9wZW5kaW5nSW5kZXhbaV1dOw0KICAgICAgICBzdXBlci5jbGVhclBlbmRpbmcoKTsNCiAgICB9DQoNCgkvLyBGSUVMRFMNCg0KICAgIC8vIHBlbmRpbmcgdHJhbnNhY3Rpb25zIHdlIGhhdmUgYXQgcHJlc2VudC4NCiAgICBtYXBwaW5nIChieXRlczMyID0+IFRyYW5zYWN0aW9uKSBtX3R4czsNCn0='