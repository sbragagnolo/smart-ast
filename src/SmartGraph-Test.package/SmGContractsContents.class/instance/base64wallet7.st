base 64 content
base64wallet7
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCi8qDQpUaGlzIEZZTiB0b2tlbiBjb250cmFjdCBpcyBkZXJpdmVkIGZyb20gdGhlIHZTbGljZSBJQ08gY29udHJhY3QsIGJhc2VkIG9uIHRoZSBFUkMyMCB0b2tlbiBjb250cmFjdC4gDQpBZGRpdGlvbmFsIGZ1bmN0aW9uYWxpdHkgaGFzIGJlZW4gaW50ZWdyYXRlZDoNCiogdGhlIGZ1bmN0aW9uIG1pbnRUb2tlbnMoKSBvbmx5IGNhbGxhYmxlIGZyb20gd2FsbGV0LCB3aGljaCBtYWtlcyB1c2Ugb2YgdGhlIGN1cnJlbnRTd2FwUmF0ZSgpIGFuZCBzYWZlVG9BZGQoKSBoZWxwZXJzDQoqIHRoZSBmdW5jdGlvbiBtaW50UmVzZXJ2ZSgpIG9ubHkgY2FsbGFibGUgZnJvbSB3YWxsZXQsIHdoaWNoIGF0IHRoZSBlbmQgb2YgdGhlIGNyb3dkc2FsZSB3aWxsIGFsbG93IHRoZSBvd25lcnMgdG8gY2xhaW0gdGhlIHVuc29sZCB0b2tlbnMNCiogdGhlIGZ1bmN0aW9uIHN0b3BUb2tlbigpIG9ubHkgY2FsbGFibGUgZnJvbSB3YWxsZXQsIHdoaWNoIGluIGFuIGVtZXJnZW5jeSwgd2lsbCB0cmlnZ2VyIGEgY29tcGxldGUgYW5kIGlycmVjb3ZlcmFibGUgc2h1dGRvd24gb2YgdGhlIHRva2VuDQoqIENvbnRyYWN0IHRva2VucyBhcmUgbG9ja2VkIHdoZW4gY3JlYXRlZCwgYW5kIG5vIHRva2VucyBpbmNsdWRpbmcgcHJlLW1pbmUgY2FuIGJlIG1vdmVkIHVudGlsIHRoZSBjcm93ZHNhbGUgaXMgb3Zlci4NCiovDQoNCg0KLy8gRVJDMjAgVG9rZW4gU3RhbmRhcmQgSW50ZXJmYWNlDQovLyBodHRwczovL2dpdGh1Yi5jb20vZXRoZXJldW0vRUlQcy9pc3N1ZXMvMjANCmNvbnRyYWN0IEVSQzIwIHsNCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIHdobykgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3Mgb3duZXIsIGFkZHJlc3Mgc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCk7DQoNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcyBmcm9tLCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKSByZXR1cm5zIChib29sIG9rKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludCB2YWx1ZSkgcmV0dXJucyAoYm9vbCBvayk7DQoNCiAgICBldmVudCBUcmFuc2ZlcihhZGRyZXNzIGluZGV4ZWQgZnJvbSwgYWRkcmVzcyBpbmRleGVkIHRvLCB1aW50IHZhbHVlKTsNCiAgICBldmVudCBBcHByb3ZhbChhZGRyZXNzIGluZGV4ZWQgb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBzcGVuZGVyLCB1aW50IHZhbHVlKTsNCn0NCg0KY29udHJhY3QgVG9rZW4gaXMgRVJDMjAgew0KDQogIHN0cmluZyBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJGdW5kWW91cnNlbGZOb3cgVG9rZW4iOw0KICBzdHJpbmcgcHVibGljIGNvbnN0YW50IHN5bWJvbCA9ICJGWU4iOw0KICB1aW50OCBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsgIC8vIDE4IGlzIHRoZSBtb3N0IGNvbW1vbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMNCiAgdWludDI1NiBwdWJsaWMgdG9rZW5DYXAgPSAxMjUwMDAwMGUxODsgLy8gMTIuNSBtaWxsaW9uIEZZTiBjYXAgDQoNCiAgYWRkcmVzcyBwdWJsaWMgd2FsbGV0QWRkcmVzczsNCiAgdWludDI1NiBwdWJsaWMgY3JlYXRpb25UaW1lOw0KICBib29sIHB1YmxpYyB0cmFuc2ZlclN0b3A7DQogDQogIG1hcHBpbmcoIGFkZHJlc3MgPT4gdWludCApIF9iYWxhbmNlczsNCiAgbWFwcGluZyggYWRkcmVzcyA9PiBtYXBwaW5nKCBhZGRyZXNzID0+IHVpbnQgKSApIF9hcHByb3ZhbHM7DQogIHVpbnQgX3N1cHBseTsNCg0KICBldmVudCBUb2tlbk1pbnQoYWRkcmVzcyBuZXdUb2tlbkhvbGRlciwgdWludCBhbW91bnRPZlRva2Vucyk7DQogIGV2ZW50IFRva2VuU3dhcE92ZXIoKTsNCiAgZXZlbnQgRW1lcmdlbmN5U3RvcEFjdGl2YXRlZCgpOw0KDQogIG1vZGlmaWVyIG9ubHlGcm9tV2FsbGV0IHsNCiAgICAgIGlmIChtc2cuc2VuZGVyICE9IHdhbGxldEFkZHJlc3MpIHRocm93Ow0KICAgICAgXzsNCiAgfQ0KDQogIC8vIENoZWNrIGlmIHRyYW5zZmVyIHNob3VsZCBzdG9wDQogIG1vZGlmaWVyIGNoZWNrVHJhbnNmZXJTdG9wIHsNCiAgICAgIGlmICh0cmFuc2ZlclN0b3AgPT0gdHJ1ZSkgdGhyb3c7DQogICAgICBfOw0KICB9DQogDQoNCiAgLyoqDQogICAqDQogICAqIEZpeCBmb3IgdGhlIEVSQzIwIHNob3J0IGFkZHJlc3MgYXR0YWNrDQogICAqDQogICAqIGh0dHA6Ly92ZXNzZW5lcy5jb20vdGhlLWVyYzIwLXNob3J0LWFkZHJlc3MtYXR0YWNrLWV4cGxhaW5lZC8NCiAgICovDQoNCiAgbW9kaWZpZXIgb25seVBheWxvYWRTaXplKHVpbnQgc2l6ZSkgew0KICAgICBpZiAoIShtc2cuZGF0YS5sZW5ndGggPT0gc2l6ZSArIDQpKSB0aHJvdzsNCiAgICAgXzsNCiAgIH0gDQogDQogIGZ1bmN0aW9uIFRva2VuKCB1aW50IGluaXRpYWxfYmFsYW5jZSwgYWRkcmVzcyB3YWxsZXQsIHVpbnQyNTYgY3Jvd2RzYWxlVGltZSkgew0KICAgIF9iYWxhbmNlc1ttc2cuc2VuZGVyXSA9IGluaXRpYWxfYmFsYW5jZTsNCiAgICBfc3VwcGx5ID0gaW5pdGlhbF9iYWxhbmNlOw0KICAgIHdhbGxldEFkZHJlc3MgPSB3YWxsZXQ7DQogICAgY3JlYXRpb25UaW1lID0gY3Jvd2RzYWxlVGltZTsNCiAgICB0cmFuc2ZlclN0b3AgPSB0cnVlOw0KICB9DQoNCiAgZnVuY3Rpb24gdG90YWxTdXBwbHkoKSBjb25zdGFudCByZXR1cm5zICh1aW50IHN1cHBseSkgew0KICAgIHJldHVybiBfc3VwcGx5Ow0KICB9DQoNCiAgZnVuY3Rpb24gYmFsYW5jZU9mKCBhZGRyZXNzIHdobyApIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdmFsdWUpIHsNCiAgICByZXR1cm4gX2JhbGFuY2VzW3dob107DQogIH0NCg0KICBmdW5jdGlvbiBhbGxvd2FuY2UoYWRkcmVzcyBvd25lciwgYWRkcmVzcyBzcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50IF9hbGxvd2FuY2UpIHsNCiAgICByZXR1cm4gX2FwcHJvdmFsc1tvd25lcl1bc3BlbmRlcl07DQogIH0NCg0KICAvLyBBIGhlbHBlciB0byBub3RpZnkgaWYgb3ZlcmZsb3cgb2NjdXJzDQogIGZ1bmN0aW9uIHNhZmVUb0FkZCh1aW50IGEsIHVpbnQgYikgcHJpdmF0ZSBjb25zdGFudCByZXR1cm5zIChib29sKSB7DQogICAgcmV0dXJuIChhICsgYiA+PSBhICYmIGEgKyBiID49IGIpOw0KICB9DQogIA0KICAvLyBBIGhlbHBlciB0byBub3RpZnkgaWYgb3ZlcmZsb3cgb2NjdXJzIGZvciBtdWx0aXBsaWNhdGlvbg0KICBmdW5jdGlvbiBzYWZlVG9NdWx0aXBseSh1aW50IF9hLCB1aW50IF9iKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsNCiAgICByZXR1cm4gKF9iID09IDAgfHwgKChfYSAqIF9iKSAvIF9iKSA9PSBfYSk7DQogIH0NCg0KICAvLyBBIGhlbHBlciB0byBub3RpZnkgaWYgdW5kZXJmbG93IG9jY3VycyBmb3Igc3VidHJhY3Rpb24NCiAgZnVuY3Rpb24gc2FmZVRvU3ViKHVpbnQgYSwgdWludCBiKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsNCiAgICByZXR1cm4gKGEgPj0gYik7DQogIH0NCg0KDQogIGZ1bmN0aW9uIHRyYW5zZmVyKCBhZGRyZXNzIHRvLCB1aW50IHZhbHVlKQ0KICAgIGNoZWNrVHJhbnNmZXJTdG9wDQogICAgb25seVBheWxvYWRTaXplKDIgKiAzMikNCiAgICByZXR1cm5zIChib29sIG9rKSB7DQoNCiAgICBpZiAodG8gPT0gd2FsbGV0QWRkcmVzcykgdGhyb3c7IC8vIFJlamVjdCB0cmFuc2ZlcnMgdG8gd2FsbGV0ICh3YWxsZXQgY2Fubm90IGludGVyYWN0IHdpdGggdG9rZW4gY29udHJhY3QpDQogICAgaWYoIF9iYWxhbmNlc1ttc2cuc2VuZGVyXSA8IHZhbHVlICkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQogICAgaWYoICFzYWZlVG9BZGQoX2JhbGFuY2VzW3RvXSwgdmFsdWUpICkgew0KICAgICAgICB0aHJvdzsNCiAgICB9DQoNCiAgICBfYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gdmFsdWU7DQogICAgX2JhbGFuY2VzW3RvXSArPSB2YWx1ZTsNCiAgICBUcmFuc2ZlciggbXNnLnNlbmRlciwgdG8sIHZhbHVlICk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCg0KICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oIGFkZHJlc3MgZnJvbSwgYWRkcmVzcyB0bywgdWludCB2YWx1ZSkNCiAgICBjaGVja1RyYW5zZmVyU3RvcA0KICAgIHJldHVybnMgKGJvb2wgb2spIHsNCg0KICAgIGlmICh0byA9PSB3YWxsZXRBZGRyZXNzKSB0aHJvdzsgLy8gUmVqZWN0IHRyYW5zZmVycyB0byB3YWxsZXQgKHdhbGxldCBjYW5ub3QgaW50ZXJhY3Qgd2l0aCB0b2tlbiBjb250cmFjdCkNCg0KICAgIC8vIGlmIHlvdSBkb24ndCBoYXZlIGVub3VnaCBiYWxhbmNlLCB0aHJvdw0KICAgIGlmKCBfYmFsYW5jZXNbZnJvbV0gPCB2YWx1ZSApIHsNCiAgICAgICAgdGhyb3c7DQogICAgfQ0KICAgIC8vIGlmIHlvdSBkb24ndCBoYXZlIGFwcHJvdmFsLCB0aHJvdw0KICAgIGlmKCBfYXBwcm92YWxzW2Zyb21dW21zZy5zZW5kZXJdIDwgdmFsdWUgKSB7DQogICAgICAgIHRocm93Ow0KICAgIH0NCiAgICBpZiggIXNhZmVUb0FkZChfYmFsYW5jZXNbdG9dLCB2YWx1ZSkgKSB7DQogICAgICAgIHRocm93Ow0KICAgIH0NCiAgICAvLyB0cmFuc2ZlciBhbmQgcmV0dXJuIHRydWUNCiAgICBfYXBwcm92YWxzW2Zyb21dW21zZy5zZW5kZXJdIC09IHZhbHVlOw0KICAgIF9iYWxhbmNlc1tmcm9tXSAtPSB2YWx1ZTsNCiAgICBfYmFsYW5jZXNbdG9dICs9IHZhbHVlOw0KICAgIFRyYW5zZmVyKCBmcm9tLCB0bywgdmFsdWUgKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KDQogIGZ1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50IHZhbHVlKQ0KICAgIGNoZWNrVHJhbnNmZXJTdG9wDQogICAgcmV0dXJucyAoYm9vbCBvaykgew0KDQogICAgLy8gVG8gY2hhbmdlIHRoZSBhcHByb3ZlIGFtb3VudCB5b3UgZmlyc3QgaGF2ZSB0byByZWR1Y2UgdGhlIGFkZHJlc3Nlc2ANCiAgICAvLyAgYWxsb3dhbmNlIHRvIHplcm8gYnkgY2FsbGluZyBgYXBwcm92ZShfc3BlbmRlciwwKWAgaWYgaXQgaXMgbm90DQogICAgLy8gIGFscmVhZHkgMCB0byBtaXRpZ2F0ZSB0aGUgcmFjZSBjb25kaXRpb24gZGVzY3JpYmVkIGhlcmU6DQogICAgLy8gIGh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9FSVBzL2lzc3Vlcy8yMCNpc3N1ZWNvbW1lbnQtMjYzNTI0NzI5DQogICAgLy8NCiAgICAvLyBOb3RlIHRoYXQgdGhpcyBkb2Vzbid0IHByZXZlbnQgYXR0YWNrczsgdGhlIHVzZXIgd2lsbCBoYXZlIHRvIHBlcnNvbmFsbHkNCiAgICAvLyAgY2hlY2sgdG8gZW5zdXJlIHRoYXQgdGhlIHRva2VuIGNvdW50IGhhcyBub3QgY2hhbmdlZCwgYmVmb3JlIGlzc3VpbmcNCiAgICAvLyAgYSBuZXcgYXBwcm92YWwuIEluY3JlbWVudC9kZWNyZW1lbnQgaXMgbm90IGNvbW1vbmx5IHNwZWMtZWQsIGFuZCANCiAgICAvLyAgY2hhbmdpbmcgdG8gYSBjaGVjay1teS1hcHByb3ZhbHMtYmVmb3JlLWNoYW5naW5nIHdvdWxkIHJlcXVpcmUgdXNlcg0KICAgIC8vICB0byBmaW5kIG91dCBoaXMgY3VycmVudCBhcHByb3ZhbCBmb3Igc3BlbmRlciBhbmQgY2hhbmdlIGV4cGVjdGVkDQogICAgLy8gIGJlaGF2aW91ciBmb3IgRVJDMjAuDQoNCg0KICAgIGlmICgodmFsdWUhPTApICYmIChfYXBwcm92YWxzW21zZy5zZW5kZXJdW3NwZW5kZXJdICE9MCkpIHRocm93Ow0KDQogICAgX2FwcHJvdmFsc1ttc2cuc2VuZGVyXVtzcGVuZGVyXSA9IHZhbHVlOw0KICAgIEFwcHJvdmFsKCBtc2cuc2VuZGVyLCBzcGVuZGVyLCB2YWx1ZSApOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQoNCiAgLy8gVGhlIGZ1bmN0aW9uIGN1cnJlbnRTd2FwUmF0ZSgpIHJldHVybnMgdGhlIGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZQ0KICAvLyBiZXR3ZWVuIEZZTiB0b2tlbnMgYW5kIEV0aGVyIGR1cmluZyB0aGUgdG9rZW4gc3dhcCBwZXJpb2QNCiAgZnVuY3Rpb24gY3VycmVudFN3YXBSYXRlKCkgY29uc3RhbnQgcmV0dXJucyh1aW50KSB7DQogICAgICB1aW50IHByZXNhbGVQZXJpb2QgPSAzIGRheXM7DQogICAgICB1aW50IHByZXNhbGVUcmFuc2l0aW9uV2luZG93ID0gMyBob3VyczsNCiAgICAgIGlmIChjcmVhdGlvblRpbWUgKyBwcmVzYWxlUGVyaW9kID4gbm93KSB7ICAvLyAyMDE3LTA2LTEwIDExYW0gR01UKzgNCiAgICAgICAgICByZXR1cm4gMTQwOyAvLyBQcmVzYWxlIFdpbmRvdyBpcyB0cmlnZ2VyZWQgYnkgYm90aCB0aW1lIGFuZCAiU3RhcnQgVG9rZW4gU3dhcCAvIEVuZCBUb2tlbiBTd2FwIi4gUmVzdHJpY3RlZCB0byBhbm5vdW5lbWVudCByYW5nZSBhbmQgYmFzaWMgdGVzdGluZy4NCiAgICAgIH0gDQogICAgICBlbHNlIGlmIChjcmVhdGlvblRpbWUgKyBwcmVzYWxlUGVyaW9kICsgMyB3ZWVrcyA+IG5vdykgeyAvLyAyMDE3LTA2LTEzIDExYW0gR01UKzgsIGJ1dCB3ZSB3aWxsIG9ubHkgU3RhcnQgVG9rZW4gU3dhcCBhdCAycG0NCiAgICAgICAgICByZXR1cm4gMTIwOw0KICAgICAgfQ0KICAgICAgZWxzZSBpZiAoY3JlYXRpb25UaW1lICsgcHJlc2FsZVBlcmlvZCArIDYgd2Vla3MgKyA2IGRheXMgKyAzIGhvdXJzICsgcHJlc2FsZVRyYW5zaXRpb25XaW5kb3cgKyAxIGRheXMgPiBub3cpIHsgLy8gMjAxNy0wNy0zMSA1cG0gR01UKzggKCsxIGRheSB3aW5kb3cgICkNCiAgICAgICAgICAvLyAxIGRheSBidWZmZXIgdG8gYWxsb3cgb25lIGZpbmFsIHRyYW5zYWN0aW9uIGZyb20gYW55b25lIHRvIGNsb3NlIGV2ZXJ5dGhpbmcNCiAgICAgICAgICAvLyBvdGhlcndpc2Ugd2FsbGV0IHdpbGwgcmVjZWl2ZSBldGhlciBidXQgc2VuZCAwIHRva2Vucw0KICAgICAgICAgIC8vIHdlIGNhbm5vdCB0aHJvdyBhcyB3ZSB3aWxsIGxvc2UgdGhlIHN0YXRlIGNoYW5nZSB0byBzdGFydCBzd2FwcGFiaWxpdHkgb2YgdG9rZW5zIA0KICAgICAgICAgIC8vIFRoaXMgaXMgYWN0dWFsbHkganVzdCBhIHByaWNlIGd1aWRlLCBhY3R1YWwgY2xvc2luZyBpcyBkb25lIGF0IHRoZSBXYWxsZXQgbGV2ZWwNCiAgICAgICAgICByZXR1cm4gMTAwOw0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgICAgcmV0dXJuIDA7DQogICAgICB9DQogIH0NCg0KICAvLyBUaGUgZnVuY3Rpb24gbWludFRva2VucyBpcyBvbmx5IHVzYWJsZSBieSB0aGUgY2hvc2VuIHdhbGxldA0KICAvLyBjb250cmFjdCB0byBtaW50IGEgbnVtYmVyIG9mIHRva2VucyBwcm9wb3J0aW9uYWwgdG8gdGhlDQogIC8vIGFtb3VudCBvZiBldGhlciBzZW50IHRvIHRoZSB3YWxsZXQgY29udHJhY3QuIFRoZSBmdW5jdGlvbg0KICAvLyBjYW4gb25seSBiZSBjYWxsZWQgZHVyaW5nIHRoZSB0b2tlbnN3YXAgcGVyaW9kDQogIGZ1bmN0aW9uIG1pbnRUb2tlbnMoYWRkcmVzcyBuZXdUb2tlbkhvbGRlciwgdWludCBldGhlckFtb3VudCkNCiAgICBleHRlcm5hbA0KICAgIG9ubHlGcm9tV2FsbGV0IHsNCiAgICAgICAgaWYgKCFzYWZlVG9NdWx0aXBseShjdXJyZW50U3dhcFJhdGUoKSwgZXRoZXJBbW91bnQpKSB0aHJvdzsNCiAgICAgICAgdWludCB0b2tlbnNBbW91bnQgPSBjdXJyZW50U3dhcFJhdGUoKSAqIGV0aGVyQW1vdW50Ow0KDQogICAgICAgIGlmKCFzYWZlVG9BZGQoX2JhbGFuY2VzW25ld1Rva2VuSG9sZGVyXSx0b2tlbnNBbW91bnQgKSkgdGhyb3c7DQogICAgICAgIGlmKCFzYWZlVG9BZGQoX3N1cHBseSx0b2tlbnNBbW91bnQpKSB0aHJvdzsNCg0KICAgICAgICBpZiAoKF9zdXBwbHkgKyB0b2tlbnNBbW91bnQpID4gdG9rZW5DYXApIHRocm93Ow0KDQogICAgICAgIF9iYWxhbmNlc1tuZXdUb2tlbkhvbGRlcl0gKz0gdG9rZW5zQW1vdW50Ow0KICAgICAgICBfc3VwcGx5ICs9IHRva2Vuc0Ftb3VudDsNCg0KICAgICAgICBUb2tlbk1pbnQobmV3VG9rZW5Ib2xkZXIsIHRva2Vuc0Ftb3VudCk7DQogIH0NCg0KICBmdW5jdGlvbiBtaW50UmVzZXJ2ZShhZGRyZXNzIGJlbmVmaWNpYXJ5KSANCiAgICBleHRlcm5hbA0KICAgIG9ubHlGcm9tV2FsbGV0IHsNCiAgICAgICAgaWYgKHRva2VuQ2FwIDw9IF9zdXBwbHkpIHRocm93Ow0KICAgICAgICBpZighc2FmZVRvU3ViKHRva2VuQ2FwLF9zdXBwbHkpKSB0aHJvdzsNCiAgICAgICAgdWludCB0b2tlbnNBbW91bnQgPSB0b2tlbkNhcCAtIF9zdXBwbHk7DQoNCiAgICAgICAgaWYoIXNhZmVUb0FkZChfYmFsYW5jZXNbYmVuZWZpY2lhcnldLCB0b2tlbnNBbW91bnQgKSkgdGhyb3c7DQogICAgICAgIGlmKCFzYWZlVG9BZGQoX3N1cHBseSx0b2tlbnNBbW91bnQpKSB0aHJvdzsNCg0KICAgICAgICBfYmFsYW5jZXNbYmVuZWZpY2lhcnldICs9IHRva2Vuc0Ftb3VudDsNCiAgICAgICAgX3N1cHBseSArPSB0b2tlbnNBbW91bnQ7DQogICAgICAgIA0KICAgICAgICBUb2tlbk1pbnQoYmVuZWZpY2lhcnksIHRva2Vuc0Ftb3VudCk7DQogIH0NCg0KICAvLyBUaGUgZnVuY3Rpb24gZGlzYWJsZVRva2VuU3dhcExvY2soKSBpcyBjYWxsZWQgYnkgdGhlIHdhbGxldA0KICAvLyBjb250cmFjdCBvbmNlIHRoZSB0b2tlbiBzd2FwIGhhcyByZWFjaGVkIGl0cyBlbmQgY29uZGl0aW9ucw0KICBmdW5jdGlvbiBkaXNhYmxlVG9rZW5Td2FwTG9jaygpDQogICAgZXh0ZXJuYWwNCiAgICBvbmx5RnJvbVdhbGxldCB7DQogICAgICAgIHRyYW5zZmVyU3RvcCA9IGZhbHNlOw0KICAgICAgICBUb2tlblN3YXBPdmVyKCk7DQogIH0NCg0KICAvLyBPbmNlIGFjdGl2YXRlZCwgYSBuZXcgdG9rZW4gY29udHJhY3Qgd2lsbCBuZWVkIHRvIGJlIGNyZWF0ZWQsIG1pcnJvcmluZyB0aGUgY3VycmVudCB0b2tlbiBob2xkaW5ncy4gDQogIGZ1bmN0aW9uIHN0b3BUb2tlbigpIG9ubHlGcm9tV2FsbGV0IHsNCiAgICB0cmFuc2ZlclN0b3AgPSB0cnVlOw0KICAgIEVtZXJnZW5jeVN0b3BBY3RpdmF0ZWQoKTsNCiAgfQ0KfQ0KDQoNCi8qDQpUaGUgc3RhbmRhcmQgV2FsbGV0IGNvbnRyYWN0LCByZXRyaWV2YWJsZSBhdA0KaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL2RhcHAtYmluL2Jsb2IvbWFzdGVyL3dhbGxldC93YWxsZXQuc29sIGhhcyBiZWVuDQptb2RpZmllZCB0byBpbmNsdWRlIGFkZGl0aW9uYWwgZnVuY3Rpb25hbGl0eSwgaW4gcGFydGljdWxhcjoNCiogQW4gYWRkaXRpb25hbCBwYXJlbnQgb2Ygd2FsbGV0IGNvbnRyYWN0IGNhbGxlZCB0b2tlbnN3YXAsIGltcGxlbWVudGluZyBhbG1vc3QNCmFsbCB0aGUgY2hhbmdlczoNCiAgICAtIEZ1bmN0aW9ucyBmb3Igc3RhcnRpbmcgYW5kIHN0b3BwaW5nIHRoZSB0b2tlbnN3YXANCiAgICAtIEEgc2V0LW9ubHktb25jZSBmdW5jdGlvbiBmb3IgdGhlIHRva2VuIGNvbnRyYWN0DQogICAgLSBidXlUb2tlbnMoKSwgd2hpY2ggY2FsbHMgbWludFRva2VucygpIGluIHRoZSB0b2tlbiBjb250cmFjdA0KICAgIC0gTW9kaWZpZXJzIGZvciBlbmZvcmNpbmcgdG9rZW5zd2FwIHRpbWUgbGltaXRzLCBtYXggZXRoZXIgY2FwLCBhbmQgbWF4IHRva2VuIGNhcA0KICAgIC0gd2l0aGRyYXdFdGhlcigpLCBmb3Igd2l0aGRyYXdpbmcgdW5zb2xkIHRva2VucyBhZnRlciB0aW1lIGNhcA0KKiB0aGUgd2FsbGV0IGZhbGxiYWNrIGZ1bmN0aW9uIGNhbGxzIHRoZSBidXlUb2tlbnMgZnVuY3Rpb24NCiogdGhlIHdhbGxldCBjb250cmFjdCBjYW5ub3Qgc2VsZmRlc3RydWN0IGR1cmluZyB0aGUgdG9rZW5zd2FwDQoqLw0KDQpjb250cmFjdCBtdWx0aW93bmVkIHsNCg0KCS8vIFRZUEVTDQoNCiAgICAvLyBzdHJ1Y3QgZm9yIHRoZSBzdGF0dXMgb2YgYSBwZW5kaW5nIG9wZXJhdGlvbi4NCiAgICBzdHJ1Y3QgUGVuZGluZ1N0YXRlIHsNCiAgICAgICAgdWludCB5ZXROZWVkZWQ7DQogICAgICAgIHVpbnQgb3duZXJzRG9uZTsNCiAgICAgICAgdWludCBpbmRleDsNCiAgICB9DQoNCgkvLyBFVkVOVFMNCg0KICAgIC8vIHRoaXMgY29udHJhY3Qgb25seSBoYXMgc2l4IHR5cGVzIG9mIGV2ZW50czogaXQgY2FuIGFjY2VwdCBhIGNvbmZpcm1hdGlvbiwgaW4gd2hpY2ggY2FzZQ0KICAgIC8vIHdlIHJlY29yZCBvd25lciBhbmQgb3BlcmF0aW9uIChoYXNoKSBhbG9uZ3NpZGUgaXQuDQogICAgZXZlbnQgQ29uZmlybWF0aW9uKGFkZHJlc3Mgb3duZXIsIGJ5dGVzMzIgb3BlcmF0aW9uKTsNCiAgICBldmVudCBSZXZva2UoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24pOw0KICAgIC8vIHNvbWUgb3RoZXJzIGFyZSBpbiB0aGUgY2FzZSBvZiBhbiBvd25lciBjaGFuZ2luZy4NCiAgICBldmVudCBPd25lckNoYW5nZWQoYWRkcmVzcyBvbGRPd25lciwgYWRkcmVzcyBuZXdPd25lcik7DQogICAgZXZlbnQgT3duZXJBZGRlZChhZGRyZXNzIG5ld093bmVyKTsNCiAgICBldmVudCBPd25lclJlbW92ZWQoYWRkcmVzcyBvbGRPd25lcik7DQogICAgLy8gdGhlIGxhc3Qgb25lIGlzIGVtaXR0ZWQgaWYgdGhlIHJlcXVpcmVkIHNpZ25hdHVyZXMgY2hhbmdlDQogICAgZXZlbnQgUmVxdWlyZW1lbnRDaGFuZ2VkKHVpbnQgbmV3UmVxdWlyZW1lbnQpOw0KDQoJLy8gTU9ESUZJRVJTDQoNCiAgICAvLyBzaW1wbGUgc2luZ2xlLXNpZyBmdW5jdGlvbiBtb2RpZmllci4NCiAgICBtb2RpZmllciBvbmx5b3duZXIgew0KICAgICAgICBpZiAoaXNPd25lcihtc2cuc2VuZGVyKSkNCiAgICAgICAgICAgIF87DQogICAgfQ0KICAgIC8vIG11bHRpLXNpZyBmdW5jdGlvbiBtb2RpZmllcjogdGhlIG9wZXJhdGlvbiBtdXN0IGhhdmUgYW4gaW50cmluc2ljIGhhc2ggaW4gb3JkZXINCiAgICAvLyB0aGF0IGxhdGVyIGF0dGVtcHRzIGNhbiBiZSByZWFsaXNlZCBhcyB0aGUgc2FtZSB1bmRlcmx5aW5nIG9wZXJhdGlvbiBhbmQNCiAgICAvLyB0aHVzIGNvdW50IGFzIGNvbmZpcm1hdGlvbnMuDQogICAgbW9kaWZpZXIgb25seW1hbnlvd25lcnMoYnl0ZXMzMiBfb3BlcmF0aW9uKSB7DQogICAgICAgIGlmIChjb25maXJtQW5kQ2hlY2soX29wZXJhdGlvbikpDQogICAgICAgICAgICBfOw0KICAgIH0NCg0KCS8vIE1FVEhPRFMNCg0KICAgIC8vIGNvbnN0cnVjdG9yIGlzIGdpdmVuIG51bWJlciBvZiBzaWdzIHJlcXVpcmVkIHRvIGRvIHByb3RlY3RlZCAib25seW1hbnlvd25lcnMiIHRyYW5zYWN0aW9ucw0KICAgIC8vIGFzIHdlbGwgYXMgdGhlIHNlbGVjdGlvbiBvZiBhZGRyZXNzZXMgY2FwYWJsZSBvZiBjb25maXJtaW5nIHRoZW0uDQogICAgZnVuY3Rpb24gbXVsdGlvd25lZChhZGRyZXNzW10gX293bmVycywgdWludCBfcmVxdWlyZWQpIHsNCiAgICAgICAgbV9udW1Pd25lcnMgPSBfb3duZXJzLmxlbmd0aCArIDE7DQogICAgICAgIG1fb3duZXJzWzFdID0gdWludChtc2cuc2VuZGVyKTsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildID0gMTsNCiAgICAgICAgZm9yICh1aW50IGkgPSAwOyBpIDwgX293bmVycy5sZW5ndGg7ICsraSkNCiAgICAgICAgew0KICAgICAgICAgICAgbV9vd25lcnNbMiArIGldID0gdWludChfb3duZXJzW2ldKTsNCiAgICAgICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcnNbaV0pXSA9IDIgKyBpOw0KICAgICAgICB9DQogICAgICAgIG1fcmVxdWlyZWQgPSBfcmVxdWlyZWQ7DQogICAgfQ0KDQogICAgLy8gUmV2b2tlcyBhIHByaW9yIGNvbmZpcm1hdGlvbiBvZiB0aGUgZ2l2ZW4gb3BlcmF0aW9uDQogICAgZnVuY3Rpb24gcmV2b2tlKGJ5dGVzMzIgX29wZXJhdGlvbikgZXh0ZXJuYWwgew0KICAgICAgICB1aW50IG93bmVySW5kZXggPSBtX293bmVySW5kZXhbdWludChtc2cuc2VuZGVyKV07DQogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGV5J3JlIGFuIG93bmVyDQogICAgICAgIGlmIChvd25lckluZGV4ID09IDApIHJldHVybjsNCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX3BlbmRpbmdbX29wZXJhdGlvbl07DQogICAgICAgIGlmIChwZW5kaW5nLm93bmVyc0RvbmUgJiBvd25lckluZGV4Qml0ID4gMCkgew0KICAgICAgICAgICAgcGVuZGluZy55ZXROZWVkZWQrKzsNCiAgICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSAtPSBvd25lckluZGV4Qml0Ow0KICAgICAgICAgICAgUmV2b2tlKG1zZy5zZW5kZXIsIF9vcGVyYXRpb24pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gUmVwbGFjZXMgYW4gb3duZXIgYF9mcm9tYCB3aXRoIGFub3RoZXIgYF90b2AuDQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIGlmIChpc093bmVyKF90bykpIHJldHVybjsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQoX2Zyb20pXTsNCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuOw0KDQogICAgICAgIGNsZWFyUGVuZGluZygpOw0KICAgICAgICBtX293bmVyc1tvd25lckluZGV4XSA9IHVpbnQoX3RvKTsNCiAgICAgICAgbV9vd25lckluZGV4W3VpbnQoX2Zyb20pXSA9IDA7DQogICAgICAgIG1fb3duZXJJbmRleFt1aW50KF90byldID0gb3duZXJJbmRleDsNCiAgICAgICAgT3duZXJDaGFuZ2VkKF9mcm9tLCBfdG8pOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFkZE93bmVyKGFkZHJlc3MgX293bmVyKSBvbmx5bWFueW93bmVycyhzaGEzKG1zZy5kYXRhKSkgZXh0ZXJuYWwgew0KICAgICAgICBpZiAoaXNPd25lcihfb3duZXIpKSByZXR1cm47DQoNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIGlmIChtX251bU93bmVycyA+PSBjX21heE93bmVycykNCiAgICAgICAgICAgIHJlb3JnYW5pemVPd25lcnMoKTsNCiAgICAgICAgaWYgKG1fbnVtT3duZXJzID49IGNfbWF4T3duZXJzKQ0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICBtX251bU93bmVycysrOw0KICAgICAgICBtX293bmVyc1ttX251bU93bmVyc10gPSB1aW50KF9vd25lcik7DQogICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcildID0gbV9udW1Pd25lcnM7DQogICAgICAgIE93bmVyQWRkZWQoX293bmVyKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZW1vdmVPd25lcihhZGRyZXNzIF9vd25lcikgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQoX293bmVyKV07DQogICAgICAgIGlmIChvd25lckluZGV4ID09IDApIHJldHVybjsNCiAgICAgICAgaWYgKG1fcmVxdWlyZWQgPiBtX251bU93bmVycyAtIDEpIHJldHVybjsNCg0KICAgICAgICBtX293bmVyc1tvd25lckluZGV4XSA9IDA7DQogICAgICAgIG1fb3duZXJJbmRleFt1aW50KF9vd25lcildID0gMDsNCiAgICAgICAgY2xlYXJQZW5kaW5nKCk7DQogICAgICAgIHJlb3JnYW5pemVPd25lcnMoKTsgLy9tYWtlIHN1cmUgbV9udW1Pd25lciBpcyBlcXVhbCB0byB0aGUgbnVtYmVyIG9mIG93bmVycyBhbmQgYWx3YXlzIHBvaW50cyB0byB0aGUgb3B0aW1hbCBmcmVlIHNsb3QNCiAgICAgICAgT3duZXJSZW1vdmVkKF9vd25lcik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2hhbmdlUmVxdWlyZW1lbnQodWludCBfbmV3UmVxdWlyZWQpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIGlmIChfbmV3UmVxdWlyZWQgPiBtX251bU93bmVycykgcmV0dXJuOw0KICAgICAgICBtX3JlcXVpcmVkID0gX25ld1JlcXVpcmVkOw0KICAgICAgICBjbGVhclBlbmRpbmcoKTsNCiAgICAgICAgUmVxdWlyZW1lbnRDaGFuZ2VkKF9uZXdSZXF1aXJlZCk7DQogICAgfQ0KDQogICAgLy8gR2V0cyBhbiBvd25lciBieSAwLWluZGV4ZWQgcG9zaXRpb24gKHVzaW5nIG51bU93bmVycyBhcyB0aGUgY291bnQpDQogICAgZnVuY3Rpb24gZ2V0T3duZXIodWludCBvd25lckluZGV4KSBleHRlcm5hbCBjb25zdGFudCByZXR1cm5zIChhZGRyZXNzKSB7DQogICAgICAgIHJldHVybiBhZGRyZXNzKG1fb3duZXJzW293bmVySW5kZXggKyAxXSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaXNPd25lcihhZGRyZXNzIF9hZGRyKSByZXR1cm5zIChib29sKSB7DQogICAgICAgIHJldHVybiBtX293bmVySW5kZXhbdWludChfYWRkcildID4gMDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBoYXNDb25maXJtZWQoYnl0ZXMzMiBfb3BlcmF0aW9uLCBhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICB2YXIgcGVuZGluZyA9IG1fcGVuZGluZ1tfb3BlcmF0aW9uXTsNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQoX293bmVyKV07DQoNCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoZXkncmUgYW4gb3duZXINCiAgICAgICAgaWYgKG93bmVySW5kZXggPT0gMCkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIC8vIGRldGVybWluZSB0aGUgYml0IHRvIHNldCBmb3IgdGhpcyBvd25lci4NCiAgICAgICAgdWludCBvd25lckluZGV4Qml0ID0gMioqb3duZXJJbmRleDsNCiAgICAgICAgcmV0dXJuICEocGVuZGluZy5vd25lcnNEb25lICYgb3duZXJJbmRleEJpdCA9PSAwKTsNCiAgICB9DQoNCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTDQoNCiAgICBmdW5jdGlvbiBjb25maXJtQW5kQ2hlY2soYnl0ZXMzMiBfb3BlcmF0aW9uKSBpbnRlcm5hbCByZXR1cm5zIChib29sKSB7DQogICAgICAgIC8vIGRldGVybWluZSB3aGF0IGluZGV4IHRoZSBwcmVzZW50IHNlbmRlciBpczoNCiAgICAgICAgdWludCBvd25lckluZGV4ID0gbV9vd25lckluZGV4W3VpbnQobXNnLnNlbmRlcildOw0KICAgICAgICAvLyBtYWtlIHN1cmUgdGhleSdyZSBhbiBvd25lcg0KICAgICAgICBpZiAob3duZXJJbmRleCA9PSAwKSByZXR1cm47DQoNCiAgICAgICAgdmFyIHBlbmRpbmcgPSBtX3BlbmRpbmdbX29wZXJhdGlvbl07DQogICAgICAgIC8vIGlmIHdlJ3JlIG5vdCB5ZXQgd29ya2luZyBvbiB0aGlzIG9wZXJhdGlvbiwgc3dpdGNoIG92ZXIgYW5kIHJlc2V0IHRoZSBjb25maXJtYXRpb24gc3RhdHVzLg0KICAgICAgICBpZiAocGVuZGluZy55ZXROZWVkZWQgPT0gMCkgew0KICAgICAgICAgICAgLy8gcmVzZXQgY291bnQgb2YgY29uZmlybWF0aW9ucyBuZWVkZWQuDQogICAgICAgICAgICBwZW5kaW5nLnlldE5lZWRlZCA9IG1fcmVxdWlyZWQ7DQogICAgICAgICAgICAvLyByZXNldCB3aGljaCBvd25lcnMgaGF2ZSBjb25maXJtZWQgKG5vbmUpIC0gc2V0IG91ciBiaXRtYXAgdG8gMC4NCiAgICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSA9IDA7DQogICAgICAgICAgICBwZW5kaW5nLmluZGV4ID0gbV9wZW5kaW5nSW5kZXgubGVuZ3RoKys7DQogICAgICAgICAgICBtX3BlbmRpbmdJbmRleFtwZW5kaW5nLmluZGV4XSA9IF9vcGVyYXRpb247DQogICAgICAgIH0NCiAgICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBiaXQgdG8gc2V0IGZvciB0aGlzIG93bmVyLg0KICAgICAgICB1aW50IG93bmVySW5kZXhCaXQgPSAyKipvd25lckluZGV4Ow0KICAgICAgICAvLyBtYWtlIHN1cmUgd2UgKHRoZSBtZXNzYWdlIHNlbmRlcikgaGF2ZW4ndCBjb25maXJtZWQgdGhpcyBvcGVyYXRpb24gcHJldmlvdXNseS4NCiAgICAgICAgaWYgKHBlbmRpbmcub3duZXJzRG9uZSAmIG93bmVySW5kZXhCaXQgPT0gMCkgew0KICAgICAgICAgICAgQ29uZmlybWF0aW9uKG1zZy5zZW5kZXIsIF9vcGVyYXRpb24pOw0KICAgICAgICAgICAgLy8gb2sgLSBjaGVjayBpZiBjb3VudCBpcyBlbm91Z2ggdG8gZ28gYWhlYWQuDQogICAgICAgICAgICBpZiAocGVuZGluZy55ZXROZWVkZWQgPD0gMSkgew0KICAgICAgICAgICAgICAgIC8vIGVub3VnaCBjb25maXJtYXRpb25zOiByZXNldCBhbmQgcnVuIGludGVyaW9yLg0KICAgICAgICAgICAgICAgIGRlbGV0ZSBtX3BlbmRpbmdJbmRleFttX3BlbmRpbmdbX29wZXJhdGlvbl0uaW5kZXhdOw0KICAgICAgICAgICAgICAgIGRlbGV0ZSBtX3BlbmRpbmdbX29wZXJhdGlvbl07DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gbm90IGVub3VnaDogcmVjb3JkIHRoYXQgdGhpcyBvd25lciBpbiBwYXJ0aWN1bGFyIGNvbmZpcm1lZC4NCiAgICAgICAgICAgICAgICBwZW5kaW5nLnlldE5lZWRlZC0tOw0KICAgICAgICAgICAgICAgIHBlbmRpbmcub3duZXJzRG9uZSB8PSBvd25lckluZGV4Qml0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVvcmdhbml6ZU93bmVycygpIHByaXZhdGUgew0KICAgICAgICB1aW50IGZyZWUgPSAxOw0KICAgICAgICB3aGlsZSAoZnJlZSA8IG1fbnVtT3duZXJzKQ0KICAgICAgICB7DQogICAgICAgICAgICB3aGlsZSAoZnJlZSA8IG1fbnVtT3duZXJzICYmIG1fb3duZXJzW2ZyZWVdICE9IDApIGZyZWUrKzsNCiAgICAgICAgICAgIHdoaWxlIChtX251bU93bmVycyA+IDEgJiYgbV9vd25lcnNbbV9udW1Pd25lcnNdID09IDApIG1fbnVtT3duZXJzLS07DQogICAgICAgICAgICBpZiAoZnJlZSA8IG1fbnVtT3duZXJzICYmIG1fb3duZXJzW21fbnVtT3duZXJzXSAhPSAwICYmIG1fb3duZXJzW2ZyZWVdID09IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgbV9vd25lcnNbZnJlZV0gPSBtX293bmVyc1ttX251bU93bmVyc107DQogICAgICAgICAgICAgICAgbV9vd25lckluZGV4W21fb3duZXJzW2ZyZWVdXSA9IGZyZWU7DQogICAgICAgICAgICAgICAgbV9vd25lcnNbbV9udW1Pd25lcnNdID0gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNsZWFyUGVuZGluZygpIGludGVybmFsIHsNCiAgICAgICAgdWludCBsZW5ndGggPSBtX3BlbmRpbmdJbmRleC5sZW5ndGg7DQogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKQ0KICAgICAgICAgICAgaWYgKG1fcGVuZGluZ0luZGV4W2ldICE9IDApDQogICAgICAgICAgICAgICAgZGVsZXRlIG1fcGVuZGluZ1ttX3BlbmRpbmdJbmRleFtpXV07DQogICAgICAgIGRlbGV0ZSBtX3BlbmRpbmdJbmRleDsNCiAgICB9DQoNCiAgIAkvLyBGSUVMRFMNCg0KICAgIC8vIHRoZSBudW1iZXIgb2Ygb3duZXJzIHRoYXQgbXVzdCBjb25maXJtIHRoZSBzYW1lIG9wZXJhdGlvbiBiZWZvcmUgaXQgaXMgcnVuLg0KICAgIHVpbnQgcHVibGljIG1fcmVxdWlyZWQ7DQogICAgLy8gcG9pbnRlciB1c2VkIHRvIGZpbmQgYSBmcmVlIHNsb3QgaW4gbV9vd25lcnMNCiAgICB1aW50IHB1YmxpYyBtX251bU93bmVyczsNCg0KICAgIC8vIGxpc3Qgb2Ygb3duZXJzDQogICAgdWludFsyNTZdIG1fb3duZXJzOw0KICAgIHVpbnQgY29uc3RhbnQgY19tYXhPd25lcnMgPSAyNTA7DQogICAgLy8gaW5kZXggb24gdGhlIGxpc3Qgb2Ygb3duZXJzIHRvIGFsbG93IHJldmVyc2UgbG9va3VwDQogICAgbWFwcGluZyh1aW50ID0+IHVpbnQpIG1fb3duZXJJbmRleDsNCiAgICAvLyB0aGUgb25nb2luZyBvcGVyYXRpb25zLg0KICAgIG1hcHBpbmcoYnl0ZXMzMiA9PiBQZW5kaW5nU3RhdGUpIG1fcGVuZGluZzsNCiAgICBieXRlczMyW10gbV9wZW5kaW5nSW5kZXg7DQp9DQoNCi8vIGluaGVyaXRhYmxlICJwcm9wZXJ0eSIgY29udHJhY3QgdGhhdCBlbmFibGVzIG1ldGhvZHMgdG8gYmUgcHJvdGVjdGVkIGJ5IHBsYWNpbmcgYSBsaW5lYXIgbGltaXQgKHNwZWNpZmlhYmxlKQ0KLy8gb24gYSBwYXJ0aWN1bGFyIHJlc291cmNlIHBlciBjYWxlbmRhciBkYXkuIGlzIG11bHRpb3duZWQgdG8gYWxsb3cgdGhlIGxpbWl0IHRvIGJlIGFsdGVyZWQuIHJlc291cmNlIHRoYXQgbWV0aG9kDQovLyB1c2VzIGlzIHNwZWNpZmllZCBpbiB0aGUgbW9kaWZpZXIuDQpjb250cmFjdCBkYXlsaW1pdCBpcyBtdWx0aW93bmVkIHsNCg0KCS8vIE1PRElGSUVSUw0KDQogICAgLy8gc2ltcGxlIG1vZGlmaWVyIGZvciBkYWlseSBsaW1pdC4NCiAgICBtb2RpZmllciBsaW1pdGVkRGFpbHkodWludCBfdmFsdWUpIHsNCiAgICAgICAgaWYgKHVuZGVyTGltaXQoX3ZhbHVlKSkNCiAgICAgICAgICAgIF87DQogICAgfQ0KDQoJLy8gTUVUSE9EUw0KDQogICAgLy8gY29uc3RydWN0b3IgLSBzdG9yZXMgaW5pdGlhbCBkYWlseSBsaW1pdCBhbmQgcmVjb3JkcyB0aGUgcHJlc2VudCBkYXkncyBpbmRleC4NCiAgICBmdW5jdGlvbiBkYXlsaW1pdCh1aW50IF9saW1pdCkgew0KICAgICAgICBtX2RhaWx5TGltaXQgPSBfbGltaXQ7DQogICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgfQ0KICAgIC8vIChyZSlzZXRzIHRoZSBkYWlseSBsaW1pdC4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uIGRvZXNuJ3QgYWx0ZXIgdGhlIGFtb3VudCBhbHJlYWR5IHNwZW50IHRvZGF5Lg0KICAgIGZ1bmN0aW9uIHNldERhaWx5TGltaXQodWludCBfbmV3TGltaXQpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIG1fZGFpbHlMaW1pdCA9IF9uZXdMaW1pdDsNCiAgICB9DQogICAgLy8gcmVzZXRzIHRoZSBhbW91bnQgYWxyZWFkeSBzcGVudCB0b2RheS4gbmVlZHMgbWFueSBvZiB0aGUgb3duZXJzIHRvIGNvbmZpcm0uDQogICAgZnVuY3Rpb24gcmVzZXRTcGVudFRvZGF5KCkgb25seW1hbnlvd25lcnMoc2hhMyhtc2cuZGF0YSkpIGV4dGVybmFsIHsNCiAgICAgICAgbV9zcGVudFRvZGF5ID0gMDsNCiAgICB9DQoNCiAgICAvLyBJTlRFUk5BTCBNRVRIT0RTDQoNCiAgICAvLyBjaGVja3MgdG8gc2VlIGlmIHRoZXJlIGlzIGF0IGxlYXN0IGBfdmFsdWVgIGxlZnQgZnJvbSB0aGUgZGFpbHkgbGltaXQgdG9kYXkuIGlmIHRoZXJlIGlzLCBzdWJ0cmFjdHMgaXQgYW5kDQogICAgLy8gcmV0dXJucyB0cnVlLiBvdGhlcndpc2UganVzdCByZXR1cm5zIGZhbHNlLg0KICAgIGZ1bmN0aW9uIHVuZGVyTGltaXQodWludCBfdmFsdWUpIGludGVybmFsIG9ubHlvd25lciByZXR1cm5zIChib29sKSB7DQogICAgICAgIC8vIHJlc2V0IHRoZSBzcGVuZCBsaW1pdCBpZiB3ZSdyZSBvbiBhIGRpZmZlcmVudCBkYXkgdG8gbGFzdCB0aW1lLg0KICAgICAgICBpZiAodG9kYXkoKSA+IG1fbGFzdERheSkgew0KICAgICAgICAgICAgbV9zcGVudFRvZGF5ID0gMDsNCiAgICAgICAgICAgIG1fbGFzdERheSA9IHRvZGF5KCk7DQogICAgICAgIH0NCiAgICAgICAgLy8gY2hlY2sgaWYgaXQncyBzZW5kaW5nIG5vdGhpbmcgKHdpdGggb3Igd2l0aG91dCBkYXRhKS4gVGhpcyBuZWVkcyBNdWx0aXRyYW5zYWN0DQogICAgICAgIGlmIChfdmFsdWUgPT0gMCkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB0aGVyZSdzIGVub3VnaCBsZWZ0IC0gaWYgc28sIHN1YnRyYWN0IGFuZCByZXR1cm4gdHJ1ZS4NCiAgICAgICAgLy8gb3ZlcmZsb3cgcHJvdGVjdGlvbiAgICAgICAgICAgICAgICAgICAgLy8gZGFpbHlMaW1pdCBjaGVjaw0KICAgICAgICBpZiAobV9zcGVudFRvZGF5ICsgX3ZhbHVlID49IG1fc3BlbnRUb2RheSAmJiBtX3NwZW50VG9kYXkgKyBfdmFsdWUgPD0gbV9kYWlseUxpbWl0KSB7DQogICAgICAgICAgICBtX3NwZW50VG9kYXkgKz0gX3ZhbHVlOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICAvLyBkZXRlcm1pbmVzIHRvZGF5J3MgaW5kZXguDQogICAgZnVuY3Rpb24gdG9kYXkoKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKHVpbnQpIHsgcmV0dXJuIG5vdyAvIDEgZGF5czsgfQ0KDQoJLy8gRklFTERTDQoNCiAgICB1aW50IHB1YmxpYyBtX2RhaWx5TGltaXQ7DQogICAgdWludCBwdWJsaWMgbV9zcGVudFRvZGF5Ow0KICAgIHVpbnQgcHVibGljIG1fbGFzdERheTsNCn0NCg0KLy8gaW50ZXJmYWNlIGNvbnRyYWN0IGZvciBtdWx0aXNpZyBwcm94eSBjb250cmFjdHM7IHNlZSBiZWxvdyBmb3IgZG9jcy4NCmNvbnRyYWN0IG11bHRpc2lnIHsNCg0KCS8vIEVWRU5UUw0KDQogICAgLy8gbG9nZ2VkIGV2ZW50czoNCiAgICAvLyBGdW5kcyBoYXMgYXJyaXZlZCBpbnRvIHRoZSB3YWxsZXQgKHJlY29yZCBob3cgbXVjaCkuDQogICAgZXZlbnQgRGVwb3NpdChhZGRyZXNzIF9mcm9tLCB1aW50IHZhbHVlKTsNCiAgICAvLyBTaW5nbGUgdHJhbnNhY3Rpb24gZ29pbmcgb3V0IG9mIHRoZSB3YWxsZXQgKHJlY29yZCB3aG8gc2lnbmVkIGZvciBpdCwgaG93IG11Y2gsIGFuZCB0byB3aG9tIGl0J3MgZ29pbmcpLg0KICAgIGV2ZW50IFNpbmdsZVRyYW5zYWN0KGFkZHJlc3Mgb3duZXIsIHVpbnQgdmFsdWUsIGFkZHJlc3MgdG8sIGJ5dGVzIGRhdGEpOw0KICAgIC8vIE11bHRpLXNpZyB0cmFuc2FjdGlvbiBnb2luZyBvdXQgb2YgdGhlIHdhbGxldCAocmVjb3JkIHdobyBzaWduZWQgZm9yIGl0IGxhc3QsIHRoZSBvcGVyYXRpb24gaGFzaCwgaG93IG11Y2gsIGFuZCB0byB3aG9tIGl0J3MgZ29pbmcpLg0KICAgIGV2ZW50IE11bHRpVHJhbnNhY3QoYWRkcmVzcyBvd25lciwgYnl0ZXMzMiBvcGVyYXRpb24sIHVpbnQgdmFsdWUsIGFkZHJlc3MgdG8sIGJ5dGVzIGRhdGEpOw0KICAgIC8vIENvbmZpcm1hdGlvbiBzdGlsbCBuZWVkZWQgZm9yIGEgdHJhbnNhY3Rpb24uDQogICAgZXZlbnQgQ29uZmlybWF0aW9uTmVlZGVkKGJ5dGVzMzIgb3BlcmF0aW9uLCBhZGRyZXNzIGluaXRpYXRvciwgdWludCB2YWx1ZSwgYWRkcmVzcyB0bywgYnl0ZXMgZGF0YSk7DQoNCiAgICAvLyBGVU5DVElPTlMNCg0KICAgIC8vIFRPRE86IGRvY3VtZW50DQogICAgZnVuY3Rpb24gY2hhbmdlT3duZXIoYWRkcmVzcyBfZnJvbSwgYWRkcmVzcyBfdG8pIGV4dGVybmFsOw0KICAgIGZ1bmN0aW9uIGV4ZWN1dGUoYWRkcmVzcyBfdG8sIHVpbnQgX3ZhbHVlLCBieXRlcyBfZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyAoYnl0ZXMzMik7DQogICAgZnVuY3Rpb24gY29uZmlybShieXRlczMyIF9oKSByZXR1cm5zIChib29sKTsNCn0NCg0KY29udHJhY3QgdG9rZW5zd2FwIGlzIG11bHRpc2lnLCBtdWx0aW93bmVkIHsNCiAgICBUb2tlbiBwdWJsaWMgdG9rZW5DdHI7DQogICAgYm9vbCBwdWJsaWMgdG9rZW5Td2FwOw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFBSRVNBTEVfTEVOR1RIID0gMyBkYXlzOw0KICAgIHVpbnQgcHVibGljIGNvbnN0YW50IFRSQU5TSVRJT05fV0lORE9XID0gMyBob3VyczsgLy8gV2Ugd2lsbCB0dXJuIG9uIHRva2VuU3dhcCBpbiB0aGlzIHBlcmlvZCBhbmQgaXQgd2lsbCAxMjAgRllOIC8gRVRIDQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgU1dBUF9MRU5HVEggPSBQUkVTQUxFX0xFTkdUSCArIFRSQU5TSVRJT05fV0lORE9XICsgNiB3ZWVrcyArIDYgZGF5cyArIDMgaG91cnM7DQogICAgdWludCBwdWJsaWMgY29uc3RhbnQgTUFYX0VUSCA9IDc1MDAwIGV0aGVyOyAvLyBIYXJkIGNhcCwgY2FwcGVkIG90aGVyd2lzZSBieSB0b3RhbCB0b2tlbnMgc29sZCAobWF4IDcuNU0gRllOKQ0KICAgIHVpbnQgcHVibGljIGFtb3VudFJhaXNlZDsNCg0KICAgIG1vZGlmaWVyIGlzVW5kZXJQcmVzYWxlTWluaW11bSB7DQogICAgICAgIGlmICh0b2tlbkN0ci5jcmVhdGlvblRpbWUoKSArIFBSRVNBTEVfTEVOR1RIID4gbm93KSB7DQogICAgICAgICAgICBpZiAobXNnLnZhbHVlIDwgMjAgZXRoZXIpIHRocm93Ow0KICAgICAgICB9DQogICAgICAgIF87DQogICAgfQ0KDQogICAgbW9kaWZpZXIgaXNaZXJvVmFsdWUgew0KICAgICAgICBpZiAobXNnLnZhbHVlID09IDApIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGlzT3ZlckNhcCB7DQogICAgCWlmIChhbW91bnRSYWlzZWQgKyBtc2cudmFsdWUgPiBNQVhfRVRIKSB0aHJvdzsNCiAgICAgICAgXzsNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc092ZXJUb2tlbkNhcCB7DQogICAgICAgIGlmICghc2FmZVRvTXVsdGlwbHkodG9rZW5DdHIuY3VycmVudFN3YXBSYXRlKCksIG1zZy52YWx1ZSkpIHRocm93Ow0KICAgICAgICB1aW50IHRva2Vuc0Ftb3VudCA9IHRva2VuQ3RyLmN1cnJlbnRTd2FwUmF0ZSgpICogbXNnLnZhbHVlOw0KICAgICAgICBpZighc2FmZVRvQWRkKHRva2VuQ3RyLnRvdGFsU3VwcGx5KCksdG9rZW5zQW1vdW50KSkgdGhyb3c7DQogICAgICAgIGlmICh0b2tlbkN0ci50b3RhbFN1cHBseSgpICsgdG9rZW5zQW1vdW50ID4gdG9rZW5DdHIudG9rZW5DYXAoKSkgdGhyb3c7DQogICAgICAgIF87DQoNCiAgICB9DQoNCiAgICBtb2RpZmllciBpc1N3YXBTdG9wcGVkIHsNCiAgICAgICAgaWYgKCF0b2tlblN3YXApIHRocm93Ow0KICAgICAgICBfOw0KICAgIH0NCg0KICAgIG1vZGlmaWVyIGFyZUNvbmRpdGlvbnNTYXRpc2ZpZWQgew0KICAgICAgICBfOw0KICAgICAgICAvLyBFbmQgdG9rZW4gc3dhcCBpZiBzYWxlIHBlcmlvZCBlbmRlZA0KICAgICAgICAvLyBXZSBjYW4ndCB0aHJvdyB0byByZXZlcnNlIHRoZSBhbW91bnQgc2VudCBpbiBvciB3ZSB3aWxsIGxvc2Ugc3RhdGUNCiAgICAgICAgLy8gLCBzbyB3ZSB3aWxsIGFjY2VwdCBpdCBldmVuIHRob3VnaCBpZiBpdCBpcyBhZnRlciBjcm93ZHNhbGUNCiAgICAgICAgaWYgKHRva2VuQ3RyLmNyZWF0aW9uVGltZSgpICsgU1dBUF9MRU5HVEggPCBub3cpIHsNCiAgICAgICAgICAgIHRva2VuQ3RyLmRpc2FibGVUb2tlblN3YXBMb2NrKCk7DQogICAgICAgICAgICB0b2tlblN3YXAgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBDaGVjayBpZiBjYXAgaGFzIGJlZW4gcmVhY2hlZCBpbiB0aGlzIHR4DQogICAgICAgIGlmIChhbW91bnRSYWlzZWQgPT0gTUFYX0VUSCkgew0KICAgICAgICAgICAgdG9rZW5DdHIuZGlzYWJsZVRva2VuU3dhcExvY2soKTsNCiAgICAgICAgICAgIHRva2VuU3dhcCA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2hlY2sgaWYgdG9rZW4gY2FwIGhhcyBiZWVuIHJlYWNoIGluIHRoaXMgdHgNCiAgICAgICAgaWYgKHRva2VuQ3RyLnRvdGFsU3VwcGx5KCkgPT0gdG9rZW5DdHIudG9rZW5DYXAoKSkgew0KICAgICAgICAgICAgdG9rZW5DdHIuZGlzYWJsZVRva2VuU3dhcExvY2soKTsNCiAgICAgICAgICAgIHRva2VuU3dhcCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gQSBoZWxwZXIgdG8gbm90aWZ5IGlmIG92ZXJmbG93IG9jY3VycyBmb3IgYWRkaXRpb24NCiAgICBmdW5jdGlvbiBzYWZlVG9BZGQodWludCBhLCB1aW50IGIpIHByaXZhdGUgY29uc3RhbnQgcmV0dXJucyAoYm9vbCkgew0KICAgICAgcmV0dXJuIChhICsgYiA+PSBhICYmIGEgKyBiID49IGIpOw0KICAgIH0NCiAgDQogICAgLy8gQSBoZWxwZXIgdG8gbm90aWZ5IGlmIG92ZXJmbG93IG9jY3VycyBmb3IgbXVsdGlwbGljYXRpb24NCiAgICBmdW5jdGlvbiBzYWZlVG9NdWx0aXBseSh1aW50IF9hLCB1aW50IF9iKSBwcml2YXRlIGNvbnN0YW50IHJldHVybnMgKGJvb2wpIHsNCiAgICAgIHJldHVybiAoX2IgPT0gMCB8fCAoKF9hICogX2IpIC8gX2IpID09IF9hKTsNCiAgICB9DQoNCg0KICAgIGZ1bmN0aW9uIHN0YXJ0VG9rZW5Td2FwKCkgb25seW93bmVyIHsNCiAgICAgICAgdG9rZW5Td2FwID0gdHJ1ZTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzdG9wVG9rZW5Td2FwKCkgb25seW93bmVyIHsNCiAgICAgICAgdG9rZW5Td2FwID0gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0VG9rZW5Db250cmFjdChhZGRyZXNzIG5ld1Rva2VuQ29udHJhY3RBZGRyKSBvbmx5b3duZXIgew0KICAgICAgICBpZiAobmV3VG9rZW5Db250cmFjdEFkZHIgPT0gYWRkcmVzcygweDApKSB0aHJvdzsNCiAgICAgICAgLy8gQWxsb3cgc2V0dGluZyBvbmx5IG9uY2UNCiAgICAgICAgaWYgKHRva2VuQ3RyICE9IGFkZHJlc3MoMHgwKSkgdGhyb3c7DQoNCiAgICAgICAgdG9rZW5DdHIgPSBUb2tlbihuZXdUb2tlbkNvbnRyYWN0QWRkcik7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYnV5VG9rZW5zKGFkZHJlc3MgX2JlbmVmaWNpYXJ5KQ0KICAgIHBheWFibGUNCiAgICBpc1VuZGVyUHJlc2FsZU1pbmltdW0NCiAgICBpc1plcm9WYWx1ZQ0KICAgIGlzT3ZlckNhcA0KICAgIGlzT3ZlclRva2VuQ2FwDQogICAgaXNTd2FwU3RvcHBlZA0KICAgIGFyZUNvbmRpdGlvbnNTYXRpc2ZpZWQgew0KICAgICAgICBEZXBvc2l0KG1zZy5zZW5kZXIsIG1zZy52YWx1ZSk7DQogICAgICAgIHRva2VuQ3RyLm1pbnRUb2tlbnMoX2JlbmVmaWNpYXJ5LCBtc2cudmFsdWUpOw0KICAgICAgICBpZiAoIXNhZmVUb0FkZChhbW91bnRSYWlzZWQsIG1zZy52YWx1ZSkpIHRocm93Ow0KICAgICAgICBhbW91bnRSYWlzZWQgKz0gbXNnLnZhbHVlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3UmVzZXJ2ZShhZGRyZXNzIF9iZW5lZmljaWFyeSkgb25seW93bmVyIHsNCgkgICAgaWYgKHRva2VuQ3RyLmNyZWF0aW9uVGltZSgpICsgU1dBUF9MRU5HVEggPCBub3cpIHsNCiAgICAgICAgICAgIHRva2VuQ3RyLm1pbnRSZXNlcnZlKF9iZW5lZmljaWFyeSk7DQogICAgICAgIH0NCiAgICB9IA0KfQ0KDQovLyB1c2FnZToNCi8vIGJ5dGVzMzIgaCA9IFdhbGxldCh3KS5mcm9tKG9uZU93bmVyKS50cmFuc2FjdCh0bywgdmFsdWUsIGRhdGEpOw0KLy8gV2FsbGV0KHcpLmZyb20oYW5vdGhlck93bmVyKS5jb25maXJtKGgpOw0KY29udHJhY3QgV2FsbGV0IGlzIG11bHRpc2lnLCBtdWx0aW93bmVkLCBkYXlsaW1pdCwgdG9rZW5zd2FwIHsNCg0KCS8vIFRZUEVTDQoNCiAgICAvLyBUcmFuc2FjdGlvbiBzdHJ1Y3R1cmUgdG8gcmVtZW1iZXIgZGV0YWlscyBvZiB0cmFuc2FjdGlvbiBsZXN0IGl0IG5lZWQgYmUgc2F2ZWQgZm9yIGEgbGF0ZXIgY2FsbC4NCiAgICBzdHJ1Y3QgVHJhbnNhY3Rpb24gew0KICAgICAgICBhZGRyZXNzIHRvOw0KICAgICAgICB1aW50IHZhbHVlOw0KICAgICAgICBieXRlcyBkYXRhOw0KICAgIH0NCg0KICAgIC8vIE1FVEhPRFMNCg0KICAgIC8vIGNvbnN0cnVjdG9yIC0ganVzdCBwYXNzIG9uIHRoZSBvd25lciBhcnJheSB0byB0aGUgbXVsdGlvd25lZCBhbmQNCiAgICAvLyB0aGUgbGltaXQgdG8gZGF5bGltaXQNCiAgICBmdW5jdGlvbiBXYWxsZXQoYWRkcmVzc1tdIF9vd25lcnMsIHVpbnQgX3JlcXVpcmVkLCB1aW50IF9kYXlsaW1pdCkNCiAgICAgICAgICAgIG11bHRpb3duZWQoX293bmVycywgX3JlcXVpcmVkKSBkYXlsaW1pdChfZGF5bGltaXQpIHsNCiAgICB9DQoNCiAgICAvLyBraWxscyB0aGUgY29udHJhY3Qgc2VuZGluZyBldmVyeXRoaW5nIHRvIGBfdG9gLg0KICAgIGZ1bmN0aW9uIGtpbGwoYWRkcmVzcyBfdG8pIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgIC8vIGVuc3VyZSBvd25lcnMgY2FuJ3QgcHJlbWF0dXJlbHkgc3RvcCB0b2tlbiBzYWxlDQogICAgICAgIGlmICh0b2tlblN3YXApIHRocm93Ow0KICAgICAgICAvLyBlbnN1cmUgb3duZXJzIGNhbid0IGtpbGwgd2FsbGV0IHdpdGhvdXQgc3RvcHBpbmcgdG9rZW4NCiAgICAgICAgLy8gIG90aGVyd2lzZSB0b2tlbiBjYW4gbmV2ZXIgYmUgc3RvcHBlZA0KICAgICAgICBpZiAodG9rZW5DdHIudHJhbnNmZXJTdG9wKCkgPT0gZmFsc2UpIHRocm93Ow0KICAgICAgICBzdWljaWRlKF90byk7DQogICAgfQ0KDQogICAgLy8gQWN0aXZhdGVzIEVtZXJnZW5jeSBTdG9wIGZvciBUb2tlbg0KICAgIGZ1bmN0aW9uIHN0b3BUb2tlbigpIG9ubHltYW55b3duZXJzKHNoYTMobXNnLmRhdGEpKSBleHRlcm5hbCB7DQogICAgICAgdG9rZW5DdHIuc3RvcFRva2VuKCk7DQogICAgfQ0KDQogICAgLy8gZ2V0cyBjYWxsZWQgd2hlbiBubyBvdGhlciBmdW5jdGlvbiBtYXRjaGVzDQogICAgZnVuY3Rpb24oKQ0KICAgIHBheWFibGUgew0KICAgICAgICBidXlUb2tlbnMobXNnLnNlbmRlcik7DQogICAgfQ0KDQogICAgLy8gT3V0c2lkZS12aXNpYmxlIHRyYW5zYWN0IGVudHJ5IHBvaW50LiBFeGVjdXRlcyB0cmFuc2FjdGlvbiBpbW1lZGlhdGVseSBpZiBiZWxvdyBkYWlseSBzcGVuZCBsaW1pdC4NCiAgICAvLyBJZiBub3QsIGdvZXMgaW50byBtdWx0aXNpZyBwcm9jZXNzLiBXZSBwcm92aWRlIGEgaGFzaCBvbiByZXR1cm4gdG8gYWxsb3cgdGhlIHNlbmRlciB0byBwcm92aWRlDQogICAgLy8gc2hvcnRjdXRzIGZvciB0aGUgb3RoZXIgY29uZmlybWF0aW9ucyAoYWxsb3dpbmcgdGhlbSB0byBhdm9pZCByZXBsaWNhdGluZyB0aGUgX3RvLCBfdmFsdWUNCiAgICAvLyBhbmQgX2RhdGEgYXJndW1lbnRzKS4gVGhleSBzdGlsbCBnZXQgdGhlIG9wdGlvbiBvZiB1c2luZyB0aGVtIGlmIHRoZXkgd2FudCwgYW55d2F5cy4NCiAgICBmdW5jdGlvbiBleGVjdXRlKGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSwgYnl0ZXMgX2RhdGEpIGV4dGVybmFsIG9ubHlvd25lciByZXR1cm5zIChieXRlczMyIF9yKSB7DQogICAgICAgIC8vIERpc2FsbG93IHRoZSB3YWxsZXQgY29udHJhY3QgZnJvbSBjYWxsaW5nIHRva2VuIGNvbnRyYWN0IG9uY2UgaXQncyBzZXQNCiAgICAgICAgLy8gc28gdG9rZW5zIGNhbid0IGJlIG1pbnRlZCBhcmJpdHJhcmlseSBvbmNlIHRoZSBzYWxlIHN0YXJ0cy4NCiAgICAgICAgLy8gVG9rZW5zIGNhbiBiZSBtaW50ZWQgZm9yIHByZW1pbmUgYmVmb3JlIHRoZSBzYWxlIG9wZW5zIGFuZCB0b2tlbkN0ciBpcyBzZXQuDQogICAgICAgIGlmIChfdG8gPT0gYWRkcmVzcyh0b2tlbkN0cikpIHRocm93Ow0KDQogICAgICAgIC8vIGZpcnN0LCB0YWtlIHRoZSBvcHBvcnR1bml0eSB0byBjaGVjayB0aGF0IHdlJ3JlIHVuZGVyIHRoZSBkYWlseSBsaW1pdC4NCiAgICAgICAgaWYgKHVuZGVyTGltaXQoX3ZhbHVlKSkgew0KICAgICAgICAgICAgU2luZ2xlVHJhbnNhY3QobXNnLnNlbmRlciwgX3ZhbHVlLCBfdG8sIF9kYXRhKTsNCiAgICAgICAgICAgIC8vIHllcyAtIGp1c3QgZXhlY3V0ZSB0aGUgY2FsbC4NCiAgICAgICAgICAgIGlmKCFfdG8uY2FsbC52YWx1ZShfdmFsdWUpKF9kYXRhKSkNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gZGV0ZXJtaW5lIG91ciBvcGVyYXRpb24gaGFzaC4NCiAgICAgICAgX3IgPSBzaGEzKG1zZy5kYXRhLCBibG9jay5udW1iZXIpOw0KICAgICAgICBpZiAoIWNvbmZpcm0oX3IpICYmIG1fdHhzW19yXS50byA9PSAwKSB7DQogICAgICAgICAgICBtX3R4c1tfcl0udG8gPSBfdG87DQogICAgICAgICAgICBtX3R4c1tfcl0udmFsdWUgPSBfdmFsdWU7DQogICAgICAgICAgICBtX3R4c1tfcl0uZGF0YSA9IF9kYXRhOw0KICAgICAgICAgICAgQ29uZmlybWF0aW9uTmVlZGVkKF9yLCBtc2cuc2VuZGVyLCBfdmFsdWUsIF90bywgX2RhdGEpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gY29uZmlybSBhIHRyYW5zYWN0aW9uIHRocm91Z2gganVzdCB0aGUgaGFzaC4gd2UgdXNlIHRoZSBwcmV2aW91cyB0cmFuc2FjdGlvbnMgbWFwLCBtX3R4cywgaW4gb3JkZXINCiAgICAvLyB0byBkZXRlcm1pbmUgdGhlIGJvZHkgb2YgdGhlIHRyYW5zYWN0aW9uIGZyb20gdGhlIGhhc2ggcHJvdmlkZWQuDQogICAgZnVuY3Rpb24gY29uZmlybShieXRlczMyIF9oKSBvbmx5bWFueW93bmVycyhfaCkgcmV0dXJucyAoYm9vbCkgew0KICAgICAgICBpZiAobV90eHNbX2hdLnRvICE9IDApIHsNCiAgICAgICAgICAgIGlmICghbV90eHNbX2hdLnRvLmNhbGwudmFsdWUobV90eHNbX2hdLnZhbHVlKShtX3R4c1tfaF0uZGF0YSkpICAgLy8gQnVnZml4OiBJZiBzdWNjZXNzZnVsLCBNdWx0aVRyYW5zYWN0IGV2ZW50IHNob3VsZCBmaXJlOyBpZiB1bnN1Y2Nlc3NmdWwsIHdlIHNob3VsZCB0aHJvdw0KICAgICAgICAgICAgICAgIHRocm93Ow0KICAgICAgICAgICAgTXVsdGlUcmFuc2FjdChtc2cuc2VuZGVyLCBfaCwgbV90eHNbX2hdLnZhbHVlLCBtX3R4c1tfaF0udG8sIG1fdHhzW19oXS5kYXRhKTsNCiAgICAgICAgICAgIGRlbGV0ZSBtX3R4c1tfaF07DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIElOVEVSTkFMIE1FVEhPRFMNCg0KICAgIGZ1bmN0aW9uIGNsZWFyUGVuZGluZygpIGludGVybmFsIHsNCiAgICAgICAgdWludCBsZW5ndGggPSBtX3BlbmRpbmdJbmRleC5sZW5ndGg7DQogICAgICAgIGZvciAodWludCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKQ0KICAgICAgICAgICAgZGVsZXRlIG1fdHhzW21fcGVuZGluZ0luZGV4W2ldXTsNCiAgICAgICAgc3VwZXIuY2xlYXJQZW5kaW5nKCk7DQogICAgfQ0KDQoJLy8gRklFTERTDQoNCiAgICAvLyBwZW5kaW5nIHRyYW5zYWN0aW9ucyB3ZSBoYXZlIGF0IHByZXNlbnQuDQogICAgbWFwcGluZyAoYnl0ZXMzMiA9PiBUcmFuc2FjdGlvbikgbV90eHM7DQp9'