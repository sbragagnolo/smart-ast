base 64 content
base64wolkExchange
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KLy8gU2FmZU1hdGggVGFrZW4gRnJvbSBGaXJzdEJsb29kDQpjb250cmFjdCBTYWZlTWF0aCB7DQogICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICB1aW50IGMgPSBhICogYjsNCiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2FmZURpdih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICBhc3NlcnQoYiA+IDApOw0KICAgICAgICB1aW50IGMgPSBhIC8gYjsNCiAgICAgICAgYXNzZXJ0KGEgPT0gYiAqIGMgKyBhICUgYik7DQogICAgICAgIHJldHVybiBjOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNhZmVTdWIodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgYXNzZXJ0KGIgPD0gYSk7DQogICAgICAgIHJldHVybiBhIC0gYjsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgICAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgfQ0KfQ0KDQovLyBFUkMyMCBJbnRlcmZhY2UNCmNvbnRyYWN0IEVSQzIwIHsNCiAgICBmdW5jdGlvbiB0b3RhbFN1cHBseSgpIGNvbnN0YW50IHJldHVybnMgKHVpbnQgdG90YWxTdXBwbHkpOw0KICAgIGZ1bmN0aW9uIGJhbGFuY2VPZihhZGRyZXNzIF9vd25lcikgY29uc3RhbnQgcmV0dXJucyAodWludCBiYWxhbmNlKTsNCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludCBfdmFsdWUpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKTsNCiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3MgX3NwZW5kZXIsIHVpbnQgX3ZhbHVlKSByZXR1cm5zIChib29sIHN1Y2Nlc3MpOw0KICAgIGZ1bmN0aW9uIGFsbG93YW5jZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc3BlbmRlcikgY29uc3RhbnQgcmV0dXJucyAodWludCByZW1haW5pbmcpOw0KICAgIGV2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF90bywgdWludCBfdmFsdWUpOw0KICAgIGV2ZW50IEFwcHJvdmFsKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgaW5kZXhlZCBfc3BlbmRlciwgdWludCBfdmFsdWUpOw0KfQ0KDQovLyBFUkMyMFRva2VuDQpjb250cmFjdCBFUkMyMFRva2VuIGlzIEVSQzIwLCBTYWZlTWF0aCB7DQoNCiAgICBtYXBwaW5nKGFkZHJlc3MgPT4gdWludDI1NikgYmFsYW5jZXM7DQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpKSBhbGxvd2VkOw0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsVG9rZW5zOyANCg0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlU3ViKGJhbGFuY2VzW21zZy5zZW5kZXJdLCBfdmFsdWUpOw0KICAgICAgICAgICAgYmFsYW5jZXNbX3RvXSA9IHNhZmVBZGQoYmFsYW5jZXNbX3RvXSwgX3ZhbHVlKTsNCiAgICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gdHJhbnNmZXJGcm9tKGFkZHJlc3MgX2Zyb20sIGFkZHJlc3MgX3RvLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHZhciBfYWxsb3dhbmNlID0gYWxsb3dlZFtfZnJvbV1bbXNnLnNlbmRlcl07DQogICAgICAgIGlmIChiYWxhbmNlc1tfZnJvbV0gPj0gX3ZhbHVlICYmIGFsbG93ZWRbX2Zyb21dW21zZy5zZW5kZXJdID49IF92YWx1ZSAmJiBfdmFsdWUgPiAwKSB7DQogICAgICAgICAgICBiYWxhbmNlc1tfdG9dID0gc2FmZUFkZChiYWxhbmNlc1tfdG9dLCBfdmFsdWUpOw0KICAgICAgICAgICAgYmFsYW5jZXNbX2Zyb21dID0gc2FmZVN1YihiYWxhbmNlc1tfZnJvbV0sIF92YWx1ZSk7DQogICAgICAgICAgICBhbGxvd2VkW19mcm9tXVttc2cuc2VuZGVyXSA9IHNhZmVTdWIoX2FsbG93YW5jZSwgX3ZhbHVlKTsNCiAgICAgICAgICAgIFRyYW5zZmVyKF9mcm9tLCBfdG8sIF92YWx1ZSk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHRvdGFsU3VwcGx5KCkgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gdG90YWxUb2tlbnM7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpIHsNCiAgICAgICAgcmV0dXJuIGJhbGFuY2VzW19vd25lcl07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwcm92ZShhZGRyZXNzIF9zcGVuZGVyLCB1aW50MjU2IF92YWx1ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGFsbG93ZWRbbXNnLnNlbmRlcl1bX3NwZW5kZXJdID0gX3ZhbHVlOw0KICAgICAgICBBcHByb3ZhbChtc2cuc2VuZGVyLCBfc3BlbmRlciwgX3ZhbHVlKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBjb25zdGFudCByZXR1cm5zICh1aW50MjU2IHJlbWFpbmluZykgew0KICAgICAgICByZXR1cm4gYWxsb3dlZFtfb3duZXJdW19zcGVuZGVyXTsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IFdvbGsgaXMgRVJDMjBUb2tlbiB7DQoNCiAgICAvLyBUT0tFTiBJTkZPDQogICAgc3RyaW5nICBwdWJsaWMgY29uc3RhbnQgbmFtZSA9ICJXb2xrIFByb3RvY29sIFRva2VuIjsNCiAgICBzdHJpbmcgIHB1YmxpYyBjb25zdGFudCBzeW1ib2wgPSAiV09MSyI7DQogICAgdWludDI1NiBwdWJsaWMgY29uc3RhbnQgZGVjaW1hbHMgPSAxODsNCg0KICAgIC8vIFJFU0VSVkUNCiAgICB1aW50MjU2IHB1YmxpYyByZXNlcnZlQmFsYW5jZSA9IDA7IA0KICAgIHVpbnQxNiAgcHVibGljIGNvbnN0YW50IHBlcmNlbnRhZ2VFVEhSZXNlcnZlID0gMjA7DQoNCiAgICAvLyBDT05UUkFDVCBPV05FUg0KICAgIGFkZHJlc3MgcHVibGljIG93bmVyID0gbXNnLnNlbmRlcjsgICAgICANCiAgICBhZGRyZXNzIHB1YmxpYyBtdWx0aXNpZ1dhbGxldDsNCiAgICBtb2RpZmllciBvbmx5T3duZXIgeyBhc3NlcnQobXNnLnNlbmRlciA9PSBvd25lcik7IF87IH0NCg0KICAgIC8vIFRPS0VOIEdFTkVSQVRJT04gRVZFTlQNCiAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIGNvbnRyaWJ1dGlvbjsNCiAgICB1aW50MjU2IHB1YmxpYyBjb25zdGFudCB0b2tlbkdlbmVyYXRpb25NaW4gPSA1MCAqIDEwKio2ICogMTAqKmRlY2ltYWxzOw0KICAgIHVpbnQyNTYgcHVibGljIGNvbnN0YW50IHRva2VuR2VuZXJhdGlvbk1heCA9IDUwMCAqIDEwKio2ICogMTAqKmRlY2ltYWxzOw0KICAgIHVpbnQyNTYgcHVibGljIHN0YXJ0X2Jsb2NrOyANCiAgICB1aW50MjU2IHB1YmxpYyBlbmRfYmxvY2s7DQogICAgYm9vbCAgICBwdWJsaWMgc2FsZUNvbXBsZXRlZCA9IGZhbHNlOw0KICAgIG1vZGlmaWVyIGlzVHJhbnNmZXJhYmxlIHsgYXNzZXJ0KHNhbGVDb21wbGV0ZWQpOyBfOyB9DQoNCiAgICAvLyBXT0xLIFNFVFRMRVJTDQogICAgbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSBzZXR0bGVyczsNCiAgICBtb2RpZmllciBvbmx5U2V0dGxlciB7IGFzc2VydChzZXR0bGVyc1ttc2cuc2VuZGVyXSA9PSB0cnVlKTsgXzsgfQ0KDQogICAgLy8gVE9LRU4gR0VORVJBVElPTiBFVkVOVExPRw0KICAgIGV2ZW50IFdvbGtDcmVhdGVkKGFkZHJlc3MgaW5kZXhlZCBfdG8sIHVpbnQyNTYgX3Rva2VuQ3JlYXRlZCk7DQogICAgZXZlbnQgV29sa0Rlc3Ryb3llZChhZGRyZXNzIGluZGV4ZWQgX2Zyb20sIHVpbnQyNTYgX3Rva2VuRGVzdHJveWVkKTsNCiAgICBldmVudCBMb2dSZWZ1bmQoYWRkcmVzcyBpbmRleGVkIF90bywgdWludDI1NiBfdmFsdWUpOw0KDQogICAgLy8gQHBhcmFtIF9zdGFydEJsb2NrDQogICAgLy8gQHBhcmFtIF9lbmRCbG9jaw0KICAgIC8vIEBwYXJhbSBfd29sa1dhbGxldA0KICAgIC8vIEByZXR1cm4gc3VjY2Vzcw0KICAgIC8vIEBkZXYgV29sayBHZW5lc2lzIEV2ZW50IFtvbmx5IGFjY2Vzc2libGUgYnkgQ29udHJhY3QgT3duZXJdDQogICAgZnVuY3Rpb24gd29sa0dlbmVzaXModWludDI1NiBfc3RhcnRCbG9jaywgdWludDI1NiBfZW5kQmxvY2ssIGFkZHJlc3MgX3dvbGtXYWxsZXQpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3Mpew0KICAgICAgICByZXF1aXJlKCAodG90YWxUb2tlbnMgPCAxKSAmJiAoIXNldHRsZXJzW21zZy5zZW5kZXJdKSAmJiAoX2VuZEJsb2NrID4gX3N0YXJ0QmxvY2spICk7DQogICAgICAgIHN0YXJ0X2Jsb2NrID0gX3N0YXJ0QmxvY2s7DQogICAgICAgIGVuZF9ibG9jayA9IF9lbmRCbG9jazsNCiAgICAgICAgbXVsdGlzaWdXYWxsZXQgPSBfd29sa1dhbGxldDsNCiAgICAgICAgc2V0dGxlcnNbbXNnLnNlbmRlcl0gPSB0cnVlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBAcGFyYW0gX25ld093bmVyDQogICAgLy8gQHJldHVybiBzdWNjZXNzDQogICAgLy8gQGRldiBUcmFuc2ZlcmluZyBDb250cmFjdCBPd25lcnNoaXAuIFtvbmx5IGFjY2Vzc2libGUgYnkgY3VycmVudCBDb250cmFjdCBPd25lcl0NCiAgICBmdW5jdGlvbiBjaGFuZ2VPd25lcihhZGRyZXNzIF9uZXdPd25lcikgb25seU93bmVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcyl7DQogICAgICAgIG93bmVyID0gX25ld093bmVyOw0KICAgICAgICBzZXR0bGVyc1tfbmV3T3duZXJdID0gdHJ1ZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8gQGRldiBUb2tlbiBHZW5lcmF0aW9uIEV2ZW50IGZvciBXb2xrIFByb3RvY29sIFRva2VuLiBUR0UgUGFydGljaXBhbnQgc2VuZCBFdGggaW50byB0aGlzIGZ1bmMgaW4gZXhjaGFuZ2Ugb2YgV29sayBQcm90b2NvbCBUb2tlbg0KICAgIGZ1bmN0aW9uIHRva2VuR2VuZXJhdGlvbkV2ZW50KCkgcGF5YWJsZSBleHRlcm5hbCB7DQogICAgICAgIHJlcXVpcmUoIXNhbGVDb21wbGV0ZWQpOw0KICAgICAgICByZXF1aXJlKCAoYmxvY2subnVtYmVyID49IHN0YXJ0X2Jsb2NrKSAmJiAoYmxvY2subnVtYmVyIDw9IGVuZF9ibG9jaykgKTsNCiAgICAgICAgdWludDI1NiB0b2tlbnMgPSBzYWZlTXVsKG1zZy52YWx1ZSwgNSoxMCoqOSk7IC8vZXhjaGFuZ2UgcmF0ZQ0KICAgICAgICB1aW50MjU2IGNoZWNrZWRTdXBwbHkgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCB0b2tlbnMpOw0KICAgICAgICByZXF1aXJlKGNoZWNrZWRTdXBwbHkgPD0gdG9rZW5HZW5lcmF0aW9uTWF4KTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBjaGVja2VkU3VwcGx5Ow0KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIHRva2Vucyk7ICANCiAgICAgICAgY29udHJpYnV0aW9uW21zZy5zZW5kZXJdID0gc2FmZUFkZChjb250cmlidXRpb25bbXNnLnNlbmRlcl0sIG1zZy52YWx1ZSk7ICANCiAgICAgICAgV29sa0NyZWF0ZWQobXNnLnNlbmRlciwgdG9rZW5zKTsgLy8gbG9ncyB0b2tlbiBjcmVhdGlvbg0KICAgIH0NCg0KICAgIC8vIEBkZXYgSWYgVG9rZW4gR2VuZXJhdGlvbiBNaW5pbXVtIGlzIE5vdCBNZXQsIFRHRSBQYXJ0aWNpcGFudHMgY2FuIGNhbGwgdGhpcyBmdW5jIGFuZCByZXF1ZXN0IGZvciByZWZ1bmQNCiAgICBmdW5jdGlvbiByZWZ1bmQoKSBleHRlcm5hbCB7DQogICAgICAgIHJlcXVpcmUoIChjb250cmlidXRpb25bbXNnLnNlbmRlcl0gPiAwKSAmJiAoIXNhbGVDb21wbGV0ZWQpICYmICh0b3RhbFRva2VucyA8IHRva2VuR2VuZXJhdGlvbk1pbikgJiYgKGJsb2NrLm51bWJlciA+IGVuZF9ibG9jaykgKTsNCiAgICAgICAgdWludDI1NiB0b2tlbkJhbGFuY2UgPSBiYWxhbmNlc1ttc2cuc2VuZGVyXTsNCiAgICAgICAgdWludDI1NiByZWZ1bmRCYWxhbmNlID0gY29udHJpYnV0aW9uW21zZy5zZW5kZXJdOw0KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IDA7DQogICAgICAgIGNvbnRyaWJ1dGlvblttc2cuc2VuZGVyXSA9IDA7DQogICAgICAgIHRvdGFsVG9rZW5zID0gc2FmZVN1Yih0b3RhbFRva2VucywgdG9rZW5CYWxhbmNlKTsNCiAgICAgICAgV29sa0Rlc3Ryb3llZChtc2cuc2VuZGVyLCB0b2tlbkJhbGFuY2UpOw0KICAgICAgICBMb2dSZWZ1bmQobXNnLnNlbmRlciwgcmVmdW5kQmFsYW5jZSk7DQogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIocmVmdW5kQmFsYW5jZSk7IA0KICAgIH0NCg0KICAgIC8vIEBkZXYgRmluYWxpemluZyB0aGUgVG9rZW4gR2VuZXJhdGlvbiBFdmVudC4gMjAlIG9mIEV0aCB3aWxsIGJlIGtlcHQgaW4gY29udHJhY3QgdG8gcHJvdmlkZSBsaXF1aWRpdHkNCiAgICBmdW5jdGlvbiBmaW5hbGl6ZSgpIG9ubHlPd25lciB7DQogICAgICAgIHJlcXVpcmUoICghc2FsZUNvbXBsZXRlZCkgJiYgKHRvdGFsVG9rZW5zID49IHRva2VuR2VuZXJhdGlvbk1pbikgKTsNCiAgICAgICAgc2FsZUNvbXBsZXRlZCA9IHRydWU7DQogICAgICAgIGVuZF9ibG9jayA9IGJsb2NrLm51bWJlcjsNCiAgICAgICAgcmVzZXJ2ZUJhbGFuY2UgPSBzYWZlRGl2KHNhZmVNdWwodGhpcy5iYWxhbmNlLCBwZXJjZW50YWdlRVRIUmVzZXJ2ZSksIDEwMCk7DQogICAgICAgIHZhciB3aXRoZHJhd2FsQmFsYW5jZSA9IHNhZmVTdWIodGhpcy5iYWxhbmNlLCByZXNlcnZlQmFsYW5jZSk7DQogICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIod2l0aGRyYXdhbEJhbGFuY2UpOw0KICAgIH0NCn0NCg0KY29udHJhY3QgV29sa1Byb3RvY29sIGlzIFdvbGsgew0KDQogICAgLy8gV09MSyBORVRXT1JLIFBST1RPQ09MDQogICAgdWludDI1NiBwdWJsaWMgYnVybkJhc2lzUG9pbnRzID0gNTAwOyAgLy8gQnVybiByYXRlIChpbiBCUCkgd2hlbiBTZXJ2aWNlIFByb3ZpZGVyIHdpdGhkcmF3cyBmcm9tIGRhdGEgYnV5ZXJzJyBhY2NvdW50cw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gbWFwcGluZyAoYWRkcmVzcyA9PiBib29sKSkgYXV0aG9yaXplZDsgLy8gaG9sZHMgd2hpY2ggYWNjb3VudHMgaGF2ZSBhcHByb3ZlZCB3aGljaCBTZXJ2aWNlIFByb3ZpZGVycw0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgZmVlQmFzaXNQb2ludHM7ICAgLy8gRmVlIChpbiBCUCkgZWFybmVkIGJ5IFNlcnZpY2UgUHJvdmlkZXIgd2hlbiBkZXBvc2l0aW5nIHRvIGRhdGEgc2VsbGVyIA0KDQogICAgLy8gV09MSyBQUk9UT0NPTCBFdmVudHM6DQogICAgZXZlbnQgQXV0aG9yaXplU2VydmljZVByb3ZpZGVyKGFkZHJlc3MgaW5kZXhlZCBfb3duZXIsIGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlcik7DQogICAgZXZlbnQgRGVhdXRob3JpemVTZXJ2aWNlUHJvdmlkZXIoYWRkcmVzcyBpbmRleGVkIF9vd25lciwgYWRkcmVzcyBfc2VydmljZVByb3ZpZGVyKTsNCiAgICBldmVudCBTZXRTZXJ2aWNlUHJvdmlkZXJGZWUoYWRkcmVzcyBpbmRleGVkIF9zZXJ2aWNlUHJvdmlkZXIsIHVpbnQyNTYgX2ZlZUJhc2lzUG9pbnRzKTsNCiAgICBldmVudCBCdXJuVG9rZW5zKGFkZHJlc3MgaW5kZXhlZCBfZnJvbSwgYWRkcmVzcyBpbmRleGVkIF9zZXJ2aWNlUHJvdmlkZXIsIHVpbnQyNTYgX3ZhbHVlKTsNCg0KICAgIC8vIEBwYXJhbSAgX2J1cm5CYXNpc1BvaW50cw0KICAgIC8vIEByZXR1cm4gc3VjY2Vzcw0KICAgIC8vIEBkZXYgU2V0IEJ1cm5SYXRlIG9uIFdvbGsgUHJvdG9jb2wgLS0gb25seSBXb2xrIEZvdW5kYXRpb24gY2FuIHNldCB0aGlzLCBhZmZlY3RzIFNlcnZpY2UgUHJvdmlkZXIgc2V0dGxlQnV5ZXINCiAgICBmdW5jdGlvbiBzZXRCdXJuUmF0ZSh1aW50MjU2IF9idXJuQmFzaXNQb2ludHMpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgcmVxdWlyZSggKF9idXJuQmFzaXNQb2ludHMgPiAwKSAmJiAoX2J1cm5CYXNpc1BvaW50cyA8PSAxMDAwKSApOw0KICAgICAgICBidXJuQmFzaXNQb2ludHMgPSBfYnVybkJhc2lzUG9pbnRzOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBAcGFyYW0gIF9zZXJ2aWNlUHJvdmlkZXINCiAgICAvLyBAcGFyYW0gIF9mZWVCYXNpc1BvaW50cw0KICAgIC8vIEByZXR1cm4gc3VjY2Vzcw0KICAgIC8vIEBkZXYgU2V0IFNlcnZpY2UgUHJvdmlkZXIgZmVlIC0tIG9ubHkgQ29udHJhY3QgT3duZXIgY2FuIGRvIHRoaXMsIGFmZmVjdHMgU2VydmljZSBQcm92aWRlciBzZXR0bGVTZWxsZXINCiAgICBmdW5jdGlvbiBzZXRTZXJ2aWNlRmVlKGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlciwgdWludDI1NiBfZmVlQmFzaXNQb2ludHMpIG9ubHlPd25lciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgaWYgKCBfZmVlQmFzaXNQb2ludHMgPD0gMCB8fCBfZmVlQmFzaXNQb2ludHMgPiA0MDAwKXsNCiAgICAgICAgICAgIC8vIHJldm9rZSBTZXR0bGVyIHByaXZpbGVnZQ0KICAgICAgICAgICAgc2V0dGxlcnNbX3NlcnZpY2VQcm92aWRlcl0gPSBmYWxzZTsNCiAgICAgICAgICAgIGZlZUJhc2lzUG9pbnRzW19zZXJ2aWNlUHJvdmlkZXJdID0gMDsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBmZWVCYXNpc1BvaW50c1tfc2VydmljZVByb3ZpZGVyXSA9IF9mZWVCYXNpc1BvaW50czsNCiAgICAgICAgICAgIHNldHRsZXJzW19zZXJ2aWNlUHJvdmlkZXJdID0gdHJ1ZTsNCiAgICAgICAgICAgIFNldFNlcnZpY2VQcm92aWRlckZlZShfc2VydmljZVByb3ZpZGVyLCBfZmVlQmFzaXNQb2ludHMpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBAcGFyYW0gIF9zZXJ2aWNlUHJvdmlkZXINCiAgICAvLyBAcmV0dXJuIF9mZWVCYXNpc1BvaW50cw0KICAgIC8vIEBkZXYgQ2hlY2sgc2VydmljZSBlZSAoaW4gQlApIGZvciBhIGdpdmVuIHByb3ZpZGVyDQogICAgZnVuY3Rpb24gY2hlY2tTZXJ2aWNlRmVlKGFkZHJlc3MgX3NlcnZpY2VQcm92aWRlcikgY29uc3RhbnQgcmV0dXJucyAodWludDI1NiBfZmVlQmFzaXNQb2ludHMpIHsNCiAgICAgICAgcmV0dXJuIGZlZUJhc2lzUG9pbnRzW19zZXJ2aWNlUHJvdmlkZXJdOw0KICAgIH0NCg0KICAgIC8vIEBwYXJhbSAgX2J1eWVyDQogICAgLy8gQHBhcmFtICBfdmFsdWUNCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MNCiAgICAvLyBAZGV2IFNlcnZpY2UgUHJvdmlkZXIgU2V0dGxlbWVudCB3aXRoIEJ1eWVyOiBhIHNtYWxsIHBlcmNlbnQgaXMgYnVybnQgKHNldCBpbiBzZXRCdXJuUmF0ZSwgc3RvcmVkIGluIGJ1cm5CYXNpc1BvaW50cykgd2hlbiBmdW5kcyBhcmUgdHJhbnNmZXJyZWQgZnJvbSBidXllciB0byBTZXJ2aWNlIFByb3ZpZGVyIFtvbmx5IGFjY2Vzc2libGUgYnkgc2V0dGxlcnNdDQogICAgZnVuY3Rpb24gc2V0dGxlQnV5ZXIoYWRkcmVzcyBfYnV5ZXIsIHVpbnQyNTYgX3ZhbHVlKSBvbmx5U2V0dGxlciByZXR1cm5zIChib29sIHN1Y2Nlc3MpIHsNCiAgICAgICAgcmVxdWlyZSggKGJ1cm5CYXNpc1BvaW50cyA+IDApICYmIChidXJuQmFzaXNQb2ludHMgPD0gMTAwMCkgJiYgYXV0aG9yaXplZFtfYnV5ZXJdW21zZy5zZW5kZXJdICk7IC8vIEJ1eWVyIG11c3QgYXV0aG9yaXplIFNlcnZpY2UgUHJvdmlkZXIgDQogICAgICAgIGlmICggYmFsYW5jZXNbX2J1eWVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgdmFyIGJ1cm5DYXAgPSBzYWZlRGl2KHNhZmVNdWwoX3ZhbHVlLCBidXJuQmFzaXNQb2ludHMpLCAxMDAwMCk7DQogICAgICAgICAgICB2YXIgdHJhbnNmZXJyZWRUb1NlcnZpY2VQcm92aWRlciA9IHNhZmVTdWIoX3ZhbHVlLCBidXJuQ2FwKTsNCiAgICAgICAgICAgIGJhbGFuY2VzW19idXllcl0gPSBzYWZlU3ViKGJhbGFuY2VzW19idXllcl0sIF92YWx1ZSk7DQogICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIHRyYW5zZmVycmVkVG9TZXJ2aWNlUHJvdmlkZXIpOw0KICAgICAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlU3ViKHRvdGFsVG9rZW5zLCBidXJuQ2FwKTsNCiAgICAgICAgICAgIFRyYW5zZmVyKF9idXllciwgbXNnLnNlbmRlciwgdHJhbnNmZXJyZWRUb1NlcnZpY2VQcm92aWRlcik7DQogICAgICAgICAgICBCdXJuVG9rZW5zKF9idXllciwgbXNnLnNlbmRlciwgYnVybkNhcCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0gDQoNCiAgICAvLyBAcGFyYW0gIF9zZWxsZXINCiAgICAvLyBAcGFyYW0gIF92YWx1ZQ0KICAgIC8vIEByZXR1cm4gc3VjY2Vzcw0KICAgIC8vIEBkZXYgU2VydmljZSBQcm92aWRlciBTZXR0bGVtZW50IHdpdGggU2VsbGVyOiBhIHNtYWxsIHBlcmNlbnQgaXMga2VwdCBieSBTZXJ2aWNlIFByb3ZpZGVyIChzZXQgaW4gc2V0U2VydmljZUZlZSwgc3RvcmVkIGluIGZlZUJhc2lzUG9pbnRzKSB3aGVuIGZ1bmRzIGFyZSB0cmFuc2ZlcnJlZCBmcm9tIFNlcnZpY2UgUHJvdmlkZXIgdG8gc2VsbGVyIFtvbmx5IGFjY2Vzc2libGUgYnkgc2V0dGxlcnNdDQogICAgZnVuY3Rpb24gc2V0dGxlU2VsbGVyKGFkZHJlc3MgX3NlbGxlciwgdWludDI1NiBfdmFsdWUpIG9ubHlTZXR0bGVyIHJldHVybnMgKGJvb2wgc3VjY2Vzcykgew0KICAgICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBoYXZlIGEgJSBmZWUgZm9yIFNlbGxlcnMgKGUuZy4gMjAlKQ0KICAgICAgICB2YXIgc2VydmljZVByb3ZpZGVyQlAgPSBmZWVCYXNpc1BvaW50c1ttc2cuc2VuZGVyXTsNCiAgICAgICAgcmVxdWlyZSggKHNlcnZpY2VQcm92aWRlckJQID4gMCkgJiYgKHNlcnZpY2VQcm92aWRlckJQIDw9IDQwMDApICk7DQogICAgICAgIGlmIChiYWxhbmNlc1ttc2cuc2VuZGVyXSA+PSBfdmFsdWUgJiYgX3ZhbHVlID4gMCkgew0KICAgICAgICAgICAgdmFyIGZlZSA9IHNhZmVEaXYoc2FmZU11bChfdmFsdWUsIHNlcnZpY2VQcm92aWRlckJQKSwgMTAwMDApOw0KICAgICAgICAgICAgdmFyIHRyYW5zZmVycmVkVG9TZWxsZXIgPSBzYWZlU3ViKF92YWx1ZSwgZmVlKTsNCiAgICAgICAgICAgIGJhbGFuY2VzW19zZWxsZXJdID0gc2FmZUFkZChiYWxhbmNlc1tfc2VsbGVyXSwgdHJhbnNmZXJyZWRUb1NlbGxlcik7DQogICAgICAgICAgICBUcmFuc2Zlcihtc2cuc2VuZGVyLCBfc2VsbGVyLCB0cmFuc2ZlcnJlZFRvU2VsbGVyKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gQHBhcmFtIF9wcm92aWRlclRvQWRkDQogICAgLy8gQHJldHVybiBzdWNjZXNzDQogICAgLy8gQGRldiBCdXllciBhdXRob3JpemVzIHRoZSBTZXJ2aWNlIFByb3ZpZGVyICh0byBjYWxsIHNldHRsZUJ1eWVyKS4gRm9yIHNlY3VyaXR5IHJlYXNvbiwgX3Byb3ZpZGVyVG9BZGQgbmVlZHMgdG8gYmUgd2hpdGVsaXN0ZWQgYnkgV29sayBGb3VuZGF0aW9uIGZpcnN0DQogICAgZnVuY3Rpb24gYXV0aG9yaXplUHJvdmlkZXIoYWRkcmVzcyBfcHJvdmlkZXJUb0FkZCkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHJlcXVpcmUoc2V0dGxlcnNbX3Byb3ZpZGVyVG9BZGRdKTsNCiAgICAgICAgYXV0aG9yaXplZFttc2cuc2VuZGVyXVtfcHJvdmlkZXJUb0FkZF0gPSB0cnVlOw0KICAgICAgICBBdXRob3JpemVTZXJ2aWNlUHJvdmlkZXIobXNnLnNlbmRlciwgX3Byb3ZpZGVyVG9BZGQpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBAcGFyYW0gX3Byb3ZpZGVyVG9SZW1vdmUNCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MNCiAgICAvLyBAZGV2IEJ1eWVyIGRlYXV0aG9yaXplcyB0aGUgU2VydmljZSBQcm92aWRlciAoZnJvbSBjYWxsaW5nIHNldHRsZUJ1eWVyKQ0KICAgIGZ1bmN0aW9uIGRlYXV0aG9yaXplUHJvdmlkZXIoYWRkcmVzcyBfcHJvdmlkZXJUb1JlbW92ZSkgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIGF1dGhvcml6ZWRbbXNnLnNlbmRlcl1bX3Byb3ZpZGVyVG9SZW1vdmVdID0gZmFsc2U7DQogICAgICAgIERlYXV0aG9yaXplU2VydmljZVByb3ZpZGVyKG1zZy5zZW5kZXIsIF9wcm92aWRlclRvUmVtb3ZlKTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLy8gQHBhcmFtIF9vd25lcg0KICAgIC8vIEBwYXJhbSBfc2VydmljZVByb3ZpZGVyDQogICAgLy8gQHJldHVybiBhdXRob3JpemF0aW9uU3RhdHVzDQogICAgLy8gQGRldiBDaGVjayBhdXRob3JpemF0aW9uIGJldHdlZW4gYWNjb3VudCBhbmQgU2VydmljZSBQcm92aWRlcg0KICAgIGZ1bmN0aW9uIGNoZWNrQXV0aG9yaXphdGlvbihhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfc2VydmljZVByb3ZpZGVyKSBjb25zdGFudCByZXR1cm5zIChib29sIGF1dGhvcml6YXRpb25TdGF0dXMpIHsNCiAgICAgICAgcmV0dXJuIGF1dGhvcml6ZWRbX293bmVyXVtfc2VydmljZVByb3ZpZGVyXTsNCiAgICB9DQoNCiAgICAvLyBAcGFyYW0gX293bmVyDQogICAgLy8gQHBhcmFtIF9wcm92aWRlclRvQWRkDQogICAgLy8gQHJldHVybiBhdXRob3JpemF0aW9uU3RhdHVzDQogICAgLy8gQGRldiBHcmFudCBhdXRob3JpemF0aW9uIGJldHdlZW4gYWNjb3VudCBhbmQgU2VydmljZSBQcm92aWRlciBvbiBidXllcnMnIGJlaGFsZiBbb25seSBhY2Nlc3NpYmxlIGJ5IENvbnRyYWN0IE93bmVyXQ0KICAgIC8vIEBub3RlIEV4cGxpY2l0IHBlcm1pc3Npb24gZnJvbSBiYWxhbmNlIG93bmVyIE1VU1QgYmUgb2J0YWluZWQgYmVmb3JlaGFuZA0KICAgIGZ1bmN0aW9uIGdyYW50U2VydmljZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfcHJvdmlkZXJUb0FkZCkgb25seU93bmVyIHJldHVybnMgKGJvb2wgYXV0aG9yaXphdGlvblN0YXR1cykgew0KICAgICAgICB2YXIgaXNQcmVhdXRob3JpemVkID0gYXV0aG9yaXplZFtfb3duZXJdW21zZy5zZW5kZXJdOw0KICAgICAgICBpZiAoaXNQcmVhdXRob3JpemVkICYmIHNldHRsZXJzW19wcm92aWRlclRvQWRkXSApIHsNCiAgICAgICAgICAgIGF1dGhvcml6ZWRbX293bmVyXVtfcHJvdmlkZXJUb0FkZF0gPSB0cnVlOw0KICAgICAgICAgICAgQXV0aG9yaXplU2VydmljZVByb3ZpZGVyKG1zZy5zZW5kZXIsIF9wcm92aWRlclRvQWRkKTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIEBwYXJhbSBfb3duZXINCiAgICAvLyBAcGFyYW0gX3Byb3ZpZGVyVG9SZW1vdmUNCiAgICAvLyBAcmV0dXJuIGF1dGhvcml6YXRpb25fc3RhdHVzDQogICAgLy8gQGRldiBSZXZva2UgYXV0aG9yaXphdGlvbiBiZXR3ZWVuIGFjY291bnQgYW5kIFNlcnZpY2UgUHJvdmlkZXIgb24gYnV5ZXJzJyBiZWhhbGYgW29ubHkgYWNjZXNzaWJsZSBieSBDb250cmFjdCBPd25lcl0NCiAgICAvLyBAbm90ZSBFeHBsaWNpdCBwZXJtaXNzaW9uIGZyb20gYmFsYW5jZSBvd25lciBhcmUgTk9UIHJlcXVpcmVkIGZvciBkaXNhYmxpbmcgaWxsLWludGVudCBTZXJ2aWNlIFByb3ZpZGVyDQogICAgZnVuY3Rpb24gcmVtb3ZlU2VydmljZShhZGRyZXNzIF9vd25lciwgYWRkcmVzcyBfcHJvdmlkZXJUb1JlbW92ZSkgb25seU93bmVyIHJldHVybnMgKGJvb2wgYXV0aG9yaXphdGlvblN0YXR1cykgew0KICAgICAgICBhdXRob3JpemVkW19vd25lcl1bX3Byb3ZpZGVyVG9SZW1vdmVdID0gZmFsc2U7DQogICAgICAgIERlYXV0aG9yaXplU2VydmljZVByb3ZpZGVyKF9vd25lciwgX3Byb3ZpZGVyVG9SZW1vdmUpOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQp9DQoNCmNvbnRyYWN0IEJhbmNvckZvcm11bGEgaXMgU2FmZU1hdGggew0KDQogICAgLy8gVGFrZW4gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vYmFuY29ycHJvdG9jb2wvY29udHJhY3RzL2Jsb2IvbWFzdGVyL3NvbGlkaXR5L2NvbnRyYWN0cy9CYW5jb3JGb3JtdWxhLnNvbA0KICAgIHVpbnQ4IGNvbnN0YW50IFBSRUNJU0lPTiAgID0gMzI7ICAvLyBmcmFjdGlvbmFsIGJpdHMNCiAgICB1aW50MjU2IGNvbnN0YW50IEZJWEVEX09ORSA9IHVpbnQyNTYoMSkgPDwgUFJFQ0lTSU9OOyAvLyAweDEwMDAwMDAwMA0KICAgIHVpbnQyNTYgY29uc3RhbnQgRklYRURfVFdPID0gdWludDI1NigyKSA8PCBQUkVDSVNJT047IC8vIDB4MjAwMDAwMDAwDQogICAgdWludDI1NiBjb25zdGFudCBNQVhfVkFMICAgPSB1aW50MjU2KDEpIDw8ICgyNTYgLSBQUkVDSVNJT04pOyAvLyAweDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDANCg0KICAgIC8qKg0KICAgICAgICBAZGV2IGdpdmVuIGEgdG9rZW4gc3VwcGx5LCByZXNlcnZlLCBDUlIgYW5kIGEgZGVwb3NpdCBhbW91bnQgKGluIHRoZSByZXNlcnZlIHRva2VuKSwgY2FsY3VsYXRlcyB0aGUgcmV0dXJuIGZvciBhIGdpdmVuIGNoYW5nZSAoaW4gdGhlIG1haW4gdG9rZW4pDQoNCiAgICAgICAgRm9ybXVsYToNCiAgICAgICAgUmV0dXJuID0gX3N1cHBseSAqICgoMSArIF9kZXBvc2l0QW1vdW50IC8gX3Jlc2VydmVCYWxhbmNlKSBeIChfcmVzZXJ2ZVJhdGlvIC8gMTAwKSAtIDEpDQoNCiAgICAgICAgQHBhcmFtIF9zdXBwbHkgICAgICAgICAgICAgdG9rZW4gdG90YWwgc3VwcGx5DQogICAgICAgIEBwYXJhbSBfcmVzZXJ2ZUJhbGFuY2UgICAgIHRvdGFsIHJlc2VydmUNCiAgICAgICAgQHBhcmFtIF9yZXNlcnZlUmF0aW8gICAgICAgY29uc3RhbnQgcmVzZXJ2ZSByYXRpbywgMS0xMDANCiAgICAgICAgQHBhcmFtIF9kZXBvc2l0QW1vdW50ICAgICAgZGVwb3NpdCBhbW91bnQsIGluIHJlc2VydmUgdG9rZW4NCg0KICAgICAgICBAcmV0dXJuIHB1cmNoYXNlIHJldHVybiBhbW91bnQNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVB1cmNoYXNlUmV0dXJuKHVpbnQyNTYgX3N1cHBseSwgdWludDI1NiBfcmVzZXJ2ZUJhbGFuY2UsIHVpbnQxNiBfcmVzZXJ2ZVJhdGlvLCB1aW50MjU2IF9kZXBvc2l0QW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICAvLyB2YWxpZGF0ZSBpbnB1dA0KICAgICAgICByZXF1aXJlKF9zdXBwbHkgIT0gMCAmJiBfcmVzZXJ2ZUJhbGFuY2UgIT0gMCAmJiBfcmVzZXJ2ZVJhdGlvID4gMCAmJiBfcmVzZXJ2ZVJhdGlvIDw9IDEwMCk7DQoNCiAgICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciAwIGRlcG9zaXQgYW1vdW50DQogICAgICAgIGlmIChfZGVwb3NpdEFtb3VudCA9PSAwKQ0KICAgICAgICAgICAgcmV0dXJuIDA7DQoNCiAgICAgICAgdWludDI1NiBiYXNlTiA9IHNhZmVBZGQoX2RlcG9zaXRBbW91bnQsIF9yZXNlcnZlQmFsYW5jZSk7DQogICAgICAgIHVpbnQyNTYgdGVtcDsNCg0KICAgICAgICAvLyBzcGVjaWFsIGNhc2UgaWYgdGhlIENSUiA9IDEwMA0KICAgICAgICBpZiAoX3Jlc2VydmVSYXRpbyA9PSAxMDApIHsNCiAgICAgICAgICAgIHRlbXAgPSBzYWZlTXVsKF9zdXBwbHksIGJhc2VOKSAvIF9yZXNlcnZlQmFsYW5jZTsNCiAgICAgICAgICAgIHJldHVybiBzYWZlU3ViKHRlbXAsIF9zdXBwbHkpOyANCiAgICAgICAgfQ0KDQogICAgICAgIHVpbnQyNTYgcmVzTiA9IHBvd2VyKGJhc2VOLCBfcmVzZXJ2ZUJhbGFuY2UsIF9yZXNlcnZlUmF0aW8sIDEwMCk7DQoNCiAgICAgICAgdGVtcCA9IHNhZmVNdWwoX3N1cHBseSwgcmVzTikgLyBGSVhFRF9PTkU7DQoNCiAgICAgICAgdWludDI1NiByZXN1bHQgPSAgc2FmZVN1Yih0ZW1wLCBfc3VwcGx5KTsNCiAgICAgICAgLy8gZnJvbSB0aGUgcmVzdWx0LCB3ZSBkZWR1Y3QgdGhlIG1pbmltYWwgaW5jcmVtZW50LCB3aGljaCBpcyBhICAgICAgICAgDQogICAgICAgIC8vIGZ1bmN0aW9uIG9mIFMgYW5kIHByZWNpc2lvbi4gICAgICAgDQogICAgICAgIHJldHVybiBzYWZlU3ViKHJlc3VsdCwgX3N1cHBseSAvIDB4MTAwMDAwMDAwKTsNCiAgICAgfQ0KDQogICAgLyoqDQogICAgICAgIEBkZXYgZ2l2ZW4gYSB0b2tlbiBzdXBwbHksIHJlc2VydmUsIENSUiBhbmQgYSBzZWxsIGFtb3VudCAoaW4gdGhlIG1haW4gdG9rZW4pLCBjYWxjdWxhdGVzIHRoZSByZXR1cm4gZm9yIGEgZ2l2ZW4gY2hhbmdlIChpbiB0aGUgcmVzZXJ2ZSB0b2tlbikNCg0KICAgICAgICBGb3JtdWxhOg0KICAgICAgICBSZXR1cm4gPSBfcmVzZXJ2ZUJhbGFuY2UgKiAoMSAtICgxIC0gX3NlbGxBbW91bnQgLyBfc3VwcGx5KSBeICgxIC8gKF9yZXNlcnZlUmF0aW8gLyAxMDApKSkNCg0KICAgICAgICBAcGFyYW0gX3N1cHBseSAgICAgICAgICAgICB0b2tlbiB0b3RhbCBzdXBwbHkNCiAgICAgICAgQHBhcmFtIF9yZXNlcnZlQmFsYW5jZSAgICAgdG90YWwgcmVzZXJ2ZQ0KICAgICAgICBAcGFyYW0gX3Jlc2VydmVSYXRpbyAgICAgICBjb25zdGFudCByZXNlcnZlIHJhdGlvLCAxLTEwMA0KICAgICAgICBAcGFyYW0gX3NlbGxBbW91bnQgICAgICAgICBzZWxsIGFtb3VudCwgaW4gdGhlIHRva2VuIGl0c2VsZg0KDQogICAgICAgIEByZXR1cm4gc2FsZSByZXR1cm4gYW1vdW50DQogICAgKi8NCiAgICBmdW5jdGlvbiBjYWxjdWxhdGVTYWxlUmV0dXJuKHVpbnQyNTYgX3N1cHBseSwgdWludDI1NiBfcmVzZXJ2ZUJhbGFuY2UsIHVpbnQxNiBfcmVzZXJ2ZVJhdGlvLCB1aW50MjU2IF9zZWxsQW1vdW50KSBwdWJsaWMgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICAvLyB2YWxpZGF0ZSBpbnB1dA0KICAgICAgICByZXF1aXJlKF9zdXBwbHkgIT0gMCAmJiBfcmVzZXJ2ZUJhbGFuY2UgIT0gMCAmJiBfcmVzZXJ2ZVJhdGlvID4gMCAmJiBfcmVzZXJ2ZVJhdGlvIDw9IDEwMCAmJiBfc2VsbEFtb3VudCA8PSBfc3VwcGx5KTsNCg0KICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIDAgc2VsbCBhbW91bnQNCiAgICAgICAgaWYgKF9zZWxsQW1vdW50ID09IDApDQogICAgICAgICAgICByZXR1cm4gMDsNCg0KICAgICAgICB1aW50MjU2IGJhc2VOID0gc2FmZVN1Yihfc3VwcGx5LCBfc2VsbEFtb3VudCk7DQogICAgICAgIHVpbnQyNTYgdGVtcDE7DQogICAgICAgIHVpbnQyNTYgdGVtcDI7DQoNCiAgICAgICAgLy8gc3BlY2lhbCBjYXNlIGlmIHRoZSBDUlIgPSAxMDANCiAgICAgICAgaWYgKF9yZXNlcnZlUmF0aW8gPT0gMTAwKSB7DQogICAgICAgICAgICB0ZW1wMSA9IHNhZmVNdWwoX3Jlc2VydmVCYWxhbmNlLCBfc3VwcGx5KTsNCiAgICAgICAgICAgIHRlbXAyID0gc2FmZU11bChfcmVzZXJ2ZUJhbGFuY2UsIGJhc2VOKTsNCiAgICAgICAgICAgIHJldHVybiBzYWZlU3ViKHRlbXAxLCB0ZW1wMikgLyBfc3VwcGx5Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciBzZWxsaW5nIHRoZSBlbnRpcmUgc3VwcGx5DQogICAgICAgIGlmIChfc2VsbEFtb3VudCA9PSBfc3VwcGx5KQ0KICAgICAgICAgICAgcmV0dXJuIF9yZXNlcnZlQmFsYW5jZTsNCg0KICAgICAgICB1aW50MjU2IHJlc04gPSBwb3dlcihfc3VwcGx5LCBiYXNlTiwgMTAwLCBfcmVzZXJ2ZVJhdGlvKTsNCg0KICAgICAgICB0ZW1wMSA9IHNhZmVNdWwoX3Jlc2VydmVCYWxhbmNlLCByZXNOKTsNCiAgICAgICAgdGVtcDIgPSBzYWZlTXVsKF9yZXNlcnZlQmFsYW5jZSwgRklYRURfT05FKTsNCg0KICAgICAgICB1aW50MjU2IHJlc3VsdCA9IHNhZmVTdWIodGVtcDEsIHRlbXAyKSAvIHJlc047DQoNCiAgICAgICAgLy8gZnJvbSB0aGUgcmVzdWx0LCB3ZSBkZWR1Y3QgdGhlIG1pbmltYWwgaW5jcmVtZW50LCB3aGljaCBpcyBhICAgICAgICAgDQogICAgICAgIC8vIGZ1bmN0aW9uIG9mIFIgYW5kIHByZWNpc2lvbi4gICAgICAgDQogICAgICAgIHJldHVybiBzYWZlU3ViKHJlc3VsdCwgX3Jlc2VydmVCYWxhbmNlIC8gMHgxMDAwMDAwMDApOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBAZGV2IENhbGN1bGF0ZSAoX2Jhc2VOIC8gX2Jhc2VEKSBeIChfZXhwTiAvIF9leHBEKQ0KICAgICAgICBSZXR1cm5zIHJlc3VsdCB1cHNoaWZ0ZWQgYnkgUFJFQ0lTSU9ODQoNCiAgICAgICAgVGhpcyBtZXRob2QgaXMgb3ZlcmZsb3ctc2FmZQ0KICAgICovIA0KICAgIGZ1bmN0aW9uIHBvd2VyKHVpbnQyNTYgX2Jhc2VOLCB1aW50MjU2IF9iYXNlRCwgdWludDMyIF9leHBOLCB1aW50MzIgX2V4cEQpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgcmVzTikgew0KICAgICAgICB1aW50MjU2IGxvZ2Jhc2UgPSBsbihfYmFzZU4sIF9iYXNlRCk7DQogICAgICAgIC8vIE5vdCB1c2luZyBzYWZlRGl2IGhlcmUsIHNpbmNlIHNhZmVEaXYgcHJvdGVjdHMgYWdhaW5zdA0KICAgICAgICAvLyBwcmVjaXNpb24gbG9zcy4gSXTigJlzIHVuYXZvaWRhYmxlLCBob3dldmVyDQogICAgICAgIC8vIEJvdGggYGxuYCBhbmQgYGZpeGVkRXhwYCBhcmUgb3ZlcmZsb3ctc2FmZS4gDQogICAgICAgIHJlc04gPSBmaXhlZEV4cChzYWZlTXVsKGxvZ2Jhc2UsIF9leHBOKSAvIF9leHBEKTsNCiAgICAgICAgcmV0dXJuIHJlc047DQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAgICBpbnB1dCByYW5nZTogDQogICAgICAgICAgICAtIG51bWVyYXRvcjogWzEsIHVpbnQyNTZfbWF4ID4+IFBSRUNJU0lPTl0gICAgDQogICAgICAgICAgICAtIGRlbm9taW5hdG9yOiBbMSwgdWludDI1Nl9tYXggPj4gUFJFQ0lTSU9OXQ0KICAgICAgICBvdXRwdXQgcmFuZ2U6DQogICAgICAgICAgICBbMCwgMHg5YjQzZDRmOGQ2XQ0KDQogICAgICAgIFRoaXMgbWV0aG9kIGFzc2VydHMgb3V0c2lkZSBvZiBib3VuZHMNCg0KICAgICovDQogICAgZnVuY3Rpb24gbG4odWludDI1NiBfbnVtZXJhdG9yLCB1aW50MjU2IF9kZW5vbWluYXRvcikgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICAvLyBkZW5vbWluYXRvciA+IG51bWVyYXRvcjogbGVzcyB0aGFuIG9uZSB5aWVsZHMgbmVnYXRpdmUgdmFsdWVzLiBVbnN1cHBvcnRlZA0KICAgICAgICBhc3NlcnQoX2Rlbm9taW5hdG9yIDw9IF9udW1lcmF0b3IpOw0KDQogICAgICAgIC8vIGxvZygxKSBpcyB0aGUgbG93ZXN0IHdlIGNhbiBnbw0KICAgICAgICBhc3NlcnQoX2Rlbm9taW5hdG9yICE9IDAgJiYgX251bWVyYXRvciAhPSAwKTsNCg0KICAgICAgICAvLyBVcHBlciAzMiBiaXRzIGFyZSBzY2FsZWQgb2ZmIGJ5IFBSRUNJU0lPTg0KICAgICAgICBhc3NlcnQoX251bWVyYXRvciA8IE1BWF9WQUwpOw0KICAgICAgICBhc3NlcnQoX2Rlbm9taW5hdG9yIDwgTUFYX1ZBTCk7DQoNCiAgICAgICAgcmV0dXJuIGZpeGVkTG9nZSggKF9udW1lcmF0b3IgKiBGSVhFRF9PTkUpIC8gX2Rlbm9taW5hdG9yKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgICAgaW5wdXQgcmFuZ2U6IA0KICAgICAgICAgICAgWzB4MTAwMDAwMDAwLHVpbnQyNTZfbWF4XQ0KICAgICAgICBvdXRwdXQgcmFuZ2U6DQogICAgICAgICAgICBbMCwgMHg5YjQzZDRmOGQ2XQ0KDQogICAgICAgIFRoaXMgbWV0aG9kIGFzc2VydHMgb3V0c2lkZSBvZiBib3VuZHMNCg0KICAgICovDQogICAgZnVuY3Rpb24gZml4ZWRMb2dlKHVpbnQyNTYgX3gpIGludGVybmFsIHJldHVybnMgKHVpbnQyNTYgbG9nRSkgew0KICAgICAgICAvKg0KICAgICAgICBTaW5jZSBgZml4ZWRMb2cyX21pbmAgb3V0cHV0IHJhbmdlIGlzIG1heCBgMHhkZmZmZmZmZmZmYCANCiAgICAgICAgKDQwIGJpdHMsIG9yIDUgYnl0ZXMpLCB3ZSBjYW4gdXNlIGEgdmVyeSBsYXJnZSBhcHByb3hpbWF0aW9uDQogICAgICAgIGZvciBgbG4oMilgLiBUaGlzIG9uZSBpcyB1c2VkIHNpbmNlIGl04oCZcyB0aGUgbWF4IGFjY3VyYWN5IA0KICAgICAgICBvZiBQeXRob24gYGxuKDIpYA0KDQogICAgICAgIDB4YjE3MjE3ZjdkMWNmNzggPSBsbigyKSAqICgxIDw8IDU2KQ0KICAgICAgICANCiAgICAgICAgKi8NCiAgICAgICAgLy9DYW5ub3QgcmVwcmVzZW50IG5lZ2F0aXZlIG51bWJlcnMgKGJlbG93IDEpDQogICAgICAgIGFzc2VydChfeCA+PSBGSVhFRF9PTkUpOw0KDQogICAgICAgIHVpbnQyNTYgbG9nMiA9IGZpeGVkTG9nMihfeCk7DQogICAgICAgIGxvZ0UgPSAobG9nMiAqIDB4YjE3MjE3ZjdkMWNmNzgpID4+IDU2Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBSZXR1cm5zIGxvZzIoeCA+PiAzMikgPDwgMzIgWzFdDQogICAgICAgIFNvIHggaXMgYXNzdW1lZCB0byBiZSBhbHJlYWR5IHVwc2hpZnRlZCAzMiBiaXRzLCBhbmQgDQogICAgICAgIHRoZSByZXN1bHQgaXMgYWxzbyB1cHNoaWZ0ZWQgMzIgYml0cy4gDQogICAgICAgIA0KICAgICAgICBbMV0gVGhlIGZ1bmN0aW9uIHJldHVybnMgYSBudW1iZXIgd2hpY2ggaXMgbG93ZXIgdGhhbiB0aGUgDQogICAgICAgIGFjdHVhbCB2YWx1ZQ0KDQogICAgICAgIGlucHV0LXJhbmdlIDogDQogICAgICAgICAgICBbMHgxMDAwMDAwMDAsdWludDI1Nl9tYXhdDQogICAgICAgIG91dHB1dC1yYW5nZTogDQogICAgICAgICAgICBbMCwweGRmZmZmZmZmZmZdDQoNCiAgICAgICAgVGhpcyBtZXRob2QgYXNzZXJ0cyBvdXRzaWRlIG9mIGJvdW5kcw0KDQogICAgKi8NCiAgICBmdW5jdGlvbiBmaXhlZExvZzIodWludDI1NiBfeCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICAvLyBOdW1iZXJzIGJlbG93IDEgYXJlIG5lZ2F0aXZlLiANCiAgICAgICAgYXNzZXJ0KCBfeCA+PSBGSVhFRF9PTkUpOw0KDQogICAgICAgIHVpbnQyNTYgaGkgPSAwOw0KICAgICAgICB3aGlsZSAoX3ggPj0gRklYRURfVFdPKSB7DQogICAgICAgICAgICBfeCA+Pj0gMTsNCiAgICAgICAgICAgIGhpICs9IEZJWEVEX09ORTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvciAodWludDggaSA9IDA7IGkgPCBQUkVDSVNJT047ICsraSkgew0KICAgICAgICAgICAgX3ggPSAoX3ggKiBfeCkgLyBGSVhFRF9PTkU7DQogICAgICAgICAgICBpZiAoX3ggPj0gRklYRURfVFdPKSB7DQogICAgICAgICAgICAgICAgX3ggPj49IDE7DQogICAgICAgICAgICAgICAgaGkgKz0gdWludDI1NigxKSA8PCAoUFJFQ0lTSU9OIC0gMSAtIGkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGhpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBmaXhlZEV4cCBpcyBhIOKAmHByb3RlY3RlZOKAmSB2ZXJzaW9uIG9mIGBmaXhlZEV4cFVuc2FmZWAsIHdoaWNoIA0KICAgICAgICBhc3NlcnRzIGluc3RlYWQgb2Ygb3ZlcmZsb3dzDQogICAgKi8NCiAgICBmdW5jdGlvbiBmaXhlZEV4cCh1aW50MjU2IF94KSBpbnRlcm5hbCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgICAgIGFzc2VydChfeCA8PSAweDM4NmJmZGJhMjkpOw0KICAgICAgICByZXR1cm4gZml4ZWRFeHBVbnNhZmUoX3gpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgICBmaXhlZEV4cCANCiAgICAgICAgQ2FsY3VsYXRlcyBlXnggYWNjb3JkaW5nIHRvIG1hY2xhdXJlbiBzdW1tYXRpb246DQoNCiAgICAgICAgZV54ID0gMSt4K3heMi8yIS4uLit4Xm4vbiENCg0KICAgICAgICBhbmQgcmV0dXJucyBlXih4Pj4zMikgPDwgMzIsIHRoYXQgaXMsIHVwc2hpZnRlZCBmb3IgYWNjdXJhY3kNCg0KICAgICAgICBJbnB1dCByYW5nZToNCiAgICAgICAgICAgIC0gRnVuY3Rpb24gb2sgYXQgICAgPD0gMjQyMzI5OTU4OTUzIA0KICAgICAgICAgICAgLSBGdW5jdGlvbiBmYWlscyBhdCA+PSAyNDIzMjk5NTg5NTQNCg0KICAgICAgICBUaGlzIG1ldGhvZCBpcyBpcyB2aXNpYmxlIGZvciB0ZXN0Y2FzZXMsIGJ1dCBub3QgbWVhbnQgZm9yIGRpcmVjdCB1c2UuIA0KIA0KICAgICAgICBUaGUgdmFsdWVzIGluIHRoaXMgbWV0aG9kIGJlZW4gZ2VuZXJhdGVkIHZpYSB0aGUgZm9sbG93aW5nIHB5dGhvbiBzbmlwcGV0OiANCg0KICAgICAgICBkZWYgY2FsY3VsYXRlRmFjdG9yaWFscygpOg0KICAgICAgICAgICAg4oCc4oCdIk1ldGhvZCB0byBwcmludCBvdXQgdGhlIGZhY3RvcmlhbHMgZm9yIGZpeGVkRXhw4oCd4oCc4oCdDQoNCiAgICAgICAgICAgIG5pID0gW10NCiAgICAgICAgICAgIG5pLmFwcGVuZCggMjk1MjMyNzk5MDM5NjA0MTQwODQ3NjE4NjA5NjQzNTIwMDAwMDAwKSAjIDM0IQ0KICAgICAgICAgICAgSVRFUkFUSU9OUyA9IDM0DQogICAgICAgICAgICBmb3IgbiBpbiByYW5nZSggMSwgIElURVJBVElPTlMsMSApIDoNCiAgICAgICAgICAgICAgICBuaS5hcHBlbmQobWF0aC5mbG9vcihuaVtuIC0gMV0gLyBuKSkNCiAgICAgICAgICAgIHByaW50KCDigJxcbiAgICAgICAg4oCcLmpvaW4oW+KAnHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjtcbiAgICAgICAgcmVzICs9IHhpICogJXM74oCdICUgaGV4KGludCh4KSkgZm9yIHggaW4gbmldKSkNCg0KICAgICovDQogICAgZnVuY3Rpb24gZml4ZWRFeHBVbnNhZmUodWludDI1NiBfeCkgaW50ZXJuYWwgcmV0dXJucyAodWludDI1Nikgew0KICAgIA0KICAgICAgICB1aW50MjU2IHhpID0gRklYRURfT05FOw0KICAgICAgICB1aW50MjU2IHJlcyA9IDB4ZGUxYmM0ZDE5ZWZjYWM4MjQ0NWRhNzViMDAwMDAwMDAgKiB4aTsNCg0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4ZGUxYmM0ZDE5ZWZjYjAwMDAwMDAwMDAwMDAwMDAwMDA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHg2ZjBkZTI2OGNmN2U1ODAwMDAwMDAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDI1MDRhMGNkOWE3ZjcyMDAwMDAwMDAwMDAwMDAwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4OTQxMjgzMzY2OWZkYzgwMDAwMDAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDFkOWQ0ZDcxNDg2NWY1MDAwMDAwMDAwMDAwMDAwMDA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHg0ZWY4Y2U4MzZiYmE4YzAwMDAwMDAwMDAwMDAwMDA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHhiNDgxZDgwN2QxYWE2ODAwMDAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDE2OTAzYjAwZmEzNTRkMDAwMDAwMDAwMDAwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4MjgxY2RhYWM2NzdiMzQwMDAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDQwMmUyYWFkNzI1ZWI4MDAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDVkNWE2YzlmMzFmZTI0MDAwMDAwMDAwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4N2M3ODkwZDQ0MmE4MzAwMDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDk5MzFlZDU0MDM0NTI4MDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweGFmMTQ3Y2YyNGNlMTUwMDAwMDAwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4YmFjMDg1NDZiODY3ZDAwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweGJhYzA4NTQ2Yjg2N2QwMDAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweGFmYzQ0MTMzODA2MWI4MDAwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4OWMzY2FiYmMwMDU2ZTAwMDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDgzOTE2ODMyODcwNWM4MDAwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDY5NDEyMDI4NmMwNGEwMDAwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4NTAzMTllOThiM2QyYzQwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDNhNTJhMWUzNmI4MjAyMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDI4OTI4NmUwZmNlMDAyOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4MWIwYzU5ZWI1MzQwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDExNGY5NWI1NTQwMDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweGFhNzIxMGQyMDA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHg2NTAxMzk2MDA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHgzOWI3OGU4MDsNCiAgICAgICAgeGkgPSAoeGkgKiBfeCkgPj4gUFJFQ0lTSU9OOw0KICAgICAgICByZXMgKz0geGkgKiAweDFmZDgwODA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHgxMGZiYzA7DQogICAgICAgIHhpID0gKHhpICogX3gpID4+IFBSRUNJU0lPTjsNCiAgICAgICAgcmVzICs9IHhpICogMHg4YzQwOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4NDYyOw0KICAgICAgICB4aSA9ICh4aSAqIF94KSA+PiBQUkVDSVNJT047DQogICAgICAgIHJlcyArPSB4aSAqIDB4MjI7DQoNCiAgICAgICAgcmV0dXJuIHJlcyAvIDB4ZGUxYmM0ZDE5ZWZjYWM4MjQ0NWRhNzViMDAwMDAwMDA7DQogICAgfSAgDQp9DQoNCmNvbnRyYWN0IFdvbGtFeGNoYW5nZSBpcyBXb2xrUHJvdG9jb2wsIEJhbmNvckZvcm11bGEgew0KDQogICAgdWludDI1NiBwdWJsaWMgbWF4UGVyRXhjaGFuZ2VCUCA9IDUwOw0KDQogICAgLy8gQHBhcmFtICBfbWF4UGVyRXhjaGFuZ2UNCiAgICAvLyBAcmV0dXJuIHN1Y2Nlc3MNCiAgICAvLyBAZGV2IFNldCBtYXggc2VsbCB0b2tlbiBhbW91bnQgcGVyIHRyYW5zYWN0aW9uIC0tIG9ubHkgV29sayBGb3VuZGF0aW9uIGNhbiBzZXQgdGhpcw0KICAgIGZ1bmN0aW9uIHNldE1heFBlckV4Y2hhbmdlKHVpbnQyNTYgX21heFBlckV4Y2hhbmdlKSBvbmx5T3duZXIgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7DQogICAgICAgIHJlcXVpcmUoIChfbWF4UGVyRXhjaGFuZ2UgPj0gMTApICYmIChfbWF4UGVyRXhjaGFuZ2UgPD0gMTAwKSApOw0KICAgICAgICBtYXhQZXJFeGNoYW5nZUJQID0gX21heFBlckV4Y2hhbmdlOw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvLyBAcmV0dXJuIEVzdGltYXRlZCBMaXF1aWRhdGlvbiBDYXANCiAgICAvLyBAZGV2IExpcXVpZGF0aW9uIENhcCBwZXIgdHJhbnNhY3Rpb24gaXMgdXNlZCB0byBlbnN1cmUgcHJvcGVyIHByaWNlIGRpc2NvdmVyeSBmb3IgV29sayBFeGNoYW5nZSANCiAgICBmdW5jdGlvbiBFc3RMaXF1aWRhdGlvbkNhcCgpIHB1YmxpYyBjb25zdGFudCByZXR1cm5zICh1aW50MjU2KSB7DQogICAgICAgIGlmIChzYWxlQ29tcGxldGVkKXsNCiAgICAgICAgICAgIHZhciBsaXF1aWRhdGlvbk1heCAgPSBzYWZlRGl2KHNhZmVNdWwodG90YWxUb2tlbnMsIG1heFBlckV4Y2hhbmdlQlApLCAxMDAwMCk7DQogICAgICAgICAgICBpZiAobGlxdWlkYXRpb25NYXggPCAxMDAgKiAxMCoqZGVjaW1hbHMpeyANCiAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbk1heCA9IDEwMCAqIDEwKipkZWNpbWFsczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBsaXF1aWRhdGlvbk1heDsgICANCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIEBwYXJhbSBfd29sa0Ftb3VudA0KICAgIC8vIEByZXR1cm4gZXRoUmVjZWl2YWJsZQ0KICAgIC8vIEBkZXYgc2VuZCBXb2xrIGludG8gY29udHJhY3QgaW4gZXhjaGFuZ2UgZm9yIGV0aCwgYXQgYW4gZXhjaGFuZ2UgcmF0ZSBiYXNlZCBvbiB0aGUgQmFuY29yIFByb3RvY29sIGRlcml2YXRpb24gYW5kIGRlY3JlYXNlIHRvdGFsU3VwcGx5IGFjY29yZGluZ2x5DQogICAgZnVuY3Rpb24gc2VsbFdvbGsodWludDI1NiBfd29sa0Ftb3VudCkgaXNUcmFuc2ZlcmFibGUoKSBleHRlcm5hbCByZXR1cm5zKHVpbnQyNTYpIHsNCiAgICAgICAgdWludDI1NiBzZWxsQ2FwID0gRXN0TGlxdWlkYXRpb25DYXAoKTsNCiAgICAgICAgdWludDI1NiBldGhSZWNlaXZhYmxlID0gY2FsY3VsYXRlU2FsZVJldHVybih0b3RhbFRva2VucywgcmVzZXJ2ZUJhbGFuY2UsIHBlcmNlbnRhZ2VFVEhSZXNlcnZlLCBfd29sa0Ftb3VudCk7DQogICAgICAgIHJlcXVpcmUoIChzZWxsQ2FwID49IF93b2xrQW1vdW50KSAmJiAoYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gX3dvbGtBbW91bnQpICYmICh0aGlzLmJhbGFuY2UgPiBldGhSZWNlaXZhYmxlKSApOw0KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVTdWIoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF93b2xrQW1vdW50KTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlU3ViKHRvdGFsVG9rZW5zLCBfd29sa0Ftb3VudCk7DQogICAgICAgIHJlc2VydmVCYWxhbmNlID0gc2FmZVN1Yih0aGlzLmJhbGFuY2UsIGV0aFJlY2VpdmFibGUpOw0KICAgICAgICBXb2xrRGVzdHJveWVkKG1zZy5zZW5kZXIsIF93b2xrQW1vdW50KTsNCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhSZWNlaXZhYmxlKTsNCiAgICAgICAgcmV0dXJuIGV0aFJlY2VpdmFibGU7ICAgICANCiAgICB9DQoNCiAgICAvLyBAcmV0dXJuIHdvbGtSZWNlaXZhYmxlICAgIA0KICAgIC8vIEBkZXYgc2VuZCBldGggaW50byBjb250cmFjdCBpbiBleGNoYW5nZSBmb3IgV29sayB0b2tlbnMsIGF0IGFuIGV4Y2hhbmdlIHJhdGUgYmFzZWQgb24gdGhlIEJhbmNvciBQcm90b2NvbCBkZXJpdmF0aW9uIGFuZCBpbmNyZWFzZSB0b3RhbFN1cHBseSBhY2NvcmRpbmdseQ0KICAgIGZ1bmN0aW9uIHB1cmNoYXNlV29saygpIGlzVHJhbnNmZXJhYmxlKCkgcGF5YWJsZSBleHRlcm5hbCByZXR1cm5zKHVpbnQyNTYpew0KICAgICAgICB1aW50MjU2IHdvbGtSZWNlaXZhYmxlID0gY2FsY3VsYXRlUHVyY2hhc2VSZXR1cm4odG90YWxUb2tlbnMsIHJlc2VydmVCYWxhbmNlLCBwZXJjZW50YWdlRVRIUmVzZXJ2ZSwgbXNnLnZhbHVlKTsNCiAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCB3b2xrUmVjZWl2YWJsZSk7DQogICAgICAgIGJhbGFuY2VzW21zZy5zZW5kZXJdID0gc2FmZUFkZChiYWxhbmNlc1ttc2cuc2VuZGVyXSwgd29sa1JlY2VpdmFibGUpOw0KICAgICAgICByZXNlcnZlQmFsYW5jZSA9IHNhZmVBZGQocmVzZXJ2ZUJhbGFuY2UsIG1zZy52YWx1ZSk7DQogICAgICAgIFdvbGtDcmVhdGVkKG1zZy5zZW5kZXIsIHdvbGtSZWNlaXZhYmxlKTsNCiAgICAgICAgcmV0dXJuIHdvbGtSZWNlaXZhYmxlOw0KICAgIH0NCg0KICAgIC8vIEBwYXJhbSBfZXhhY3RXb2xrDQogICAgLy8gQHJldHVybiBldGhSZWZ1bmRhYmxlDQogICAgLy8gQGRldiBzZW5kIGV0aCBpbnRvIGNvbnRyYWN0IGluIGV4Y2hhbmdlIGZvciBleGFjdCBhbW91bnQgb2YgV29sayB0b2tlbnMgd2l0aCBtYXJnaW4gb2YgZXJyb3Igb2Ygbm8gbW9yZSB0aGFuIDEgV29say4gDQogICAgLy8gQG5vdGUgUHVyY2hhc2Ugd2l0aCB0aGUgaW5zdWZmaWNpZW50IGV0aCB3aWxsIGJlIGNhbmNlbGxlZCBhbmQgcmV0dXJuZWQ7IGV4Y2VlZGluZyBldGggYmFsYW5hbmNlIGZyb20gcHVyY2hhc2UsIGlmIGFueSwgd2lsbCBiZSByZXR1cm5lZC4gICAgIA0KICAgIGZ1bmN0aW9uIHB1cmNoYXNlRXhhY3RXb2xrKHVpbnQyNTYgX2V4YWN0V29saykgaXNUcmFuc2ZlcmFibGUoKSBwYXlhYmxlIGV4dGVybmFsIHJldHVybnModWludDI1Nil7DQogICAgICAgIHVpbnQyNTYgd29sa1JlY2VpdmFibGUgPSBjYWxjdWxhdGVQdXJjaGFzZVJldHVybih0b3RhbFRva2VucywgcmVzZXJ2ZUJhbGFuY2UsIHBlcmNlbnRhZ2VFVEhSZXNlcnZlLCBtc2cudmFsdWUpOw0KICAgICAgICBpZiAod29sa1JlY2VpdmFibGUgPCBfZXhhY3RXb2xrKXsNCiAgICAgICAgICAgIC8vIENhbmNlbCBJbnN1ZmZpY2llbnQgUHVyY2hhc2UNCiAgICAgICAgICAgIHJldmVydCgpOw0KICAgICAgICAgICAgcmV0dXJuIG1zZy52YWx1ZTsNCiAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgdmFyIHdvbGtEaWZmID0gc2FmZVN1Yih3b2xrUmVjZWl2YWJsZSwgX2V4YWN0V29sayk7DQogICAgICAgICAgICB1aW50MjU2IGV0aFJlZnVuZGFibGUgPSAwOw0KICAgICAgICAgICAgLy8gUmVmdW5kIGlmIHdvbGtEaWZmIGV4Y2VlZHMgMSBXb2xrDQogICAgICAgICAgICBpZiAod29sa0RpZmYgPCAxMCoqZGVjaW1hbHMpew0KICAgICAgICAgICAgICAgIC8vIENyZWRpdCBCdXllciBGdWxsIGFtb3VudCBpZiB3aXRoaW4gbWFyZ2luIG9mIGVycm9yDQogICAgICAgICAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCB3b2xrUmVjZWl2YWJsZSk7DQogICAgICAgICAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSBzYWZlQWRkKGJhbGFuY2VzW21zZy5zZW5kZXJdLCB3b2xrUmVjZWl2YWJsZSk7DQogICAgICAgICAgICAgICAgcmVzZXJ2ZUJhbGFuY2UgPSBzYWZlQWRkKHJlc2VydmVCYWxhbmNlLCBtc2cudmFsdWUpOw0KICAgICAgICAgICAgICAgIFdvbGtDcmVhdGVkKG1zZy5zZW5kZXIsIHdvbGtSZWNlaXZhYmxlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsgICAgIA0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgZXRoUmVmdW5kYWJsZSA9IGNhbGN1bGF0ZVNhbGVSZXR1cm4oIHNhZmVBZGQodG90YWxUb2tlbnMsIHdvbGtSZWNlaXZhYmxlKSAsIHNhZmVBZGQocmVzZXJ2ZUJhbGFuY2UsIG1zZy52YWx1ZSksIHBlcmNlbnRhZ2VFVEhSZXNlcnZlLCB3b2xrRGlmZik7DQogICAgICAgICAgICAgICAgdG90YWxUb2tlbnMgPSBzYWZlQWRkKHRvdGFsVG9rZW5zLCBfZXhhY3RXb2xrKTsNCiAgICAgICAgICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IHNhZmVBZGQoYmFsYW5jZXNbbXNnLnNlbmRlcl0sIF9leGFjdFdvbGspOw0KICAgICAgICAgICAgICAgIHJlc2VydmVCYWxhbmNlID0gc2FmZUFkZChyZXNlcnZlQmFsYW5jZSwgc2FmZVN1Yihtc2cudmFsdWUsIGV0aFJlZnVuZGFibGUpKTsNCiAgICAgICAgICAgICAgICBXb2xrQ3JlYXRlZChtc2cuc2VuZGVyLCBfZXhhY3RXb2xrKTsNCiAgICAgICAgICAgICAgICBtc2cuc2VuZGVyLnRyYW5zZmVyKGV0aFJlZnVuZGFibGUpOw0KICAgICAgICAgICAgICAgIHJldHVybiBldGhSZWZ1bmRhYmxlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ=='