base 64 content
base64ziberToken13
	^'cHJhZ21hIHNvbGlkaXR5XjAuNC4xMTsNCg0KICAvKg0KDQogICAgWmliZXIuaW8gQ29udHJhY3QNCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT0NCiAgICBCdXlzIFpCUiB0b2tlbnMgZnJvbSB0aGUgREFPIGNyb3dkc2FsZSBvbiB5b3VyIGJlaGFsZi4NCiAgICBBdXRob3I6IC91L0xlbw0KDQogICovDQoNCg0KICAvLyBJbnRlcmZhY2UgdG8gWkJSIElDTyBDb250cmFjdA0KICBjb250cmFjdCBEYW9Ub2tlbiB7DQogICAgdWludDI1NiBwdWJsaWMgQ0FQOw0KICAgIHVpbnQyNTYgcHVibGljIHRvdGFsRXRoZXJzOw0KICAgIGZ1bmN0aW9uIHByb3h5UGF5bWVudChhZGRyZXNzIHBhcnRpY2lwYW50KSBwYXlhYmxlOw0KICAgIGZ1bmN0aW9uIHRyYW5zZmVyKGFkZHJlc3MgX3RvLCB1aW50IF9hbW91bnQpIHJldHVybnMgKGJvb2wgc3VjY2Vzcyk7DQogIH0NCg0KICBjb250cmFjdCBaaWJlclRva2VuIHsNCiAgICAvLyBTdG9yZSB0aGUgYW1vdW50IG9mIEVUSCBkZXBvc2l0ZWQgYnkgZWFjaCBhY2NvdW50Lg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gdWludDI1NikgcHVibGljIGJhbGFuY2VzOw0KICAgIC8vIFN0b3JlIHdoZXRoZXIgb3Igbm90IGVhY2ggYWNjb3VudCB3b3VsZCBoYXZlIG1hZGUgaXQgaW50byB0aGUgY3Jvd2RzYWxlLg0KICAgIG1hcHBpbmcgKGFkZHJlc3MgPT4gYm9vbCkgcHVibGljIGNoZWNrZWRfaW47DQogICAgLy8gQm91bnR5IGZvciBleGVjdXRpbmcgYnV5Lg0KICAgIHVpbnQyNTYgcHVibGljIGJvdW50eTsNCiAgICAvLyBUcmFjayB3aGV0aGVyIHRoZSBjb250cmFjdCBoYXMgYm91Z2h0IHRoZSB0b2tlbnMgeWV0Lg0KICAgIGJvb2wgcHVibGljIGJvdWdodF90b2tlbnM7DQogICAgLy8gUmVjb3JkIHRoZSB0aW1lIHRoZSBjb250cmFjdCBib3VnaHQgdGhlIHRva2Vucy4NCiAgICB1aW50MjU2IHB1YmxpYyB0aW1lX2JvdWdodDsNCiAgICAvLyBFbWVyZ2VuY3kga2lsbCBzd2l0Y2ggaW4gY2FzZSBhIGNyaXRpY2FsIGJ1ZyBpcyBmb3VuZC4NCiAgICBib29sIHB1YmxpYyBraWxsX3N3aXRjaDsNCiAgICANCiAgICAvKiBQdWJsaWMgdmFyaWFibGVzIG9mIHRoZSB0b2tlbiAqLw0KICAgIHN0cmluZyBwdWJsaWMgbmFtZTsNCiAgICBzdHJpbmcgcHVibGljIHN5bWJvbDsNCiAgICB1aW50OCBwdWJsaWMgZGVjaW1hbHM7DQogICAgDQogICAgLy8gUmF0aW8gb2YgWkJSIHRva2VucyByZWNlaXZlZCB0byBFVEggY29udHJpYnV0ZWQNCiAgICAvLyAxLjAwMC4wMDAgQkdQID0gODAuMDAwLjAwMCBaQlINCiAgICAvLyAxRVRIID0gMjE4IEJHUCAoMDMuMDcuMjAxNzogaHR0cHM6Ly93d3cuY29pbmdlY2tvLmNvbS9lbi9wcmljZV9jaGFydHMvZXRoZXJldW0vZ2JwKQ0KICAgIC8vIDEgRVRIID0gMTc0NDAgWkJSDQogICAgdWludDI1NiBaQlJfcGVyX2V0aCA9IDE3NDQwOw0KICAgIC8vVG90YWwgWkJSIFRva2VucyBSZXNlcnZlDQogICAgdWludDI1NiBaQlJfdG90YWxfcmVzZXJ2ZSA9IDEwMDAwMDAwMDsNCiAgICAvLyBaQlIgVG9rZW5zIGZvciBEZXZlbG9wZXJzDQogICAgdWludDI1NiBaQlJfZGV2X3Jlc2VydmVkID0gMTAwMDAwMDA7DQogICAgLy8gWkJSIFRva2VucyBmb3IgU2VsbGluZyBvdmVyIElDTw0KICAgIHVpbnQyNTYgWkJSX2Zvcl9zZWxsaW5nID0gODAwMDAwMDA7DQogICAgLy8gWkJSIFRva2VucyBmb3IgQm91bnR5DQogICAgdWludDI1NiBaQlJfZm9yX2JvdW50eT0gMTAwMDAwMDA7DQogICAgLy8gRVRIIGZvciBhY3RpdmF0ZSBraWxsLXN3aXRjaCBpbiBjb250cmFjdA0KICAgIHVpbnQyNTYgRVRIX3RvX2VuZCA9IDUwMDAwIGV0aGVyOw0KICAgIHVpbnQgcmVnaXN0cmVkVG87DQogICAgdWludDI1NiBsb2FkZWRSZWZ1bmQ7DQogICAgdWludDI1NiBfc3VwcGx5ID0gMTAwMDAwMDAwMDA7DQogICAgc3RyaW5nIF9uYW1lID0gIlpJQkVSIFRFU1QgVE9LRU4iOw0KICAgIHN0cmluZyBfc3ltYm9sID0gIlpCUlgiOw0KICAgIHVpbnQ4IF9kZWNpbWFscyA9IDI7DQoNCiAgICAvLyBUaGUgWkJSIFRva2VuIGFkZHJlc3MgYW5kIHNhbGUgYWRkcmVzcyBhcmUgdGhlIHNhbWUuDQogICAgRGFvVG9rZW4gcHVibGljIHRva2VuID0gRGFvVG9rZW4oMHhhOWQ1ODVDRTNCMjI3ZDY5OTg1YzNGN0E4NjZmRTdkMGU1MTBkYTUwKTsNCiAgICAvLyBUaGUgZGV2ZWxvcGVyIGFkZHJlc3MuDQogICAgYWRkcmVzcyBkZXZlbG9wZXJfYWRkcmVzcyA9IDB4NjUwODg3QjMzQkZBNDIzMjQwRUQ3QmM0QkQyNmM2NjA3NUUzYkVhZjsNCg0KDQogICAgLyogVGhpcyBjcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGJhbGFuY2VzICovDQogICAgICBtYXBwaW5nIChhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBiYWxhbmNlT2Y7DQogICAgICANCiAgICAgIC8qIFRoaXMgZ2VuZXJhdGVzIGEgcHVibGljIGV2ZW50IG9uIHRoZSBibG9ja2NoYWluIHRoYXQgd2lsbCBub3RpZnkgY2xpZW50cyAqLw0KICAgICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5kZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7DQoNCiAgICAgIC8vLyBTYWZlTWF0aCBjb250cmFjdCAtIG1hdGggb3BlcmF0aW9ucyB3aXRoIHNhZmV0eSBjaGVja3MNCiAgICAgIC8vLyBAYXV0aG9yIGRldkBzbWFydGNvbnRyYWN0ZWFtLmNvbQ0KICAgICAgZnVuY3Rpb24gc2FmZU11bCh1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICB1aW50IGMgPSBhICogYjsNCiAgICAgICAgYXNzZXJ0KGEgPT0gMCB8fCBjIC8gYSA9PSBiKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIHNhZmVEaXYodWludCBhLCB1aW50IGIpIGludGVybmFsIHJldHVybnMgKHVpbnQpIHsNCiAgICAgICAgYXNzZXJ0KGIgPiAwKTsNCiAgICAgICAgdWludCBjID0gYSAvIGI7DQogICAgICAgIGFzc2VydChhID09IGIgKiBjICsgYSAlIGIpOw0KICAgICAgICByZXR1cm4gYzsNCiAgICAgIH0NCg0KICAgICAgZnVuY3Rpb24gc2FmZVN1Yih1aW50IGEsIHVpbnQgYikgaW50ZXJuYWwgcmV0dXJucyAodWludCkgew0KICAgICAgICBhc3NlcnQoYiA8PSBhKTsNCiAgICAgICAgcmV0dXJuIGEgLSBiOw0KICAgICAgfQ0KDQogICAgICBmdW5jdGlvbiBzYWZlQWRkKHVpbnQgYSwgdWludCBiKSBpbnRlcm5hbCByZXR1cm5zICh1aW50KSB7DQogICAgICAgIHVpbnQgYyA9IGEgKyBiOw0KICAgICAgICBhc3NlcnQoYz49YSAmJiBjPj1iKTsNCiAgICAgICAgcmV0dXJuIGM7DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIG1heDY0KHVpbnQ2NCBhLCB1aW50NjQgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDY0KSB7DQogICAgICAgIHJldHVybiBhID49IGIgPyBhIDogYjsNCiAgICAgIH0NCg0KICAgICAgZnVuY3Rpb24gbWluNjQodWludDY0IGEsIHVpbnQ2NCBiKSBpbnRlcm5hbCBjb25zdGFudCByZXR1cm5zICh1aW50NjQpIHsNCiAgICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIG1heDI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gYSA+PSBiID8gYSA6IGI7DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIG1pbjI1Nih1aW50MjU2IGEsIHVpbnQyNTYgYikgaW50ZXJuYWwgY29uc3RhbnQgcmV0dXJucyAodWludDI1Nikgew0KICAgICAgICByZXR1cm4gYSA8IGIgPyBhIDogYjsNCiAgICAgIH0NCg0KICAgICAgZnVuY3Rpb24gYXNzZXJ0KGJvb2wgYXNzZXJ0aW9uKSBpbnRlcm5hbCB7DQogICAgICAgIGlmICghYXNzZXJ0aW9uKSB7DQogICAgICAgICAgdGhyb3c7DQogICAgICAgIH0NCiAgICAgIH0NCg0KDQogICAgICAvKioNCiAgICAgICogQWxsb3cgbG9hZCByZWZ1bmRzIGJhY2sgb24gdGhlIGNvbnRyYWN0IGZvciB0aGUgcmVmdW5kaW5nLg0KICAgICAgKg0KICAgICAgKiBUaGUgdGVhbSBjYW4gdHJhbnNmZXIgdGhlIGZ1bmRzIGJhY2sgb24gdGhlIHNtYXJ0IGNvbnRyYWN0IGluIHRoZSBjYXNlIHRoZSBtaW5pbXVtIGdvYWwgd2FzIG5vdCByZWFjaGVkLi4NCiAgICAgICovDQogICAgICBmdW5jdGlvbiBsb2FkUmVmdW5kKCkgcGF5YWJsZSB7DQogICAgICAgIGlmKG1zZy52YWx1ZSA9PSAwKSB0aHJvdzsNCiAgICAgICAgbG9hZGVkUmVmdW5kID0gc2FmZUFkZChsb2FkZWRSZWZ1bmQsIG1zZy52YWx1ZSk7DQogICAgICB9DQoNCiAgICAgIC8qKg0KICAgICAgKiBJbnZlc3RvcnMgY2FuIGNsYWltIHJlZnVuZC4NCiAgICAgICovDQogICAgICBmdW5jdGlvbiByZWZ1bmQoKSBwcml2YXRlICB7DQogICAgICAgIHVpbnQyNTYgd2VpVmFsdWUgPSB0aGlzLmJhbGFuY2U7DQogICAgICAgIGlmICh3ZWlWYWx1ZSA9PSAwKSB0aHJvdzsNCiAgICAgICAgdWludDI1NiB3ZWlSZWZ1bmRlZDsNCiAgICAgICAgd2VpUmVmdW5kZWQgPSBzYWZlQWRkKHdlaVJlZnVuZGVkLCB3ZWlWYWx1ZSk7DQogICAgICAgIHJlZnVuZCgpOw0KICAgICAgICBpZiAoIW1zZy5zZW5kZXIuc2VuZCh3ZWlWYWx1ZSkpIHRocm93Ow0KICAgICAgfQ0KDQogICAgICAvKiBTZW5kIGNvaW5zICovDQogICAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIF90bywgdWludDI1NiBfdmFsdWUpIHsNCiAgICAgICAgICAvKiBpZiB0aGUgc2VuZGVyIGRvZW5zdCBoYXZlIGVub3VnaCBiYWxhbmNlIHRoZW4gc3RvcCAqLw0KICAgICAgICAgIGlmIChiYWxhbmNlT2ZbbXNnLnNlbmRlcl0gPCBfdmFsdWUpIHRocm93Ow0KICAgICAgICAgIGlmIChiYWxhbmNlT2ZbX3RvXSArIF92YWx1ZSA8IGJhbGFuY2VPZltfdG9dKSB0aHJvdzsNCiAgICAgICAgICANCiAgICAgICAgICAvKiBBZGQgYW5kIHN1YnRyYWN0IG5ldyBiYWxhbmNlcyAqLw0KICAgICAgICAgIGJhbGFuY2VPZlttc2cuc2VuZGVyXSAtPSBfdmFsdWU7DQogICAgICAgICAgYmFsYW5jZU9mW190b10gKz0gX3ZhbHVlOw0KICAgICAgICAgIA0KICAgICAgICAgIC8qIE5vdGlmaXkgYW55b25lIGxpc3RlbmluZyB0aGF0IHRoaXMgdHJhbnNmZXIgdG9vayBwbGFjZSAqLw0KICAgICAgICAgIFRyYW5zZmVyKG1zZy5zZW5kZXIsIF90bywgX3ZhbHVlKTsNCiAgICAgIH0NCiAgICANCiAgICAvLyBBbGxvd3MgdGhlIGRldmVsb3BlciB0byBzaHV0IGRvd24gZXZlcnl0aGluZyBleGNlcHQgd2l0aGRyYXdhbHMgaW4gZW1lcmdlbmNpZXMuDQogICAgZnVuY3Rpb24gYWN0aXZhdGVfa2lsbF9zd2l0Y2goKSB7DQogICAgICAvLyBPbmx5IGFsbG93IHRoZSBkZXZlbG9wZXIgdG8gYWN0aXZhdGUgdGhlIGtpbGwgc3dpdGNoLg0KICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVyX2FkZHJlc3MpIHRocm93Ow0KICAgICAgLy8gSXJyZXZlcnNpYmx5IGFjdGl2YXRlIHRoZSBraWxsIHN3aXRjaC4NCiAgICAgIGtpbGxfc3dpdGNoID0gdHJ1ZTsNCiAgICB9DQogICAgDQogICAgLy8gV2l0aGRyYXdzIGFsbCBFVEggZGVwb3NpdGVkIG9yIFpCUiBwdXJjaGFzZWQgYnkgdGhlIHNlbmRlci4NCiAgICBmdW5jdGlvbiB3aXRoZHJhdygpew0KICAgICAgLy8gSWYgY2FsbGVkIGJlZm9yZSB0aGUgSUNPLCBjYW5jZWwgY2FsbGVyJ3MgcGFydGljaXBhdGlvbiBpbiB0aGUgc2FsZS4NCiAgICAgIGlmICghYm91Z2h0X3Rva2Vucykgew0KICAgICAgICAvLyBTdG9yZSB0aGUgdXNlcidzIGJhbGFuY2UgcHJpb3IgdG8gd2l0aGRyYXdhbCBpbiBhIHRlbXBvcmFyeSB2YXJpYWJsZS4NCiAgICAgICAgdWludDI1NiBldGhfYW1vdW50ID0gYmFsYW5jZXNbbXNnLnNlbmRlcl07DQogICAgICAgIC8vIFVwZGF0ZSB0aGUgdXNlcidzIGJhbGFuY2UgcHJpb3IgdG8gc2VuZGluZyBFVEggdG8gcHJldmVudCByZWN1cnNpdmUgY2FsbC4NCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gPSAwOw0KICAgICAgICAvLyBSZXR1cm4gdGhlIHVzZXIncyBmdW5kcy4gIFRocm93cyBvbiBmYWlsdXJlIHRvIHByZXZlbnQgbG9zcyBvZiBmdW5kcy4NCiAgICAgICAgbXNnLnNlbmRlci50cmFuc2ZlcihldGhfYW1vdW50KTsNCiAgICAgIH0NCiAgICAgIC8vIFdpdGhkcmF3IHRoZSBzZW5kZXIncyB0b2tlbnMgaWYgdGhlIGNvbnRyYWN0IGhhcyBhbHJlYWR5IHB1cmNoYXNlZCB0aGVtLg0KICAgICAgZWxzZSB7DQogICAgICAgIC8vIFN0b3JlIHRoZSB1c2VyJ3MgWkJSIGJhbGFuY2UgaW4gYSB0ZW1wb3JhcnkgdmFyaWFibGUgKDEgRVRIV2VpIC0+IDIwMDAgWkJSV2VpKS4NCiAgICAgICAgdWludDI1NiBaQlJfYW1vdW50ID0gYmFsYW5jZXNbbXNnLnNlbmRlcl0gKiBaQlJfcGVyX2V0aDsNCiAgICAgICAgLy8gVXBkYXRlIHRoZSB1c2VyJ3MgYmFsYW5jZSBwcmlvciB0byBzZW5kaW5nIFpCUiB0byBwcmV2ZW50IHJlY3Vyc2l2ZSBjYWxsLg0KICAgICAgICBiYWxhbmNlc1ttc2cuc2VuZGVyXSA9IDA7DQogICAgICAgIC8vIE5vIGZlZSBmb3Igd2l0aGRyYXdpbmcgaWYgdGhlIHVzZXIgd291bGQgaGF2ZSBtYWRlIGl0IGludG8gdGhlIGNyb3dkc2FsZSBhbG9uZS4NCiAgICAgICAgdWludDI1NiBmZWUgPSAwOw0KICAgICAgICAvLyAxJSBmZWUgaWYgdGhlIHVzZXIgZGlkbid0IGNoZWNrIGluIGR1cmluZyB0aGUgY3Jvd2RzYWxlLg0KICAgICAgICBpZiAoIWNoZWNrZWRfaW5bbXNnLnNlbmRlcl0pIHsNCiAgICAgICAgICBmZWUgPSBaQlJfYW1vdW50IC8gMTAwOw0KICAgICAgICAgIC8vIFNlbmQgYW55IG5vbi16ZXJvIGZlZXMgdG8gZGV2ZWxvcGVyLg0KICAgICAgICAgIGlmKCF0b2tlbi50cmFuc2ZlcihkZXZlbG9wZXJfYWRkcmVzcywgZmVlKSkgdGhyb3c7DQogICAgICAgIH0NCiAgICAgICAgLy8gU2VuZCB0aGUgdXNlciB0aGVpciB0b2tlbnMuICBUaHJvd3MgaWYgdGhlIGNyb3dkc2FsZSBpc24ndCBvdmVyLg0KICAgICAgICBpZighdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgWkJSX2Ftb3VudCAtIGZlZSkpIHRocm93Ow0KICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBBbGxvdyBkZXZlbG9wZXIgdG8gYWRkIEVUSCB0byB0aGUgYnV5IGV4ZWN1dGlvbiBib3VudHkuDQogICAgZnVuY3Rpb24gYWRkX3RvX2JvdW50eSgpIHBheWFibGUgew0KICAgICAgLy8gT25seSBhbGxvdyB0aGUgZGV2ZWxvcGVyIHRvIGNvbnRyaWJ1dGUgdG8gdGhlIGJ1eSBleGVjdXRpb24gYm91bnR5Lg0KICAgICAgaWYgKG1zZy5zZW5kZXIgIT0gZGV2ZWxvcGVyX2FkZHJlc3MpIHRocm93Ow0KICAgICAgLy8gRGlzYWxsb3cgYWRkaW5nIHRvIGJvdW50eSBpZiBraWxsIHN3aXRjaCBpcyBhY3RpdmUuDQogICAgICBpZiAoa2lsbF9zd2l0Y2gpIHRocm93Ow0KICAgICAgLy8gRGlzYWxsb3cgYWRkaW5nIHRvIHRoZSBib3VudHkgaWYgY29udHJhY3QgaGFzIGFscmVhZHkgYm91Z2h0IHRoZSB0b2tlbnMuDQogICAgICBpZiAoYm91Z2h0X3Rva2VucykgdGhyb3c7DQogICAgICAvLyBVcGRhdGUgYm91bnR5IHRvIGluY2x1ZGUgcmVjZWl2ZWQgYW1vdW50Lg0KICAgICAgYm91bnR5ICs9IG1zZy52YWx1ZTsNCiAgICB9DQogICAgDQogICAgLy8gQnV5cyB0b2tlbnMgaW4gdGhlIGNyb3dkc2FsZSBhbmQgcmV3YXJkcyB0aGUgY2FsbGVyLCBjYWxsYWJsZSBieSBhbnlvbmUuDQogICAgZnVuY3Rpb24gY2xhaW1fYm91bnR5KCl7DQogICAgICAvLyBTaG9ydCBjaXJjdWl0IHRvIHNhdmUgZ2FzIGlmIHRoZSBjb250cmFjdCBoYXMgYWxyZWFkeSBib3VnaHQgdG9rZW5zLg0KICAgICAgaWYgKGJvdWdodF90b2tlbnMpIHJldHVybjsNCiAgICAgIC8vIERpc2FsbG93IGJ1eWluZyBpbnRvIHRoZSBjcm93ZHNhbGUgaWYga2lsbCBzd2l0Y2ggaXMgYWN0aXZlLg0KICAgICAgaWYgKGtpbGxfc3dpdGNoKSB0aHJvdzsNCiAgICAgIC8vIFJlY29yZCB0aGF0IHRoZSBjb250cmFjdCBoYXMgYm91Z2h0IHRoZSB0b2tlbnMuDQogICAgICBib3VnaHRfdG9rZW5zID0gdHJ1ZTsNCiAgICAgIC8vIFJlY29yZCB0aGUgdGltZSB0aGUgY29udHJhY3QgYm91Z2h0IHRoZSB0b2tlbnMuDQogICAgICB0aW1lX2JvdWdodCA9IG5vdyArIDEgZGF5czsNCiAgICAgIC8vIFRyYW5zZmVyIGFsbCB0aGUgZnVuZHMgKGxlc3MgdGhlIGJvdW50eSkgdG8gdGhlIFpCUiBjcm93ZHNhbGUgY29udHJhY3QNCiAgICAgIC8vIHRvIGJ1eSB0b2tlbnMuICBUaHJvd3MgaWYgdGhlIGNyb3dkc2FsZSBoYXNuJ3Qgc3RhcnRlZCB5ZXQgb3IgaGFzDQogICAgICAvLyBhbHJlYWR5IGNvbXBsZXRlZCwgcHJldmVudGluZyBsb3NzIG9mIGZ1bmRzLg0KICAgICAgdG9rZW4ucHJveHlQYXltZW50LnZhbHVlKHRoaXMuYmFsYW5jZSAtIGJvdW50eSkoYWRkcmVzcyh0aGlzKSk7DQogICAgICAvLyBTZW5kIHRoZSBjYWxsZXIgdGhlaXIgYm91bnR5IGZvciBidXlpbmcgdG9rZW5zIGZvciB0aGUgY29udHJhY3QuDQogICAgICBpZih0aGlzLmJhbGFuY2UgPiBFVEhfdG9fZW5kKQ0KICAgICAgew0KICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIoYm91bnR5KTsNCiAgICAgIH0NCiAgICAgIGVsc2Ugew0KICAgICAgICAgIHRpbWVfYm91Z2h0ID0gbm93ICsgIDEgZGF5cyAqIDk7DQogICAgICAgICAgaWYodGhpcy5iYWxhbmNlID4gRVRIX3RvX2VuZCkgew0KICAgICAgICAgICAgbXNnLnNlbmRlci50cmFuc2Zlcihib3VudHkpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBBIGhlbHBlciBmdW5jdGlvbiBmb3IgdGhlIGRlZmF1bHQgZnVuY3Rpb24sIGFsbG93aW5nIGNvbnRyYWN0cyB0byBpbnRlcmFjdC4NCiAgICBmdW5jdGlvbiBkZWZhdWx0X2hlbHBlcigpIHBheWFibGUgew0KICAgICAgLy8gVHJlYXQgbmVhci16ZXJvIEVUSCB0cmFuc2FjdGlvbnMgYXMgY2hlY2sgaW5zIGFuZCB3aXRoZHJhd2FsIHJlcXVlc3RzLg0KICAgICAgaWYgKG1zZy52YWx1ZSA8PSAxIGZpbm5leSkgew0KICAgICAgICAvLyBDaGVjayBpbiBkdXJpbmcgdGhlIGNyb3dkc2FsZS4NCiAgICAgICAgaWYgKGJvdWdodF90b2tlbnMpIHsNCiAgICAgICAgICAvLyBPbmx5IGFsbG93IGNoZWNraW5nIGluIGJlZm9yZSB0aGUgY3Jvd2RzYWxlIGhhcyByZWFjaGVkIHRoZSBjYXAuDQogICAgICAgICAgaWYgKHRva2VuLnRvdGFsRXRoZXJzKCkgPj0gdG9rZW4uQ0FQKCkpIHRocm93Ow0KICAgICAgICAgIC8vIE1hcmsgdXNlciBhcyBjaGVja2VkIGluLCBtZWFuaW5nIHRoZXkgd291bGQgaGF2ZSBiZWVuIGFibGUgdG8gZW50ZXIgYWxvbmUuDQogICAgICAgICAgY2hlY2tlZF9pblttc2cuc2VuZGVyXSA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAgLy8gV2l0aGRyYXcgZnVuZHMgaWYgdGhlIGNyb3dkc2FsZSBoYXNuJ3QgYmVndW4geWV0IG9yIGlzIGFscmVhZHkgb3Zlci4NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgd2l0aGRyYXcoKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy8gRGVwb3NpdCB0aGUgdXNlcidzIGZ1bmRzIGZvciB1c2UgaW4gcHVyY2hhc2luZyB0b2tlbnMuDQogICAgICBlbHNlIHsNCiAgICAgICAgLy8gRGlzYWxsb3cgZGVwb3NpdHMgaWYga2lsbCBzd2l0Y2ggaXMgYWN0aXZlLg0KICAgICAgICBpZiAoa2lsbF9zd2l0Y2gpIHRocm93Ow0KICAgICAgICAvLyBPbmx5IGFsbG93IGRlcG9zaXRzIGlmIHRoZSBjb250cmFjdCBoYXNuJ3QgYWxyZWFkeSBwdXJjaGFzZWQgdGhlIHRva2Vucy4NCiAgICAgICAgaWYgKGJvdWdodF90b2tlbnMpIHRocm93Ow0KICAgICAgICAvLyBVcGRhdGUgcmVjb3JkcyBvZiBkZXBvc2l0ZWQgRVRIIHRvIGluY2x1ZGUgdGhlIHJlY2VpdmVkIGFtb3VudC4NCiAgICAgICAgYmFsYW5jZXNbbXNnLnNlbmRlcl0gKz0gbXNnLnZhbHVlOw0KICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBEZWZhdWx0IGZ1bmN0aW9uLiAgQ2FsbGVkIHdoZW4gYSB1c2VyIHNlbmRzIEVUSCB0byB0aGUgY29udHJhY3QuDQogICAgZnVuY3Rpb24gKCkgcGF5YWJsZSB7DQogICAgICAvLyBEZWxlZ2F0ZSB0byB0aGUgaGVscGVyIGZ1bmN0aW9uLg0KICAgICAgZGVmYXVsdF9oZWxwZXIoKTsNCiAgICB9DQogICAgDQogICAgLy9DaGVjayBpcyBtc2dfc2VuZGVyIGlzIGNvbnRyYWN0IGRldg0KICAgIG1vZGlmaWVyIG9ubHlPd25lcigpIHsNCiAgICAgIGlmIChtc2cuc2VuZGVyICE9IGRldmVsb3Blcl9hZGRyZXNzKSB7DQogICAgICAgIHRocm93Ow0KICAgICAgfQ0KICAgICAgXzsNCiAgICB9DQogICAgDQogICAgLy8gU2VuZCBmdW5kIHdoZW4gaWNvIGVuZA0KICAgIGZ1bmN0aW9uIHdpdGhkcmF3RXRoKCkgb25seU93bmVyIHsgICAgICAgIA0KICAgICAgICAgIG1zZy5zZW5kZXIudHJhbnNmZXIodGhpcy5iYWxhbmNlKTsNCiAgICB9DQogICAgDQogICAgLy9LaWxsIGNvbnRyYWN0DQogICAgZnVuY3Rpb24ga2lsbCgpIG9ubHlPd25lciB7ICAgICAgICANCiAgICAgICAgICBzZWxmZGVzdHJ1Y3QoZGV2ZWxvcGVyX2FkZHJlc3MpOw0KICAgIH0NCiAgfQ=='